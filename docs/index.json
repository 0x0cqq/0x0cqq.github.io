[{"content":"https://github.com/ChenQiqian/Simple-Captcha-Solver\n","description":"A simple program to solve Captcha on www.bjeea.cn","id":1,"section":"showcase","tags":null,"title":"Simple Captcha Solver","uri":"https://blog.chenqiqian.com/showcase/project/simple-captcha-solver/"},{"content":"ã€æœ€æ–°æ›´æ–°ï¼š20201026ã€‘\nå…¶å®ç°åœ¨å·²ç»å¼€å­¦ä¸€ä¸ªå¤šæœˆäº†ï¼Œä½†å…¶å®åœ¨ THU çš„ç”Ÿæ´»ä¹Ÿæ‰åˆšåˆšå¼€å§‹ã€‚å†™äº›ä¸œè¥¿æ¥è®°å½•æœ€åˆçš„ç”Ÿæ´»ï¼Œè¿˜æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚\nä»¥å‰ä¹Ÿæ›¾æƒ³å†™è¿‡è¿™ç§é•¿ç¯‡ï¼Œä½†æ˜¯å…¶å®åšæŒä¸ä¸‹æ¥çš„æ¦‚ç‡å¾ˆå¤§ï¼Œå› ä¸ºè‡ªå·±ä¹Ÿä¸çŸ¥é“åˆ°åº•ä¼šå†™å¤šé•¿ã€‚\n æƒ³æ¥ä¹Ÿæœ‰è¶£ï¼Œåœ¨ THU çš„ç”Ÿæ´»æ€»å…±ä¹Ÿå°± 50 ä¸ªæœˆï¼Œç°åœ¨å·²ç»è¿‡å»äº† 1/50 ï¼›äººç”Ÿæ€»å…± 1000 ä¸ªæœˆï¼Œç°åœ¨åˆè¿‡å»äº† 1/1000 ã€‚\nä½†æ˜¯ç°åœ¨å¹¶æ²¡æœ‰ä»–ä»¬å³å°†è¿‡å»çš„æ„Ÿè§‰ã€‚\n å†™å°è¯´è¦å…ˆä»‹ç»æ—¶é—´åœ°ç‚¹äººç‰©ï¼Œå†™è®°å½•å¤§æ¦‚ä¹Ÿè¦å…ˆä»‹ç»ç¯å¢ƒã€‚\næ ¡å›­ æ¸…åå¾ˆå¤§ï¼Œä¹Ÿå¾ˆå°ã€‚æœ€åŒ—è¾¹æ˜¯å­¦ç”Ÿå…¬å¯“ã€‚\nå­¦ç”Ÿå…¬å¯“ å­¦ç”Ÿå…¬å¯“å¤§æ¦‚åˆ†ä¸ºç´«è†åŒºå’Œå—åŒºã€‚æˆ‘ä»¬ä½åœ¨ç´«è†ä¸€å·æ¥¼ã€‚\ncqqç¿»éäº†è‡ªå·±çš„æ‰‹æœºï¼Œå‘ç°ä¸€å¼ å®¿èˆå¤–æ™¯çš„ç…§ç‰‡éƒ½æ²¡æœ‰æ‹è¿‡ï¼Œè™½ç„¶æ¯å¤©éƒ½æœ‰å¾ˆé•¿çš„æ—¶é—´åœ¨å®¿èˆåº¦è¿‡ï¼Œä½†å®¿èˆå´æ˜¯æœ€ä¸ç•™æ„çš„åœ°æ–¹ã€‚\nä»æ¥¼å·å°±å¯ä»¥çœ‹å‡ºï¼Œç´«è†ä¸€å·æ¥¼å¤§æ¦‚æ˜¯ç´«è†å…¬å¯“é‡Œæœ€è€èµ„å†çš„æ¥¼äº†ã€‚æ¥¼å¤–çœ‹ä¸Šå»ä¸å…¶ä»–çš„æ¥¼ä¹Ÿæ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œæ¥¼å†…çš„è£…ä¿®å¤„åœ¨å¾®å¦™çš„ç•Œé™ä¸Šï¼Œä¸ç°åœ¨çš„æ—¶ä»£è—•æ–­ä¸è¿ã€‚æ¥¼å†…ä¸»è¦ä½çš„æ˜¯æ— ç³»ï¼Œé›·ç³»å’Œè½¯é™¢çš„åŒå­¦ï¼Œæ—è¾¹å°±æ˜¯æ— ç³»çš„æ–°ç”Ÿå’Œå­¦é•¿ã€‚ï¼ˆå¦‚æœæˆ‘æ²¡æé”™çš„è¯..ï¼Ÿï¼‰\nç”±äºç–«æƒ…åŸå› ï¼Œç°åœ¨æ•´æ ‹6å±‚å¿«ä¸€åƒäººçš„å®¿èˆæ¥¼åªå¼€äº†ä¸€ä¸ªé—¨ï¼Œæˆ‘æ‰€åœ¨çš„å®¿èˆåœ¨ä¸‰å±‚ï¼Œè·ç¦»æ¥¼é—¨çš„è·ç¦»ä¹Ÿä¸ç®—è¿œï¼›ä½†é—®åˆ°è´µç³»æŸäººçš„å®¿èˆå°±åœ¨1å±‚é è¿‘æ¥¼é—¨ä¹‹å\u0026hellip;ç»¼ä¸Šæ‰€è¿°ï¼Œæ²¡æœ‰æ¯”è¾ƒï¼Œå°±æ²¡æœ‰å†…å·ã€‚å®¿èˆé—¨å£å°±æ˜¯å«ç”Ÿé—´ï¼Œä¸æ´—æ¼±é—´éš”æ¥¼æ¢¯é—´ç›¸æœ›ã€‚æœ¬æ¥è§‰å¾—è¿™å¹¶ä¸æ˜¯å¾ˆå¥½ï¼Œä½†ç°åœ¨è§‰å¾—å…¶å®ä¹Ÿè¿˜å¯ä»¥ï¼Œæ¯•ç«Ÿåœ¨å®¿èˆçš„æ—¶é—´ä¹Ÿæ²¡å¤šå°‘ã€‚\n â€œè¦åƒåŸå¢“ä¸€æ ·ç®€æ´ã€‚â€\n ç„¶è€Œï¼Œè¿™åœ¨å®¿èˆå¹¶åšä¸åˆ°ã€‚ä¸ŠåºŠä¸‹æ¡Œçš„å¸ƒç½®ç»™æ¯ä¸ªäººä¸€ä¸ªç›¸å¯¹ç‹¬ç«‹çš„ç©ºé—´ï¼Œç§å¯†æ€§å’Œè‡ªç”±åº¦ç›¸å¯¹æ¥è¯´ç®—æ˜¯å¾ˆä¸é”™ã€‚\nç›®å‰çš„ä¸€ä¸ªæœˆï¼Œè¿˜å¯ä»¥ä¿æŒæ¡Œé¢æ•´æ´åˆ°å¯ä»¥å±•å¼€ä¸€å¼ äººæ°‘æ—¥æŠ¥ï¼Œç„¶è€Œçœ‹åˆ°å­¦é•¿çš„å¯å®¤çš„æ•´æ´ç¨‹åº¦ï¼ŒçœŸä¸çŸ¥é“è‡ªå·±ä¸€å¹´è¿‡ååˆä¼šæ€ä¹ˆæ ·\u0026hellip;\nè¯´åˆ°æ¡Œå­ï¼Œå°±æƒ³èµ·æ¥åœ¨ä¸Šå¤§å­¦å‰ï¼Œèµ¶ç€æš‘å‡çœ‹äº†ä¸å°‘ä¹¦ï¼ˆè‡³å°‘æ¯”è¿™ä¸€ä¸ªæœˆæ¥çœ‹ï¼‰ï¼Œå“²å­¦ã€é€»è¾‘å­¦ã€ç»æµå­¦ã€æ”¿æ²»å­¦ã€é“å¾·ç»ã€ä¸­åŒ»ã€æ•°å­¦\u0026hellip;\u0026hellip;åœ¨å¼€å­¦ä¹‹å‰å¤©çœŸçš„ä»¥ä¸ºè‡ªå·±èƒ½æœ‰æ—¶é—´çœ‹ä¹¦ï¼Œäºæ˜¯å°±ä¹°/å¸¦äº†ä¸å°‘ä¹¦æ¥åˆ°å­¦æ ¡ï¼Œå¼€å­¦ç¬¬ä¸€å‘¨ç”šè‡³è¿˜ä»å›¾ä¹¦é¦†é‡Œå€Ÿäº†é—²ä¹¦ï¼Œç°åœ¨æ‰å‘ç°æ ¹æœ¬æ²¡æœ‰è¿™ä¸ªæ—¶é—´23333\näºæ˜¯å°±æœ‰äº†\u0026hellip;ä¹¦æ¶çš„è¿›å‡».gif\n   0909 0919 1020           æˆ‘çœŸçš„æ˜¯è®¡ç®—æœºç±»çš„å­¦ç”Ÿçš„å—.jpg\nç°åœ¨ä¹Ÿå‘ç°ï¼Œå¾ˆå¤šä¹¦ä¹Ÿåªå€¼å¾—æ³›è¯»ï¼Œä¹Ÿè¿˜æœ‰å¾ˆå¤šä¹¦å€¼å¾—è®°ç¬”è®°ç²¾è¯»ã€‚è¦æŠŠæ¡å¥½åº¦ï¼Œå¦åˆ™å•¥ä¹¦éƒ½è¯»ä¸å®Œäº†.jpeg\nè¯´åˆ°ä¹¦ï¼Œå°±è¦è¯´è¯´ä½ æ¸…çš„å›¾ä¹¦é¦†äº†ã€‚\nå›¾ä¹¦é¦† å¿˜äº†åœ¨å“ªèŠ‚è¯¾ä¸Šå¬åˆ°çš„æ•…äº‹ï¼š\n æŸå¤–å›½å¤§å­¦çš„ä»£è¡¨å›¢å‚è§‚æ ¡å›­ä¹‹åï¼Œå¯¹æŸä¸–ä¸€å¤§çš„é™ªåŒäººå‘˜è¯´ï¼šâ€œä½ ä»¬æƒ³è¦ç®¡ç†å¥½è¿™æ‰€å­¦æ ¡å¤ªç®€å•äº†ï¼Œåªè¦æ¯å¤©æŒ‰æ—¶æ‰“å¼€å›¾ä¹¦é¦†çš„å¤§é—¨å°±å¯ä»¥äº†ã€‚â€\n ç¡®å®ã€‚æ¸…åçš„å›¾ä¹¦é¦†å¾ˆå¤šï¼Œä¹Ÿå¾ˆå¤§ã€‚è€é¦†ã€è¥¿é¦†ã€åŒ—é¦†æ„æˆçš„ä¸»é¦†æœ‰ä¸¤ä¸ªæ ‡å‡†ç”°å¾„åœºé‚£ä¹ˆå¤§ï¼Œè€Œç¾æœ¯é¦†ã€é‡‘èé¦†ã€å»ºç­‘é¦†ã€æ³•å¾‹é¦†ã€æ–‡ç§‘é¦†ç­‰ç­‰åˆ†é¦†æ•£å¸ƒäºå­¦æ ¡ï¼ˆè¿œç¦»ç´«è†å…¬å¯“åŒºï¼‰çš„å„ä¸ªè§’è½ï¼Œå„æœ‰ç‰¹è‰²ã€‚\nå›¾ä¹¦é¦†çœŸé¦™ã€‚\n          åŒ—é¦† è¥¿é¦† æ³•å¾‹é¦†    é¦–å…ˆæ˜¯èµ„æºã€‚æ›¾ç»åœ¨é«˜å¤§çš„ä¹¦æ¶ä¹‹é—´æ¼«æ­¥ï¼Œå‡ ä¹æ¯ä¸ªä¹¦æ¶éƒ½ä¼šæœ‰é‚£ä¹ˆä¸€ä¸¤æœ¬ç‰¹åˆ«å¼•äººæ³¨ç›®çš„ä¹¦ï¼Œè¦ä¹ˆæ˜¯å½¢åˆ¶å¤ºç›®ï¼Œè¦ä¹ˆæ˜¯ä¹¦åå¥‡ç‰¹ã€‚æ®è¯´ï¼Œæ¸…åå›¾ä¹¦é¦†ç°åœ¨æœ‰å‡ ç™¾ä¸‡çº¸è´¨å†Œä¹¦ï¼ŒåŸºæœ¬æ‰€æœ‰å› ä¸ºè¯¾ç¨‹æˆ–è€…å…¶ä»–åŸå› éœ€è¦çš„ä¹¦éƒ½å¯ä»¥åœ¨å›¾ä¹¦é¦†ä¹¦ç›®é‡Œé¢æ‰¾åˆ°ï¼Œåªæ˜¯ä¸ä¸€å®šè¿˜åœ¨æ¶ä¸Šã€‚ä¹‹æ‰€ä»¥ä¸Šä¸€å¥è¯è¯´çº¸è´¨è—ä¹¦ï¼Œæ˜¯å› ä¸ºå›¾ä¹¦é¦†è¿˜æœ‰å¾ˆå¤šå¾ˆå¤šç”µå­èµ„æºï¼ŒåŒ…æ‹¬å„ç§ä¹¦ã€æ•™å‚çš„ç”µå­ç‰ˆï¼Œè¿˜æœ‰å„ç§æ–‡çŒ®ç½‘ç«™çš„çŸ¥ç½‘ï¼ŒæŒºä¸é”™ã€‚\nå…¶æ¬¡æ˜¯ç¯å¢ƒã€‚ä½ æ¸…ç¯å¢ƒæœ¬æ¥å°±ä¸é”™ï¼Œå›¾ä¹¦é¦†æ›´æ˜¯â€œé¢œå€¼æ‹…å½“â€ã€‚åŒ—é¦†çš„ä¸‹æ²‰å¹¿åœºå’Œé‚ºæ¶è½©ï¼Œè¥¿é¦†çš„çˆ¬å±±è™ï¼Œæ³•å¾‹é¦†çš„ç»¿èï¼Œç»¿è‰²çš„æ´»åŠ›å’Œæ£•è‰²çš„æœ¨æ¡Œæ­é…ï¼Œå¾ˆæœ‰æ„å¢ƒã€‚å›¾ä¹¦é¦†ç›¸æ¯”å®¿èˆæœ€å¥½çš„ï¼Œå°±æ˜¯é«˜å±‚é«˜å’Œå¼€æ”¾çš„ç©ºé—´ï¼›é«˜å±‚é«˜è¥é€ äº†ä¸å‹æŠ‘çš„æ°›å›´ï¼Œå¼€æ”¾å¼çš„ç©ºé—´è®©è‡ªå·±ä¸è‡³äºå­¦åˆ°è‡ªé—­ã€‚è™½ç„¶å®¿èˆä¹Ÿæ˜¯äººäººéƒ½åœ¨å­¦ä¹ ï¼Œä½†æ¯•ç«Ÿåœ¨ä¸è®¤è¯†çš„äººé¢å‰ï¼Œé‚£ç§ç«äº‰çš„æ²‰é‡ä¹Ÿå¯ä»¥æ”¾ä¸‹äº›ã€‚\nä»å›¾ä¹¦é¦†å€Ÿäº†ä¸å°‘ä¹¦ï¼Œç›®å‰ï¼ˆ10.22ï¼‰è¿˜æ²¡è¿˜å›å»å‡ æœ¬ï¼Œæœ‰å‡ æœ¬ä¹¦å¤§æ¦‚å¿«éœ€è¦ç»­å€Ÿäº†ï¼Œæœ‰å‡ æœ¬ä¹¦è‡ªä»å€Ÿå›æ¥å°±æ²¡æ€ä¹ˆç¿»è¿‡ã€‚å¾ˆæƒ­æ„§ï¼Œä¸€å®šè¦ä¿è¯å€Ÿè¿‡çš„ä¹¦éƒ½çœ‹è¿‡ï¼å¤§å­¦å¦‚æœä¸è¯»ä¹¦å“ªé‡Œè¿˜æ˜¯å¤§å­¦ç”Ÿæ´»å‘¢\u0026hellip;\nåœ¨ä½ æ¸…ï¼Œå›¾ä¹¦é¦†çš„æœ¬è´¨å…¶å®æ˜¯å¤§å‹æ’åº§å……è¶³è‡ªä¹ å®¤ã€‚äº‹å®ä¸Šä¹Ÿçš„ç¡®æ˜¯çš„ï¼Œå¹³å‡ä¸‹æ¥æˆ‘ä¸€å¤©å¤§æ¦‚ä¹Ÿèƒ½æœ‰ä¸¤ä¸‰ä¸ªå°æ—¶åœ¨å›¾ä¹¦é¦†ï¼Œä¸»è¦å°±æ˜¯åšä½œä¸šå’Œé¢„ä¹ å§ã€‚å½“ç„¶ï¼Œè‡ªä¹ ä¹Ÿä¸æ˜¯åªèƒ½åœ¨å®¿èˆå’Œå›¾ä¹¦é¦†ã€‚\næ•™å­¦æ¥¼ æ•™å­¦æ¥¼è™½ç„¶ä¸»è¦ç”¨æ¥ä¸Šè¯¾ï¼Œè‡ªç„¶ä¹Ÿæ˜¯è‡ªä¹ çš„å¥½åœ°æ–¹ã€‚\n æ‰€è°“å¤§å­¦è€…ï¼Œéæœ‰å¤§æ¥¼ä¹‹è°“ä¹Ÿï¼Œæœ‰å¤§å¸ˆä¹‹è°“ä¹Ÿã€‚\nâ€”â€”æ¢…è´»ç¦\n æ¢…è€æ ¡é•¿çš„è¯å¯¹ï¼Œä½†æ‹¥æœ‰ä¸–ç•Œä¸€æµå¤§æ¥¼ä¹Ÿæ˜¯æˆä¸ºä¸–ç•Œä¸€æµå¤§å­¦çš„å¿…è¦æ¡ä»¶ã€‚\næ¸…åçš„å…¬å…±æ•™å­¦æ¥¼æœ‰å…­åº§ï¼šç¬¬ä¸€è‡³ç¬¬äº”æ•™å®¤æ¥¼ï¼Œç¬¬å…­æ•™å­¦æ¥¼ã€‚ç°åœ¨ï¼ŒäºŒæ•™å’Œä¸‰æ•™æ­£åœ¨ç¿»æ–°/ç»´ä¿®ï¼Œæˆ‘è¿˜æ²¡æœ‰æœºä¼šä½¿ç”¨ã€‚å››æ•™éƒ½æ˜¯å°æ•™å®¤ï¼Œå¤§ä¸€çš„å¤§è¯¾å¾ˆå°‘æœ‰æœºä¼šç”¨åˆ°ï¼›ä¸€æ•™æœ‰å‡ ä¸ª200äºº+çš„æ•™å®¤ï¼Œå¯ä»¥å¼€æ€ä¿®ç­‰å…¨æ ¡å¤§è¯¾ï¼›äº”æ•™å‡ ä¹å…¨æ˜¯180äººå·¦å³çš„æ•™å®¤ï¼Œæ‰€ä»¥æˆ‘çš„è®¸å¤šæ•°å­¦è¯¾éƒ½æ”¾åœ¨è¿™é‡Œã€‚è€Œå…­æ•™ï¼Œæ—¢æœ‰200äººå·¦å³çš„å¤§æ•™å®¤ï¼Œä¹Ÿæœ‰80äººçš„ä¸­ç­‰æ•™å®¤ï¼Œè¿˜æœ‰40äººåŠä»¥ä¸‹çš„å°æ•™å®¤ï¼Œæ•™å®¤æ•°é‡å¤šã€ç±»å‹é½ï¼Œæ‰€ä»¥è‡ªç„¶å°±æˆä¸ºæˆ‘æœ€å¸¸æ´»åŠ¨çš„åœ°æ–¹ã€‚çº¿ä»£ã€å†™æ²Ÿã€å†›ç†ã€å…šè¯¾ï¼Œä¸å°‘è¯¾éƒ½æ˜¯åœ¨è¿™é‡Œä¸Šçš„ã€‚\nå½“ç„¶ï¼ŒæŸäº›ç³»çš„ç³»é¦†å’Œä¸€äº›å…¶ä»–çš„å»ºç­‘ä¹Ÿä¼šå½“åšæ•™å­¦æ¥¼æ¥ç”¨ï¼Œæ¯”å¦‚æŠ€ç§‘æ¥¼ã€æ˜ç†æ¥¼ï¼Œå› ä¸ºæœ‰å¤§æ•™å®¤è€Œæˆä¸ºæŸäº›å¤§è¯¾çš„ä¸Šè¯¾åœ°ç‚¹ï¼›è€Œå¤è‰²å¤é¦™çš„æ¸…åå­¦å ‚å´ä¸çŸ¥é“ä¸ºä»€ä¹ˆæˆä¸ºäº†æˆ‘ä»¬æŸèŠ‚æ™šè¯¾çš„åœ°ç‚¹ã€‚\næˆ‘æœ€å–œæ¬¢å…­æ•™ã€‚æˆ‘ä¸€å¹´å‰æ¥åˆ°æ¸…åï¼Œæ—©å·²è¯´è¿‡äº†ã€‚å…­æ•™ç»™äººä¸€ç§ç£…ç¤´è€Œç²¾å·§çš„æ„Ÿå—ï¼šè§„æ¨¡å®å¤§ï¼ŒBåŒºæœ€é«˜æœ‰9å±‚ï¼Œ6C300çš„æ•™å®¤æœ‰250äºº+çš„è§„æ¨¡ï¼›è®¾è®¡å·§å¦™ï¼ŒCåº§ä¸åŒçš„å±‚é«˜è®¾è®¡ç»™äº†é˜¶æ¢¯æ•™å®¤ä»¥æ›´å¤§çš„è‡ªç”±åº¦ï¼ŒAåŒºä¸‰é—´ç›¸é‚»çš„é˜¶æ¢¯æ•™å®¤ï¼Œé‡‡å…‰å´è‡ªç„¶è€Œå……è¶³ï¼ŒABåº§ä»ä¸€å±‚åˆ°é¡¶çš„ç©ºé—´ï¼Œæœ‰åŠ©äºè¾¨åˆ«ç©ºé—´æ–¹ä½ï¼Œä¹Ÿèƒ½å¤Ÿå‡å°‘å±‚é«˜çš„å‹æŠ‘ã€‚\næœ‰ä¸€è¯´ä¸€ï¼Œå¾ˆå¤šå­¦æ ¡åªè¦æœ‰è¿™ä¹ˆä¸€æ ‹æ•™å­¦æ¥¼ï¼Œæ•´ä¸ªå­¦æ ¡çš„æ•™å­¦éœ€æ±‚åŸºæœ¬ä¸Šéƒ½å¯ä»¥æ»¡è¶³äº†ã€‚\nä½†æ¸…åè¿˜æœ‰ä¸€äºŒä¸‰å››äº”æ•™ã€‚\næˆ‘æ°¸è¿œå–œæ¬¢å…­æ•™ï¼ï¼ˆè‡³å°‘åœ¨ä¸‰æ•™ä¿®å¥½ä¹‹å‰ï¼ï¼‰\n   å…­æ•™AåŒºçš„ä»°æœ› å…­æ•™CåŒºçš„è¿œæœ›          ä½ æ¸…çš„æ•™å­¦æ¥¼ï¼Œè£…å¤‡é½å…¨ã€‚é™¤äº†åŸºæœ¬çš„è®¾æ–½ï¼Œæœ‰å’–å•¡æœºï¼Œæœ‰æ‰“å°æœºï¼Œæœ‰è‡ªåŠ¨å”®è´§æœºï¼Œè¿˜æœ‰è£…æ»¡äº†äººæ°‘æ—¥æŠ¥å’Œå…‰æ˜æ—¥æŠ¥çš„æ¶å­ï¼è¦è¯´ä¸æ»¡æ„çš„ï¼Œæ¤…å­ç¡®å®ä¸å¤ªèˆ’æœï¼Œå½“ç„¶ä¹Ÿå¯èƒ½æ˜¯æˆ‘çš„è…°ä¸å¤ªè¡Œå§ã€‚\nåœ¨æ•™å­¦æ¥¼ä¸Šå®ŒåŠå¤©çš„è¯¾ï¼Œæ¥ä¸‹æ¥é™¤äº†å»å›¾ä¹¦é¦†å’Œå›å®¿èˆï¼Œä¸€èˆ¬å°±æ˜¯å»é£Ÿå ‚åƒé¥­äº†ã€‚\nã€ä¸Šæ¬¡æ›´æ–°20201026ã€‘\nã€åŠ¨æ€æ›´æ–°.jpgã€‘\nã€è¦æ˜¯cqqå¿˜è®°/æ‡’å¾—æ›´æ–°äº†è®°å¾—å‚¬ä»–ï¼ï¼ã€‘\n","description":"","id":3,"section":"posts","tags":null,"title":"First Days in THU","uri":"https://blog.chenqiqian.com/posts/thudays/"},{"content":" çœ‹æ˜¨å¤©çš„æˆ‘ä»¬èµ°è¿œäº† åœ¨å‘½è¿å¹¿åœºä¸­å¤®ç­‰å¾…\né‚£æ¨¡ç³Šçš„è‚©è†€ è¶Šå¥”è·‘è¶Šæ¸ºå°\næ›¾ç»å¹¶è‚©å¾€å‰çš„ä¼™ä¼´ åœ¨ä¸¾æ¯ç¥ç¦åéƒ½èµ°æ•£\nåªæ˜¯é‚£ä¸ªå¤œæ™š æˆ‘æ·±æ·±çš„éƒ½ç•™è—åœ¨å¿ƒå\n  å‡Œæ™¨å››ç‚¹çš„é¦–éƒ½å›½é™…æœºåœºï¼Œå¯‚å¯¥ä¸”å­¤å•ã€‚å‘åŠ¨æœºçš„è½°é¸£ä¼¼ä¹è¿˜åœ¨èº«åå›å“ï¼Œè®¸å¤šå¤§å°é£æœºåœ¨åœæœºåªä¸Šä¸€æ¶æ¶æ•´é½çš„åœæ”¾ã€‚\nå½“æ¯ä¸ªäººéƒ½æ‹¿åˆ°è¡Œæï¼Œæ²¿ç€ç¬”ç›´è€Œæ¼«é•¿çš„æ­¥é“èµ°å‘åœè½¦åœºï¼›å½“æˆ‘èµ°å‘å‚ç›´ç”µæ¢¯ï¼Œæ‰€æœ‰åŒè¡Œçš„åŒå­¦éƒ½ä»è§†é‡é‡Œæ¶ˆå¤±ï¼›å½“æˆ‘åä¸Šè½¦çš„ååº§ï¼ŒåŠªåŠ›å››æœ›å´åªçœ‹åˆ°é’¢é“å’Œæ°´æ³¥é—ªç€å†°å†·çš„å…‰ã€‚\næˆ‘äºæ˜¯æ„è¯†åˆ°ï¼šæˆ‘çš„é«˜ä¸­ç”Ÿæ´»ï¼Œåœ¨è¿™é‡Œå†™ä¸‹äº†æœ€åçš„å­—ç¬¦ã€‚\nå…«å¤©æ¥ï¼Œæˆ‘ä¸è¿™å‡ ä½åŒå­¦ä¸€èµ·ä¹˜åäº†å…«ä¸ªå°æ—¶çš„é£æœºï¼Œå…­ä¸ªå°æ—¶çš„é«˜é“ï¼Œè·¨è¿‡å¤§åŠä¸ªä¸­å›½ï¼Œåªæ˜¯ä¸ºäº†ï¼šèƒ½å¤Ÿå†æ²‰æµ¸åœ¨é«˜ä¸­çš„æ°›å›´ä¸­ï¼Œå“ªæ€•åªæ˜¯å†å¤šä¸€å¤©ã€‚åªè¦è¿™äº›ç†Ÿæ‚‰çš„èº«å½±è¿˜åœ¨æˆ‘çš„èº«è¾¹ï¼Œæˆ‘çš„é«˜ä¸­æ—¶å…‰ä»¿ä½›ä¹Ÿå°±è¿˜åœ¨æˆ‘çš„å¿ƒé‡Œï¼Œåœ¨æˆ‘çš„é¢å‰ã€‚\næ˜¯å•Šã€‚åœ¨è¿™äº›å¯çˆ±çš„åŒå­¦èº«è¾¹ï¼Œæˆ‘æ‹¥æœ‰åå…«å¹´æ¥æœ€å……å®ä¸å¹¸ç¦çš„äººç”Ÿã€‚\næˆ‘ä¸ç”¨å°å¿ƒåœ°æ©é¥°è‡ªå·±çš„è„†å¼±å’Œç–²å€¦ï¼Œæˆ‘ä¸ç”¨ç´§å¼ åœ°çº¦æŸè‡ªå·±ç¬¦åˆä¸–ä¿—çš„æ¯æ¡è§„åˆ™ï¼Œæˆ‘å¯ä»¥è¡¨éœ²æˆ‘çœŸå®çš„æ„Ÿæƒ…ï¼Œæˆ‘å¯ä»¥æ¸¸ç¦»äºé™ˆè§„æ—§ä¿—ä¹‹å¤–ã€‚æˆ‘è¯´ï¼Œæˆ‘é»˜ï¼Œæˆ‘ç¬‘ï¼Œæˆ‘å“­ï¼Œæˆ‘çˆ±ï¼Œæˆ‘æ¨ã€‚æˆ‘å¯ä»¥æ´»å‡ºæˆ‘çš„è‡ªæˆ‘ã€‚\næˆ‘ä»¬è°ˆç¬‘ï¼Œæˆ‘ä»¬ç¢°æ¯ï¼›æˆ‘ä»¬æ”€ç™»ï¼Œæˆ‘ä»¬æ¼«æ­¥ã€‚æˆ‘ä»¬ä¸€èµ·çœ‹æ˜Ÿè¾°ä¸å¤§æµ·ï¼Œæˆ‘ä»¬ä¸€èµ·å”±å‡ºå†…å¿ƒçš„æƒ…æ€ï¼›æˆ‘ä»¬æ„Ÿå—æ¸©æš–çš„äººæƒ…ä¸çˆ±ï¼Œæˆ‘ä»¬äº¤æµå¯¹ä¸–ç•Œçš„è®¤è¯†å’Œçœ‹æ³•ã€‚\nè¿™æ˜¯é’å¹´äººçš„ç”ŸåŠ›ï¼Œè¿™æ˜¯ç‹¬å±äºæˆ‘ä»¬è¿™äº›é’å¹´äººçš„ç”ŸåŠ›ã€‚\næ„Ÿè°¢ã€‚\nè€Œè¿™æ ·çš„æ—¥å­å·²ç»ç»“æŸï¼Œæˆ‘ä»¬è¦æ¸è¡Œæ¸è¿œäº†ã€‚æœ‰è®¸å¤šæƒ³è¯´çš„è¯æ²¡æœ‰è¯´ï¼Œæœ‰è®¸å¤šæƒ³åšçš„äº‹æ²¡æœ‰åšã€‚è€Œæˆ‘ä»¬è¦æ¸è¡Œæ¸è¿œäº†ã€‚\næˆ‘æƒ³ç•™ä½æˆ‘çš„é«˜ä¸­æ—¶å…‰å’Œé«˜ä¸­åŒå­¦ï¼Œå¯æˆ‘ä»¬ä»ç„¶å°†è¦ä¸”å¿…ç„¶è¦ç¦»åˆ«ã€‚äººä»æ¥éƒ½ä¸æ˜¯å¯¹ç¦»åˆ«ä¼¤æ‚²ï¼Œè€Œæ˜¯å¯¹äºè‡ªå·±çš„æ— åŠ›è€Œä¼¤æ‚²ã€‚æˆ‘ä»¬å°†è¦ä¸”å¿…ç„¶è¦å„å¥”ä¸œè¥¿ï¼Œè¸ä¸Šä¸åŒçš„åœŸåœ°ï¼Œè¿›å…¥ä¸åŒçš„å­¦æ ¡ï¼Œè®¤è¯†ä¸åŒçš„äººï¼Œè¿›å…¥ä¸åŒçš„åœˆå­ã€‚è¿™ä¹‹åï¼Œæˆ‘å°†ä¸å¤šå°‘äººå‡ å¹´éƒ½å†è§ä¸äº†ä¸€é¢ï¼Ÿä¸å¤šå°‘äººå‡ å¹´éƒ½å†è¯´ä¸äº†ä¸€è¨€ï¼Ÿä¸å¤šå°‘æ›¾ç»çš„æœ‹å‹ï¼Œä¸å¤šå°‘æ›¾ç»å¹¶è‚©ç«™ç«‹ã€å¹¶è‚©è¡Œèµ°ã€å¹¶è‚©æ­Œå”±ã€å¹¶è‚©æˆ˜æ–—è¿‡çš„äººåœ¨è¿™é‡Œåˆ†ç¦»ï¼Œæ¸æ¸æˆä¸ºå½¼æ­¤çš„è·¯äººï¼Ÿæˆ‘è™½ç„¶æƒ³ç»§ç»­æ‹¥æŠ±æˆ‘çš„åŒå­¦ä»¬ï¼Œä½†è¿™äº›åˆæœ‰ä»€ä¹ˆèƒ½å¤Ÿä»¥æˆ‘çš„æ„å¿—ä¸ºè½¬ç§»å‘¢ï¼Ÿå°±ç®—æœ‰ï¼Œæˆ‘åˆè¯¥æ€ä¹ˆåšå‘¢\u0026hellip;\u0026hellip;\né—æ†¾ã€‚\næˆ‘èƒ½åšçš„ï¼Œå¤§æ¦‚å°±åªæœ‰æŠŠè¿™æ®µæ—¶å…‰å°å¿ƒç¿¼ç¿¼åœ°æ‰“ä¸Šå°æ¡ï¼Œæ•´é½åœ°æ”¾åœ¨è®°å¿†æ·±å¤„é‚£éšç§˜çš„è§’è½ï¼Œå°±åƒä¹‹å‰çš„åäº”å¹´æ—¶å…‰ä¸€æ ·ã€‚æ¯•ç«Ÿï¼Œå›å¿†è¶Šæ˜¯ç”œç¾ä¾¿è¶Šä½¿äººä¼¤æ€€äº†ã€‚\nè½¦åœ¨é«˜é€Ÿè·¯ä¸Šé£å¿«å¥”é©°ï¼Œé›¾è’™è’™çš„å¤©é™…éšçº¦å·²ç»å‘äº®ã€‚åœ¨æœºåœºè¿˜æ˜¾å¾—å……æ²›çš„ç²¾åŠ›å¥½åƒä¸€ä¸‹å­è¢«æŠ½ç¦»èº«ä½“ï¼Œçª—å¤–çš„åœŸåœ°å’Œå»ºç­‘åœ¨è§†é‡é‡Œæ¸æ¸æ¨¡ç³Šã€‚\né«˜ä¸­çœŸæ­£çš„æœ€åä¸€å¤©ï¼Œç»“æŸäº†ã€‚\n æˆ‘åªæƒ³è¦æ‹‰ä½æµå¹´\nå¥½å¥½åœ°è¯´å£°å†è§\né—æ†¾æ„Ÿè°¢éƒ½å›ä¸å»æ˜¨å¤©\n","description":"","id":4,"section":"posts","tags":null,"title":"ã€Œéšç¬”ã€æ¯•ä¸šæ¸¸åè®°","uri":"https://blog.chenqiqian.com/posts/trip-graduation-short/"},{"content":"å…³äºæœ€å¤§å…¬çº¦æ•°çš„æ¬§å‡ é‡Œå¾—ç®—æ³•åŠå…¶æ‹“å±•ã€‚\nå‰ç½®çŸ¥è¯† æ•´é™¤ å®šä¹‰ å¯¹äº $a,b \\in \\mathbb Z$ ï¼Œè‹¥å­˜åœ¨ $q\\in \\mathbb Z$ ä½¿ $a = qb$ æˆç«‹ï¼Œåˆ™ç§° $b$ æ•´é™¤ $a$ æˆ– $a$ è¢« $b$ æ•´é™¤ï¼Œè®°ä½œ $b\\mid a$ ã€‚\næˆ‘ä»¬ç§° $b$ æ˜¯ $a$ çš„å› æ•°ï¼Œ $a$ æ˜¯ $b$ çš„å€æ•°ã€‚\nå¦åˆ™ï¼Œæˆ‘ä»¬ç§° $b$ ä¸æ•´é™¤ $a$ æˆ– $a$ ä¸è¢« $b$ æ•´é™¤ï¼Œè®°ä½œ $b\\nmid a$ ã€‚\næ€§è´¨  $c\\mid b,b\\mid a \\implies c \\mid a$ $x,y \\in \\mathbb Z, m|a,m|b \\implies m|(ax+by)$  å¸¦ä½™æ•°é™¤æ³• å®šä¹‰ è‹¥ $a,b\\in \\mathbb Z,b\u0026gt;0$ ï¼Œåˆ™å­˜åœ¨å”¯ä¸€çš„ $q,r\\in \\mathbb Z$ ï¼Œä½¿\n$$\na = bq+r,0\\leq r \u0026lt; b\n$$\nè¿™é‡Œçš„ $q$ ç§°ä½œä¸å®Œå…¨å•†ï¼Œ $r$ ç§°ä¸ºä½™æ•°ã€‚\nå–æ•´ å®šä¹‰ $\\lfloor x \\rfloor$ å’Œ $\\lceil x \\rceil$ åˆ†åˆ«ä»£è¡¨å‘ä¸‹å’Œå‘ä¸Šå–æ•´ã€‚\næ€§è´¨  åœ¨å¸¦ä½™é™¤æ³•ä¸­ï¼Œ$q = \\lfloor \\frac{a}{b} \\rfloor$. è‹¥$n\\in \\mathbb Z$ï¼š$\\lfloor x + n \\rfloor = \\lfloor x \\rfloor + n$ $\\lceil x \\rceil = âˆ’ \\lfloor âˆ’x \\rfloor , âˆ’ \\lfloor x\\rfloor = âˆ’ \\lceil âˆ’x \\rceil$ $\\lceil \\frac{n}{m} \\rceil = \\lfloor \\frac{n+m-1}{m} \\rfloor$ $round(x) = \\lfloor x+0.5\\rfloor$ $\\lfloor\\frac{\\lfloor x \\rfloor}{n}\\rfloor = \\lfloor \\frac{x}{n}\\rfloor$ $\\lfloor\\frac{n}{\\lfloor x \\rfloor}\\rfloor \\neq \\lfloor \\frac{n}{x}\\rfloor$ $\\lfloor \\sqrt{x}\\rfloor = \\lfloor \\sqrt{\\lfloor x \\rfloor} \\rfloor$ $\\lfloor \\frac{n}{ab} \\rfloor = \\lfloor \\frac{\\lfloor \\frac{n}{a} \\rfloor }{b} \\rfloor$  æœ€å¤§å…¬çº¦æ•°$\\gcd$ï¼ˆgreatest common divisorï¼‰ å®šä¹‰ æœ€å¤§å…¬çº¦æ•°ï¼Œå³ç»™å®šä¸¤ä¸ªæ•´æ•° $a,b$ ï¼Œæ±‚æœ€å¤§çš„æ­£æ•´æ•° $w$ï¼Œæ»¡è¶³ $w$ æ•´é™¤ $a$ ä¸” $w$ æ•´é™¤ $b$ ( $w|a$ ä¸” $w|b$ ).è®°ä½œ $\\gcd(a,b) = w$ .\nå®šä¹‰$gcd(0,0) = 0$ã€‚\nä¸€äº›æ€§è´¨  $gcd(a,0) = |a|$ $gcd(a,ka) = |a|,,k \\in \\mathbb Z$ $gcd(a,b) = gcd(b,a)$ $gcd(a,b) = gcd(a,-b)$ $gcd(a,gcd(b,c)) = gcd(gcd(a,b),c)$ åœ¨ $(0,0)$ åˆ° $(a,b)$ï¼ˆ $a,b \\in \\mathbb Z$ ï¼‰çš„çº¿æ®µä¸Šï¼Œæœ‰ $gcd(a,b)+1$ ä¸ªæ•´ç‚¹ï¼ˆåŒ…æ‹¬ä¸¤ç«¯ç‚¹ï¼‰  æ±‚æ³• è¾—è½¬ç›¸é™¤æ³•ã€‚\nå…¶æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªé€’å½’ç®—æ³•ï¼Œé€šè¿‡ä¸æ–­é€’å½’çš„æ–¹å¼è®¡ç®—è¿™ä¸¤ä¸ªæ•°çš„æœ€å¤§å…¬çº¦æ•°ã€‚\nè¿‡ç¨‹ï¼š$gcd(a,b) = gcd(b,a \\bmod b)$\nè¾¹ç•Œï¼š$gcd(a,0) = a$\nè¯æ˜ ï¼ˆæœ‰é™æ€§ï¼‰\nä»¤ $k$ è¡¨ç¤ºæˆ‘ä»¬è®¡ç®—çš„æ­¥éª¤æ•°ï¼ˆä» $0$ å¼€å§‹è®¡æ•°ï¼‰ã€‚\næ¯ä¸€æ­¥çš„è¾“å…¥æ˜¯éƒ½æ˜¯å‰ä¸¤æ¬¡è®¡ç®—çš„éè´Ÿä½™æ•° $r_{kâˆ’1}$ å’Œ $r_{kâˆ’2}$ ã€‚\nå› ä¸ºä½™æ•°è‚¯å®šå°äºé™¤æ•°ï¼Œæ‰€ä»¥ $r_{kâˆ’1}$ å°äº $r_{kâˆ’2}$ ã€‚åœ¨ç¬¬ $k$ æ­¥ä¸­ï¼Œç®—æ³•è®¡ç®—å‡ºæ»¡è¶³ä»¥ä¸‹ç­‰å¼çš„å•† $q_k$ å’Œä½™æ•° $r_k$ ï¼š\n$$\nr_{kâˆ’2} = q_{k} \\times r_{kâˆ’1} + r_k,; \\text{å…¶ä¸­}0\\leq r_k\u0026lt;r_{k-1}\n$$\næ­¤æ—¶ï¼Œ$r_{k-1}$ å’Œ $r_k$ å°±æ˜¯ä¸‹ä¸€æ¬¡é€’å½’çš„è¾“å…¥ã€‚\nå¦‚æœæŠŠæ‰€æœ‰å¼å­éƒ½åˆ—å‡ºæ¥ï¼Œå°±ä¼šæ˜¯è¿™ä¸ªæ ·å­ï¼š\n$$\n\\begin{aligned}{}\na =\u0026amp; q_0 \\times b + r_0\\\nb =\u0026amp; q_1 \\times r_0 + r_1\\\nr_0 =\u0026amp; q_2 \\times r_1 + r_2\\\nr_1 =\u0026amp; q_3 \\times r_2 + r_3\\\n\u0026hellip;\\\nr_{n-2} =\u0026amp; q_n \\times r_{n-1} + r_n\\\n\\end{aligned}\n$$\nè¿™é‡Œçš„ $a,b$ çš„å¤§å°åœ¨ç¬¬ä¸€æ¬¡é™¤æ³•çš„æ—¶å€™å°±ä¼šè°ƒèŠ‚ï¼Œæ‰€ä»¥ä¸å¿…å…³å¿ƒï¼Œä¸å¦¨è®¾ $a\u0026gt;b$ ã€‚\næ³¨æ„åˆ° $a \u0026gt; b \u0026gt; r_1 \u0026gt; r_2 \u0026gt; r_3 \u0026gt; r_4\u0026hellip; \u0026gt; r_n \u0026gt;=0$ ï¼Œæ‰€ä»¥ä¸€å®šèƒ½åœ¨ $n$ æ¬¡é€’å½’è¿‡åä½¿å¾—é€’å½’åˆ°è¾¹ç•Œæƒ…å½¢ï¼Œå³ $r_n = 0$ ã€‚\næ­¤æ—¶ $r_{n-1}$ å°±æ˜¯æˆ‘ä»¬æ±‚å¾—çš„ $\\gcd(a,b)$ ã€‚\nï¼ˆæ­£ç¡®æ€§ï¼‰\nè®¾ $\\gcd(a,b) = g$ ï¼Œæˆ‘ä»¬éœ€è¦è¯æ˜ $r_{n-1} = g$ ã€‚\nç¬¬ä¸€æ­¥ï¼š\nå› ä¸º $r_n = 0$ ï¼Œåˆ $r_{n-2} = q_n \\times r_{n-1} + r_n$ ï¼Œæ‰€ä»¥ $r_{n-2}$ æ˜¯ $r_{n-1}$ çš„æ•´æ•°å€ã€‚ $r_{n-3}$ ç”±æ•´æ•°å€çš„ $r_{n-2}$ å’Œä¸€ä¸ª $r_{n-1}$ æ„æˆï¼Œæ‰€ä»¥ $r_{n-3}$ æ˜¯ $r_{n-1}$ çš„æ•´æ•°å€ã€‚åŒç†å¯å¾— $a,b$ éƒ½æ˜¯ $r_{n-1}$ çš„æ•´æ•°å€ã€‚\næ‰€ä»¥ $r_{n-1}$ å°±æ˜¯ $a,b$ çš„å…¬å› æ•°ï¼Œåˆ $g$ æ˜¯ $a,b$ çš„æœ€å¤§å…¬å› æ•°ï¼Œæ‰€ä»¥ $g \\geq r_{n-1}$ ã€‚\nç¬¬äºŒæ­¥ï¼š\nå› ä¸º $g = gcd(a,b)$ ï¼Œä»¤ $a = mg,b = ng$ ï¼Œå…¶ä¸­ $n,m$ å‡ä¸ºè‡ªç„¶æ•°ã€‚\nå› ä¸º $a = q_0 \\times b + r_0$ ï¼Œæ‰€ä»¥ $r_0 = (m - q_0 \\times n)g$ ï¼Œå³ $g$ ä¹Ÿä¸º $r_0$ çš„å› æ•°ã€‚åŒç†ä¸‹å»å°±å¯ä»¥å¾—åˆ° $g$ æ•´é™¤ $r_0,r_1,r_2,\u0026hellip;,r_{n-1}$ ã€‚æ‰€ä»¥ $g \\leq r_{n-1}$ ã€‚\nç»¼ä¸Šå¯å¾—ï¼š $g = r_{n-1}$ ã€‚\næ‰€ä»¥ï¼Œè¾—è½¬ç›¸é™¤æ³•çš„æ­£ç¡®æ€§å¯ä»¥å¦‚ä¸Šè¯æ˜ã€‚\nå®ç° ç›´æ¥æŒ‰ç…§æ€è·¯å®ç°å³å¯ï¼š\n1 2 3 4  template\u0026lt;typename T\u0026gt; T gcd(T a,T b){ return b==0?a:gcd(b,a%b); }   æ—¶é—´å¤æ‚åº¦ $O(\\log n)$ ï¼Œè¯æ˜å‚è§ LamÃ©å®šç† ã€‚\næ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼ˆexgcdï¼‰ å®šä¹‰ æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼Œå³ç»™å®šä¸¤ä¸ªæ­£æ•´æ•° $a,b$ ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿ç”¨æ¬§å‡ é‡Œå¾—ç®—æ³•æ±‚å‡º $gcd(a,b)$ çš„åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ±‚å‡º $ax+by = gcd(a,b)$ çš„ä¸€ç»„æ•´æ•°è§£ $x_0,y_0$ ã€‚\nå…¶æ–¹ç¨‹æ‰€æœ‰è§£ä¸ºï¼š\n$$\n\\left{\n\\begin{aligned}{}\nx = x_0+\\frac{b}{gcd(a,b)}\\\ny = y_0-\\frac{a}{gcd(a,b)}\n\\end{aligned}\n\\right.\n$$\nä¸€ä¸ªç»“è®ºï¼š $ax+by$ çš„æœ€å°æ­£å€¼ $ax_0+by_0 = gcd(a,b)$\næ±‚æ³•\u0026amp;è¯æ˜ ç°åœ¨æˆ‘ä»¬è¦æ±‚ $ax+by = gcd(a,b)$ çš„ä¸€ç»„æ•´æ•°è§£ã€‚\nè€ƒè™‘åˆ°æ¬§å‡ é‡Œå¾—ç®—æ³•çš„å…¬å¼ $gcd(a,b) = gcd(b,a \\bmod b)$\nè‹¥æœ‰ä¸€ç»„ $x',y'$ ä½¿å¾— $bx'+ (a \\bmod b) y' = gcd(b,a \\bmod b)$\nè¿™ä¸ªæ—¶å€™æˆ‘ä»¬æ³¨æ„åˆ°å¯ä»¥ä»¤ $ax+by = bx'+ (a \\bmod b) y'$ .\nå› ä¸º $a \\bmod b = a-\\lfloor\\frac{a}{b}\\rfloor b$ ï¼Œæ‰€ä»¥ä¸Šå¼å¯ä»¥åŒ–ä¸º $ax+by = bx'+(a-\\lfloor\\frac{a}{b}\\rfloor b)y'$ .\nè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å·²ç»çŸ¥é“ $x',y',a,b$ ï¼ŒæœªçŸ¥æ•°æœ‰ $x,y$ ã€‚æ‰€ä»¥è¿™ä¸ªæ–¹ç¨‹äº‹å®ä¸Šæ˜¯è¦ä¹ˆæ— è§£è¦ä¹ˆæ— æ•°ä¸ªè§£ã€‚è€Œæˆ‘ä»¬è¿™é‡Œåªéœ€è¦ä¸€ä¸ªç‰¹è§£ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠä¸Šå¼æ•´ç†æˆä¸ºå…³äº $a,b$ çš„æ’æˆç«‹å¼å­ï¼Œå°±å¯ä»¥é€šè¿‡ $x',y'$ è§£å‡º $x,y$ ã€‚æ•´ç†å¾—\n$$\na(x)+b(y) = a(y') + b(x'-\\lfloor\\frac{a}{b}\\rfloor y')\n$$\nå¯ä»¥å¾—åˆ°ä¸€ç»„ç‰¹è§£ï¼š$x = y',y = x'-\\lfloor\\frac{a}{b}\\rfloor y'$ã€‚æ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥é€’å½’æ±‚è§£ã€‚\nç²¾ç®€ç‰ˆè¿‡ç¨‹ï¼š\nä»¤ $\\text{exgcd}(a,b)$ ä¸º $ax+by = gcd(a,b)$ çš„è§£ $(x,y)$ ã€‚\nå¯¹äº $\\text{exgcd}(a,b)$ ï¼Œé€’å½’æ±‚å¾— $exgcd(b,a \\bmod b)$ çš„è§£ $(x',y')$ ã€‚\nåˆ™ $exgcd(a,b) = (y', x'-\\lfloor\\frac{a}{b}\\rfloor y')$ ã€‚\nè¾¹ç•Œæƒ…å†µä¸º $b = 0$ æ—¶ï¼Œæ­¤æ—¶æ–¹ç¨‹å³ä¸º $ax + 0y = a$ ï¼Œè¿”å› $(1,0)$ å³å¯ã€‚\nä»£ç  1 2 3 4 5 6 7  template\u0026lt;typename T\u0026gt; T exgcd(T a,T b,T \u0026amp;x,T \u0026amp;y){ if (!b){x=1,y=0;return a;} T d = exgcd(b,a%b,y,x); y-=(a/b)*x; return d; }   åº”ç”¨   $ax+by=c$ ä¸å®šæ–¹ç¨‹\nå¯ä»¥è¯æ˜ï¼Œä»…å½“ $gcd(a,b)|c$ æ—¶ï¼Œè¯¥æ–¹ç¨‹æœ‰æ•´æ•°è§£ã€‚\nå…ˆç”¨æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•æ±‚å‡º $ax+by = gcd(a,b)$ çš„ä¸€ç»„æ•´æ•°è§£ï¼Œç„¶åå°†å¾—åˆ°çš„è§£å‡ä¹˜ä¸Š $\\frac{c}{gcd(a,b)}$ å³å¯ã€‚\n  $ax \\equiv c \\pmod b$ ä¸€æ¬¡åŒä½™æ–¹ç¨‹\nè½¬åŒ–ä¸º $ax + by = c$ çš„ä¸€ä¸ªé—®é¢˜ï¼Œå¯ä»¥å¾—å‡ºæœ‰è§£æ¡ä»¶å½“ä¸”ä»…å½“ $gcd(a,b)|c$ ã€‚è¿ç”¨ä¸Šé¢çš„æ–¹æ³•æ±‚è§£å³å¯ã€‚\n  ä¹˜æ³•é€†å…ƒï¼Œå°† $ax \\equiv 1 \\pmod p$ è½¬åŒ–æˆ $ax + py = 1$ è§£ä¸å®šæ–¹ç¨‹å³å¯ã€‚\n  ç±»æ¬§å‡ é‡Œå¾—ç®—æ³• ä¸€ç§ç”¨äºæ±‚è§£å½¢ä¼¼\n$$\n\\sum_{i = 0}^n{\\lfloor\\frac{ai+b}{c}\\rfloor}\n$$\nçš„é—®é¢˜çš„ç®—æ³•ã€‚\nè¿‡ç¨‹ é¦–å…ˆå¯¹ $a,b$ å…³äº $c$ å–æ¨¡ï¼Œä½¿å¾— $a,b\u0026lt;c$ ã€‚\nä»¤ $m = \\lfloor\\frac{an+b}{c}\\rfloor$ ã€‚\næ­¤æ—¶æœ‰ï¼š\n$$\n\\sum_{i = 0}^n{\\lfloor\\frac{ai+b}{c}\\rfloor} \\\n= \\sum_{j = 0}^{m-1}\\sum_{i = 0}^n[j \u0026lt; \\lfloor\\frac{ai+b}{c}\\rfloor]\\\n= \\sum_{j = 0}^{m-1}\\sum_{i = 0}^n[i \u0026gt; \\lfloor\\frac{cj+c-b-1}{a}\\rfloor]\\\n= \\sum_{j = 0}^{m-1}n - \\lfloor\\frac{cj+c-b-1}{a}\\rfloor\\\n= nm - \\sum_{j = 0}^{m-1}\\lfloor\\frac{cj+c-b-1}{a}\\rfloor\n$$\næ³¨æ„åˆ°è¿™ä¸ªæ—¶å€™ $a,b$ éƒ½æ˜¯å¯¹ $c$ å–æ¨¡çš„ï¼Œæ‰€ä»¥è¿™ä¸ªä¸œè¥¿å¾ˆåƒæ¬§å‡ é‡Œå¾—ç®—æ³•ï¼Œæ—¶é—´å¤æ‚åº¦å¤§çº¦ä¹Ÿæ˜¯ $O(\\log n)$ .\næ‰©å±• $$\n\\sum_{i = 0}^n{{\\lfloor\\frac{ai+b}{c}\\rfloor}^2}\\\n\\sum_{i = 0}^n{i{\\lfloor\\frac{ai+b}{c}\\rfloor}}\n$$\n","description":"","id":5,"section":"posts","tags":["æ•°å­¦","æ¬§å‡ é‡Œå¾—ç®—æ³•","æ¨¡æ¿","ç¬”è®°"],"title":"æ¬§å‡ é‡Œå¾—ç®—æ³•å­¦ä¹ ç¬”è®°","uri":"https://blog.chenqiqian.com/posts/notes-gcd/"},{"content":"å…³äºåŸºç¡€çš„å¤šé¡¹å¼æ¦‚å¿µåŠè®¡ç®—ã€‚\nå¤šé¡¹å¼ï¼ˆæ¦‚å¿µï¼‰ å®šä¹‰ ä¸€ä¸ªä»¥ $x$ ä¸ºå˜é‡çš„å¤šé¡¹å¼æ˜¯ä¸€ä¸ªå®šä¹‰åœ¨ä»£æ•°åŸŸ $F$ ä¸Šçš„ $A(x)$ ï¼Œå…¶å¯ä»¥è¡¨ç¤ºä¸ºï¼š\n$$\nA(x) = \\sum_{j=0}^{n-1} a_jx^j\n$$\nè¡¨ç¤º ç³»æ•°è¡¨ç¤ºæ³• åœ¨å¤šé¡¹å¼ $A(x)$ ä¸­ï¼Œæˆ‘ä»¬ç§° $\\overrightarrow{a} = (a_0,a_1,a_2,\u0026hellip;,a_{n-1})$ ä¸ºå¤šé¡¹å¼ $A(x)$ çš„ç³»æ•°å‘é‡ã€‚å…¶å³ä¸ºå¤šé¡¹å¼çš„ç³»æ•°è¡¨è¾¾ã€‚\nç‚¹å€¼è¡¨ç¤ºæ³• æˆ‘ä»¬æŠŠäº’ä¸ç›¸åŒçš„ $x_0,x_1,\u0026hellip;,x_{n-1}$ ä½œä¸º $x$ ä»£å…¥å¤šé¡¹å¼ï¼Œå¾—åˆ° $y_j = A(x_j)$ ï¼Œæ­¤æ—¶æˆ‘ä»¬ç§° ${(x_0,y_0),(x_1,y_1),\u0026hellip;,(x_{n-1},y_{n-1})}$ ä¸ºå¤šé¡¹å¼ $A(x)$ çš„ç‚¹å€¼è¡¨è¾¾ã€‚å…¶ä¸­æ‰€æœ‰çš„ $x_j$ éƒ½äº’ä¸ç›¸åŒã€‚\nå”¯ä¸€æ€§ å¯¹äº $n$ ä¸ªç‚¹å€¼å¯¹ç»„æˆçš„é›†åˆ ${(x_0,y_0),(x_1,y_1),\u0026hellip;,(x_{n-1},y_{n-1})}$ ï¼Œå¯ä»¥ç¡®å®šå”¯ä¸€çš„ç³»æ•°è¡¨ç¤ºæ³• $\\overrightarrow{a}$ ã€‚è¿™ä¸ªè¿‡ç¨‹åˆè¢«ç§°ä¸º**æ’å€¼**ã€‚\nè¯¦è§ï¼šæ‹‰æ ¼æœ—æ—¥æ’å€¼æ³•ã€‚\nè¿ç®— ç³»æ•°è¡¨ç¤ºä¸‹ ä¸¤ä¸ªå¤šé¡¹å¼ $A(x)$ å’Œ $B(x)$ï¼Œ $A$ å’Œ $B$ çš„ç³»æ•°è¡¨ç¤ºåˆ†åˆ«ä¸ºï¼š\n$$\nA(x) = \\sum_{j=0}^{n-1} a_jx^j,\\quad\nB(x) = \\sum_{j=0}^{n-1} b_jx^j\n$$\nåŠ æ³• è‹¥ $C(x) = A(x) + B(x)$ ï¼Œé‚£ä¹ˆ $C(x)$ çš„ç³»æ•°è¡¨ç¤ºå°±å¯ä»¥å†™ä½œï¼š\n$$C(x) = \\sum_{j=0}^{n-1} (a_j+b_j) x^j$$\nä¹˜æ³• è‹¥ $C(x) = A(x)B(x)$ ï¼Œé‚£ä¹ˆ $C(x)$ çš„ç³»æ•°è¡¨ç¤ºå°±å¯ä»¥å†™ä½œï¼š\n$$C(x) = \\sum_{j = 0}^{2n-2}c_j x^j$$\nå…¶ä¸­ï¼š\n$$c_j = \\sum_{k = 0}^{j} a_k b_{j-k}$$\nç‚¹å€¼è¡¨ç¤ºä¸‹ è®¾ $A$ çš„ç‚¹å€¼è¡¨è¾¾ä¸º ${(x_0,y_0),(x_1,y_1),\u0026hellip;,(x_{n-1},y_{n-1})}$ ï¼Œ $B$ çš„ç‚¹å€¼è¡¨è¾¾ä¸º ${(x_0,y_0â€˜),(x_1,y_1â€™),\u0026hellip;,(x_{n-1},y_{n-1}â€˜)}$ ã€‚\nåŠ æ³• è‹¥ $C(x) = A(x) + B(x)$ ,é‚£ä¹ˆ $C(x)$ çš„ç‚¹å€¼çš„è¡¨è¾¾å°±å¯ä»¥å†™ä½œï¼š\n$${(x_0,y_0+y_0'),(x_1,y_1+y_1'),\u0026hellip;,(x_{n-1},y_{n-1}+y_{n-1}')}$$\nä¹˜æ³• è¿™é‡Œå› ä¸ºæœ€åä¹˜å¾—çš„æ˜¯ä¸€ä¸ªæ¬¡æ•°ç•Œä¸º $2n$ çš„å¤šé¡¹å¼ï¼Œè¿™é‡Œ $A$ å’Œ $B$ çš„ç‚¹å€¼å°±éƒ½å¾—æœ‰ $2n$ å¯¹ã€‚\nè‹¥ $C(x) = A(x)B(x)$ ï¼Œé‚£ä¹ˆ $C(x)$ çš„ç‚¹å€¼çš„è¡¨è¾¾å°±å¯ä»¥å†™ä½œï¼š\n$${(x_0,y_0y_0'),(x_1,y_1y_1'),\u0026hellip;,(x_{2n-1},y_{2n-1}y_{2n-1}')}$$\nå¯ä»¥å‘ç°ï¼Œç‚¹å€¼è¡¨ç¤ºåœ¨å¤šé¡¹å¼çš„è¿ç®—æ–¹é¢æ˜æ˜¾å…·æœ‰é€Ÿåº¦ä¸Šçš„ä¼˜åŠ¿ã€‚\nå¤šé¡¹å¼ä¹˜æ³•ï¼ˆå¿«é€Ÿå‚…ç«‹å¶å˜æ¢ï¼‰ å®šä¹‰ å¿«é€Ÿå‚…é‡Œå¶å˜æ¢ï¼ˆFast Fourier Transform, FFTï¼‰æ˜¯ä¸€ç§å¯åœ¨ $O(n \\log n)$æ—¶é—´å†…å®Œæˆçš„ç¦»æ•£å‚…é‡Œå¶å˜æ¢ï¼ˆDiscrete Fourier Transform, DFTï¼‰ç®—æ³•ï¼Œåœ¨ OI ä¸­çš„ä¸»è¦åº”ç”¨ä¹‹ä¸€æ˜¯åŠ é€Ÿå¤šé¡¹å¼ä¹˜æ³•çš„è®¡ç®—ã€‚\nç¦»æ•£å‚…ç«‹å¶å˜æ¢ï¼Œåœ¨è¿™é‡Œå³æŒ‡å°†ä¸€ä¸ªå¤šé¡¹å¼çš„ç³»æ•°è¡¨ç¤ºæ³•è½¬åŒ–ä¸ºç‚¹å€¼è¡¨ç¤ºæ³•çš„è¿‡ç¨‹ã€‚\nå‰ç½®çŸ¥è¯†ï¼š  å¤æ•°  è¿‡ç¨‹ é¦–å…ˆå°†å¤šé¡¹å¼çš„æ¬¡æ•°ç•Œè¡¥è¶³æˆä¸º $2^n$ ï¼Œä»¥æ–¹ä¾¿åç»­çš„ç­–ç•¥ã€‚\nä¸‹æ–‡æåˆ°çš„ç‚¹å€¼å‘é‡é»˜è®¤ä¸ºåœ¨å•ä½æ ¹çš„ $0$ åˆ° $n-1$ æ¬¡å¹‚å¤„å–å¾—ã€‚\nä¸‹æ–‡æ‰€æœ‰çš„æ•°å‡é»˜è®¤åœ¨å¤æ•°åŸŸä¸­è®¨è®ºï¼ŒåŒ…æ‹¬ç³»æ•°ã€å¤šé¡¹å¼çš„å€¼ã€‚\næ·±åˆ»å»ºè®®è¯»è€…æ‹¿ç¬”å’Œçº¸æŠŠè¿™ä¸€éƒ¨åˆ†è‡ªå·±æ‰‹ç®—è¿›è¡ŒéªŒè¯ã€‚\nDFT è®¾å¤šé¡¹å¼ $A(x)$ ç³»æ•°è¡¨è¾¾ä¸ºï¼š\n$$\nA(x) = \\sum_{j = 0}^{n-1} a_jx^j\n$$\nå°† $n$ æ¬¡å•ä½æ ¹çš„ $0$ åˆ° $n - 1$ æ¬¡å¹‚ï¼Œå³ $\\omega _n^0,\\omega n^1,\u0026hellip;\\omega n^{n-1}$ ï¼Œå¸¦å…¥å¤šé¡¹å¼çš„ç³»æ•°è¡¨ç¤ºï¼Œæ‰€å¾—ç‚¹å€¼å‘é‡ $(y_0,y_1,\u0026hellip;,y{n-1})$ ç§°ä¸ºå…¶ç³»æ•°å‘é‡ $(a_0,a_1,\u0026hellip;,a{n-1})$ çš„ç¦»æ•£å‚…é‡Œå¶å˜æ¢ã€‚\næŒ‰ç…§æœ´ç´ ç®—æ³•æ±‚å¾— DFT ï¼Œåˆ™æ—¶é—´å¤æ‚åº¦ä¸º $O(n^2)$ ã€‚\næ”¹è¿›ï¼šFFT ç”±äºæˆ‘ä»¬è¦å¯¹é—®é¢˜è¿›è¡Œåˆ†æ²»å¤„ç†ï¼Œæ‰€ä»¥æˆ‘ä»¬æƒ³åŠæ³•å‡å°è¿™ä¸ªé—®é¢˜çš„è§„æ¨¡ã€‚\næˆ‘ä»¬æ ¹æ®æ¬¡æ•°å¥‡å¶å¯¹ $A(x)$ çš„æ‰€æœ‰é¡¹è¿›è¡Œåˆ†ç±»ã€‚å³ï¼š\n$$\nA(x) = (a_0 + a_2x^2 + \u0026hellip; + a_{n-2}x^{n-2}) + (a_1x + a_3x^3 + \u0026hellip; + a_{n-1}x^{n-1})\n$$\næ³¨æ„åˆ°æˆ‘ä»¬å¦‚æœä»¤ï¼š\n$$\nA_0(x) = (a_0 + a_2x + \u0026hellip; + a_{n-2}x^{\\frac{n}{2}-1})\\\nA_1(x) = (a_1 + a_3x + \u0026hellip; + a_{n-1}x^{\\frac{n}{2}-1})\n$$\né‚£ä¹ˆï¼š\n$$\nA(x) = A_0(x^2) + xA_1(x^2)\n$$\næ³¨æ„åˆ° $A_0$ å’Œ $A_1$ éƒ½æ˜¯ $A$ çš„å­é—®é¢˜ï¼Œæˆ‘ä»¬è¯•å›¾å‡å°æ•°æ®èŒƒå›´çš„åŒæ—¶å¿«é€Ÿçš„é€šè¿‡ $A_0$ å’Œ $A_1$ å¾—åˆ° $A$ ã€‚\nè‹¥ $k\u0026lt;\\frac{n}{2}$ ï¼ˆä¸ŠåŠåœˆï¼‰ï¼Œå°† $\\omega_{n}^{k}$ ä»£å…¥ä¸Šå¼å¾—ï¼š\n$$\n\\begin{aligned}{}\nA(\\omega_{n}^{k}) = \u0026amp; A_0(\\omega_{n}^{2k})+\\omega_{n}^{k}A_1(\\omega_{n}^{2k})\\\n= \u0026amp; A_0(\\omega_{\\frac{n}{2}}^{k})+\\omega_{n}^{k}A_1(\\omega_{\\frac{n}{2}}^{k})\n\\end{aligned}\n$$\nåŒç†å¯å¾—ï¼ˆä¸‹åŠåœˆçš„ï¼‰ï¼š\n$$\nA(\\omega_{n}^{k+\\frac{n}{2}}) = A_0(\\omega_{\\frac{n}{2}}^{k})-\\omega_{n}^{k}A_1(\\omega_{\\frac{n}{2}}^{k})\n$$\næ‰€ä»¥æˆ‘ä»¬æ³¨æ„åˆ°æˆ‘ä»¬åªéœ€è¦çŸ¥é“ $A_0(x)$ å’Œ $A_1(x)$ åœ¨ $\\omega_{\\frac{n}{2}}^{0},\\omega_{\\frac{n}{2}}^{1},\u0026hellip;,\\omega_{\\frac{n}{2}}^{\\frac{n}{2}-1}$ ï¼Œçš„å€¼ï¼Œç„¶åå°±å¯ä»¥ $O(n)$ çš„æ±‚å¾— $A(x)$ åœ¨ $\\omega_{n}^{0},\\omega_{n}^{1},\u0026hellip;,\\omega_{n}^{n-1}$ çš„å€¼ï¼Œä¹Ÿå°±ç”¨ FFT å®Œæˆäº†æˆ‘ä»¬çš„ DFT è¿‡ç¨‹ã€‚\næ±‚ $A_0(x)$ å’Œ $A_1(x)$ çš„è¿‡ç¨‹å®Œå…¨æ˜¯ä¸€ä¸ªè®¾å®šå¥½ç³»æ•°å‘é‡ $(a_0,a_2,\u0026hellip;,a_{n-2})$ æˆ–è€… $(a_1,a_3,\u0026hellip;,a_{n-1})$ å°±å¯ä»¥ç›´æ¥é€’å½’çš„ä¸€ä¸ªå­é—®é¢˜ï¼Œè€Œä¸”æ¯æ¬¡é€’å½’è¿‡ç¨‹æ‰€èŠ±çš„æ—¶é—´å°±æ˜¯åªä¸å½“å‰æ•°æ®èŒƒå›´æœ‰å…³çš„ $O(n)$ ã€‚\næ€»æ—¶é—´å¤æ‚åº¦æ˜¯ $O(n \\log n)$ ã€‚\nIDFT å°†å¤šé¡¹å¼åœ¨$n$ æ¬¡å•ä½æ ¹çš„ $0$ åˆ° $n - 1$ æ¬¡å¹‚ï¼Œå³$\\omega _n^0,\\omega n^1,\u0026hellip;\\omega n^{n-1} $å¤„ç‚¹å€¼å‘é‡$(y_0,y_1,\u0026hellip;,y{n-1})$é€šè¿‡æ’å€¼ç­‰åŠæ³•è½¬æ¢ä¸ºå”¯ä¸€çš„å¤šé¡¹å¼ç³»æ•°å‘é‡$(a_0,a_1,\u0026hellip;,a{n-1})$çš„è¿‡ç¨‹ç§°ä¸ºç¦»æ•£å‚…é‡Œå¶é€†å˜æ¢ï¼ˆIDFTï¼‰ã€‚\nå¦‚æœè¿ç”¨æ‹‰æ ¼æœ—æ—¥æ’å€¼å»ç›´æ¥æ±‚å¾—çš„è¯ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯$O(n^2)$ã€‚\næ”¹è¿›ï¼šFFT æˆ‘ä»¬é€šè¿‡ä¸€ç³»åˆ—çš„æ¨å¯¼åä¼šå‘ç°ä»ç„¶å¯ä»¥ä½¿ç”¨ä¸Šé¢å·²ç»å®šä¹‰å¥½çš„ä½¿ç”¨ FFT ä¼˜åŒ–çš„ DFT æ¥å®Œæˆè¿™é‡Œçš„ IDFT ã€‚\nå› ä¸º DFT æ±‚çš„æ˜¯ä»ç³»æ•°åˆ°ç‚¹å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å‡è£…è¿™é‡Œæœ‰ä¸€ä¸ªå¤šé¡¹å¼ $B(x)$ ï¼Œç„¶åæŠŠå®ƒè½¬åŒ–æˆç‚¹å€¼ï¼Œå¯»æ‰¾å…¶ä¸åŸæ¥å¤šé¡¹å¼çš„ç³»æ•°çš„å…³ç³»ã€‚\nä»¤\n$$\nB(x) = \\sum_{j = 0}^{n-1} y_jx^j\n$$\nä»¤å…¶ç»è¿‡ä¸€æ¬¡ç¦»æ•£å‚…ç«‹å¶å˜æ¢ä¹‹åå¾—åˆ°åœ¨å•ä½æ ¹çš„ $0$ åˆ° $n-1$ æ¬¡å¹‚çš„å…±è½­å¤æ•°ï¼Œå³ $B(x)$ åœ¨ $w_n^{0},w_n^{-1},\u0026hellip;,w_n^{-(n-1)}$ å¤„çš„ç‚¹å€¼å‘é‡ä¸º $(c_0,c_1,\u0026hellip;,c_{n-1})$ ï¼Œå…¶ä¸­ï¼š\n$$\nc_k = \\sum_{i=0}^{n-1} y_i (\\omega_n^{-k})^i\n$$\nç”±äº\n$$\ny_i = \\sum_{j = 0}^{n-1} a_j(\\omega_n^i)^j\n= \\sum_{j = 0}^{n-1} a_j(\\omega_n^j)^i\\\n$$\nä»£å…¥ä¹‹åå¾—ï¼š\n$$\nc_k = \\sum_{i=0}^{n-1} (\\sum_{j=0}^{n-1} a_j(\\omega_n^j)^i) (\\omega_n^{-k})^i\\\n= \\sum_{j=0}^{n-1} a_j(\\sum_{i=0}^{n-1} (\\omega_n^{j-k})^i) \\\n$$\nä»¤\n$$\nS(x) = \\sum_{i=0}^{n-1}x^i\n$$\nåˆ™æœ‰å¦‚ä¸‹ç»“è®ºï¼ˆå¯ä»¥é€šè¿‡å¤æ•°å•ä½æ ¹çš„æ€§è´¨è‡ªè¡Œè¯æ˜ï¼‰:\n$$\nS(\\omega_n^k)=\n\\begin{cases}\n0,\u0026amp; k\\neq 0\\\nn,\u0026amp; k=0\n\\end{cases}\n$$\nåˆ™åœ¨ä¸Šä¸Šä¸Šå¼å¯ä»¥å†™ä½œï¼š\n$$\nc_k = \\sum_{j=0}^{n-1} a_jS(\\omega_n^{j-k}) \\\n$$\nå½“$j = k$æ—¶ï¼Œ$S(\\omega_n^{j-k})$ä¸º$n$ï¼Œå¦åˆ™è¯¥é¡¹ä¸º$0$ã€‚\næ‰€ä»¥å¯ä»¥å¾—åˆ°ç»“æœï¼š\n$$\nc_k = na_k\n$$\næ‰€ä»¥ç®€ç•¥æ€»ç»“ä¸€ä¸‹$IDFT$ï¼š\nè®¾å¤šé¡¹å¼\n$$\nA(x) = \\sum_{j = 0}^{n-1} a_jx^j\n$$\nç»è¿‡ä¸€æ¬¡ç¦»æ•£å‚…ç«‹å¶å˜æ¢ä¹‹ååœ¨ $n$ æ¬¡å•ä½æ ¹çš„ $0$ åˆ° $n - 1$ æ¬¡å¹‚ï¼Œå³ $\\omega _n^0,\\omega _n^1,\u0026hellip;\\omega n^{n-1}$ å¤„çš„ç‚¹å€¼å‘é‡ä¸º $(y_0,y_1,\u0026hellip;,y{n-1})$ ã€‚\nåˆ™å¦‚æœå°† $(y_0,y_1,\u0026hellip;,y_{n-1})$ å½“ä½œç³»æ•°å†ä¸€æ¬¡è¿›è¡Œç¦»æ•£å‚…ç«‹å¶å˜æ¢ï¼Œå…¶åœ¨ $n$ æ¬¡å•ä½æ ¹çš„ $0$ åˆ° $n - 1$ æ¬¡å¹‚çš„**å…±è½­å¤æ•°**ï¼Œå³ $\\omega _n^0,\\omega _n^{-1},\u0026hellip;\\omega _n^{-(n-1)}$ å¤„çš„ç‚¹å€¼å‘é‡ä¸º $(c_0,c_1,\u0026hellip;,c_{n-1})$ ã€‚\né‚£ä¹ˆè¿™ä¸ªæ—¶å€™ï¼Œ $a_k = \\frac{c_k}{n}$ ã€‚\nä¸€ç§é«˜æ•ˆçš„è¿­ä»£å®ç° ä»¥ä¸Šçš„$FFT$çš„è¿‡ç¨‹æ˜¯é€’å½’çš„ï¼Œæ‰€ä»¥æ•ˆç‡ä¸é«˜ã€‚\nè€Œæˆ‘ä»¬é€šè¿‡å¯¹é€’å½’è®¡ç®—é¡ºåºçš„å½’çº³ä¹‹åï¼Œå¯ä»¥å‘ç°å¦‚ä¸‹è§„å¾‹ï¼š\næœ€ä¸‹å±‚ä»å·¦åˆ°å³çš„æ•°åŠå…¶äºŒè¿›åˆ¶è¡¨ç¤ºä¸ºï¼š$0(000),4(100),2(010),6(110),1(001),5(101),3(011),7(111)$\nå¯ä»¥å‘ç°ï¼Œæ¯ä¸ªä½ç½®ä¸Šçš„è®¡ç®—é¡ºåºæ°å¥½æ˜¯åŸæ¥æ•°å­—çš„äºŒè¿›åˆ¶åè½¬ã€‚è€Œå¯¹äºè¿™ $n$ ä¸ªæ•°çš„äºŒè¿›åˆ¶æ•°åè½¬å¯ä»¥é€šè¿‡å¦‚ä¸‹ç®—æ³•åœ¨ $O(n)$ çš„æ—¶é—´å®Œæˆã€‚\nåˆ©ç”¨ä¸€ä¸ªç±»ä¼¼ dp çš„æ€æƒ³ï¼Œç”¨ $rev[i]$ ä»£è¡¨å¯¹ $i$ è¿›è¡ŒäºŒè¿›åˆ¶ç¿»è½¬ä¹‹åçš„ç»“æœï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™æˆ‘ä»¬æœ‰å¦‚ä¸‹çš„ç»“è®ºï¼š\n1  rev[i] = (rev[i\u0026gt;\u0026gt;1]\u0026gt;\u0026gt;1) | ((i\u0026amp;1) \u0026lt;\u0026lt; (len-1));   å‚è€ƒï¼šFFTä¸­çš„äºŒè¿›åˆ¶ç¿»è½¬é—®é¢˜ | GGN_2015çš„åšå®¢\n\næ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŒ‰ç…§è¿™ä¸ªæ ‘çš„é¡ºåºï¼Œä»ä¸‹åˆ°ä¸Šï¼Œä»å·¦åˆ°å³ï¼Œä¾æ¬¡è®¡ç®—å¯¹åº”çš„ DFT ç‚¹å€¼ã€‚ç„¶åç”¨$O(len)$ çš„æ—¶é—´åˆå¹¶ã€‚\næ³¨æ„åˆ°è¿™ä¸ªé€’å½’æ ‘ä¸€å…±æœ‰ $\\log n$ å±‚ï¼Œæ¯å±‚çš„é•¿åº¦éƒ½æ˜¯ $n$ ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦ä»ç„¶æ˜¯ $O(n\\log n)$ ã€‚\nå…·ä½“æ¥è¯´ï¼Œå¤§æ¦‚å°±æ˜¯ï¼š\nå¼€å§‹çš„æ—¶å€™ï¼Œæ•°ç»„é‡Œæ¯ä¸ªä½ç½®æ”¾çš„éƒ½æ˜¯è¿™ä¸ªä½ç½®çš„ç‚¹å€¼ï¼Œå› ä¸ºåœ¨ $n = 1$ å¹¶æ²¡æœ‰å˜é‡ $x$ ã€‚\nè¿™ä¸ªæ—¶å€™å†è¿›è¡Œå‘ä¸Šçš„åˆå¹¶ã€‚å¤„ç†åˆ°ä»ä¸‹å¾€ä¸Šæ•°çš„ç¬¬ $i(i\\in[0,log_2 n])$ å±‚ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦å¤„ç†çš„ç‚¹å€¼ä¸ªæ•°å°±æ˜¯ $2^{i}$ ä¸ªã€‚\nå¦‚æœæŠŠå½“å‰æ­£åœ¨å¤„ç†çš„æ˜¯ $A(\\omega_n^k)$ ã€‚åœ¨å¤„ç†ä¹‹å‰ï¼Œæˆ‘ä»¬å‡è®¾åœ¨è¿™ $2^{i}$ çš„åŒºé—´çš„å·¦è¾¹ $2^{i-1}$ ä¸ªå…ƒç´ ä¾æ¬¡æ”¾ç½®çš„æ˜¯ $A_0(\\omega_{\\frac{n}{2}}^{k})$ ï¼Œå³ä¾§ä¾æ¬¡æ”¾ç½®çš„æ˜¯ $A_1(\\omega_{\\frac{n}{2}}^{k})$ ã€‚å¤„ç†ä¹‹åï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨è¿™ $2^i$ ä¸ªä½ç½®ä¾æ¬¡æ”¾ç½®çš„æ˜¯ $A(\\omega_n^k)$ ï¼Œæ¥ä½¿æˆ‘ä»¬ä¸Šé¢çš„å¤„ç†ä¹‹å‰çš„å‡è®¾æˆç«‹ã€‚\næˆ‘ä»¬è¿ç”¨ä¸Šé¢æ¨å¯¼å‡ºçš„å…¬å¼ï¼š\n$$\n\\begin{aligned}{}\nA(\\omega_{n}^{k}) = \u0026amp; A_0(\\omega_{\\frac{n}{2}}^{k})+\\omega_{n}^{k}A_1(\\omega_{\\frac{n}{2}}^{k})\\\nA(\\omega_{n}^{k+\\frac{n}{2}}) =\u0026amp; A_0(\\omega_{\\frac{n}{2}}^{k})-\\omega_{n}^{k}A_1(\\omega_{\\frac{n}{2}}^{k})\n\\end{aligned}\n$$\nè¿™ä¸ªæ—¶å€™ $A_0(\\omega_{\\frac{n}{2}}^{k})$ å°±åœ¨å½“å‰åŒºé—´å·¦åŠè¾¹çš„ç¬¬ $k$ ä¸ªä½ç½®ä¸Šï¼Œè€Œ $A_1(\\omega_{\\frac{n}{2}}^{k})$ å°±åœ¨åŒºé—´å³åŠè¾¹çš„ç¬¬ $k$ ä¸ªä½ç½®ä¸Šã€‚\näº‹å®ä¸Šå¯ä»¥å‘ç° $A_0(\\omega_{\\frac{n}{2}}^{k})$ åœ¨æ•°ç»„ä¸­çš„ä½ç½®å°±æ˜¯ $A(\\omega_{n}^{k})$ åœ¨æ•°ç»„ä¸­çš„ä½ç½®ï¼Œè€Œ $A_1(\\omega_{\\frac{n}{2}}^{k})$ åœ¨æ•°ç»„ä¸­çš„ä½ç½®å°±æ˜¯ $A(\\omega_{n}^{k+\\frac{n}{2}})$ åœ¨æ•°ç»„ä¸­çš„ä½ç½®ã€‚\næ‰€ä»¥å¯¹äºè¿™ $n$ ä¸ªç‚¹å€¼ï¼Œå®ƒä»¬æ„æˆ $\\frac{n}{2}$ å¯¹ï¼Œäº’ä¸å¹²æ‰°ï¼Œæˆ‘ä»¬åªéœ€è¦æŠŠè¿™ä¸¤ä¸ªä½ç½®ä¸Šçš„å€¼å–å‡ºæ¥ï¼Œç»è¿‡è¿ç®—ä¹‹åå†æ”¾å›å»ï¼Œå°±å¯ä»¥å®Œæˆè¿™å¯¹ä½ç½®ä¸Šç‚¹å€¼çš„åˆå¹¶è®¡ç®—ã€‚\nè¿™ä¸ªè¿‡ç¨‹çš„å½¢è±¡å›¾è§£ï¼š\nè¿™é‡Œçš„ $y_k^{[0]}$ å°±æ˜¯æˆ‘ä»¬çš„ $A_0(\\omega_{\\frac{n}{2}}^k)$ ï¼Œ$y_k^{[1]}$ å°±æ˜¯æˆ‘ä»¬çš„ $A_1(\\omega_{\\frac{n}{2}}^k)$ ï¼Œ $y_k$ å°±æ˜¯æˆ‘ä»¬çš„ $A(\\omega_n^k)$ ã€‚\nè¿™ç§æ¥å—ä¸¤ä¸ªé€’å½’å¾—åˆ°çš„ $A_0$ å’Œ $A_1$ å€¼ï¼Œäº¤å‰è®¡ç®—å¾—åˆ° $A$ çš„å€¼çš„æ“ä½œè¢«ç§°ä¸ºè´è¶æ“ä½œã€‚\nç®€ç•¥æ¦‚æ‹¬ï¼š\né€šè¿‡åœ¨é€’å½’æ ‘ä¸Šä»ä¸‹åˆ°ä¸Šï¼Œä»å·¦åˆ°å³çš„é¡ºåºä¾æ¬¡é€’æ¨ï¼Œæ¯æ¬¡å¾—åˆ°ä¸€å¯¹æ›´é«˜å±‚çš„ç‚¹å€¼ï¼Œæœ€åé€’æ¨å¾—åˆ°æœ€ç»ˆè¦æ±‚çš„ $n$ ä¸ªç‚¹å€¼ã€‚\nä»£ç  è¿™é‡Œç»™å‡ºä¸€ä¸ªå¿«é€Ÿå‚…ç«‹å¶å˜æ¢æ¨¡ç‰ˆé¢˜çš„C++ä»£ç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49  #include \u0026lt;bits/stdc++.h\u0026gt;using namespace std; typedef complex\u0026lt;double\u0026gt; complex_t; const int MAXN = 2610000; namespace FFT{ const double PI = acos(-1.0); // op == 1 -\u0026gt; DFT, op == -1 -\u0026gt; IDFT void fft(complex_t *P,int n,int op){ // P ä¼ å…¥ n ä¸ªç³»æ•°ï¼ˆå¤æ•°ï¼‰ï¼Œop æ ‡è®°æ“ä½œ  static int r[MAXN];//r[i] å­˜å‚¨ i åè½¬äºŒè¿›åˆ¶åå¾—åˆ°çš„æ•°  int len = log2(n);//è®¡ç®—äºŒè¿›åˆ¶ä½é•¿åº¦ï¼ˆ001 -\u0026gt; len = 3ï¼‰  for(int i = 0;i \u0026lt; n;i++) r[i] = (r[i\u0026gt;\u0026gt;1]\u0026gt;\u0026gt;1) | ((i\u0026amp;1) \u0026lt;\u0026lt; (len-1)); //é€’æ¨è®¡ç®— r[i]  for(int i = 0;i \u0026lt; n;i++)// äº¤æ¢å¾—åˆ°æœ€åº•å±‚åºåˆ—  if(i \u0026lt; r[i]) swap(P[i],P[r[i]]); for(int i = 1;i\u0026lt;n;i\u0026lt;\u0026lt;=1){// è®¡ç®—æ‰€æœ‰é•¿åº¦ä¸º(i\u0026lt;\u0026lt;1)çš„åºåˆ—çš„DFTå€¼  complex_t x(cos(PI/i),op*sin(PI/i));// è¯¥é•¿åº¦ä¸‹çš„å•ä½æ ¹  for(int j = 0;j\u0026lt;n;j+=(i\u0026lt;\u0026lt;1)){ // æŸä¸€ä¸ªé•¿åº¦ä¸º(i\u0026lt;\u0026lt;1)çš„åºåˆ—  complex_t y(1,0); // \\omega_{n}^{0}  for(int k = 0;k\u0026lt;i;k++,y*=x){ // è®¡ç®—A(\\omgea_{n}^{k})å’ŒA(\\omgea_{n}^{n/2+k})  complex_t p=P[j+k],q=y*P[j+i+k]; // p = A_0(\\omgea_{n/2}^{k})  // q = \\omgea_{n}^{k} * A_1(\\omgea_{n/2}^{k})  P[j+k] = p+q,P[i+j+k]=p-q; //A(\\omgea_{n}^{k}) = p+q, A(\\omgea_{n}^{n/2+k}) = p-q  } } } } } int n,m; complex_t a[MAXN],b[MAXN]; int main(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m); int t; for(int i = 0;i\u0026lt;=n;i++){scanf(\u0026#34;%d\u0026#34;,\u0026amp;t);a[i] = t;} for(int i = 0;i\u0026lt;=m;i++){scanf(\u0026#34;%d\u0026#34;,\u0026amp;t);b[i] = t;} for(m+=n,n=1;n\u0026lt;=m;n\u0026lt;\u0026lt;=1); FFT::fft(a,n,1),FFT::fft(b,n,1);// å¯¹ä¸¤ä¸ªå¤šé¡¹å¼è¿›è¡ŒDFT  for(int i = 0;i\u0026lt;=n;i++) a[i] *= b[i];//ç‚¹å€¼ä¹˜æ³•è®¡ç®—  FFT::fft(a,n,-1); // å¯¹ç‚¹å€¼è¿›è¡ŒIDFT  for(int i = 0;i\u0026lt;=m;i++) printf(\u0026#34;%d \u0026#34;,int(a[i].real()/n + 0.5)); return 0; }   å¿«é€Ÿæ•°è®ºå˜æ¢(NTT) è·Ÿ $FFT$ å¤§è‡´ï¼ˆå‡ ä¹å®Œå…¨ï¼‰ä¸€æ ·ï¼Œåªéœ€è¦æŠŠå¤æ•°å•ä½æ ¹æ›¿æ¢æˆæ¨¡å½¢å¦‚ $a \\times 2^b + 1$ çš„è´¨æ•° $p$ï¼Œå¸¸ç”¨è´¨æ•°å‚è§ï¼šMisckoo\u0026rsquo;s Blog\nã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14  void ntt(ll *P,int n,int op){ for(int i = 0;i\u0026lt;n;i++) if(i \u0026lt; r[i]) swap(P[i],P[r[i]]); for(int i = 1;i\u0026lt;n;i\u0026lt;\u0026lt;=1){ ll w = pow((op==1?G:INVG),(MOD-1)/(i\u0026lt;\u0026lt;1),MOD); for(int j = 0;j\u0026lt;n;j+=(i\u0026lt;\u0026lt;1)){ ll wn = 1; for(int k = 0;k\u0026lt;i;k++,wn=(wn*w)%MOD){ ll p = P[j+k],q = wn*(P[i+j+k])%MOD; P[j+k] = (p+q)%MOD; P[i+j+k] = ((p-q)%MOD+MOD)%MOD; } } } }   åº”ç”¨ ä¼˜åŒ–è®¡ç®—å·ç§¯ã€‚\nå¿«é€Ÿè®¡ç®—å½¢å¦‚ $f(i) = \\sum g(j) g(i-j)$ ä¹‹ç±»é—®é¢˜ã€‚\nå‚è€ƒèµ„æ–™ FFTè¯¦è§£ | GGN-2015çš„åšå®¢ å†™çš„å¾ˆé€‚åˆåˆå­¦è€…\nFFTå­¦ä¹ ç¬”è®° | Menci\u0026rsquo;s Blog æœ‰è¯¦å°½çš„æ•°å­¦å…¬å¼ï¼Œä½†ä¸é€‚åˆåˆå­¦çš„åŒå­¦çœ‹\nMisckoo\u0026rsquo;s Blog ç®€ç»ƒï¼Œæœ‰å…³äºNTTå’Œå…¶åº”ç”¨çš„ç®€ä»‹ è´¨é‡å¾ˆé«˜\nå¤šé¡¹å¼é™¤æ³•ã€å–æ¨¡ ç»™å‡ºä¸¤ä¸ªå¤šé¡¹å¼ $A(x),B(x)$ ï¼Œæ¬¡æ•°åˆ†åˆ«ä¸º $n,m(n \\geq m)$ï¼Œæ±‚æ»¡è¶³ï¼š\n$$\nA(x) = Q(x)B(x) + R(x)\n$$\nä¸” $R(x)$ æ¬¡æ•°å°äº $B(x)$ çš„æ¬¡æ•°ã€‚\nåŸç† å¤šé¡¹å¼ï¼ˆåŒ…æ‹¬ç”Ÿæˆå‡½æ•°ç­‰ï¼‰ä¸­çš„ $x$ å¯ä»¥æœ‰åŒé‡å«ä¹‰ï¼šå ä½ç¬¦æˆ–è€…ä¸€ä¸ªå¤å˜é‡ã€‚\nè¿™é‡Œå¦‚æœå½“åšå ä½ç¬¦ï¼Œæˆ‘ä»¬å¯ä»¥æ‹¿ $\\frac{1}{x}$ ä»£æ›¿ $x$ ä»£å…¥æ–¹ç¨‹ï¼Œå°±æœ‰ï¼š\n$$\nA(\\frac{1}{x}) = Q(\\frac{1}{x})B(\\frac{1}{x}) + R(\\frac{1}{x})\n$$\nåŒä¹˜ $x^n$ ï¼Œå¾—åˆ°:\n$$\nx^n A(\\frac{1}{x}) = (x^{n-m}Q(\\frac{1}{x}))(x^m B(\\frac{1}{x})) + x^{n-m+1}(x^{m-1}R(\\frac{1}{x}))\n$$\næˆ‘ä»¬è®¾ï¼ˆäº‹å®ä¸Šå°±æ˜¯æŠŠç³»æ•°åäº†è¿‡æ¥ï¼‰\n$$\nA'(x) = x^n A(\\frac{1}{x})\\\nB'(x) = x^m B(\\frac{1}{x})\\\nQ'(x) = x^{n-m} Q(\\frac{1}{x})\\\nR'(x) = x^{m-1} R(\\frac{1}{x})\n$$\né‚£ä¹ˆ\n$$\nA'(x) = Q'(x)B'(x) + x^{n-m+1}R'(x)\n$$\nä¸¤ä¾§å¯¹ $x^{n-m+1}$ å–æ¨¡å¾—åˆ°\n$$\nA'(x) \\equiv Q'(x)B'(x) \\pmod{x^{n-m+1}}\n$$\n$$\nQ'(x) \\equiv \\frac{A'(x)}{B'(x)} \\pmod{x^{n-m+1}}\n$$\nå› ä¸º $Q'(x)$ ä¹Ÿå°±æ˜¯ $Q(x)$ çš„æ¬¡æ•°æ­£å¥½æ˜¯ $n-m$ ï¼Œåˆšå¥½å…¨éƒ¨ä¿ç•™ï¼Œæ‰€ä»¥è¿™ä¸ªåœ°æ–¹æ±‚å‡ºçš„åœ¨æ¨¡ $x^{n-m+1}$ æ„ä¹‰ä¸‹çš„ $Q'(x)$ å°±æ˜¯çœŸæ­£çš„ $Q'(x)$ ã€‚\nä½™å¼ $R$ å°±æŠŠ $Q$ å’Œ $B$ ç”¨ NTT ä¹˜å›å»å‡æ‰å³å¯\u0026hellip;\nå¤šé¡¹å¼ï¼ˆæ±‚é€†ï¼‰ å¤šé¡¹å¼æ±‚é€†çš„ç›®çš„æ˜¯ï¼š\nç»™å‡ºå¤šé¡¹å¼ $A(x)$ ï¼Œæ±‚å¤šé¡¹å¼ $B(x)$ ï¼Œä½¿å¾— $A(x) B(x) \\equiv 1 \\pmod{x^n}$ ã€‚ç³»æ•°å¯¹æŸä¸ªæ•° $p$ å–æ¨¡ã€‚\nåŸç† æˆ‘ä»¬å‘ç°ï¼Œå¦‚æœæˆ‘ä»¬ä»¤ $B'(x)$ ä¸º $A(x) B'(x) \\equiv 1 \\pmod{x^{\\lceil\\frac{n}{2}\\rceil}}$ çš„è§£ï¼›åˆæœ‰ $A(x)B(x) \\equiv 1 \\pmod{x^{\\lceil\\frac{n}{2}\\rceil}}$\nä¸¤å¼ç›¸å‡å¾—åˆ°ï¼š $A(x)(B(x)-B'(x)) \\equiv 0 \\pmod{x^{\\lceil\\frac{n}{2}\\rceil}}$ï¼Œæˆ‘ä»¬æœ‰ $A(x) \\not\\equiv 0 \\pmod{x^{\\lceil\\frac{n}{2}\\rceil}}$ï¼Œæ‰€ä»¥æœ‰ $B(x) - B'(x) \\equiv 0 \\pmod{x^{\\lceil\\frac{n}{2}\\rceil}}$ ã€‚\nè¿™ä¸ªå¼å­éå¸¸ç‰¹æ®Šï¼Œæˆ‘ä»¬å¯ä»¥æ¨å‡ºä»¥ä¸‹çš„å¼å­ï¼š $(B(x)-B'(x))^2 \\equiv 0 \\pmod{x^n}$ ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ\næˆ‘ä»¬æ³¨æ„åˆ°ï¼Œ $B(x) - B'(x)$ åœ¨å $\\lceil\\frac{n}{2}\\rceil$ é¡¹çš„å€¼éƒ½æ˜¯ $0$ ï¼Œé‚£ä¹ˆå¹³æ–¹ä¹‹åæƒ³è¦å‡‘å‡ºä¸€ä¸ªæ¬¡æ•°å°äº $n$ çš„é¡¹ï¼Œåˆ™å¿…é¡»å«æœ‰ä¸€ä¸ªæ¬¡æ•°åœ¨ $\\lceil\\frac{n}{2}\\rceil$ ä»¥ä¸‹çš„é¡¹ï¼Œæ˜¾ç„¶å¿…é¡»æ˜¯ $0$ ã€‚\né‚£ä¹ˆæˆ‘ä»¬å°±æœ‰ $B(x)^2 - 2 B(x)B'(x) + B'(x)^2 \\equiv 0 \\pmod{x^n}$ï¼Œä¸¤è¾¹åŒæ—¶ä¹˜ä¸Š $A(x)$ å°±æœ‰ $B(x) - 2B'(x) + A(x)B'(x)^2 \\equiv 0 \\pmod{x^n}$ ï¼Œç§»é¡¹ä¹‹åå°±æœ‰æœ€åçš„ç­”æ¡ˆï¼š$B(x) \\equiv 2B'(x) - A(x)B'(x)^2 \\pmod{x^n}$ã€‚\nå®ç°  cal(A,n)  å¦‚æœ $n = 1$ï¼Œç›´æ¥è¿”å›è¯¥æ•°æ¨¡ $p$ æ„ä¹‰ä¸‹çš„é€†å…ƒã€‚ å¦‚æœ $n \u0026gt; 1$ï¼Œæˆ‘ä»¬è®¡ç®—å‡º B'(x) = cal(A,ceil(n/2))\næ ¹æ® B(x) = B'(x) - A(x)B'(x)^2 å¹¶ç”¨ $NTT/FFT$ ä¼˜åŒ–ç®—å‡º B(x)    ä»£ç  é€’å½’ç‰ˆ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28  namespace NTT{ int init(int n);// åˆå§‹åŒ– ntt çš„å„ç§ä¸œè¥¿  void ntt(ll *P,int n,int op);// è¿›è¡Œ ntt å˜æ¢  // ... } namespace xxx{ ll a[MAXN],b[MAXN],A[MAXN],B[MAXN],r[MAXN]; void work(int n){ if(n == 1) b[0] = inv(a[0],MOD); else{ int s = (n+1)/2;work(s); int t = NTT::init(2*n+2); memset(A,0,sizeof(ll) * t),memcpy(A,a,sizeof(ll) * n); memset(B,0,sizeof(ll) * t),memcpy(B,b,sizeof(ll) * s); NTT::ntt(A,t,1),NTT::ntt(B,t,1); for(int i = 0;i\u0026lt;t;i++) r[i] = (2-A[i]*B[i]%MOD+MOD)*B[i] % MOD; NTT::ntt(r,t,-1); memcpy(b,r,sizeof(ll) * n); } } void getinv(ll *P,int n){ memcpy(a,P,sizeof(ll) * n); work(n); memcpy(P,b,sizeof(ll) * n); } }   ","description":"","id":6,"section":"posts","tags":["æ•°å­¦","å¤šé¡¹å¼","æ¨¡æ¿","ç¬”è®°"],"title":"ç®€å•å¤šé¡¹å¼å­¦ä¹ ç¬”è®°","uri":"https://blog.chenqiqian.com/posts/notes-poly/"},{"content":"å®šä¹‰ä¸€ä¸ªæ•°å­—ä¸²ä¸ºâ€œå¦™â€çš„å½“ä¸”ä»…å½“ï¼šè¯¥ä¸²åŒ…å«æŸä¸€å­åºåˆ—ä¸º $2017$ ï¼Œä¸”ä¸åŒ…å«å­åºåˆ— $2016$ã€‚\nå®šä¹‰ä¸€ä¸ªæ•°å­—ä¸²çš„â€œä¸‘å€¼â€ä¸ºï¼šè¯¥ä¸²è‡³å°‘åˆ å»å‡ ä¸ªå­—ç¬¦ï¼Œå¯ä»¥ä½¿å¾—å‰©ä½™ä¸²å˜â€œå¦™â€ï¼›å¦‚æœåˆ å»ä»»æ„å¤šä¸ªå­—ç¬¦ï¼Œå‡æ— æ³•ä½¿è¯¥ä¸²å˜â€œå¦™â€ï¼Œåˆ™è¯¥ä¸²çš„â€œä¸‘å€¼â€æ˜¯ $-1$ã€‚\nç»™å®šä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„æ•°å­—ä¸² $s$ ã€‚æœ‰ $q$ æ¬¡è¯¢é—®ï¼Œæ¯æ¬¡è¯¢é—®ç”¨ $(l_i,r_i)$ è¡¨ç¤ºã€‚å¯¹äºæ¯æ¬¡è¯¢é—®ï¼Œå›ç­”å­ä¸² $s[l_i\u0026hellip;r_i]$ çš„â€œä¸‘å€¼â€ã€‚\né“¾æ¥ Codeforces\né¢˜è§£ æˆ‘ä»¬è€ƒè™‘åªæœ‰ä¸€ä¸ªè¯¢é—®è€Œä¸”å­ä¸²æ˜¯æ•´ä¸ªå­—ç¬¦ä¸²çš„åšæ³•ã€‚\næˆ‘ä»¬ä»¤ $dp[i][p]$ (å…¶ä¸­ $p \\in {0,1,2,3,4}$) è¡¨ç¤ºä½¿ $p$ æœ€å¤šæ°å¥½åŒ¹é…åˆ° $2017$ çš„ç¬¬ $p$ ä¸ªä½ç½®çš„æœ€å°åˆ é™¤ä»£ä»·ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å†™å‡ºå¦‚ä¸‹çš„ dp è½¬ç§»æ–¹ç¨‹ï¼š\n$$\ndp[0][0] = 1,dp[0][1] = dp[0][2] = dp[0][3] = dp[0][4] = \\infty\\\n\\begin{aligned}\ndp[i][0] = \u0026amp;\\left{\\begin{aligned}\ndp[i-1][0] + 1\u0026amp;, s_i \\in {2}\\\ndp[i-1][0]\u0026amp;, s_i \\not\\in {2}\\\n\\end{aligned}\n\\right.\\\ndp[i][1] = \u0026amp;\\left{\\begin{aligned}\n\\min(dp[i-1][0],dp[i-1][1])\u0026amp;,s_i \\in {2}\\\ndp[i-1][1] + 1\u0026amp;,s_i \\in {0}\\\ndp[i-1][1]\u0026amp;,s_i \\not \\in {2,0}\n\\end{aligned}\\right.\\\ndp[i][2] = \u0026amp;\\left{\\begin{aligned}\n\\min(dp[i-1][1],dp[i-1][2])\u0026amp;,s_i \\in {0}\\\ndp[i-1][2] + 1\u0026amp;,s_i \\in {1}\\\ndp[i-1][2]\u0026amp;,s_i \\not \\in {0,1}\n\\end{aligned}\\right.\\\ndp[i][3] = \u0026amp;\\left{\\begin{aligned}\n\\min(dp[i-1][2],dp[i-1][3])\u0026amp;,s_i \\in {1}\\\ndp[i-1][3] + 1\u0026amp;,s_i \\in {7,6}\\\ndp[i-1][3]\u0026amp;,s_i \\not \\in {1,6,7}\n\\end{aligned}\\right.\\\ndp[i][4] = \u0026amp;\\left{\\begin{aligned}\n\\min(dp[i-1][3],dp[i-1][4])\u0026amp;,s_i \\in {7}\\\ndp[i-1][4] + 1\u0026amp;,s_i \\in {6}\\\ndp[i-1][4]\u0026amp;,s_i \\not \\in {6,7}\n\\end{aligned}\\right.\\\n\\end{aligned}\n$$\nå¦‚æœæˆ‘ä»¬æŠŠä¸€èˆ¬çŸ©é˜µçš„ $(\\mathbb Z, \\cdot,+)$ å˜æˆ $(\\mathbb Z,+,\\min)$ ï¼Œå› ä¸ºæˆ‘ä»¬çš„è½¬ç§»åªä¸è¿™ä¸ªä½ç½®çš„å­—ç¬¦æœ‰å…³ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å†™å‡ºçŠ¶æ€çŸ©é˜µ $M_i$ ï¼Œ ä½¿ï¼š\n$$\nM_i\\left[\\begin{matrix}\ndp[i-1][0]\\\ndp[i-1][1]\\\ndp[i-1][2]\\\ndp[i-1][3]\\\ndp[i-1][4]\\\n\\end{matrix}\\right] \\left[\\begin{matrix}\ndp[i][0]\\\ndp[i][1]\\\ndp[i][2]\\\ndp[i][3]\\\ndp[i][4]\\\n\\end{matrix}\\right]\n$$\n  $s_i = 2$ æ—¶ï¼š\n$$\nM_i = \\left[\\begin{matrix}{}\n1 \u0026amp; \\inf \u0026amp; \\inf \u0026amp; \\inf \u0026amp; \\inf\\\n0 \u0026amp; 0 \u0026amp; \\inf \u0026amp; \\inf \u0026amp; \\inf\\\n\\inf \u0026amp; \\inf \u0026amp; 0 \u0026amp; \\inf \u0026amp; \\inf\\\n\\inf \u0026amp; \\inf \u0026amp; \\inf \u0026amp; 0 \u0026amp; \\inf\\\n\\inf \u0026amp; \\inf \u0026amp; \\inf \u0026amp; \\inf \u0026amp; 0\\\n\\end{matrix}\\right]\n$$\n  $s_i = 0$ æ—¶ï¼š\n$$\nM_i = \\left[\\begin{matrix}{}\n0 \u0026amp; \\inf \u0026amp; \\inf \u0026amp; \\inf \u0026amp; \\inf\\\n\\inf \u0026amp; 1 \u0026amp; \\inf \u0026amp; \\inf \u0026amp; \\inf\\\n\\inf \u0026amp; 0 \u0026amp; 0 \u0026amp; \\inf \u0026amp; \\inf\\\n\\inf \u0026amp; \\inf \u0026amp; \\inf \u0026amp; 0 \u0026amp; \\inf\\\n\\inf \u0026amp; \\inf \u0026amp; \\inf \u0026amp; \\inf \u0026amp; 0\\\n\\end{matrix}\\right]\n$$\n  $s_i = 1$ æ—¶\n$$\nM_i = \\left[\\begin{matrix}{}\n0 \u0026amp; \\inf \u0026amp; \\inf \u0026amp; \\inf \u0026amp; \\inf\\\n\\inf \u0026amp; 0 \u0026amp; \\inf \u0026amp; \\inf \u0026amp; \\inf\\\n\\inf \u0026amp; \\inf \u0026amp; 1 \u0026amp; \\inf \u0026amp; \\inf\\\n\\inf \u0026amp; \\inf \u0026amp; 0 \u0026amp; 0 \u0026amp; \\inf\\\n\\inf \u0026amp; \\inf \u0026amp; \\inf \u0026amp; \\inf \u0026amp; 0\\\n\\end{matrix}\\right]\n$$\n  $s_i = 7$ æ—¶ï¼š\n$$\nM_i = \\left[\\begin{matrix}{}\n0 \u0026amp; \\inf \u0026amp; \\inf \u0026amp; \\inf \u0026amp; \\inf\\\n\\inf \u0026amp; 0 \u0026amp; \\inf \u0026amp; \\inf \u0026amp; \\inf\\\n\\inf \u0026amp; \\inf \u0026amp; 0 \u0026amp; \\inf \u0026amp; \\inf\\\n\\inf \u0026amp; \\inf \u0026amp; \\inf \u0026amp; 1 \u0026amp; \\inf\\\n\\inf \u0026amp; \\inf \u0026amp; \\inf \u0026amp; 0 \u0026amp; 0\\\n\\end{matrix}\\right]\n$$\n  $s_i = 6$ æ—¶\n$$\nM_i = \\left[\\begin{matrix}{}\n0 \u0026amp; \\inf \u0026amp; \\inf \u0026amp; \\inf \u0026amp; \\inf\\\n\\inf \u0026amp; 0 \u0026amp; \\inf \u0026amp; \\inf \u0026amp; \\inf\\\n\\inf \u0026amp; \\inf \u0026amp; 0 \u0026amp; \\inf \u0026amp; \\inf\\\n\\inf \u0026amp; \\inf \u0026amp; \\inf \u0026amp; 1 \u0026amp; \\inf\\\n\\inf \u0026amp; \\inf \u0026amp; \\inf \u0026amp; \\inf \u0026amp; 1\\\n\\end{matrix}\\right]\n$$\n  other\n$$\nM_i = \\left[\\begin{matrix}{}\n0 \u0026amp; \\inf \u0026amp; \\inf \u0026amp; \\inf \u0026amp; \\inf\\\n\\inf \u0026amp; 0 \u0026amp; \\inf \u0026amp; \\inf \u0026amp; \\inf\\\n\\inf \u0026amp; \\inf \u0026amp; 0 \u0026amp; \\inf \u0026amp; \\inf\\\n\\inf \u0026amp; \\inf \u0026amp; \\inf \u0026amp; 0 \u0026amp; \\inf\\\n\\inf \u0026amp; \\inf \u0026amp; \\inf \u0026amp; \\inf \u0026amp; 0\\\n\\end{matrix}\\right]\n$$\n  åˆå§‹çŸ©é˜µï¼š\n$$\nD= \\left[\\begin{matrix}\n0\\\n\\inf\\\n\\inf\\\n\\inf\\\n\\inf\\\n\\end{matrix}\\right]\n$$\nå¯¹äºè¯¢é—®ï¼Œæˆ‘ä»¬æŠŠçŸ©é˜µæ‰”åˆ°çº¿æ®µæ ‘ä¸Šï¼Œå› ä¸ºæœ‰ç»“åˆå¾‹ï¼ˆä»€ä¹ˆä½ é—®ä¸ºä»€ä¹ˆï¼Ÿæˆ‘ä¹Ÿä¸çŸ¥é“ï¼‰ï¼Œæ¯æ¬¡æŸ¥è¯¢çº¿æ®µæ ‘å³å¯ï¼Œæ³¨æ„åˆå¹¶çš„æ—¶å€™è¦å³è¾¹çš„çŸ©é˜µåœ¨å·¦ï¼Œå·¦è¾¹çš„çŸ©é˜µåœ¨å³åšä¹˜æ³•ã€‚\näº‹å®ä¸Šè¿™é“é¢˜å¯ä»¥æ”¯æŒå•ç‚¹ä¿®æ”¹çš„å‘¢ï¼ˆ\næ—¶é—´å¤æ‚åº¦ï¼š$O(5^2 q \\log n )$\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76  #include \u0026lt;bits/stdc++.h\u0026gt;using namespace std; const int MAXN = 410000,N = 5; struct Matrix{ int num[N][N]; Matrix(int op = 0){ memset(num,0x3f,sizeof(num)); if(op == 1) for(int i = 0;i\u0026lt;N;i++){ num[i][i] = 0; } } int *operator [] (int n){return num[n];} }; Matrix mul(Matrix \u0026amp;a,Matrix \u0026amp;b){ Matrix ans; for(int i = 0;i\u0026lt;N;i++){ for(int j = 0;j\u0026lt;N;j++){ for(int k = 0;k\u0026lt;N;k++){ ans[i][j] = min(ans[i][j],a[i][k] + b[k][j]); } } } return ans; } Matrix get(int x){ Matrix t(1); if(x == 2) t[0][0] = 1,t[1][0] = 0; if(x == 0) t[1][1] = 1,t[2][1] = 0; if(x == 1) t[2][2] = 1,t[3][2] = 0; if(x == 7) t[3][3] = 1,t[4][3] = 0; if(x == 6) t[4][4] = 1,t[3][3] = 1; return t; } int n,q; char s[MAXN]; namespace Seg{ Matrix sum[MAXN\u0026lt;\u0026lt;2]; #define lson (nown\u0026lt;\u0026lt;1)  #define rson (nown\u0026lt;\u0026lt;1|1)  #define mid ((l+r)\u0026gt;\u0026gt;1)  void build(int nown,int l,int r,char *s){ if(l == r) sum[nown] = get(s[l] - \u0026#39;0\u0026#39;); else{ build(lson,l,mid,s),build(rson,mid+1,r,s); sum[nown] = mul(sum[rson],sum[lson]); } } Matrix query(int nown,int l,int r,int ql,int qr){ if(ql \u0026lt;= l \u0026amp;\u0026amp; r \u0026lt;= qr){ return sum[nown]; } else{ Matrix L(1),R(1); if(ql \u0026lt;= mid) L = query(lson,l,mid,ql,qr); if(qr \u0026gt;= mid+1) R = query(rson,mid+1,r,ql,qr); return mul(R,L); } } } int main(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;q); scanf(\u0026#34;%s\u0026#34;,s+1); Seg::build(1,1,n,s); for(int i = 1;i\u0026lt;=q;i++){ int l,r; scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;l,\u0026amp;r); Matrix ans = Seg::query(1,1,n,l,r); printf(\u0026#34;%d\\n\u0026#34;,ans[4][0] \u0026gt; (r-l+1)?-1:ans[4][0]); } return 0; }   ","description":"","id":7,"section":"posts","tags":["çŸ©é˜µ","çº¿æ®µæ ‘","åŠ¨æ€è§„åˆ’"],"title":"ã€ŒCF750Eã€New Year and Old Subsequence-çŸ©é˜µ+çº¿æ®µæ ‘+dp","uri":"https://blog.chenqiqian.com/posts/cf750e/"},{"content":"Emoji Support Emoji can be enabled in a Hugo project in a number of ways.\nThe emojify function can be called directly in templates or Inline Shortcodes.\nTo enable emoji globally, set enableEmoji to true in your siteâ€™s configuration and then you can type emoji shorthand codes directly in content files; e.g.\nğŸ™ˆ ğŸ™ˆ ğŸ™‰ ğŸ™‰ ğŸ™Š ğŸ™Š\nThe Emoji cheat sheet is a useful reference for emoji shorthand codes.\nN.B. The above steps enable Unicode Standard emoji characters and sequences in Hugo, however the rendering of these glyphs depends on the browser and the platform. To style the emoji you can either use a third party emoji font or a font stack; e.g.\n1 2 3  .emoji { font-family: Apple Color Emoji,Segoe UI Emoji,NotoColorEmoji,Segoe UI Symbol,Android Emoji,EmojiSymbols; }   Rich Content Hugo ships with several Built-in Shortcodes for rich content, along with a Privacy Config and a set of Simple Shortcodes that enable static and no-JS versions of various social media embeds.\n Math Typesetting We need goldmark katex entension which is not yet we have: [https://github.com/gohugoio/hugo/issues/6544](https://github.com/gohugoio/hugo/issues/6544)  Mathematical notation in a Hugo project can be enabled by using third party JavaScript libraries.\n In this example we will be using KaTeX\n Create a partial under /layouts/partials/math.html Within this partial reference the Auto-render Extension or host these scripts locally. Include the partial in your templates like so:  {{ if or .Params.math .Site.Params.math }} {{ partial \u0026quot;math.html\u0026quot; . }} {{ end }}  To enable KaTex globally set the parameter math to true in a project\u0026rsquo;s configuration To enable KaTex on a per page basis include the parameter math: true in content files.  Note: Use the online reference of Supported TeX Functions\nExamples Inline math: $$ \\varphi = \\dfrac{1+\\sqrt5}{2}= 1.6180339887â€¦ $$\nBlock math:\n$$\n\\varphi = 1+\\frac{1} {1+\\frac{1} {1+\\frac{1} {1+\\cdots} } }\n$$\nCode Syntax Highlighting Verify the following code blocks render as code blocks and highlight properly.\nMore about tuning syntax highlighting is the Hugo documentation.\nDiff 1 2 3 4 5 6 7 8 9 10  *** /path/to/original\t\u0026#39;\u0026#39;timestamp\u0026#39;\u0026#39; --- /path/to/new\t\u0026#39;\u0026#39;timestamp\u0026#39;\u0026#39; *************** *** 1 **** ! This is a line. --- 1 --- ! This is a replacement line. It is important to spell -removed line +new line   *** /path/to/original\t\u0026#39;\u0026#39;timestamp\u0026#39;\u0026#39; --- /path/to/new\t\u0026#39;\u0026#39;timestamp\u0026#39;\u0026#39; *************** *** 1 **** ! This is a line. --- 1 --- ! This is a replacement line. It is important to spell -removed line +new line Makefile CC=gcc CFLAGS=-I. hellomake: hellomake.o hellofunc.o $(CC) -o hellomake hellomake.o hellofunc.o -I. 1 2 3 4 5  CC=gcc CFLAGS=-I. hellomake: hellomake.o hellofunc.o $(CC) -o hellomake hellomake.o hellofunc.o -I.   JSON 1 2 3  {\u0026#34;employees\u0026#34;:[ {\u0026#34;firstName\u0026#34;:\u0026#34;John\u0026#34;, \u0026#34;lastName\u0026#34;:\u0026#34;Doe\u0026#34;}, ]}   Markdown 1 2 3  **bold** *italics* [link](www.example.com)   JavaScript 1  document.write(\u0026#39;Hello, world!\u0026#39;);   CSS 1 2 3  body { background-color: red; }   Objective C 1 2 3 4 5 6  #import \u0026lt;stdio.h\u0026gt;  int main (void) { printf (\u0026#34;Hello world!\\n\u0026#34;); }   Python 1  print \u0026#34;Hello, world!\u0026#34;   XML 1 2 3 4 5  \u0026lt;employees\u0026gt; \u0026lt;employee\u0026gt; \u0026lt;firstName\u0026gt;John\u0026lt;/firstName\u0026gt; \u0026lt;lastName\u0026gt;Doe\u0026lt;/lastName\u0026gt; \u0026lt;/employee\u0026gt; \u0026lt;/employees\u0026gt;   Perl 1  print \u0026#34;Hello, World!\\n\u0026#34;;   Bash 1  echo \u0026#34;Hello World\u0026#34;   PHP 1  \u0026lt;?php echo \u0026#39;\u0026lt;p\u0026gt;Hello World\u0026lt;/p\u0026gt;\u0026#39;; ?\u0026gt;  CoffeeScript 1  console.log(â€œHello world!â€);   C# 1 2 3 4 5 6 7 8  using System; class Program { public static void Main(string[] args) { Console.WriteLine(\u0026#34;Hello, world!\u0026#34;); } }   C++ 1 2 3 4 5 6 7  #include \u0026lt;iostream.h\u0026gt; main() { cout \u0026lt;\u0026lt; \u0026#34;Hello World!\u0026#34;; return 0; }   SQL 1 2  SELECT column_name,column_name FROM table_name;   Go 1 2 3 4 5  package main import \u0026#34;fmt\u0026#34; func main() { fmt.Println(\u0026#34;Hello, ä¸–ç•Œ\u0026#34;) }   Ruby 1  puts \u0026#34;Hello, world!\u0026#34;   Java 1 2 3 4 5 6 7 8 9 10 11 12  import javax.swing.JFrame; //Importing class JFrame import javax.swing.JLabel; //Importing class JLabel public class HelloWorld { public static void main(String[] args) { JFrame frame = new JFrame(); //Creating frame  frame.setTitle(\u0026#34;Hi!\u0026#34;); //Setting title frame  frame.add(new JLabel(\u0026#34;Hello, world!\u0026#34;));//Adding text to frame  frame.pack(); //Setting size to smallest  frame.setLocationRelativeTo(null); //Centering frame  frame.setVisible(true); //Showing frame  } }   Latex Equation 1  \\frac{d}{dx}\\left( \\int_{0}^{x} f(u)\\,du\\right)=f(x).   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38  import {x, y} as p from \u0026#39;point\u0026#39;; const ANSWER = 42; class Car extends Vehicle { constructor(speed, cost) { super(speed); var c = Symbol(\u0026#39;cost\u0026#39;); this[c] = cost; this.intro = `This is a car runs at ${speed}.`; } } for (let num of [1, 2, 3]) { console.log(num + 0b111110111); } function $initHighlight(block, flags) { try { if (block.className.search(/\\bno\\-highlight\\b/) != -1) return processBlock(block.function, true, 0x0F) + \u0026#39; class=\u0026#34;\u0026#34;\u0026#39;; } catch (e) { /* handle exception */ var e4x = \u0026lt;div\u0026gt;Example \u0026lt;p\u0026gt;1234\u0026lt;/p\u0026gt;\u0026lt;/div\u0026gt;; } for (var i = 0 / 2; i \u0026lt; classes.length; i++) { // \u0026#34;0 / 2\u0026#34; should not be parsed as regexp  if (checkCondition(classes[i]) === undefined) return /\\d+[\\s/]/g; } console.log(Array.every(classes, Boolean)); } export $initHighlight;   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Hello world\u0026lt;/title\u0026gt; \u0026lt;link href=\u0026#39;http://fonts.googleapis.com/css?family=Roboto:400,400italic,700,700italic\u0026#39; rel=\u0026#39;stylesheet\u0026#39; type=\u0026#39;text/css\u0026#39;\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;index.css\u0026#34; /\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div id=\u0026#34;app\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;script src=\u0026#34;//cdnjs.cloudflare.com/ajax/libs/less.js/2.5.1/less.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;vendor/prism.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;examples.bundle.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt;   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41  /********************************************************* * General */ pre[class*=\u0026#34;language-\u0026#34;], code { color: #5c6e74; font-size: 13px; text-shadow: none; font-family: Consolas, Monaco, \u0026#39;Andale Mono\u0026#39;, \u0026#39;Ubuntu Mono\u0026#39;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; } pre[class*=\u0026#34;language-\u0026#34;]::selection, code::selection { text-shadow: none; background: #b3d4fc; } @media print { pre[class*=\u0026#34;language-\u0026#34;], code { text-shadow: none; } } pre[class*=\u0026#34;language-\u0026#34;] { padding: 1em; margin: .5em 0; overflow: auto; background: #f8f5ec; } :not(pre) \u0026gt; code { padding: .1em .3em; border-radius: .3em; color: #db4c69; background: #f9f2f4; }   Shortcodes Markdownify box This is boxmd shortcode Simple box This is **box** shortcode  Code tabs Make it easy to switch between different code\njava javascript  1  System.out.println(\u0026#39;Hello World!\u0026#39;);     1  console.log(\u0026#39;Hello World!\u0026#39;);       'use strict'; var containerId = JSON.parse(\"\\\"59ff937268b16f1f\\\"\"); var containerElem = document.getElementById(containerId); var codetabLinks = null; var codetabContents = null; var ids = []; if (containerElem) { codetabLinks = containerElem.querySelectorAll('.codetab__link'); codetabContents = containerElem.querySelectorAll('.codetab__content'); } for (var i = 0; i 0) { codetabContents[0].style.display = 'block'; }  Tabs for general purpose Windows MacOS Ubuntu  Windows section 1  console.log(\u0026#39;Hello World!\u0026#39;);   âš ï¸Becareful that the content in the tab should be different from each other. The tab makes unique id hashes depending on the tab contents. So, If you just copy-paste the tabs with multiple times, since it has the same contents, the tab will not work.\n MacOS section Hello world!  Ubuntu section Great!    'use strict'; var containerId = JSON.parse(\"\\\"7f7c6142046c0503\\\"\"); var containerElem = document.getElementById(containerId); var tabLinks = null; var tabContents = null; var ids = []; if (containerElem) { tabLinks = containerElem.querySelectorAll('.tab__link'); tabContents = containerElem.querySelectorAll('.tab__content'); } for (var i = 0; i 0) { tabContents[0].style.display = 'block'; }  Expand   Expand me  Title contents     Expand me2  Title2 contents2   Alert Colored box\nthis is a text this is a text this is a text this is a text Notice success text  info text  warning text  error text  Links and references https://blog.chenqiqian.com/posts/about-this-blog/ Click This\nChartjs Test { \u0026quot;type\u0026quot;: \u0026quot;bar\u0026quot;, \u0026quot;data\u0026quot;: { \u0026quot;labels\u0026quot;: [\u0026quot;One\u0026quot;, \u0026quot;Two\u0026quot;, \u0026quot;Three\u0026quot;, \u0026quot;Four\u0026quot;, \u0026quot;Five\u0026quot;, \u0026quot;Six\u0026quot;], \u0026quot;datasets\u0026quot;: [{ \u0026quot;label\u0026quot;: \u0026quot;# of Votes\u0026quot;, \u0026quot;data\u0026quot;: [12, 19, 3, 5, 3, 8] }] } } { \u0026quot;type\u0026quot;: \u0026quot;line\u0026quot;, \u0026quot;data\u0026quot;: { \u0026quot;labels\u0026quot;: [\u0026quot;One\u0026quot;, \u0026quot;Two\u0026quot;, \u0026quot;Three\u0026quot;, \u0026quot;Four\u0026quot;, \u0026quot;Five\u0026quot;, \u0026quot;Six\u0026quot;], \u0026quot;datasets\u0026quot;: [ { \u0026quot;label\u0026quot;: \u0026quot;# of Votes\u0026quot;, \u0026quot;data\u0026quot;: [12, 19, 3, 5, 2, 3], \u0026quot;backgroundColor\u0026quot;:\u0026quot;transparent\u0026quot;, \u0026quot;borderColor\u0026quot;:\u0026quot;orange\u0026quot; }, { \u0026quot;label\u0026quot;: \u0026quot;Some other set\u0026quot;, \u0026quot;data\u0026quot;: [15, 8, 13, 5, 5, 9], \u0026quot;backgroundColor\u0026quot;:\u0026quot;transparent\u0026quot;, \u0026quot;borderColor\u0026quot;:\u0026quot;#44ccff\u0026quot; } ] } } Flowchartjs Test st=\u0026gt;start: Start|past:\u0026gt;http://www.google.com[blank] e=\u0026gt;end: End|future:\u0026gt;http://www.google.com op1=\u0026gt;operation: My Operation|past op2=\u0026gt;operation: Stuff|current sub1=\u0026gt;subroutine: My Subroutine|invalid cond=\u0026gt;condition: Yes or No?|approved:\u0026gt;http://www.google.com c2=\u0026gt;condition: Good idea|rejected io=\u0026gt;inputoutput: catch something...|future st-\u0026gt;op1(right)-\u0026gt;cond cond(yes, right)-\u0026gt;c2 cond(no)-\u0026gt;sub1(left)-\u0026gt;op1 c2(yes)-\u0026gt;io-\u0026gt;e c2(no)-\u0026gt;op2-\u0026gt;e JS Sequence Diagram Test Alice-\u0026gt;Bob: Hello Bob, how are you? Note right of Bob: Bob thinks Bob--\u0026gt;Alice: I am good thanks! Title: Here is a title A-\u0026gt;B: Normal line B--\u0026gt;C: Dashed line C-\u0026gt;\u0026gt;D: Open arrow D--\u0026gt;\u0026gt;A: Dashed open arrow Mermaid Test graph TD; A--\u0026gt;B; A--\u0026gt;C; B--\u0026gt;D; C--\u0026gt;D; sequenceDiagram participant Alice participant Bob Alice-\u0026gt;John: Hello John, how are you? loop Healthcheck John-\u0026gt;John: Fight against hypochondria end Note right of John: Rational thoughts \u0026lt;br/\u0026gt;prevail... John--\u0026gt;Alice: Great! John-\u0026gt;Bob: How about you? Bob--\u0026gt;John: Jolly good! graph TD A[Hard] --\u0026gt;|Text| B(Round) B --\u0026gt; C{Decision} C --\u0026gt;|One| D[Result 1] C --\u0026gt;|Two| E[Result 2] gantt section Section Completed :done, des1, 2014-01-06,2014-01-08 Active :active, des2, 2014-01-07, 3d Parallel 1 : des3, after des1, 1d Parallel 2 : des4, after des1, 1d Parallel 3 : des5, after des3, 1d Parallel 4 : des6, after des4, 1d classDiagram Class01 \u0026lt;|-- AveryLongClass : Cool \u0026lt;\u0026lt;interface\u0026gt;\u0026gt; Class01 Class09 --\u0026gt; C2 : Where am i? Class09 --* C3 Class09 --|\u0026gt; Class07 Class07 : equals() Class07 : Object[] elementData Class01 : size() Class01 : int chimp Class01 : int gorilla class Class10 { \u0026lt;\u0026lt;service\u0026gt;\u0026gt; int id size() } stateDiagram [*] --\u0026gt; Still Still --\u0026gt; [*] Still --\u0026gt; Moving Moving --\u0026gt; Still Moving --\u0026gt; Crash Crash --\u0026gt; [*] pie \u0026quot;Dogs\u0026quot; : 386 \u0026quot;Cats\u0026quot; : 85 \u0026quot;Rats\u0026quot; : 15 Viz Test digraph G { subgraph cluster_0 { style=filled; color=lightgrey; node [style=filled,color=white]; a0 -\u0026gt; a1 -\u0026gt; a2 -\u0026gt; a3; label = \u0026quot;process #1\u0026quot;; } subgraph cluster_1 { node [style=filled]; b0 -\u0026gt; b1 -\u0026gt; b2 -\u0026gt; b3; label = \u0026quot;process #2\u0026quot;; color=blue } start -\u0026gt; a0; start -\u0026gt; b0; a1 -\u0026gt; b3; b2 -\u0026gt; a3; a3 -\u0026gt; a0; a3 -\u0026gt; end; b3 -\u0026gt; end; start [shape=Mdiamond]; end [shape=Msquare]; } Wavedrom Test failed.\n{ \u0026quot;signal\u0026quot;: [ {\u0026quot;name\u0026quot;: \u0026quot;CLK\u0026quot;, \u0026quot;wave\u0026quot;: \u0026quot;p.....|...\u0026quot;}, {\u0026quot;name\u0026quot;:\u0026quot;DAT\u0026quot;, \u0026quot;wave\u0026quot;:\u0026quot;x.345x|=.x\u0026quot;, \u0026quot;data\u0026quot;:[\u0026quot;A\u0026quot;,\u0026quot;B\u0026quot;,\u0026quot;C\u0026quot;,\u0026quot;D\u0026quot;]}, {\u0026quot;name\u0026quot;: \u0026quot;REQ\u0026quot;, \u0026quot;wave\u0026quot;: \u0026quot;0.1..0|1.0\u0026quot;}, {}, {\u0026quot;name\u0026quot;: \u0026quot;ACK\u0026quot;, \u0026quot;wave\u0026quot;: \u0026quot;1.....|01.\u0026quot;} ] } ","description":"Hugo and Zzo Features.","id":8,"section":"posts","tags":["test"],"title":"Hugo and Zzo Features","uri":"https://blog.chenqiqian.com/posts/hugo-and-zzo-features/"},{"content":" \u0026ldquo;è®°å½•æ—¶å…‰ä¸æ¢¦æƒ³\u0026rdquo;\n è¿™ä¸ªå°ç«™æ˜¯æˆ‘åœ¨2017å¹´12æœˆçš„æ—¶å€™å»ºç«‹çš„å•¦ã€‚é‚£ä¸ªæ—¶å€™æˆ‘åˆšä¸Šé«˜ä¸­ï¼Œåˆšå­¦OIæ²¡å¤šä¹…ï¼Œçœ‹åˆ°Menciçš„åšå®¢ï¼Œè§‰å¾—å¾ˆé…·ï¼Œäºæ˜¯è‡ªå·±ä¹Ÿæäº†ä¸€ä¸ªã€‚\n\u0008å‡ å¹´æ¥ï¼Œå°ç«™æˆä¸ºäº†æˆ‘è®°å½•ç”Ÿæ´»ã€å­¦ä¹ è¿‡ç¨‹ï¼ŒæŠ’å‘æƒ…æ€çš„ä¸€ä¸ªçª—å£ï¼Œè®©æˆ‘ç»“è¯†äº†æœ‹å‹ï¼Œä¹Ÿè®©æˆ‘åœ¨OIä¸­æœ‰æ‰€ç²¾è¿›ã€‚\nå‡ å¹´æ¥ï¼Œå°ç«™ç»å†äº†å‡ è½®é‡å»ºï¼Œä» hexo é©±åŠ¨å˜ä¸º hugo é©±åŠ¨ï¼Œä¸»é¢˜ä» next åˆ° icarus åˆ°ç°åœ¨çš„ zzo ï¼Œä¹Ÿç®—æ˜¯å°ç«™çš„æˆé•¿å§ã€‚\næŸä¹¦ä¸­æœ‰ï¼š\n To the time to life, rather than to life in time.\nâ€”â€”ç»™æ—¶å…‰ä»¥ç”Ÿå‘½ï¼Œè€Œä¸æ˜¯ç»™ç”Ÿå‘½ä»¥æ—¶å…‰ã€‚\n å¤§æ¦‚å°±æ˜¯è¿™ä¸ªå°ç«™ä¹‹æ‰€ä»¥å­˜åœ¨çš„ç›®çš„ã€‚\næ›´å¤šå…³äºæˆ‘çš„ä»‹ç»å¯ä»¥å» About é‡Œé¢çœ‹å•¦ã€‚\n  æˆ‘ä»ç„¶åœ¨ã€€æ— äººé—®æ´¥çš„é˜´é›¨éœ‰æ¹¿ä¹‹åœ°\nå’Œç€é›¨éŸ³ã€€å”±ç€æ²¡æœ‰å¬ä¼—çš„æ­Œæ›²\näººæ½®ä»æ˜¯ã€€æ¼«æ— ç›®çš„åœ°å‘ç›®çš„åœ°æ•£å»\nå¿™ç¢Œç€ã€€æ— ä¸ºç€ã€€ç»§ç»­\n ","description":"è®°å½•æ—¶å…‰ä¸æ¢¦æƒ³","id":9,"section":"posts","tags":null,"title":"å…³äºè¿™ä¸ªå°ç«™çš„ä»‹ç»","uri":"https://blog.chenqiqian.com/posts/about-this-blog/"},{"content":"This is contact page.\né‚®ç®±  cqqqwq@outlook.com cqqqwq@gmail.com  ","description":"è”ç³»cqqqwqçš„æ–¹å¼ã€‚","id":10,"section":"","tags":null,"title":"Contact","uri":"https://blog.chenqiqian.com/contact/"},{"content":" é«˜ä¸‰æ‘¸åº•è€ƒè¯•çš„ä½œæ–‡é¢˜ç›®æ˜¯ã€Œåˆå¿ƒã€ã€‚\n â€œæˆ‘å­¦ OI çš„â€œåˆå¿ƒâ€æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿâ€åˆç§‹çš„å‚æ™šï¼Œæˆ‘éª‘ç€è½¦è·¯è¿‡æ¸…åå¤§å­¦çš„é—¨å£ï¼Œè¿™ä¸ªé—®é¢˜çªç„¶å‡ºç°åœ¨æˆ‘çš„è„‘æµ·ã€‚\næœ¬æ¥è¿™é‡Œå†™äº†å¾ˆå¤šæœ‰å…³æˆ‘çš„ OI ç”Ÿæ¶¯çš„äº‹æƒ…ï¼Œå‡ ä¹éƒ½è¦å†™å®Œäº†ã€‚ä½†ä»”ç»†æƒ³æƒ³ï¼Œè¿‡å»çš„å°±è¿‡å»äº†ï¼Œè¿™äº›å›å¿†ä¹Ÿå°±è®©å®ƒå¿˜å´å§ï¼Œä¸è¦å†å¶å°”çš„ç‰µæŒ‚äº†ä¸€æ€ä¸€ç¼•çš„ç²¾åŠ›ã€‚\næˆ‘æƒ³ï¼Œæˆ‘å­¦ OI çš„â€œåˆå¿ƒâ€å¯èƒ½æ˜¯ï¼šå®ƒèƒ½ç»™æˆ‘å¿«ä¹ã€‚åšé¢˜å¯ä»¥ç»™æˆ‘å¿«ä¹ã€‚åšé¢˜éƒ½æ˜¯ä¸€ç§çŸ­æœŸå›æŠ¥éå¸¸å¤§çš„äº‹æƒ…ï¼Œè€Œ OI çš„çŸ¥è¯†ç‚¹å¤šè€Œå°çš„ç‰¹ç‚¹è®©å­¦ä¹ çš„å›æŠ¥ä¹Ÿå˜å¾—ååˆ†å®¹æ˜“è·å¾—ã€‚å½“ä½ æˆ–ä»ä¹¦ä¸Šæˆ–ä»ç½‘ä¸Šçš„åšå®¢ä¸Šå­¦ä¹ åˆ°ä¸€ä¸ªæ–°çš„çŸ¥è¯†ç‚¹ï¼Œé©¬ä¸Šå°±èƒ½æŠŠå®ƒåº”ç”¨åˆ°å®è·µå½“ä¸­ï¼Œæ‰‹æŒ‡çš„ç¿»é£ï¼Œé»‘è‰²èƒŒæ™¯å’Œç™½è‰²å­—ä½“çš„ç¢°æ’è®©äººçš„å¿ƒçµå¾—ä»¥æ²‰æµ¸åœ¨çŸ¥è¯†çš„æµ·æ´‹ä¸­ï¼Œè€Œç»¿è‰²çš„åŠæ—¶åé¦ˆï¼Œæˆ–æ˜¯æˆ–éçš„äºŒåˆ†å›æŠ¥ï¼Œä»é”™å˜æˆå¯¹çš„æ¿€åŠ¨ç¬é—´ï¼Œè¿™ä¸€åˆ‡éƒ½ç»™äº†æˆ‘æ— æ¯”çš„æ¬¢æ„‰ã€‚è¯¾å ‚ä¹Ÿå¯ä»¥ç»™æˆ‘æ„‰æ‚¦ã€‚å’Œå‡ ä¸ªçŸ¥å¿ƒçš„æœ‹å‹ååœ¨ä¸€èµ·æœ‰è¯´æœ‰ç¬‘ï¼Œè¯¾å ‚å¼€æ”¾çš„æ°”æ°›ï¼Œèˆ’é€‚çš„ç¯å¢ƒï¼Œæˆ‘ä»¬ä¸åƒå…¶ä»–ç«èµ›é‚£æ ·åœ¨å°å°çš„è¯¾æ¡Œå‰é’»ç ”çŸ¥è¯†ï¼Œæˆ‘ä»¬ååœ¨ç”µè„‘å‰ï¼Œçœ¼å‰å¿ƒä¸­çš„å¢ƒç•Œæˆ–è®¸éƒ½èƒ½é«˜ä¸Šè®¸å¤šã€‚ä¸åƒå…¶ä»–ç«èµ›ï¼Œå³ä½¿ä½ ä¸æ˜¯æœ€å¼ºçš„äººï¼Œä½ ä¹Ÿå¯ä»¥åœ¨æŸäº›æŠ€å·§ä¸Šæ¯”åˆ«äººå¥½ï¼Œå› æ­¤æ‰€æœ‰äººéƒ½å¯ä»¥ç«™ä¸Šè®²å°å½“å…¶ä»–äººçš„â€œè€å¸ˆâ€ã€‚æˆ‘è¿˜è®°å¾—ç«™åœ¨è®²å°ä¸Šè°ˆç¬‘é£ç”Ÿçš„ä¸€ä¸ªä¸ªç¬é—´ï¼Œè°åˆèƒ½è¯´ï¼Œè¿™ä¸æ˜¯ä¸€åœºæˆé•¿å‘¢ã€‚è¿˜æœ‰ä¹Ÿè®¸æ˜¯é‚£å‡ ä¸ªå¿—åŒçš„æœ‹å‹ã€‚ä¹Ÿè®¸æˆ‘ä»¬ç°åœ¨æ—©å·²åˆ†é“æ‰¬é•³ï¼Œä½†ä¸¤å¹´åŒå­¦ OI çš„æƒ…è°Šï¼Œäº’å¸®äº’åŠ©çš„æ¸©æš–ï¼Œæ·±å¤œçº¦CFçš„é™è°§ï¼Œæˆ‘çœŸçš„ä¹Ÿè®¸ä¸€ç”Ÿéƒ½ä¸ä¼šå¿˜è®°ã€‚æˆ–è®¸ï¼Œè¿™å°±æ˜¯æ”¯æŒæˆ‘èƒ½å¤Ÿåœ¨è¿™ä¹ˆä¸€æ¡ç‹­çª„çš„ç‹¬æœ¨æ¡¥ä¸Šä¸æ–­å‰è¡Œçš„æ ¹æœ¬åŠ¨åŠ›å§ã€‚\nå½“ç„¶ä¸å¯å¦è®¤ï¼Œæˆ‘å­¦ OI çš„â€œåˆå¿ƒâ€è‚¯å®šæœ‰å‡å­¦çš„å› ç´ ã€‚æ¯•ç«Ÿ OI ä½œä¸ºäº”å¤§ç«èµ›ä¹‹ä¸€ï¼Œåœ¨å‡å­¦ä¸Šçš„ç”¨å¤„ä¹Ÿæ˜¯éå¸¸å¤§çš„ã€‚è¯´æ¥æç¬‘ï¼Œåˆå­¦çš„æ—¶å€™ï¼Œæˆ‘å¯èƒ½æ›¾ç»è¿˜å¹»æƒ³è¿‡é›†è®­é˜Ÿä¹‹ç±»çš„ä¸œè¥¿ï¼Œä½†åæ¥å‘ç°ï¼Œä¸è¿‡é•œèŠ±æ°´æœˆè€Œå·²ã€‚ç¬¬ä¸€å¹´çš„è€ƒè¯•æˆ–è®¸è¿˜å¯ä»¥æ²¡æœ‰å‹åŠ›ï¼Œä½†ç¬¬äºŒå¹´ä»¥æ¥çš„å„ç§è€ƒè¯•æˆ–è®¸å°±ä¼šåœ¨æ— å½¢ä¹‹ä¸­ç»™äº†æˆ‘å¾ˆå¤§çš„å‹åŠ›ã€‚ä½†å…¶å®è¯´æ¥ä¹Ÿæç¬‘ï¼Œæˆ‘è€ƒçš„ä¸ºæ•°ä¸å¤šçš„å‡ åœºè¯•è™½ç„¶éƒ½æ²¡æ€ä¹ˆè€ƒå¥½ï¼Œä½†æˆ‘çš„å¿ƒæ€å´æ˜¯ååˆ†çš„åº·å¥ã€‚ä¹Ÿè®¸æˆ‘å°±æ˜¯è¿™ä¹ˆä¸€ä¸ªä¹å¤©çš„äººå§ã€‚è¯å½’æ­£ä¼ ï¼Œæˆ‘ä¹Ÿç”±è¡·çš„æ„Ÿè°¢ OI ï¼Œè‡³å°‘è®©æˆ‘æ”¶è·äº†ä¸€ä¸ªçœä¸€ï¼Œè®©æˆ‘èƒ½å¤Ÿåœ¨è‡ªä¸»æ‹›ç”Ÿä¸­æˆ–æœ‰æˆ–æ— çš„å æœ‰é‚£ä¹ˆä¸€ç‚¹ç‚¹çš„ä¼˜åŠ¿å§ã€‚\nå…¶å®æœ¬æ¥è¿™ç¯‡æ–‡ç« æ˜¯æƒ³å›å¿†ä¸€ä¸‹æˆ‘çš„ OI ç”Ÿæ¶¯ï¼Œä½†äº‹å®ä¸Šä¹Ÿæ²¡æœ‰ä»€ä¹ˆå¥½å›å¿†çš„ï¼›é™¤äº†çºªå¿µç€ä¸é•¿ä¸çŸ­çš„ OI ç”Ÿæ¶¯ï¼Œæˆ‘å¯èƒ½ä¸»è¦è¿˜æ˜¯æƒ³ç»™â€œåä¹‹è§ˆè€…â€ä¸€äº›æ•™è®­å§ã€‚\né¦–å…ˆï¼Œè¦å…¨èº«å¿ƒçš„æŠ•å…¥ï¼Œâ€œç¬ƒå‰è¡Œè€Œå‹¿é¡¾åâ€ï¼›å…¶æ¬¡ï¼Œæ°¸è¿œä¸è¦å¯¹è‡ªå·±å¤±å»ä¿¡å¿ƒï¼Œæ¯•ç«Ÿä¸åˆ°æœ€åçš„åˆ†æ•°å‡ºç°åœ¨å¤§å±å¹•ä¸Šï¼Œä½ æ°¸è¿œéƒ½ä¸ä¼šçŸ¥é“ä½ çš„çœŸæ­£å®åŠ›å¦‚ä½•ã€‚\næ²¡æœ‰ä»€ä¹ˆå¯ä»¥å†è¯´äº†ã€‚\nè°¨ä»¥æ­¤æ–‡ä½œä¸ºæˆ‘å¯¹ OI æœ€åçš„çºªå¿µã€‚\n","description":"","id":11,"section":"posts","tags":null,"title":"ã€Œéšç¬”ã€åˆå¿ƒ","uri":"https://blog.chenqiqian.com/posts/essay-first-mind-oi/"},{"content":"GoodBye, OI.\nå¤ªé•¿ä¸çœ‹ç‰ˆ  è€ƒçš„è¿˜ä¸é”™ï¼Œrk19 é€€å½¹ã€‚\n è¯´åœ¨å‰é¢ å¥½å¥½çš„BJWCå°±ç»™å–æ¶ˆäº†å•Šã€‚\nWeek -2 Day1 2019-04-06 ç¬¬ä¸€å¤©ï¼Œåˆæ˜¯ç†Ÿæ‚‰çš„é¦–å¸ˆå¤§é™„ä¸­ã€‚\nä»Šå¤©å……æ»¡äº†é”…çš„å‘³é“ã€‚\né¦–å…ˆæ˜¯æ™šå¼€å§‹äº†åŠä¸ªå°æ—¶emmæ‰€ä»¥æœ¬æ¥æ‰é¸¡çš„ä¸‰ä¸ªå°æ—¶æ—¶é—´å°±å˜æˆäº†ä¸¤ä¸ªåŠå°æ—¶ï¼ˆè™½ç„¶åæ¥è¡¥äº†åŠä¸ªå°æ—¶ï¼‰\nç„¶å 9:30 æ‰“å¼€é¢˜\u0026hellip;æ€ä¹ˆæ–‡ä»¶åæ˜¯ 0612.pdf ï¼Ÿï¼Ÿï¼Ÿæ€ä¹ˆå†…å®¹æ˜¯å±±ä¸œçœé˜Ÿé›†è®­ï¼Ÿï¼Ÿï¼Ÿ\nå¥½å§å¥½å§åšå§åšå§ã€‚\nT1 å•¥å•Šï¼ŸçŸ©é˜µå•¥ç©æ„ï¼Ÿæˆ‘å’‹çœ‹ä¸æ‡‚é¢˜ï¼Ÿå’‹æ²¡æœ‰éƒ¨åˆ†åˆ†å•Šï¼Ÿï¼Ÿï¼Ÿ\nT2 å•¥å•Šï¼Ÿå›¾å’Œç”Ÿæˆæ ‘çš„é‚£ä¸€å¥—ç†è®ºï¼Ÿï¼Ÿï¼Ÿæˆ‘ä¸ä¼šå•Šï¼Ÿï¼Ÿï¼Ÿå’‹æ²¡æœ‰éƒ¨åˆ†åˆ†å•Šï¼Ÿï¼Ÿï¼Ÿ\nT3 å•¥å•Šï¼Ÿçœ‹èµ·æ¥åƒä¸ªç±»ä¼¼å­—ç¬¦ä¸²çš„ dp ï¼Ÿä¸ºä»€ä¹ˆ lzy åœ¨æˆ‘æ—è¾¹å†™ SA ï¼Ÿï¼Ÿï¼Ÿæœ‰éƒ¨åˆ†åˆ†ï¼Ÿè®©æˆ‘æ¨æ¨\u0026hellip;\næ¨å•Šæ¨ T3\u0026hellip;å¥½åƒå¯ä»¥æå‡ºä¸€ä¸ª dpï¼Œä½†æ˜¯å¥½åƒæ²¡æ³•æ»¡è¶³ç¬¬ä¸€ä¸ªè¦æ±‚å•Šã€‚\nå†™å•Šå†™å•Šå†™ï¼Œæ¨å•Šæ¨å•Šæ¨\u0026hellip;ä¸€ä¸ªå¤šå°æ—¶è¿‡å»ï¼Œå¤§æ¦‚å†™äº†ä¸ªå“ˆå¸Œ+äºŒåˆ†+äºŒåˆ†ä¹‹ç±»çš„ä¸œè¥¿ï¼›å¤§æ¦‚è·‘è¿‡äº†æ ·ä¾‹\u0026hellip;ç„¶åå‘ç°æ˜¯æœ‰é”…çš„\u0026hellip;èƒ¡ä¹±æäº†ä¸ªè´ªå¿ƒä¸Šå»\u0026hellip;\nçœ‹ T1 \u0026hellip;å“¦æˆ‘ç»ˆäºçœ‹æ‡‚äº†é¢˜æ„\u0026hellip;è¯¶èƒ¡ä¹±çŒœç»“è®º\u0026hellip;æ˜¯ä¸æ˜¯çº¿æ€§æ— å…³å°±å¯ä»¥å°‘ä¸€æ¬¡æ“ä½œå•Š\u0026hellip;é‚£ä¹ˆé«˜æ–¯æ¶ˆå…ƒæ¶ˆæ¶ˆæ¶ˆ\u0026hellip;åˆå†™äº†ä¸ªç±»ä¼¼çº¿æ€§åŸºçš„ä¸œè¥¿æ‹ä¸€æ‹\u0026hellip;å¥½åƒç²¾åº¦ä¸å¤ªå®¹æ˜“å‡ºé”…\u0026hellip;ä¸ç®¡äº†ä¸ç®¡äº†\u0026hellip;\nè¿™ä¸ªæ—¶å€™è¯´è¿˜å¯ä»¥å†å†™åŠä¸ªå°æ—¶\u0026hellip;ä¸å†™äº†ä¸å†™äº†æˆ‘è¦åƒé¥­\u0026hellip;\näºæ˜¯å°±äº¤äº†ç¨‹åºå»åƒé¥­\u0026hellip;\né¥­å¾ˆå¥½åƒã€‚\né¥­çœŸçš„å¾ˆå¥½åƒã€‚\né¥­çœŸçš„è¶…çº§å¥½åƒã€‚\nä¸‹åˆè®²é¢˜\u0026hellip;\nT1 Aæ‰äº†ï¼Œå¤šäºè¿™é“é¢˜æ²¡æœ‰çˆ† 0 qaq\nå¥½åƒå…¨ä¸–ç•Œéƒ½ä¼šT2ï¼Ÿå°±æ˜¯ä¸ªå¥‡è‘©æ„é€ ï¼Ÿå¥½å§\u0026hellip;\nT3 çš„è´ªå¿ƒæœç„¶å‡äº†ï¼Œç„¶åè·å¾—äº† 0 åˆ†çš„å¥½æˆç»©\u0026hellip;å¥½æ­¹ä¹Ÿæƒ³åˆ°äº†æ­£è§£çš„ä¸€åŠå‘¢\u0026hellip;ä¹Ÿä¸å¤šç»™ç‚¹åˆ†æ•°\u0026hellip;\nå¹¶åˆ—æ’å 20-49 å emmmå¾ˆç¬¦åˆè’Ÿè’»çš„æœ¬è´¨äº†\u0026hellip;\nè®²è¯¾è®²çš„æ˜¯ç½‘ç»œæµï¼Œå¥½åƒä¸æ˜¯å¾ˆéš¾ï¼Œä¹Ÿæ²¡æ€ä¹ˆå¬ã€‚\nä¸‹åˆéª‘è½¦å›å®¶\u0026hellip;ä¸é”™å•Šqwq\nDay2 2019-04-07 åˆæ˜¯ç†Ÿæ‚‰çš„é¦–å¸ˆå¤§é™„ä¸­å—¯ã€‚\nhyc åŒå­¦æå‰è¿›å…¥äº†ç³»ç»Ÿè¢«é¦–å¸ˆå¤§çš„è€å¸ˆè®­æ–¥äº†ï¼ˆå¹¶ä¸”ä¸ºäº†ç»™ hyc åŒå­¦ä¸‹å°çš„æœºä¼šï¼šâ€œå°é»„åŒå­¦åœ¨è¿™ä¸ªå±‹å­é‡Œä¸æ˜¯ç¬¬ä¸€ä¹Ÿæ˜¯ç¬¬äºŒåâ€ï¼‰\nä»Šå¤©è€ƒè¯• 8:30 å°±å¼€å§‹äº†è€ƒè¯•ï¼Œé¢˜ç›®ç»ˆäºæ˜¯ BJOI å¼€å¤´çš„é¢˜ç›®äº†2333\nT1 å•¥å•Šï¼Ÿæ€ä¹ˆæœ‰åœ°å›¾å•Š\u0026hellip;ä¸‹ä¸€é¢˜\u0026hellip;\nT2 å•¥å•Šï¼Ÿæ€ä¹ˆåˆæ˜¯å›¾å’Œç”Ÿæˆæ ‘çš„é‚£ä¸€å¥—ç†è®ºå•Šï¼Ÿè¿™æ¬¡è¿˜è¦ç®—æ•°\u0026hellip;ä¸‹ä¸€é¢˜\u0026hellip;\nT3 å•¥å•Šï¼Ÿæ€ä¹ˆåˆæ˜¯å›¾è®ºä¸­å­˜åœ¨æ€§æŸ“è‰²é—®é¢˜å•Šï¼Ÿï¼Ÿï¼Ÿä¸ä¼šåƒå»å¹´çœé€‰é‚£æ ·éšä¾¿çŒœä¸ªç»“è®ºå°±è¿‡äº†å§\u0026hellip;\nå…ˆçœ‹ T1 å§ã€‚æˆ‘å¯ä»¥é¢„å¤„ç†ä¸€æ³¢\u0026hellip;ç„¶åå˜æˆä¸€ä¸ªå•¥é—®é¢˜..ï¼Ÿæ¯å››ä¸ª B ç‰©å“å¿…é¡»é€‰ä¸€ä¸ªï¼Ÿï¼Ÿï¼Ÿå’‹åšå•Š\u0026hellip;æ€ä¹ˆå°±ä¸¤æ¡£ subtask å•Š ï¼ˆ40/40+60ï¼‰\u0026hellip;\nä¸ç®¡äº†å…ˆå†™ä¸ªé¢„å¤„ç†\u0026hellip;æƒ³æƒ³æƒ³å†™å†™å†™ 2h å°±è¿™ä¹ˆè¿‡å»äº†\u0026hellip;æˆ‘æ€ä¹ˆè¿˜æ˜¯ä¸ä¼šåé¢çš„æ“ä½œå•Š\u0026hellip;å…¶é—´è„‘è¡¥äº†è‹¥å¹²ä¸ªå‡çš„åšæ³•\u0026hellip;\nå¥½å§å…ˆæ”¾ç€æˆ‘å»æƒ³æƒ³åé¢çš„é¢˜\u0026hellip;\nT2 10 åˆ† $k = 0$ æˆ‘ä¼š233 å°±æ˜¯æ±‚ä¸€ä¸ªç”Ÿæˆæ ‘ä¸ªæ•°å˜›\u0026hellip;åé¢çš„éƒ¨åˆ†åˆ†å¥½åƒä¹Ÿä¸æ˜¯å¾ˆéš¾\u0026hellip;\nå†çœ‹çœ‹ T3\u0026hellip; è¯¶ï¼Ÿå¥½åƒæœ‰ä¸ªä»€ä¹ˆsbæ€§è´¨ï¼Ÿï¼Ÿåªä¼šå¿…è¦æ€§ä¸ä¼šå……åˆ†æ€§ï¼Œé‚£è‚¯å®šå°±æ˜¯äº†ã€‚å¯ä»¥ä» $O(2^{2n})$ ä¼˜åŒ–åˆ° $O(2^n)$ \u0026hellip; å¥½åƒå¯ä»¥æœ‰ 40 åˆ†äº†è¯¶\u0026hellip;æ‰“äº†ä¸ªå¤§æš´åŠ›å’Œå°æš´åŠ›æ‹æ‹\u0026hellip;å—¯è¿‡äº†é‚£è¿™ä¸ªç»“è®ºå¥½åƒæ˜¯å¯¹çš„\u0026hellip;\nå’¦ï¼Ÿæˆ‘å·¦è¾¹çš„äººæ€ä¹ˆ T1 å†™äº† 500 è¡Œï¼Ÿï¼Ÿï¼Ÿï¼ˆèµ›åå‘ç°æ­¤äºº A æ‰äº†æ­¤é¢˜\u0026hellip;ï¼‰ å’¦ï¼Ÿæˆ‘å³è¾¹çš„äººæ€ä¹ˆå†çœ‹ vim çš„æ–‡æ¡£ï¼Ÿï¼Ÿï¼Ÿå¥½å§\u0026hellip;\nè¯¶ï¼ŸT3 å¥½åƒä¸éœ€è¦æšä¸¾å­å›¾\u0026hellip;å°±æ˜¯æœ€å¤§æƒé—­åˆå­å›¾å•Š\u0026hellip;å•Šï¼è¿™ä¸ªæˆ‘ä¼šï¼çœ‹çœ‹è¡¨\u0026hellip;è¿˜æœ‰å››ååˆ†é’Ÿ\u0026hellip;æ²¡äº‹æ²¡äº‹\u0026hellip;\nå¼€å§‹ç  dinic \u0026hellip;å‰å‡ å¤©å†™äº†ç½‘ç»œæµ 24 é¢˜\u0026hellip; dinic çš„æ¿å­éƒ½å¿«èƒ½ä¸çœ‹é”®ç›˜æ•²å‡ºæ¥äº†\u0026hellip;è¯´åˆ°é”®ç›˜\u0026hellip;æˆ‘çš„é”®ç›˜çš„ backspace å±…ç„¶æ˜¯åçš„\u0026hellip;è¿™å¯¹äºä¸€ä¸ªæ‰‹æ®‹é€‰æ‰‹çœŸçš„æ˜¯\u0026hellip;\n10 åˆ†é’Ÿå¤šä¸€ç‚¹æ•²å®Œ dinic ï¼ˆæˆ‘ç”¨è‡ªå·±çš„ç¬”è®°æœ¬å¯ä»¥ 7 åˆ†é’Ÿå·¦å³æ•²å®Œçš„ï¼‰ï¼Œå»ºå›¾å¾ˆ easy ï¼Œæ‹æ‹æ‹æ­»æ´»æ‹ä¸è¿‡\u0026hellip;ç„¶åçŒ›ç„¶å‘ç°æ˜¯è¦æœ€å¤§æƒéç©ºé—­åˆå­å›¾\u0026hellip;è‡ªé—­\u0026hellip;æŠŠæš´åŠ›äº¤ä¸Šå»äº†\u0026hellip;\nå—¯ã€‚å‡ºåˆ†å€’æ˜¯æ²¡æŒ‚åˆ†\u0026hellip;\nT1 æ²¡å­¦è¿‡ 2-SAT + æ²¡å‘ç°å…‰è·¯å¯é€†\u0026hellip;æ²¡åŠæ³•å§\nT2 ç¥ä»™æ•°å­¦\u0026hellip;å€’æ˜¯æˆ‘å°‘çœ‹åˆ° 30 åˆ†æš´åŠ› emmm\nT3 ä¸ºä»€ä¹ˆæšä¸¾å¿…é€‰ä¸€ä¸ªç‚¹ç„¶åå¤šè·‘ 500 å€æ¬¡æ•° dinic å¯ä»¥è¿‡ åˆç€ 50 æ¬¡ dinic 0.04sï¼Ÿï¼Ÿï¼Ÿ ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿæˆ‘éƒ½åœ¨æ­£è§£é—¨å£äº†å•Šå–‚\u0026hellip;å·®ç‚¹å°± 100 åˆ†äº†å•Š\u0026hellip;\næœ€å rk30 \u0026hellip;ä¹Ÿå·®ä¸å¤šå§\u0026hellip;\nä¸‹åˆæ‚é¢˜é€‰è®²åœ¨å†™å‘¨æœ«ä½œä¸šï¼Œæ²¡å¬ã€‚\nrdfzhyc å’Œ çœŸæ­£çš„ hyc åˆ‡é¢˜éƒ½åˆ‡çš„å¾ˆæ¬¢ä¹ orz\nWeek -1 Day1 2019-04-13 å¤§æ¦‚æ˜¯æœ‰å²ä»¥æ¥åœ¨çœé‡Œæ’åæœ€é«˜çš„ä¸€æ¬¡å‘¢\u0026hellip;\nè¿›åœºè¦æ±‚æ¢äº†ä¸ªé”®ç›˜ï¼Œæ„Ÿè§‰æ¯”ä»¥å‰çš„é‚£ä¸ªå¥½å¤šäº†\u0026hellip;\n8:30 å¼€å§‹è€ƒè¯•çœ‹é¢˜ã€‚\nT1çœ‹èµ·æ¥å°±æ˜¯ä¸ªdp\u0026hellip;emmå¥½åƒè¿æœ€å°éƒ¨åˆ†åˆ†éƒ½ä¸ä¼š\u0026hellip;\nT2æ•°æ®èŒƒå›´ $10^5$ è€¶ï¼æ ‘ä¸Šçš„é¢˜ï¼è€¶ï¼çœ‹çœ‹å•Š\u0026hellip;è¯¶å…ˆå†™ä¸ª 20 åˆ† $O(n^2)$ æš´åŠ›å§\u0026hellip;å¤§æ¦‚ 10 åˆ†é’Ÿå¤šå¤§æ¦‚è¿‡äº†\u0026hellip;\nä»”ç»†ç ”ç©¶ä¸€ä¸‹\u0026hellip;ç»Ÿè®¡æ‰€æœ‰è·¯å¾„ä¸­æ»¡è¿™ä¸ªä¸œè¥¿å¥½åƒå¯ä»¥ç‚¹åˆ†æ²»ï¼Œå›å¿†äº†ä¸€æ³¢ç‚¹åˆ†æ²»æ€ä¹ˆå†™\u0026hellip;\nç„¶åå¼€å§‹å†™ç‚¹åˆ†æ²»\u0026hellip;å¤§æ¦‚å†™äº†ä¸€ä¸ªå°æ—¶å†™åˆ°æœ€åçš„ä¸¤ä¸ª dfs\u0026hellip;ç„¶åå‘ç°è‡ªå·±çš„ä¸€ä¸ª dfs å‡äº†\u0026hellip;æƒ³äº†æƒ³å¥—äº†ä¸€ä¸ªå·¦åæ ‘ä¸Šå»ä»ä¸‹å¾€ä¸Šåˆå¹¶ï¼Œç„¶åäºæ˜¯å¤šäº†ä¸€ä¸ª $\\log$ \u0026hellip;å¤§æ¦‚ä¸¤ä¸ªå°æ—¶è°ƒè¿‡äº† T2 \u0026hellip;\nç„¶åçœ‹ T3\u0026hellip;T3 çš„æš´åŠ›å¥½åƒéå¸¸è½»æ¾\u0026hellip; 20 åˆ†çš„ $O(n^3)$ æš´åŠ› 5 åˆ†é’Ÿå°±å†™å®Œäº†\u0026hellip;ç„¶åæ¨äº†æ¨å¼å­å‘ç° $O(n^2)$ çš„æ–œç‡ä¼˜åŒ–ä¹Ÿéå¸¸æ˜¾ç„¶\u0026hellip;\nç„¶åå¿½ç„¶æƒ³èµ·æ¥\u0026hellip;ä»€ä¹ˆï¼Ÿn ä¸ªä¸œè¥¿åˆ†æˆ k ä»½ï¼Ÿï¼Ÿï¼Ÿæˆ‘ä¼š wqs äºŒåˆ†ï¼ï¼ï¼\næ‰“ä¸ªè¡¨å‘ç°çš„ç¡®æœ‰å‡¸æ€§\u0026hellip;ç„¶åå†™äº†ä¸ª wqs äºŒåˆ† + æ–œç‡ä¼˜åŒ–\u0026hellip;20åˆ†é’Ÿå°±å†™å®Œäº†\u0026hellip;å¯¹æ‹æ‹æ‹æ”¹æ”¹æ”¹è¿‡è¿‡è¿‡\u0026hellip;\nç„¶åæœ€åè¿˜å‰©ä¸‹åŠä¸ªå¤šå°æ—¶\u0026hellip;å†™äº†å†™ T1 çš„æš´åŠ›æ²¡å†™å®Œ\u0026hellip;\nä¸­åˆé¥­è¿˜æ˜¯ä¸€å¦‚æ—¢å¾€çš„å¥½åƒ\u0026hellip;\nä¸‹åˆå…ˆè®²äº† COCI çš„é¢˜ç›®è‹¥å¹²ï¼Œé¢˜ç›®æ˜¯ç›¸å½“çš„æ¯’ç˜¤å‘€qaqï¼ˆæˆ‘ä¸€ç›´åœ¨æ‰“æ¸¸æˆ \u0026amp; å†™æ•°å­¦ä½œä¸š\nç„¶å 3 ç‚¹å¤šçš„æ—¶å€™å‡ºæˆç»©äº†\u0026hellip;ç¬¬ä¸‰é¢˜å› ä¸º eps è®¾å¤§äº†è€ŒæŒ‚äº† $30$ åˆ†\u0026hellip;\näºæ˜¯å°± rk6 ã€‚\nå¦‚æœçœé€‰èƒ½è¿™ä¹ˆé«˜çš„è¯å¤§æ¦‚å°±å¯ä»¥ç¿»ç›˜äº†å§ï¼ˆ\nå°±ç®—è¿›é˜Ÿäº†æˆ‘ä¹Ÿä¸ä¼šå» NOI çš„\u0026hellip;\nWeek 0 Day1 2019-04-20 æ­£å¼æ¯”èµ›æ—¥ã€‚\nä»Šå¤©èµ·çš„æ ¼å¤–çš„æ—©\u0026hellip;ä¸‰å‘¨æ²¡æœ‰æ—¶é—´è¡¥è§‰ï¼Œæ„Ÿè§‰è‡ªå·±çš„ç²¾åŠ›å¿«è¦è¢«è€—å°½äº†\u0026hellip;\næ—©ä¸Šå…«ç‚¹å¼€å§‹è€ƒè¯•ã€‚\nT1 çœ‹äº†çœ‹ã€‚å¾ˆåƒä¸€ä¸ª AC è‡ªåŠ¨æœºä¸Šèƒ¡é€¼ dp ã€‚\nT2 çœ‹äº†çœ‹ã€‚å“‡ã€‚é¢˜é¢å¥½é•¿ã€‚å®ƒåœ¨è®²å•¥å‘¢\u0026hellip;å“¦å¥½åƒæ˜¯ä¸ªæ•°å­¦é¢˜ã€‚\nT3 çœ‹äº†çœ‹ã€‚å“‡ã€‚é¢˜é¢æ€ä¹ˆæ¯” T2 è¿˜é•¿å•Šã€‚çœ‹ç€æ€ä¹ˆè¿™ä¹ˆåƒä¸€ä¸ªä¹±æé¢˜å•Š\u0026hellip;ä»”ç»†çœ‹çœ‹\u0026hellip;ä¸ä¼šå‘Šè¾\u0026hellip;\nå›å»æ¨äº†æ¨ T1 ã€‚å¥½åƒæœ‰ä¸€ä¸ª $O(n^3 \\sqrt n)$ çš„æ˜¾ç„¶ dp \u0026hellip;emmm å–ä¸ªå¯¹æ•°å°±å˜æˆäº†å‡ ä½•å¹³å‡å€¼äº†å•Šã€‚å’¦ï¼Ÿå‡ ä½•å¹³å‡å€¼\u0026hellip;æˆ‘ä¼š 0/1 åˆ†æ•°è§„åˆ’\u0026hellip;è„‘è¡¥äº†ä¸€æ³¢å¼€å§‹å†™å†™å†™\u0026hellip;å¾—æœ‰å‡ ä¸ªæœˆæ²¡å†™è¿‡ AC è‡ªåŠ¨æœºäº†\u0026hellip;ACè‡ªåŠ¨æœºé”™ï¼ŒACè‡ªåŠ¨æœºé”™å®Œ dp é”™\u0026hellip; æƒ³+å†™+è°ƒäº†ä¸¤ä¸ªå°æ—¶ç»ˆäºè¿‡äº†æ ·ä¾‹\u0026hellip;\näºæ˜¯çœ‹ T2 ã€‚å•¥ç©æ„å•Š\u0026hellip;åªä¼š40åˆ†\u0026hellip;å†™äº†äº› 150 è¡Œ+ç»ˆäºè¿‡æ‰äº†40åˆ†çš„æš´åŠ›åˆ†\u0026hellip;\nçœ‹äº†çœ‹ T3 \u0026hellip;æ„Ÿè§‰å¦‚æœå†™ 100 è¡Œä¹Ÿå°±æ˜¯ 10 åˆ†\u0026hellip;ä¸å†™äº†\u0026hellip;æŸ¥æŸ¥ T1 \u0026amp; T2\u0026hellip;\nç„¶åå°± 13 ç‚¹æ¯”èµ›ç»“æŸäº†\u0026hellip;\nåƒé¥­çš„æ—¶å€™å‘ç°å¹¶ä¸æ€ä¹ˆå¥½\u0026hellip;æˆ‘æ ¡é™¤äº† dmy æ²¡äººä¼šåš T2\u0026hellip; hyc ä¼šåš T3 æ€’åˆš 4h è¿‡æ‰å¤§æ ·ä¾‹ç„¶åå°±æ²¡å‘ç° T1 æ˜¯ä¸€ä¸ªç­¾åˆ°é¢˜\u0026hellip; jkp å¤§æ¦‚è·Ÿæˆ‘æ‰“çš„åˆ†æ˜¯ä¸€æ ·å¤šçš„\u0026hellip;\nåƒå®Œé¥­ä¹‹åç­‰åˆ°å¿« 3 ç‚¹å¼€å§‹è®²é¢˜\u0026hellip;æˆ‘è·å¾—äº† 105 åˆ†\u0026hellip; T1 è¢«å¡å¸¸ TLE äº† 20 åˆ†\u0026hellip; T2 ä¸çŸ¥é“å“ªé‡Œæé”™äº† 40 -\u0026gt; 25 \u0026hellip;å’‹ä¸€ä¸å°å¿ƒå°± rk13 äº†å‘¢\u0026hellip;\nhyc T3 çˆ†åˆ° 30 äº†\u0026hellip; jkp è¢«å¥³é€‰æ‰‹æš´æ‰“äº†\u0026hellip;ä¸è¿‡è¿˜åœ¨é˜Ÿçº¿ä¸Š\u0026hellip;\ndmy ä»ç„¶æ˜¯å¤©ä¸‹ç¬¬ä¸€\u0026hellip;\næ˜å¤© hyc ä¸€å®šèƒ½ç¿»ç›˜çš„ï¼\njkp ä¸€å®šèƒ½è‹Ÿä½é˜Ÿçº¿çš„ï¼\næˆ‘ä¸€å®šèƒ½é€€å½¹çš„ï¼\nDay2 2019-04-21 8 ç‚¹å¼€è€ƒã€‚\nä»Šå¤©å‡ºäº†ä¸€äº›å°é”…\u0026hellip;ä¸è¿‡ä¹Ÿæ˜¯åœ¨å…«ç‚¹å¼€å§‹äº†ã€‚\nå¼€å±€çœ‹ T1 \u0026hellip;å’¦ï¼Ÿå¥½æƒ³æ˜¯ä¸ª sb dpï¼Ÿï¼Ÿï¼Ÿ $O(nms) = 2 \\times 10^8$ å¸¸æ•°å°èƒ½è¿‡å§\u0026hellip;100åˆ†æœ‰äº†\u0026hellip;\nçœ‹ T2 ã€‚å§æ§½ï¼Ÿæ€ä¹ˆæ˜¯ä¸ªç‰©ç†é¢˜ï¼Ÿçœ‹èµ·æ¥æ˜¯ä¸ªæ— ç©·ç­‰æ¯”æ•°åˆ—æ±‚å’Œï¼Œæˆ‘ä¼šå•Šï¼ˆ\næ¨äº†æ¨å¼å­ã€‚å†™äº†æ€ä¹ˆéƒ½è°ƒä¸è¿‡å°æ ·ä¾‹\u0026hellip;å’¦ï¼Ÿæ¨¡æ•°æ˜¯å¤šå°‘ï¼Ÿ1e9+7ï¼Ÿï¼Ÿï¼Ÿæˆ‘æ€ä¹ˆæ•²æˆäº†998244353\u0026hellip;ç„¶åè¿‡æ‰äº†ç¬¬ä¸€ä¸ªæ ·ä¾‹\u0026hellip;æµ‹ç¬¬äºŒä¸ªä¸‰å—ç»ç’ƒçš„æ ·ä¾‹åˆ Wa äº†\u0026hellip;ä»”ç»†æƒ³æƒ³è§‰å¾—è¿˜è¦å¤šç»´æŠ¤ä¸¤ä¸ªä¸œè¥¿æ‰èƒ½åˆå¹¶\u0026hellip;äºæ˜¯å°±å†™äº†ç„¶åè¿‡æ‰äº†æ ·ä¾‹æ‰”åˆ°ä¸€è¾¹\u0026hellip;\nå†™äº† T1 çš„æš´åŠ› * 2 ç„¶åéƒ½è·‘çš„é£å¿«ï¼ˆå¼±æ™º dp è¿˜è°ƒäº†åŠä¸ªå¤šå°æ—¶\u0026hellip;ï¼‰\nç„¶å 10 ç‚¹å¤šè¿‡æ‰äº†ä¸¤ä¸ªé¢˜ã€‚\nç„¶åçœ‹ T3 ã€‚T3 ä¸€çœ‹å°±æ˜¯ä¸€ä¸ªæ•°æ®ç»“æ„é¢˜ï¼Œåˆæ­¥æŠŠç­”æ¡ˆç¡®å®šåˆ°å¹³è¡¡æ ‘å’Œçº¿æ®µæ ‘ä¸¤ä¸ªä¸Šã€‚ç„¶åæ‰¾æ€§è´¨ã€‚\nå…ˆè½¬åŒ–äº†ä¸€ä¸‹é¢˜ç›®çš„æ¡ä»¶ï¼Œç„¶åæƒ³æ€ä¹ˆæ‰èƒ½æ„é€ ä¸€ä¸ªæœ€ä¼˜æ–¹æ¡ˆã€‚ç„¶åå¤§æ¦‚æœ‰äº†ä¸ªç»“è®ºï¼Œå†™äº†ä¸€æ³¢è¿‡äº†æ ·ä¾‹ã€‚è½¬åŒ–äº†ä¸€ä¸‹å‘ç°å¥½åƒå¯ä»¥ç”¨çº¿æ®µæ ‘ç»´æŠ¤ï¼Œäºæ˜¯å°±å¼€å§‹ç çº¿æ®µæ ‘ã€‚ä¹Ÿä¸éš¾å†™ï¼Œä¸€ä¸ªå°æ—¶å·¦å³å°±å†™å®Œäº†ï¼ˆå…¶é—´è¿˜æŠŠæ—¶é—´è®°é”™æ…Œå¼ äº†å¥½ä¸€ä¼šï¼‰\u0026hellip;å†™å®Œè¿‡äº†æ‹å¤§æ¦‚æ˜¯ 12:00 å·¦å³\u0026hellip;\nåƒé¥­ã€‚hyc \u0026amp; jkpéƒ½AKäº†ã€‚å¤§æ¦‚æœ‰ç¿»ç›˜çš„å¸Œæœ›ã€‚æˆ‘å¥½åƒåªè¦ä¸ fst å°±æœ‰ç¿»ç›˜çš„å¸Œæœ›è¯¶ã€‚\näºæ˜¯å‡ºåˆ†ã€‚å¼€å§‹è¿˜æƒ³åœ¨ 300 åˆ†é‚£é‡Œæ‰¾åˆ°è‡ªå·±ï¼Œå‘ç°ç¬¬ä¸€å±éƒ½æ²¡æœ‰è‡ªå·±äºæ˜¯å¼€å§‹æ…Œå¼ ã€‚\næœ€åå‘ç°è‡ªå·± T3 çˆ†é›¶äº†\u0026hellip; 200 åˆ† rk30 å·¦å³å§\u0026hellip;\nçœ‹äº†çœ‹å‘ç°è‡ªå·±çš„ T3 ac \u0026amp; wa å‚æ‚ï¼Œä½†æ˜¯æ†ç»‘æµ‹è¯•ä¸‹å°±çˆ† 0 äº†\u0026hellip;\nç„¶åæƒ³äº†åŠå¤©ä¹Ÿè§‰å¾—è‡ªå·±æ²¡æœ‰å†™æŒ‚ï¼ŒæŠŠåšæ³•ç»™ hyc è®²äº†ä¸€ä¸‹\u0026hellip;ç„¶åå°±è¢« dmy å‰æ‰äº†\u0026hellip;ï¼ˆdmyï¼šâ€œè¿™ä¸æ˜¯æˆ‘æƒ³å‡ºæ¥è¿‡çš„ä¸€ä¸ªå‡ç»“è®ºå—â€ï¼‰\näºæ˜¯æœ€åå¤§æ¦‚å°±æ˜¯ hyc å’Œ jkp éƒ½è¿›é˜Ÿäº†ï¼Œç„¶åæˆ‘æ€»è¯„ rk19 å…‰è£é€€å½¹\u0026hellip;å¤§æ¦‚æ ‡å‡†åˆ†ä¸Šå·®äº† 15 åˆ†ï¼Ÿ\nåœ¨çœé€‰å‰çš„é‚£ä¸ªå‘¨äº”ï¼Œ jkp æ›¾ç»æƒ³ç»™æˆ‘è®²é¢˜ï¼Œè®²çš„å°±æ˜¯ T3 çš„å‡å¼±ç‰ˆæœ¬ï¼Œä½†è¢«æˆ‘æ‹’ç»äº†\u0026hellip;å¦‚æœå¬äº†çš„è¯ï¼Œè‡³å°‘èƒ½ä¼š 47 åˆ†çš„å§\u0026hellip;é‚£ä¹ˆå°±è¿›é˜Ÿäº†å•Š\u0026hellip;ä½†æƒ³æƒ³å¦‚æœæˆ‘è¿™æ ·çš„èœé¸¡é€‰æ‰‹éƒ½èƒ½è¿›é˜Ÿï¼Œè¿™æ— ç–‘æ˜¯å¯¹é‚£äº›æ•´å¤©å‹¤å¥‹åˆ·é¢˜çš„ç¥ä»™é€‰æ‰‹æœ€å¤§çš„ä¸å…¬å¹³å§ã€‚\næˆ‘å°±ä¸è¯¥ä¹°é‚£ä¸‰å‰¯æ‰‘å…‹ç‰ŒQAQ\nä¸è¿‡æœ¨å·²æ²‰èˆŸ\u0026hellip;è¿›é˜Ÿäº†å€’æ˜¯éº»çƒ¦è®¸å¤š\u0026hellip;\nå°±æ˜¯ä¸è¿›é˜Ÿå°±å¾—è€ƒæœŸä¸­è€ƒè¯•å•Š\u0026hellip;æ»šå»å¤ä¹ äº†\u0026hellip;\nç»“æŸè¯­ æƒ³é€ç»™ 6 ä¸ªæœˆå‰çš„è‡ªå·±ï¼Œå’Œæ‰€æœ‰çœ‹åˆ°è¿™ç¯‡ blog çš„äººï¼š\n ã€Œå¯æ˜¯ç•™å­˜çš„äººæ€»æ˜¯ä¹ æƒ¯å¤©çœŸçš„ä¸ºç¦»å¼€è€…æ„Ÿåˆ°æ‚²æ‚¯ï¼Œæ®Šä¸çŸ¥ç•™å­˜æœªå¿…æ˜¯æ­£ç¡®çš„é€‰æ‹©ã€‚ã€\n GoodBye, OI.\n","description":"","id":12,"section":"posts","tags":null,"title":"BJOI2019é€€å½¹è®°","uri":"https://blog.chenqiqian.com/posts/trip-bjoi2019/"},{"content":"åœ¨ä¸€ä¸ª $5 \\times 5$ çš„æ£‹ç›˜ä¸Šæœ‰ $12$ ä¸ªç™½è‰²çš„éª‘å£«å’Œ $12$ ä¸ªé»‘è‰²çš„éª‘å£«ï¼Œ ä¸”æœ‰ä¸€ä¸ªç©ºä½ã€‚åœ¨ä»»ä½•æ—¶å€™ä¸€ä¸ªéª‘å£«éƒ½èƒ½æŒ‰ç…§éª‘å£«çš„èµ°æ³•ï¼ˆå®ƒå¯ä»¥èµ°åˆ°å’Œå®ƒæ¨ªåæ ‡ç›¸å·®ä¸º $1$ ï¼Œçºµåæ ‡ç›¸å·®ä¸º $2$ æˆ–è€…æ¨ªåæ ‡ç›¸å·®ä¸º $2$ ï¼Œçºµåæ ‡ç›¸å·®ä¸º $1$ çš„æ ¼å­ï¼‰ç§»åŠ¨åˆ°ç©ºä½ä¸Šã€‚ ç»™å®šä¸€ä¸ªåˆå§‹çš„æ£‹ç›˜ï¼Œæ€æ ·æ‰èƒ½ç»è¿‡ç§»åŠ¨å˜æˆå¦‚ä¸‹ç›®æ ‡æ£‹ç›˜ï¼š ä¸ºäº†ä½“ç°å‡ºéª‘å£«ç²¾ç¥ï¼Œä»–ä»¬å¿…é¡»ä»¥æœ€å°‘çš„æ­¥æ•°å®Œæˆä»»åŠ¡ã€‚\né“¾æ¥ Luogu P2324\né¢˜è§£ IDA*\u0026hellip;\nå…¶å®å°±æ˜¯\n è®¾ç½®ä¸€ä¸ªæ·±åº¦é™åˆ¶é˜²æ­¢æœç´¢è¿‡æ·±\u0026hellip; è®¾ç½®ä¸€ä¸ªä¼°ä»·å‡½æ•°æœ€ä¼˜æ€§å‰ªæ\u0026hellip;  çœ‹èµ·æ¥æ˜¯å§\u0026hellip;\nå¥½åƒ A* å°±æ˜¯ç”¨ä¼°ä»·å‡½æ•° + ä¼˜å…ˆé˜Ÿåˆ—ä¼˜åŒ–ï¼Ÿ\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77  #include \u0026lt;bits/stdc++.h\u0026gt;using namespace std; const int N = 8; int n = 5; int t[N][N]; char s[N][N];int a[N][N]; int mv[8][2] = {{1,-2},{1,2},{2,1},{2,-1},{-2,1},{-2,-1},{-1,-2},{-1,2}}; void init(){ for(int i = 1;i\u0026lt;=n;i++) scanf(\u0026#34;%s\u0026#34;,s[i]+1); for(int i = 1;i\u0026lt;=n;i++){ for(int j = 1;j\u0026lt;=n;j++){ a[i][j] = s[i][j] == \u0026#39;*\u0026#39;? -1 : s[i][j] - \u0026#39;0\u0026#39;; } } } int maxd = 0; int dfs(int dep,int x,int y,int left,int last){ if(dep + left \u0026gt; maxd + 1) return 0; // è€ƒè™‘åˆ°æˆ‘ä»¬æœ€åä¸€æ¬¡ä¸€å®šæ˜¯ç›´æ¥æŠŠå‰©ä½™çš„æ ¼å­å‡å° 2ï¼Œè¿™ä¹ˆè¯´æ„Ÿè§‰é¢˜è§£å¤§éƒ¨åˆ†æ˜¯é”™çš„  // hackæ•°æ®ï¼š  /* 1 11111 01111 00*11 00001 00000 ç­”æ¡ˆï¼š0 æœ‰çš„é¢˜è§£ä¼šè¾“å‡º â€œ-1â€ */ if(left == 0) return 1; for(int i = 0;i \u0026lt; 8;i++)if(i != 7 - last){ int nx = x + mv[i][0],ny = y + mv[i][1]; if(nx \u0026lt; 1 || nx \u0026gt; n || ny \u0026lt; 1 || ny \u0026gt; n) continue; int newleft = left; if(a[x][y]==t[x][y]) newleft++; if(a[nx][ny]==t[nx][ny]) newleft++; if(a[x][y]==t[nx][ny]) newleft--; if(a[nx][ny]==t[x][y]) newleft--; swap(a[x][y],a[nx][ny]); if(dfs(dep+1,nx,ny,newleft,i)) return 1; swap(a[x][y],a[nx][ny]); } return 0; } void solve(){ int tx,ty,tleft = 0; for(int i = 1;i\u0026lt;=n;i++){ for(int j = 1;j\u0026lt;=n;j++){ if(a[i][j] != t[i][j]) tleft++; if(a[i][j] == -1) tx = i,ty = j; } } for(maxd = 0;maxd \u0026lt;= 15;maxd++){ if(dfs(0,tx,ty,tleft,-1)) return (void)(printf(\u0026#34;%d\\n\u0026#34;,maxd)); } printf(\u0026#34;-1\\n\u0026#34;); } int main(){ t[1][1]=t[1][2]=t[1][3]=t[1][4]=t[1][5]=t[2][2]=1; t[2][3]=t[2][4]=t[2][5]=t[3][4]=t[3][5]=t[4][5]=1; t[2][1]=t[3][1]=t[3][2]=t[4][1]=t[4][2]=t[4][3]=0; t[4][4]=t[5][1]=t[5][2]=t[5][3]=t[5][4]=t[5][5]=0; t[3][3]=-1; int T;scanf(\u0026#34;%d\u0026#34;,\u0026amp;T); for(int i = 1;i\u0026lt;=T;i++){ init(),solve(); } return 0; }   ","description":"","id":13,"section":"posts","tags":["æœç´¢"],"title":"ã€ŒSCOI2005ã€éª‘å£«ç²¾ç¥-æœç´¢","uri":"https://blog.chenqiqian.com/posts/scoi2005-knight/"},{"content":"é¢˜æ„è¿‡é•¿ï¼Œæ¦‚æ‹¬å¦‚ä¸‹ï¼š\nä½ æœ‰ $n$ ç§é£Ÿæï¼Œè¯„å§” $m$ ä¸ªè¦æ±‚ï¼Œä½ éœ€è¦åŠ å·¥è¿™ $n$ ç§é£Ÿæï¼Œæ¯ç§ä»\u0026quot;æ±‰å¼ï¼ˆhï¼‰\u0026ldquo;æˆ–è€…\u0026quot;æ»¡å¼ï¼ˆmï¼‰\u0026ldquo;ä¸­é€‰æ‹©ä¸€ç§ã€‚æ¯ä¸ªè¦æ±‚ç”¨ä¸¤ä¸ªå½¢å¦‚ $\\text{h} x$ æˆ–è€… $\\text{m}x$ ï¼ˆ $x$ ä¸ºä¸€ä¸ª $1 \\sim n$ çš„æ­£æ•´æ•°ï¼‰ï¼Œæ„ä¸ºç¬¬ $x$ é“èœéœ€è¦ç”¨ç”¨\u0026quot;æ±‰å¼ï¼ˆhï¼‰\u0026ldquo;æˆ–è€…\u0026quot;æ»¡å¼ï¼ˆmï¼‰\u0026ldquo;æ¥è¿›è¡ŒåŠ å·¥ï¼Œæ¯ä¸ªè¦æ±‚ä¸­çš„ä¸¤ä¸ªæ¡ä»¶å¿…é¡»è‡³å°‘æ»¡è¶³ä¸€ä¸ªï¼Œæ¯ç§é£Ÿææœ€å¤šåªèƒ½ç”¨ä¸€ç§æ–¹å¼æ¥åŠ å·¥ã€‚\nè¯·ä½ åˆ¤æ–­å­˜ä¸å­˜åœ¨ä¸€ä¸ªåˆæ³•çš„æ–¹å¼ã€‚\né“¾æ¥ Luogu P4171\né¢˜è§£ å¦‚æœæˆ‘ä»¬æŠŠåšæ»¡å¼å’Œæ±‰å¼çœ‹æˆä¸€ä¸ªå˜é‡çš„ $0/1$ å–å€¼ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°è¿™ä¸ªå°±æ˜¯ä¸ª 2-SAT æ¨¡å‹ã€‚\nç»ƒä¹ æ¨¡ç‰ˆèƒŒè¯µæŠ€å·§ï¼ˆ\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63  #include \u0026lt;bits/stdc++.h\u0026gt;using namespace std; const int MAXN = 11100; struct Edge{ int to,nex; }edge[MAXN*2];int ecnt = 2; int fir[MAXN]; void addedge(int a,int b){ edge[ecnt] = (Edge){b,fir[a]},fir[a] = ecnt++; } void clear(){ecnt = 2;memset(fir,0,sizeof(fir));} int n,m; int p(int x,int op){return x + op * n;} void add(int i,int a,int j,int b){ addedge(p(i,a^1),p(j,b)),addedge(p(j,b^1),p(i,a)); } int dfn[MAXN],low[MAXN],col[MAXN],cnum,S[MAXN]; void tarjan(int x){ dfn[x] = low[x] = ++dfn[0];S[++S[0]] = x; for(int e = fir[x];e;e = edge[e].nex){ int v = edge[e].to; if(!dfn[v]) tarjan(v),low[x] = min(low[x],low[v]); else if(!col[v]) low[x] = min(low[x],dfn[v]); } if(low[x] == dfn[x]){ for(++cnum;S[S[0]] != x;--S[0]) col[S[S[0]]] = cnum; col[S[S[0]--]] = cnum; } } bool solve_sat(){ memset(dfn,0,sizeof(dfn)),memset(low,0,sizeof(low)); memset(S,0,sizeof(S)),memset(col,0,sizeof(col)); cnum = 0; for(int i = 1;i \u0026lt;= 2*n;i++) if(!dfn[i]) tarjan(i); for(int i = 1;i\u0026lt;=n;i++) if(col[p(i,0)] == col[p(i,1)]) return 0; return 1; } void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m); char s1[10],s2[10];int x,y; for(int i = 1;i\u0026lt;=m;i++){ scanf(\u0026#34;%s %s\u0026#34;,s1,s2); sscanf(s1+1,\u0026#34;%d\u0026#34;,\u0026amp;x),sscanf(s2+1,\u0026#34;%d\u0026#34;,\u0026amp;y); add(x,s1[0]==\u0026#39;h\u0026#39;,y,s2[0]==\u0026#39;h\u0026#39;); } } int main(){ int T;scanf(\u0026#34;%d\u0026#34;,\u0026amp;T); for(int i = 1;i\u0026lt;=T;i++){ clear(),init(); printf(solve_sat()?\u0026#34;GOOD\\n\u0026#34;:\u0026#34;BAD\\n\u0026#34;); } return 0; }   ","description":"","id":14,"section":"posts","tags":["å›¾è®º","2-SAT"],"title":"ã€ŒJSOI2010ã€æ»¡æ±‰å…¨å¸­-2-SAT","uri":"https://blog.chenqiqian.com/posts/jsoi2010-feast/"},{"content":"è‹¥èƒ½å°†æ— å‘å›¾ $G=(V, E)$ ç”»åœ¨å¹³é¢ä¸Šä½¿å¾—ä»»æ„ä¸¤æ¡æ— é‡åˆé¡¶ç‚¹çš„è¾¹ä¸ç›¸äº¤ï¼Œåˆ™ç§° $G$ æ˜¯å¹³é¢å›¾ã€‚åˆ¤å®šä¸€ä¸ªå›¾æ˜¯å¦ä¸ºå¹³é¢å›¾çš„é—®é¢˜æ˜¯å›¾è®ºä¸­çš„ä¸€ä¸ªé‡è¦é—®é¢˜ã€‚ç°åœ¨å‡è®¾ä½ è¦åˆ¤å®šçš„æ˜¯ä¸€ç±»ç‰¹æ®Šçš„å›¾ï¼Œå›¾ä¸­å­˜åœ¨ä¸€ä¸ªåŒ…å«æ‰€æœ‰é¡¶ç‚¹çš„ç¯ï¼Œå³å­˜åœ¨å“ˆå¯†é¡¿å›è·¯ã€‚\né“¾æ¥ Luogu P3209\né¢˜è§£ æˆ‘ä»¬æŠŠå“ˆå¯†é¡¿å›è·¯æ‹å‡ºæ¥ï¼Œå‰©ä¸‹çš„è¾¹è¦ä¹ˆåœ¨ç¯å¤–è¦ä¹ˆåœ¨ç¯å†…ï¼Œå¦‚æœä¸¤æ¡è¾¹åŒæ—¶åœ¨ç¯å†…ä¼šå¯¼è‡´ç›¸äº¤ï¼ˆåˆ¤å®šæ¯”è¾ƒå•°å—¦å°±ä¸è¯´äº†ï¼‰ï¼Œæˆ‘ä»¬å°±å»ºè¾¹çº¦æŸ $x_i \\oplus x_j = 1$ å³å¯ã€‚\nå¯ä»¥ç”¨ 2-SAT æ¨¡å‹è§£å†³è¯¥é—®é¢˜ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98  #include \u0026lt;bits/stdc++.h\u0026gt;using namespace std; const int MAXN = 11000; struct Edge{ int to,nex; }edge[MAXN*100];int ecnt = 2; int fir[MAXN]; void addedge(int a,int b){ edge[ecnt] = (Edge){b,fir[a]},fir[a] = ecnt++; } void clear(){ecnt = 2;memset(fir,0,sizeof(fir));} int n,m; int s[MAXN]; int p(int i,int op){return i + op * m;} void add_xor(int i,int j){// i xor j == 1  addedge(p(i,1),p(j,0)),addedge(p(i,0),p(j,1)); addedge(p(j,0),p(i,1)),addedge(p(j,1),p(i,0)); } int dfn[MAXN],low[MAXN],S[MAXN],col[MAXN],cnum; void tarjan(int x){ dfn[x] = low[x] = ++dfn[0];S[++S[0]] = x; for(int e = fir[x];e;e = edge[e].nex){ int v = edge[e].to; if(!dfn[v]) tarjan(v),low[x] = min(low[x],low[v]); else if(!col[v]) low[x] = min(low[x],dfn[v]); } if(low[x] == dfn[x]){ for(++cnum;S[S[0]] != x;--S[0]) col[S[S[0]]] = cnum; col[S[S[0]--]] = cnum; } } bool solve_sat(){ memset(dfn,0,sizeof(dfn)),memset(col,0,sizeof(col)); memset(S,0,sizeof(S)),memset(low,0,sizeof(low)); cnum = 0; for(int i = 1;i \u0026lt;= 2 * m;i++) if(!dfn[i]) tarjan(i); for(int i = 1;i \u0026lt;= m;i++) if(col[p(i,0)] == col[p(i,1)]) return 0; return 1; } set\u0026lt;pair\u0026lt;int,int\u0026gt; \u0026gt; Set; int u[MAXN],v[MAXN]; int vis[MAXN],pos[MAXN]; int judge(int i,int j){ if(vis[i] || vis[j]) return 0; if(make_pair(u[i],-v[i]) \u0026gt; make_pair(u[j],-v[j])) swap(i,j); if(v[j] \u0026lt;= v[i] || u[j] \u0026gt;= v[i]) return 0; else return 1; } void init(){ Set.clear(); scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m); for(int i = 1;i\u0026lt;=m;i++){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;u[i],\u0026amp;v[i]); if(u[i] \u0026gt; v[i]) swap(u[i],v[i]); } for(int i = 1;i\u0026lt;=n;i++) scanf(\u0026#34;%d\u0026#34;,\u0026amp;s[i]); s[0] = s[n]; for(int i = 1;i\u0026lt;=n;i++){ int u = s[i-1],v = s[i]; if(u \u0026gt; v) swap(u,v); Set.insert(make_pair(u,v)); } for(int i = 1;i\u0026lt;=m;i++) vis[i] = Set.count(make_pair(u[i],v[i])); for(int i = 1;i\u0026lt;=n;i++) pos[s[i]] = i; for(int i = 1;i\u0026lt;=m;i++) { u[i] = pos[u[i]],v[i] = pos[v[i]]; if(u[i] \u0026gt; v[i]) swap(u[i],v[i]); } } void solve(){ if(m \u0026gt; 3 * n - 6) return (void)(printf(\u0026#34;NO\\n\u0026#34;)); for(int i = 1;i \u0026lt;= m;i++){ for(int j = i+1;j \u0026lt;= m;j++){ if(judge(i,j)) add_xor(i,j); } } printf(solve_sat()?\u0026#34;YES\\n\u0026#34;:\u0026#34;NO\\n\u0026#34;); } int main(){ int T;scanf(\u0026#34;%d\u0026#34;,\u0026amp;T); for(int i = 1;i\u0026lt;=T;i++){ clear(),init(); solve(); } return 0; }   ","description":"","id":15,"section":"posts","tags":["å›¾è®º","2-SAT"],"title":"ã€ŒHNOI2010ã€å¹³é¢å›¾åˆ¤å®š-2-SAT","uri":"https://blog.chenqiqian.com/posts/hnoi2010-planarity/"},{"content":"æœ‰ä¸€å¼  $n \\times m$ çš„æ•°è¡¨ï¼Œå…¶ç¬¬ $i$ è¡Œç¬¬ $j$ åˆ—ï¼ˆ $1 \\le i \\le n$ï¼Œ $1 \\le j \\le m$ ï¼‰çš„æ•°å€¼ä¸ºèƒ½åŒæ—¶æ•´é™¤ $i$ å’Œ $j$ çš„æ‰€æœ‰è‡ªç„¶æ•°ä¹‹å’Œã€‚ç»™å®š $a$ ï¼Œè®¡ç®—æ•°è¡¨ä¸­ä¸å¤§äº $a$ çš„æ•°ä¹‹å’Œã€‚\n$1 \\le n,m \\le 10^5$ ï¼Œ $1 \\le Q \\le 2 \\times 10^4$\né“¾æ¥ Luogu P3312\né¢˜è§£ æˆ‘ä»¬æŠŠè¿™ä¸ªä¸œè¥¿å†™æˆå…¬å¼ï¼š\n$$\n\\sum_{i=1}^n \\sum_{j = 1}^m (\\sum_{d|\\gcd(i,j)} d)[\\sum_{d|\\gcd(i,j)} d \\le a]\n$$\nä¸å¦¨ä»¤ $n \u0026lt; m$ ï¼Œæ¨æ¨å¼å­\u0026hellip;\n$$\n\\sum_{d=1}^{n} (\\sum_{k|d} k)[\\sum_{k|d} k \\le a] \\sum_{i=1}^{\\lfloor \\frac{n}{d} \\rfloor} \\sum_{j=1}^{\\lfloor \\frac{m}{d} \\rfloor} [\\gcd(i,j) = 1]\n$$\næˆ‘ä»¬ä»¤\n$$\n\\sigma_1(n) = \\sum_{d|n} d\n$$\nè¿™æ˜¯ä¸€ä¸ªç§¯æ€§å‡½æ•°ã€‚\né‚£ä¹ˆå°±æ˜¯\n$$\n\\sum_{d=1}^{n} \\sigma_1(d)[\\sigma_1(d) \\le a] \\sum_{i=1}^{\\lfloor \\frac{n}{d} \\rfloor} \\sum_{j=1}^{\\lfloor \\frac{m}{d} \\rfloor} [\\gcd(i,j) = 1]\n$$\næˆ‘ä»¬çŸ¥é“ï¼š\n$$\n\\sum_{i=1}^{n} \\sum_{j=1}^{m} [\\gcd(i,j) = 1]\\\n= \\sum_{i=1}^{n} \\sum_{j=1}^{m} \\sum_{k | \\gcd(i,j)} \\mu(k)\\\n= \\sum_{k = 1}^n \\mu(k) \\lfloor \\frac{n}{k}\\rfloor \\lfloor \\frac{m}{k}\\rfloor\n$$\né‚£ä¹ˆä»£å…¥å°±æ˜¯ï¼š\n$$\n\\sum_{d=1}^{n} \\sigma_1(d)[\\sigma_1(d) \\le a] \\sum_{k = 1}^{\\lfloor \\frac{n}{d} \\rfloor} \\mu(k) \\lfloor \\frac{n}{dk}\\rfloor \\lfloor \\frac{m}{dk}\\rfloor\n$$\næˆ‘ä»¬è®¾ $T = dk$ ï¼Œå°±æœ‰ï¼š\n$$\n\\sum_{T = 1}^n \\lfloor \\frac{n}{T}\\rfloor \\lfloor \\frac{m}{T}\\rfloor \\sum_{d | T} [\\sigma_1(d) \\le a]\\sigma_1(d) \\mu(\\frac{T}{d})\n$$\nä»¤\n$$\nf(T) = \\sum_{d|T} \\sigma_1(d)[\\sigma_1(d) \\le a]\\mu(\\frac{T}{d})\n$$\nå¼å­å°±å˜æˆï¼š\n$$\n\\sum_{T = 1}^n \\lfloor \\frac{n}{T}\\rfloor \\lfloor \\frac{m}{T}\\rfloor f(T)\n$$\næˆ‘ä»¬åªè¦èƒ½è·å¾— $f(T)$ çš„å‰ç¼€å’Œï¼Œæˆ‘ä»¬å°±èƒ½ $O(\\sqrt n)$ å‡ºè§£äº†ã€‚\né‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆå¯¹ä¸åŒçš„ $a$ ç»´æŠ¤è¿™ä¸ªç©æ„å‘¢ï¼Ÿ\næˆ‘ä»¬è€ƒè™‘æŠŠ $a$ ä»å°åˆ°å¤§æ’åºï¼Œç„¶åæˆ‘ä»¬åªéœ€è¦å¤„ç†å‡ºæ”¹å˜çš„ $f$ï¼Œç”¨ä¸€ä¸ªä¸œè¥¿ç»´æŠ¤å‰ç¼€å’Œå³å¯ã€‚\næˆ‘ä»¬è€ƒè™‘åˆ°åŠ å…¥ä¸€ä¸ª $\\sigma_0(x) = a+1$ çš„ $a$ ä¼šå¯¹ $f$ äº§ç”Ÿä»€ä¹ˆå½±å“ã€‚æœ‰ä¸”ä»…æœ‰ $x$ çš„å€æ•°ä¼šæœ‰æ›´æ”¹ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥æš´åŠ›æšä¸¾æ‰€æœ‰å€æ•°ï¼Œç„¶ååŠ å…¥åˆ°fçš„å‰ç¼€å’Œçš„è´¡çŒ®å½“ä¸­å°±å¯ä»¥äº†ã€‚å› ä¸º $\\frac{n}{1} + \\frac{n}{2} + \\cdots + \\frac{n}{n} = O(n \\log n) $ ï¼Œæ‰€ä»¥æœ€åçš„å¤æ‚åº¦å°±æ˜¯ $O(n \\log n + n \\log^2 n + q \\sqrt n \\log n)$\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87  #include \u0026lt;bits/stdc++.h\u0026gt;using namespace std; const int MAXN = 110000; int N = 110000,T; int sig[MAXN],prime[MAXN],mu[MAXN],vis[MAXN],ans[MAXN]; void sieve(int n){ mu[1] = 1; for(int i = 2;i\u0026lt;=n;i++){ if(!vis[i]){ prime[++prime[0]] = i; mu[i] = -1; } for(int j = 1;j \u0026lt;= prime[0] \u0026amp;\u0026amp; i * prime[j] \u0026lt;= n;j++){ vis[i*prime[j]] = 1; if(i % prime[j] == 0){ mu[i*prime[j]] = 0; break; } else mu[i*prime[j]] = -mu[i]; } } for(int i = 1;i\u0026lt;=n;i++) for(int j = i;j\u0026lt;=n;j+=i) sig[j] += i; } struct Node{ int id,n,m,a; }q[MAXN]; bool cmp1(const Node \u0026amp;x,const Node \u0026amp;y){return x.a \u0026lt; y.a;} bool cmp2(const int \u0026amp;a,const int \u0026amp;b){return sig[a] \u0026lt; sig[b];} namespace BIT{// ç»´æŠ¤ f çš„å‰ç¼€å’Œ  int sumn[MAXN],n; void init(int _n){n = _n;} int lowbit(int x){return x \u0026amp; (-x);} int query(int x){ int ans = 0; while(x \u0026gt;= 1) ans += sumn[x],x -= lowbit(x); return ans; } void modify(int x,int v){ while(x \u0026lt;= n) sumn[x] += v,x += lowbit(x); } } void update(int x){ for(int i = 1;i * x \u0026lt;= N;i++) BIT::modify(i*x,sig[x] * mu[i]); } int calc(int n,int m){ int ans = 0; if(n \u0026gt; m) swap(n,m); for(int l = 1,r;l\u0026lt;=n;l = r+1){ r = min(n/(n/l),m/(m/l)); ans = ans + (n/l) * (m/l) * (BIT::query(r) - BIT::query(l-1)); } return ans; } int main(){ sieve(N),BIT::init(N); scanf(\u0026#34;%d\u0026#34;,\u0026amp;T); for(int i = 1;i\u0026lt;=T;i++){ int a,b,c; scanf(\u0026#34;%d %d %d\u0026#34;,\u0026amp;a,\u0026amp;b,\u0026amp;c); q[i] = (Node){i,a,b,c}; } sort(q+1,q+T+1,cmp1); static int t[MAXN]; for(int i = 1;i\u0026lt;=N;i++) t[i] = i; sort(t+1,t+N+1,cmp2); int now = 1; for(int i = 1;i\u0026lt;=T;i++){ while(t[now] \u0026lt;= N \u0026amp;\u0026amp; sig[t[now]] \u0026lt;= q[i].a) update(t[now]),now++; ans[q[i].id] = calc(q[i].n,q[i].m); } for(int i = 1;i\u0026lt;=T;i++) printf(\u0026#34;%d\\n\u0026#34;,ans[i] \u0026amp; 2147483647); return 0; }   ","description":"","id":16,"section":"posts","tags":["æ•°å­¦","æ•°è®º"],"title":"ã€ŒSDOI2014ã€æ•°è¡¨-æ•°è®º","uri":"https://blog.chenqiqian.com/posts/sdoi2014-table/"},{"content":"ç»™å®šä¸€ä¸ª $n$ ä¸ªç‚¹ $m$ æ¡è¾¹çš„æ— å‘è¿é€šå›¾ $G$ å’Œè‹¥å¹²ä¸ªå°é›†åˆ $S$ï¼Œæ¯ä¸ªå°é›†åˆåŒ…å« $c(1 \\le c \\le 4)$ æ¡è¾¹ï¼Œå¯¹äºæ¯ä¸ªé›†åˆï¼Œä½ éœ€è¦ç¡®å®šå°†é›†åˆä¸­çš„è¾¹åˆ æ‰åæ”¹å›¾æ˜¯å¦ä¿æŒè”é€šã€‚\né›†åˆé—´çš„è¯¢é—®ç›¸äº’ç‹¬ç«‹ã€‚\né“¾æ¥ LuoguP5227\né¢˜è§£ æ„Ÿè§‰ç°åœ¨æœ‰ä¸€ç‚¹èƒ½æ„Ÿå—åˆ°çº¿æ®µæ ‘åˆ†æ²»çš„ç²¾åäº†ã€‚\næˆ‘ä»¬è€ƒè™‘åˆ°ï¼Œç»´æŠ¤ä¸€ä¸ªæ— è®ºå•¥ç©æ„ï¼Œä¸€ä¸ªå›¾ä¸æ–­åˆ å»ä¸€æ¡è¾¹ä¹‹åæˆ‘ä»¬ä¸èƒ½çŸ¥é“è¿™ä¸ªå›¾æ˜¯å¦è”é€šï¼›ä½†æ˜¯å¦‚æœæˆ‘ä»¬ç”¨å¹¶æŸ¥é›†ç»´æŠ¤è”é€šæ€§ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åœ¨ $O(n\\log n)$ çš„æ—¶é—´å†…åŠ è¾¹ï¼ŒåŒæ—¶çŸ¥é“è¿™ä¸ªå›¾æ˜¯å¦è”é€šã€‚\næ‰€ä»¥æˆ‘ä»¬å…ˆå°†é—®é¢˜è½¬åŒ–æˆç±»ä¼¼åŠ è¾¹çš„é—®é¢˜ï¼Œå®åˆ™å…¶å®æ˜¯ç»´æŠ¤æ¯æ¡è¾¹çš„å‡ºç°çš„åŒºé—´ã€‚\næˆ‘ä»¬å‘ç°ï¼Œä»»æ„æ—¶åˆ»çš„åˆ è¾¹ï¼Œéƒ½ä¼šä½¿è¿™ä¸ªè¾¹ç”±ä¸€ä¸ªå¤§åŒºé—´çš„å‡ºç°å˜æˆä¸¤ä¸ªå°åŒºé—´çš„å‡ºç°ï¼Œå› ä¸ºæ€»å…±çš„åˆ è¾¹åœ¨ $O(k)$ é‡çº§ï¼Œæ‰€ä»¥è¯´æˆ‘ä»¬å°±ä¼šäº§ç”Ÿ $O(k)$ ä¸ªåŒºé—´ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥æŠŠè¿™äº›åŒºé—´æ’’åˆ°çº¿æ®µæ ‘ä¸Šï¼Œå°±æœ‰æ€»å…± $O(k \\log k)$ ä¸ªæ“ä½œã€‚\næ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå¯ä»¥æ’¤é”€çš„å¹¶æŸ¥é›†ï¼Ÿ~~æˆ‘åªä¼šå¯æŒä¹…åŒ– ï¼Œ~~ä½†æ˜¯æ—¶é—´å¤æ‚åº¦éœ€è¦ $O(n \\log n)$ ä¸€ä¸‹ï¼Œæ‰€ä»¥æˆ‘ä»¬è€ƒè™‘æƒ³åŠæ³•åˆ é™¤è¾¹å³å¯ã€‚\næˆ‘ä»¬æŒ‰ç§©åˆå¹¶ï¼Œç„¶åè®°å½•ä¸€ä¸‹æ”¹äº†å“ªäº›ï¼Œæ¯æ¬¡æ’¤é”€å³å¯ã€‚\næ—¶é—´å¤æ‚åº¦ ï¼š$O(k \\log k \\log n)$ ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80  #include \u0026lt;bits/stdc++.h\u0026gt;using namespace std; const int MAXN = 210000; struct Edge{int u,v;}e[MAXN]; int n,m,k,ans[MAXN]; namespace BCJ{ int f[MAXN],d[MAXN],r; pair\u0026lt;int,int\u0026gt; stack[MAXN];int cnt;// ç¬¬ä¸€ä¸ªå­˜idï¼Œç¬¬äºŒä¸ªå­˜åŸæ¥çš„ç§©  void init(int n){for(int i = 1;i\u0026lt;=n;i++) f[i] = i,d[i] = 1;} int find(int x){return f[x] == x?x:find(f[x]);} void un(int x,int y){ int fx = find(x),fy = find(y); if(fx == fy) return; r++; if(d[fx] \u0026lt; d[fy]) swap(x,y),swap(fx,fy); stack[++cnt] = make_pair(fy,d[fy]); stack[++cnt] = make_pair(fx,d[fx]); f[fy] = fx; if(d[fy] == d[fx]) d[fx]+=1; } void undo(int lim){//  while(cnt \u0026gt; lim){ int i = cnt,x = stack[i].first,pred = stack[i].second; if(f[x] != x) r--; f[x] = x,d[x] = pred;cnt--; } } } namespace SegTree{ vector\u0026lt;int\u0026gt; v[MAXN\u0026lt;\u0026lt;2]; #define lson (x\u0026lt;\u0026lt;1)  #define rson (x\u0026lt;\u0026lt;1|1)  #define mid ((l+r)\u0026gt;\u0026gt;1)  void update(int x,int l,int r,int ql,int qr,int val){ if(ql \u0026gt; qr) return; if(ql \u0026lt;= l \u0026amp;\u0026amp; r \u0026lt;= qr) v[x].push_back(val); else{ if(ql \u0026lt;= mid) update(lson,l,mid,ql,qr,val); if(qr \u0026gt;= mid+1) update(rson,mid+1,r,ql,qr,val); } } void solve(int x,int l,int r,int *ans){ int lim = BCJ::cnt; for(int i = 0;i \u0026lt; int(v[x].size());i++) BCJ::un(e[v[x][i]].u,e[v[x][i]].v); if(l == r) ans[l] = (BCJ::r == n-1); else solve(lson,l,mid,ans),solve(rson,mid+1,r,ans); BCJ::undo(lim); } } void init(){ static int tim[MAXN]; scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m);BCJ::init(n); int a,b; for(int i = 1;i\u0026lt;=m;i++) scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;a,\u0026amp;b),e[i] = (Edge){a,b}; scanf(\u0026#34;%d\u0026#34;,\u0026amp;k); for(int i = 1;i\u0026lt;=k;i++){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;a); for(int w = 1;w\u0026lt;=a;w++){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;b); SegTree::update(1,1,k,tim[b]+1,i-1,b); tim[b] = i; } } for(int i = 1;i\u0026lt;=m;i++) SegTree::update(1,1,k,tim[i]+1,k,i); } void solve(){ SegTree::solve(1,1,k,ans); for(int i = 1;i\u0026lt;=k;i++) printf(ans[i]?\u0026#34;Connected\\n\u0026#34;:\u0026#34;Disconnected\\n\u0026#34;); } int main(){ init(),solve(); return 0; }   ","description":"","id":17,"section":"posts","tags":["æ•°æ®ç»“æ„","çº¿æ®µæ ‘åˆ†æ²»","å¹¶æŸ¥é›†"],"title":"ã€ŒAHOI2013ã€è”é€šå›¾-çº¿æ®µæ ‘åˆ†æ²»+å¹¶æŸ¥é›†","uri":"https://blog.chenqiqian.com/posts/ahoi2013-graph/"},{"content":"Anihc å›½æœ‰ $n$ ä¸ªåŸå¸‚ï¼Œè¿™ $n$ ä¸ªåŸå¸‚ä» $1$ ~ $n$ ç¼–å·ï¼Œ$1$ å·åŸå¸‚ä¸ºé¦–éƒ½ã€‚åŸå¸‚é—´åˆå§‹æ—¶æœ‰ $m$ æ¡é«˜é€Ÿå…¬è·¯ï¼Œæ¯æ¡é«˜é€Ÿå…¬è·¯éƒ½æœ‰ä¸€ä¸ªéè´Ÿæ•´æ•°çš„ç»æµå½±å“å› å­ï¼Œæ¯æ¡é«˜é€Ÿå…¬è·¯çš„ä¸¤ç«¯éƒ½æ˜¯åŸå¸‚ï¼ˆå¯èƒ½ä¸¤ç«¯æ˜¯åŒä¸€ä¸ªåŸå¸‚)ï¼Œä¿è¯ä»»æ„ä¸¤ä¸ªåŸå¸‚éƒ½å¯ä»¥é€šè¿‡é«˜é€Ÿå…¬è·¯äº’è¾¾ã€‚\nAnihc å›½æ­£åœ¨ç­¹åˆ’ã€Œå…«çºµå…«æ¨ªã€çš„é«˜é“å»ºè®¾è®¡åˆ’ï¼Œè®¡åˆ’è¦ä¿®å»ºä¸€äº›é«˜é€Ÿé“è·¯ï¼Œæ¯æ¡é«˜é€Ÿé“è·¯ä¸¤ç«¯ä¹Ÿéƒ½æ˜¯åŸå¸‚ï¼ˆå¯èƒ½ä¸¤ç«¯æ˜¯åŒä¸€ä¸ªåŸå¸‚)ï¼Œä¹Ÿéƒ½æœ‰ä¸€ä¸ªéè´Ÿæ•´æ•°çš„ç»æµå½±å“å› å­ã€‚å›½å®¶è¿˜è®¡åˆ’åœ¨ã€Œå…«çºµå…«æ¨ªã€è®¡åˆ’å»ºæˆä¹‹åï¼Œå°†ã€Œä¸€å¸¦ä¸€è·¯ã€æ‰©å±•ä¸ºã€Œä¸€å¸¦ä¸€è·¯ä¸€ç¯ã€ï¼Œå¢åŠ ã€Œå†…é™†åŸå¸‚ç»æµç¯ã€å³é€‰æ‹©ä¸€æ¡ä»é¦–éƒ½å‡ºå‘æ²¿è‹¥ä¸€ç³»åˆ—é«˜é“ä¸é«˜é€Ÿå…¬è·¯èµ°çš„è·¯å¾„ï¼Œæ¯æ¡é«˜é“æˆ–é«˜é€Ÿå…¬è·¯å¯ä»¥ç»è¿‡å¤šæ¬¡ï¼Œæ¯åº§åŸå¸‚ä¹Ÿå¯ä»¥ç»è¿‡å¤šæ¬¡ï¼Œæœ€åè·¯å¾„åˆåœ¨é¦–éƒ½ç»“æŸã€‚ä»¤ã€Œå†…é™†åŸå¸‚ç»æµç¯ã€çš„ GDP ä¸ºä¾æ¬¡å°†è¿™æ¡è·¯å¾„ä¸Šæ‰€ç»è¿‡çš„é«˜é“æˆ–é«˜é€Ÿå…¬è·¯çš„ç»æµå½±å“å› å­å¼‚æˆ–èµ·æ¥ï¼ˆä¸€æ¡è·¯ç»è¿‡å¤šæ¬¡åˆ™ä¼šè¢«è®¡ç®—å¤šæ¬¡ï¼‰ã€‚\nç°åœ¨ Anihc åœ¨ä¼šè®®ä¸Šè®¨è®ºã€Œå…«çºµå…«æ¨ªã€çš„å»ºè®¾è®¡åˆ’æ–¹æ¡ˆï¼Œä»–ä»¬ä¼šä¸æ–­åœ°ä¿®æ”¹è®¡åˆ’æ–¹æ¡ˆï¼Œå¸Œæœ›ä½ èƒ½å®æ—¶åé¦ˆå¯¹äºå½“å‰çš„ã€Œå…«çºµå…«æ¨ªã€çš„å»ºè®¾è®¡åˆ’çš„æ–¹æ¡ˆã€Œå†…é™†åŸå¸‚ç»æµç¯ã€çš„æœ€å¤§æ˜¯å¤šå°‘ã€‚\nåˆå§‹æ—¶ï¼Œå…«çºµå…«æ¨ªè®¡åˆ’ä¸­ä¸åŒ…å«ä»»ä½•â€”æ¡é«˜é“ï¼Œæœ‰ä»¥ä¸‹ä¸‰ç§æ“ä½œï¼š\n  Add x y z ï¼šåœ¨è®¡åˆ’ä¸­ç»™åœ¨åŸå¸‚ $x$ å’ŒåŸå¸‚ $y$ ä¹‹é—´å»ºè®¾ä¸€æ¡é«˜é“ï¼Œå…¶ç»æµå½±å“å› å­ä¸º $z$ ï¼Œå¦‚æœè¿™æ˜¯ç¬¬ $k$ ä¸ª Add æ“ä½œï¼Œåˆ™å°†è¿™æ¡é«˜é“å‘½åä¸º $k$ å·é«˜é“ã€‚\n  Cancel k ï¼šå°†è®¡åˆ’ä¸­çš„ $k$ å·é«˜é“å–æ¶ˆæ‰ï¼Œä¿è¯æ­¤æ—¶ $k$ å·é«˜é“ä¸€å®šå­˜åœ¨ã€‚\n  Change k z ï¼šè¡¨ç¤ºå°†ç¬¬ $k$ å·é«˜é“çš„ç»æµå½±å“å› å­æ›´æ”¹ä¸º $z$ ï¼Œä¿è¯æ­¤æ—¶ $k$ å·é«˜é“ä¸€å®šå­˜åœ¨ã€‚\n  é“¾æ¥ LOJ2312\nLuogu P3733\né¢˜è§£ P.S. å…«çºµå…«æ¨ªèµ›è‰‡å•Šï¼\næ²¡æœ‰åŠ è¾¹/åˆ è¾¹/æ”¹æƒå€¼çš„è¯ï¼Œè¿™ä¸ªé¢˜å°±æ˜¯ WC2011 æœ€å¤§ XOR è·¯å¾„ã€‚\næœ‰äº†ä¿®æ”¹æ€ä¹ˆåŠï¼Ÿæˆ‘ä»¬å¯¹æ—¶é—´åˆ†æ²»/åˆ†å—å°±ä¼šå¥½å¾ˆå¤šã€‚\næˆ‘ä»¬è€ƒè™‘å¯¹æ—¶é—´å»ºç«‹çº¿æ®µæ ‘ï¼Œé‚£ä¹ˆæ¯æ¡è·¯éƒ½ä¼šæœ‰ä¸€ä¸ªå‡ºç°çš„æ—¶é—´åŒºé—´ï¼Œæˆ‘ä»¬ç”¨çº¿æ®µæ ‘çš„æ–¹æ³•æŠŠè¿™ä¸ªåŒºé—´åˆ†åˆ° $\\log Q$ ä¸ªèŠ‚ç‚¹ä¸Šã€‚è¿™æ ·æ€»å…±æœ‰ $O(Q \\log Q)$ ä¸ªèŠ‚ç‚¹ä¸Šå­˜åœ¨ä¸€ä¸ªä¿®æ”¹ã€‚\nå¯¹äºçº¿æ€§åŸºçš„é—®é¢˜ï¼Œæˆ‘ä»¬è€ƒè™‘åœ¨çº¿æ®µæ ‘ä¸Šè§£å†³è¿™ä¸ªé—®é¢˜ã€‚åœ¨ä¸€ä¸ªé•¿åº¦ä¸º $len$ çš„çº¿æ€§åŸºï¼ˆ bitset ä¼˜åŒ–ï¼‰é‡Œé¢æ’å…¥ä¸€ä¸ªæ•°çš„å¤æ‚åº¦æ˜¯ï¼š$O(\\frac{len^2}{w})$ ï¼Œå¤åˆ¶ä¸€ä¸ªçº¿æ€§åŸºçš„ä»£ä»·æ˜¯ $O(\\frac{len^2}{w})$ ã€‚æˆ‘ä»¬è€ƒè™‘åœ¨çº¿æ®µæ ‘ä¸Šdfsï¼ˆæ„Ÿè§‰æ˜¯ï¼‰ï¼Œç„¶åæˆ‘ä»¬éœ€è¦ç»´æŠ¤è¿™ä¸ªå¶å­åˆ°åŸç‚¹çš„é“¾ä¸Šçš„çº¿æ€§åŸºå³å¯ã€‚é‚£ä¹ˆæˆ‘ä»¬ä¸€å…±è¦å¤åˆ¶ $O(Q)$ æ¬¡çº¿æ€§åŸºï¼Œç´¯è®¡æ’å…¥ $O(Q \\log Q)$ æ¬¡ï¼ŒæŸ¥è¯¢ä¸€æ¬¡çš„å¤æ‚åº¦ä¹Ÿæ˜¯ $O(\\frac{len^2}{w})$ ï¼Œæ‰€ä»¥æœ€åçš„ä¸»è¦çš„æ—¶é—´å¤æ‚åº¦åº”è¯¥æ˜¯ $O(Q \\log Q \\frac{len^2}{w})$ ã€‚\nå¯¹äºç¯çš„è·å¾—ï¼Œæˆ‘ä»¬è€ƒè™‘åˆ°å¯ä»¥å…ˆæå‡ºåŸå›¾çš„ä¸€ä¸ªç”Ÿæˆæ ‘ï¼ˆdfs å³å¯ï¼‰ï¼Œç„¶åæŠŠæ‰€æœ‰éæ ‘è¾¹åŠ è¿›å»å³å¯ã€‚æ¯æ¬¡æ”¹å˜ä¸€ä¸ªè¾¹ï¼Œæˆ‘ä»¬éƒ½åªåŠ å…¥ä¸€ä¸ªç¯ï¼šdis[x]^dis[y]^v ï¼Œå…¶å®å°±æ˜¯ç”Ÿæˆæ ‘ä¸Šçš„ç¯ã€‚å…¶ä»–çš„ç¯éƒ½å¯ä»¥å¹¶å‡ºæ¥ã€‚\nå±…ç„¶è·‘çš„è¿™ä¹ˆå¿«orz\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136  #include \u0026lt;bits/stdc++.h\u0026gt;#define bs bitset\u0026lt;MAXN\u0026gt; using namespace std; const int MAXN = 1500,LOGN = 15; void char_to_bs(char *s,bs \u0026amp;res){ int l = strlen(s);reverse(s,s+l); res.reset(); for(int i = 0;i\u0026lt;l;i++){ if(s[i] == \u0026#39;1\u0026#39;) res[i] = 1; else if(s[i] == \u0026#39;0\u0026#39;) res[i] = 0; else assert(0); } } void bs_to_char(bs \u0026amp;s){int flag = 0; for(int i = MAXN-1;i\u0026gt;=0;i--){ if(s[i] == 1) flag = 1; if(flag) putchar(s[i]+\u0026#39;0\u0026#39;); }if(!flag) putchar(\u0026#39;0\u0026#39;); } struct LB{ bs basis[MAXN]; void clear(){for(int i = 0;i\u0026lt;MAXN;i++) basis[i].reset();} void ins(bs x){ for(int i = MAXN-1;i\u0026gt;=0;--i){ if(x[i] == 0) continue; if(basis[i].any()) x ^= basis[i]; else {basis[i] = x;break;} } } bs query(){ bs res; for(int i = MAXN-1;i\u0026gt;=0;--i) if(!res[i]) res ^= basis[i]; return res; } }BS[LOGN]; namespace SegTree{ vector\u0026lt;bs\u0026gt; v[MAXN\u0026lt;\u0026lt;2]; #define lson (x\u0026lt;\u0026lt;1)  #define rson (x\u0026lt;\u0026lt;1|1)  #define mid ((l+r)\u0026gt;\u0026gt;1)  void update(int x,int l,int r,int ql,int qr,bs val){ if(ql \u0026lt;= l \u0026amp;\u0026amp; r \u0026lt;= qr) v[x].push_back(val); else{ if(ql \u0026lt;= mid) update(lson,l,mid,ql,qr,val); if(qr \u0026gt;= mid+1) update(rson,mid+1,r,ql,qr,val); } } void solve(int x,int l,int r,int level,bs *ans){ BS[level] = BS[level-1]; for(int i = 0;i \u0026lt; (int)(v[x].size());i++) BS[level].ins(v[x][i]); if(l == r) ans[l] = BS[level].query(); else{ solve(lson,l,mid,level+1,ans); solve(rson,mid+1,r,level+1,ans); } } } struct Edge{ int to,nex;bs v; }edge[MAXN*2]; int fir[MAXN],ecnt = 2; void addedge(int a,int b,bs c){ edge[ecnt] = (Edge){b,fir[a],c},fir[a] = ecnt++; } int n,m,q,k; int a[MAXN],b[MAXN],tim[MAXN];bs c[MAXN]; int vis[MAXN];bs dis[MAXN]; bs ans[MAXN]; void dfs(int x,int fa){ vis[x] = 1; for(int e = fir[x];e;e = edge[e].nex){ int v = edge[e].to; if(v == fa) continue; if(vis[v] == 1) SegTree::update(1,0,q,0,q,dis[x]^dis[v]^edge[e].v); else{ dis[v] = dis[x] ^ edge[e].v; dfs(v,x); } } } void init(){ scanf(\u0026#34;%d %d %d\u0026#34;,\u0026amp;n,\u0026amp;m,\u0026amp;q); static char ss[MAXN]; for(int i = 1;i\u0026lt;=m;i++){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;a[i],\u0026amp;b[i]); scanf(\u0026#34;%s\u0026#34;,ss);char_to_bs(ss,c[i]); addedge(a[i],b[i],c[i]),addedge(b[i],a[i],c[i]); } } void solve(){ static char op[20],ss[MAXN];int t;bs tmp; for(int i = 1;i\u0026lt;=q;i++){ scanf(\u0026#34;%s\u0026#34;,op); if(op[0] == \u0026#39;A\u0026#39;){++k; // Add  tim[k] = i; scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;a[k],\u0026amp;b[k]); scanf(\u0026#34;%s\u0026#34;,ss);char_to_bs(ss,c[k]); } else if(op[1] == \u0026#39;a\u0026#39;){// Cancel  scanf(\u0026#34;%d\u0026#34;,\u0026amp;t); SegTree::update(1,0,q,tim[t],i-1,c[t]^dis[a[t]]^dis[b[t]]); tim[t] = -i; } else if(op[1] == \u0026#39;h\u0026#39;){// Change  scanf(\u0026#34;%d\u0026#34;,\u0026amp;t); scanf(\u0026#34;%s\u0026#34;,ss);char_to_bs(ss,tmp); SegTree::update(1,0,q,tim[t],i-1,c[t]^dis[a[t]]^dis[b[t]]); c[t] = tmp,tim[t] = i; } else assert(0); } for(int i = 1;i\u0026lt;=k;i++)if(tim[i] \u0026gt; 0){ SegTree::update(1,0,q,tim[i],q,c[i]^dis[a[i]]^dis[b[i]]); } SegTree::solve(1,0,q,1,ans); } void output(){for(int i = 0;i\u0026lt;=q;i++) bs_to_char(ans[i]),putchar(\u0026#39;\\n\u0026#39;);} int main(){ init(); dfs(1,0); solve(); output(); return 0; }   ","description":"","id":18,"section":"posts","tags":["æ•°æ®ç»“æ„","çº¿æ®µæ ‘åˆ†æ²»","çº¿æ€§åŸº"],"title":"ã€ŒHAOI2017ã€å…«çºµå…«æ¨ª-çº¿æ®µæ ‘åˆ†æ²»+çº¿æ€§åŸº","uri":"https://blog.chenqiqian.com/posts/haoi2017-railway/"},{"content":"æœ‰ $n$ ä¸ªå•†åº—ï¼Œæ¯ä¸ªå•†åº—éƒ½æœ‰ä¸€ä¸ªç‰¹æ®Šå•†å“ï¼Œæ¯ä¸ªäººåœ¨ä»»ä½•æ—¶é—´éƒ½å¯ä»¥ä¹°ã€‚ç¬¬ä¸€å¤©å¯èƒ½æ²¡æœ‰è¿›è´§ï¼Œæœ‰è‹¥å¹²æ¬¡è¯¢é—®ï¼Œè€Œä¹‹åçš„æ¯å¤©ï¼Œéƒ½æœ‰ä¸€æ¬¡è¿›è´§å’Œè‹¥å¹²æ¬¡è¯¢é—®ï¼Œæ¯æ¬¡è¿›è´§éƒ½æ˜¯æŸä¸ªå•†åº—è¿›äº†æŸä¸ªç¼–å·çš„è´§ï¼Œæ¯æ¬¡è¯¢é—®éƒ½æ˜¯è¯¢é—®åœ¨ç¼–å·ä¸º $l$ åˆ° $r$ çš„å•†åº—ä¸­ï¼Œåœ¨ $d$ å¤©å†…è¿›çš„è´§çš„ç¼–å·å¼‚æˆ– $x$ çš„æœ€å¤§å€¼ã€‚\né“¾æ¥ Luogu P4585\né¢˜è§£ æˆ‘ä»¬è€ƒè™‘å¦‚æœæ²¡æœ‰å¤©æ•°é™åˆ¶ï¼Œå°±æ˜¯ç±»ä¼¼ ã€ŒSCOI2016ã€ç¾å‘³ è¿™æ ·çš„é¢˜ï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ªå¯æŒä¹…åŒ– Trie å°±å¯ä»¥è§£å†³äº†ã€‚ç°åœ¨æœ‰æ—¶é—´çš„é™åˆ¶ï¼Œæˆ‘ä»¬ç”¨çº¿æ®µæ ‘å¥—å¯æŒä¹…åŒ–çº¿æ®µæ ‘è²Œä¼¼å°±å¯ä»¥äº†ï¼ˆï¼Œä½†æ˜¯è¿™ä¸ªä¸ä¼˜ç¾qwq\né‚£è®©æˆ‘ä»¬å­¦ä¹ ä¸€ä¸‹çº¿æ®µæ ‘åˆ†æ²»ã€‚\næˆ‘ä»¬å›æƒ³çº¿æ®µæ ‘çš„å·¥ä½œåŸç†ï¼Œæœ¬è´¨ä¸Šæ˜¯å°†ä¸€ä¸ªåŒºé—´åˆ’åˆ†æˆ $O(\\log n)$ ä¸ªåŒºé—´ï¼Œå¯¹äºè¿™ç§è´¡çŒ®å¯ä»¥ç´¯åŠ çš„é¢˜ç›®ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ†æ²»è¯¢é—®çš„æ—¶é—´åŒºé—´åˆ°çº¿æ®µæ ‘çš„èŠ‚ç‚¹ä¸Šï¼Œç„¶ååœ¨çº¿æ®µæ ‘ä¸Šè·‘ä¸€äº›ä»€ä¹ˆdfsä¹‹ç±»çš„å°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼ˆå½“ç„¶ï¼Œè´¡çŒ®ä¸ç‹¬ç«‹ä¹Ÿæ˜¯å¯ä»¥åšçš„ï¼Œå°±æ˜¯éœ€è¦æ‰€æœ‰çš„ $d$ éƒ½ç›¸åŒæˆ–è€…èƒ½å¤Ÿä»¥ç‰©å“çš„æ—¶é—´æ¥ç¡®å®šä¸€ä¸ªæŸ¥è¯¢çš„è´¡çŒ®æ¥è‡ªäºé‚£äº›ç‰©å“ï¼Œä¹Ÿå°±æ˜¯æŸ¥è¯¢çš„è´¡çŒ®æ¥è‡ªä¸æŸ¥è¯¢æ— å…³çš„åœ°æ–¹ï¼‰ã€‚\næˆ‘ä»¬è€ƒè™‘å¯¹æ—¶é—´åˆ†æ²»ï¼Œçº¿æ®µæ ‘çš„ä¸‹æ ‡æ˜¯æ—¶é—´ï¼Œç„¶åæ¯æ¬¡éƒ½æŠŠè¯¢é—®åˆ†æ•£åˆ° $O(\\log n)$ ä¸ªåŒºé—´ä¸Šï¼Œæœ€åå¯¹ç­”æ¡ˆå– $\\max$ å³å¯ã€‚\né‚£ä¹ˆæˆ‘ä»¬ç°åœ¨æ€»å…±æœ‰ $O(n \\log n)$ ä¸ªè¯¢é—®åœ¨ $O(n)$ ä¸ªèŠ‚ç‚¹é‡Œé¢ï¼Œæˆ‘ä»¬è€ƒè™‘æ¥å¤„ç†æ–°åŠ è¿›æ¥çš„ç‰©å“ã€‚\næˆ‘ä»¬æŠŠå•†å“å¯¹äºå‡ºç°çš„ä½ç½®æ’åºï¼Œç„¶åæˆ‘ä»¬æŒ‰ç…§æ—¶é—´æ¯æ¬¡éƒ½æŠŠæ‰€æœ‰è¯¢é—®åˆ’åˆ†åˆ°ä¸¤è¾¹å»ï¼Œæ¯ä¸ªçº¿æ®µæ ‘çš„èŠ‚ç‚¹éƒ½æ–°å»ºä¸€ä¸ªå¯æŒä¹…åŒ– Trieï¼Œæˆ‘ä»¬å¯ä»¥è¯æ˜è¿™ä¸ªä¸œè¥¿çš„å¤æ‚åº¦åªæœ‰ $O(n \\log^2 n)$ ï¼Œå› ä¸ºæ¯ä¸ªç‰©å“æœ€å¤šå‡ºç° $O(\\log n)$ æ¬¡ï¼Œæ¯æ¬¡æ’å…¥éƒ½æ˜¯ $O(\\log n)$ çš„ã€‚æˆ‘ä»¬å†å•ç‹¬å»ºç«‹ä¸€ä¸ªå¯æŒä¹…åŒ– Trie å¤„ç†ç‰¹æ®Šç‰©å“å³å¯ã€‚æ¯ä¸ªçº¿æ®µæ ‘èŠ‚ç‚¹å»ºç«‹ Trie çš„æ—¶å€™éœ€è¦ç¦»æ•£åŒ–ä¿è¯æ—¶é—´å¤æ‚åº¦æ­£ç¡®æ€§ã€‚\næ—¶é—´å¤æ‚åº¦ï¼š $O(n \\log^2 n)$ ï¼Œç©ºé—´å¤æ‚åº¦ $O(n \\log n)$ ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96  #include \u0026lt;bits/stdc++.h\u0026gt;using namespace std; const int MAXN = 110000,logn = 19; int c[MAXN*logn*2][2],sum[MAXN*logn*2],totp; struct Query{int id,l,r,x;}; struct Node{int tim,p,v;}; bool cmp(Node a,Node b){return a.p \u0026lt; b.p;} vector\u0026lt;Query\u0026gt; Q[MAXN\u0026lt;\u0026lt;2];// query vector\u0026lt;Node\u0026gt; N[MAXN\u0026lt;\u0026lt;2];// node / number  int query(int lc,int rc,int v){ int ans = 0; for(int i = logn-1;i\u0026gt;=0;--i){ ans \u0026lt;\u0026lt;= 1;int t = (v\u0026gt;\u0026gt;i) \u0026amp; 1; if(sum[c[rc][t^1]] - sum[c[lc][t^1]] \u0026gt; 0) lc = c[lc][t^1],rc = c[rc][t^1],ans ^= 1; else lc = c[lc][t],rc = c[rc][t]; } return ans; } void modify(int \u0026amp;x,int pre,int v){ int now = x = ++totp; for(int i = logn-1;i\u0026gt;=0;--i){ int t = (v\u0026gt;\u0026gt;i) \u0026amp; 1; c[now][t] = ++totp,c[now][t^1] = c[pre][t^1]; sum[now] = sum[pre]+1; now = c[now][t],pre = c[pre][t]; } sum[now] = sum[pre] + 1; } #define mid ((l+r)/2) #define lson (x\u0026lt;\u0026lt;1) #define rson (x\u0026lt;\u0026lt;1|1) void addq(int x,int l,int r,int ql,int qr,Query q){ if(qr \u0026lt; l || ql \u0026gt; r || ql \u0026gt; qr) return; if(ql \u0026lt;= l \u0026amp;\u0026amp; r \u0026lt;= qr) Q[x].push_back(q); else{ if(ql \u0026lt;= mid) addq(lson,l,mid,ql,qr,q); if(qr \u0026gt;= mid+1) addq(rson,mid+1,r,ql,qr,q); } } int rt[MAXN],tmp[MAXN],ans[MAXN]; void solve(int x,int l,int r){ if(N[x].size() == 0) return; tmp[0] = totp = 0;// æ¸…ç©º Trie  tmp[++tmp[0]] = 0,rt[1] = 0; for(int i = 0;i \u0026lt; (int)(N[x].size());i++){ tmp[++tmp[0]] = N[x][i].p; rt[tmp[0]] = 0,modify(rt[tmp[0]],rt[tmp[0]-1],N[x][i].v); if(l == r) continue; if(N[x][i].tim \u0026lt;= mid) N[lson].push_back(N[x][i]); else N[rson].push_back(N[x][i]); } for(int i = 0;i \u0026lt; (int)(Q[x].size());i++){ int L = upper_bound(tmp+1,tmp+tmp[0]+1,Q[x][i].l-1) - tmp - 1; int R = upper_bound(tmp+1,tmp+tmp[0]+1,Q[x][i].r) - tmp - 1; ans[Q[x][i].id] = max(ans[Q[x][i].id],query(rt[L],rt[R],Q[x][i].x)); } if(l == r) return; solve(lson,l,mid),solve(rson,mid+1,r); } int n,m,tott,totq; int val[MAXN]; int main(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m); for(int i = 1;i\u0026lt;=n;i++) scanf(\u0026#34;%d\u0026#34;,\u0026amp;val[i]); totp = 0; for(int i = 1;i\u0026lt;=n;i++) rt[i] = 0,modify(rt[i],rt[i-1],val[i]); int op,L,R,x,d,s,v; for(int i = 1;i\u0026lt;=m;i++){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;op); if(op == 0){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;s,\u0026amp;v); tott++; N[1].push_back((Node){tott,s,v}); } else if(op == 1){ scanf(\u0026#34;%d %d %d %d\u0026#34;,\u0026amp;L,\u0026amp;R,\u0026amp;x,\u0026amp;d); ++totq; addq(1,1,m,tott-d+1,tott,(Query){totq,L,R,x}); ans[totq] = query(rt[L-1],rt[R],x); } } sort(N[1].begin(),N[1].end(),cmp); solve(1,1,m); for(int i = 1;i\u0026lt;=totq;i++) printf(\u0026#34;%d\\n\u0026#34;,ans[i]); return 0; }   ","description":"","id":19,"section":"posts","tags":["æ•°æ®ç»“æ„","çº¿æ®µæ ‘","çº¿æ®µæ ‘åˆ†æ²»","å¯æŒä¹…åŒ–çº¿æ®µæ ‘","Trie"],"title":"ã€ŒFJOI2015ã€ç«æ˜Ÿå•†åº—é—®é¢˜-çº¿æ®µæ ‘åˆ†æ²»+å¯æŒä¹…åŒ–Trie","uri":"https://blog.chenqiqian.com/posts/fjoi2015-shop/"},{"content":"Doris åˆšåˆšå­¦ä¹ äº† fibnacci æ•°åˆ—ï¼Œç”¨ $f[i]$ è¡¨ç¤ºæ•°åˆ—çš„ç¬¬ $i$ é¡¹ï¼Œé‚£ä¹ˆï¼š $f[0] = 0,f[1] = 1,f[n] = f[n - 1] + f[n - 2](n \\geq 2)$ ã€‚\nDoris ç”¨è€å¸ˆçš„è¶…çº§è®¡ç®—æœºç”Ÿæˆäº†ä¸€ä¸ª $n \\times m$ çš„è¡¨æ ¼ï¼Œç¬¬ $i$ è¡Œç¬¬ $j$ åˆ—çš„æ ¼å­ä¸­çš„æ•°æ˜¯ $f[\\gcd(i, j)]$ï¼Œå…¶ä¸­ $\\gcd(i, j)$ è¡¨ç¤º $i$ ä¸ $j$ çš„æœ€å¤§å…¬çº¦æ•°ã€‚\nDoris çš„è¡¨æ ¼ä¸­å…±æœ‰ $n \\times m$ ä¸ªæ•°ï¼Œå¥¹æƒ³çŸ¥é“è¿™äº›æ•°çš„ä¹˜ç§¯æ˜¯å¤šå°‘ã€‚\nè¿™äº›æ•°çš„ä¹˜ç§¯å®åœ¨æ˜¯å¤ªå¤§äº†ï¼Œæ‰€ä»¥ Doris åªæƒ³çŸ¥é“ä¹˜ç§¯å¯¹ $1000000007$ å–æ¨¡åçš„ç»“æœã€‚\né“¾æ¥ Luogu P3704\né¢˜è§£ ä»¤ $fib(i)$ ä¸ºæ–æ³¢é‚£å¥‘æ•°åˆ—çš„ç¬¬ $i$ é¡¹ï¼Œæˆ‘ä»¬è¦æ±‚çš„æ˜¯ï¼š\n$$\n\\prod_{i=1}^n \\prod_{j=1}^m fib(\\gcd(i,j))\n$$\næ¨æ¨å¼å­ï¼ˆä¸å¦¨è®¾ $n \\le m$ï¼‰ï¼š\n$$\n\\prod_{i=1}^n \\prod_{j=1}^m fib(\\gcd(i,j))\\\n= \\prod_{d=1}^n fib(d)^{g(d)}\n$$\nå…¶ä¸­ ï¼š\n$$\ng(d) = \\sum_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor} \\sum_{j=1}^{\\lfloor\\frac{m}{d}\\rfloor} [\\gcd(i,j) = 1]\\\n= \\sum_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor} \\sum_{j=1}^{\\lfloor\\frac{m}{d}\\rfloor} \\sum_{k | \\gcd(i,j)} \\mu(k)\\\n= \\sum_{k=1}^{\\lfloor\\frac{n}{d}\\rfloor} \\mu(k) \\lfloor \\frac{\\lfloor\\frac{n}{d}\\rfloor} {k}\\rfloor \\lfloor \\frac{\\lfloor\\frac{m}{d}\\rfloor} {k}\\rfloor\\\n= \\sum_{k=1}^{\\lfloor\\frac{n}{d}\\rfloor} \\mu(k)\\lfloor\\frac{n}{dk}\\rfloor\\lfloor\\frac{m}{dk}\\rfloor\\\n$$\nä»¥ä¸Šæ˜¯æˆ‘ä¼šçš„å…¨éƒ¨\u0026hellip;\næˆ‘ä»¬ä»¤ $T = kd$ ï¼Œç„¶åç›´æ¥ä»£åˆ°æœ€å¤–é¢ï¼š\n$$\nsum = \\prod_{d=1}^{n} fib(d)^{\\sum_{k=1}^{\\lfloor\\frac{n}{d}\\rfloor} \\mu(k)\\lfloor\\frac{n}{dk}\\rfloor\\lfloor\\frac{m}{dk}\\rfloor}\\\n= \\prod_{k=1}^{n} \\prod_{d = 1}^{\\lfloor\\frac{n}{k}\\rfloor}fib(d)^{\\mu(k)\\lfloor\\frac{n}{dk}\\rfloor\\lfloor\\frac{m}{dk}\\rfloor}\\\n=\\prod_{T=1}^n \\prod_{k | T} fib(\\frac{T}{k})^{\\mu(k)\\lfloor\\frac{n}{T}\\rfloor\\lfloor\\frac{m}{T}\\rfloor}\n$$\nç„¶åæˆ‘ä»¬å¦‚æœä»¤ï¼š\n$$\nf(T) = \\prod_{k|T} fib(\\frac{T}{k})^{\\mu(k)}\n$$\nåŸæ¥çš„å¼å­å°±è¡¨ç¤ºä¸ºï¼š\n$$\nsum = \\prod_{T=1}^n {f(T)}^{\\lfloor\\frac{n}{T}\\rfloor\\lfloor\\frac{m}{T}\\rfloor}\n$$\n$O(n\\log n)$ æå‡ºæ¥ $f$ çš„å–å€¼ï¼Œç„¶åèƒ¡é€¼åˆ†å—å³å¯ã€‚\næ—¶é—´å¤æ‚åº¦ï¼š$O(n \\log n + T \\sqrt n)$\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62  #include \u0026lt;bits/stdc++.h\u0026gt;#define ll long long using namespace std; const int MAXN = 1010000,mod = 1e9+7; ll qpow(ll x,ll k){ ll ans = 1; for(lli= k;i;i\u0026gt;\u0026gt;=1,x = (x*x)%mod) if(i \u0026amp; 1) ans = ans * x % mod; return ans; } int mu[MAXN],f[MAXN],fib[MAXN],inv[MAXN]; int sum[MAXN],sinv[MAXN]; void sieve(int n){ // \\sum_{d | n} \\mu(d) = [n=1]  // mu(n) = [n=1] - \\sum_{d \u0026lt; n,d | n} mu(d)  mu[1] = 1; for(inti= 1;i\u0026lt;=n;i++){ for(intj= i+i;j\u0026lt;=n;j+=i) mu[j] -= mu[i]; } for(inti= 0;i\u0026lt;=n;i++){f[i] = 1;} for(inti= 1;i\u0026lt;=n;i++){ fib[i] = i==1? 1 : fib[i-1] + fib[i-2]; if(fib[i] \u0026gt;= mod) fib[i] -= mod; inv[i] = qpow(fib[i],mod-2); for(intj= i,k = 1;j\u0026lt;=n;j+=i,k++){ f[j] = 1LL * f[j] * (mu[k] == 1?fib[i]:(mu[k]==0?1:inv[i])) % mod; } } sum[0] = sinv[0] = 1; for(inti= 1;i\u0026lt;=n;i++){ sum[i] = 1LL * sum[i-1] * f[i] % mod; sinv[i] = 1LL * sinv[i-1] * qpow(f[i],mod-2) % mod; } } int calc(int n,int m){ if(n \u0026gt; m) swap(n,m); int ans = 1; for(int l = 1,r;l\u0026lt;=n;l = r+1){ r = min(n/(n/l),m/(m/l)); int A = 1LL * sum[r] * sinv[l-1] % mod; int B = 1LL * (n/l) * (m/l) % (mod-1); // printf(\u0026#34;l:%d A:%d B:%d\\n\u0026#34;,l,A,B);  ans = 1LL * ans * qpow(A,B) % mod; } return ans; } signed main(){ sieve(1000000); int T; scanf(\u0026#34;%d\u0026#34;,\u0026amp;T); for(inti= 1;i\u0026lt;=T;i++){ int n,m; scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m); printf(\u0026#34;%d\\n\u0026#34;,calc(n,m)); } return 0; }   ","description":"","id":20,"section":"posts","tags":["æ•°è®º","æ•°å­¦"],"title":"ã€ŒSDOI2017ã€æ•°å­—è¡¨æ ¼-æ•°è®º","uri":"https://blog.chenqiqian.com/posts/sdoi2017-product/"},{"content":"Bob æœ‰ä¸€æ£µ $nâ€‹$ ä¸ªç‚¹çš„æœ‰æ ¹æ ‘ï¼Œå…¶ä¸­ $1â€‹$ å·ç‚¹æ˜¯æ ¹èŠ‚ç‚¹ã€‚Bob åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šæ¶‚äº†é¢œè‰²ï¼Œå¹¶ä¸”æ¯ä¸ªç‚¹ä¸Šçš„é¢œè‰²ä¸åŒã€‚\nå®šä¹‰ä¸€æ¡è·¯å¾„çš„æƒå€¼æ˜¯ï¼Œè¿™æ¡è·¯å¾„ä¸Šçš„ç‚¹ï¼ˆåŒ…æ‹¬èµ·ç‚¹å’Œç»ˆç‚¹ï¼‰å…±æœ‰å¤šå°‘ç§ä¸åŒçš„é¢œè‰²ã€‚\nBob å¯èƒ½ä¼šè¿›è¡Œè¿™å‡ ç§æ“ä½œï¼š\n 1 xï¼ŒæŠŠç‚¹ $x$ åˆ°æ ¹èŠ‚ç‚¹çš„è·¯å¾„ä¸Šçš„æ‰€æœ‰çš„ç‚¹æŸ“ä¸Šä¸€ç§æ²¡æœ‰ç”¨è¿‡çš„æ–°é¢œè‰²ï¼› 2 x yï¼Œæ±‚ $x$ åˆ° $y$ çš„è·¯å¾„çš„æƒå€¼ï¼› 3 xï¼Œåœ¨ä»¥ $x$ ä¸ºæ ¹çš„å­æ ‘ä¸­é€‰æ‹©ä¸€ä¸ªç‚¹ï¼Œä½¿å¾—è¿™ä¸ªç‚¹åˆ°æ ¹èŠ‚ç‚¹çš„è·¯å¾„æƒå€¼æœ€å¤§ï¼Œæ±‚æœ€å¤§æƒå€¼ã€‚  Bob ä¸€å…±ä¼šè¿›è¡Œ $m$ æ¬¡æ“ä½œã€‚\né“¾æ¥ Luogu P3703\né¢˜è§£ æˆ‘ä»¬æ³¨æ„åˆ°å¾ˆé‡è¦çš„ä¸€ç‚¹æ˜¯ï¼šæŸ“ä¸Šä¸€ç§æ²¡æœ‰ç”¨è¿‡çš„æ–°é¢œè‰²ã€‚å†åŠ ä¸Šæ¯æ¬¡æŸ“è‰²éƒ½æ˜¯ä»è¿™ä¸ªç‚¹åˆ°æ ¹èŠ‚ç‚¹ï¼Œè¿™æ„å‘³ç€ï¼Œæœ‰å¤šå°‘æ®µé¢œè‰²å°±æœ‰å¤šå°‘ç§é¢œè‰²ã€‚\næˆ‘ä»¬å¦‚æœä»¤ $f(x)$ ä¸º $x$ åˆ°æ ¹èŠ‚ç‚¹é¢œè‰²çš„æ®µæ•°ï¼Œ$g(x,y)$ ä¸ºç¬¬äºŒä¸ªæ“ä½œçš„ç­”æ¡ˆï¼Œä¸éš¾å‘ç°å¦‚ä¸‹æ€§è´¨ï¼š\n$$\ng(x,y) = f(x) + f(y) - 2*\\text{lca}(x,y) + 1\n$$\nè¿™ä¸ªå…¶å®å¯ä»¥é€šè¿‡è€ƒè™‘é¢œè‰²æ®µ+1çš„æœ¬è´¨æ˜¯å‡ºç°äº†ä¸€ä¸ªåˆ†å‰²ç‚¹ã€‚\nç„¶åæˆ‘ä»¬è€ƒè™‘å¦‚ä½•ç»´æŠ¤ $f(x)$ çš„å€¼ã€‚\næˆ‘ä»¬ç»™ä¸€ä¸ªç‚¹åˆ°æ ¹èŠ‚ç‚¹æŸ“ä¸Šè‰²ï¼Œå°±æ˜¯è®©è¿™ä¸ªç‚¹åˆ°æ ¹èŠ‚ç‚¹æ‰“é€šæˆä¸ºä¸€æ¡è¿é€šå—ã€‚å’¦ï¼Ÿä¼¼ä¹å¾ˆåƒ access ï¼Ÿé‚£æˆ‘ä»¬å²‚ä¸æ¯æ¬¡ access ä¸€ä¸‹å°±å¯ä»¥äº†ï¼Œç„¶åæˆ‘ä»¬å‘ç° access çš„æ—¶å€™åˆ‡æ¢è™šå®è¾¹çš„æ¬¡æ•°å°±æ˜¯è¿™ä¸ªç‚¹çš„ç­”æ¡ˆã€‚è¿™æ ·æˆ‘ä»¬æŒ‰ç…§ dfs åºåˆ—æ„é€ ä¸€æ£µçº¿æ®µæ ‘ï¼Œåˆ‡æ¢è™š/å®è¾¹çš„æ—¶å€™æ›´æ–°çº¿æ®µæ ‘+1/-1å³å¯ã€‚\næ—¶é—´å¤æ‚åº¦ï¼š$O(n \\log n)$\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149  #include \u0026lt;bits/stdc++.h\u0026gt;using namespace std; const int MAXN = 110000; namespace SegTree{ #define ls (x\u0026lt;\u0026lt;1)  #define rs (x\u0026lt;\u0026lt;1|1)  #define mid ((l+r)\u0026gt;\u0026gt;1)  int mx[MAXN\u0026lt;\u0026lt;2],lzy[MAXN\u0026lt;\u0026lt;2]; void add(int x,int v){mx[x] += v,lzy[x] += v;} void push_down(int x){if(lzy[x]) add(ls,lzy[x]),add(rs,lzy[x]),lzy[x] = 0;} void push_up(int x){mx[x] = max(mx[ls],mx[rs]);} void build(int x,int l,int r,int *a){ if(l == r) mx[x] = a[l]; else{ build(ls,l,mid,a),build(rs,mid+1,r,a); push_up(x); } } void update(int x,int l,int r,int ql,int qr,int v){ if(ql \u0026lt;= l \u0026amp;\u0026amp; r \u0026lt;= qr) add(x,v); else{ push_down(x); if(ql \u0026lt;= mid) update(ls,l,mid,ql,qr,v); if(qr \u0026gt;= mid+1) update(rs,mid+1,r,ql,qr,v); push_up(x); } } int query(int x,int l,int r,int ql,int qr){ if(ql \u0026lt;= l \u0026amp;\u0026amp; r \u0026lt;= qr) return mx[x]; else{ push_down(x); int ans = -0x3f3f3f3f; if(ql \u0026lt;= mid) ans = max(ans,query(ls,l,mid,ql,qr)); if(qr \u0026gt;= mid+1) ans = max(ans,query(rs,mid+1,r,ql,qr)); return ans; } } } struct Edge{ int to,nex; }edge[MAXN*2]; int fir[MAXN],ecnt = 2; void addedge(int a,int b){ edge[ecnt] = (Edge){b,fir[a]},fir[a] = ecnt++; } int n,m; int dfn[MAXN],f[MAXN],siz[MAXN],dep[MAXN],son[MAXN],top[MAXN]; void dfs0(int x,int fa,int depth){ siz[x] = 1,f[x] = fa,dep[x] = depth; for(int e = fir[x];e;e = edge[e].nex){ int v = edge[e].to; if(v == fa) continue; dfs0(v,x,depth+1); siz[x] += siz[v]; if(siz[v] \u0026gt; siz[son[x]]) son[x] = v; } } void dfs1(int x,int topf){ top[x] = topf;dfn[x] = ++dfn[0]; if(!son[x]) return; dfs1(son[x],topf); for(int e = fir[x];e;e = edge[e].nex){ int v = edge[e].to; if(v == son[x] || v == f[x]) continue; dfs1(v,v); } } int lca(int x,int y){ while(top[x] != top[y]){ if(dep[top[x]] \u0026lt; dep[top[y]]) swap(x,y); x = f[top[x]]; } if(dep[x] \u0026gt; dep[y]) swap(x,y); return x; } void update_tree(int x,int v){ if(!x) return; SegTree::update(1,1,n,dfn[x],dfn[x]+siz[x]-1,v); } int query_tree(int x){return SegTree::query(1,1,n,dfn[x],dfn[x]+siz[x]-1);} int query(int x){return SegTree::query(1,1,n,dfn[x],dfn[x]);} int query(int x,int y){return query(x)+query(y)-2*query(lca(x,y))+1;} namespace LCT{ int c[MAXN][2],f[MAXN],mn[MAXN]; void init(int n,int *fa){for(int i = 1;i\u0026lt;=n;i++) f[i] = fa[i],mn[i] = i;} bool noroot(int x){return c[f[x]][0] == x || c[f[x]][1] == x;} void push_up(int x){mn[x] = c[x][0]?mn[c[x][0]]:x;} void rotate(int x){ int y = f[x],z = f[y],t = (c[y][1] == x),w = c[x][1-t]; if(noroot(y)) c[z][c[z][1]==y] = x; c[x][1-t] = y,c[y][t] = w; if(w) f[w] = y; f[y] = x,f[x] = z; push_up(y); } void splay(int x){ while(noroot(x)){ int y = f[x],z = f[y]; if(noroot(y)){ (c[y][1]==x)^(c[z][1]==y)?rotate(x):rotate(y); }rotate(x); push_up(x); } } void access(int x){ for(int y = 0;x;x = f[y=x]){ splay(x); update_tree(mn[c[x][1]],1),update_tree(mn[y],-1); c[x][1] = y,push_up(x); } } } void modify(int x){LCT::access(x);} void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m); for(int i = 2;i\u0026lt;=n;i++){ int a,b; scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;a,\u0026amp;b); addedge(a,b),addedge(b,a); } dfs0(1,0,1),dfs1(1,1); static int v[MAXN]; for(int i = 1;i\u0026lt;=n;i++) v[dfn[i]] = dep[i]; SegTree::build(1,1,n,v),LCT::init(n,f); } void solve(){ int op,x,y; for(int i = 1;i\u0026lt;=m;i++){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;op); if(op == 1) scanf(\u0026#34;%d\u0026#34;,\u0026amp;x),modify(x); else if(op == 2) scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;x,\u0026amp;y),printf(\u0026#34;%d\\n\u0026#34;,query(x,y)); else if(op == 3) scanf(\u0026#34;%d\u0026#34;,\u0026amp;x),printf(\u0026#34;%d\\n\u0026#34;,query_tree(x)); } } int main(){ init(),solve(); return 0; }   ","description":"","id":21,"section":"posts","tags":["æ ‘å½¢ç»“æ„","dfsåº","LCT","çº¿æ®µæ ‘"],"title":"ã€ŒSDOI2017ã€æ ‘ç‚¹æ¶‚è‰²-LCT+æ ‘é“¾å‰–åˆ†","uri":"https://blog.chenqiqian.com/posts/sdoi2017-paint/"},{"content":"ç»™å®š $n,m,k$ ï¼Œè®¡ç®—\n$$\n\\sum_{i=1}^n\\sum_{j=1}^m {\\gcd(i,j)}^k\n$$\nå¯¹ $1000000007$ å–æ¨¡çš„ç»“æœ\né“¾æ¥ Luogu P4449\né¢˜è§£ æˆ‘ä»¬æ¥æ¥æ¥æ¨æ¨æ¨å¼å­å§qwq\n$$\n\\sum_{i=1}^n\\sum_{j=1}^m {\\gcd(i,j)}^k\n$$\nä¸å¦¨ä»¤ $n\u0026lt;m$ ï¼Œæšä¸¾ $\\gcd(i,j) = d$ ï¼š\n$$\nS = \\sum_{d=1}^{n} d^k \\sum_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum_{i=1}^{\\lfloor\\frac{m}{d}\\rfloor} [(i,j)=1]\\\n= \\sum_{d=1}^{n} d^k \\sum_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum_{i=1}^{\\lfloor\\frac{m}{d}\\rfloor} \\sum_{t | \\gcd(i,j)} \\mu(t)\\\n= \\sum_{d=1}^{n} d^k \\sum_{t = 1}^{\\lfloor\\frac{n}{d}\\rfloor} \\mu(t)\\sum_{i=1}^{\\lfloor\\frac{n}{dt}\\rfloor}\\sum_{i=1}^{\\lfloor\\frac{m}{dt}\\rfloor} 1\\\n= \\sum_{d=1}^{n} d^k \\sum_{t = 1}^{\\lfloor\\frac{n}{d}\\rfloor} \\mu(t) \\lfloor\\frac{n}{dt}\\rfloor \\lfloor\\frac{m}{dt}\\rfloor\\\n$$\nä»¤ $dt = T$ ï¼Œæˆ‘ä»¬æœ‰ï¼š\n$$\nS = \\sum_{T=1}^{n} \\lfloor\\frac{n}{T}\\rfloor \\lfloor\\frac{m}{T}\\rfloor\\sum_{d|T}d^k\\mu(\\frac{T}{d})\n$$\næˆ‘ä»¬ä»¤ $g(T) = \\sum_{d|T}d^k\\mu(\\frac{T}{d})$ï¼ŒåŸå¼å˜ä¸ºï¼š\n$$\nS = \\sum_{T=1}^{n} \\lfloor\\frac{n}{T}\\rfloor \\lfloor\\frac{m}{T}\\rfloor g(T)\n$$\nå¾ˆæ˜æ˜¾è¿™ä¸ªå¯ä»¥æ•´é™¤åˆ†å—ï¼Œå¾ˆæ˜æ˜¾ $g$ æ˜¯ä¸€ä¸ªç§¯æ€§å‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬è€ƒè™‘å¦‚ä½•ç®—å‡º $g$ çš„å‰ç¼€å’Œã€‚\nå‘ç° $n,m$ çš„èŒƒå›´æ¯”è¾ƒå°ï¼Œå¯ä»¥è€ƒè™‘ç”¨çº¿æ€§ç­›è§£å†³è¿™ä¸ªé—®é¢˜ã€‚\nçº¿æ€§ç­›çš„æœ¬è´¨æ˜¯ä¸æ–­åŠ å…¥æœ€å°è´¨å› å­ï¼Œæˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªè´¨æ•°çš„\n$$\ng(P^t) = \\sum_{i=0}^t f(P^i) \\mu (P^{t-i})\n$$\nå‡¡æ˜¯æœ‰å¹³æ–¹å› å­çš„æ•°éƒ½æ˜¯çš„è«æ¯”ä¹Œæ–¯å‡½æ•°å€¼éƒ½æ˜¯ $0$ ï¼Œæ‰€ä»¥è¿™ä¸ªå¼å­åŒ–æˆï¼š\n$$\ng(P^t) = \\mu(1) f(P^t) + \\mu(P)f(P^{t-1})\\\n= f(P^t) - f(P^{t-1})\n= P^{kt} - P^{k(t-1)}\n= P^{k(t-1)}(P^{k}-1)\n$$\nå¯ä»¥æ³¨æ„åˆ°å¦‚æœæ²¡æœ‰ $P$ è¿™ä¸ªè´¨å› å­ï¼Œç­”æ¡ˆå°±æ˜¯ç›´æ¥ä¹˜ä¸Š $P^k-1$ ï¼Œå¦‚æœæœ‰å°±ä¹˜ä¸Š $P^k$ å³å¯ã€‚\nè¿™å¤§æ¦‚ä¹Ÿæ˜¯çº¿æ€§ç­›ç­›æœªçŸ¥ç§¯æ€§å‡½æ•°çš„å¥—è·¯ï¼šç®—å‡ºæ¥ $g(P^t)$ å¹¶è§‚å¯Ÿè¿™ä¸ªä¸œè¥¿çš„æ€§è´¨ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥è®°å½•æœ€å°è´¨å› å­çš„å¤§å°ã€‚\næ—¶é—´å¤æ‚åº¦ï¼š $O(n + T \\sqrt n)$ ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61  #include \u0026lt;bits/stdc++.h\u0026gt;#define ll long long using namespace std; const int MAXN = 5100000,mod = 1e9+7; ll pow(ll x,ll k, ll p){ ll ans = 1; for(ll i = k;i;i\u0026gt;\u0026gt;=1,x = (x*x)%p) if(i\u0026amp;1) ans = ans * x % p; return ans; } int g[MAXN],s[MAXN]; int noprime[MAXN],prime[MAXN]; void sieve(int n,int k){ g[1] = 1; for(int i = 2;i\u0026lt;=n;i++){ if(!noprime[i]){ prime[++prime[0]] = i,g[i] = pow(i,k,mod)-1; if(g[i] \u0026lt; 0) g[i] += mod;//å®¹æ˜“å‡ºé”…...  } for(int j = 1;j \u0026lt;= prime[0] \u0026amp;\u0026amp; i*prime[j] \u0026lt;= n;j++){ noprime[i*prime[j]] = 1; if(i % prime[j] == 0){ g[i*prime[j]] = 1LL * g[i] * (g[prime[j]]+1) % mod; break; } g[i*prime[j]] = 1LL * g[i] * g[prime[j]] % mod; } } for(int i = 1;i\u0026lt;=n;i++) { s[i] = s[i-1] + g[i]; if(s[i] \u0026gt;= mod) s[i] -= mod; } } int calc(int n,int m){ if(n \u0026gt; m) swap(n,m); int ans = 0; for(int l = 1,r;l \u0026lt;= n;l = r + 1){ r = min(n/(n/l),m/(m/l)); int tmp = (1LL * (n/l) * (m/l)) % mod; // å¤šåŠ æ‹¬å·...  int sum = s[r] - s[l-1]; if(sum \u0026lt; 0) sum += mod; ans = (ans + 1LL * tmp * sum) % mod; } return ans; } int main(){ int T,k; scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;T,\u0026amp;k); sieve(5000000,k); for(int i = 1;i\u0026lt;=T;i++){ int n,m; scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m); printf(\u0026#34;%d\\n\u0026#34;,calc(n,m)); } return 0; }   ","description":"","id":22,"section":"posts","tags":["æ•°å­¦","æ•°è®º"],"title":"ã€ŒLuogu4449ã€äºç¥ä¹‹æ€’åŠ å¼ºç‰ˆ-æ•°å­¦","uri":"https://blog.chenqiqian.com/posts/luogu-4499/"},{"content":"ç»™å®šä¸€ä¸ªç”± $n$ è¡Œæ•°å­—ç»„æˆçš„æ•°å­—æ¢¯å½¢å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚æ¢¯å½¢çš„ç¬¬ä¸€è¡Œæœ‰ $m$ ä¸ªæ•°å­—ã€‚ä»æ¢¯å½¢çš„é¡¶éƒ¨çš„ $m$ ä¸ªæ•°å­—å¼€å§‹ï¼Œåœ¨æ¯ä¸ªæ•°å­—å¤„å¯ä»¥æ²¿å·¦ä¸‹æˆ–å³ä¸‹æ–¹å‘ç§»åŠ¨ï¼Œå½¢æˆä¸€æ¡ä»æ¢¯å½¢çš„é¡¶è‡³åº•çš„è·¯å¾„ã€‚\nåˆ†åˆ«éµå®ˆä»¥ä¸‹è§„åˆ™ï¼š\n ä»æ¢¯å½¢çš„é¡¶è‡³åº•çš„ $m$ æ¡è·¯å¾„äº’ä¸ç›¸äº¤ï¼› ä»æ¢¯å½¢çš„é¡¶è‡³åº•çš„ $m$ æ¡è·¯å¾„ä»…åœ¨æ•°å­—ç»“ç‚¹å¤„ç›¸äº¤ï¼› ä»æ¢¯å½¢çš„é¡¶è‡³åº•çš„ $m$ æ¡è·¯å¾„å…è®¸åœ¨æ•°å­—ç»“ç‚¹ç›¸äº¤æˆ–è¾¹ç›¸äº¤ã€‚  é“¾æ¥ LOJ6010\né¢˜è§£ è´¹ç”¨æµ 3 in 1\u0026hellip;\nè€ƒè™‘æŠŠæ¯ä¸ªç‚¹æ‹†ç‚¹ï¼Œç„¶åé™åˆ¶å¦‚ä½•æ»¡è¶³å‘¢ï¼Ÿ\n æˆ‘ä»¬æŠŠæ‰€æœ‰è¾¹å’Œç‚¹ä¹‹é—´çš„æƒå€¼éƒ½è®¾ç½®æˆä¸º 1 æˆ‘ä»¬æŠŠæ‹†ç‚¹çš„ä¸¤ä¸ªç‚¹ä¹‹é—´çš„å®¹é‡è®¾ç½®æˆä¸º infï¼Œå…¶ä»–åœ°æ–¹éƒ½æ˜¯ 1 æ‰€æœ‰éƒ½æ˜¯ inf  æ³¨æ„åŸç‚¹å¾€æœ€ä¸Šé¢ä¸€å±‚çš„æ¯ä¸€ä¸ªç‚¹éƒ½æ˜¯å®¹é‡ä¸º 1 çš„ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124  #include \u0026lt;bits/stdc++.h\u0026gt;#define inf 0x3f3f3f3f using namespace std; const int MAXN = 800,MAXM = MAXN*40; namespace MCMF{//æœ€å¤§è´¹ç”¨  int S,T; struct Edge{ int from,to; int cap,flow; int cost,nex; }edge[MAXM*2]; int fir[MAXN],ecnt = 2; void addedge(int a,int b,int c,int d){ edge[ecnt] = (Edge){a,b,c,0, d,fir[a]},fir[a] = ecnt++; edge[ecnt] = (Edge){b,a,0,0,-d,fir[b]},fir[b] = ecnt++; } void clear(){memset(fir,0,sizeof(fir)),ecnt = 2;} int dis[MAXN],inq[MAXN]; bool spfa(){ memset(dis,0x3f,sizeof(dis)); static queue\u0026lt;int\u0026gt; q; dis[S] = 0;q.push(S); while(!q.empty()){ int x = q.front();q.pop();inq[x] = 0; for(int e = fir[x];e;e = edge[e].nex){ int v = edge[e].to; if(edge[e].cap \u0026gt; edge[e].flow \u0026amp;\u0026amp; dis[v] \u0026gt; dis[x] + edge[e].cost){ dis[v] = dis[x] + edge[e].cost; if(!inq[v]) q.push(v),inq[v] = 1; } } } return dis[T] \u0026lt; dis[0]; } int dfs(int x,int limit = inf){ if(x == T || limit == 0) return limit; int sumf = 0;inq[x] = 1; for(int e = fir[x];e;e = edge[e].nex){ int v = edge[e].to; if(!inq[v] \u0026amp;\u0026amp; dis[v] == dis[x] + edge[e].cost){ int f = dfs(v,min(limit,edge[e].cap - edge[e].flow)); sumf += f,limit -= f; edge[e].flow += f, edge[e^1].flow -= f; if(limit == 0) break; } } return sumf; } pair\u0026lt;int,int\u0026gt; solve(int s,int t){ S = s,T = t; int ansf = 0,ansc = 0; while(spfa()){ int f = dfs(s); memset(inq,0,sizeof(inq)); ansf += f,ansc += f * dis[t]; } return make_pair(ansf,ansc); } } int m,n; int v[40][40]; int _h(int i,int j){return ((m+(m+i-2))*(i-1)/2)+j;} int in(int i,int j){return _h(i,j)*2-1;} int out(int i,int j){return _h(i,j)*2;} void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;m,\u0026amp;n); for(int i = 1;i\u0026lt;=n;i++) for(int j = 1;j\u0026lt;=m+i-1;j++) scanf(\u0026#34;%d\u0026#34;,\u0026amp;v[i][j]); } void solve(){ int S = 2*_h(n,m+n-1)+1,T = S+1; // question 1  MCMF::clear(); for(int j = 1;j\u0026lt;=m;j++) MCMF::addedge(S,in(1,j),1,0); for(int i = 1;i\u0026lt;=n;i++){ for(int j = 1;j\u0026lt;=m+i-1;j++){ MCMF::addedge(in(i,j),out(i,j),1,-v[i][j]); if(i == n) MCMF::addedge(out(i,j),T,1,0); else MCMF::addedge(out(i,j),in(i+1,j),1,0), MCMF::addedge(out(i,j),in(i+1,j+1),1,0); } } printf(\u0026#34;%d\\n\u0026#34;,-(MCMF::solve(S,T).second)); // question 2  MCMF::clear(); for(int j = 1;j\u0026lt;=m;j++) MCMF::addedge(S,in(1,j),1,0); for(int i = 1;i\u0026lt;=n;i++){ for(int j = 1;j\u0026lt;=m+i-1;j++){ MCMF::addedge(in(i,j),out(i,j),m,-v[i][j]); if(i == n) MCMF::addedge(out(i,j),T,m,0); else MCMF::addedge(out(i,j),in(i+1,j),1,0), MCMF::addedge(out(i,j),in(i+1,j+1),1,0); } } printf(\u0026#34;%d\\n\u0026#34;,-(MCMF::solve(S,T).second)); // question 3  MCMF::clear(); for(int j = 1;j\u0026lt;=m;j++) MCMF::addedge(S,in(1,j),1,0); for(int i = 1;i\u0026lt;=n;i++){ for(int j = 1;j\u0026lt;=m+i-1;j++){ MCMF::addedge(in(i,j),out(i,j),m,-v[i][j]); if(i == n) MCMF::addedge(out(i,j),T,m,0); else MCMF::addedge(out(i,j),in(i+1,j),m,0), MCMF::addedge(out(i,j),in(i+1,j+1),m,0); } } printf(\u0026#34;%d\\n\u0026#34;,-(MCMF::solve(S,T).second)); } int main(){ init(); solve(); return 0; }   ","description":"","id":23,"section":"posts","tags":["å›¾è®º","ç½‘ç»œæµ","è´¹ç”¨æµ"],"title":"ã€Œç½‘ç»œæµ 24 é¢˜ã€æ•°å­—æ¢¯å½¢-è´¹ç”¨æµ","uri":"https://blog.chenqiqian.com/posts/loj6010/"},{"content":"æŸå…¬å¸å‘ç°å…¶ç ”åˆ¶çš„ä¸€ä¸ªè½¯ä»¶ä¸­æœ‰ $n$ ä¸ªé”™è¯¯ï¼Œéšå³ä¸ºè¯¥è½¯ä»¶å‘æ”¾äº†ä¸€æ‰¹å…± $m$ ä¸ªè¡¥ä¸ç¨‹åºã€‚æ¯ä¸€ä¸ªè¡¥ä¸ç¨‹åºéƒ½æœ‰å…¶ç‰¹å®šçš„é€‚ç”¨ç¯å¢ƒï¼ŒæŸä¸ªè¡¥ä¸åªæœ‰åœ¨è½¯ä»¶ä¸­åŒ…å«æŸäº›é”™è¯¯è€ŒåŒæ—¶åˆä¸åŒ…å«å¦ä¸€äº›é”™è¯¯æ—¶æ‰å¯ä»¥ä½¿ç”¨ã€‚ä¸€ä¸ªè¡¥ä¸åœ¨æ’é™¤æŸäº›é”™è¯¯çš„åŒæ—¶ï¼Œå¾€å¾€ä¼šåŠ å…¥å¦ä¸€äº›é”™è¯¯ã€‚\næ¢å¥è¯è¯´ï¼Œå¯¹äºæ¯ä¸€ä¸ªè¡¥ä¸ $i$ ï¼Œéƒ½æœ‰ $2$ ä¸ªä¸ä¹‹ç›¸åº”çš„é”™è¯¯é›†åˆ $B_1(i)$ å’Œ $B_2(i)$ ï¼Œä½¿å¾—ä»…å½“è½¯ä»¶åŒ…å« $B_1(i)$ ä¸­çš„æ‰€æœ‰é”™è¯¯ï¼Œè€Œä¸åŒ…å« $B_2(i)$ ä¸­çš„ä»»ä½•é”™è¯¯æ—¶ï¼Œæ‰å¯ä»¥ä½¿ç”¨è¡¥ä¸ $i$ ã€‚è¡¥ä¸ $i$ å°†ä¿®å¤è½¯ä»¶ä¸­çš„æŸäº›é”™è¯¯ $F_1(i)$ ï¼Œè€ŒåŒæ—¶åŠ å…¥å¦ä¸€äº›é”™è¯¯ $F_2(i)$ ã€‚å¦å¤–ï¼Œæ¯ä¸ªè¡¥ä¸éƒ½è€—è´¹ä¸€å®šçš„æ—¶é—´ã€‚\nè¯•è®¾è®¡ä¸€ä¸ªç®—æ³•ï¼Œåˆ©ç”¨å…¬å¸æä¾›çš„ $m$ ä¸ªè¡¥ä¸ç¨‹åºå°†åŸè½¯ä»¶ä¿®å¤æˆä¸€ä¸ªæ²¡æœ‰é”™è¯¯çš„è½¯ä»¶ï¼Œå¹¶ä½¿ä¿®å¤åçš„è½¯ä»¶è€—æ—¶æœ€å°‘ã€‚\né“¾æ¥ loj6009\né¢˜è§£ çŠ¶æ€å‹ç¼©ä¹‹åç›´æ¥æŒ‰ç…§çº¦æŸè·‘æœ€çŸ­è·¯å³å¯\u0026hellip;\næ³¨æ„åŒºåˆ† ~ å’Œ ! çš„åŒºåˆ«ã€‚\né¢˜è§£ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54  #include \u0026lt;bits/stdc++.h\u0026gt;#define inf 0x3f3f3f3f using namespace std; const int MAXM = 110,MAXN = (1\u0026lt;\u0026lt;20)+10; int n,m; int T[MAXM],B1[MAXM],B2[MAXM],F1[MAXM],F2[MAXM]; char s[MAXM],t[MAXM]; int dis[MAXN],inq[MAXN]; int spfa(int s,int t){ static queue\u0026lt;int\u0026gt; q; memset(dis,0x3f,sizeof(dis)); dis[s] = 0,q.push(s); while(!q.empty()){ int x = q.front();q.pop();inq[x] = 0; for(int i = 1;i\u0026lt;=m;i++){ if(!((~x) \u0026amp; B1[i]) \u0026amp;\u0026amp; !(x\u0026amp;B2[i])){ int v = (x \u0026amp; (~F1[i])) | (F2[i]); if(dis[v] \u0026gt; dis[x] + T[i]){ dis[v] = dis[x] + T[i]; if(!inq[v]) q.push(v),inq[v] = 1; } } } } return dis[t]; } void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m); for(int i = 1;i\u0026lt;=m;i++){ scanf(\u0026#34;%d %s %s\u0026#34;,\u0026amp;T[i],s,t); for(int j = 0;j\u0026lt;n;j++){ if(s[j] == \u0026#39;+\u0026#39;) B1[i] |= (1\u0026lt;\u0026lt;j); if(s[j] == \u0026#39;-\u0026#39;) B2[i] |= (1\u0026lt;\u0026lt;j); if(t[j] == \u0026#39;-\u0026#39;) F1[i] |= (1\u0026lt;\u0026lt;j); if(t[j] == \u0026#39;+\u0026#39;) F2[i] |= (1\u0026lt;\u0026lt;j); } } } void solve(){ int ans = spfa((1\u0026lt;\u0026lt;n)-1,0); printf(\u0026#34;%d\\n\u0026#34;,ans==inf ? 0 : ans); } int main(){ init(); solve(); return 0; }   ","description":"","id":24,"section":"posts","tags":["å›¾è®º","æœ€çŸ­è·¯"],"title":"ã€Œç½‘ç»œæµ 24 é¢˜ã€è½¯ä»¶è¡¥ä¸-æœ€çŸ­è·¯","uri":"https://blog.chenqiqian.com/posts/loj6009/"},{"content":"ä¸€ä¸ªé¤å…åœ¨ç›¸ç»§çš„ $n$ å¤©é‡Œï¼Œæ¯å¤©éœ€ç”¨çš„é¤å·¾æ•°ä¸å°½ç›¸åŒã€‚å‡è®¾ç¬¬ $i$ å¤©éœ€è¦ $r_i$ å—é¤å·¾ã€‚é¤å…å¯ä»¥è´­ä¹°æ–°çš„é¤å·¾ï¼Œæ¯å—é¤å·¾çš„è´¹ç”¨ä¸º $P$ åˆ†ï¼›æˆ–è€…æŠŠæ—§é¤å·¾é€åˆ°å¿«æ´—éƒ¨ï¼Œæ´—ä¸€å—éœ€ $M$ å¤©ï¼Œå…¶è´¹ç”¨ä¸º $F$ åˆ†ï¼›æˆ–è€…é€åˆ°æ…¢æ´—éƒ¨ï¼Œæ´—ä¸€å—éœ€ $n$ å¤©ï¼Œå…¶è´¹ç”¨ä¸º $S$ åˆ†ï¼ˆ$S \u0026lt; F$ï¼‰ã€‚\næ¯å¤©ç»“æŸæ—¶ï¼Œé¤å…å¿…é¡»å†³å®šå°†å¤šå°‘å—è„çš„é¤å·¾é€åˆ°å¿«æ´—éƒ¨ï¼Œå¤šå°‘å—é¤å·¾é€åˆ°æ…¢æ´—éƒ¨ï¼Œä»¥åŠå¤šå°‘å—ä¿å­˜èµ·æ¥å»¶æœŸé€æ´—ã€‚ä½†æ˜¯æ¯å¤©æ´—å¥½çš„é¤å·¾å’Œè´­ä¹°çš„æ–°é¤å·¾æ•°ä¹‹å’Œï¼Œè¦æ»¡è¶³å½“å¤©çš„éœ€æ±‚é‡ã€‚\nè¯•è®¾è®¡ä¸€ä¸ªç®—æ³•ä¸ºé¤å…åˆç†åœ°å®‰æ’å¥½ $n$ å¤©ä¸­é¤å·¾ä½¿ç”¨è®¡åˆ’,ä½¿æ€»çš„èŠ±è´¹æœ€å°ã€‚\né“¾æ¥ LOJ6008\né¢˜è§£ è¿™é“é¢˜å¯ä»¥ç”¨è´¹ç”¨æµæ¥è§£å†³ã€‚ï¼ˆä¸‹é¢ç”¨ä¸€ä¸ªæœ‰åºåˆ—æ•°å¯¹ $(cap,cost)$ æè¿°ä¸€æ¡è¾¹çš„æµé‡å’Œä»·æ ¼ï¼‰\næˆ‘ä»¬æŠŠæ¯ä¸ªç‚¹æ‹†æˆä¸¤ä¸ªç‚¹ï¼Œ$in(i)$ å’Œ $out(i)$ï¼Œåˆ†åˆ«å¤„ç†å¹²å‡€æ¯›å·¾å’Œè„çš„æ¯›å·¾ã€‚\næˆ‘ä»¬ä»åŸç‚¹å‘æ¯ä¸€ä¸ª $in$ ç‚¹è¿æ¥ä¸€æ¡ $(inf,P)$ çš„è¾¹ï¼Œè¡¨ç¤ºè´­ä¹°çš„å¹²å‡€æ¯›å·¾ã€‚\nä» $S$ å‘æ¯ä¸€ä¸ª $out(i)$ è¿æ¥ä¸€æ¡ $(r_i,0)$ çš„è¾¹ï¼Œè¡¨ç¤ºæ¯å¤©æˆ‘å¯ä»¥æ”¶è·è¿™ä¹ˆå¤šæ¡è„æ¯›å·¾ï¼›ä»æ¯ä¸€ä¸ª $in(i)$ å‘ $T$ è¿æ¥ä¸€æ¡ $(r_i,0)$ çš„è¾¹ï¼Œè¡¨ç¤ºæˆ‘æ¯å¤©å¾—ç”¨æ‰è¿™ä¹ˆå¤šæ¡å¹²å‡€æ¯›å·¾ã€‚ä¸Šé¢çš„è¿è¾¹ä¿è¯æˆ‘ä»¬æ»¡è¶³æ¡ä»¶æ—¶çš„æµæ˜¯æœ€å¤§æµã€‚\nä» $out(i)$ å‘ $out(i+1)$ è¿è¾¹ $(inf,0)$ ï¼Œè¡¨ç¤ºå¯ä»¥æŠŠè„æ¯›å·¾ç•™ç€ä¸æ´—ï¼›ç„¶åå°±æ˜¯å¿«æ´—åº—/æ…¢æ´—åº—ï¼Œä» $out(i)$ å‘ $in(i+M)/in(i+N)$ è¿ä¸€æ¡ $(inf,F/S)$ çš„è¾¹ã€‚\nè´¹ç”¨æµçš„æœ€å°è´¹ç”¨å³ä¸ºç­”æ¡ˆã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81  #include \u0026lt;bits/stdc++.h\u0026gt;// #define int long long #define inf 0x3f3f3f3fLL using namespace std; const int MAXN = 2100,MAXM = MAXN*8*2; namespace MCMF{ int S,T; struct Edge{ int from,to; int cap,flow; int cost,nex; }edge[MAXM*2]; int fir[MAXN],ecnt = 2; void addedge(int a,int b,int c,int d){ edge[ecnt] = (Edge){a,b,c,0, d,fir[a]},fir[a] = ecnt++; edge[ecnt] = (Edge){b,a,0,0,-d,fir[b]},fir[b] = ecnt++; } int dis[MAXN],inq[MAXN]; bool spfa(){ memset(dis,0x3f,sizeof(dis)); static queue\u0026lt;int\u0026gt; q; dis[S] = 0;q.push(S); while(!q.empty()){ int x = q.front();q.pop();inq[x] = 0; for(int e = fir[x];e;e = edge[e].nex){ int v = edge[e].to; if(edge[e].cap \u0026gt; edge[e].flow \u0026amp;\u0026amp; dis[v] \u0026gt; dis[x] + edge[e].cost){ dis[v] = dis[x] + edge[e].cost; if(!inq[v]) q.push(v),inq[v] = 1; } } } return dis[T] \u0026lt; dis[0]; } int dfs(int x,int limit = inf){ if(x == T || limit == 0) return limit; int sumf = 0;inq[x] = 1; for(int e = fir[x];e;e = edge[e].nex){ int v = edge[e].to; if(!inq[v] \u0026amp;\u0026amp; dis[v] == dis[x] + edge[e].cost){ int f = dfs(v,min(limit,edge[e].cap - edge[e].flow)); sumf += f,limit -= f; edge[e].flow += f, edge[e^1].flow -= f; if(limit == 0) break; } } return sumf; } pair\u0026lt;int,int\u0026gt; solve(int s,int t){ S = s,T = t; int ansf = 0,ansc = 0; while(spfa()){ int f = dfs(s); memset(inq,0,sizeof(inq)); ansf += f,ansc += f * dis[t]; } return make_pair(ansf,ansc); } } int n,P,fd,fp,sd,sp; int v[MAXN]; signed main(){ scanf(\u0026#34;%d %d %d %d %d %d\u0026#34;,\u0026amp;n,\u0026amp;P,\u0026amp;fd,\u0026amp;fp,\u0026amp;sd,\u0026amp;sp); for(int i = 1;i\u0026lt;=n;i++) scanf(\u0026#34;%d\u0026#34;,\u0026amp;v[i]); int S = 2*n+1,T = 2*n+2;// 1-\u0026gt; n,n+1-\u0026gt;n+n  for(int i = 1;i\u0026lt;=n;i++){ MCMF::addedge(S,i,inf/2,P); MCMF::addedge(S,i+n,v[i],0); MCMF::addedge(i,T,v[i],0); MCMF::addedge(i+n,i+n+1,inf/2,0); if(i+fd \u0026lt;= n) MCMF::addedge(i+n,i+fd,inf/2,fp); if(i+sd \u0026lt;= n) MCMF::addedge(i+n,i+sd,inf/2,sp); } pair\u0026lt;int,int\u0026gt; ans = MCMF::solve(S,T); printf(\u0026#34;%d\\n\u0026#34;,ans.second); return 0; }   ","description":"","id":25,"section":"posts","tags":["å›¾è®º","ç½‘ç»œæµ","è´¹ç”¨æµ"],"title":"ã€Œç½‘ç»œæµ 24 é¢˜ã€é¤å·¾è®¡åˆ’-è´¹ç”¨æµ","uri":"https://blog.chenqiqian.com/posts/loj6008/"},{"content":"æ˜¨å¤©å›å®¶çš„è·¯ä¸Šï¼Œåœ¨æµ·æ·€é»„åº„è·¯å£çš„è¥¿åŒ—è§’ä¸Šï¼Œæœ‰ä¸€ä½è¡—å¤´æ­Œæ‰‹åœ¨å¼¹å”±ç€å‰ä»–ã€‚\n æˆ‘ç«™åœ¨è·¯è¾¹ç­‰ç€çº¢ç¯ï¼Œç¦»ä»–çš„éŸ³ç®±å¾ˆè¿‘ã€‚ä»¥æˆ‘å¾®è–„çš„éŸ³ä¹é‰´èµèƒ½åŠ›æ¥çœ‹ï¼Œä»–å”±çš„å¤§çº¦æ˜¯é‚£ç§æœ€è¿‘è¢«ç§°ä¸ºâ€œæ°‘è°£â€çš„ç±»å‹ã€‚å£°éŸ³å¾ˆå¤§ï¼Œè®©æˆ‘ä¸å¾—ä¸æ‘˜ä¸‹è€³æœºï¼Œå»å°è¯•å¬ä¸€å¬ä»–çš„å¼¹å”±ã€‚æ­Œè¯æ˜¯ä»€ä¹ˆï¼Œæˆ‘éƒ½å·²ç»å¿˜è®°ã€‚\né‚£å¤©æ™šä¸Šé£å¾ˆå¤§ï¼Œå‘¼å‘¼å•¦å•¦çš„å¹ç€æ§æ ‘çš„å¶å­ã€‚ä»–åªç©¿ç€ä¸€ä¸ªçŸ­è¢–ï¼Œå´ä¸æ¯«çœ‹ä¸å‡ºæ¥ä»–æœ‰æ„Ÿè§‰åˆ°å†·é£çš„å‘¼å•¸ã€‚ä¸€ä¸ªå‰ä»–ç›’å­æ‘†åœ¨ä»–é¢å‰ï¼Œä¸Šé¢å†™ç€å››ä¸ªå­—â€œåŸåˆ›éŸ³ä¹â€ï¼Œè¿˜æœ‰é›¶é›¶æ•£æ•£çš„ä¸€äº›é›¶é’±ã€‚\nä¸€åˆ‡çœ‹èµ·æ¥éƒ½å†æ™®é€šä¸è¿‡äº†ã€‚\nä½†è¿™é‡Œæ˜¯æµ·æ·€é»„åº„ã€‚è¿™é‡Œçš„è¡—å¤´æ°¸è¿œä¸ä¼šç©ºæ—·ï¼Œå³ä½¿åˆ°äº†ä¹ç‚¹å¤šä¹Ÿä»ç„¶äººæµå¦‚ç»‡ã€‚æœ‰åˆšåˆšæ”¾å­¦çš„æ™šè‡ªä¹ çš„å­¦ç”Ÿï¼Œæœ‰æ‰‹ç‰µç€æ‰‹çš„æƒ…ä¾£ä»æ–°ä¸­å…³èµ°å‘åœ°é“ï¼Œæˆ–åªæ˜¯åœ¨æ­¤å¤„ç»è¿‡ã€‚å°½ç®¡å¤œè‰²æ—©å·²è¦†ç›–äº†å¤©ç©¹ï¼Œä»ç„¶æœ‰è¡Œè‰²åŒ†åŒ†çš„äººæ­£åœ¨èµ°å‘å„è‡ªçš„ç›®çš„åœ°ã€‚\nä»–ä»Šå¤©æ™šä¸Šå°†ä¼šæ€ä¹ˆåº¦è¿‡ï¼Ÿä»–æ™šä¸Šä½åœ¨å“ªé‡Œå‘¢ï¼Ÿä»–è¿‡çš„æ˜¯ä»€ä¹ˆæ ·å­çš„ç”Ÿæ´»å‘¢ï¼Ÿæˆ‘ä¸çŸ¥é“ã€‚ä¹Ÿè®¸ä»–æ˜¯ä¸€ä¸ªæœ‰é’±äººæˆ–è€…å®¶å¢ƒæ®·å®ï¼Œåªæ˜¯æƒ³è¦å……å®è‡ªå·±åœ¨è¿™é‡Œå”±æ­Œï¼›ä¹Ÿè®¸ä»–æ˜¯ä¸€ä¸ªè½é­„çš„æ­Œè€…ï¼Œæ¯æ—¥æ²‰è¿·äºéŸ³ä¹ä¹‹ä¸­ï¼Œæ™šä¸Šåˆ°è¿™é‡Œæ¥æŒ£å¾—ç”Ÿå­˜çš„å£ç²®ã€‚\nå¯è¿™äº›åˆä¸æˆ‘ä½•å¹²å‘¢ï¼Ÿ\nå‰ä»–çš„å’Œå¼¦å’Œä½æ²‰çš„äººå£°ç»è¿‡éŸ³å“çš„æ”¾å¤§ç›–ä½äº†æ‰€æœ‰çš„ä¸€åˆ‡ã€‚è¿™æ˜¯æ¯”ç”¨è€³æœºå¬æ­Œæ›´åŠ éœ‡é¢¤äººå¿ƒçš„ï¼šæ˜æ˜æ•´ä¸ªä¸–ç•Œéƒ½åœ¨ä½ èº«æ—ï¼Œä½†æ˜¯å› ä¸ºæœ‰éŸ³ä¹ï¼Œé‚£æ‰€æœ‰çš„ä¸€åˆ‡éƒ½æ˜¯é‚£ä¹ˆçš„ç©ºè™šï¼Œå¯ä»¥çœ‹è§å´æ— æ³•è§¦æ‘¸ã€‚ä»–ä¼¼ä¹ä¹Ÿè·Ÿæˆ‘ä¸€æ ·æ²‰æµ¸åœ¨éŸ³ä¹å½“ä¸­ï¼Œé—­ç€çœ¼ç›ï¼Œèº«ä½“éšç€å³æ‰‹çš„ä¸Šä¸‹èˆåŠ¨è€ŒåŠ¨ã€‚\nå¾ˆå¿«å°±ç»¿ç¯äº†ã€‚æˆ‘èµ°å‘é©¬è·¯å¯¹é¢ï¼Œèº«åå‰ä»–ä¹å£°æ¸æ¸å˜å°ï¼Œæœ€åå˜æˆè½»è½»çš„å‘¢å–ƒã€‚å…¬äº¤è½¦çš„å¼•æ“çš„è½°é¸£ï¼Œå°è½¦çš„è½®èƒåˆ’è¿‡ç©ºæ°”çš„å£°éŸ³ï¼Œä»–ä»¬çº·è‡³æ²“æ¥çš„å‡ºç°ï¼Œæ¶Œå…¥æˆ‘çš„èº«è¾¹ã€‚èº«è¾¹çš„ä¸€åˆ‡äº‹ç‰©ï¼Œè‰æœ¨ã€è½¦è¾†ã€äººç¾¤éƒ½å¦‚ä»æ¥æ²¡æœ‰è¿‡çš„çœŸå®ä¸€èˆ¬ã€‚æŠ¬å¤´æœ›å»ï¼Œç‚¹ç‚¹å¾®å¾®çš„æ˜Ÿå…‰æ— åŠ›çš„åœ¨é—ªçƒéƒ½å¸‚ç¿çƒ‚çš„ç¯å…‰ä¹‹ä¸Šã€‚\næˆ‘çœŸä¸çŸ¥é“ï¼Œæˆ‘æ˜¯ä»è™šå¹»èµ°è¿›çœŸå®ï¼Œè¿˜æ˜¯ä»çœŸå®èµ°è¿›äº†è™šå¹»ã€‚\n ã€Œæˆ‘ä»ç„¶åœ¨ æ— äººé—®æ´¥çš„ é˜´é›¨éœ‰æ¹¿ä¹‹åœ° ã€\nã€Œå’Œç€é›¨éŸ³ å”±ç€æ²¡æœ‰å¬ä¼—çš„æ­Œæ›²ã€\nã€Œäººæ½®ä»æ˜¯ æ¼«æ— ç›®çš„åœ° å‘ç›®çš„åœ°æ•£å»ã€\nã€Œå¿™ç¢Œç€ æ— ä¸ºç€ ç»§ç»­ã€\n","description":"","id":26,"section":"posts","tags":null,"title":"ã€Œéšç¬”ã€æ— é¢˜","uri":"https://blog.chenqiqian.com/posts/esay-no-title/"},{"content":"åœ¨ä¸€ä¸ªæœ‰ $m \\times n$ ä¸ªæ–¹æ ¼çš„æ£‹ç›˜ä¸­ï¼Œæ¯ä¸ªæ–¹æ ¼ä¸­æœ‰ä¸€ä¸ªæ­£æ•´æ•°ã€‚\nç°è¦ä»æ–¹æ ¼ä¸­å–æ•°ï¼Œä½¿ä»»æ„ $2$ ä¸ªæ•°æ‰€åœ¨æ–¹æ ¼æ²¡æœ‰å…¬å…±è¾¹ï¼Œä¸”å–å‡ºçš„æ•°çš„æ€»å’Œæœ€å¤§ã€‚è¯•è®¾è®¡ä¸€ä¸ªæ»¡è¶³è¦æ±‚çš„å–æ•°ç®—æ³•ã€‚\né“¾æ¥ LOJ 6007\né¢˜è§£ å¯ä»¥å‘ç°ï¼Œè¿™æ˜¯ä¸€ä¸ªäºŒåˆ†å›¾çš„å¸¦æƒæœ€å¤§ç‹¬ç«‹é›†çš„é—®é¢˜ã€‚\nå¯¹äºè¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆè§£å†³ï¼š\næˆ‘ä»¬å¯¹äºäºŒåˆ†å›¾çš„ $S$ é›†å’Œ $T$ é›†ï¼ŒåŸç‚¹å‘ $S$ é›†åˆä¸Šè¿è¾¹ï¼Œ $T$ é›†åˆçš„æ‰€æœ‰ç‚¹å‘æ±‡ç‚¹è¿è¾¹ï¼Œè¾¹æµé‡ä¸ºç‚¹æƒï¼›æ‰€æœ‰æœ‰çº¦æŸçš„è¾¹ç›´æ¥è¿è¾¹ï¼Œæƒå€¼ $\\inf$ ï¼›ç­”æ¡ˆå°±æ˜¯è¾¹æƒå’Œå‡å»æœ€å¤§æµçš„æµé‡ã€‚\næ€ä¹ˆè¯æ˜ï¼Ÿå¯ä»¥æ„Ÿæ€§è¯æ˜ã€‚\næ±‚å‡ºæ¥çš„æœ€å°å‰²ä¸€å®šæ˜¯ä¸€ä¸ªåˆæ³•æ–¹æ¡ˆã€‚æˆ‘ä»¬å‰²æ‰äº†å“ªæ¡è¾¹ï¼Œæ„å‘³ç€æˆ‘ä»¬ä»˜å‡ºäº†ä¸€ä¸ªä»£ä»·ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¸é€‰äº†è¿™ä¸ªç‰©å“ã€‚å¦‚æœæˆ‘ä»¬åŒæ—¶é€‰äº†åœ¨äºŒåˆ†å›¾ä¸¤ä¾§æœ‰è¿è¾¹çš„èŠ‚ç‚¹ï¼ˆæ²¡æœ‰å‰²è¾¹ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¿™ä¸ªå›¾å°±ä¸å¯èƒ½è¢«å‰²å¼€ï¼ˆä¸­é—´æ˜¯æ— ç©·å¤§ï¼‰ï¼Œè¿™ä¸ªå›¾å°±ä¸æ˜¯ä¸€ä¸ªåˆæ³•çš„æœ€å°å‰²äº†ã€‚åå‘åº”å½“ä¹Ÿæ˜¯å¯ä»¥è¯æ˜çš„ã€‚\næ‰€ä»¥è¿™ä¸ªç®—æ³•çš„æ­£ç¡®æ€§æ˜¯å¯ä»¥ä¿éšœçš„ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82  #include \u0026lt;bits/stdc++.h\u0026gt;#define inf 0x3f3f3f3f using namespace std; const int MAXN = 10000,MAXM = 50000; struct Edge{ int from,to; int cap,flow; int nex; }edge[MAXM]; int fir[MAXN],ecnt = 2; void addedge(int a,int b,int c){ edge[ecnt] = (Edge){a,b,c,0,fir[a]},fir[a] = ecnt++; edge[ecnt] = (Edge){b,a,0,0,fir[b]},fir[b] = ecnt++; } int dis[MAXN]; bool bfs(int s,int t){ static queue\u0026lt;int\u0026gt; q; memset(dis,0,sizeof(dis));while(!q.empty()) q.pop(); dis[s] = 1;q.push(s); while(!q.empty()){ int x = q.front();q.pop(); for(int e = fir[x];e;e = edge[e].nex){ int v = edge[e].to; if(!dis[v] \u0026amp;\u0026amp; edge[e].cap \u0026gt; edge[e].flow){ dis[v] = dis[x] + 1,q.push(v); } } } return dis[t]; } int dfs(int x,int t,int limit = inf){ if(limit == 0 || x == t) return limit; int sumf = 0; for(int e = fir[x];e;e = edge[e].nex){ int v = edge[e].to; if(dis[v] == dis[x] + 1){ int f = dfs(v,t,min(limit,edge[e].cap - edge[e].flow)); if(f){ sumf += f,limit -= f,edge[e].flow += f,edge[e^1].flow -= f; if(limit == 0) break; } } } return sumf; } int dinic(int s,int t){ int ans = 0; while(bfs(s,t)) ans += dfs(s,t); return ans; } int m,n,val[110][110],sum; int _hash(int x,int y){return (x-1)*n+y;} bool judge(int x,int y){return (x+y)\u0026amp;1;} int main(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;m,\u0026amp;n); for(int i = 1;i\u0026lt;=m;i++) for(int j = 1;j\u0026lt;=n;j++) scanf(\u0026#34;%d\u0026#34;,\u0026amp;val[i][j]),sum += val[i][j]; int S = n*m+1,T = S + 1; for(int i = 1;i\u0026lt;=m;i++){ for(int j = 1;j\u0026lt;=n;j++){ if(judge(i,j)) addedge(S,_hash(i,j),val[i][j]); else addedge(_hash(i,j),T,val[i][j]); if(!judge(i,j)){ if(i \u0026gt; 1) addedge(_hash(i-1,j),_hash(i,j),inf); if(i \u0026lt; m) addedge(_hash(i+1,j),_hash(i,j),inf); if(j \u0026gt; 1) addedge(_hash(i,j-1),_hash(i,j),inf); if(j \u0026lt; n) addedge(_hash(i,j+1),_hash(i,j),inf); } } } printf(\u0026#34;%d\\n\u0026#34;,sum-dinic(S,T)); return 0; }   ","description":"","id":27,"section":"posts","tags":["å›¾è®º","ç½‘ç»œæµ","äºŒåˆ†å›¾"],"title":"ã€Œç½‘ç»œæµ 24 é¢˜ã€æ–¹æ ¼å–æ•°-äºŒåˆ†å›¾æœ€å¤§ç‹¬ç«‹é›†","uri":"https://blog.chenqiqian.com/posts/loj6007/"},{"content":"å‡è®¾ä¸€ä¸ªè¯•é¢˜åº“ä¸­æœ‰ $n$ é“è¯•é¢˜ã€‚æ¯é“è¯•é¢˜éƒ½æ ‡æ˜äº†æ‰€å±ç±»åˆ«ã€‚åŒä¸€é“é¢˜å¯èƒ½æœ‰å¤šä¸ªç±»åˆ«å±æ€§ã€‚ç°è¦ä»é¢˜åº“ä¸­æŠ½å– $m$ é“é¢˜ç»„æˆè¯•å·ã€‚å¹¶è¦æ±‚è¯•å·åŒ…å«æŒ‡å®šç±»å‹çš„è¯•é¢˜ã€‚è¯•è®¾è®¡ä¸€ä¸ªæ»¡è¶³è¦æ±‚çš„ç»„å·ç®—æ³•ã€‚\né“¾æ¥ LOJ 6006\né¢˜è§£ å¯¹æ¯é“é¢˜å»ºä¸€ä¸ªç‚¹ï¼Œå¯¹æ¯ä¸ªç±»å‹å»ºä¸€ä¸ªç‚¹ï¼Œæ¯é“é¢˜å‘å®ƒèƒ½æˆä¸ºçš„ç±»å‹è¿è¾¹ï¼ŒåŸç‚¹å‘é¢˜è¿è¾¹ï¼Œç±»å‹å‘æ±‡ç‚¹è¿è¾¹ï¼Œè·‘æœ€å¤§æµå³å¯ã€‚\næ–¹æ¡ˆå°±çœ‹ä¸€ä¸‹å“ªäº›è¾¹æ˜¯æ»¡æµè¾“å‡ºå³å¯ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88  #include \u0026lt;bits/stdc++.h\u0026gt;#define inf 0x3f3f3f3f using namespace std; const int MAXN = 1100,MAXM = 1100*25*2; struct Edge{ int from,to; int cap,flow; int nex; }edge[MAXM]; int fir[MAXN],ecnt = 2; void addedge(int a,int b,int c){ edge[ecnt] = (Edge){a,b,c,0,fir[a]},fir[a] = ecnt++; edge[ecnt] = (Edge){b,a,0,0,fir[b]},fir[b] = ecnt++; } int dis[MAXN]; bool bfs(int s,int t){ static queue\u0026lt;int\u0026gt; q; memset(dis,0,sizeof(dis));while(!q.empty()) q.pop(); dis[s] = 1,q.push(s); while(!q.empty()){ int x = q.front();q.pop(); for(int e = fir[x];e;e = edge[e].nex){ int v = edge[e].to; if(!dis[v] \u0026amp;\u0026amp; edge[e].cap \u0026gt; edge[e].flow){ dis[v] = dis[x] + 1,q.push(v); } } } return dis[t]; } int dfs(int x,int t,int limit = inf){ if(limit == 0 || x == t) return limit; int sumf = 0; for(int e = fir[x];e;e = edge[e].nex){ int v = edge[e].to; if(dis[v] == dis[x] + 1){ int f = dfs(v,t,min(limit,edge[e].cap - edge[e].flow)); if(f){ sumf += f,limit -= f; edge[e].flow += f,edge[e^1].flow -= f; if(limit == 0) break; } } } return sumf; } int dinic(int s,int t){ int ans = 0; while(bfs(s,t)) ans += dfs(s,t); return ans; } int k,n,m; int main(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;k,\u0026amp;n); int S = k + n + 1,T = S + 1; for(int i = 1;i\u0026lt;=k;i++){ int tmp;scanf(\u0026#34;%d\u0026#34;,\u0026amp;tmp); addedge(S,i,tmp),m += tmp; } for(int i = 1;i\u0026lt;=n;i++){ int p,tmp; scanf(\u0026#34;%d\u0026#34;,\u0026amp;p); addedge(i+k,T,1); for(int x = 1;x \u0026lt;= p;x++){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;tmp); addedge(tmp,i+k,1); } } int ans = dinic(S,T); if(ans != m) printf(\u0026#34;No Solution!\\n\u0026#34;); else{ for(int i = 1;i\u0026lt;=k;i++){ printf(\u0026#34;%d: \u0026#34;,i); for(int e = fir[i];e;e = edge[e].nex){int v = edge[e].to; if(k+1\u0026lt;=v \u0026amp;\u0026amp; v\u0026lt;=k+n \u0026amp;\u0026amp; edge[e].flow == 1) printf(\u0026#34;%d \u0026#34;,v-k); } printf(\u0026#34;\\n\u0026#34;); } } return 0; }   ","description":"","id":28,"section":"posts","tags":["å›¾è®º","ç½‘ç»œæµ"],"title":"ã€Œç½‘ç»œæµ 24 é¢˜ã€è¯•é¢˜åº“-ç½‘ç»œæœ€å¤§æµ","uri":"https://blog.chenqiqian.com/posts/loj6006/"},{"content":"ä¼—æ‰€å‘¨çŸ¥ï¼Œæœ€å°è´¹ç”¨æœ€å¤§æµå‘æ¥æ˜¯ä¸€ä¸ªç®—æ³•å¾ˆå¤šçš„é—®é¢˜ï¼Œä¸‹é¢æ€»ç»“äº†å‡ ä¸ªå¸¸ç”¨çš„æœ€å°è´¹ç”¨æœ€å¤§æµç®—æ³•ã€‚\nå¢å¹¿è·¯ç®—æ³•ï¼ˆEKç®—æ³•ï¼‰ æ¯æ¬¡éƒ½åœ¨åŸå›¾çš„æ®‹ä½™ç½‘ç»œä¸Šè¿›è¡Œä¸€æ¬¡æœ€çŸ­è·¯ï¼ˆ bellmanford ç®—æ³•æˆ–è€… spfa ç®—æ³•ï¼‰æ‰¾å‡ºä¸€æ¡ä»åŸç‚¹åˆ°æ±‡ç‚¹çš„æœ€çŸ­è·¯ï¼Œç„¶åæ±‚å‡ºè¿™æ¡æœ€çŸ­è·¯ä¸Šçš„æœ€å¤§å¯æµæµé‡å¹¶æµæ»¡ï¼Œç›´åˆ°æ‰¾ä¸å‡ºæœ€çŸ­è·¯ä¸ºæ­¢ã€‚\næœ€å¹¿æ³›ä½¿ç”¨çš„è´¹ç”¨æµç®—æ³•ã€‚\nå®Œæ•´ä»£ç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94  #include \u0026lt;bits/stdc++.h\u0026gt;using namespace std; const int inf = 0x3f3f3f3f; const int MAXN = 510,MAXM = 100000; struct Edge{ int from,to; int cap,flow; int cost,nex; }edge[MAXM*2]; int fir[MAXN],ecnt = 2; void addedge(int a,int b,int c,int d){ // printf(\u0026#34;add:%d %d %d %d\\n\u0026#34;,a,b,c,d);  edge[ecnt] = (Edge){a,b,c,0,d,fir[a]}; fir[a] = ecnt++; edge[ecnt] = (Edge){b,a,0,0,-d,fir[b]}; fir[b] = ecnt++; } int dis[MAXN],vis[MAXN],minf[MAXN],pree[MAXN]; queue\u0026lt;int\u0026gt; q; bool spfa(int s,int t){ while(!q.empty()) q.pop(); memset(dis,0x3f,sizeof(dis)); memset(vis,0,sizeof(vis)); q.push(s);dis[s] = 0,minf[s] = inf; while(!q.empty()){ int nown = q.front();q.pop(); vis[nown] = 0; for(int nowe = fir[nown];nowe;nowe = edge[nowe].nex){ Edge \u0026amp; e = edge[nowe]; if(dis[e.to] \u0026gt; dis[nown] + e.cost \u0026amp;\u0026amp; e.cap \u0026gt; e.flow){ dis[e.to] = dis[nown] + e.cost; minf[e.to] = min(minf[nown],e.cap - e.flow); pree[e.to] = nowe; if(vis[e.to] == 0){ q.push(e.to); vis[e.to] = 1; } } } } return dis[t] \u0026lt; inf; } int min_cost_flow(int s,int t,int k = inf){ int ans = 0; while(spfa(s,t) \u0026amp;\u0026amp; k \u0026gt; 0){ if(dis[t] \u0026gt; 0) break; for(int nown = t,nowe = 0;nown != s;nown = edge[nowe].from){ nowe = pree[nown]; edge[nowe].flow += minf[t],edge[nowe^1].flow -= minf[t]; } ans += dis[t] * minf[t]; } return ans; } int n,m,k; char s[MAXN]; char t[MAXN]; bool check(int pos,int len){ if(pos + len - 1 \u0026gt; n) return 0; for(int i = 1;i\u0026lt;=len;i++) if(s[pos + i - 1] != t[i]){ return 0; } return 1; } int main(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n),scanf(\u0026#34;%s\u0026#34;,s+1); int S = 0,T = n+2; scanf(\u0026#34;%d\u0026#34;,\u0026amp;m); for(int i = 1;i\u0026lt;=m;i++){ int p; scanf(\u0026#34;%s %d\u0026#34;,t+1,\u0026amp;p); int len = strlen(t+1); for(int i = 1;i\u0026lt;=n;i++){ if(check(i,len)) addedge(i,i+len,1,-p); } } scanf(\u0026#34;%d\u0026#34;,\u0026amp;k); for(int i = 1;i\u0026lt;=n;i++){ addedge(i,i+1,inf,0); } addedge(S,1,k,0); addedge(n+1,T,k,0); printf(\u0026#34;%d\\n\u0026#34;,-min_cost_flow(S,T)); return 0; }   ï¼ˆCF717Gï¼‰\næ¶ˆåœˆç®—æ³• TBDã€‚\nè¿ç»­æœ€çŸ­è·¯ç®—æ³•ï¼ˆzkwè´¹ç”¨æµï¼‰ TBDã€‚\nåŸå§‹å¯¹å¶ç®—æ³• å®ç°1 æ¯æ¬¡è¿›è¡Œ spfa ï¼Œç„¶ååœ¨æœ€çŸ­è·¯ä¸Šåšdinicå¤šè·¯å¢å¹¿ã€‚\nå®Œæ•´ä»£ç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76  #include \u0026lt;bits/stdc++.h\u0026gt;#define inf 0x3f3f3f3f using namespace std; const int MAXN = 5100,MAXM = 51000; namespace MCMF{ int S,T; struct Edge{ int from,to; int cap,flow; int cost,nex; }edge[MAXM*2]; int fir[MAXN],ecnt = 2; void addedge(int a,int b,int c,int d){ edge[ecnt] = (Edge){a,b,c,0, d,fir[a]},fir[a] = ecnt++; edge[ecnt] = (Edge){b,a,0,0,-d,fir[b]},fir[b] = ecnt++; } int dis[MAXN],inq[MAXN]; bool spfa(){ memset(dis,0x3f,sizeof(dis)); static queue\u0026lt;int\u0026gt; q; dis[S] = 0;q.push(S); while(!q.empty()){ int x = q.front();q.pop();inq[x] = 0; for(int e = fir[x];e;e = edge[e].nex){ int v = edge[e].to; if(edge[e].cap \u0026gt; edge[e].flow \u0026amp;\u0026amp; dis[v] \u0026gt; dis[x] + edge[e].cost){ dis[v] = dis[x] + edge[e].cost; if(!inq[v]) q.push(v),inq[v] = 1; } } } return dis[T] \u0026lt; dis[0]; } int dfs(int x,int limit = inf){ if(x == T || limit == 0) return limit; int sumf = 0;inq[x] = 1; for(int e = fir[x];e;e = edge[e].nex){ int v = edge[e].to; if(!inq[v] \u0026amp;\u0026amp; dis[v] == dis[x] + edge[e].cost){ int f = dfs(v,min(limit,edge[e].cap - edge[e].flow)); sumf += f,limit -= f; edge[e].flow += f, edge[e^1].flow -= f; if(limit == 0) break; } } return sumf; } pair\u0026lt;int,int\u0026gt; solve(int s,int t){ S = s,T = t; int ansf = 0,ansc = 0; while(spfa()){ int f = dfs(s); memset(inq,0,sizeof(inq)); ansf += f,ansc += f * dis[t]; } return make_pair(ansf,ansc); } } int n,m,s,t; int main(){ // scanf(\u0026#34;%d %d %d %d\u0026#34;,\u0026amp;n,\u0026amp;m,\u0026amp;s,\u0026amp;t);  scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m);s = 1,t = n; for(int i = 1;i\u0026lt;=m;i++){ int a,b,c,d; scanf(\u0026#34;%d %d %d %d\u0026#34;,\u0026amp;a,\u0026amp;b,\u0026amp;c,\u0026amp;d); MCMF::addedge(a,b,c,d); } pair\u0026lt;int,int\u0026gt; ans = MCMF::solve(s,t); printf(\u0026#34;%d %d\\n\u0026#34;,ans.first,ans.second); return 0; }   å®ç°2 ç®€å•æ¥è¯´ï¼Œå°±æ˜¯æˆ‘ä»¬å¯ä»¥åœ¨æ®‹é‡ç½‘ç»œä¸Šè¿›è¡Œä¸€æ¬¡æœ€çŸ­è·¯æ“ä½œï¼ˆbellman fordï¼‰ï¼Œç„¶åæ¯æ¬¡å»ç»´æŠ¤ä¸€ä¸ªlabelï¼Œæ¯æ¬¡æ‰©å±•å®Œï¼ˆä½¿ç”¨ dinic ä»…åœ¨ç¬¦åˆæ¡ä»¶çš„é“è·¯ä¸Šæ›´æ”¹ï¼‰æ›´æ–°æœ€çŸ­è·¯labelï¼ˆä½¿ç”¨ dijkstra ç®—æ³•ï¼‰ï¼Œç„¶åä½¿ç”¨ä¸€ä¸ªæ¾å¼›æ“ä½œï¼Œä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4  void reduce(int s,int t){ for(int e = 2;e \u0026lt;= ecnt;e++) E0.cost += dis[E0.to] - dis[E0.from]; delta += dis[s]; }   ç„¶åå°±å¯ä»¥è·‘ dijkstra äº†ã€‚\nå®Œæ•´ä»£ç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114  #include \u0026lt;bits/stdc++.h\u0026gt;#include \u0026lt;bits/extc++.h\u0026gt;#include \u0026lt;unistd.h\u0026gt;#define E0 edge[e] #define E1 edge[e^1] #define inf 0x3f3f3f3f using namespace std; const int MAXN = 410,MAXM = 15010; struct Edge{ int from,to,cap,flow,cost,nex; }edge[MAXM*2]; int fir[MAXN],ecnt = 2; void addedge(int a,int b,int c,int d){ edge[ecnt] = (Edge){a,b,c,0, d,fir[a]},fir[a] = ecnt++; edge[ecnt] = (Edge){b,a,0,0,-d,fir[b]},fir[b] = ecnt++; } struct Node{ int x,d; bool operator \u0026lt; (const Node \u0026amp;_n)const{return d \u0026gt; _n.d;} Node(int _x,int _d):x(_x),d(_d){} }; // #define Node pair\u0026lt;int,int\u0026gt; // typedef __gnu_pbds::priority_queue\u0026lt;Node, less\u0026lt;Node\u0026gt;, __gnu_pbds::pairing_heap_tag\u0026gt; heap; // typedef priority_queue\u0026lt; Node ,vector\u0026lt; Node \u0026gt;,greater\u0026lt;Node\u0026gt;\u0026gt; heap; typedef priority_queue\u0026lt;Node\u0026gt; heap; int n,m; int dis[MAXN],inq[MAXN],vis[MAXN],ansf,ansc,delta; void reduce(int s,int t){ for(int e = 2;e \u0026lt;= ecnt;e++) E0.cost += dis[E0.to] - dis[E0.from]; delta += dis[s]; } bool bellman(int s,int t){// t ä¸ºèµ·ç‚¹  static queue\u0026lt;int\u0026gt; q; memset(dis,0x3f,sizeof(int)*(n+1));while(!q.empty()) q.pop(); dis[t] = 0,q.push(t);inq[t] = 1; while(!q.empty()){ int x = q.front();q.pop();inq[x] = 0; for(int e = fir[x];e;e = edge[e].nex){ int v = E0.to,c = E1.cap,f = E1.flow,l = E1.cost; if(c \u0026gt; f \u0026amp;\u0026amp; dis[v] \u0026gt; dis[x] + l){ dis[v] = dis[x] + l; if(!inq[v]) inq[v] = 1,q.push(v); } } } return dis[s] \u0026lt; inf; } bool dijkstra(int s,int t){ memset(dis,0x3f,sizeof(int)*(n+1)); static heap q; dis[t] = 0;q.push(Node(t,0)); while(!q.empty()){ Node p = q.top();q.pop();int x = p.x; if(p.d != dis[x]) continue; for(int e = fir[x];e;e = edge[e].nex){ int v = E0.to,c = E1.cap,f = E1.flow,l = E1.cost; if(c \u0026gt; f \u0026amp;\u0026amp; dis[v] \u0026gt; dis[x] + l){ dis[v] = dis[x] + l,q.push(Node(v,dis[v])); } } } return dis[s] \u0026lt; inf; } int dfs(int x,int t,int limit = inf){ if(x == t || limit == 0) return limit; vis[x] = 1; // differ from dinic  int sumf = 0; for(int \u0026amp;e = cur[x];e;e = edge[e].nex){ int v = E0.to,c = E0.cap,f = E0.flow,l = E0.cost; if(!vis[v] \u0026amp;\u0026amp; c \u0026gt; f \u0026amp;\u0026amp; l == 0){ int newf = dfs(v,t,min(limit,c-f)); sumf += newf,limit -= newf; E0.flow += newf,E1.flow -= newf; if(limit == 0) break; } } return sumf; } void augment(int s,int t){ int curf = 0; while(memset(vis,0,sizeof(int)*(n+1)),(curf = dfs(s,t))){ ansf += curf,ansc += curf * delta; } } void primaldual(int s,int t){ if(!dijkstra(s,t)) return; ansf = ansc = delta = 0; do{ reduce(s,t),augment(s,t); }while(dijkstra(s,t)); } int main(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m); int S = 1,T = n; for(int i = 1;i\u0026lt;=m;i++){ int a,b,c,d; scanf(\u0026#34;%d %d %d %d\u0026#34;,\u0026amp;a,\u0026amp;b,\u0026amp;c,\u0026amp;d); addedge(a,b,c,d); } primaldual(S,T); printf(\u0026#34;%d %d\\n\u0026#34;,ansf,ansc); return 0; }   ","description":"","id":29,"section":"posts","tags":["å›¾è®º","ç½‘ç»œæµ","è´¹ç”¨æµ","æ¨¡æ¿"],"title":"å¸¸è§æœ€å°è´¹ç”¨æœ€å¤§æµç®—æ³•å­¦ä¹ ç¬”è®°","uri":"https://blog.chenqiqian.com/posts/notes-mfmc/"},{"content":"ç»™å®šæ­£æ•´æ•°åºåˆ— $x_1 \\sim x_n$ ï¼Œä»¥ä¸‹é€’å¢å­åºåˆ—å‡ä¸ºéä¸¥æ ¼é€’å¢ã€‚\n  è®¡ç®—å…¶æœ€é•¿é€’å¢å­åºåˆ—çš„é•¿åº¦ $s$ ã€‚\n  è®¡ç®—ä»ç»™å®šçš„åºåˆ—ä¸­æœ€å¤šå¯å–å‡ºå¤šå°‘ä¸ªé•¿åº¦ä¸º $s$ çš„é€’å¢å­åºåˆ—ã€‚\n  å¦‚æœå…è®¸åœ¨å–å‡ºçš„åºåˆ—ä¸­å¤šæ¬¡ä½¿ç”¨ $x_1$ å’Œ $x_n$ ï¼Œåˆ™ä»ç»™å®šåºåˆ—ä¸­æœ€å¤šå¯å–å‡ºå¤šå°‘ä¸ªé•¿åº¦ä¸º $s$ çš„é€’å¢å­åºåˆ—ã€‚\n  é“¾æ¥ LOJ6005\né¢˜è§£ è¿™ä¸ªé—®é¢˜éœ€è¦ç”¨dpå’Œç½‘ç»œæµæ­é…è§£å†³ã€‚\nç¬¬ä¸€é—®ï¼šç›´æ¥ $O(n^2)$ dp å³å¯ã€‚\nç¬¬äºŒé—®ï¼šåœ¨ç¬¬ä¸€é—®çš„åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬è€ƒè™‘ç½‘ç»œæµã€‚\næˆ‘ä»¬æŠŠæ¯ä¸ªç‚¹æ‹†æˆä¸¤ä¸ªç‚¹ï¼š $(i,0)$ å’Œ $(i,1)$\n $S$ å‘æ‰€æœ‰ $dp[i] = 1$ çš„ $(i,0)$ è¿è¾¹ æ‰€æœ‰ $dp[i] = s$ çš„ç‚¹å‘ T è¿è¾¹ å¯¹äºæ¯ä¸ª $j$ï¼Œå‘æ‰€æœ‰æ»¡è¶³ï¼š $j \u0026lt; i \\le n,x[j] \\le x[i],dp[j] + 1 = dp[i]$ ï¼Œè¿ä¸€æ¡ $(i,1)$ å‘ $(j,0)$ çš„è¾¹ æœ€åæ¯ä¸ª $(i,0)$ å‘ $(i,1)$ è¿è¾¹ã€‚  ç„¶å dinic å¤§æ¦‚å°±å¯ä»¥äº†ã€‚\nç¬¬ä¸‰é—®ï¼šæŠŠå››ä¸ªè¾¹å¢åŠ åˆ°æ­£æ— ç©·ï¼š$(1,0) \\rightarrow (1,1)$ , $(n,0) \\rightarrow (n,1)$ , $S \\rightarrow (1,0)$ , $(n,1) \\rightarrow T$ï¼ˆå¦‚æœæœ‰ï¼‰ ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85  #include \u0026lt;bits/stdc++.h\u0026gt;#define inf 0x3f3f3f3f using namespace std; const int MAXN = 1100,MAXM = MAXN*MAXN; struct Edge{ int from,to; int cap,flow; int nex; }edge[MAXM]; int fir[MAXN],ecnt = 2; void addedge(int a,int b,int c){ edge[ecnt] = (Edge){a,b,c,0,fir[a]};fir[a] = ecnt++; edge[ecnt] = (Edge){b,a,0,0,fir[b]};fir[b] = ecnt++; } int dis[MAXN]; bool bfs(int s,int t){ static queue\u0026lt;int\u0026gt; q; memset(dis,0,sizeof(dis));while(!q.empty()) q.pop(); dis[s] = 1,q.push(s); while(!q.empty()){ int x = q.front();q.pop(); for(int e = fir[x];e;e = edge[e].nex){ int v = edge[e].to; if(!dis[v] \u0026amp;\u0026amp; edge[e].cap \u0026gt; edge[e].flow){ dis[v] = dis[x]+1;q.push(v); } } } return dis[t]; } int dfs(int x,int t,int limit =inf){ if(limit == 0 || x == t) return limit; int sumf = 0; for(int e = fir[x];e;e = edge[e].nex){ int v = edge[e].to; if(dis[v] == dis[x]+1){ int f = dfs(v,t,min(limit,edge[e].cap - edge[e].flow)); if(f){ sumf += f,limit -= f; edge[e].flow += f,edge[e^1].flow -= f; if(limit == 0) break; } } } return sumf; } int dinic(int s,int t){ static int ans = 0; while(bfs(s,t)) ans += dfs(s,t); return ans; } int n; int x[MAXN],dp[MAXN]; void init(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n); for(int i = 1;i\u0026lt;=n;i++) scanf(\u0026#34;%d\u0026#34;,\u0026amp;x[i]); } void solve(){ int ans = 0,S = n+1,T = 2*n+3;// 0 -\u0026gt; n \u0026amp;\u0026amp; n+1 -\u0026gt; 2*n+1  for(int i = 1;i\u0026lt;=n;i++) addedge(i,i+n+1,1); for(int i = 1;i\u0026lt;=n;i++){ for(int j = 0;j\u0026lt;i;j++)if(x[j] \u0026lt;= x[i]) dp[i] = max(dp[i],dp[j]+1); for(int j = 0;j\u0026lt;i;j++)if(x[j] \u0026lt;= x[i] \u0026amp;\u0026amp; dp[j] + 1 == dp[i]) addedge(j+n+1,i,1); ans = max(ans,dp[i]); } for(int i = 1;i\u0026lt;=n;i++) if(dp[i] == ans) addedge(i+n+1,T,1); printf(\u0026#34;%d\\n\u0026#34;,ans); printf(\u0026#34;%d\\n\u0026#34;,dinic(S,T)); addedge(1,1+n+1,n*n-1),addedge(n,n+n+1,n*n-1); addedge(S,1,n*n-1); if(dp[n] == ans) addedge(n+n+1,T,n*n-1); printf(\u0026#34;%d\\n\u0026#34;,dinic(S,T)); } int main(){ init(),solve(); return 0; }   ","description":"","id":30,"section":"posts","tags":["å›¾è®º","ç½‘ç»œæµ","åŠ¨æ€è§„åˆ’"],"title":"ã€Œç½‘ç»œæµ 24 é¢˜ã€æœ€é•¿é€’å¢å­åºåˆ—-dp+ç½‘ç»œæœ€å¤§æµ","uri":"https://blog.chenqiqian.com/posts/loj6005/"},{"content":"å‡è®¾æœ‰æ¥è‡ª $m$ ä¸ªä¸åŒå•ä½çš„ä»£è¡¨å‚åŠ ä¸€æ¬¡å›½é™…ä¼šè®®ã€‚æ¯ä¸ªå•ä½çš„ä»£è¡¨æ•°åˆ†åˆ«ä¸º $r_i$ ã€‚ä¼šè®®é¤å…å…±æœ‰ $n$ å¼ é¤æ¡Œï¼Œæ¯å¼ é¤æ¡Œå¯å®¹çº³ $c_i$ ä¸ªä»£è¡¨å°±é¤ã€‚\nä¸ºäº†ä½¿ä»£è¡¨ä»¬å……åˆ†äº¤æµï¼Œå¸Œæœ›ä»åŒä¸€ä¸ªå•ä½æ¥çš„ä»£è¡¨ä¸åœ¨åŒä¸€ä¸ªé¤æ¡Œå°±é¤ã€‚\nè¯•è®¾è®¡ä¸€ä¸ªç®—æ³•ï¼Œç»™å‡ºæ»¡è¶³è¦æ±‚çš„ä»£è¡¨å°±é¤æ–¹æ¡ˆã€‚\né“¾æ¥ LOJ6004\né¢˜è§£ æˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ªé¢˜è½¬åŒ–æˆç½‘ç»œæœ€å¤§æµè§£å†³ã€‚\næ¯ä¸ªå•ä½ä¸€ä¸ªç‚¹ $1$ ï½ $m$ ï¼Œæ¯ä¸ªé¤æ¡Œä¸€ä¸ªç‚¹ $m+1$ ï½ $m+n$ ï¼Œæºç‚¹å‘å•ä½è¿è¾¹ï¼Œé¤æ¡Œå‘æ±‡ç‚¹è¿è¾¹ï¼Œåˆ†åˆ«æ˜¯å¯¹åº”å®¹é‡ï¼›æ¯ä¸ªå•ä½å‘æ¯ä¸ªé¤æ¡Œè¿è¾¹ï¼Œå®¹é‡ä¸º $1$ ã€‚ å¦‚æœæœ€å¤§æµç­‰äºäººæ•°ï¼Œå°±æœ‰è§£ï¼Œå¦åˆ™æ— è§£ã€‚\nè¾“å‡ºæ–¹æ¡ˆæˆ‘ä»¬è€ƒè™‘å¯¹æ¯ä¸ªå•ä½çš„ç‚¹ï¼Œéå†å‡ºè¾¹ï¼Œæ‰¾å‡ºè¿å‘é¤æ¡Œçš„æœ‰æµé‡çš„è¾¹çš„å¦ä¸€æ®µï¼Œå¯¹åº”é¤æ¡Œçš„å°±æ˜¯å•ä½çš„æ¯ä¸ªäººå»çš„é¤æ¡Œã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92  #include \u0026lt;bits/stdc++.h\u0026gt;#define inf 0x3f3f3f3f using namespace std; const int MAXN = 500,MAXM = MAXN*MAXN*2; struct Edge{ int from,to; int cap,flow; int nex; }edge[MAXM]; int fir[MAXN],ecnt = 2; void addedge(int a,int b,int c){ edge[ecnt] = (Edge){a,b,c,0,fir[a]},fir[a] = ecnt++; edge[ecnt] = (Edge){b,a,0,0,fir[b]},fir[b] = ecnt++; } int dis[MAXN]; bool bfs(int s,int t){ static queue\u0026lt;int\u0026gt; q; memset(dis,0,sizeof(dis));while(!q.empty()) q.pop(); dis[s] = 1,q.push(s); while(!q.empty()){ int x = q.front();q.pop(); for(int e = fir[x];e;e = edge[e].nex){ int v = edge[e].to; if(!dis[v] \u0026amp;\u0026amp; edge[e].cap \u0026gt; edge[e].flow){ dis[v] = dis[x]+1;q.push(v); } } } return dis[t]; } int dfs(int x,int t,int limit = inf){ if(limit == 0 || x == t) return limit; int sumf = 0; for(int e = fir[x];e;e = edge[e].nex){ int v = edge[e].to; if(dis[v] == dis[x] + 1){ int f = dfs(v,t,min(limit,edge[e].cap - edge[e].flow)); if(f){ sumf += f,limit -= f; edge[e].flow += f,edge[e^1].flow -= f; } if(limit == 0) break; } } return sumf; } int dinic(int s,int t){ int ans = 0; while(bfs(s,t)) ans += dfs(s,t); return ans; } int n,m; int sa[MAXN],sb[MAXN]; vector\u0026lt;int\u0026gt; ANS[MAXN]; void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;m,\u0026amp;n); for(int i = 1;i\u0026lt;=m;i++) scanf(\u0026#34;%d\u0026#34;,\u0026amp;sb[i]); for(int i = 1;i\u0026lt;=n;i++) scanf(\u0026#34;%d\u0026#34;,\u0026amp;sa[i]); } void solve(){ int S = n+m+1,T = S+1,sum = 0; for(int i = 1;i\u0026lt;=m;i++) addedge(S,i,sb[i]),sum += sb[i]; for(int i = 1;i\u0026lt;=n;i++) addedge(m+i,T,sa[i]); for(int i = 1;i\u0026lt;=m;i++){ for(int j = 1;j\u0026lt;=n;j++){ addedge(i,m+j,1); } } int ans = dinic(S,T); if(ans != sum) return (printf(\u0026#34;0\\n\u0026#34;),void(0)); printf(\u0026#34;1\\n\u0026#34;); for(int x = 1;x\u0026lt;=m;x++){ for(int e = fir[x];e;e = edge[e].nex){ int v = edge[e].to; if(edge[e].flow == 1) printf(\u0026#34;%d \u0026#34;,v-m); } printf(\u0026#34;\\n\u0026#34;); } } int main(){ init(); solve(); }   ","description":"","id":31,"section":"posts","tags":["å›¾è®º","ç½‘ç»œæµ"],"title":"ã€Œç½‘ç»œæµ 24 é¢˜ã€åœ†æ¡Œèšé¤-ç½‘ç»œæœ€å¤§æµ","uri":"https://blog.chenqiqian.com/posts/loj6004/"},{"content":"å‡è®¾æœ‰ $n$ æ ¹æŸ±å­ï¼Œç°è¦æŒ‰ä¸‹è¿°è§„åˆ™åœ¨è¿™ $n$ æ ¹æŸ±å­ä¸­ä¾æ¬¡æ”¾å…¥ç¼–å·ä¸º $1, 2, 3, 4, \\cdots$ çš„çƒã€‚\n æ¯æ¬¡åªèƒ½åœ¨æŸæ ¹æŸ±å­çš„æœ€ä¸Šé¢æ”¾çƒã€‚ åœ¨åŒä¸€æ ¹æŸ±å­ä¸­ï¼Œä»»ä½• $2$ ä¸ªç›¸é‚»çƒçš„ç¼–å·ä¹‹å’Œä¸ºå®Œå…¨å¹³æ–¹æ•°ã€‚  è¯•è®¾è®¡ä¸€ä¸ªç®—æ³•ï¼Œè®¡ç®—å‡ºåœ¨ $n$ æ ¹æŸ±å­ä¸Šæœ€å¤šèƒ½æ”¾å¤šå°‘ä¸ªçƒã€‚\né“¾æ¥ LOJ6003\né¢˜è§£ å…¶å®è¿™ä¸ªæœ¬è´¨ä¸Šç±»ä¼¼ä¸€ä¸ªé“¾è¦†ç›–çš„é—®é¢˜ã€‚\næˆ‘ä»¬æ¯æ¬¡è€ƒè™‘åŠ å…¥ä¸€ä¸ªçƒï¼Œç„¶ååœ¨äºŒåˆ†å›¾ä¸Šè¿ä¸Šå¯è¡Œçš„è¾¹ï¼ˆ $i+j$ æ˜¯å¹³æ–¹æ•°è€Œä¸” $i \u0026lt; j$ï¼‰ï¼Œæ¯æ¬¡ç›´æ¥æ¥ç€è·‘ dinic ï¼Œç›´åˆ°ä¸æ»¡è¶³å³å¯ã€‚\nè¾“å‡ºæ–¹æ¡ˆå°±æ˜¯æšä¸¾è¾¹ï¼Œæ‰¾é“¾èµ·ç‚¹ã€‚åŒä¸Šä¸€é“é¢˜ã€‚\nå…¶å®åº”è¯¥äºŒåˆ†ï¼Œå¤æ‚åº¦æ›´å¥½ä¿è¯ï¼Œä¸è¿‡è¿™ä¸ªæ¯”è¾ƒå¥½å†™ï¼ˆ\nè¿™é¢˜ä¹Ÿå¯ä»¥è´ªå¿ƒï¼Œæ‡’å¾—å†™äº†ï¼Œé¢˜è§£ç²˜è´´è¿‡æ¥ï¼š\n è´ªå¿ƒå°±æ˜¯ä»å°åˆ°å¤§æšä¸¾ç¼–å·ï¼Œä¹‹ååœ¨å·²ç»æœ‰çƒçš„æŸ±å­é‡Œéšä¾¿æ‰¾ä¸€ä¸ªèƒ½æ”¾çš„æ”¾ã€‚å¦‚æœæ‰¾ä¸åˆ°ï¼Œå°±æ–°å¼€ä¸€ä¸ªæŸ±å­ã€‚\nä½†å®ƒæ˜¯æ­£ç¡®çš„å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ\n  å¯ä»¥è¯æ˜ã€‚ç”¨æ•°å­¦å½’çº³æ³•è¯æ˜è´ªå¿ƒæ³•æ¯æ¬¡çš„é€‰æ‹©æ˜¯å”¯ä¸€çš„(å³ï¼Œåªèƒ½æŠŠçƒæ”¾åˆ°0æˆ–1ä¸ªå·²ç»æ”¾äº†çƒçš„æŸ±å­ä¸Š)ï¼Œä¸”ç­”æ¡ˆä¸º(ä¸€ä¸ªç®€å•å¼å­ï¼Œæš‚ä¸å‰§é€)ã€‚ç”¨dilworthå®šç†å¯ä»¥è¯æ˜è¿™ä¸ªæ˜¯æœ€ä¼˜çš„(hint:æŸ±å­çš„é¡¶ç«¯æ„æˆä¸€ä¸ªåé“¾)ã€‚\nè¿™ä¸ªç®—æ³•workæ˜¯å› ä¸ºâ€œåŠ èµ·æ¥æ˜¯å¹³æ–¹æ•°â€çš„æ€§è´¨å¾ˆå¥½ã€‚æ”¹æˆå…¶ä»–æ¡ä»¶å°±åšä¸äº†äº†ã€‚\n é“¾æ¥ ï¼š UOJ BLOG\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106  #include \u0026lt;bits/stdc++.h\u0026gt;#include \u0026lt;unistd.h\u0026gt;#define inf 0x3f3f3f3f using namespace std; const int MAXN = 3200,MAXM = MAXN*100,N = MAXN/2; struct Edge{ int from,to; int cap,flow; int nex; }edge[MAXM]; int fir[MAXN],ecnt = 2; void addedge(int a,int b,int c){ edge[ecnt] = (Edge){a,b,c,0,fir[a]};fir[a] = ecnt++; edge[ecnt] = (Edge){b,a,0,0,fir[b]};fir[b] = ecnt++; } int dis[MAXN]; bool bfs(int s,int t){ static queue\u0026lt;int\u0026gt; q; memset(dis,0,sizeof(dis));while(!q.empty()) q.pop(); dis[s] = 1;q.push(s); while(!q.empty()){ int x = q.front();q.pop(); for(int e = fir[x];e;e = edge[e].nex){ int v = edge[e].to; if(!dis[v] \u0026amp;\u0026amp; edge[e].cap \u0026gt; edge[e].flow){ dis[v] = dis[x] + 1;q.push(v); } } } return dis[t]; } int dfs(int x,int t,int limit = inf){ if(limit == 0 || x == t) return limit; int sumf = 0; for(int e = fir[x];e;e = edge[e].nex){ int v = edge[e].to; if(dis[v] == dis[x] + 1){ int f = dfs(v,t,min(limit,edge[e].cap - edge[e].flow)); if(f){ sumf += f,limit -= f; edge[e].flow += f,edge[e^1].flow -= f; } if(limit == 0) break; } } return sumf; } int dinic(int s,int t){ static int ans = 0; while(bfs(s,t)) ans += dfs(s,t); return ans; } int n,is_squ[MAXN]; void init(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n);for(int i = 1;i*i \u0026lt; MAXN;i++) is_squ[i*i] = 1; } int solve(){ int S = MAXN-1,T = MAXN-2; for(int i = 1;i\u0026lt;=MAXN;i++){ addedge(S,i,1),addedge(i+N,T,1); for(int j = 1;j\u0026lt;i;j++){ if(is_squ[i+j]) addedge(j,i+N,1); } int ans = i - dinic(S,T); if(ans \u0026gt; n) return i-1; } } void output(int x){ int S = MAXN-1,T = MAXN-2; memset(fir,0,sizeof(fir)),ecnt = 2; for(int i = 1;i\u0026lt;=x;i++){ addedge(S,i,1),addedge(i+N,T,1); for(int j = i+1;j\u0026lt;=x;j++){ if(is_squ[i+j]) addedge(i,j+N,1); } } dinic(S,T); static int pre[MAXN],nxt[MAXN]; for(int e = 2;e\u0026lt;=ecnt;e+=2){ int a = edge[e].from,b = edge[e].to,f = edge[e].flow; if(f == 1 \u0026amp;\u0026amp; 1 \u0026lt;= a \u0026amp;\u0026amp; a \u0026lt;= x \u0026amp;\u0026amp; N+1 \u0026lt;= b \u0026amp;\u0026amp; b \u0026lt;= MAXN+x){ pre[b-N] = a,nxt[a] = b-N; } } printf(\u0026#34;%d\\n\u0026#34;,x); for(int i = 1;i\u0026lt;=x;i++){ if(pre[i] == 0){ for(int t = i;t;t = nxt[t]) printf(\u0026#34;%d \u0026#34;,t); printf(\u0026#34;\\n\u0026#34;); } } } int main(){ init(),output(solve()); return 0; }   ","description":"","id":32,"section":"posts","tags":["å›¾è®º","ç½‘ç»œæµ","äºŒåˆ†å›¾"],"title":"ã€Œç½‘ç»œæµ 24 é¢˜ã€é­”æœ¯çƒ-äºŒåˆ†å›¾æœ€å¤§åŒ¹é…","uri":"https://blog.chenqiqian.com/posts/loj6003/"},{"content":"ç»™å®šæœ‰å‘å›¾ $G = (V, E)$ã€‚è®¾ $P$ æ˜¯ $G$ çš„ä¸€ä¸ªç®€å•è·¯ï¼ˆé¡¶ç‚¹ä¸ç›¸äº¤ï¼‰çš„é›†åˆã€‚å¦‚æœ $V$ ä¸­æ¯ä¸ªé¡¶ç‚¹æ°å¥½åœ¨ $P$ çš„ä¸€æ¡è·¯ä¸Šï¼Œåˆ™ç§° $P$ æ˜¯ $G$ çš„ä¸€ä¸ªè·¯å¾„è¦†ç›–ã€‚ $P$ ä¸­è·¯å¾„å¯ä»¥ä» $V$ çš„ä»»ä½•ä¸€ä¸ªé¡¶ç‚¹å¼€å§‹ï¼Œé•¿åº¦ä¹Ÿæ˜¯ä»»æ„çš„ï¼Œç‰¹åˆ«åœ°ï¼Œå¯ä»¥ä¸º $0$ ã€‚ $G$ çš„æœ€å°è·¯å¾„è¦†ç›–æ˜¯ $G$ çš„æ‰€å«è·¯å¾„æ¡æ•°æœ€å°‘çš„è·¯å¾„è¦†ç›–ã€‚\nè®¾è®¡ä¸€ä¸ªæœ‰æ•ˆç®—æ³•æ±‚ä¸€ä¸ªæœ‰å‘æ— ç¯å›¾ $G$ çš„æœ€å°è·¯å¾„è¦†ç›–ã€‚\né“¾æ¥ LOJ6002\né¢˜è§£ è¿™ä¸ªé¢˜å¯ä»¥è½¬åŒ–æˆäºŒåˆ†å›¾åŒ¹é…æ¥åšã€‚\nå› ä¸ºé¡¶ç‚¹ä¸ç›¸äº¤ï¼Œæ‰€ä»¥æ¯ä¸ªé¡¶ç‚¹è‡³å¤šæœ‰ä¸€ä¸ªå…¥åº¦ \u0026amp; å‡ºåº¦ï¼Œæ‰€ä»¥å¦‚æœä¸¤ä¸ªè¾¹èƒ½æ¥ä¸Šï¼Œæˆ‘ä»¬çš„ç­”æ¡ˆå°±å¯ä»¥å‡æ‰ä¸€ä¸ª 1 ã€‚\nä»€ä¹ˆæƒ…å†µä¸‹ç­”æ¡ˆå¯ä»¥å‡æ‰ 1 ï¼Ÿå°±æ˜¯æˆ‘ä»¬èƒ½é€šè¿‡ä¸€æ¡è¾¹è¿èµ·æ¥ä¸¤ä¸ªç‚¹çš„æ—¶å€™ã€‚ç„¶åæ”¾åˆ°åŸæ¥çš„å›¾ä¸Šï¼Œè¿èµ·æ¥è‡ªç„¶å°±æ˜¯ç­”æ¡ˆã€‚é‚£ä¹ˆè¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ„å»ºä¸€ä¸ªäºŒåˆ†å›¾ï¼ŒæŠŠæ¯ä¸ªç‚¹æ‹†æˆä¸¤ä¸ªï¼ŒåŸå›¾ä¸Šçš„è¾¹ä»å·¦ä¾§å‡ºï¼Œå³ä¾§å…¥å³å¯ã€‚\nè¾“å‡ºæ–¹æ¡ˆçš„è¯ï¼Œå°±éå†æ¯æ¡è¾¹ï¼ˆå°±æ˜¯äºŒåˆ†å›¾é‡Œé¢æ»¡æµçš„è¾¹ï¼‰ï¼Œè®°å½•ä¸€ä¸‹æ¯ä¸ªç‚¹çš„å¾€åèµ°å’Œå¾€å‰èµ°çš„èŠ‚ç‚¹æ˜¯ä»€ä¹ˆï¼Œç„¶åæ‰¾åˆ°æ‰€æœ‰é“¾å¤´ä¸€è·¯å¾€åè·³å°±å¯ä»¥äº†ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98  #include \u0026lt;bits/stdc++.h\u0026gt;#define inf 0x3f3f3f3f using namespace std; const int MAXN = 410,MAXM = MAXN*MAXN*2; struct Edge{ int from,to; int cap,flow; int nex; }edge[MAXM]; int fir[MAXN],ecnt = 2; void addedge(int a,int b,int c){ edge[ecnt] = (Edge){a,b,c,0,fir[a]};fir[a] = ecnt++; edge[ecnt] = (Edge){b,a,0,0,fir[b]};fir[b] = ecnt++; } int dis[MAXN]; bool bfs(int s,int t){ static queue\u0026lt;int\u0026gt; q; memset(dis,0,sizeof(dis));while(!q.empty()) q.pop(); dis[s] = 1;q.push(s); while(!q.empty()){ int x = q.front();q.pop(); for(int e = fir[x];e;e = edge[e].nex){ int v = edge[e].to; if(!dis[v] \u0026amp;\u0026amp; edge[e].cap \u0026gt; edge[e].flow){ dis[v] = dis[x] + 1,q.push(v); } } } return dis[t]; } int dfs(int x,int t,int limit = inf){ if(limit == 0 || x == t) return limit; int sumf = 0; for(int e = fir[x];e;e = edge[e].nex){ int v = edge[e].to; if(dis[v] == dis[x] + 1){ int f = dfs(v,t,min(limit,edge[e].cap - edge[e].flow)); if(f){ sumf += f,limit -= f; edge[e].flow += f,edge[e^1].flow -= f; } if(limit == 0) break; } } return sumf; } int dinic(int s,int t){ int ans = 0; while(bfs(s,t)) ans += dfs(s,t); return ans; } int n,m,S,T; int pre[MAXN],nxt[MAXN]; void print_chain(){ for(int x = 1;x\u0026lt;=n;x++){ for(int e = fir[x];e;e = edge[e].nex){ int v = edge[e].to; if(!(n \u0026lt;= v \u0026amp;\u0026amp; v \u0026lt;= 2*n)) continue; if(edge[e].flow == 1){ pre[v-n] = x,nxt[x] = v-n; } } } for(int x = 1;x\u0026lt;=n;x++){ if(pre[x] == 0){// é“¾å­å¤´  for(int t = x;t;t = nxt[t]) printf(\u0026#34;%d \u0026#34;,t); printf(\u0026#34;\\n\u0026#34;); } } } void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m);S = 2*n+1,T = S + 1; for(int i = 1;i\u0026lt;=m;i++){ int a,b; scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;a,\u0026amp;b); addedge(a,b+n,1); } for(int i = 1;i\u0026lt;=n;i++) addedge(S,i,1),addedge(i+n,T,1); } void solve(){ int ans = n - dinic(S,T); print_chain(); printf(\u0026#34;%d\\n\u0026#34;,ans); } int main(){ init(),solve(); return 0; }   ","description":"","id":33,"section":"posts","tags":["å›¾è®º","ç½‘ç»œæµ","äºŒåˆ†å›¾"],"title":"ã€Œç½‘ç»œæµ 24 é¢˜ã€æœ€å°è·¯å¾„è¦†ç›–-äºŒåˆ†å›¾æœ€å¤§åŒ¹é…","uri":"https://blog.chenqiqian.com/posts/loj6002/"},{"content":"W æ•™æˆæ­£åœ¨ä¸ºå›½å®¶èˆªå¤©ä¸­å¿ƒè®¡åˆ’ä¸€ç³»åˆ—çš„å¤ªç©ºé£è¡Œã€‚æ¯æ¬¡å¤ªç©ºé£è¡Œå¯è¿›è¡Œä¸€ç³»åˆ—å•†ä¸šæ€§å®éªŒè€Œè·å–åˆ©æ¶¦ã€‚ç°å·²ç¡®å®šäº†ä¸€ä¸ªå¯ä¾›é€‰æ‹©çš„å®éªŒé›†åˆ $E = { E_1, E_2, \\cdots, E_m }$ ï¼Œå’Œè¿›è¡Œè¿™äº›å®éªŒéœ€è¦ä½¿ç”¨çš„å…¨éƒ¨ä»ªå™¨çš„é›†åˆ $I = { I_1, I_2, \\cdots, I_n }$ ã€‚å®éªŒ $E_j$ éœ€è¦ç”¨åˆ°çš„ä»ªå™¨æ˜¯ $I$ çš„å­é›† $R_j \\subseteq I$ ã€‚é…ç½®ä»ªå™¨ $I_k$ çš„è´¹ç”¨ä¸º $c_k$ ç¾å…ƒã€‚å®éªŒ $E_j$ çš„èµåŠ©å•†å·²åŒæ„ä¸ºè¯¥å®éªŒç»“æœæ”¯ä»˜ $p_j$ ç¾å…ƒã€‚W æ•™æˆçš„ä»»åŠ¡æ˜¯æ‰¾å‡ºä¸€ä¸ªæœ‰æ•ˆç®—æ³•ï¼Œç¡®å®šåœ¨ä¸€æ¬¡å¤ªç©ºé£è¡Œä¸­è¦è¿›è¡Œå“ªäº›å®éªŒå¹¶å› æ­¤è€Œé…ç½®å“ªäº›ä»ªå™¨æ‰èƒ½ä½¿å¤ªç©ºé£è¡Œçš„å‡€æ”¶ç›Šæœ€å¤§ã€‚è¿™é‡Œå‡€æ”¶ç›Šæ˜¯æŒ‡è¿›è¡Œå®éªŒæ‰€è·å¾—çš„å…¨éƒ¨æ”¶å…¥ä¸é…ç½®ä»ªå™¨çš„å…¨éƒ¨è´¹ç”¨çš„å·®é¢ã€‚\nå¯¹äºç»™å®šçš„å®éªŒå’Œä»ªå™¨é…ç½®æƒ…å†µï¼Œç¼–ç¨‹æ‰¾å‡ºå‡€æ”¶ç›Šæœ€å¤§çš„è¯•éªŒè®¡åˆ’ã€‚\né“¾æ¥ LOJ6001\né¢˜è§£ è¿™ç§é—®é¢˜äº‹å®ä¸Šæ˜¯ä¸€ä¸ªæœ€å¤§æƒé—­åˆå­å›¾çš„é—®é¢˜ã€‚\næˆ‘ä»¬æŠŠä¸€ä¸ªå®éªŒæŠ½è±¡æˆä¸€ä¸ªç‚¹ï¼ˆç¼–å· $1$ - $m$ ï¼‰ï¼Œä¸€ä¸ªä»ªå™¨ä¹ŸæŠ½è±¡æˆä¸€ä¸ªç‚¹ï¼ˆç¼–å· $m+1$ - $m+n$ï¼‰ï¼Œå†ä»æ¯ä¸ªå®éªŒå¾€å…¶éœ€è¦çš„å™¨æè¿ä¸€æ¡æœ‰å‘è¾¹ã€‚\nè¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦æ±‚å‡ºçš„æ˜¯ä¸€ä¸ªæœ€å¤§æƒçš„é—­åˆå­å›¾ï¼ŒèŠ‚ç‚¹çš„æƒå€¼å¯æ­£å¯è´Ÿï¼ˆå®éªŒæ­£ï¼Œä»ªå™¨è´Ÿï¼‰ã€‚\nè¿™ä¸ªæ—¶å€™æˆ‘ä»¬æ€ä¹ˆåšå‘¢ï¼Ÿæˆ‘ä»¬æŠŠ $S$ å‘æ‰€æœ‰æ­£æƒå€¼çš„ç‚¹è¿æƒå€¼å®¹é‡çš„è¾¹ï¼Œæ‰€æœ‰åŸå›¾ä¸­çš„è¾¹éƒ½è¿$\\inf$ ï¼Œæ‰€æœ‰è´Ÿæƒå€¼çš„ç‚¹éƒ½å‘ $T$ è¿ä¸€ä¸ªæƒå€¼çš„ç»å¯¹å€¼å®¹é‡çš„è¾¹ã€‚\nè¿™ä¸ªæ—¶å€™æ‰€æœ‰æ­£æƒå€¼çš„å’Œå‡å» $S$ å’Œ $T$ çš„æœ€å°å‰²å°±æ˜¯ç­”æ¡ˆã€‚å¦‚ä½•è¯æ˜ï¼Ÿæˆ‘ä»¬è€ƒè™‘æ¯æ¬¡å‰²éƒ½æ˜¯ä¸€ä¸ªä»£ä»·ï¼Œä¹Ÿå°±æ˜¯é€‰äº†è´Ÿæƒå’Œä¸é€‰æ­£æƒï¼Œéƒ½ä¼šå¸¦æ¥ä¸€ä¸ªä»£ä»·ï¼Œç„¶åæˆ‘ä»¬æƒ³è®©è¿™ä¸ªä»£ä»·æœ€å°ï¼Œæ‰€ä»¥å°±æ˜¯æœ€å°å‰²ã€‚\nè¿™ä¸ªæ—¶å€™å¯ä»¥å‘ç°ï¼Œå’Œ $S$ è”é€šï¼ˆèƒ½å¤Ÿé€šè¿‡éæ»¡æµè¾¹åˆ°è¾¾ï¼‰çš„éƒ½æ˜¯è¦é€‰çš„å®éªŒå’Œä»ªå™¨ï¼Œ dfs ä¸€æ¬¡å³å¯å®Œæˆã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112  #include \u0026lt;bits/stdc++.h\u0026gt;#define inf 0x3f3f3f3f using namespace std; const int MAXN = 110,MAXM = MAXN*MAXN; struct Edge{ int from,to; int cap,flow; int nex; }edge[MAXM]; int fir[MAXN],ecnt = 2; void addedge(int a,int b,int c){ edge[ecnt] = (Edge){a,b,c,0,fir[a]};fir[a] = ecnt++; edge[ecnt] = (Edge){b,a,0,0,fir[b]};fir[b] = ecnt++; } int n,m, dis[MAXN]; bool bfs(int s,int t){ static queue\u0026lt;int\u0026gt; q; memset(dis,0,sizeof(dis));while(!q.empty()) q.pop(); dis[s] = 1;q.push(s); while(!q.empty()){ int x = q.front();q.pop(); for(int e = fir[x];e;e = edge[e].nex){ int v = edge[e].to; if(!dis[v] \u0026amp;\u0026amp; edge[e].cap \u0026gt; edge[e].flow){ dis[v] = dis[x] + 1;q.push(v); } } } return dis[t]; } int dfs(int x,int t,int limit = inf){ if(x == t || limit == 0) return limit; int sumf = 0; for(int e = fir[x];e;e = edge[e].nex){ int v = edge[e].to; if(dis[v] == dis[x]+1 \u0026amp;\u0026amp; edge[e].cap \u0026gt; edge[e].flow){ int f = dfs(v,t,min(limit,edge[e].cap - edge[e].flow)); if(f){ sumf += f,limit -= f; edge[e].flow += f,edge[e^1].flow -= f; } if(limit == 0) break; } } return sumf; } int dinic(int s,int t){ int ans = 0; while(bfs(s,t)) ans += dfs(s,t); return ans; } vector\u0026lt;int\u0026gt; node[MAXN]; int val[MAXN],cost[MAXN]; vector\u0026lt;int\u0026gt; ans1,ans2; void dfs1(int x){ if(1 \u0026lt;= x \u0026amp;\u0026amp; x \u0026lt;= m) ans1.push_back(x); if(m+1 \u0026lt;= x \u0026amp;\u0026amp; x \u0026lt;= m+n) ans2.push_back(x-m); int t = 0;swap(t,dis[x]); for(int e = fir[x];e;e = edge[e].nex){ int v = edge[e].to; if(dis[v] == t+1) dfs1(v); } } void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;m,\u0026amp;n); // 1 -\u0026gt; m å®éªŒï¼Œm+1 -\u0026gt; m+n \u0008ç‰©å“  static char s[MAXN*10]; for(int i = 1;i\u0026lt;=m;i++){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;val[i]); int t; while(scanf(\u0026#34;%[\\n\\r]\u0026#34;,s)!=1){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;t); node[i].push_back(t); } } for(int i = 1;i\u0026lt;=n;i++) scanf(\u0026#34;%d\u0026#34;,\u0026amp;cost[i]); } void solve(){ int S = n+m+1,T = S+1,sum = 0; for(int i = 1;i\u0026lt;=m;i++) addedge(S,i,val[i]),sum += val[i]; for(int i = 1;i\u0026lt;=m;i++) for(auto x : node[i]) addedge(i,m+x,inf); for(int i = 1;i\u0026lt;=n;i++) addedge(m+i,T,cost[i]); int ans = sum - dinic(S,T); bfs(S,T); dfs1(S); sort(ans1.begin(),ans1.end()),sort(ans2.begin(),ans2.end()); for(unsigned i = 0;i\u0026lt;ans1.size();i++){ printf(\u0026#34;%d\u0026#34;,ans1[i]);putchar(i != ans1.size()-1?\u0026#39; \u0026#39;:\u0026#39;\\n\u0026#39;); } for(unsigned i = 0;i\u0026lt;ans2.size();i++){ printf(\u0026#34;%d\u0026#34;,ans2[i]);putchar(i != ans2.size()-1?\u0026#39; \u0026#39;:\u0026#39;\\n\u0026#39;); } printf(\u0026#34;%d\\n\u0026#34;,ans); } int main(){ init(); solve(); }   ","description":"","id":34,"section":"posts","tags":["å›¾è®º","æœ€å¤§æƒé—­åˆå­å›¾","ç½‘ç»œæµ"],"title":"ã€Œç½‘ç»œæµ 24 é¢˜ã€å¤ªç©ºé£è¡Œè®¡åˆ’-æœ€å¤§æƒé—­åˆå­å›¾","uri":"https://blog.chenqiqian.com/posts/loj6001/"},{"content":"é£è¡Œå¤§é˜Ÿæœ‰è‹¥å¹²ä¸ªæ¥è‡ªå„åœ°çš„é©¾é©¶å‘˜ï¼Œä¸“é—¨é©¾é©¶ä¸€ç§å‹å·çš„é£æœºï¼Œè¿™ç§é£æœºæ¯æ¶æœ‰ä¸¤ä¸ªé©¾é©¶å‘˜ï¼Œéœ€ä¸€ä¸ªæ­£é©¾é©¶å‘˜å’Œä¸€ä¸ªå‰¯é©¾é©¶å‘˜ã€‚ç”±äºç§ç§åŸå› ï¼Œä¾‹å¦‚ç›¸äº’é…åˆçš„é—®é¢˜ï¼Œæœ‰äº›é©¾é©¶å‘˜ä¸èƒ½åœ¨åŒä¸€æ¶é£æœºä¸Šé£è¡Œï¼Œé—®å¦‚ä½•æ­é…é©¾é©¶å‘˜æ‰èƒ½ä½¿å‡ºèˆªçš„é£æœºæœ€å¤šã€‚\nå› ä¸ºé©¾é©¶å·¥ä½œåˆ†å·¥ä¸¥æ ¼ï¼Œä¸¤ä¸ªæ­£é©¾é©¶å‘˜æˆ–ä¸¤ä¸ªå‰¯é©¾é©¶å‘˜éƒ½ä¸èƒ½åŒæœºé£è¡Œã€‚\né“¾æ¥ LOJ6000\né¢˜è§£ æ³¨æ„åˆ°è¿™å°±æ˜¯ä¸€ä¸ªäºŒåˆ†å›¾åŒ¹é…é—®é¢˜ã€‚\næˆ‘ä»¬æŠŠå·¦ä¾§æ”¾ç½®æ­£é£è¡Œå‘˜ï¼ˆ $1$ - $m$ ï¼‰ï¼Œå³ä¾§æ”¾ç½®å‰¯é£è¡Œå‘˜ï¼ˆ $m+1$ - $n$ ï¼‰ï¼Œç„¶ååœ¨å¯ä»¥é…å¯¹çš„æ­£å‰¯é£è¡Œå‘˜ä¹‹é—´è¿è¾¹ï¼ŒäºŒåˆ†å›¾æœ€å¤§åŒ¹é…å³ä¸ºç­”æ¡ˆã€‚\nå¯ä»¥ç”¨ç½‘ç»œæœ€å¤§æµè§£å†³è¿™ä¸ªé—®é¢˜ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81  #include \u0026lt;bits/stdc++.h\u0026gt;#define inf 0x3f3f3f3f using namespace std; const int MAXN = 110,MAXM = 110*110; struct Edge{ int from,to; int cap,flow; int nex; }edge[MAXM]; int fir[MAXN],ecnt = 2; void addedge(int a,int b,int c){ edge[ecnt] = (Edge){a,b,c,0,fir[a]};fir[a] = ecnt++; edge[ecnt] = (Edge){b,a,0,0,fir[b]};fir[b] = ecnt++; } int n,m,dis[MAXN]; bool bfs(int s,int t){ static queue\u0026lt;int\u0026gt; q; memset(dis,0,sizeof(dis));while(!q.empty()) q.pop(); dis[s] = 1;q.push(s); while(!q.empty()){ int x = q.front();q.pop(); for(int e = fir[x];e;e = edge[e].nex){ int v = edge[e].to; if(!dis[v] \u0026amp;\u0026amp; edge[e].cap \u0026gt; edge[e].flow){ dis[v] = dis[x]+1;q.push(v); } } } return dis[t]; } int dfs(int x,int t,int limit = inf){ if(limit == 0 || x == t) return limit; int sumf = 0; for(int e = fir[x];e;e = edge[e].nex){ int v = edge[e].to; if(dis[v] == dis[x] + 1 \u0026amp;\u0026amp; edge[e].cap \u0026gt; edge[e].flow){ int f = dfs(v,t,min(edge[e].cap - edge[e].flow,limit)); if(f){ sumf += f,limit -= f; edge[e].flow += f,edge[e^1].flow -= f; } if(limit == 0) break; } } return sumf; } int dinic(int s,int t){ int ans = 0; while(bfs(s,t)) ans += dfs(s,t); return ans; } int w[MAXN][MAXN]; void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m);int a,b; while(scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;a,\u0026amp;b) == 2) w[a][b] = 1; } void solve(){ // å»ºå›¾ï¼šæ¯ä¸ªé£è¡Œå‘˜ä¸€ä¸ªç‚¹ï¼Œæ­£ 1-\u0026gt; m ï¼Œå‰¯ m+1 -\u0026gt; n  int S = n+1,T = n+2; for(int i = 1;i\u0026lt;=m;i++) addedge(S,i,1); for(int i = 1;i\u0026lt;=m;i++) for(int j = m+1;j\u0026lt;=n;j++) if(w[i][j] == 1) addedge(i,j,1); for(int j = m+1;j\u0026lt;=n;j++) addedge(j,T,1); printf(\u0026#34;%d\\n\u0026#34;,dinic(S,T)); } int main(){ init(); solve(); return 0; }   ","description":"","id":35,"section":"posts","tags":["å›¾è®º","ç½‘ç»œæµ","äºŒåˆ†å›¾"],"title":"ã€Œç½‘ç»œæµ 24 é¢˜ã€æ­é…é£è¡Œå‘˜-äºŒåˆ†å›¾æœ€å¤§åŒ¹é…","uri":"https://blog.chenqiqian.com/posts/loj6000/"},{"content":"ä½ è¢«ç»™å®šä¸€æ£µ $n$ ä¸ªç‚¹çš„æ ‘ï¼Œç‚¹ä» $1$ åˆ° $n$ ç¼–å·ã€‚æ¯ä¸ªç‚¹å¯èƒ½æœ‰ä¸¤ç§é¢œè‰²ï¼šé»‘æˆ–ç™½ã€‚æˆ‘ä»¬å®šä¹‰ $dist(a,b)$ ä¸ºç‚¹ $a$ è‡³ç‚¹ $b$ è·¯å¾„ä¸Šçš„è¾¹ä¸ªæ•°ã€‚ä¸€å¼€å§‹æ‰€æœ‰çš„ç‚¹éƒ½æ˜¯é»‘è‰²çš„ã€‚\nè¦æ±‚ä½œä»¥ä¸‹æ“ä½œï¼š\n 0 i å°†ç‚¹ $i$ çš„é¢œè‰²åè½¬ï¼ˆé»‘å˜ç™½ï¼Œç™½å˜é»‘ï¼‰ 1 v è¯¢é—® $dist(u,v)$ çš„æœ€å°å€¼ã€‚$u$ ç‚¹å¿…é¡»ä¸ºç™½è‰²ï¼ˆ $u$ ä¸ $v$ å¯ä»¥ç›¸åŒï¼‰ï¼Œæ˜¾ç„¶å¦‚æœ $v$ æ˜¯ç™½ç‚¹ï¼ŒæŸ¥è¯¢å¾—åˆ°çš„å€¼ä¸€å®šæ˜¯ $0$ ã€‚  ç‰¹åˆ«åœ°ï¼Œå¦‚æœä½œ 1 æ“ä½œæ—¶æ ‘ä¸Šæ²¡æœ‰ç™½ç‚¹ï¼Œè¾“å‡º $-1$ ã€‚\né“¾æ¥ Luogu\né¢˜è§£ æˆ‘ç›´æ¥å¤åˆ¶äº† QTREE4 çš„ä»£ç \u0026hellip;\nä¸»è¦æ”¹åŠ¨å¦‚ä¸‹ï¼š\n æŠŠæ‰€æœ‰çš„ $\\max$ æ”¹æˆäº† $\\min$ æŠŠæ‰€æœ‰çš„è¾¹æƒæ”¹æˆ $1$ å»é™¤æ‰€æœ‰è·Ÿè·¯å¾„æœ‰å…³çš„ä¸œè¥¿  ç„¶åå°±okäº†\u0026hellip;\næ—¶é—´å¤æ‚åº¦ï¼š $O(n \\log^2 n)$\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111  #include \u0026lt;bits/stdc++.h\u0026gt;#define inf 0x3f3f3f3f using namespace std; const int MAXN = 210000; struct Edge{ int to,nex; }edge[MAXN*2]; int fir[MAXN],ecnt = 2; void addedge(int a,int b){ edge[ecnt] = (Edge){b,fir[a]}; fir[a] = ecnt++; } inline int _f(multiset\u0026lt;int\u0026gt; \u0026amp;S){return S.size()?*S.begin():inf;} struct LCT{ int c[MAXN][2],w[MAXN],f[MAXN],sum[MAXN]; int lmin[MAXN],rmin[MAXN]; multiset\u0026lt;int\u0026gt; Ch[MAXN]; void init(int n){for(int i = 0;i\u0026lt;=n;i++) w[i] = lmin[i] = rmin[i] = inf;} bool noroot(int x){return c[f[x]][0] == x || c[f[x]][1] == x;} void push_up(int x){assert(x); #define ls c[x][0]  #define rs c[x][1]  sum[x] = sum[ls] + sum[rs] + 1; int minc = min(w[x],_f(Ch[x])); int L = min(minc,rmin[ls] + 1),R=min(minc,lmin[rs]); lmin[x] = min(lmin[ls],R + sum[ls] + 1); rmin[x] = min(rmin[rs],L + sum[rs]); #undef ls  #undef rs  } void rotate(int x){ int y = f[x],z = f[y],t = c[y][1] == x,w = c[x][1-t]; if(noroot(y)) c[z][c[z][1]==y] = x; c[x][1-t] = y,c[y][t] = w; if(w) f[w] = y; f[y] = x,f[x] = z; push_up(y); } void splay(int x){ while(noroot(x)){ int y = f[x],z = f[y]; if(noroot(y)){ (c[y][1]==x)^(c[z][1]==y)?rotate(x):rotate(y); }rotate(x); }push_up(x); } void access(int x){ for(int y = 0;x;x = f[y=x]){ splay(x); if(c[x][1]) Ch[x].insert(lmin[c[x][1]]); if(y) Ch[x].erase(Ch[x].find(lmin[y])); c[x][1] = y,push_up(x); } } void modify(int x){ access(x),splay(x); w[x] = w[x]==0?inf:0; push_up(x); } int query(int x){ access(x),splay(x); return rmin[x]; } void add(int x,int v){Ch[x].insert(lmin[v]);} }T; void dfs1(int x,int fa){ for(int nowe = fir[x];nowe;nowe = edge[nowe].nex){ int v = edge[nowe].to; if(v == fa) continue; T.f[v] = x,dfs1(v,x); T.add(x,v); } T.push_up(x); } int n,q; void init(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n); for(int i = 2;i\u0026lt;=n;i++){ int a,b; scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;a,\u0026amp;b); addedge(a,b),addedge(b,a); } T.init(n);dfs1(1,0); } void solve(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;q); int op, x; for(int i = 1;i\u0026lt;=q;i++){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;op,\u0026amp;x); if(op == 1){ int ans = T.query(x); if(ans \u0026lt; inf) printf(\u0026#34;%d\\n\u0026#34;,ans); else printf(\u0026#34;-1\\n\u0026#34;); }else if(op == 0) T.modify(x); } } int main(){ init(); solve(); return 0; }   ","description":"","id":36,"section":"posts","tags":["æ•°æ®ç»“æ„","LCT"],"title":"ã€ŒSPOJ26374ã€QTREE5-LCT","uri":"https://blog.chenqiqian.com/posts/spoj26374-qtree5/"},{"content":"ä¸€æ£µæ ‘,æ¯ä¸ªç‚¹åˆå§‹æœ‰ä¸ªç‚¹æƒå’Œé¢œè‰²(è¾“å…¥ä¼šç»™ä½ )\n 0 u : è¯¢é—®æ‰€æœ‰ $u,v$ è·¯å¾„ä¸Šçš„æœ€å¤§ç‚¹æƒ,è¦æ»¡è¶³ $u,v$ è·¯å¾„ä¸Šæ‰€æœ‰ç‚¹çš„é¢œè‰²éƒ½ç›¸åŒ 1 u : åè½¬ $u$ çš„é¢œè‰² 2 u w :æŠŠ $u$ çš„ç‚¹æƒæ”¹æˆ $w$  $color_i \\in [0,1],w_i \\in [-10^9,10^9],n,m \\le 10^5$\né“¾æ¥ Luogu\né¢˜è§£ æˆ‘å°±æ˜¯è¦ç”¨ä¸€ä¸ª LCT åšï¼\nè¿™æ¬¡åœ¨ BZOJ ä¸Šä¹Ÿæ²¡æœ‰è¢«å¡å¸¸ï¼\næˆ‘ä»¬ç»´æŠ¤ä¸¤ä¸ª multiset ç»´æŠ¤æ¯ä¸ªç‚¹çš„è™šå­æ ‘ï¼ˆé¡¶ç‚¹ä¸åŒé¢œè‰²ï¼‰çš„æœ€å¤§è”é€šå—ï¼ˆè¡¨ç°ä¸º lmx[x]ï¼‰ï¼Œæ¯æ¬¡ access çš„æ—¶å€™æ›´æ–°ä¸€ä¸‹å°±å¥½äº†ã€‚\nä¸€å®šè®°ä½ï¼Œaccessçš„æ—¶å€™è¯¥åˆ çš„åˆ ï¼Œè¯¥åŠ çš„åŠ ï¼Œæ˜¯ç›¸å¯¹äºå­æ ‘æ¥è¯´çš„ï¼åˆ«æé”™äº†(å¤§å“­\næ—¶é—´å¤æ‚åº¦ï¼š$O(n \\log^2 n)$ ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110  #include \u0026lt;bits/stdc++.h\u0026gt;#define inf 0x3f3f3f3f using namespace std; const int MAXN = 110000; int _f(multiset\u0026lt;int\u0026gt; \u0026amp;S){return S.empty()?-inf:*(S.rbegin());} struct LCT{ int c[MAXN][2],f[MAXN],v[MAXN],w[MAXN],sum[MAXN][2]; int lc[MAXN],rc[MAXN],lmx[MAXN],rmx[MAXN]; multiset\u0026lt;int\u0026gt; vmx[MAXN][2]; void init(){lmx[0] = rmx[0] = -inf+1;} bool noroot(int x){return c[f[x]][0]==x||c[f[x]][1]==x;} void push_up(int x){ #define ls c[x][0]  #define rs c[x][1]  sum[x][0] = sum[ls][0] + sum[rs][0] + (w[x]==0); sum[x][1] = sum[ls][1] + sum[rs][1] + (w[x]==1); lc[x] = ls?lc[ls]:w[x],rc[x] = rs?rc[rs]:w[x]; int maxl = max(max(v[x],_f(vmx[x][w[x]])) , rc[ls] == w[x]?rmx[ls]:-inf); int maxr = max(max(v[x],_f(vmx[x][w[x]])) , lc[rs] == w[x]?lmx[rs]:-inf); lmx[x] = lmx[ls],rmx[x] = rmx[rs]; if(!ls || (!sum[ls][1-lc[x]] \u0026amp;\u0026amp; w[x] == lc[x])) lmx[x] = max(lmx[x],maxr);//!!!  if(!rs || (!sum[rs][1-rc[x]] \u0026amp;\u0026amp; w[x] == rc[x])) rmx[x] = max(rmx[x],maxl);//!!!  #undef ls  #undef rs  } void rotate(int x){ int y = f[x],z = f[y],t = (c[y][1]==x),w = c[x][1-t];//!!!  if(noroot(y)) c[z][c[z][1]==y] = x; c[x][1-t] = y,c[y][t] = w; if(w) f[w] = y; f[y] = x,f[x] = z; push_up(y); } void splay(int x){ while(noroot(x)){ int y = f[x],z = f[y]; if(noroot(y)){ (c[y][1]==x)^(c[z][1]==y)?rotate(x):rotate(y); }rotate(x); }push_up(x); } void access(int x){ for(int y = 0;x;x = f[y=x]){ splay(x); vmx[x][ lc[c[x][1]] ].insert(lmx[ c[x][1] ]);//!!!  vmx[x][ lc[y] ].erase(lmx[y]);//!!!  c[x][1] = y,push_up(x);//!!!  } } void m_node(int x,int c,int val){w[x] = c,v[x] = val;} void m_fa(int x,int fa){f[x] = fa,vmx[fa][lc[x]].insert(lmx[x]);} void m_color(int x){access(x),splay(x),w[x]^=1,push_up(x);} void m_value(int x,int val){access(x),splay(x),v[x] = val,push_up(x);} int q_max(int x){access(x),splay(x);return rmx[x];} }T; int n,q; int col[MAXN],val[MAXN]; struct Edge{ int to,nex; }edge[MAXN*2]; int fir[MAXN],ecnt = 2; void addedge(int a,int b){ edge[ecnt] = (Edge){b,fir[a]}; fir[a] = ecnt++; } void dfs(int x,int fa){ for(int e = fir[x];e;e = edge[e].nex){ int v = edge[e].to; if(v == fa) continue; T.m_node(v,col[v],val[v]); dfs(v,x); T.push_up(v),T.m_fa(v,x); } } void init(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n);T.init(); for(int i = 1;i\u0026lt;=n-1;i++){ int a,b; scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;a,\u0026amp;b); addedge(a,b),addedge(b,a); } for(int i = 1;i\u0026lt;=n;i++) scanf(\u0026#34;%d\u0026#34;,\u0026amp;col[i]); for(int i = 1;i\u0026lt;=n;i++) scanf(\u0026#34;%d\u0026#34;,\u0026amp;val[i]); T.m_node(1,col[1],val[1]);dfs(1,0); } void solve(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;q); for(int i = 1;i\u0026lt;=q;i++){ int op,x,v; scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;op,\u0026amp;x); if(op == 0) printf(\u0026#34;%d\\n\u0026#34;,T.q_max(x)); else if(op == 1) T.m_color(x); else if(op == 2) scanf(\u0026#34;%d\u0026#34;,\u0026amp;v),T.m_value(x,v); } } int main(){ init(); solve(); return 0; }   ","description":"","id":37,"section":"posts","tags":["æ•°æ®ç»“æ„","LCT"],"title":"ã€ŒSPOJ16580ã€QTREE7-LCT","uri":"https://blog.chenqiqian.com/posts/spoj16580-qtree7/"},{"content":"ç»™ä½ ä¸€æ£µ $n$ ä¸ªç‚¹çš„æ ‘ï¼Œç¼–å· $1$~$n$ ã€‚æ¯ä¸ªç‚¹å¯ä»¥æ˜¯é»‘è‰²ï¼Œå¯ä»¥æ˜¯ç™½è‰²ã€‚åˆå§‹æ—¶æ‰€æœ‰ç‚¹éƒ½æ˜¯é»‘è‰²ã€‚æœ‰ä¸¤ç§æ“ä½œï¼š\n 0 u ï¼šè¯¢é—®æœ‰å¤šå°‘ä¸ªèŠ‚ç‚¹ $v$ æ»¡è¶³è·¯å¾„ $u$ åˆ° $v$ ä¸Šæ‰€æœ‰èŠ‚ç‚¹ï¼ˆåŒ…æ‹¬ç«¯ç‚¹ï¼‰éƒ½æ‹¥æœ‰ç›¸åŒçš„é¢œè‰² 1 u ï¼šç¿»è½¬ $u$ çš„é¢œè‰²  é“¾æ¥ Luogu\né¢˜è§£ æˆ‘å°±ä¸æƒ³ç”¨ä¸¤ä¸ª LCT åšï¼\nç„¶ååœ¨ BZOJ ä¸Šå°±è¢«å¡å¸¸äº†\u0026hellip;æ— æ‰€è°“äº†ï¼\næˆ‘ä»¬è€ƒè™‘ç±»ä¼¼ QTREE457 ï¼Œç»´æŠ¤ä¸€ä¸‹è™šå­çš„è”é€šå—æƒ…å†µå³å¯ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä»£è¡¨ä¸€ä¸ª $splay$ çš„é¢œè‰²åº”è¯¥æ˜¯æœ€å·¦ä¾§çš„é¢œè‰²ï¼Œä¹Ÿå°±æ˜¯ä»£ç ä¸­çš„ lc[x] ã€‚\nå¥—è·¯ä¹Ÿæ˜¯ç›¸åŒçš„ï¼Œpush_up ä¼šå†™çš„ç¨å¾®éº»çƒ¦ç‚¹ï¼Œaccess è¦è€ƒè™‘è™šå­çš„å˜åŒ–å¯¹ç»´æŠ¤çš„è™šå­ä¿¡æ¯çš„å½±å“ã€‚\næ—¶é—´å¤æ‚åº¦: $O(n\\log n)$\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102  #include \u0026lt;bits/stdc++.h\u0026gt;using namespace std; const int MAXN = 110000; struct LCT{ int c[MAXN][2],f[MAXN]; int w[MAXN];// ä»£è¡¨é¢œè‰² 0ç™½ 1é»‘  int lc[MAXN],rc[MAXN];// ä»£è¡¨å½“å‰splayå­æ ‘çš„æœ€å·¦ä¾§å’Œæœ€å³ä¾§çš„é¢œè‰²  int lsum[MAXN],rsum[MAXN];// ä»£è¡¨å·¦ä¾§çš„è¿ç—›å—å’Œå³ä¾§çš„è”é€šå—çš„å¤§å°ï¼Œ  int vsum[MAXN][2],siz[MAXN][2];// æ ¹èŠ‚ç‚¹çš„è™šå­æ ‘ï¼Œæ ¹èŠ‚ç‚¹é¢œè‰²ä¸º 0/1 çš„å¤§å°  void init(int n){ for(int i = 1;i\u0026lt;=n;i++) w[i] = 1; } bool noroot(int x){return c[f[x]][0]==x||c[f[x]][1]==x;} void push_up(int x){ #define ls (c[x][0])  #define rs (c[x][1])  siz[x][0] = siz[ls][0] + siz[rs][0] + (w[x]==0); siz[x][1] = siz[ls][1] + siz[rs][1] + (w[x]==1); lc[x] = ls?lc[ls]:w[x],rc[x] = rs?rc[rs]:w[x]; int xl = 1 + vsum[x][w[x]] + (rc[ls]==w[x]?rsum[ls]:0); int xr = 1 + vsum[x][w[x]] + (lc[rs]==w[x]?lsum[rs]:0); lsum[x] = lsum[ls],rsum[x] = rsum[rs]; if(!ls || (!siz[ls][1-lc[ls]] \u0026amp;\u0026amp; lc[ls] == w[x])) lsum[x] += xr; if(!rs || (!siz[rs][1-rc[rs]] \u0026amp;\u0026amp; rc[rs] == w[x])) rsum[x] += xl; #undef ls  #undef rs  } void rotate(int x){ int y = f[x],z = f[y],t = (c[y][1]==x),w = (c[x][1-t]); if(noroot(y)) c[z][c[z][1]==y] = x; c[x][1-t] = y,c[y][t] = w; if(w) f[w] = y; f[x] = z,f[y] = x; push_up(y); } void splay(int x){ while(noroot(x)){ int y = f[x],z = f[y]; if(noroot(y)){ (c[y][1]==x)^(c[z][1]==y)?rotate(x):rotate(y); }rotate(x); }push_up(x); } void access(int x){ for(int y = 0;x;x = f[y=x]){ splay(x); vsum[x][lc[c[x][1]]] += lsum[c[x][1]]; vsum[x][lc[y]] -= lsum[y]; c[x][1] = y,push_up(x); } } void modify(int x){access(x),splay(x),w[x] ^= 1,push_up(x);} int query(int x){access(x),splay(x);return rsum[x];} }T; struct Edge{ int to,nex; }edge[MAXN*2]; int fir[MAXN],ecnt = 2; void addedge(int a,int b){ edge[ecnt] = (Edge){b,fir[a]}; fir[a] = ecnt++; } void dfs(int x,int fa){ for(int e = fir[x];e;e = edge[e].nex){ int v = edge[e].to; if(v == fa) continue; dfs(v,x); T.f[v] = x,T.vsum[x][T.w[v]] += T.lsum[v]; } T.push_up(x); } int n,m; void init(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n);T.init(n); for(int i = 1;i\u0026lt;=n-1;i++){ int a,b; scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;a,\u0026amp;b); addedge(a,b),addedge(b,a); } dfs(1,0); } void solve(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;m); for(int i = 1;i\u0026lt;=m;i++){ int op,x; scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;op,\u0026amp;x); if(op == 0) printf(\u0026#34;%d\\n\u0026#34;,T.query(x)); else if(op == 1) T.modify(x); } } int main(){ init(),solve(); return 0; }   ","description":"","id":38,"section":"posts","tags":["æ•°æ®ç»“æ„","LCT"],"title":"ã€ŒSPOJ16549ã€QTREE6-LCT","uri":"https://blog.chenqiqian.com/posts/spoj16549-qtree6/"},{"content":"ç»™å®šä¸€æ£µ $n$ ä¸ªç‚¹çš„æ ‘ï¼Œè¾¹å…·æœ‰è¾¹æƒã€‚è¦æ±‚ä½œä»¥ä¸‹æ“ä½œï¼š\n  DIST a b è¯¢é—®ç‚¹ $a$ è‡³ç‚¹ $b$ è·¯å¾„ä¸Šçš„è¾¹æƒä¹‹å’Œ\n  KTH a b k è¯¢é—®ç‚¹ $a$ è‡³ç‚¹ $b$ æœ‰å‘è·¯å¾„ä¸Šçš„ç¬¬kä¸ªç‚¹çš„ç¼–å·\n  æœ‰å¤šç»„æµ‹è¯•æ•°æ®ï¼Œæ¯ç»„æ•°æ®ä»¥ DONE ç»“å°¾ã€‚\né“¾æ¥ Luogu\né¢˜è§£ æˆ‘ä»¬æ¥ç€ç”¨LCTçˆ†æè¿™ä¸ªé¢˜ã€‚\næˆ‘ä»¬è¿˜æ˜¯æŠŠè¾¹æ‹†æˆç‚¹ï¼Œåˆ†åˆ«å‘ä¸¤è¾¹è¿è¾¹ï¼Œç„¶åè·ç¦»å°±æ˜¯è·¯å¾„ç‚¹æƒå’Œï¼›æŸ¥è¯¢ç¬¬ $k$ ä¸ªç‚¹å°±æ˜¯ split ä¹‹ååœ¨ $splay$ ä¸Šä¹±è·‘æ‰¾ kth ã€‚\næ—¶é—´å¤æ‚åº¦ï¼š $O(n \\log n)$\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109  #include \u0026lt;bits/stdc++.h\u0026gt;#define ll long long using namespace std; const int MAXN = 21000; struct LCT{ int c[MAXN][2],f[MAXN],siz[MAXN],r[MAXN]; ll v[MAXN],sum[MAXN]; void init(int n){for(int i=1;i\u0026lt;=n;i++)c[i][0]=c[i][1]=f[i]=r[i]=v[i]=sum[i]=0,siz[i]=1;} bool noroot(int x){return c[f[x]][0] == x || c[f[x]][1] == x;} void rev(int x){r[x]^=1,swap(c[x][0],c[x][1]);} void push_down(int x){if(r[x])rev(c[x][0]),rev(c[x][1]),r[x]=0;} void push_up(int x){ siz[x] = siz[c[x][0]] + siz[c[x][1]] + 1; sum[x] = sum[c[x][0]] + sum[c[x][1]] + v[x]; } void push_all(int x){ static int S[MAXN];S[0] = 0; while(noroot(x)) S[++S[0]] = x,x = f[x]; S[++S[0]] = x; for(int i = S[0];i\u0026gt;=1;--i) push_down(S[i]); } void rotate(int x){ int y = f[x],z = f[y],t = (c[y][1]==x),w = c[x][1-t]; if(noroot(y)) c[z][c[z][1]==y] = x; c[x][1-t] = y,c[y][t] = w; if(w) f[w] = y; f[x] = z,f[y] = x; push_up(y); } void splay(int x){ push_all(x); while(noroot(x)){ int y = f[x],z = f[y]; if(noroot(y)){ (c[y][1]==x)^(c[z][1]==y)?rotate(x):rotate(y); }rotate(x); }push_up(x); } void access(int x){ for(int y = 0;x;x = f[y=x]) splay(x),c[x][1] = y,push_up(x); } void makeroot(int x){access(x),splay(x),rev(x);} void m_node(int x,int fa,int val = 0){v[x] = sum[x] = val,f[x] = fa;} void split(int x,int y){makeroot(x),access(y),splay(y);} ll query_sum(int x,int y){return (split(x,y),sum[y]);} int query_kth(int x,int y,int k){ split(x,y);int t = y; if(k \u0026gt; siz[y]) return -1; while(true){ push_down(t); if(k \u0026lt;= siz[c[t][0]]) t = c[t][0]; else if(k == siz[c[t][0]] + 1) break; else k -= siz[c[t][0]]+1,t = c[t][1]; } if(t) splay(t);return t; } }T; struct Edge{ int id,to,len,nex; }edge[MAXN]; int fir[MAXN],ecnt = 2; void __clear(int n){ecnt = 2;for(int i = 1;i\u0026lt;=n;i++) fir[i] = 0;} void addedge(int id,int a,int b,int c){ edge[ecnt] = (Edge){id,b,c,fir[a]}; fir[a] = ecnt++; } //---------------// int n; void dfs(int x,int fa){ for(int e = fir[x];e;e = edge[e].nex){ int v = edge[e].to,len = edge[e].len,id = edge[e].id; if(v == fa) continue; T.m_node(n+id,x,len),T.m_node(v,n+id); dfs(v,x); } } void init(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n);T.init(2*n),__clear(2*n); for(int i = 1;i\u0026lt;=n-1;i++){ int a,b,c; scanf(\u0026#34;%d %d %d\u0026#34;,\u0026amp;a,\u0026amp;b,\u0026amp;c); addedge(i,a,b,c),addedge(i,b,a,c); } dfs(1,0); } void solve(){ char op[10];int x,y,k; while(true){ scanf(\u0026#34;%s\u0026#34;,op); if(op[1] == \u0026#39;O\u0026#39;) break; scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;x,\u0026amp;y); if(op[0]==\u0026#39;K\u0026#39;) scanf(\u0026#34;%d\u0026#34;,\u0026amp;k),printf(\u0026#34;%d\\n\u0026#34;,T.query_kth(x,y,2*k-1)); else if(op[0] == \u0026#39;D\u0026#39;) printf(\u0026#34;%lld\\n\u0026#34;,T.query_sum(x,y)); } } int main(){ int T = 0;scanf(\u0026#34;%d\u0026#34;,\u0026amp;T); for(int i = 1;i\u0026lt;=T;i++)init(),solve(); return 0; }   ","description":"","id":39,"section":"posts","tags":["LCT","æ•°æ®ç»“æ„"],"title":"ã€ŒSPOJ913ã€QTREE2-LCT","uri":"https://blog.chenqiqian.com/posts/spoj913-qtree2/"},{"content":"ç»™å®š $n$ ä¸ªç‚¹çš„æ ‘ï¼Œè¾¹æŒ‰è¾“å…¥é¡ºåºç¼–å·ä¸º $1,2,\u0026hellip;,n-1$ï¼Œè¦æ±‚ä½œä»¥ä¸‹æ“ä½œï¼š\n CHANGE i v ï¼šå°†ç¬¬ $i$ æ¡è¾¹æƒå€¼æ”¹ä¸º $v$ QUERY a b ï¼šè¯¢é—®ä» $a$ ç‚¹åˆ° $b$ ç‚¹è·¯å¾„ä¸Šçš„æœ€å¤§è¾¹æƒ  æœ‰å¤šç»„æµ‹è¯•æ•°æ®ï¼Œæ¯ç»„æ•°æ®ä»¥ DONE ç»“å°¾ã€‚\né“¾æ¥ Luogu\né¢˜è§£ å¯ä»¥ç”¨ LCT å®Œæˆæœ¬é¢˜ã€‚\næˆ‘ä»¬è€ƒè™‘æ¯ä¸ªè¾¹å’Œæ¯ä¸ªç‚¹å»ºç«‹ä¸€ä¸ª LCT ä¸­çš„ç‚¹ï¼Œç„¶åè¾¹çš„ç‚¹çš„ç‚¹æƒå°±æ˜¯è¾¹çš„è¾¹æƒï¼Œè¿™æ ·å°±å¯ä»¥ä¿®æ”¹è¾¹çš„æƒå€¼äº†ã€‚\næŸ¥è¯¢çš„è¯ï¼Œç›´æ¥ split å‡ºæ¥æŸ¥è¯¢æœ€å¤§å€¼å³å¯ï¼Œç‚¹å¯¹åº”çš„ LCT ä¸­çš„ç‚¹çš„æƒå€¼ä¸º $-\\inf$ã€‚\næ—¶é—´å¤æ‚åº¦ï¼š $O(n \\log n)$\nä»£ç  Luogu ç‰ˆæœ¬ï¼›\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99  #include \u0026lt;bits/stdc++.h\u0026gt;#define inf 0x3f3f3f3f using namespace std; const int MAXN = 210000; struct LCT{ int c[MAXN][2],f[MAXN],v[MAXN],mx[MAXN],r[MAXN]; void init(int n){for(int i = 0;i\u0026lt;=n;i++) v[i]=mx[i] = -inf, c[i][0]=c[i][1]=f[i]=r[i] = 0;} bool noroot(int x){return c[f[x]][0] == x || c[f[x]][1] == x;} void push_up(int x){mx[x] = max(v[x],max(mx[c[x][0]],mx[c[x][1]]));} void rev(int x){r[x] ^= 1,swap(c[x][0],c[x][1]);} void push_down(int x){if(r[x]) rev(c[x][0]),rev(c[x][1]),r[x] = 0;} void push_all(int x){ static int S[MAXN];S[0] = 0; while(noroot(x)) S[++S[0]] = x,x = f[x]; S[++S[0]] = x; for(int i = S[0];i\u0026gt;=1;--i) push_down(S[i]); } void rotate(int x){ int y = f[x],z = f[y],t = (c[y][1] == x),w = c[x][1-t]; if(noroot(y)) c[z][c[z][1]==y] = x; c[x][1-t] = y,c[y][t] = w; if(w) f[w] = y; f[x] = z,f[y] = x; push_up(y); } void splay(int x){ push_all(x); while(noroot(x)){ int y = f[x],z = f[y]; if(noroot(y)){ (c[y][1] == x) ^ (c[z][1] == y) ? rotate(x) : rotate(y); }rotate(x); }push_up(x); } void access(int x){ for(int y = 0;x;x = f[y=x]){ splay(x),c[x][1] = y,push_up(x); } } void makeroot(int x){access(x),splay(x),rev(x);} void update(int x,int val){v[x] = val,push_up(x);} void modify(int x,int val){access(x),splay(x),update(x,val);} void split(int x,int y){makeroot(x),access(y),splay(y);} int query(int x,int y){return x == y ? 0 : (split(x,y),mx[y]);} void addedge(int x,int fa){f[x] = fa;} }T; struct Edge{ int id,to,len,nex; }edge[MAXN*2]; int fir[MAXN],ecnt = 2; void addedge(int id,int a,int b,int c){ edge[ecnt] = (Edge){id,b,c,fir[a]}; fir[a] = ecnt++; } void _clear(int n){ecnt = 2;for(int i = 1;i\u0026lt;=n;i++) fir[i] = 0;} int n,q; void dfs(int x,int fa){ for(int e = fir[x];e;e = edge[e].nex){ int v = edge[e].to,l = edge[e].len,id = edge[e].id; if(v == fa) continue; T.update(n+id,l),T.addedge(v,n+id),T.addedge(n+id,x); dfs(v,x); } } void init(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n); _clear(2*n); T.init(2*n); for(int i = 1;i\u0026lt;=n-1;i++){ int a,b,c; scanf(\u0026#34;%d %d %d\u0026#34;,\u0026amp;a,\u0026amp;b,\u0026amp;c); addedge(i,a,b,c),addedge(i,b,a,c); } dfs(1,0); } void solve(){ char op[10];int x,y; while(true){ scanf(\u0026#34;%s\u0026#34;,op); if(op[0] == \u0026#39;D\u0026#39;) break; scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;x,\u0026amp;y); if(op[0] == \u0026#39;C\u0026#39;) T.modify(n+x,y); else if(op[0] == \u0026#39;Q\u0026#39;) printf(\u0026#34;%d\\n\u0026#34;,T.query(x,y)); } } int main(){ int T = 1; for(int i = 1;i\u0026lt;=T;i++) init(),solve(); return 0; }   SPOJ ç‰ˆæœ¬ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102  #include \u0026lt;stdio.h\u0026gt;#define inf 0x3f3f3f3f #define MAXN 210000  int max(int x,int y){return x \u0026gt; y ? x : y;} int swap(int *x,int *y){(*x) ^= (*y),(*y) ^= (*x),(*x) ^= (*y);} int c[MAXN][2],f[MAXN],v[MAXN],mx[MAXN],r[MAXN]; void _init_(int n){for(int i = 0;i\u0026lt;=n;i++) v[i]=mx[i] = -inf, c[i][0]=c[i][1]=f[i]=r[i] = 0;} int noroot(int x){return c[f[x]][0] == x || c[f[x]][1] == x;} void push_up(int x){mx[x] = max(v[x],max(mx[c[x][0]],mx[c[x][1]]));} void rev(int x){r[x] ^= 1,swap(\u0026amp;c[x][0],\u0026amp;c[x][1]);} void push_down(int x){if(r[x]) rev(c[x][0]),rev(c[x][1]),r[x] = 0;} void push_all(int x){ static int S[MAXN];S[0] = 0; while(noroot(x)) S[++S[0]] = x,x = f[x]; S[++S[0]] = x; for(int i = S[0];i\u0026gt;=1;--i) push_down(S[i]); } void rotate(int x){ int y = f[x],z = f[y],t = (c[y][1] == x),w = c[x][1-t]; if(noroot(y)) c[z][c[z][1]==y] = x; c[x][1-t] = y,c[y][t] = w; if(w) f[w] = y; f[x] = z,f[y] = x; push_up(y); } void splay(int x){ push_all(x); while(noroot(x)){ int y = f[x],z = f[y]; if(noroot(y)){ (c[y][1] == x) ^ (c[z][1] == y) ? rotate(x) : rotate(y); }rotate(x); }push_up(x); } void access(int x){ for(int y = 0;x;x = f[y=x]){ splay(x),c[x][1] = y,push_up(x); } } void makeroot(int x){access(x),splay(x),rev(x);} void update(int x,int val){v[x] = val,push_up(x);} void modify(int x,int val){access(x),splay(x),update(x,val);} void split(int x,int y){makeroot(x),access(y),splay(y);} int query(int x,int y){split(x,y);return x == y ? 0 : mx[y];} void _addedge(int x,int fa){f[x] = fa;} struct Edge{ int id,to,len,nex; }edge[MAXN*2]; int fir[MAXN],ecnt = 2; void addedge(int id,int a,int b,int c){ edge[ecnt].id = id,edge[ecnt].to = b,edge[ecnt].nex = fir[a],edge[ecnt].len = c; fir[a] = ecnt++; } int n,q; void dfs(int x,int fa){ for(int e = fir[x];e;e = edge[e].nex){ int v = edge[e].to,l = edge[e].len,id = edge[e].id; if(v == fa) continue; update(n+id,l),_addedge(v,n+id),_addedge(n+id,x); dfs(v,x); } } void _clear(int n){ ecnt = 2;for(int i = 1;i\u0026lt;=n;i++) fir[i] = 0; } void init(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n); _clear(2*n); _init_(2*n); for(int i = 1;i\u0026lt;=n-1;i++){ int a,b,c; scanf(\u0026#34;%d %d %d\u0026#34;,\u0026amp;a,\u0026amp;b,\u0026amp;c); addedge(i,a,b,c),addedge(i,b,a,c); } dfs(1,0); } void solve(){ char op[10];int x,y; while(1){ scanf(\u0026#34;%s\u0026#34;,op); if(op[0] == \u0026#39;D\u0026#39;) break; scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;x,\u0026amp;y); if(op[0] == \u0026#39;C\u0026#39;) modify(n+x,y); else if(op[0] == \u0026#39;Q\u0026#39;) printf(\u0026#34;%d\\n\u0026#34;,query(x,y)); } } int main(){ int T = 0; scanf(\u0026#34;%d\u0026#34;,\u0026amp;T); for(int i = 1;i\u0026lt;=T;i++) init(),solve(); return 0; }   ","description":"","id":40,"section":"posts","tags":["æ•°æ®ç»“æ„","LCT"],"title":"ã€ŒSPOJ375ã€QTREE1-LCT","uri":"https://blog.chenqiqian.com/posts/spoj375-qtree1/"},{"content":"ä½ è¢«ç»™å®šä¸€æ£µ $n$ ä¸ªç‚¹çš„å¸¦è¾¹æƒçš„æ ‘ï¼ˆè¾¹æƒå¯ä»¥ä¸ºè´Ÿï¼‰ã€‚æ¯ä¸ªç‚¹å¯èƒ½æœ‰ä¸¤ç§é¢œè‰²ï¼šé»‘æˆ–ç™½ã€‚æˆ‘ä»¬å®šä¹‰ $dist(a,b)$ ä¸ºç‚¹ $a$ è‡³ç‚¹ $b$ è·¯å¾„ä¸Šçš„è¾¹æƒå€¼ä¹‹å’Œã€‚ä¸€å¼€å§‹æ‰€æœ‰çš„ç‚¹éƒ½æ˜¯ç™½è‰²çš„ã€‚\nè¦æ±‚ä½œä»¥ä¸‹æ“ä½œï¼š\n  C a å°†ç‚¹açš„é¢œè‰²åè½¬ï¼ˆé»‘å˜ç™½ï¼Œç™½å˜é»‘ï¼‰\n  A è¯¢é—® $dist(a,b)$ çš„æœ€å¤§å€¼ã€‚$a,b$ ç‚¹éƒ½å¿…é¡»ä¸ºç™½è‰²ï¼ˆ $a$ ä¸ $b$ å¯ä»¥ç›¸åŒï¼‰ï¼Œæ˜¾ç„¶å¦‚æœæ ‘ä¸Šä»å­˜åœ¨ç™½ç‚¹ï¼ŒæŸ¥è¯¢å¾—åˆ°çš„å€¼ä¸€å®šæ˜¯ä¸ªéè´Ÿæ•°ã€‚\nç‰¹åˆ«åœ°ï¼Œå¦‚æœè¿›è¡Œ A æ“ä½œæ—¶æ ‘ä¸Šæ²¡æœ‰ç™½ç‚¹ï¼Œè¾“å‡º They have disappeared.ã€‚\n  é“¾æ¥ Luogu\né¢˜è§£ å¯ä»¥ç”¨LCTè§£å†³è¿™ä¸ªé—®é¢˜ã€‚\næˆ‘ä»¬å…ˆè€ƒè™‘é“¾ä¸Šçš„æƒ…å†µã€‚å¦‚æœè¿™ä¸ªé—®é¢˜åœ¨é“¾ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥ç”¨çº¿æ®µæ ‘ç»´æŠ¤è‹¥å¹²ä¸ªå˜é‡ï¼šåŒºé—´å·¦ç«¯ç‚¹å¾€å³æœ€è¿œçš„ç™½ç‚¹ï¼ŒåŒºé—´å³ç«¯ç‚¹å¾€å·¦æœ€è¿œçš„ç™½ç‚¹çš„è·ç¦»ï¼Œè¿™ä¸ªåŒºé—´å†…éƒ¨ä¸¤ä¸ªç™½ç‚¹ä¹‹é—´çš„è·ç¦»ã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨ $O(\\log n)$ çš„æ—¶é—´å†…åˆå¹¶åŒºé—´ã€‚\næˆ‘ä»¬è€ƒè™‘æ ‘ä¸Šæ²¡æœ‰ä¿®æ”¹çš„é—®é¢˜ã€‚æˆ‘ä»¬éƒ½ä¼šç‚¹åˆ†æ²»ï¼šåœ¨è€ƒè™‘æ¯ä¸ªæ ‘çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ‰¾åˆ°ä¸åŒå­æ ‘é‡Œé¢æœ€é•¿çš„ä¸¤ä¸ªé“¾ï¼Œä»–ä»¬åˆå¹¶åˆ°ä¸€èµ· å’Œ å­æ ‘å†…éƒ¨çš„æœ€é•¿é“¾ å–æœ€å¤§å€¼ï¼Œç­”æ¡ˆå°±æ˜¯è¿™ä¸ªå­æ ‘é‡Œé¢æœ€é•¿ç™½ç‚¹ä¹‹é—´çš„è·ç¦»ï¼Œåˆ†æ²»ä¹‹åå°±æ˜¯ $O(n \\log n)$ã€‚\næˆ‘è§‰å¾— LCT çš„è§£æ³•é¢‡æœ‰ 2 åˆ 1 çš„æ„æ€ã€‚\næˆ‘ä»¬ä»¤ 1 å·èŠ‚ç‚¹ä¸ºæ ¹ï¼Œç„¶åæ‰€æœ‰ç‚¹çš„æƒå€¼éƒ½æ˜¯è¿™ä¸ªç‚¹åˆ°çˆ¶äº²çš„è¾¹çš„æƒå€¼ï¼ˆ $1$ å·èŠ‚ç‚¹çš„æƒå€¼ä¸º $0$ ï¼‰ï¼Œè¿™æ ·ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„è·ç¦»å°±æ˜¯ä¸¤ä¸ªç‚¹ä¸Šçš„ç®€å•è·¯å¾„çš„æƒå€¼ä¹‹å’Œã€‚\næ¯ä¸ªèŠ‚ç‚¹æˆ‘ä»¬éœ€è¦ç»´æŠ¤ä»¥ä¸‹ä¿¡æ¯ï¼š\n sum[x] ï¼š $x$ çš„ splay ä¸Šå­æ ‘çš„é“¾å’Œï¼ˆåˆ°é“¾çš„çˆ¶èŠ‚ç‚¹ï¼‰ lmax[x]ï¼Œrmax[x] ï¼š $x$ æ‰€åœ¨ $splay$ çš„å­æ ‘ä¸Šå¯¹åº”åŸæ ‘ä¸Šæœ€æµ…ï¼ˆæ·±ï¼‰çš„ç‚¹ï¼ˆæœ€æµ…çš„ç‚¹çš„çˆ¶äº²ï¼‰å‡ºå‘èƒ½å¤Ÿåˆ°è¾¾æœ€è¿œçš„ç™½ç‚¹ï¼ˆåªåœ¨å½“å‰èŠ‚ç‚¹çš„ $splay$ å’Œè™šå­æ ‘çš„å¹¶é‡Œé¢èµ°ï¼‰ maxs[x] ï¼šæˆ‘ä»¬åªè€ƒè™‘è¿™ä¸ª splay å’Œè¿™ä¸ª splay å¯¹åº”çš„èŠ‚ç‚¹çš„è™šå­æ ‘é‡Œé¢ä¹±è·‘ï¼Œèƒ½è·å¾—çš„æœ€é•¿çš„è·¯å¾„ ä¸¤ä¸ª multiset ï¼š chain[x] , path[x] è¡¨ç¤º $x$ èŠ‚ç‚¹çš„è™šå­æ ‘é‡Œé¢åˆ° $x$ èŠ‚ç‚¹çš„æœ€é•¿é“¾ å’Œ æœ€é•¿è·¯å¾„  æˆ‘ä»¬ä¸»è¦æœ‰ä¸¤ä¸ªç‰¹å¼‚çš„å‡½æ•°ï¼š\n ä¸€ä¸ªç‰¹åˆ«é•¿çš„ push_up ï¼š\nå…·ä½“ç»´æŠ¤åœ¨ä»£ç é‡Œé¢é‡Œé¢çœ‹å§qwq ç¨å¾®æœ‰äº›ä¸åŒçš„ accessï¼š\nå…¶å®æ˜¯ç»´æŠ¤è™šå­æ ‘çš„å¸¸è§„æ“ä½œï¼šè€ƒè™‘æ¶ˆé™¤å’Œæ–°æ·»å½±å“å³å¯ã€‚  æˆ‘ä»¬å°± win æ‰äº†ã€‚\næ—¶é—´å¤æ‚åº¦ä¸º $O(n \\log^2 n)$ ã€‚\nä¸ºä»€ä¹ˆè·‘çš„é£å¿«å•Š\u0026hellip;\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145  #include \u0026lt;bits/stdc++.h\u0026gt;#define inf 0x3f3f3f3f using namespace std; const int MAXN = 210000; struct Edge{ int to,len; int nex; }edge[MAXN*2]; int fir[MAXN],ecnt = 2; void addedge(int a,int b,int c){ edge[ecnt] = (Edge){b,c,fir[a]}; fir[a] = ecnt++; } inline int _f(multiset\u0026lt;int\u0026gt; \u0026amp;S){return S.size()?*S.rbegin():-inf;} inline int _s(multiset\u0026lt;int\u0026gt; \u0026amp;S){return S.size()\u0026gt;1?*(++S.rbegin()):-inf;} struct LCT{ int c[MAXN][2],w[MAXN],f[MAXN],sum[MAXN],len[MAXN]; int lmax[MAXN],rmax[MAXN],maxs[MAXN],ans; multiset\u0026lt;int\u0026gt; Ch[MAXN],Pa[MAXN]; void init(int n){for(int i = 0;i\u0026lt;=n;i++) lmax[i] = rmax[i] = maxs[i] = -inf;} bool noroot(int x){return c[f[x]][0] == x || c[f[x]][1] == x;} void push_up(int x){assert(x); #define ls c[x][0]  #define rs c[x][1]  // sum[x] : é“¾å­çš„é•¿åº¦ï¼Œç”±å·¦å³åŠ èµ·æ¥  sum[x] = sum[ls] + sum[rs] + len[x]; // maxc : ä»è™šå­æ ‘é‡Œé¢ æœ€é•¿çš„åˆ°è¿™ä¸ªç‚¹çš„é“¾çš„é•¿åº¦  // L/R ï¼šä»è¿™ä¸ªç‚¹å·¦/å³ä¾§ï¼ˆæˆ–è€…è™šå­æ ‘ï¼‰è¿‡æ¥èƒ½å¤Ÿè·‘æœ€è¿œçš„è·ç¦»  // l/rmax : è¿™ä¸ªå­ splay é‡Œé¢æœ€æµ…çš„èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ / æœ€æ·±çš„ç‚¹ èƒ½å¤Ÿèµ°åˆ°æœ€è¿œçš„è·ç¦»  int maxc = max(w[x],_f(Ch[x])); int L = max(maxc,rmax[ls]+len[x]),R=max(maxc,lmax[rs]); lmax[x] = max(lmax[ls],R + sum[ls] + len[x]); rmax[x] = max(rmax[rs],L + sum[rs]); maxs[x] = -inf; // 1 : ä¸¤ä¸ªè™šå­æ ‘é‡Œé¢ç»„åˆ 2 : è™šå­æ ‘é‡Œé¢çš„æœ€é•¿è·¯å¾„  // 3 \u0026amp; 4 : ä¸€ä¸ªè™šå­æ ‘å’Œå·¦/å³ å‡ºæ¥åˆ° å³/å·¦ä¾§ è¾¹ä¸­  // 5 \u0026amp; 6 ï¼š ä¸¤ä¸ªå­ splay ä¸­çš„æœ€é•¿è·¯å¾„  // 7 : è™šå­æ ‘ä¸­çš„é“¾åˆ°è¿™ä¸ªèŠ‚ç‚¹çš„è·ç¦»  maxs[x] = max(maxs[x],max(_f(Ch[x])+_s(Ch[x]),_f(Pa[x]))); maxs[x] = max(maxs[x],max(rmax[ls]+len[x]+R,lmax[rs]+L)); maxs[x] = max(maxs[x],max(maxs[ls],maxs[rs])); if(w[x]==0) maxs[x] = max(maxs[x],_f(Ch[x])),maxs[x] = max(maxs[x],0); #undef ls  #undef rs  } void rotate(int x){ int y = f[x],z = f[y],t = c[y][1] == x,w = c[x][1-t]; if(noroot(y)) c[z][c[z][1]==y] = x; c[x][1-t] = y,c[y][t] = w; if(w) f[w] = y; f[y] = x,f[x] = z; push_up(y); } void splay(int x){ while(noroot(x)){ int y = f[x],z = f[y]; if(noroot(y)){ (c[y][1]==x)^(c[z][1]==y)?rotate(x):rotate(y); }rotate(x); }push_up(x); } void access(int x){ for(int y = 0;x;x = f[y=x]){ splay(x); if(c[x][1]) Ch[x].insert(lmax[c[x][1]]),Pa[x].insert(maxs[c[x][1]]); if(y) Ch[x].erase(Ch[x].find(lmax[y])),Pa[x].erase(Pa[x].find(maxs[y])); c[x][1] = y,push_up(x); } } void modify(int x){ access(x),splay(x); w[x] = w[x]==0?-inf:0; push_up(x); ans = maxs[x]; } void add(int x,int v){ Ch[x].insert(lmax[v]),Pa[x].insert(maxs[v]); } int query(){return ans;} void print(int n){ printf(\u0026#34;--------------------\\n\u0026#34;); for(int x = 1;x\u0026lt;=n;x++){ printf(\u0026#34;%d: c:%d %d f:%d | sum:%d len:%d w:%d | max: l:%d r:%d s:%d\\n\u0026#34;,x,c[x][0],c[x][1],f[x],sum[x],len[x],w[x],lmax[x],rmax[x],maxs[x]); printf(\u0026#34;Ch: \u0026#34;); for(auto x : Ch[x]) printf(\u0026#34;%d \u0026#34;,x); printf(\u0026#34;\\n\u0026#34;); printf(\u0026#34;Pa: \u0026#34;); for(auto x : Pa[x]) printf(\u0026#34;%d \u0026#34;,x); printf(\u0026#34;\\n\u0026#34;); } printf(\u0026#34;--------------------\\n\u0026#34;); } }T; void dfs1(int x,int fa){ for(int nowe = fir[x];nowe;nowe = edge[nowe].nex){ int v = edge[nowe].to,l = edge[nowe].len; if(v == fa) continue; T.f[v] = x,T.len[v] = l,dfs1(v,x); T.add(x,v); } T.push_up(x); } int n,q; void init(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n); for(int i = 2;i\u0026lt;=n;i++){ int a,b,c; scanf(\u0026#34;%d %d %d\u0026#34;,\u0026amp;a,\u0026amp;b,\u0026amp;c); addedge(a,b,c),addedge(b,a,c); } T.init(n);dfs1(1,0);T.ans = T.maxs[1]; } void solve(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;q); char op[10];int x; for(int i = 1;i\u0026lt;=q;i++){ scanf(\u0026#34;%s\u0026#34;,op); if(op[0] == \u0026#39;A\u0026#39;){ int ans = T.query(); if(ans \u0026gt;= 0) printf(\u0026#34;%d\\n\u0026#34;,ans); else printf(\u0026#34;They have disappeared.\\n\u0026#34;); }else if(op[0] == \u0026#39;C\u0026#39;) scanf(\u0026#34;%d\u0026#34;,\u0026amp;x),T.modify(x); } } int main(){ init(); solve(); return 0; }   ","description":"","id":41,"section":"posts","tags":["æ•°æ®ç»“æ„","LCT"],"title":"ã€ŒSPOJ2666ã€QTREE4-LCT","uri":"https://blog.chenqiqian.com/posts/spoj2666-qtree4/"},{"content":"å°å¼ºè¦åœ¨ $N$ ä¸ªå­¤ç«‹çš„æ˜Ÿçƒä¸Šå»ºç«‹èµ·ä¸€å¥—é€šä¿¡ç³»ç»Ÿã€‚è¿™å¥—é€šä¿¡ç³»ç»Ÿå°±æ˜¯è¿æ¥ $N$ ä¸ªç‚¹çš„ä¸€ä¸ªæ ‘ã€‚ è¿™ä¸ªæ ‘çš„è¾¹æ˜¯ä¸€æ¡ä¸€æ¡æ·»åŠ ä¸Šå»çš„ã€‚åœ¨æŸä¸ªæ—¶åˆ»ï¼Œä¸€æ¡è¾¹çš„è´Ÿè½½å°±æ˜¯å®ƒæ‰€åœ¨çš„å½“å‰èƒ½å¤Ÿ è”é€šçš„æ ‘ä¸Šè·¯è¿‡å®ƒçš„ç®€å•è·¯å¾„çš„æ•°é‡ã€‚\nç°åœ¨ï¼Œä½ çš„ä»»åŠ¡å°±æ˜¯éšç€è¾¹çš„æ·»åŠ ï¼ŒåŠ¨æ€çš„å›ç­”å°å¼ºå¯¹äºæŸäº›è¾¹çš„è´Ÿè½½çš„è¯¢é—®ã€‚\né“¾æ¥ Luogu P4219\né¢˜è§£ æˆ‘ä»¬å‘ç°å…¶å®å°±æ˜¯è¾¹ä¸¤ç«¯çš„ç‚¹çš„ä¸ªæ•°ä¹˜èµ·æ¥å°±å¯ä»¥äº†ã€‚\næˆ‘ä»¬åœ¨æ™®é€š LCT çš„åŸºç¡€ä¸Šå¤šç»´æŠ¤ä¸€ä¸ª $vsiz$ ï¼Œè¡¨ç¤ºè™šå­æ ‘çš„ $siz$ çš„å¤§å°ä¹‹å’Œã€‚\næˆ‘ä»¬å‘ç°è¿™ä¸ª $vsiz$ çš„ç»´æŠ¤åªéœ€è¦åœ¨ access å’Œ link å‡½æ•°é‡Œé¢å®Œæˆï¼Œåœ¨è¿™ä¸¤ä¸ªå‡½æ•°é‡Œé¢ä¿®æ”¹å¾®å°çš„ä¸€ç‚¹ï¼Œæ³¨æ„è™šå­æ ‘çš„å¢å‡å³å¯ã€‚\nç­”æ¡ˆå°±æ˜¯ä¸¤ä¸ªç‚¹å¯¹åº”çš„è™šå­æ ‘çš„ $vsiz + 1$ å†ä¹˜åˆ°ä¸€èµ·å³å¯ï¼Œå› ä¸ºæŸ¥è¯¢çš„ä¸¤ä¸ªç‚¹æ˜¯è¿åœ¨ä¸€èµ·çš„ã€‚\næ—¶é—´å¤æ‚åº¦ : $O(n \\log n)$\nLCT ç»†èŠ‚ä¸€å®šæ³¨æ„ï¼\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82  #include \u0026lt;bits/stdc++.h\u0026gt;#define ll long long using namespace std; const int MAXN = 110000; namespace LCT{ int c[MAXN][2],f[MAXN],siz[MAXN],vsiz[MAXN];bool r[MAXN]; bool noroot(int x){return c[f[x]][0] == x || c[f[x]][1] == x;} void rev(int x){swap(c[x][0],c[x][1]),r[x]^=1;} void push_down(int x){if(r[x]) rev(c[x][0]),rev(c[x][1]),r[x] = 0;} void push_all(int x){ static int S[MAXN];S[0] = 0; S[++S[0]] = x; while(noroot(x)) x = f[x],S[++S[0]] = x; for(int i = S[0];i\u0026gt;=1;--i) push_down(S[i]); } void push_up(int x){ siz[x] = siz[c[x][0]] + siz[c[x][1]] + vsiz[x] + 1; } void init(int n){for(int i = 1;i\u0026lt;=n;i++) push_up(i);} void rotate(int x){ int y = f[x],z = f[y],t = c[y][1] == x,w = (c[x][1-t]); if(noroot(y)) c[z][c[z][1]==y] = x; c[y][t] = w,c[x][1-t] = y; if(w) f[w] = y; f[y] = x,f[x] = z; push_up(y),push_up(x); } void splay(int x){ push_all(x); while(noroot(x)){ int y = f[x],z = f[y]; if(noroot(y)){ (c[y][1] == x) ^ (c[z][1] == y) ? rotate(x) : rotate(y); }rotate(x); } } void access(int x){ for(int y = 0;x;x = f[y=x]){ splay(x); vsiz[x] += siz[c[x][1]]; vsiz[x] -= siz[c[x][1] = y]; // è€ƒè™‘åˆ°æ–°æ¥ä¸Šæ¥çš„ y çš„ f[y] ä¸€å®šæ˜¯ x ï¼Œ ç›¸å½“äºå‡å»ä¸€å †è™šå­æ ‘  // push_up(x); æˆ‘ä»¬æ³¨æ„åˆ° siz[x] äº‹å®ä¸Šä¸ä¼šå˜  } } void makeroot(int x){access(x),splay(x),rev(x);} void split(int x,int y){makeroot(x),access(y),splay(y);} void link(int x,int y){ split(x,y); f[x] = y,vsiz[y] += siz[x]; push_up(y); } ll query(int x,int y){ split(x,y); ll a = vsiz[x]+1,b = vsiz[y]+1;// éå­æ ‘ siz å°± win äº†  return a * b; } } int n,q; void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;q); LCT::init(n); } void solve(){ for(int i = 1;i\u0026lt;=q;i++){ char s[5];int x,y; scanf(\u0026#34;%s %d %d\u0026#34;,s,\u0026amp;x,\u0026amp;y); if(s[0] == \u0026#39;A\u0026#39;) LCT::link(x,y); else printf(\u0026#34;%lld\\n\u0026#34;,LCT::query(x,y)); } } int main(){ init(); solve(); return 0; }   ","description":"","id":42,"section":"posts","tags":["æ•°æ®ç»“æ„","LCT"],"title":"ã€ŒBJOI2014ã€å¤§èåˆ-LCT","uri":"https://blog.chenqiqian.com/posts/bjoi2014-mixture/"},{"content":"è¾“å…¥é•¿åº¦ä¸º $n$ çš„ä¸² $S$ ï¼Œæ±‚ $S$ çš„æœ€é•¿åŒå›æ–‡å­ä¸² $T$,å³å¯å°† $T$ åˆ†ä¸ºä¸¤éƒ¨åˆ†$X$ ï¼Œ $Y$ ï¼Œ ï¼ˆ $âˆ£Xâˆ£,âˆ£Yâˆ£ \\geq 1$ ï¼‰ä¸” $X$ å’Œ $Y$ éƒ½æ˜¯å›æ–‡ä¸²ã€‚\né“¾æ¥ Luogu P4555\né¢˜è§£ å‡ ä¹æ˜¯æ¨¡ç‰ˆé¢˜ã€‚\næ­£åè·‘ä¸€éå›æ–‡è‡ªåŠ¨æœºï¼Œæ‰¾å‡ºæ¯ä¸ªä½ç½®å¾€ä¸¤ä¸ªæ–¹å‘çš„æœ€é•¿å›æ–‡åç¼€ï¼ŒåŠ èµ·æ¥å°±æ˜¯ç­”æ¡ˆã€‚\næ—¶é—´å¤æ‚åº¦: $O(n)$ ã€‚\næ³¨æ„ $0$ å’Œ a çš„æ··æ·†ï¼ŒåŠ¡å¿…åŠ ä¸Š s[0] = -1 ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41  #include \u0026lt;bits/stdc++.h\u0026gt;using namespace std; const int MAXN = 110000; struct PAM{ int s[MAXN],c[MAXN][26],fa[MAXN],len[MAXN],tcnt,last; void init(){ s[0] = -1; last = 0,tcnt = 1; fa[0] = fa[1] = 1; len[0] = 0,len[1] = -1; } int getfail(int n,int p){ while(s[n-len[p]-1] != s[n]) p = fa[p]; return p; } int ins(int n,int x){// è¿”å›æœ€é•¿å›æ–‡åç¼€é•¿åº¦  s[n] = x; int p = getfail(n,last),\u0026amp;q = c[p][x]; if(!q){ int f = c[getfail(n,fa[p])][x]; q = ++tcnt,len[q] = len[p]+2,fa[q] = f; } last = q; return len[q]; } }A,B; int n;char s[MAXN]; int a[MAXN],b[MAXN]; int main(){ scanf(\u0026#34;%s\u0026#34;,s+1);n = strlen(s+1); A.init(),B.init(); for(int i = 1;i\u0026lt;=n;i++) a[i] = A.ins(i,s[i]-\u0026#39;a\u0026#39;);//,printf(\u0026#34;%d:%d\\n\u0026#34;,i,a[i]);  for(int i = n;i\u0026gt;=1;--i) b[i] = B.ins(n-i+1,s[i]-\u0026#39;a\u0026#39;);//,printf(\u0026#34;%d:%d\\n\u0026#34;,i,b[i]);  int ans = 0; for(int i = 1;i\u0026lt;=n-1;i++) ans = max(ans,a[i]+b[i+1]); printf(\u0026#34;%d\\n\u0026#34;,ans); return 0; }   ","description":"","id":43,"section":"posts","tags":["å­—ç¬¦ä¸²","å›æ–‡è‡ªåŠ¨æœº"],"title":"ã€Œå›½å®¶é›†è®­é˜Ÿã€æœ€é•¿åŒå›æ–‡å­ä¸²-å›æ–‡è‡ªåŠ¨æœº","uri":"https://blog.chenqiqian.com/posts/luogu-4555/"},{"content":"æœ‰ä¸¤ä¸ªå¿«é€’å‘˜ï¼Œåˆ†åˆ«åœ¨ $s_1, s_2(0\\le s_1,s_2\\le 10^9)$ ä½ç½®ã€‚ç°åœ¨æœ‰ $n(1\\le n\\le 100000)$ ä¸ªä»»åŠ¡ï¼Œéœ€è¦ä¾æ¬¡å®Œæˆï¼Œæ¯ä¸ªä»»åŠ¡ç”¨ä¸€ä¸ªæ•´æ•° $x_i$ è¡¨ç¤ºè¦å°†è´§ç‰©é€åˆ° $x_i$ ä½ç½®ï¼Œè®©ä»»ä½•ä¸€ä¸ªå¿«é€’å‘˜åˆ° $x_i$ éƒ½å¯ä»¥ã€‚\nç”±äºå¿«é€’å‘˜ä¹‹é—´éœ€è¦æœ‰å¯¹è®²æœºè”ç³»ï¼Œè¯·ä½ è®¾è®¡ä¸€ç§æ–¹æ¡ˆä½¿å¾—ä¸¤ä¸ªå¿«é€’å‘˜ä¹‹é—´çš„æœ€é•¿è·ç¦»æœ€çŸ­ã€‚\né“¾æ¥ Codeforces\né¢˜è§£ æˆ‘ä»¬è€ƒè™‘äºŒåˆ†ï¼Œç„¶åé—®é¢˜å°±å˜æˆäº†ä½ èƒ½ä¸èƒ½åœ¨äºŒåˆ†çš„é™åˆ¶æ¡ä»¶ $M$ çš„é—´è·å†…å®Œæˆè¿™ä¸ªé—®é¢˜ã€‚\næˆ‘ä»¬è€ƒè™‘è´ªå¿ƒçš„è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å¦‚æœæˆ‘ä»¬ä»¤ $[l_i,r_i]$ æ˜¯åœ¨èµ°åˆ°ç¬¬ $i$ ä¸ªä¹‹å‰çš„æ—¶å€™ï¼Œå­˜åœ¨åˆæ³•æ–¹æ¡ˆå½“ä¸”ä»…å½“å­˜åœ¨å¿«é€’å‘˜ä½äº $[l_i,r_i]$ è€Œä¸”ä¸¤ä¸ªå¿«é€’å‘˜ä¹‹é—´è·ç¦»ä¸è¶…è¿‡ $M$ ï¼ˆè¿™æ ·ä¸¤ä¸ªå¿«é€’å‘˜éƒ½å¯ä»¥ç§»åŠ¨ï¼‰ã€‚\næˆ‘ä»¬å‘ç° $[l_n,r_n]$ åº”è¯¥æ˜¯ $[x_n-M,x_n+M]$ ï¼ˆæ¯”è¾ƒæ˜¾ç„¶ï¼‰ã€‚\né‚£ä¹ˆï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å·²ç»æœ‰äº† $[l_{i+1},r_{i+1}]$ ï¼Œæˆ‘ä»¬å¦‚ä½•æ¨å‡º $[l_{i},r_i]$ å‘¢ï¼Ÿ\næˆ‘ä»¬è€ƒè™‘åˆ°è¿›è¡Œå®Œç¬¬ $i$ ä¸ªä»»åŠ¡ä¹‹åï¼Œå¿…ç„¶ä¼šæœ‰ä¸€ä½è€å“¥ä½äº $x_i$ ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å¦‚æœ $x_i$ åœ¨ $[l_{i+1},r_{i+1}]$ ä¹‹é—´ï¼Œæˆ‘ä»¬åªéœ€è¦æ»¡è¶³ä¿è¯åœ¨æŸè€å“¥èµ°çš„æ—¶å€™ç¬¬äºŒä¸ªæ¡ä»¶æ—¶åˆ»æ»¡è¶³å³å¯ï¼šä¹Ÿå°±æ˜¯ $l_i = x_i - M,r_i = x_i+M$ ã€‚ ä¸ºä»€ä¹ˆè¿™ä¸ªæ˜¯å¯¹çš„å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå¦‚æœä¸€ä½è€å“¥åœ¨è¿™ä¸ªåŒºé—´é‡Œé¢ï¼Œç„¶åå‰©ä¸‹ä¸€ä½è€å“¥æ— è®ºåœ¨å“ªä¸€å®šå¯ä»¥åœ¨æ»¡è¶³ $M$ çš„é™åˆ¶ä¹‹ä¸‹åˆ°è¾¾ $x_i$ ï¼Œç„¶åæˆ‘ä»¬ä¸‹ä¸€è½®ä¹Ÿå°±æ˜¯winçš„äº†ã€‚\né‚£å¦‚æœ $x_i$ ä¸åœ¨ $[l_{i+1},r_{i+1}]$ ä¸­å‘¢ï¼Ÿé‚£æˆ‘ä»¬è€ƒè™‘æœ‰ä¸€ä½è€å“¥å°±å¿…é¡»åœ¨ $[l_{i+1},r_{i+1}]$ ä¸­ï¼ˆå› ä¸ºä»–å¿…ç„¶ä¸åŠ¨ï¼‰ï¼Œä½†æ˜¯ä»–æ‰€åœ¨çš„ä½ç½®è¿˜å¾—æ»¡è¶³èƒ½å¤Ÿè®©å¦ä¸€ä½è€å“¥èµ°åˆ° $x_i$ ä¹Ÿèƒ½å’Œä»–ä¿æŒè”ç³»ï¼Œæ‰€ä»¥ä»–å¿…é¡»åœ¨ $[x_i-M,x_i+M]$ã€‚è¿™ä¸¤ä¸ªåŒºé—´æ±‚äº¤ä¹‹åå°±æ˜¯ç­”æ¡ˆã€‚\næœ€ååˆ¤ä¸€ä¸‹ $[l_1,r_1]$ å°±å¯ä»¥äº†ã€‚\næ—¶é—´å¤æ‚åº¦ï¼š $O(n \\log C)$\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26  #include \u0026lt;bits/stdc++.h\u0026gt;using namespace std; const int MAXN = 110000; int n,s1,s2,x[MAXN]; bool check(int M){ int L = x[n]-M,R = x[n]+M; for(int i = n-1;i\u0026gt;=1;--i){ if(L \u0026lt;= x[i] \u0026amp;\u0026amp; x[i] \u0026lt;= R) L = x[i] - M,R = x[i] + M; else L = max(L,x[i]-M),R = min(R,x[i]+M); } return (L \u0026lt;= s1 \u0026amp;\u0026amp; s1 \u0026lt;= R) || (L \u0026lt;= s2 \u0026amp;\u0026amp; s2 \u0026lt;= R); } int main(){ scanf(\u0026#34;%d %d %d\u0026#34;,\u0026amp;n,\u0026amp;s1,\u0026amp;s2); for(int i = 1;i\u0026lt;=n;i++) scanf(\u0026#34;%d\u0026#34;,\u0026amp;x[i]); int L = abs(s1-s2),R = 1e9; while(L!=R){int mid = (L+R)/2; if(check(mid)) R = mid; else L = mid+1; } printf(\u0026#34;%d\\n\u0026#34;,L); }   ","description":"","id":44,"section":"posts","tags":["è´ªå¿ƒ"],"title":"ã€ŒCF875Eã€Delivery Club-äºŒåˆ†+è´ªå¿ƒ","uri":"https://blog.chenqiqian.com/posts/cf875e/"},{"content":"ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„ $01$ åºåˆ—ï¼Œç¬¬ $i$ ä½æ˜¯ $0$ ä»£è¡¨ èŠ‚ç‚¹ $i$ åˆ°èŠ‚ç‚¹ $i \\bmod n + 1$ æœ‰ä¸€æ¡æœ‰å‘è¾¹ï¼Œç¬¬ $i$ ä½æ˜¯ $1$ ä»£è¡¨ èŠ‚ç‚¹ $i \\bmod n + 1$ åˆ°èŠ‚ç‚¹ i æœ‰ä¸€æ¡æœ‰å‘è¾¹ã€‚\næˆ‘ä»¬ç§°ä¸€ä¸ªèŠ‚ç‚¹å¯¹ $(u,v)$ æ˜¯å¦™çš„å½“ä¸”ä»…å½“ä¸å­˜åœ¨ $u$ åˆ° $v$ å’Œ $v$ åˆ° $u$ çš„è·¯å¾„ä»»ä½•ä¸¤è€…ä¹‹ä¸€ã€‚\nç°åœ¨ä½ è¦ä»è¿™ä¸ªå›¾é‡Œé¢æŒ‘å‡ºä¸€ä¸ªé›†åˆï¼Œä½¿å¾—é›†åˆä¸­ä»»æ„ä¸¤ä¸ªä¸åŒçš„èŠ‚ç‚¹ $u$ å’Œ $v$ ä¹‹é—´æ„æˆçš„èŠ‚ç‚¹å¯¹ $(u,v)$ éƒ½æ˜¯å¦™çš„ã€‚\nè¯·ä½ è¾“å‡ºè¿™ä¸ªé›†åˆçš„å¤§å°çš„æœ€å¤§å€¼ã€‚\né“¾æ¥ Codeforces\né¢˜è§£ ä¸ä¼šåšï¼Œçœ‹äº†é¢˜è§£ä¹Ÿä¸ä¼šåš\u0026hellip;çœ‹æ‡‚é¢˜è§£æ˜¯ä¸å¯èƒ½çœ‹æ‡‚çš„ï¼Œåªå¥½å»çœ‹çœ‹ä»£ç è¿‡è¿‡æ—¥å­ã€‚\näºæ˜¯ç ”ç©¶äº†ä¸€ç•ª rng_58 çš„ä»£ç ï¼Œå¤§æ¦‚ææ‡‚äº†è¿™ä¸ªé¢˜ã€‚\næˆ‘ä»¬æŠŠè¿™ $n$ ä¸ªç‚¹å¤åˆ¶ä¸€å€ï¼Œæ”¾åœ¨ä¸€æ¡ç›´çº¿ä¸Šã€‚æˆ‘ä»¬æŠŠå…·æœ‰ç›¸åŒæ–¹å‘çš„ç§°ä¸ºä¸€ä¸ªè¿ç»­æ®µï¼Œå…¶é•¿åº¦ä¸ºè¿ç»­çš„è¾¹çš„æ•°é‡ï¼Œç„¶åæˆ‘ä»¬æ‰¾åˆ°ä¸€ä¸ªä½ç½®åˆ‡æ‰è¿™ä¸ªåºåˆ—ï¼Œç›¸å½“äºæ–­ç¯ä¸ºé“¾ï¼Œç„¶åæˆ‘ä»¬å‘ç°è¿™ä¸ªä¸œè¥¿å¯ä»¥è´ªå¿ƒè§£å†³äº†ã€‚\næˆ‘ä»¬å¦‚æœé‡åˆ°ä¸€ä¸ªé•¿åº¦å¤§äºç­‰äº 2 çš„ï¼Œæˆ‘ä»¬å°±æŠŠç­”æ¡ˆ + 1ï¼Œç„¶ååœ¨ä¸¤ä¸ªé•¿åº¦å¤§äºç­‰äº 2 çš„ä¹‹é—´ï¼Œå…¨éƒ½æ˜¯é•¿åº¦å¤§äºç­‰äº 1 çš„ï¼Œæˆ‘ä»¬å‘ç°è¿™æ ·çš„è¯ï¼Œä¸ºäº†ä¸å½±å“åˆ°é•¿åº¦å¤§äºç­‰äº 2 çš„ï¼Œæˆ‘ä»¬èƒ½å–çš„ä¸ªæ•°å°±æ˜¯ $\\frac{len}{2}$ ã€‚ç„¶åå°±å¯ä»¥è®¡ç®—ç­”æ¡ˆäº†ã€‚\nå¦‚æœä¸å­˜åœ¨é•¿åº¦å¤§äºç­‰äº 2 çš„åºåˆ—ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ç­”æ¡ˆå°±æ˜¯ $\\frac{n}{2}$\nè´ªå¿ƒçš„å»æƒ³ä¸€æƒ³ï¼Œå¾ˆæœ‰æ­£ç¡®çš„é“ç†ã€‚\næ—¶é—´å¤æ‚åº¦ï¼š $O(n)$\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45  #include \u0026lt;bits/stdc++.h\u0026gt;#define ui unsigned using namespace std; ui n,st; string s,t; int main(){ cin \u0026gt;\u0026gt; s;n = s.length(); s = s+s; for(ui i = 1;i\u0026lt;s.length();i++){ if(s[i] != s[i-1]){st = i;break;} } s = s.substr(st,n); int ans = 0; for(ui i = 0;i \u0026lt; s.length();){ for(ui j = i+1;;j++){ if(j == s.length() || s[j] != s[i]){ t.push_back(j - i == 1?\u0026#39;1\u0026#39;:\u0026#39;2\u0026#39;); i = j; break; } } } int M = t.length(); t = t + t; for(int i = 1;i\u0026lt;=M;i++){ if(i == M || t[i] != t[i-1]){ t = t.substr(i,M); break; } } for(ui i = 0;i\u0026lt;t.length();){ for(ui j = i+1;;j++){ if(j == t.length() || t[j] != t[i]){ ans += (j-i) / (t[i]==\u0026#39;1\u0026#39;?2:1); i = j; break; } } } cout \u0026lt;\u0026lt; ans \u0026lt;\u0026lt; endl; return 0; }   ","description":"","id":45,"section":"posts","tags":["ä¹±æ"],"title":"ã€ŒCF353Eã€ Antichain-ä¹±æ","uri":"https://blog.chenqiqian.com/posts/cf353e/"},{"content":"ä¸€æ£µæ ‘ä¸Šæœ‰ $n$ ä¸ªèŠ‚ç‚¹ï¼ŒæŠŠæ¯ä¸ªèŠ‚ç‚¹æŸ“æˆé»‘è‰²æˆ–ç™½è‰²ï¼Œè¦æ±‚å¶å­èŠ‚ç‚¹ä¸€åŠæ˜¯é»‘è‰²ï¼Œä¸€åŠæ˜¯ç™½è‰²ï¼ˆä¿è¯å¶å­èŠ‚ç‚¹çš„ä¸ªæ•°æ˜¯å¶æ•°ï¼‰ã€‚\næ±‚åœ¨æ»¡è¶³è¦æ±‚çš„æƒ…å†µä¸‹ï¼Œæœ€å°çš„ä¸¤ç«¯é¢œè‰²ä¸åŒçš„è¾¹çš„æ•°é‡ã€‚\né“¾æ¥ Codeforces\né¢˜è§£ æˆ‘ä»¬è€ƒè™‘æ ‘å½¢dpï¼Œä»¤ $dp[x][v][0/1]$ è¡¨ç¤ºèŠ‚ç‚¹ $x$ ä»£è¡¨çš„å­æ ‘é‡Œé¢ï¼Œä¸ºç™½è‰²çš„å¶å­èŠ‚ç‚¹æœ‰ $v$ ä¸ªï¼Œ$x$ èŠ‚ç‚¹çš„é¢œè‰²æ˜¯ç™½è‰²ï¼ˆ0ï¼‰è¿˜æ˜¯é»‘è‰²ï¼ˆ1ï¼‰çš„æƒ…å†µä¸‹ï¼Œæœ€å°çš„ä¸¤ç«¯é¢œè‰²ä¸åŒçš„è¾¹çš„æ•°é‡ã€‚\nç„¶åæˆ‘ä»¬å¯ä»¥ç”¨é‚£ç§ $O(n^2)$ å®Œæˆæ ‘å½¢ dp çš„å¥—è·¯å»æå®ƒå°±å¯ä»¥äº†ã€‚\nç„¶åè½¬ç§»çš„æ—¶å€™è¿˜è¦æšä¸¾ç¬¬ä¸‰ç»´æ˜¯ 0 è¿˜æ˜¯ 1 ï¼Œç„¶åè®¡ç®—è´¡çŒ®ï¼Œä¸è¦å¿˜æ‰ï¼ˆ\nè¿™ä¸ªè·Ÿæ™®é€šçš„æ ‘å½¢dpä¸å¤ªä¸€æ ·ï¼Œéœ€è¦åœ¨å¼€å§‹çš„æ—¶å€™å¤šç‰¹æ®Šåˆ¤æ–­ä¸€äº›ï¼Œè€Œä¸”ä½ åŠ å…¥å­æ ‘æ›´æ–°dpæ•°ç»„çš„æ—¶å€™ä¸èƒ½é—ä¼ è¿™ä¸ªæ•°ç»„ï¼Œåªèƒ½ç”¨æ–°ç®—å‡ºæ¥çš„æ•°æ¥æ›´æ–°ã€‚\næ—¶é—´å¤æ‚åº¦ï¼š$O(n^2)$\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77  #include \u0026lt;bits/stdc++.h\u0026gt;using namespace std; const int MAXN = 5100; struct Edge{ int to,nex; }edge[MAXN*2]; int fir[MAXN],ecnt = 2; void addedge(int a,int b){ edge[ecnt] = (Edge){b,fir[a]}; fir[a] = ecnt++; } int n; int in[MAXN],siz[MAXN],sum,rt = 0; int dp[MAXN][MAXN][2];// dp[x][v][0/1] v ä¸ªç™½è‰²çš„ void dfs(int x,int fa){ if(in[x] == 1){ siz[x] = 1,dp[x][1][0] = 0,dp[x][0][1] = 0; return; } int f = 0; for(int nowe = fir[x];nowe;nowe = edge[nowe].nex){ int v = edge[nowe].to; if(v == fa) continue; dfs(v,x); if(f == 0){ for(int k = 0;k \u0026lt;= siz[v];k++){ dp[x][k][1] = min(dp[v][k][0]+1,dp[v][k][1]); dp[x][k][0] = min(dp[v][k][1]+1,dp[v][k][0]); } } else{ for(int j = siz[v] + siz[x];j \u0026gt;= 0;j--){ int tmp[2] = {0x3f3f3f3f,0x3f3f3f3f}; for(int k = 0;k \u0026lt;= min(j,siz[v]);k++){ // dp[x][j-k] ä¸ dp[v][k] ä¹‹é—´çš„ç¢°æ’å’Œæ¿€æƒ…  tmp[1] = min(tmp[1],dp[x][j-k][1] + min(dp[v][k][0]+1,dp[v][k][1])); tmp[0] = min(tmp[0],dp[x][j-k][0] + min(dp[v][k][1]+1,dp[v][k][0])); } dp[x][j][0] = tmp[0],dp[x][j][1] = tmp[1]; } } f = 1; siz[x] += siz[v]; } } void init(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n); for(int i = 2;i\u0026lt;=n;i++){ int a,b; scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;a,\u0026amp;b); addedge(a,b),addedge(b,a); in[a]++,in[b]++; } for(int i = 1;i\u0026lt;=n;i++){ if(in[i] == 1) sum++; if(in[i] \u0026gt; in[rt]) rt = i; } } void solve(){ if(n == 2){printf(\u0026#34;1\\n\u0026#34;);return;} memset(dp,0x3f,sizeof(dp)); dfs(rt,0); printf(\u0026#34;%d\\n\u0026#34;,min(dp[rt][sum/2][0],dp[rt][sum/2][1])); } int main(){ init(); solve(); return 0; }   ","description":"","id":46,"section":"posts","tags":["åŠ¨æ€è§„åˆ’","æ ‘å½¢dp"],"title":"ã€ŒCF581Fã€ Zublicanes and Mumocrates - æ ‘å½¢dp","uri":"https://blog.chenqiqian.com/posts/cf581f/"},{"content":"æˆ‘ä»¬å®šä¹‰\n$$\nJ(x) = \\sum_{d | x} [\\gcd(x,\\frac{x}{d}) = 1] d\n$$\nè¯·ä½ æ±‚å‡º $J(x) = A$ æœ‰å¤šå°‘ä¸ª $x$ æ»¡è¶³æ¡ä»¶ã€‚\né“¾æ¥ Codeforces\né¢˜è§£ æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œè¿™ä¸ª $J(x)$ æ˜¯ä¸€ä¸ªç§¯æ€§å‡½æ•°ã€‚\næ‰€ä»¥å¦‚æœ $x = {p_1}^{k_1}{p_2}^{k_2}\\cdots{p_m}^{k_m}$ ï¼Œé‚£ä¹ˆ $J(x) = J({p_1}^{k_1})J({p_2}^{k_2})\\cdots J({p_m}^{k_m}) = ({p_1}^{k_1}+1)({p_2}^{k_2}+1)({p_m}^{k_m}+1)$\næ‰€ä»¥é—®é¢˜å˜æˆäº†æˆ‘ä»¬æœ‰å¤šå°‘ç§å¯¹ $A$ å½¢å¦‚ä¸Šé¢å½¢å¼çš„ä¸åŒåˆ†è§£ã€‚\næˆ‘ä»¬è€ƒè™‘æ±‚å‡ºæ‰€æœ‰ $A$ çš„çº¦æ•°ï¼Œè®°ä¸º $d_1,d_2,\u0026hellip;,d_n$ ã€‚æˆ‘ä»¬è€ƒè™‘å“ªäº› $p$ å¯èƒ½ç”¨æ¥ç»„æˆ $A$ ã€‚å¦‚æœ $p$ å¯ä»¥è¢«ç”¨æ¥ç»„æˆ $A$ ï¼Œé‚£ä¹ˆ $A$ çš„çº¦æ•°é‡Œé¢è‚¯å®šå­˜åœ¨ä¸€ä¸ªçº¦æ•°å‡å» $1$ ä¹‹åæ˜¯ $p$ çš„è‹¥å¹²æ¬¡æ–¹ã€‚\næˆ‘ä»¬æŠŠæ‰€æœ‰çš„çº¦æ•°å‡å» $1$ ä¹‹åç›´æ¥åˆ†è§£è´¨å› æ•°ï¼Œè¿™ä¸ªè¿‡ç¨‹çš„å¤æ‚åº¦å¤§æ¦‚æ˜¯ï¼š\n$$\n\\sqrt 1 + \\sqrt 2 + \u0026hellip; + \\sqrt{\\sqrt{n}} + \\sqrt \\frac{n}{1} + \\sqrt{\\frac{n}{2}} + \u0026hellip; + \\sqrt{\\frac{n}{n}}\n$$\nä¸ä¼šè¯æ˜ï¼Œä½†å¯ä»¥è¿‡å§ï¼ˆ\nç„¶åæˆ‘ä»¬å°±å¾—åˆ°äº†æ‰€æœ‰å¯ä»¥ç»„æˆ A çš„è´¨æ•° $p_1,\u0026hellip;,p_k$ï¼Œè¿™æ ·çš„è´¨æ•°ä¸ä¼šå¾ˆå¤šï¼Œæˆ‘ä»¬å‘ç°è¿™æ ·çš„è´¨æ•°ä¸ä¼šè¶…è¿‡ $\\sigma_0(n) \\approx \\sqrt[3]{n}$ ã€‚\næˆ‘ä»¬è€ƒè™‘ $dp$ , ä»¤ $dp[i][j]$ è¡¨ç¤ºä½¿ç”¨å‰ $i$ ä¸ªè´¨æ•°æ‹¼å‡ºæ¥ç¬¬ $j$ ä¸ªçº¦æ•°çš„æ–¹æ¡ˆæ•°ã€‚\nè½¬ç§»çš„è¯ï¼Œæ¯æ¬¡åŠ å…¥ä¸€ä¸ªè´¨æ•°ï¼Œå¯¹äºæ‰€æœ‰çš„ $j$ï¼Œæˆ‘ä»¬éƒ½ä¹˜ä¸Šè¿™ä¸ªè´¨æ•°è‹¥å¹²æ¬¡ï¼Œç„¶åæ›´æ–°ç­”æ¡ˆã€‚ä»€ä¹ˆï¼Ÿä½ è¯´å¤æ‚åº¦ï¼Ÿä¸ä¼šè¯ä¸ä¼šè¯ï¼Œåæ­£èƒ½è¿‡å°±è¡Œï¼ˆ\næœ€å $dp[k][n]$ å°±æ˜¯ç­”æ¡ˆã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49  #include \u0026lt;bits/stdc++.h\u0026gt;#define ll long long using namespace std; const int MAXN = 10000; ll A; ll p[MAXN],k,d[MAXN],n; map\u0026lt;ll,int\u0026gt; div_pos;set\u0026lt;ll\u0026gt; vis; ll dp[MAXN];// æ»šåŠ¨æ•°ç»„  int main(){ cin \u0026gt;\u0026gt; A; for(ll i = 1;i*i\u0026lt;=A;i++) if(A % i == 0){ d[++n] = i; if(i * i != A) d[++n] = A/i; } sort(d + 1,d + n + 1); // for(int i = 1;i\u0026lt;=n;i++){  // printf(\u0026#34;%d:%lld\\n\u0026#34;,i,d[i]);  // }  for(int t = 1;t\u0026lt;=n;t++){ ll x = d[t]; div_pos[x] = t;x -= 1; bool flag = 0; for(ll i = 2;i * i \u0026lt;= x;i++){ if(x % i == 0){ flag = 1; while(x % i == 0) x /= i; if(x == 1 \u0026amp;\u0026amp; !vis.count(i)) p[++k] = i,vis.insert(i); break; } } if(flag == 0 \u0026amp;\u0026amp; x \u0026gt; 1 \u0026amp;\u0026amp; !vis.count(x)) p[++k] = x,vis.insert(x); } sort(p+1,p+k+1); dp[1] = 1; for(int i = 1;i\u0026lt;=k;i++){ for(int j = n;j\u0026gt;=1;j--){ if(dp[j] == 0) continue; for(ll w = p[i];log2(d[j]) + log2(w+1) \u0026lt;= log2(1.5*A);w *= p[i]){ if(div_pos.count(d[j]*(w+1))){ dp[div_pos[d[j]*(w+1)]] += dp[j]; } } } } printf(\u0026#34;%lld\\n\u0026#34;,dp[n]); return 0; }   ","description":"","id":47,"section":"posts","tags":["åŠ¨æ€è§„åˆ’","æ•°å­¦"],"title":"ã€ŒCF542Dã€Superhero's Job - dp + æ•°è®º","uri":"https://blog.chenqiqian.com/posts/cf542d/"},{"content":"  Stay simple. Stay naÃ¯ve.\nè‡ªæ­Œè‡ªèˆè‡ªå¼€æ€€ã€‚\n æ­å–œä½ ï¼å‘ç°äº†ä¸€ä¸ªè’Ÿè’»çš„å°ç«™ã€‚\ncqqqwq æ˜¯æŸé«˜ä¸­å¼€å§‹å­¦ OI çš„è’Ÿè’»ï¼Œç°å·²è·³å…¥è®¡ç®—æœºå¤©å‘ã€‚\næ›¾å°±è¯»äºåŒ—äº¬å¸‚ç¬¬ä¸€ä¸ƒäºŒä¸­å­¦ï¼Œç°å°±è¯»äºäº”é“å£èŒä¸šæŠ€å·¥å­¦æ ¡ã€‚\ncqqqwq ä¸å®šæœŸæ›´æ–°åšå®¢ï¼Œä¸»è¦å†…å®¹åŒ…æ‹¬æ—¥å¸¸ã€ç®—æ³•ã€é¢˜è§£ã€‚\n","description":"cqqqwqçš„è‡ªæˆ‘ä»‹ç»ã€‚","id":48,"section":"","tags":null,"title":"å…³äºæˆ‘","uri":"https://blog.chenqiqian.com/about/"},{"content":"ç»™å®šä¸€ä¸ªå«æœ‰ $n$ ä¸ªç‚¹ï¼Œ $m$ æ¡è¾¹çš„æ£®æ—ã€‚æœ‰ $q$ ä¸ªè¯¢é—®ï¼Œæ¯æ¬¡ç»™å‡ºä¸¤ä¸ªç‚¹ $u_i,v_i$ ï¼Œå¦‚æœ $u_i$ åœ¨è”é€šå— $A$ å†…ï¼Œ$v_i$ åœ¨è”é€šå— $B$ å†…ï¼Œæˆ‘ä»¬éšæœºé€‰æ‹©ä¸¤ä¸ªç‚¹ $a \\in A,b \\in B$ ï¼Œæˆ‘ä»¬åœ¨ $(a,b)$ ä¹‹é—´è¿ä¸€æ¡è¾¹ï¼Œå¦‚æœè¿™ä¸ªè¿æ¥æˆåæ–°è”é€šå—ä¸æ„æˆä¸€ä¸ªæ ‘ï¼Œè¾“å‡º $-1$ ï¼Œå¦åˆ™è¾“å‡ºæ–°è”é€šå—æ ‘çš„ç›´å¾„çš„æœŸæœ›ã€‚æ‰€æœ‰è¾¹æƒå‡ä¸º $1$ ã€‚\né“¾æ¥ Codeforces\né¢˜è§£ å¦‚æœ $u,v$ åœ¨åŒä¸€ä¸ªè”é€šå—é‡Œé¢ï¼Œè¾“å‡º $-1$ ã€‚\næˆ‘ä»¬æœ‰ä¸€ä¸ªç»“è®ºï¼šæˆ‘ä»¬è¿æ¥ $a,b$ ä¸¤ç‚¹æ—¶ï¼Œæˆ‘ä»¬çš„ç›´å¾„åªå¯èƒ½æœ‰ä¸¤ç§å¯èƒ½ï¼š\n $\\max($ $A$ è”é€šå—çš„ç›´å¾„ï¼Œ$B$ è”é€šå—çš„ç›´å¾„ $)$ $a$ ç‚¹å‡ºå‘çš„æœ€é•¿è·¯å¾„ + $b$ ç‚¹å‡ºå‘çš„æœ€é•¿è·¯å¾„ + 1 ï¼ˆå„è”é€šå—å†…ï¼‰  æˆ‘ä»¬è€ƒè™‘ç¬¬ä¸€ä¸ªå¾ˆå¥½æ±‚ï¼Œè®¾å…¶ä¸º $D$ã€‚é‚£ä¹ˆæˆ‘ä»¬çš„ç­”æ¡ˆå°±æ˜¯ï¼š\n$$\nans_i = \\frac{1}{siz[A] \\times siz[B]}\\sum_{a \\in A,b \\in B} max(D,d(a) + d(b) + 1)\n$$\næˆ‘ä»¬ä»¤ $d(a) + d(b) + 1 \u0026gt;= D$ çš„æ•°å¯¹ $(a,b)$ çš„æ•°ç›®ä¸º $cnt_i$ ï¼Œå…¶ï¼ˆ$d(a) + d(b) + 1$ï¼‰å’Œä¸º $sum_i$ ï¼Œé‚£ä¹ˆåŒ–ç®€ä¹‹åï¼š\n$$\nans_i = \\frac{D \\times (siz[A] \\times siz[B]-cnt_i) + sum_i}{siz[A] \\times siz[B]}\n$$\næˆ‘ä»¬ç°åœ¨åªéœ€è¦æ±‚å‡º $cnt_i$ å’Œ $sum_i$ ã€‚\næ¥ä¸‹æ¥å°±æ˜¯ç„å¹»çš„è¿‡ç¨‹äº†ã€‚\næˆ‘ä»¬ä»¤ä¸¤ä¸ªè”é€šå—ä¸­æ¯”è¾ƒå°çš„è”é€šå—ä¸º $A$ ï¼Œå¦ä¸€ä¸ªä¸º $B$ï¼Œæˆ‘ä»¬è®¡ç®— $d$ æ•°ç»„å‰ç¼€å’Œä¹‹åç”¨äºŒåˆ†çš„åŠæ³•è®¡ç®—ç­”æ¡ˆï¼Œå¤æ‚åº¦åº”å½“æ˜¯ $O(siz[A] * log(siz[B]))$ï¼ˆå¹¶ä¸”ç”¨ map è¿›è¡Œè®°å¿†åŒ–ï¼‰ã€‚\nå¦‚æœ $siz[A] \u0026lt; \\sqrt n$ ï¼Œé‚£ä¹ˆæˆ‘ä»¬å•æ¬¡è¯¢é—®çš„å¤æ‚åº¦ä¸ä¼šè¶…è¿‡ $O(\\sqrt n \\log n)$ ï¼Œæ€»ä½“å¤æ‚åº¦æ˜¯ $O(q \\sqrt n \\log n)$ ã€‚\nå¦åˆ™ $siz[A] \u0026gt; \\sqrt n$ï¼Œé‚£ä¹ˆæˆ‘ä»¬è®°å¿†åŒ–ä¹‹åï¼Œæˆ‘ä»¬æ³¨æ„åˆ°æ»¡è¶³ $siz[A] \u0026gt; \\sqrt n$ çš„æ ‘åªä¼šæœ‰å°‘äº $\\sqrt n$ ä¸ªï¼Œæ‰€ä»¥æˆ‘ä»¬æ¯ä¸ª$siz[A]$ æœ€å¤šè¢«è®¡ç®— $O(\\sqrt n)$ æ¬¡ï¼Œæ‰€ä»¥å°±å¯ä»¥åšåˆ° $O(\\sum siz[A] * \\sqrt n\\log n)$ ï¼Œä¹Ÿå°±æ˜¯ $O(n \\sqrt n \\log n)$ã€‚\næ‰€ä»¥æœ€åçš„æ—¶é—´å¤æ‚åº¦å°±æ˜¯ $O((n+q) \\sqrt n \\log n)$ ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114  #include \u0026lt;bits/stdc++.h\u0026gt;#define ll long long #define db double using namespace std; const int MAXN = 110000; struct Edge{ int to,nex; }edge[MAXN*2]; int fir[MAXN],ecnt = 2; void addedge(int a,int b){ edge[ecnt] = (Edge){b,fir[a]}; fir[a] = ecnt++; } int n,m,q; int R[MAXN]; vector\u0026lt;int\u0026gt; d[MAXN]; vector\u0026lt;ll\u0026gt; s[MAXN]; int tmp[MAXN]; int dis[MAXN],vis[MAXN],col[MAXN],cnt; int maxid; void dfs(int nown,bool is_it_rated = 0,int f = 0){ if(dis[nown] \u0026gt; dis[maxid]) maxid = nown; for(int nowe = fir[nown];nowe;nowe = edge[nowe].nex){ int v = edge[nowe].to; if(v == f) continue; dis[v] = dis[nown] + 1; dfs(v,is_it_rated,nown); } if(is_it_rated){ vis[nown] = 1,col[nown] = cnt; tmp[nown] = max(tmp[nown],dis[nown]); } } void getv(int nown,int f = 0){ d[cnt].push_back(tmp[nown]); for(int nowe = fir[nown];nowe;nowe = edge[nowe].nex){ int v = edge[nowe].to; if(v == f) continue; getv(v,nown); } } void init(){ scanf(\u0026#34;%d %d %d\u0026#34;,\u0026amp;n,\u0026amp;m,\u0026amp;q); for(int i = 1;i\u0026lt;=m;i++){ int u,v; scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;u,\u0026amp;v); addedge(u,v),addedge(v,u); } } void cal(int x){ ++cnt; d[cnt].push_back(-1e9); int u,v; maxid = 0,dis[x] = 0,dfs(x);u = maxid; dis[u] = 0,dfs(u);v = maxid; R[cnt] = dis[v]; dis[u] = 0,dfs(u,1);dis[v] = 0,dfs(v,1); getv(x); sort(d[cnt].begin(),d[cnt].end()); s[cnt].resize(d[cnt].size()); s[cnt][0] = 0; for(unsigned i = 1;i\u0026lt;s[cnt].size();i++) s[cnt][i] = s[cnt][i-1] + d[cnt][i]; } void build(){ dis[0] = -1; for(int i = 1;i\u0026lt;=n;i++){ if(vis[i] == 0) cal(i); } } map\u0026lt;pair\u0026lt;int,int\u0026gt;,double\u0026gt; S; double query(int u,int v){ u = col[u],v = col[v]; if(d[u].size() \u0026gt; d[v].size()) swap(u,v); if(S.count(make_pair(u,v))) return S[make_pair(u,v)]; int D = max(R[u],R[v]); ll us = (int)(d[u].size())-1,vs = (int)(d[v].size())-1; double cnt = 0,sum = 0; for(int i = 1;i \u0026lt;= us;i++){ int T = D - d[u][i] - 1;// åªè¦å¤§äºç­‰äº T å°±å¯ä»¥ç®— cnt  int t = lower_bound(d[v].begin(),d[v].end(),T) - d[v].begin(); cnt += db(vs-t+1),sum += db(s[v][vs] - s[v][t-1]) + db(vs-t+1) * (d[u][i]+1); } return S[make_pair(u,v)] = (db(D)*(us*vs-cnt)+sum) / (us*vs); } void solve(){ for(int i = 1;i\u0026lt;=q;i++){ int u,v; scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;u,\u0026amp;v); if(col[u] == col[v]) printf(\u0026#34;-1\\n\u0026#34;); else printf(\u0026#34;%.10lf\\n\u0026#34;,query(u,v)); } } signed main(){ init(); build(); solve(); return 0; }   ","description":"","id":49,"section":"posts","tags":["ä¹±æ","æ ‘çš„ç›´å¾„"],"title":"ã€ŒCF804Dã€Expected diameter of a tree-æ ‘çš„ç›´å¾„+ä¹±æ","uri":"https://blog.chenqiqian.com/posts/cf804d/"},{"content":"ç»™å®š $n$ ä¸ªé•¿åº¦å‡ä¸º $m$ çš„å­—ç¬¦ä¸²ï¼Œå†ç»™å‡ºä¸€ä¸ª $n$ è¡Œ $m$ åˆ—çš„çŸ©é˜µ ${a_{nm}}$ã€‚\nçŸ©é˜µå…ƒç´  $a_{ij}$ ä»£è¡¨æŠŠç¬¬ $i$ ä¸ªå­—ç¬¦ä¸²ç¬¬ $j$ ä¸ªå­—ç¬¦æ”¹æˆå…¶å®ƒä»»æ„å­—ç¬¦æ‰€éœ€è¦çš„ä»£ä»·ã€‚\nç°åœ¨è¦æ±‚å¯¹äºä»»æ„ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ€»å­˜åœ¨æŸä¸€ä½ç½® $j$ ä½¿å¾—è¯¥ä½ç½®ä¸Šçš„å­—ç¬¦åœ¨ä»»æ„å…¶ä»–å­—ç¬¦ä¸²è¯¥ä½ç½®çš„å­—ç¬¦ä¸åŒã€‚\nå³ä¸ºå¯¹äºç¬¬ x ä¸ªå­—ç¬¦ä¸² ï¼Œæœ‰ $\\exists j \\in [1,m] , \\forall i \\in [1,n],s_{xj} \\neq s_{ij}$ ã€‚\næ±‚æŠŠæ‰€æœ‰å­—ç¬¦ä¸²ä¿®æ”¹æˆæ»¡è¶³ä¸Šè¿°è¦æ±‚çš„å­—ç¬¦ä¸²çš„æœ€å°ä»£ä»·æ˜¯å¤šå°‘ï¼Ÿ\næ•°æ®èŒƒå›´ï¼š $1 \\le n,m \\le 20,1\\le a_{ij} \\le 10^6$ ã€‚\né¢˜è§£ æˆ‘ä»¬å‘ç°ï¼Œæ— è®ºå…¶ä»–å­—ç¬¦ä¸²æ˜¯ä»€ä¹ˆæƒ…å†µï¼Œæˆ‘ä»¬æ€»èƒ½æ‰¾åˆ°åœ¨è¿™ä¸€ä½æ²¡æœ‰ç”¨è¿‡çš„å­—ç¬¦ï¼Œè¿™ä¹Ÿæ˜¯åé¢dpæ­£ç¡®æ€§çš„ä¿éšœã€‚\næˆ‘ä»¬çŠ¶æ€å‹ç¼©ä¸€æ³¢ï¼Œä»¤ $dp[S]$ è¡¨ç¤ºåœ¨ $S$ ä¸­ä¸º $1$ çš„è¿™äº›éƒ½å·²ç»å¥½è®°äº†çš„æƒ…å†µä¸‹ï¼Œæƒ³è¦å¥½è®°è¿˜éœ€è¦å¤šå°‘ä»£ä»·ã€‚\næˆ‘ä»¬æ³¨æ„åˆ°ï¼Œå®ƒä»¬çš„æ›´æ”¹åº”å½“æ˜¯ä¸ä¼šå¹²æ‰°çš„ï¼ˆæˆ‘éƒ½æ”¹åˆ°ä»æ²¡äººç”¨è¿‡çš„ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¯æ¬¡éƒ½è€ƒè™‘æœ€é å·¦çš„ä¸æ˜¯ $1$ çš„ä½ç½®ï¼ŒæŠŠå®ƒå˜æˆ $1$ ã€‚æˆ‘ä»¬ä¾æ¬¡è€ƒè™‘æ¯åˆ—ï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§åŠæ³•ï¼š\n æŠŠè¿™ä¸ªå­—ç¬¦ä¸²çš„è¿™ä¸ªå­—ç¬¦æ”¹äº† æŠŠè¿™ä¸ªå­—ç¬¦ä¸²è¿™ä¸ªä½ç½®ä¸Šæ‰€æœ‰æ‹¥æœ‰å’Œå®ƒä¸€æ ·çš„å­—ç¬¦çš„å­—ç¬¦ä¸²çš„è¿™ä¸ªä½ç½®éƒ½æ”¹æ‰ï¼Œåªå‰©ä¸‹ä¸€ä¸ª $a$ æœ€å¤§çš„  åˆ†ç±»è®¨è®ºè½¬ç§»å³å¯ã€‚\næ—¶é—´å¤æ‚åº¦ $O(m 2 ^ n)$ ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56  #include \u0026lt;bits/stdc++.h\u0026gt;#define inf 0x3f3f3f3f using namespace std; const int N = 21,MAXN = (1\u0026lt;\u0026lt;N); int n,m,dp[MAXN]; int a[N][N];char s[N][N]; int ss[N][N],ms[N][N];// ss ä¸ s[i][j] åŒåˆ—ç›¸åŒçš„é›†åˆåˆ—è¡¨, ms ... å‡å»æœ€å¤§çš„  void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m); for(int i = 1;i\u0026lt;=n;i++) scanf(\u0026#34;%s\u0026#34;,s[i]+1); for(int i = 1;i\u0026lt;=n;i++) for(int j = 1;j\u0026lt;=m;j++) scanf(\u0026#34;%d\u0026#34;,\u0026amp;a[i][j]); for(int i = 1;i\u0026lt;=n;i++){ for(int j = 1;j\u0026lt;=m;j++){ ss[i][j] = (1\u0026lt;\u0026lt;(i-1)); ms[i][j] = a[i][j];int sum = a[i][j]; for(int k = 1;k\u0026lt;=n;k++)if(i != k){ if(s[i][j] == s[k][j]){ ss[i][j] |= (1\u0026lt;\u0026lt;(k-1)); ms[i][j] = max(a[k][j],ms[i][j]); sum += a[k][j]; } } ms[i][j] = sum - ms[i][j]; } } } int dfs(int S){ if(dp[S] \u0026lt; inf) return dp[S]; if(S == (1\u0026lt;\u0026lt;n)-1) return 0; int ans = inf,low; for(int i = 1;i\u0026lt;=n;i++){ if((S \u0026amp; (1\u0026lt;\u0026lt;(i-1))) == 0){ low = i;break; } } for(int j = 1;j\u0026lt;=m;j++) ans = min(ans,min( dfs(S|(1\u0026lt;\u0026lt;(low-1))) + a[low][j], dfs(S|ss[low][j]) + ms[low][j])); return dp[S] = ans; } int main(){ init(); memset(dp,0x3f,sizeof(dp)); printf(\u0026#34;%d\\n\u0026#34;,dfs(0)); return 0; }   ","description":"","id":50,"section":"posts","tags":["åŠ¨æ€è§„åˆ’","çŠ¶å‹dp"],"title":"ã€ŒCF543Cã€Remembering Strings-çŠ¶æ€å‹ç¼©dp","uri":"https://blog.chenqiqian.com/posts/cf543c/"},{"content":"Ciel ç‹ç‹¸åœ¨æ¸¸ä¹å›­é‡Œæ’é˜Ÿç­‰å¾…ä¸Šæ‘©å¤©è½®ã€‚ç°åœ¨æœ‰ $n$ ä¸ªäººæŒ‰ç¼–å·é¡ºæ¬¡åœ¨é˜Ÿåˆ—é‡Œï¼Œæœ‰ $m$ æ¡èˆ¹ï¼Œç¬¬ $i$ æ¡èˆ¹åˆ°æ—¶ï¼Œå‰ $q_{i}$ ä¸ªäººå¯ä»¥ä¸Šèˆ¹ã€‚ä¿è¯ $\\sum q_i = n$ã€‚ äººæ€»æ˜¯ä¸æ„¿æ„å’Œé™Œç”Ÿäººä¸ŠåŒä¸€æ¡èˆ¹çš„ï¼Œå½“ç¬¬ $i$ ä¸ªäººä¸ç¬¬ $j$ ä¸ªäººå¤„äºåŒä¸€æ¡èˆ¹ä¸Šæ—¶ï¼Œä¼šäº§ç”Ÿ $u_{i,j}$ çš„æ²®ä¸§å€¼ã€‚è¯·ä½ æ±‚å‡ºæœ€å°çš„æ²®ä¸§å€¼å’Œã€‚ä¸€æ¡èˆ¹ä¸Šçš„äººä¸¤ä¸¤éƒ½ä¼šäº§ç”Ÿæ²®ä¸§å€¼ï¼Œä¸ä¼šè®¡ç®—è¿™ä¸ªæ²®ä¸§å€¼ä¸¤æ¬¡ã€‚\né“¾æ¥ Codeforces\né¢˜è§£ æˆ‘ä»¬æ³¨æ„åˆ°æˆ‘ä»¬æœ‰ä¸€ä¸ªç®€å•çš„è½¬ç§»æ–¹ç¨‹ï¼š\n$$\ndp[i][j] = \\min_{1 \\le p \u0026lt; i}(dp[p][j-1] + g(p+1,j))\n$$\nå…¶ä¸­ $g(i,j)$ è¡¨ç¤ºä» $i$ åˆ° $j$ ä¸­é€‰ä¸­æ‰€æœ‰äººéœ€è¦è€—è´¹çš„ä»£ä»·ã€‚\nè¿™ä¸ªä¸œè¥¿çš„å¤æ‚åº¦æ˜¯ $O(n^2m)$ ï¼Œ æˆ‘ä»¬å¯ä»¥ç”¨å†³ç­–å•è°ƒæ€§ä¼˜åŒ–åˆ° $O(nm \\log n)$ ï¼Œä½†æ˜¯è¿™ä¸ªä¸è¶³ä»¥è¿‡æ‰è¯¥é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ wqs äºŒåˆ† + å†³ç­–å•è°ƒæ€§ä¼˜åŒ–åˆ° $O(n \\log n \\log m)$ ã€‚\néœ€è¦æ³¨æ„çš„æ˜¯è¿™é‡Œçš„ä»£ä»·åº”å½“æ˜¯è´Ÿçš„ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬éœ€è¦åŠ ä¸Šä»£ä»·ã€‚ï¼ˆå·®ä¸å¤šå•¦\néœ€è¦è¯»å…¥ä¼˜åŒ–ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83  #include \u0026lt;bits/stdc++.h\u0026gt;using namespace std; namespace fast_io { inline char read(){static const int IN_LEN=1000000;static char buf[IN_LEN],*s,*t;return s==t?(((t=(s=buf)+fread(buf,1,IN_LEN,stdin))==s)?-1:*s++) : *s++;} inline void read(int \u0026amp;x){static bool iosig;static char c;for (iosig=false,c=read();!isdigit(c);c=read()){if(c==\u0026#39;-\u0026#39;)iosig=true;if(c==-1)return;}for(x=0;isdigit(c);c=read())x=((x+(x\u0026lt;\u0026lt;2))\u0026lt;\u0026lt;1)+(c^\u0026#39;0\u0026#39;);if(iosig)x=-x;} }using namespace fast_io; const int MAXN = 4100; int n,m; char tmp[MAXN*2]; int a[MAXN][MAXN],s[MAXN][MAXN];// å‰ i ä¸ªä¸å‰ j ä¸ªçš„ç­”æ¡ˆ  int G(int x,int y){// ç¬¬ x ä¸ªåˆ°ç¬¬ y ä¸ªçš„ç­”æ¡ˆï¼Œx \u0026lt;= y  return (s[y][y] - 2 * s[x-1][y] + s[x-1][x-1])/2; } int dp[MAXN],siz[MAXN],fi,la; struct Node{ int p,l,r; Node(int _p = 0,int _l = 0,int _r = 0){p = _p,l = _l,r = _r;} }; Node q[MAXN];//[fi,la]  void reset(){dp[0] = siz[0] = la = 0;fi = 1;} int cal(int now,int last,int k){return dp[last] + G(last+1,now) + k;} int check(int k){// k ä¸ºä»£ä»·ï¼Œæ¯ä¸ªéƒ½åŠ ä¸Šä¸€ä¸ª k ï¼Œå› ä¸ºæ–œç‡æ˜¯è´Ÿæ•°  // ä¸é™åˆ†æ®µä¸ªæ•°ï¼Œè€ƒè™‘ dp[i] ä¸ºå‰ i ä¸ªåˆ†è‹¥å¹²æ®µçš„æœ€å°å€¼ï¼Œæ¯åˆ†ä¸€æ®µè¦åŠ ä¸€ä¸ª k x  reset(); q[++la] = Node(0,1,n); for(int i = 1;i\u0026lt;=n;i++){ while(fi \u0026lt; la \u0026amp;\u0026amp; q[fi].r \u0026lt; i) fi++; dp[i] = cal(i,q[fi].p,k),siz[i] = siz[q[fi].p] + 1; // ä¸ºä»€ä¹ˆå¯¹æ–°æ¥çš„è¿™ä¹ˆä¸å‹å¥½ï¼Ÿï¼Ÿï¼Ÿ  if(cal(n,q[la].p,k) \u0026lt;= cal(n,i,k)) continue; while(fi \u0026lt; la \u0026amp;\u0026amp; cal(q[la].l,q[la].p,k) \u0026gt; cal(q[la].l,i,k)) la--; int L = q[la].l,R = q[la].r + 1;// äºŒåˆ†å†³ç­–ç‚¹  while(L!=R){ int mid = (L+R)/2; if(cal(mid,q[la].p,k) \u0026gt; cal(mid,i,k)) R = mid; else L = mid+1; } q[la].r = L-1; q[++la] = Node(i,L,n); } // æœ€ä¼˜åˆ†å‡ æ®µï¼Ÿ  return siz[n]; } void init(){ read(n),read(m); for(int i = 1;i\u0026lt;=n;i++) for(int j = 1;j\u0026lt;=n;j++){ read(a[i][j]); s[i][j] = s[i-1][j] + s[i][j-1] - s[i-1][j-1] + a[i][j]; } } void solve(){ int L = 0,R = s[n][n]; while(L != R){ int mid = (L+R)/2; if(check(mid) \u0026lt;= m) R = mid; else L = mid+1; } check(L); printf(\u0026#34;%d\\n\u0026#34;,dp[n] - L*m); } int main(){ init(); solve(); return 0; }   ","description":"","id":51,"section":"posts","tags":["åŠ¨æ€è§„åˆ’","wqsäºŒåˆ†","å†³ç­–å•è°ƒæ€§"],"title":"ã€ŒCF321Eã€Ciel and Gondolas-wqsäºŒåˆ†+å†³ç­–å•è°ƒæ€§","uri":"https://blog.chenqiqian.com/posts/cf321e/"},{"content":"æœ‰ $n$ æœ¬ä¹¦ï¼Œç¬¬ $i$ æœ¬ä¹¦ä¸­æœ‰ $a_i$ ä¸ªé—®é¢˜ï¼Œå‡å±äºç¬¬ $t_i$ ç±»é—®é¢˜ã€‚\næœ‰ $q$ æ¬¡è¯¢é—®ï¼Œæ¯æ¬¡è¯¢é—®ç»™å‡ºä¸€ä¸ªåŒºé—´ $[l_i,r_i]$ ï¼Œè¯¢é—®æœ‰å¤šå°‘ä¸ªåŸåºåˆ—çš„è¿ç»­å­åŒºé—´æ˜¯ç»™å‡ºåŒºé—´çš„å­åŒºé—´ï¼Œä¸”è¯¥å­åŒºé—´ä¸­æ‰€æœ‰ä¹¦ä¸­é—®é¢˜çš„å’Œæ»¡è¶³ç¬¬ $1$ ç±»çš„é—®é¢˜æ°å¥½æ¯”ç¬¬ $2$ ç±»çš„é—®é¢˜æ°å¥½å¤š $k$ ä¸ªã€‚\næ•°æ®èŒƒå›´ï¼š $1 \\le n \\le 10^5$ , $-10^9 \\le k \\le 10^9$, $t_i \\in {1,2}$ , $0 \\le a_i \\le 10^9$ , $1 \\le q \\le 10^5$ , $1 \\le l_i \\le r_i \\le n$\né“¾æ¥ Codeforces\né¢˜è§£ çœ‹åˆ°ç¦»çº¿çš„åŒºé—´è¯¢é—®è®©æˆ‘ä»¬æƒ³åˆ°è«é˜Ÿï¼ˆå…¶å®æ˜¯å‰å‡ å¤©THUWCæ²¡åšå‡ºæ¥ç­¾åˆ°é¢˜è®©æˆ‘æƒ³åˆ°çš„ï¼‰ï¼Œç„¶åæˆ‘ä»¬å‘ç°æˆ‘ä»¬å¯ä»¥åšåˆ°ç›¸é‚»çš„åŒºé—´è½¬ç§»ã€‚è¿™ä¸ªé—®é¢˜äº‹å®ä¸Šå°±æ˜¯å‰ç¼€å’Œç›¸å·® $k$ ï¼Œæˆ‘ä»¬ç”¨ä¸ªä»€ä¹ˆä¸œè¥¿ï¼ˆæ¯”å¦‚ map ï¼‰ç¦»æ•£åŒ–ä¸€ä¸‹æ‰€æœ‰çš„ sum å‰ç¼€å’Œï¼Œé¢„å¤„ç†å‡ºæ¥æ¯ä¸ªä½ç½®çš„å‰ç¼€å’Œå‡æ‰å’ŒåŠ ä¸Š $k$ ä¹‹åçš„ç¦»æ•£åŒ–åçš„æ•°å­—ã€‚åœ¨è«é˜Ÿçš„è¿‡ç¨‹ä¸­ç»´æŠ¤ä¸€ä¸ª $cnt$ æ•°ç»„ï¼Œå°±å¯ä»¥ $O(1)$ è½¬ç§»äº†ã€‚\næ—¶é—´å¤æ‚åº¦ï¼š$O(q \\sqrt n + n \\log n )$\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81  #include \u0026lt;bits/stdc++.h\u0026gt;#define ll long long using namespace std; const int MAXN = 110000; int n,q,Q; int t[MAXN],a[MAXN]; ll k,sum[MAXN],A[MAXN],B[MAXN];// A -\u0026gt; -k / B -\u0026gt; +k map\u0026lt;ll,int\u0026gt; S;int tmpcnt = 0; struct Query{ int l,r,id; }qu[MAXN]; bool cmp(Query a,Query b){ if(a.l/Q != b.l/Q) return a.l / Q \u0026lt; b.l / Q; else return ((a.l/Q)\u0026amp;1)?a.r \u0026lt; b.r:a.r \u0026gt; b.r; } void init(){ scanf(\u0026#34;%d %lld\u0026#34;,\u0026amp;n,\u0026amp;k); for(int i = 1;i\u0026lt;=n;i++) scanf(\u0026#34;%d\u0026#34;,\u0026amp;t[i]); for(int i = 1;i\u0026lt;=n;i++) scanf(\u0026#34;%d\u0026#34;,\u0026amp;a[i]); for(int i = 1;i\u0026lt;=n;i++){ sum[i] = t[i] == 1?a[i]:-a[i]; sum[i] += sum[i-1]; S[sum[i]] = 0; } S[0] = 0; for(auto it = S.begin();it != S.end();it++) it-\u0026gt;second = ++tmpcnt; for(int i = 0;i\u0026lt;=n;i++){ if(S.count(sum[i]-k)) A[i] = S[sum[i]-k]; if(S.count(sum[i]+k)) B[i] = S[sum[i]+k]; sum[i] = S[sum[i]]; } Q = sqrt(n); scanf(\u0026#34;%d\u0026#34;,\u0026amp;q); for(int i = 1;i\u0026lt;=q;i++) scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;qu[i].l,\u0026amp;qu[i].r),qu[i].id = i; sort(qu+1,qu+q+1,cmp); } static int cnt[MAXN],L = 1,R = 0;// ç»´æŠ¤ [L-1,R] çš„å‰ç¼€å’Œ ll ans = 0; void addL(int pos){ ans += cnt[B[pos-1]];cnt[sum[pos-1]]++; } void addR(int pos){ ans += cnt[A[pos]];cnt[sum[pos]]++; } void delL(int pos){ cnt[sum[pos-1]]--;ans -= cnt[B[pos-1]]; } void delR(int pos){ cnt[sum[pos]]--;ans -= cnt[A[pos]]; } ll ANS[MAXN]; void solve(){ cnt[S[0]] = 1; for(int i = 1;i\u0026lt;=q;i++){ while(qu[i].l \u0026lt; L) addL(--L); while(qu[i].r \u0026gt; R) addR(++R); while(qu[i].l \u0026gt; L) delL(L++); while(qu[i].r \u0026lt; R) delR(R--); ANS[qu[i].id] = ans; } for(int i = 1;i\u0026lt;=q;i++){ printf(\u0026#34;%lld\\n\u0026#34;,ANS[i]); } } int main(){ init(); solve(); return 0; }   ","description":"","id":52,"section":"posts","tags":["æ•°æ®ç»“æ„","è«é˜Ÿ"],"title":"ã€ŒCF877Fã€Ann and Books-è«é˜Ÿ","uri":"https://blog.chenqiqian.com/posts/cf877f/"},{"content":"Dreamoon æœ‰ä¸€ä¸ªå­—ç¬¦ä¸² $s$ å’Œä¸€ä¸ªæ¨¡å¼ä¸² $p$ ï¼Œä»–ä¼šå…ˆä» $s$ ä¸­åˆ é™¤æ°å¥½ $x$ ä¸ªå­—ç¬¦æ¥äº§ç”Ÿä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸² $s'$ ã€‚ç„¶åä»–ä¼šè®¡ç®— $occ(s',p)$ï¼Œå³ä» $s'$ ä¸­èƒ½æ‰¾åˆ°çš„ç­‰äº pp çš„ä¸ç›¸äº¤çš„å­ä¸²æ•°é‡çš„æœ€å¤§å€¼ã€‚ä»–æƒ³è®© $occ(s',p)$ çš„å€¼å°½å¯èƒ½å¤§ã€‚\næ›´å½¢å¼åœ°è¯´ï¼Œè®©æˆ‘ä»¬ç”¨ $ans(x)$ è¡¨ç¤ºæ‰€æœ‰å¯ä»¥ä» $s$ ä¸­åˆ å»æ°å¥½ $x$ ä¸ªå­—ç¬¦å¾—åˆ°çš„ $s'$ ä¸­ $occ(s',p)$ çš„æœ€å¤§å€¼ã€‚Dreamoon æƒ³è¦çŸ¥é“å¯¹äºæ‰€æœ‰çš„ $x$ $(0 \\leq x \\leq |s|)$ï¼Œ $ans(x)$ çš„å€¼ã€‚\né¢˜è§£ è¿™é¢˜æˆ‘ç”¨äº†ä¸€ä¸ªæå…¶éº»çƒ¦çš„ $dp$ï¼Œéœ€è¦è®°å½•å››ä¸ªæ•°ç»„ï¼Œæœ‰ä¸€å¤§å †ç»†èŠ‚ï¼Œæˆ‘ç®€ç•¥åœ°è¯´ä¸‹ã€‚\n$f[i][j]$ è¡¨ç¤ºåœ¨ $s$ ä¸²å‰ $i$ ä½ï¼Œå½“å‰åŒ¹é…åˆ° $p$ ä¸²ç¬¬ $j$ ä½ï¼Œ$p$ ä¸²æœ€é å³æ—¶ï¼Œç¬¬ä¸€ä½çš„ä½ç½®ã€‚\n$h[i]$ è¡¨ç¤ºåœ¨ $s$ ä¸²å‰ $i$ ä½ï¼ŒåŒ¹é…ä¸€ä¸ªå®Œæ•´çš„ $p$ ä¸²ï¼Œ$p$ ä¸²æœ€é å³æ—¶ï¼Œéœ€è¦ä½¿è¿™ä¸ªå­åºåˆ—å˜æˆå­ä¸²çš„æœ€å°ä»£ä»·ã€‚\n$g[i][j]$ è¡¨ç¤ºåœ¨ $s$ ä¸²çš„å‰ $i$ ä½ï¼Œå‰é¢å‡ºç°å®Œæ•´çš„ $j$ æ¬¡ $p$ ä¸²æ—¶ï¼Œç¬¬ä¸€æ¬¡å‡ºç°çš„ $p$ ä¸²æœ€é å³æ—¶ï¼Œç¬¬ä¸€æ¬¡å‡ºç°çš„ $p$ ä¸²çš„ç¬¬ä¸€ä¸ªä½ç½®ã€‚\n$p[i][j]$ è¡¨ç¤ºå¦‚ä¸Šæ¡ä»¶ä¸‹çš„ä»£ä»·æ˜¯å¤šå°‘ã€‚\nè®¡ç®—å‡ºå¦‚ä¸Šå››ä¸ªæ•°ç»„ä¹‹åï¼Œæˆ‘ä»¬è®¡ç®—å‡º $\\text{minlen}[i]$ ï¼Œæ„ä¸ºæå‡º $i$ ä¸ª $p$ ä¸²çš„æœ€å°ä»£ä»·ã€‚\nç„¶åå¯¹äºæ¯ä¸€ä¸ª $i$ ï¼Œå½“ $t \\in [\\text{minlen}[i-1],\\text{minlen[i]-1]}$ ï¼Œ $ans(t) = i$ ã€‚åé¢è¿˜æœ‰ä¸€äº›å°±æ˜¯é€†åºçš„é€’å¢æ•°åˆ—ï¼Œå¦‚ $\u0026hellip;444333222111000$ ï¼Œé•¿åº¦å–å†³äºæœ€å¤§èƒ½æå‡ºæ¥å¤šå°‘ä¸ªã€‚\nåæ­£è¶…çº§éº»çƒ¦ï¼Œä½†æ˜¯è¿‡æ‰äº†2333\næ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦éƒ½æ˜¯ $O(n^2)$ ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78  #include \u0026lt;bits/stdc++.h\u0026gt;using namespace std; const int MAXN = 2100; int n,m; char s[MAXN],t[MAXN]; int last[MAXN][30]; int f[MAXN][MAXN],h[MAXN]; int g[MAXN][MAXN],p[MAXN][MAXN]; void init(){ scanf(\u0026#34;%s\u0026#34;,s+1),scanf(\u0026#34;%s\u0026#34;,t+1); n = strlen(s+1),m = strlen(t+1); } void build(){ static int l[30]; for(int i = 1;i\u0026lt;=n;i++){ for(int c = 0;c\u0026lt;26;c++) last[i][c] = l[c]; l[s[i]-\u0026#39;a\u0026#39;] = i; } } void solve(){ h[0] = 0x3f3f3f3f; for(int i = 1;i\u0026lt;=n;i++){ for(int j = 1;j\u0026lt;=m;j++){ if(s[i] == t[j]){ f[i][j] = (j == 1?i:f[i-1][j-1]); if(j == m) h[i] = (i - f[i][m] + 1 - m); } else{ f[i][j] = f[i-1][j]; if(j == m) h[i] = h[i-1]; } if(f[i][j] == f[i-1][j]) h[i] = min(h[i],h[i-1]); } } static int minl[MAXN],ans[MAXN],maxn = 0; memset(minl,0x3f,sizeof(minl)); for(int j = 1;j\u0026lt;=n;j++){ for(int i = 1;i\u0026lt;=n;i++){ if(f[i][m]){ g[i][j] = (j == 1?f[i][m]:g[f[i][m]-1][j-1]); p[i][j] = (j == 1?h[i] :p[f[i][m]-1][j-1] + h[i]); } else{ g[i][j] = g[i-1][j]; p[i][j] = p[i-1][j]; } if(g[i-1][j]) p[i][j] = min(p[i][j],p[i-1][j]); if(g[i][j]){ minl[j] = min(minl[j],p[i][j]); maxn = max(maxn,j); if(p[i][j] == 0) ans[0] = max(ans[0],j); } } } minl[0] = 1,minl[n+1] = 0x3f3f3f3f; for(int i = 1;i\u0026lt;=n;i++){ for(int x = minl[i-1];x \u0026lt;= min(minl[i]-1,n);x++) ans[x] = i-1; } for(int i = n;i\u0026gt;=1;--i){ if((n-i+1) \u0026gt; maxn * (m)+1) break; ans[i] = ((i + m \u0026gt; n)?0:ans[i+m]+1); } for(int i = 0;i\u0026lt;=n;i++) printf(\u0026#34;%d \u0026#34;,ans[i]); printf(\u0026#34;\\n\u0026#34;); } int main(){ init(); build(); solve(); return 0; }   ","description":"","id":53,"section":"posts","tags":["åŠ¨æ€è§„åˆ’"],"title":"ã€ŒCF476Eã€Dreamoon and Strings-åŠ¨æ€è§„åˆ’","uri":"https://blog.chenqiqian.com/posts/cf476e/"},{"content":"ç»™å®šé•¿åº¦ä¸º $n$ çš„æ•´æ•°åºåˆ— $h[n]$ ï¼Œæœ‰ $Q$ ä¸ªè¯¢é—®ï¼Œæ¯æ¬¡ç»™å‡º $l_1,r_1$ ï¼Œâ€‹è¯¢é—®æœ‰å¤šå°‘å¯¹ $l_2,r_2$ ï¼Œæ»¡è¶³ä»¥ä¸‹æ¡ä»¶:\n $r_2 â€“ l_2 = r_1 â€“ l_1$ åŒºé—´ $[l_1, r_1]$ ä¸åŒºé—´ $[l_2, r_2]$ æ²¡æœ‰äº¤é›† å¯¹äºä»»æ„ $i \\in [0,r_1 â€“ l_1]$ ï¼Œæ»¡è¶³ $h[l_1 + i] + h[l_2 + i] = h[l_1] + h[l_2]$  é“¾æ¥ Codeforces\né¢˜è§£ æ³¨æ„åˆ°ç¬¬ä¸‰ä¸ªæ¡ä»¶å¯ä»¥è½¬åŒ–æˆ\n$$\nh[l_1 + i + 1] + h[l_2 + i + 1] = h[l_1 + i] + h[l_2 + i],\n\\ i \\in [0,r_i-l_i-1]\n$$\nä¹Ÿå°±æ˜¯\n$$\nh[l_1 + i + 1] - h[l_1 + i] = - (h[l_2 + i + 1] - h[l_2 + i])\n\\ i \\in [0,r_i-l_i-1]\n$$\næˆ‘ä»¬ä»¤ $g[i] = h[i+1] - h[i]$ï¼Œé‚£ä¹ˆç¬¬ä¸‰ä¸ªæ¡ä»¶çš„è¡¨è¿°å°±å˜ä¸ºï¼š\n$$\ng[l_1+i] = -g[l_2+i]\n\\ i \\in [0,r_i-l_i-1]\n$$\nå¦‚æœæˆ‘ä»¬ä»¤ $len = r_i-l_i-1$ ï¼Œé‚£ä¹ˆæ¡ä»¶å˜æˆï¼š\n$$\ng[l_1\u0026hellip;l_1+len] = - g[l_2\u0026hellip;l_2+len]\n$$\nåç¼€æ•°ç»„å¤„ç†ä¹‹åï¼Œå°±å˜æˆäº†ä¸€ä¸ªäºŒç»´æ•°ç‚¹çš„é—®é¢˜ï¼Œéšä¾¿æ€ä¹ˆæä¸€æå°±å¯ä»¥äº†ã€‚\nè¿™é‡Œç”¨äº†ä¸»å¸­æ ‘å®ç°ã€‚è¦ç‰¹åˆ¤ $l = r$ çš„æƒ…å†µï¼Œç­”æ¡ˆæ˜¯ $n-1$ ã€‚æ³¨æ„è¦æ’é™¤æ‰ç›¸äº¤çš„æƒ…å†µï¼Œéœ€è¦åŠ ä¸€å‡ä¸€ï¼Œè¿™ä¸ªåœ°æ–¹æ¯”è¾ƒå®¹æ˜“é”™\u0026hellip;\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148  #include \u0026lt;bits/stdc++.h\u0026gt;#define inf 0x3f3f3f3f using namespace std; const int MAXN = 210000,LOGN = 20; namespace SA{ int s[MAXN],sa[MAXN],ht[MAXN],x[MAXN],y[MAXN],rk[MAXN],cnt[MAXN]; void get_sa(int n,int m){ for(int i = 0;i\u0026lt;m;i++) cnt[i] = 0; for(int i = 0;i\u0026lt;n;i++) cnt[s[i]]++; for(int i = 1;i\u0026lt;m;i++) cnt[i] += cnt[i-1]; for(int i = n-1;~i;--i) sa[--cnt[s[i]]] = i; m = rk[sa[0]] = 0; for(int i = 1;i\u0026lt;n;i++) rk[sa[i]] = s[sa[i]] == s[sa[i-1]]?m:++m; for(int j = 1;;j\u0026lt;\u0026lt;=1){ if(++m == n) break; for(int i = 0;i\u0026lt;j;i++) y[i] = n-j+i; for(int i = 0,k = j;i\u0026lt;n;i++) if(sa[i] \u0026gt;= j) y[k++] = sa[i] - j; for(int i = 0;i\u0026lt;n;i++) x[i] = rk[y[i]]; for(int i = 0;i\u0026lt;m;i++) cnt[i] = 0; for(int i = 0;i\u0026lt;n;i++) cnt[x[i]]++; for(int i = 1;i\u0026lt;m;i++) cnt[i] += cnt[i-1]; for(int i = n-1;~i;--i) sa[--cnt[x[i]]] = y[i],y[i] = rk[i]; m = rk[sa[0]] = 0; for(int i = 1;i\u0026lt;n;i++) rk[sa[i]] = (y[sa[i]] == y[sa[i-1]] \u0026amp;\u0026amp; y[sa[i]+j] == y[sa[i-1]+j]?m:++m); } } void get_height(int n){ for(int i = 0,h = ht[0] = 0;i\u0026lt;n;i++){ int j = sa[rk[i]-1]; while(i+h\u0026lt;n \u0026amp;\u0026amp; j+h\u0026lt;n \u0026amp;\u0026amp; s[i+h] == s[j+h]) h++; ht[rk[i]] = h; if(h) --h; } } void solve(int n,int m,int *a){ for(int i = 0;i\u0026lt;n;i++) s[i] = a[i]; s[n++] = 0; get_sa(n,m),get_height(n); } } namespace ST{ int minn[MAXN][LOGN]; void init(int n,int *a){ for(int i = 1;i\u0026lt;=n;i++) minn[i][0] = a[i]; for(int j = 1;j\u0026lt;LOGN;j++) for(int i = 1;i + (1\u0026lt;\u0026lt;(j-1)) \u0026lt;= n;i++) minn[i][j] = min(minn[i][j-1],minn[i+(1\u0026lt;\u0026lt;(j-1))][j-1]); } int query(int l,int r){ int t = log2(r-l+1); return min(minn[l][t],minn[r-(1\u0026lt;\u0026lt;t)+1][t]); } } int _q(int l,int r){ return l == r ? inf : ST::query(l+1,r); } int rt[MAXN]; namespace CMT{ int ls[MAXN*LOGN],rs[MAXN*LOGN],sumn[MAXN*LOGN],cnt; #define mid ((l+r)/2)  void insert(int \u0026amp;nown,int pre,int l,int r,int pos,int v){ nown = ++cnt;ls[nown] = ls[pre],rs[nown] = rs[pre],sumn[nown] = sumn[pre]; if(l == r) sumn[nown] += v; else{ if(pos \u0026lt;= mid) insert(ls[nown],ls[pre],l,mid,pos,v); if(pos \u0026gt;= mid+1) insert(rs[nown],rs[pre],mid+1,r,pos,v); sumn[nown] = sumn[ls[nown]] + sumn[rs[nown]]; } } int query(int nown,int l,int r,int ql,int qr){ if(!nown) return 0; if(ql \u0026lt;= l \u0026amp;\u0026amp; r \u0026lt;= qr) return sumn[nown]; else{ int ans = 0; if(ql \u0026lt;= mid) ans += query(ls[nown],l,mid,ql,qr); if(qr \u0026gt;= mid+1) ans += query(rs[nown],mid+1,r,ql,qr); return ans; } } #undef mid } map\u0026lt;int,int\u0026gt; S; int n,len,m,q,h[MAXN],g[MAXN]; void init(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n); for(int i = 0;i\u0026lt;n;i++){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;h[i]); if(i) g[i-1] = h[i] - h[i-1]; } g[n-1] = h[n]-h[n-1],g[n] = 2e9+1; len = 2*n+1; for(int i = 1;i\u0026lt;=n;i++) g[n+i] = -g[i-1]; for(int i = 0;i\u0026lt;len;i++) S[g[i]] = 0; for(auto it = S.begin();it != S.end();it++) it-\u0026gt;second = ++m; m++; for(int i = 0;i\u0026lt;len;i++) g[i] = S[g[i]]; } int query_cmt(int lb,int rb,int l,int r){ return CMT::query(rt[rb],0,len,l,r) - CMT::query(rt[lb-1],0,len,l,r); } int query(int L,int R){ if(L == R) return n-1; int pos = SA::rk[L],l = R-L,lb,rb; int LL = 0,RR = pos; while(LL != RR){ int mid = (LL+RR)/2; if(_q(mid,pos) \u0026gt;= l) RR = mid; else LL = mid+1; } lb = LL; LL = pos,RR = len; while(LL != RR){ int mid = (LL+RR+1)/2; if(_q(pos,mid) \u0026gt;= l) LL = mid; else RR = mid-1; } rb = LL; return query_cmt(lb,rb,n+1,len) - query_cmt(lb,rb,max(n+1,n+L-l+1),n+R+1); return 0; } void solve(){ SA::solve(len,m,g),ST::init(len,SA::ht); for(int i = 1;i\u0026lt;len;i++) CMT::insert(rt[i],rt[i-1],0,len,SA::sa[i],1); scanf(\u0026#34;%d\u0026#34;,\u0026amp;q); for(int i = 1;i\u0026lt;=q;i++){ int l,r; scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;l,\u0026amp;r); printf(\u0026#34;%d\\n\u0026#34;,query(l-1,r-1)); } } int main(){ init(); solve(); return 0; }   ","description":"","id":54,"section":"posts","tags":["åç¼€æ•°ç»„","ä¸»å¸­æ ‘","å­—ç¬¦ä¸²","æ•°æ®ç»“æ„"],"title":"ã€ŒCF232Dã€Fence-åç¼€æ•°ç»„+ä¸»å¸­æ ‘","uri":"https://blog.chenqiqian.com/posts/cf232d/"},{"content":"æˆ‘ä»¬æœ‰ $n$ ä¸ªé›†åˆï¼Œç¬¬ $i$ ä¸ªé›†åˆæœ‰ $m_i$ ä¸ªæ•°ï¼ˆ$1$ åˆ° $n$ ä¸­çš„æ•´æ•°ï¼‰ï¼Œæƒå€¼ä¸º $w_i$ ã€‚\nç°åœ¨è¯·ä½ ä»ä¸­é€‰å‡º $k$ ï¼ˆ$k$ ä¸ºä»»æ„ $0$ åˆ° $n$ ä¸­çš„æ•´æ•°ï¼‰ä¸ªé›†åˆï¼Œæ»¡è¶³è¿™ $k$ ä¸ªé›†åˆçš„å¹¶é›†çš„å¤§å°ä¸º $k$ ï¼Œè¯¢é—®è¿™ $k$ ä¸ªé›†åˆçš„æƒå€¼å’Œæœ€å°å€¼ã€‚\nä¿è¯ä»è¿™ $n$ é€‰å‡ºä»»æ„ $x$ ä¸ªé›†åˆï¼Œä»–ä»¬çš„å¹¶é›†å¤§å°ä¸å°äº $k$ ã€‚\né“¾æ¥ Codeforces\né¢˜è§£ ç†Ÿæ‚‰äºŒåˆ†å›¾é‚£å¥—ç†è®ºçš„åŒå­¦å¾ˆå¿«å°±ä¼šå‘ç°ï¼Œé¢˜ç›®ä¸­ç»™å‡ºçš„æ¡ä»¶ï¼šä»»æ„ $k(1 \\le k \\le n)$ ä¸ªé›†åˆçš„å¹¶é›†çš„å¤§å°éƒ½ä¸å°äº $k$ ï¼Œå¯ä»¥è½¬åŒ–æˆéœå°”å®šç†çš„ä¸€æ–¹é¢çš„è¡¨è¿°ã€‚\næˆ‘ä»¬å»ºç«‹ä¸€ä¸ªäºŒåˆ†å›¾ $G_1$ ï¼Œå·¦è¾¹æ”¾ä¸Šæ‰€æœ‰çš„é›†åˆï¼Œå³è¾¹æ”¾ä¸Šæ‰€æœ‰çš„æ•°ï¼ŒæŠŠå·¦ä¾§æ¯ä¸ªé›†åˆå‘å…¶æ‹¥æœ‰çš„æ•°è¿ä¸€æ¡è¾¹ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™ï¼Œæ ¹æ®éœå°”å®šç†ï¼Œè¿™ä¸ªäºŒåˆ†å›¾å­˜åœ¨ä¸€ä¸ªå·¦ä¾§æ‰€æœ‰èŠ‚ç‚¹éƒ½åœ¨åŒ¹é…ä¸­çš„åŒ¹é…ï¼ˆè¿™ä¸ªå›¾ä¸­å³ä¾§ä¹Ÿåªæœ‰ $n$ ä¸ªèŠ‚ç‚¹ï¼Œæ‰€ä»¥äº‹å®ä¸Šæ˜¯ä¸€ä¸ªå®Œç¾åŒ¹é…ï¼‰ã€‚\næ‰€ä»¥æ¯ä¸€ä¸ªé›†åˆ $i$ éƒ½å¯ä»¥å¯¹åº”åˆ°ä¸€ä¸ªæ•° $c_i$ ï¼Œ ä¸”ä»»æ„ä¸¤ä¸ªæ•°çš„ $c_i$ éƒ½ä¸ç›¸åŒã€‚\nè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å‘ç°ï¼Œä»»æ„é€‰ $k$ ä¸ªé›†åˆï¼Œæˆ‘ä»¬éƒ½å¯ä»¥å¾—åˆ°è¿™ $k$ ä¸ªé›†åˆå¹¶é›†çš„ä¸€ä¸ªå­é›†ï¼Œå°±æ˜¯ç”±è¿™ $k$ ä¸ªé›†åˆçš„ $c_i$ æ„æˆçš„é›†åˆã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å·²ç»ä¸èƒ½æœ‰ä»»ä½•å…¶ä»–çš„æ•°åŠ å…¥ï¼Œå¦‚æœæˆ‘ä»¬é€‰æ‹©äº†ç¬¬ $i$ ä¸ªé›†åˆï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯¹äºç¬¬ $i$ ä¸ªé›†åˆï¼Œå¯¹äºé™¤äº† $c_i$ çš„å…ƒç´  $t$ ï¼Œæˆ‘ä»¬éƒ½å¿…é¡»é€‰æ‹© $c_j = t$ çš„ $j$ é›†åˆï¼Œæ‰èƒ½ä¿è¯ä¸å¤šå‡ºæ¥å…ƒç´ ã€‚\nè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±æœ‰äº†ä¸€ä¸ªæ–°æ¨¡å‹ï¼Œ ä»”ç»†è§‚å¯Ÿçš„è¯ï¼Œå°±ä¼šå‘ç°å…¶å®æ˜¯ä¸€ä¸ªæœ€å°æƒé—­åˆå­å›¾çš„æ¨¡å‹ï¼Œå¯ä»¥ç”¨æœ€å°å‰²æ¨¡å‹æ¥è§£å†³ï¼Œç½‘ä¸Šä¹Ÿæœ‰è®¸å¤šèµ„æ–™ï¼Œåœ¨è¿™é‡Œå°±ä¸é‡å¤äº†ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122  #include \u0026lt;bits/stdc++.h\u0026gt;using namespace std; const int MAXN = 610,inf = 0x3f3f3f3f; int n,w[MAXN]; vector\u0026lt;int\u0026gt; G[MAXN]; struct Edge{ int from,to; int cap,flow; int nex; }edge[MAXN*MAXN*2]; int fir[MAXN],ecnt = 2; int addedge(int a,int b,int c){ edge[ecnt] = (Edge){a,b,c,0,fir[a]}; fir[a] = ecnt++; edge[ecnt] = (Edge){b,a,0,0,fir[b]}; fir[b] = ecnt++; return ecnt - 2; } int dis[MAXN]; queue\u0026lt;int\u0026gt; q; bool bfs(int s,int t){ memset(dis,0,sizeof(dis)); while(!q.empty()) q.pop(); dis[s] = 1;q.push(s); while(!q.empty()){ int nown = q.front();q.pop(); for(int nowe = fir[nown];nowe;nowe = edge[nowe].nex){ int v = edge[nowe].to; if(dis[v] == 0 \u0026amp;\u0026amp; edge[nowe].cap \u0026gt; edge[nowe].flow){ dis[v] = dis[nown] + 1; q.push(v); } } } return dis[t] != 0; } int dfs(int nown,int t,int limit = inf){ if(nown == t || limit == 0) return limit; int sumf = 0; for(int nowe = fir[nown];nowe;nowe = edge[nowe].nex){ int v = edge[nowe].to; if(dis[v] == dis[nown] + 1 \u0026amp;\u0026amp; edge[nowe].cap \u0026gt; edge[nowe].flow){ int f = dfs(v,t,min(limit,edge[nowe].cap - edge[nowe].flow)); if(f){ edge[nowe].flow += f,edge[nowe^1].flow -= f; sumf += f,limit -= f; } if(limit == 0) break; } } return sumf; } int dinic(int s,int t){ int ans = 0; while(bfs(s,t)) ans += dfs(s,t); return ans; } void init(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n); for(int i = 1;i\u0026lt;=n;i++){ int m; scanf(\u0026#34;%d\u0026#34;,\u0026amp;m); while(m--){ int x;scanf(\u0026#34;%d\u0026#34;,\u0026amp;x); G[i].push_back(x); } } for(int i = 1;i\u0026lt;=n;i++) scanf(\u0026#34;%d\u0026#34;,\u0026amp;w[i]); } vector\u0026lt;int\u0026gt; E[MAXN];int c[MAXN],back[MAXN]; void get_matching(){ int S = 0,T = 2*n+1; for(int i = 1;i\u0026lt;=n;i++){ addedge(S,i,1),addedge(i+n,T,1); for(auto j : G[i]) E[i].push_back(addedge(i,j+n,1)); } dinic(S,T); for(int i = 1;i\u0026lt;=n;i++){ for(unsigned x = 0;x \u0026lt; G[i].size();x++){ if(edge[E[i][x]].flow == 1){ c[i] = G[i][x]; back[G[i][x]] = i; break; } } } } void solve(){ get_matching(); ecnt = 2;memset(fir,0,sizeof(fir)); int S = n+1,T = S+1; int ans = 0; for(int i = 1;i\u0026lt;=n;i++){ w[i] = -w[i]; if(w[i] \u0026gt; 0) addedge(S,i, w[i]),ans += w[i]; else addedge(i,T,-w[i]); } for(int i = 1;i\u0026lt;=n;i++){ for(auto j : G[i])if(j != c[i]) addedge(i,back[j],inf); } ans -= dinic(S,T); printf(\u0026#34;%d\\n\u0026#34;,-ans); } int main(){ init(); solve(); return 0; }   ","description":"","id":55,"section":"posts","tags":["ç½‘ç»œæµ","å›¾è®º"],"title":"ã€ŒCF103Eã€Buying Sets-éœå°”å®šç†-ç½‘ç»œæµ-æœ€å°æƒé—­åˆå­å›¾","uri":"https://blog.chenqiqian.com/posts/cf103e/"},{"content":"ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„æ•°ç»„ï¼Œæˆ‘ä»¬è¦ä»ä¸­æ‰¾å‡ºä¸¤ä¸ªä¸ç›¸äº¤ï¼ˆä¸å«é‚®ç›¸åŒå…ƒç´ çš„ï¼‰çš„å­åºåˆ—ï¼Œè¦æ±‚æ¯ä¸ªå­åºåˆ—çš„ä»»æ„ä¸¤ä¸ªç›¸é‚»å…ƒç´ çš„å·®çš„ç»å¯¹å€¼ä¸º $1$ æˆ– åœ¨æ¨¡ $7$ æ„ä¹‰ä¸‹ç›¸åŒã€‚è¯·ä½ æ±‚å‡ºè¿™ä¸¤ä¸ªå­åºåˆ—é•¿åº¦å’Œçš„æœ€å¤§å€¼ã€‚\né¢˜è§£ ä»¤ $dp[x][y]$ è¡¨ç¤ºç¬¬ä¸€ä¸ªå­åºåˆ—æœ€åä¸€ä¸ªå…ƒç´ å–åˆ° $x$ ï¼Œç¬¬äºŒä¸ªå­åºåˆ—çš„æœ€åä¸€ä¸ªå…ƒç´ å–åˆ° $y$ çš„æœ€å¤§çš„å’Œã€‚\n $x \u0026lt; y$\nä»¤ $dp[y] = dp[y]$ $x = y$\næ˜¾ç„¶ $dp[y] = 0$ $x \u0026gt; y$\n$$\ndp[y] = \\max_{0 \\le i \u0026lt; x,i \\neq y}(dp[i][y]+1)\n$$\nå…¶ä¸­ $i$ åˆ° $x$ æ»¡è¶³å¦‚ä¸Šæ¡ä»¶ã€‚  å‰ä¸¤ä¸ªçš„æ­£ç¡®æ€§å¾ˆå¥½ç†è§£ï¼Œç¬¬ä¸‰ä¸ªçš„æ­£ç¡®æ€§å¦‚ä½•ä¿è¯å‘¢ï¼Ÿæˆ‘ä»¬è€ƒè™‘åˆ°è™½ç„¶æˆ‘ä»¬åªæ›´æ–°äº†ç¬¬ä¸€ä¸ªï¼Œä½†æ˜¯æˆ‘ä»¬ç¬¬ä¸€ç§æƒ…å†µä¹Ÿå°±äº¤æ¢äº†ä¸¤ä¸ªå­åºåˆ—ï¼Œæ‰€ä»¥äº‹å®ä¸Šæˆ‘ä»¬ä¹Ÿå¯ä»¥ç®—æ›´æ–°äº†ä¸¤ä¸ªå­åºåˆ—çš„ã€‚\næˆ‘ä»¬è¿™æ ·è½¬ç§»æ˜¯ $O(n^3)$ çš„ï¼Œä¸èƒ½é€šè¿‡æœ¬é¢˜ã€‚\næˆ‘ä»¬å¯ä»¥ä¼˜åŒ–è¿™ä¸ª dp ã€‚æˆ‘ä»¬æŒ‰ç…§ç¬¬ä¸€ç»´ $y$ ä»å°åˆ°å¤§ï¼Œç¬¬äºŒç»´ $x$ ä»å°åˆ°å¤§æ›´æ–°ã€‚\nå¯¹äºæ¯ä¸ª y ï¼Œæˆ‘ä»¬å¯ä»¥ç»´æŠ¤ä¸¤ä¸ªæ•°ç»„ $\\text{maxmod[j]},\\text{maxnum[j]}$ï¼Œåˆ†åˆ«ä»£è¡¨åœ¨å½“å‰ $y$ ä¸­ï¼Œï¼ˆå½“å‰è®¡ç®—åˆ° $dp[x][y]$ï¼‰ï¼Œæ»¡è¶³ $0 \\le i \u0026lt; x$ ä¸” $i \\neq y$ çš„æœ€å¤§çš„ dp å€¼ï¼Œè€Œä¸”è¿™äº› $a[i]$ åœ¨æ¨¡ 7 çš„ä½™æ•°ï¼ˆæˆ–æœ¬èº«æ•°å€¼ï¼‰ä¸º $j$ ã€‚\næˆ‘ä»¬å‘ç°è¿™æ ·çš„è½¬ç§»å°±å˜æˆäº† $O(1)$ çš„ã€‚\næ‰€ä»¥ï¼Œæœ€åçš„æ—¶é—´å¤æ‚åº¦å°±å˜æˆäº† $O(n^2)$ ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47  #include \u0026lt;bits/stdc++.h\u0026gt;using namespace std; const int MAXN = 5100,MAXC = 110000; int n,a[MAXN]; int dp[MAXN][MAXN];// dp[x][y] int maxnum[MAXC],maxmod[7]; void init(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n); for(int i = 1;i\u0026lt;=n;i++) scanf(\u0026#34;%d\u0026#34;,\u0026amp;a[i]); } void solve(){ int ans = -1e9; for(int i = 0;i\u0026lt;MAXC;i++) maxnum[i] = -1e9; for(int y = 0;y\u0026lt;=n;y++){ for(int x = 1;x\u0026lt;=n;x++) maxnum[a[x]] = -1e9; for(int i = 0;i\u0026lt;7;i++) maxmod[i] = -1e9; dp[0][y] = dp[y][0]; for(int x = 1;x \u0026lt;= y-1;x++){ dp[x][y] = dp[y][x]; maxnum[a[x]] = max(maxnum[a[x]],dp[x][y]); maxmod[a[x] % 7] = max(maxmod[a[x] % 7],dp[x][y]); } for(int x = y+1;x\u0026lt;=n;x++){ dp[x][y] = -1e9; dp[x][y] = max(dp[x][y],maxnum[a[x]-1] + 1); dp[x][y] = max(dp[x][y],maxnum[a[x]+1] + 1); dp[x][y] = max(dp[x][y],maxmod[a[x]%7] + 1); dp[x][y] = max(dp[x][y],dp[0][y] + 1); maxnum[a[x]] = max(maxnum[a[x]],dp[x][y]); maxmod[a[x] % 7] = max(maxmod[a[x] % 7],dp[x][y]); } for(int x = 1;x\u0026lt;=n;x++){ ans = max(ans,dp[x][y]); } } printf(\u0026#34;%d\\n\u0026#34;,ans); } int main(){ init(); solve(); return 0; }   ","description":"","id":56,"section":"posts","tags":["åŠ¨æ€è§„åˆ’"],"title":"ã€ŒCF813Dã€Two Melodies-ç®€å•dp","uri":"https://blog.chenqiqian.com/posts/cf813d/"},{"content":"æ–°çš„æŠ€æœ¯æ­£å†²å‡»ç€æ‰‹æœºé€šè®¯å¸‚åœºï¼Œå¯¹äºå„å¤§è¿è¥å•†æ¥è¯´ï¼Œè¿™æ—¢æ˜¯æœºé‡ï¼Œæ›´æ˜¯æŒ‘æˆ˜ã€‚THU é›†å›¢æ——ä¸‹çš„ CS\u0026amp;T é€šè®¯å…¬å¸åœ¨æ–°ä¸€ä»£é€šè®¯æŠ€æœ¯è¡€æˆ˜çš„å‰å¤œï¼Œéœ€è¦åšå¤ªå¤šçš„å‡†å¤‡å·¥ä½œï¼Œä»…å°±ç«™å€é€‰æ‹©ä¸€é¡¹ï¼Œå°±éœ€è¦å®Œæˆå‰æœŸå¸‚åœºç ”ç©¶ã€ç«™å€å‹˜æµ‹ã€æœ€ä¼˜åŒ–ç­‰é¡¹ç›®ã€‚\nåœ¨å‰æœŸå¸‚åœºè°ƒæŸ¥å’Œç«™å€å‹˜æµ‹ä¹‹åï¼Œå…¬å¸å¾—åˆ°äº†ä¸€å…± $N$ ä¸ªå¯ä»¥ä½œä¸ºé€šè®¯ä¿¡å·ä¸­è½¬ç«™çš„åœ°å€ï¼Œè€Œç”±äºè¿™äº›åœ°å€çš„åœ°ç†ä½ç½®å·®å¼‚ï¼Œåœ¨ä¸åŒçš„åœ°æ–¹å»ºé€ é€šè®¯ä¸­è½¬ç«™éœ€è¦æŠ•å…¥çš„æˆæœ¬ä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ï¼Œæ‰€å¹¸åœ¨å‰æœŸè°ƒæŸ¥ä¹‹åè¿™äº›éƒ½æ˜¯å·²çŸ¥æ•°æ®ï¼šå»ºç«‹ç¬¬ $i$ ä¸ªé€šè®¯ä¸­è½¬ç«™éœ€è¦çš„æˆæœ¬ä¸º $P_i$ ã€‚\nå¦å¤–å…¬å¸è°ƒæŸ¥å¾—å‡ºäº†æ‰€æœ‰æœŸæœ›ä¸­çš„ç”¨æˆ·ç¾¤ï¼Œä¸€å…± $M$ ä¸ªã€‚å…³äºç¬¬ i ä¸ªç”¨æˆ·ç¾¤çš„ä¿¡æ¯æ¦‚æ‹¬ä¸º $A_i$ , $B_i$ å’Œ $C_i$ ï¼šè¿™äº›ç”¨æˆ·ä¼šä½¿ç”¨ä¸­è½¬ç«™ $A_i$ å’Œä¸­è½¬ç«™ $B_i$ è¿›è¡Œé€šè®¯ï¼Œå…¬å¸å¯ä»¥è·ç›Š $C_i$â€‹ ã€‚\nTHU é›†å›¢çš„ CS\u0026amp;T å…¬å¸å¯ä»¥æœ‰é€‰æ‹©çš„å»ºç«‹ä¸€äº›ä¸­è½¬ç«™ï¼ˆæŠ•å…¥æˆæœ¬ï¼‰ï¼Œä¸ºä¸€äº›ç”¨æˆ·æä¾›æœåŠ¡å¹¶è·å¾—æ”¶ç›Šï¼ˆè·ç›Šä¹‹å’Œï¼‰ã€‚é‚£ä¹ˆå¦‚ä½•é€‰æ‹©æœ€ç»ˆå»ºç«‹çš„ä¸­è½¬ç«™æ‰èƒ½è®©å…¬å¸çš„å‡€è·åˆ©æœ€å¤§å‘¢ï¼Ÿï¼ˆå‡€è·åˆ© = è·ç›Šä¹‹å’Œ â€“ æŠ•å…¥æˆæœ¬ä¹‹å’Œï¼‰\né¢˜è§£ æœ€å¤§æƒé—­åˆå›¾é—®é¢˜ã€‚\næˆ‘ä»¬è½¬åŒ–æ¨¡å‹ï¼Œæˆ‘ä»¬æŠŠè¾¹å’Œç‚¹éƒ½çœ‹æˆä¸€ä¸ªç‰©å“ï¼Œé‚£ä¹ˆæˆ‘ä»¬æœ‰ä¸€äº›ä¾èµ–å…³ç³»ï¼šå¦‚æœæˆ‘ä»¬æŒ‡å®šè¦é€‰çš„è¾¹çš„é›†åˆï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬è‚¯å®šå¸Œæœ›é€‰çš„ç‚¹çš„æƒå€¼å’Œè¶Šå°è¶Šå¥½ï¼Œç„¶è€Œæˆ‘ä»¬å¿…é¡»è¦é€‰çš„æœ€å°‘çš„ç‚¹å°±æ˜¯æ‰€æœ‰ä¸Šæ–‡è¾¹é›†é‡Œé¢çš„æ¯æ¡è¾¹çš„ç«¯ç‚¹çš„å¹¶ã€‚\nè½¬åŒ–æˆè¿™æ ·çš„é—®é¢˜ä¹‹åï¼Œæˆ‘ä»¬å°±æ˜¯ä¸€ä¸ªæœ€å¤§æƒé—­åˆå›¾çš„é—®é¢˜äº†ã€‚æ‰€æœ‰åŸå›¾ä¸­çš„ç‚¹åœ¨æ–°å›¾ä¸­éƒ½æ˜¯è´Ÿæƒå€¼ï¼Œä»è¯¥ç‚¹åœ¨æ–°å›¾çš„ç‚¹å‘æ±‡ç‚¹è¿ä¸€ä¸ªè¯¥ç‚¹ä»£ä»·ä¸ºå®¹é‡çš„è¾¹ï¼›æ‰€æœ‰åŸå›¾ä¸­çš„è¾¹åœ¨æ–°å›¾ä¸­éƒ½æ˜¯è´Ÿæƒå€¼ï¼Œä»æºç‚¹å‘è¯¥è¾¹åœ¨æ–°å›¾çš„ç‚¹è¿ä¸€ä¸ªè¯¥è¾¹æ”¶ç›Šä¸ºå®¹é‡çš„è¾¹ï¼›å‰©ä½™åŸå›¾çš„è¾¹å‘ä¸¤ä¸ªç«¯ç‚¹å„è¿ä¸€æ¡ inf çš„è¾¹å³å¯ã€‚\nè·‘å‡ºæœ€å¤§æµå³ä¸ºç­”æ¡ˆã€‚\næ­£ç¡®æ€§ï¼Ÿ\n\u0026lt;copy part\u0026gt;\nå¦‚æœå‰²æ‰ç”¨æˆ·çš„è¾¹ï¼Œé‚£ä¹ˆå°±èˆå¼ƒæ‰ä¸€éƒ¨åˆ†æ”¶ç›Šï¼Œå¯ä»¥çœ‹åšæŸå¤±ã€‚\nå¦‚æœå‰²æ‰ä¸­è½¬ç«™çš„è¾¹ï¼Œé‚£ä¹ˆå°±ä»˜å‡ºä¸€å®šä»£ä»·ï¼Œå¯ä»¥çœ‹åšæŸå¤±ã€‚\nåˆå› ä¸ºä¸ä¼šå‰²æ‰INFçš„è¾¹ï¼Œæ‰€ä»¥å°±å·§å¦™çš„è§£å†³äº†é€‰Aå¿…é¡»é€‰Bçš„é—®é¢˜ã€‚\n\u0026lt;\\copy part\u0026gt;\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102  #include \u0026lt;bits/stdc++.h\u0026gt;using namespace std; const int inf = 1e9+7; const int MAXN = 55100,MAXM = 4*MAXN; struct Edge{ int to,nex; int cap,flow; }edge[MAXM*2]; int fir[MAXN],cur[MAXN],ecnt = 2; void addedge(int a,int b,int c){ edge[ecnt] = (Edge){b,fir[a],c,0}; fir[a] = ecnt++; edge[ecnt] = (Edge){a,fir[b],0,0}; fir[b] = ecnt++; } int S,T; int dis[MAXN]; queue\u0026lt;int\u0026gt; q; bool bfs(){ memset(dis,0,sizeof(dis)); memcpy(cur,fir,sizeof(cur)); while(!q.empty()) q.pop(); dis[S] = 1; q.push(S); while(!q.empty()){ int nown = q.front();q.pop(); for(int nowe = fir[nown];nowe;nowe = edge[nowe].nex){ int v = edge[nowe].to; if(edge[nowe].cap \u0026gt; edge[nowe].flow \u0026amp;\u0026amp; dis[v] == 0){ dis[v] = dis[nown] + 1; q.push(v); if(v == T) return 1; } } } return 0; } int dfs(int nown,int limit = inf){ if(limit == 0 || nown == T) return limit; for(int \u0026amp;nowe = cur[nown];nowe;nowe = edge[nowe].nex){ int v = edge[nowe].to; if(edge[nowe].cap \u0026gt; edge[nowe].flow \u0026amp;\u0026amp; dis[v] == dis[nown] + 1){ int f = dfs(v,min(limit,edge[nowe].cap - edge[nowe].flow)); if(f){ edge[nowe].flow+=f; edge[nowe^1].flow -= f; return f; } } } return 0; } int dinic(){ int ans = 0,f = 0; while(bfs()){ while(true){ f = dfs(S); if(f == 0) break; else ans+=f; } } return ans; } int n,m,a[MAXN]; int u[MAXN],v[MAXN],w[MAXN]; void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m); for(int i = 1;i\u0026lt;=n;i++){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;a[i]); } for(int i = 1;i\u0026lt;=m;i++){ scanf(\u0026#34;%d %d %d\u0026#34;,\u0026amp;u[i],\u0026amp;v[i],\u0026amp;w[i]); } } void solve(){//è¾¹åœ¨å‰[1,m]ï¼Œç‚¹åœ¨å [m+1,m+n]  S = n+m+1,T = n+m+2; for(int i = 1;i\u0026lt;=n;i++)addedge(m+i,T,a[i]); for(int i = 1;i\u0026lt;=m;i++){ addedge(S,i,w[i]); addedge(i,m+u[i],inf),addedge(i,m+v[i],inf); } int ans = -dinic(); for(int i = 1;i\u0026lt;=m;i++){ ans += w[i]; } printf(\u0026#34;%d\\n\u0026#34;,ans); } int main(){ init(); solve(); return 0; }   ","description":"","id":57,"section":"posts","tags":["ç½‘ç»œæµ","æœ€å¤§æƒé—­åˆå­å›¾","å›¾è®º"],"title":"ã€ŒNOI2006ã€æœ€å¤§è·åˆ©-ç½‘ç»œæµ-æœ€å¤§æƒé—­åˆå­å›¾","uri":"https://blog.chenqiqian.com/posts/noi2006-benefit/"},{"content":"æœ¬æ¸¸è®°æ˜¯çœŸçš„æ¸¸ç©è¿‡ç¨‹è®°å½•ã€‚\nè¿™ç¯‡æ–‡ç« æ¯ä¸ªé˜¶æ®µéƒ½æ˜¯è¿‡å®Œå°±ç›´æ¥å†™äº†\u0026hellip;æœ‰å¯èƒ½æ¯”è¾ƒå•°å—¦ï¼Œä¼šæœ‰æ¯”è¾ƒå¤šçš„å¿ƒç†å•¥çš„å§\u0026hellip;\nDay-?,2019-12-xx ä¸å¯æè¿°ã€‚\nupd on Day1 æ¸æ¸åæ‚”ã€‚æˆ‘ä¹Ÿè®¸å°±ä¸åº”è¯¥æ¥å—çš„å§ã€‚\nDay-2,2019-01-19 è‹¥å¹²å¤©å‰è®¢å¥½äº†ä¹˜åCA1315èˆªç­ä»åŒ—äº¬é£å¾€å¹¿å·ã€‚ä»Šå¤©åä¸€ç‚¹å¯ä»¥å€¼æœºä¹‹åå‘ç°ï¼Œç«Ÿç„¶ä»åŸæ¥çš„777-300ERæ¢æˆäº†747-8Iï¼Œæ„Ÿè§‰æœ‰ä¸€ç§ä¸­å¥–çš„æ„æ€ã€‚\nå€¼æœºå€¼äº†ä¸€ä¸ªåœ¨é£æœºæœ€åçš„ä½ç½®ï¼Œåº”è¯¥è¿˜ç®—æ˜¯æ¯”è¾ƒå®½æ•ï¼Œåªä¸è¿‡æ˜¯æ²¡æœ‰é çª—çš„ä½ç½®ã€‚\nå›å®¶æ”¶æ‹¾è¡Œæï¼Œè¢«è®­æ–¥ä¸ä¼šç”Ÿæ´»qwqå°±å¸¦äº†ä¸€ä¸ªå¤§çš„åŒè‚©èƒŒåŒ…å°±æ»šç²—äº†ã€‚\nDay-1,2019-01-20 æ—©æ—©åˆ°æœºåœºï¼Œå‘ç°é£æœºæ—©å°±åœ¨ç­‰æˆ‘ä»¬äº†ã€‚\nè¿˜çœ‹åˆ°äº†ä¸€ä¸ªæ±‰èçš„747-8é™è½ï¼Œå¤ªç¾äº†ã€‚ä¹Ÿçœ‹åˆ°äº†å›½èˆªå½©ç»˜çš„ 77W ï¼Œæ„Ÿè§‰ååˆ†èˆ’é€‚ã€‚ä¸Šé£æœºå‰è¿˜çœ‹äº†ä¸€é›†ç©ºä¸­æµ©åŠ«ï¼Œæ„Ÿè§‰ååˆ†èˆ’é€‚ã€‚\nä¸Šé£æœºä¹‹åä¸åˆ°äº”åˆ†é’Ÿå°±æŠŠè‡ªå·±çš„å°ç”µè§†æåäº†ï¼Œäºæ˜¯å¼€å§‹å†™ä»£ç ã€‚\nå†™ SA å†™åˆ°ä¸€åŠå‘ç°åº§ä½åº•ä¸‹çš„æ’åº§å……ä¸ä¸Šç”µï¼Œäºæ˜¯æ”¶èµ·ç”µè„‘å¼€å§‹ç©æ‰‹æœºï¼Œå‘ç°å¹¶æ²¡æœ‰å•æœºæ¸¸æˆï¼Œäºæ˜¯å°±å¼€å§‹é¢“åºŸï¼Œ\nå¹¿å·çš„äº‘è¶…çº§ä½ \u0026amp; åšï¼Œåˆ°äº† 1200 ç±³ä»¥ä¸‹ä¹‹åæ‰èƒ½å‹‰å¼ºçœ‹åˆ°åœ°é¢ï¼Œæ‰€ä»¥è™½ç„¶æˆ‘ä»¬ä»å—ä¾§è¿›åœºäº”è¾¹ä¸‹é¢ç»è¿‡å¹¿å·å¸‚åŒºï¼Œä½†æ˜¯ä»€ä¹ˆéƒ½çœ‹ä¸è§.jpegï¼Œ\nä¸‹é£æœºä¹‹åå°±æ˜¯å»é…’åº—ï¼Œä»å¸‚åŒºåŒ—è¾¹å·¨è¿œåˆ°å¸‚åŒºä¸œè¾¹å·¨è¿œçš„é…’åº—å…ˆä½ä¸€æ™šä¸Šã€‚å‡ å¤©å‰å°±çŸ¥é“è¦å’Œå¯çˆ±çš„ï¼ˆå¹¶ä¸ï¼‰ç”·å­©å­ä½ä¸€ä¸ªå¤§åºŠæˆ¿ï¼Œè¿˜æœ‰äº›æ¿€åŠ¨ï¼ˆå¹¶ä¸ï¼‰ã€‚\nåˆ°äº†é…’åº—ä¹‹åå‘ç°é…’åº—æœ‰ä¸€ä¸ªé˜³å°ï¼Œæ™¯è‰²è¶…çº§ç¾ä¸½çš„è¯¶ï¼ç›´æ¥ä¿ƒæˆäº†æˆ‘å†³å®šåœ¨23å·æ™šä¸Šæºœå‡ºæ¥åœ¨é…’åº—ä½ä¸€æ™šä¸Šï¼Œ\næ™šé¥­ä¹‹å‰å¦ä¸€å±‹åœ¨ç©ç‚‰çŸ³ï¼Œæˆ‘è¿‡å»å¼€äº†ä¸€åŒ…æå‡ºæ¥ä¸ªæ©™å¡ï¼Œæ®è¯´rp\u0026ndash;ï¼Ÿï¼Ÿï¼Ÿ\næ™šé¥­å»åƒäº†è’¸æ±½ç«é”…ï¼ˆä¹Ÿè®¸ä¸æ˜¯ï¼‰ï¼Œæ„Ÿåˆ°éå¸¸èµ›è‰‡ã€‚\nè¿™å¤©æ™šä¸Šè¿˜æœ‰ä¸€åœº 8 ç‚¹çš„ Div2 çš„ CF ï¼Œäºæ˜¯å››äººå¼€é»‘å±€ï¼Œç»“æœæ˜¯ä¸€ä¸ªå¥‡è‘©åœºï¼ŒABCä¸‰é“SBé¢˜ï¼ŒDæ˜¯ä¸ªæ¨¡æ‹Ÿï¼ŒEæ˜¯ä¸ªçˆ†æœï¼Ÿï¼Ÿï¼Ÿæˆ‘å­¦çš„ç®—æ³•æœ‰ä»€ä¹ˆç”¨å—ï¼Ÿï¼Ÿï¼Ÿä¸ä¼šåš Eï¼Œè¯¢é—®éš”å£ç¥ä»™ï¼Œå¾—åˆ°å›å¤ï¼šâ€œçˆ†æœï¼Œâ€ ç„¶åå°± PP äº†ï¼Œ\nèµ›åç‰¹åˆ«æç¬‘ï¼ŒæŸäººçš„ E è¢«åŒå±‹ç¥ä»™ X æ‰äº†ï¼Œç„¶è€Œå¹¶æ²¡æœ‰FSTï¼Œä»¤äººå‘æŒ‡ï¼Œ\nDay1,2019-01-21 ä¸ƒç‚¹åŠèµ·åºŠï¼Œæ„Ÿåˆ°éå¸¸èˆ’é€‚ï¼Œå¤§æ¦‚æ˜¯è¿‘è‹¥å¹²å¤©ç¡çš„æœ€å¤šçš„ä¸€æ¬¡..ï¼Ÿæ—©ä¸Šåƒé¥­ï¼Œçœ‹åˆ°ä¸€è½¦é•¿éƒ¡çš„åŒå­¦ï¼ˆå¿½ç„¶å®³æ€•ï¼‰ï¼Œä¼°è®¡æ‰€æœ‰äººéƒ½æ¯”æˆ‘å‰å®³ï¼ˆå¿«å“­äº†ï¼‰\nåƒå®Œé¥­å°¾éšé•¿éƒ¡å¤§å†›å‰å¾€å¹¿å·äºŒä¸­ï¼Œé•¿éƒ¡çš„äººèµ°çš„å·¨å¿«ï¼Œç”šè‡³å®Œå…¨è·Ÿä¸ä¸Šä»–ä»¬çš„èµ°è·¯ï¼Œå·¨ä½¬ä»¬æœç„¶æ“…é•¿èµ°è·¯\u0026hellip;\nåˆ°åœ°æ–¹ä¹‹åé¢†äº†èƒ¸ç‰Œï¼Œé¢†äº†è¡£æœï¼Œé¢†äº†è¢‹å­ï¼Œç„¶åå»å®¿èˆï¼Œå®¿èˆæ˜¯åœ¨æ—è¾¹çš„å®éªŒå­¦æ ¡ï¼Œå¤§æ¦‚ç¦»è€ƒè¯•çš„åœ°æ–¹æœ‰ä¸€ä¸ªå¤§æ“åœº+ä¸€æ ‹å¤§æ¥¼é‚£ä¹ˆè¿œã€‚\nè¿™ä¸ªå¤§æ“åœºå¾ˆniceï¼Œæœ‰10ä¸ªè·‘é“ï¼Œè¿˜æ˜¯å¤©ç„¶è‰ï¼ˆè™½ç„¶æˆ‘ä»¬åˆ°çš„æ—¶å€™å·²ç»å‡ ä¹åªå‰©ä¸‹åœŸäº†ï¼‰ï¼Œç¯®çƒåœºæœ‰10å—ï¼Œï¼ˆç®€å•å¯»è§…ï¼‰ï¼Œè¿˜æœ‰å®¤å†…çš„å¸¦çœ‹å°çš„ç¯®çƒé¦†\u0026amp;ç¾½æ¯›çƒé¦†ï¼Œæ¯”ç ´æ ¡ç®€ç›´ä¸çŸ¥é“é«˜åˆ°å“ªé‡Œå»äº†ã€‚\nç„¶åå°±æ˜¯è¯•æœºï¼Œç”µè„‘è¿˜ä¸é”™ï¼Œæœ‰çš„æ—¶å€™æœ‰é˜³å…‰çœŸæ˜¯éå¸¸emmmï¼ŒVSCodeç¯å¢ƒå¦™å•Šï¼Œé…å®Œä¹‹åæ•²äº†ä¸ªåç¼€æ•°ç»„å’ŒFWTï¼Œåç¼€æ•°ç»„è¿˜æ•²é”™äº†å¥½å¤šï¼ˆæ‚è„¸ï¼‰FWTç”šè‡³æ²¡æœ‰å†™å®Œï¼Œæ„Ÿåˆ°éå¸¸ä¸å¦™ã€‚\nä¸€è·¯å›´è§‚ç¥ä»™ä¸æ•¢æ­è¯ï¼Œäºæ˜¯å›å®¿èˆå¾…äº†ä¼šã€‚å®¿èˆå­˜åœ¨ä¸€ä¸ªæœºå™¨ä¸æ–­æŒ–åœŸï¼ˆæ£åœ°ï¼‰å‘å‡ºå·¨å¤§çš„å£°éŸ³ã€‚åœ¨å®¿èˆçœ‹äº†çœ‹ LCT æ¿å­ï¼Œå’Œä¸€å¤§å †å…¶ä»–çš„æ¿å­ï¼Œç„¶åå°±è¦å»åƒé¥­äº†ã€‚\nåƒé¥­çš„åœ°æ–¹å’Œä¸€å¤§å †å¹¿å·äºŒä¸­çš„å­¦ç”Ÿä¸€èµ·åƒäº†é¥­ï¼Œç››é¥­ç››çš„å·¨å¤šï¼Œç”šè‡³æ²¡æœ‰åƒå®Œ\u0026hellip;\nä¸‹åˆçš„è€ƒè¯•ä¸æï¼Œå¤§æ¦‚å°±æ˜¯å‡åˆ†200èœé¸¡åˆ†æ•°40\u0026hellip;æˆä¸ºå­¦æ ¡ rk-1 \u0026hellip;è‡ªå·±è®²è¿‡çš„è«é˜Ÿéƒ½ä¸ä¼šï¼ŒæŠŠé—®é¢˜æƒ³æˆäºŒç»´çš„ç„¶åå°±ååäº†\u0026hellip;å¿ƒæƒ…ä¸æ˜¯å¾ˆå¥½ï¼Œå¤§æ¦‚éœ€è¦ç»§ç»­è®¤æ¸…è‡ªå·±èœé¸¡çš„äº‹å®ã€‚\nå¼€å¹•å¼æ²¡ä»€ä¹ˆå¥½ç©çš„ã€‚è®²è¯ * nã€‚\nå¹¿ä¸œçš„å¦¹å­å¹³å‡è´¨é‡æ¯”åŒ—æ–¹é«˜ã€‚å—¯ã€‚\næ„Ÿè§‰å¹¶ä¸æ˜¯éå¸¸å¥½ï¼Œåœ¨è€ƒåœºä¸Šåäº†5ä¸ªå°æ—¶å•¥éƒ½ä¸ä¼šçš„æ„Ÿè§‰çœŸçš„è®©äººè‡ªé—­ã€‚ç¬¬ä¸€æ¬¡ï¼ˆä¹Ÿè®¸çœé€‰çš„æ—¶å€™æ‰æ˜¯ç¬¬ä¸€æ¬¡ï¼‰æ„Ÿåˆ°è¿™ä¹ˆç»æœ›\u0026hellip;ä½ å¸Œæœ›èƒ½å¤Ÿåšå¥½çš„äº‹æƒ…å´æ²¡æœ‰æ”¹å˜çš„èƒ½åŠ›\u0026hellip;ä¹Ÿè®¸ä¸‰ä¸ªæœˆå‰æ ¹æœ¬å°±ä¸åº”è¯¥ç»§ç»­å‘¢\u0026hellip;\nDay2,2019-01-22 æ—©é¥­æ²¡ä»€ä¹ˆå¥½ç©çš„qwq\næ—©ä¸Šå…«ç‚¹é’Ÿåˆ°è€ƒåœºåå¥½ï¼Œè€ƒè¯•æ²¡å•¥å¥½ç©çš„\u0026hellip;Aæ‰äº†T1ä¹‹åä¸ä¼šæ±‚å‡¸åŒ…ï¼Œå¡åœ¨T3ä¸èƒ½åŠ¨å¼¹ï¼Œåˆæ··äº†ä¸ªæ¯”å¤§ä¼—åˆ†\u0026ndash;çš„åˆ†æ•°ï¼Œä»¤äººä¸çˆ½qaq\nå‘ç°è¿™ä¸ªå­¦æ ¡çš„åŸºç¡€è®¾æ–½çœŸæ˜¯å¥½å•Šï¼Œè¿˜æœ‰éœ²å¤©çš„æ¸¸æ³³æ± \u0026hellip;ä¸çŸ¥é“æ¯”æˆ‘ä»¬é«˜åˆ°å“ªé‡Œå»äº†qaq\nåƒå®Œé¥­å’Œæœ¬æ ¡é€‰æ‰‹è°ˆç¬‘é£ç”Ÿï¼Œå¤§å®¶è°ˆè®ºè‡ªå·±æŒ‚çš„åˆ†emmmæƒ¨æ¡ˆç°åœº\u0026hellip;\næ™šä¸Šè€ƒè¯•ä»¤äººè‡ªé—­\u0026hellip;åˆå›°åˆç´¯\u0026hellip;\nä¸€å…±å…«é“é¢˜ï¼Œ3hã€‚å·¥ç¨‹å®ç°å¤§èµ›ï¼Œåº“å‡½æ•°å®ç°å¤§èµ›\u0026hellip;å¡åœ¨T4å‘ç°è¦å®ç°CRCï¼Œç„¶åç›´åˆ°è€ƒè¯•ç»“æŸå‰30åˆ†é’Ÿæ‰å‘ç°CRCå¯ä»¥æš´åŠ›ï¼çœŸä»¤äººè‡ªé—­\u0026hellip;\n","description":"","id":58,"section":"posts","tags":null,"title":"å¹¿å·æ—…æ¸¸è®°","uri":"https://blog.chenqiqian.com/posts/trip-thuwc2019/"},{"content":"ä¸ºäº†æœ‰è¯´æœåŠ›åœ°å‘é˜¿ç±³å·´å±•ç¤ºé˜¿ç±³å·´çš„ä½œæ–‡æ˜¯å¤šä¹ˆè®©äººè§‰å¾—â€œçœ¼ç†Ÿâ€ï¼Œå°å¼ºæƒ³å‡ºäº†ä¸€ä¸ªè¯„å®šä½œæ–‡ â€œç†Ÿæ‚‰ç¨‹åº¦â€çš„é‡åŒ–æŒ‡æ ‡ï¼š$L_0$ .å°å¼ºé¦–å…ˆå°†ä½œæ–‡è½¬åŒ–æˆä¸€ä¸ª $01$ ä¸²ã€‚ä¹‹åï¼Œå°å¼ºæœé›†äº†å„è·¯åå®¶çš„æ–‡ç« ï¼ŒåŒæ ·åˆ†åˆ«è½¬åŒ–æˆ $01$ ä¸²åï¼Œæ•´ç†å‡ºä¸€ä¸ªåŒ…å«äº† $M$ ä¸ª $01$ ä¸²çš„â€œ æ ‡å‡†ä½œæ–‡åº“ â€ã€‚\nå°å¼ºè®¤ä¸ºï¼šå¦‚æœä¸€ä¸ª $01$ ä¸²é•¿åº¦ä¸å°‘äº $L$ ä¸”åœ¨ æ ‡å‡†ä½œæ–‡åº“ ä¸­çš„æŸä¸ªä¸²é‡Œå‡ºç°è¿‡ï¼ˆå³ï¼Œå®ƒæ˜¯ æ ‡å‡†ä½œæ–‡åº“ çš„ æŸä¸ªä¸² çš„ä¸€ä¸ª è¿ç»­å­ä¸² ï¼‰ï¼Œé‚£ä¹ˆå®ƒæ˜¯â€œ ç†Ÿæ‚‰ â€çš„ã€‚å¯¹äºä¸€ç¯‡ä½œæ–‡ï¼ˆä¸€ä¸ª $01$ ä¸²ï¼‰Aï¼Œå¦‚æœèƒ½å¤ŸæŠŠ A åˆ†å‰²æˆè‹¥å¹²æ®µå­ä¸²ï¼Œå…¶ä¸­â€œ ç†Ÿæ‚‰ â€ çš„å­ä¸²çš„ é•¿åº¦æ€»å’Œ ä¸å°‘äº A æ€»é•¿åº¦çš„ $90%$ï¼Œé‚£ä¹ˆç§° A æ˜¯ â€œ ç†Ÿæ‚‰çš„æ–‡ç«  â€ã€‚ $L_0$ æ˜¯èƒ½å¤Ÿè®© $A$ æˆä¸º â€œ ç†Ÿæ‚‰çš„æ–‡ç«  â€ çš„ æ‰€æœ‰ $L$ çš„æœ€å¤§å€¼ ï¼ˆå¦‚æœä¸å­˜åœ¨è¿™æ ·çš„ $L$ ï¼Œé‚£ä¹ˆè§„å®š $L_0 = 0$ ï¼‰ã€‚\né“¾æ¥ Luogu P4022\né¢˜è§£ æˆ‘ä»¬æ³¨æ„åˆ°é¦–å…ˆå¤–é¢å¯ä»¥å¥—ä¸€ä¸ªäºŒåˆ†ï¼Œå•è°ƒæ€§æ˜¾ç„¶æˆç«‹ã€‚\næˆ‘ä»¬éœ€è¦å¯¹è¿™ä¸ªåœ°æ–¹æ‰€æœ‰çš„æ ‡å‡†ä½œæ–‡åº“å»ºç«‹ä¸€ä¸ªå¹¿ä¹‰ SAM ï¼ˆæˆ–è€…ä¸²ä¸€èµ·ä¹Ÿå¯ä»¥ï¼ŒåŸºæœ¬ä¸Šæ˜¯ç­‰ä»·çš„ï¼‰ã€‚\nç„¶åæˆ‘ä»¬çš„é—®é¢˜å˜æˆäº†å­˜åœ¨æ€§é—®é¢˜ï¼šæ˜¯å¦å­˜åœ¨ä¸€ç§åˆ†å‰²æ–¹æ¡ˆï¼Œå…¶ä¸­ç†Ÿæ‚‰çš„å­ä¸²çš„é•¿åº¦å‡ä¸å°äº $L$ ä¸”åœ¨æ ‡å‡†ä½œæ–‡åº“é‡Œé¢å‡ºç°è¿‡ï¼Œä¸”å’Œå¤§äº $90%$ ã€‚\næˆ‘ä»¬ç”¨ä¸€ä¸ª $dp[i]$ è¡¨ç¤ºåœ¨è¿™ç§é™åˆ¶ä¸‹åœ¨ $[1,i]$ çš„å­ä¸²çš„æœ€å¤§çš„ç†Ÿæ‚‰çš„é•¿åº¦ï¼Œç„¶åæˆ‘ä»¬æ˜æ˜¾æœ‰ä¸€ä¸ª $O(n^2)$ çš„è§£æ³•ï¼ˆéœ€è¦é¢„å¤„ç†æˆ‘ä»¬è¦åˆ¤æ–­çš„ä½œæ–‡çš„æ¯ä¸ªä½ç½®åœ¨å¹¿ä¹‰SAMä¸Šèƒ½å¤Ÿæœ€é•¿åŒ¹é…çš„é•¿åº¦ï¼Œè¿™é‡Œç”¨åœ¨SAMä¸Šè·‘+æš´åŠ›è·³ Fail æ ‘ï¼Œåˆ¤æ–­å½“å‰æœ€é•¿æ˜¯ä¸æ˜¯åœ¨ä½ è¦ç¬¦åˆçš„åŒºé—´ï¼Œç†è®ºæ—¶é—´å¤æ‚åº¦ $O(n \\log n)$ï¼Œä¸ä¼šè¯æ˜ï¼‰ã€‚\nçŒœæµ‹å­˜åœ¨å†³ç­–å•è°ƒæ€§ï¼Œäº‹å®ä¸Šçš„ç¡®æˆç«‹ã€‚ç”¨å•è°ƒé˜Ÿåˆ—ç»´æŠ¤å³å¯ã€‚\næ‰€ä»¥æ—¶é—´å¤æ‚åº¦å¤§çº¦æ˜¯ï¼š $O(n \\log n)$ ~ $O(n \\log^2 n)$ $\\approx O(\\text{èƒ½è¿‡})$ ã€‚\nåç¼€è‡ªåŠ¨æœºçš„é¢˜å•Šï¼Œæ„Ÿè§‰æ—¶é—´å¤æ‚åº¦å¯¹å°±è¡Œäº†ï¼Œæ¯”å¦‚ NOID1T3 ã€‚å¤šå¦™å•Šï¼\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119  #include \u0026lt;bits/stdc++.h\u0026gt;using namespace std; const int MAXN = 2100000; namespace SAM{ int c[MAXN][2],l[MAXN],fa[MAXN],cnt,last,rt; void init(){rt = last = ++cnt;} int newnode(int x){l[++cnt] = x;return cnt;} int ins(int p,int x){ if(c[p][x]){ int q = c[p][x]; if(l[q] == l[p] + 1) last = q; else{ int nq = newnode(l[p]+1);last = nq; memcpy(c[nq],c[q],sizeof(c[q])); fa[nq] = fa[q];fa[q] = nq; for(;c[p][x] == q;p = fa[p]) c[p][x] = nq; } } else{ int np = newnode(l[p]+1);last = np; for(;p \u0026amp;\u0026amp; (!c[p][x]);p = fa[p]) c[p][x] = np; if(!p) fa[np] = rt; else{ int q = c[p][x]; if(l[q] == l[p]+1) fa[np] = q; else{ int nq = newnode(l[p]+1); memcpy(c[nq],c[q],sizeof(c[q])); fa[nq] = fa[q];fa[q] = fa[np] = nq; for(;c[p][x] == q;p = fa[p]) c[p][x] = nq; } } } return last; } void ins(char *s){ int n = strlen(s),p = rt; for(int i = 0;i\u0026lt;n;i++) p = ins(p,s[i]-\u0026#39;0\u0026#39;); } void calmax(int n,char *s,int *res){ int now = rt,cur = 0; for(int i = 0;i\u0026lt;n;i++){ int x = s[i] - \u0026#39;0\u0026#39;; if(c[now][x]){ cur++,now = c[now][x]; } else{ while(now \u0026amp;\u0026amp; !c[now][x]) now = fa[now]; if(now == 0) now = rt,cur = 0; else cur = l[now] + 1,now = c[now][x]; } res[i+1] = cur; } } } int n,m; char s[MAXN]; int maxlen[MAXN]; int dp[MAXN]; int q[MAXN],fi,la; bool check(int n,int L){// é•¿åº¦ä¸º L çš„æƒ…å†µä¸‹æ˜¯å¦å¯ä»¥å®ç°  fi = 0,la = -1; for(int i = 0;i \u0026lt; L;i++) dp[i] = 0; for(int i = L;i \u0026lt;= n;i++){ // printf(\u0026#34;%d:%d\\n\u0026#34;,i,maxlen[i]);  dp[i] = dp[i-1]; while(fi \u0026lt;= la \u0026amp;\u0026amp; dp[q[la]] + (i-q[la]) \u0026lt;= dp[i-L] + (i-(i-L))) la--; q[++la] = i-L; while(fi \u0026lt;= la \u0026amp;\u0026amp; q[fi] \u0026lt; i - maxlen[i]) fi++; if(fi \u0026lt;= la) dp[i] = max(dp[i],dp[q[fi]] + (i-q[fi])); } // printf(\u0026#34;%d\\n\u0026#34;,dp[n]);  return dp[n] * 10 \u0026gt;= n * 9; } int cal(char *s){ int n = strlen(s); SAM::calmax(n,s,maxlen); int L = 1,R = 1000000; while(L != R){ int mid = (L+R+1)/2; if(!check(n,mid)){ R = mid-1; } else{ L = mid; } } return L; } void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m); SAM::init(); for(int i = 1;i \u0026lt;= m;i++){ scanf(\u0026#34;%s\u0026#34;,s); SAM::ins(s); } } void solve(){ for(int i = 1;i\u0026lt;=n;i++){ scanf(\u0026#34;%s\u0026#34;,s); printf(\u0026#34;%d\\n\u0026#34;,cal(s)); } } int main(){ init(); solve(); return 0; }   ","description":"","id":59,"section":"posts","tags":["å­—ç¬¦ä¸²","åç¼€è‡ªåŠ¨æœº"],"title":"ã€ŒCTSC2012ã€ç†Ÿæ‚‰çš„æ–‡ç« -å¹¿ä¹‰åç¼€è‡ªåŠ¨æœº","uri":"https://blog.chenqiqian.com/posts/ctsc2012-familiar/"},{"content":"å®šä¹‰ä¸€ä¸ªå®Œå…¨äºŒå‰æ ‘æ ‘é«˜ä¸ºæ ¹èŠ‚ç‚¹åˆ°å¶å­èŠ‚ç‚¹ç»è¿‡çš„è¾¹æ•°ã€‚\nç»™å®šä¸€ä¸ªæ ‘é«˜ä¸º $h(1 \\le h \\le 30)$ çš„å®Œå…¨äºŒå‰æ ‘ï¼Œå…¶ä¸­ç¬¬ $x$ ä¸ªèŠ‚ç‚¹çš„å·¦å„¿å­ä¸ºç¬¬ $2x$ ä¸ªèŠ‚ç‚¹ï¼Œå³å„¿å­ä¸ºç¬¬ $2x+1$ ä¸ªèŠ‚ç‚¹ã€‚\nç°åœ¨æœ‰ $q(1 \\le q \\le 10^{5})$ ä¸ªï¼Œåˆ†ä¸ºä¸¤ç§æ“ä½œï¼š\n add v e ï¼ˆ $1 \\le v \\le 2^{h+1}-1,1 \\le e \\le 10^4$ ï¼‰è¡¨ç¤ºç»™ç¬¬ $v$ ä¸ªèŠ‚ç‚¹çš„æƒå€¼åŠ  $e$ ã€‚ decay æ“ä½œã€‚æˆ‘ä»¬åœ¨è¿™ä¸ªäºŒå‰æ ‘é‡Œé¢ä»¥ç­‰æ¦‚ç‡é€‰æ‹©ä¸€ä¸ªå¶å­èŠ‚ç‚¹ï¼Œå°†è¿™ä¸ªå¶å­èŠ‚ç‚¹åˆ°æ ¹çš„è·¯å¾„ä¸Šæ‰€æœ‰çš„è¾¹éƒ½åˆ å»ã€‚åœ¨åˆ é™¤åï¼Œæ ‘ä¼šå½¢æˆè‹¥å¹²ä¸ªè”é€šå—ï¼Œæˆ‘ä»¬å®šä¹‰æŸä¸ªè”é€šå—çš„çš„æƒå€¼ä¸ºè¿™ä¸ªè”é€šå—å†…æ‰€æœ‰èŠ‚ç‚¹çš„æƒå€¼ä¹‹å’Œã€‚æˆ‘ä»¬å®šä¹‰åˆ é™¤åçš„æ ‘çš„æƒå€¼ä¸ºå½¢æˆçš„æ‰€æœ‰è”é€šå—çš„æƒå€¼çš„æœ€å¤§å€¼ã€‚è¯·ä½ æ±‚å‡ºè¿™ä¸ªå€¼çš„æœŸæœ›ã€‚æ¯æ¬¡åˆ é™¤åä¼šæ¢å¤æ‰€æœ‰åˆ é™¤çš„è¾¹ã€‚  é“¾æ¥ Codeforces\né¢˜è§£ è€ƒè™‘æˆ‘ä»¬åœ¨æ ‘ä¸Šéšæœºèµ°å‡ºä¸€ä¸ªè·¯å¾„ã€‚æˆ‘ä»¬å‘ç°ï¼Œæˆ‘ä»¬æ¯ä¸ªåœ°æ–¹ç›¸å½“äºæœ‰ä¸¤ä¸ªå†³ç­–ï¼šå¾€å·¦èµ°ï¼Œå¾€å³èµ°ï¼Œä¸¤ä¸ªçš„æ¦‚ç‡æ˜¯ç›¸åŒçš„ã€‚\næˆ‘ä»¬å¦‚æœè®¾å½“å‰èŠ‚ç‚¹ä¸ºä¸º $x$ï¼Œé‚£ä¹ˆå¾€å·¦èµ°çš„è¯å°±ä¼šäº§ç”Ÿä¸€ä¸ªå®Œå…¨ä¸ä¼šæ›´æ”¹çš„è”é€šå—ï¼ˆ$sum[rs[x]] +v[x]$ï¼‰ã€‚å¦‚æœå­˜åœ¨ $sum[rs[x]] + v[x] \\ge sum[ls[x]]$ è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å‘ç°ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ€ä¹ˆèµ°ï¼Œäº§ç”Ÿçš„è”é€šå—éƒ½ä¸ä¼šæ¯”å·²ç»äº§ç”Ÿçš„è¿™ä¸ª $sum[rs[x]] + v[x]$ å¤§ã€‚æ‰€ä»¥æˆ‘ä»¬å°±ä¸ç”¨èµ° $sum$ è¾ƒå°çš„é‚£è¾¹äº†ï¼Œå› ä¸ºå®ƒä»¬çš„è´¡çŒ®å·²ç»å¯ä»¥è®¡ç®—äº†ã€‚\nè¿™æ ·çš„è¯æˆ‘ä»¬æ¯æ¬¡å†³ç­–éƒ½å¯ä»¥åªèµ°ä¸€è¾¹ï¼ŒåŒæ—¶è®¡ç®—å‡ºå‰©ä¸‹çš„ä¸€è¾¹çš„æ‰€æœ‰ç­”æ¡ˆä¹‹å’Œã€‚åœ¨èµ°çš„è¿‡ç¨‹ä¸­ç»´æŠ¤ä¸€ä¸‹å·²ç»å­˜åœ¨çš„è”é€šå—çš„æœ€å¤§å€¼å³å¯ã€‚\nåŠ çš„è¯ç›´æ¥æš´åŠ›åœ¨æ ‘ä¸Šç»´æŠ¤ä¸€ä¸ªå­æ ‘å’Œå³å¯ã€‚\næ—¶é—´å¤æ‚åº¦ï¼š$O(q \\times h)$\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70  #include \u0026lt;bits/stdc++.h\u0026gt;using namespace std; const int MAXN = 110000,LOGN = 31; namespace Tree{ int sumn[MAXN*LOGN],ls[MAXN*LOGN],rs[MAXN*LOGN],cnt = 1; void upd(int nown,int v){ static int tmp[40];int ecnt = 0; for(int i = nown;i;i\u0026gt;\u0026gt;=1) tmp[++ecnt] = i\u0026amp;1; int now = 1; for(int i = ecnt-1;i\u0026gt;=0;--i){ sumn[now] += v; if(tmp[i] == 0){ if(!ls[now]) ls[now] = ++cnt; now = ls[now]; } else{ if(!rs[now]) rs[now] = ++cnt; now = rs[now]; } } } double decay(){ int now = 1,nowmax = -1e9; double ans = 0, p = 1; while(now != 0){// now éç©º  int lson = sumn[ls[now]],rson = sumn[rs[now]],val = sumn[now] - lson - rson; p *= 0.5; ans += p * max(nowmax,max(lson,rson)+val); if(lson \u0026gt; rson){ nowmax = max(nowmax,rson+val); now = ls[now]; } else{ nowmax = max(nowmax,lson+val); now = rs[now]; } } ans += p * nowmax; return ans; } } int h,q; void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;h,\u0026amp;q); } void solve(){ for(int i = 1;i\u0026lt;=q;i++){ char s[12]; int a,b; scanf(\u0026#34;%s\u0026#34;,s); if(s[0] == \u0026#39;a\u0026#39;){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;a,\u0026amp;b); Tree::upd(a,b); } else if(s[0] == \u0026#39;d\u0026#39;){ printf(\u0026#34;%.8lf\\n\u0026#34;,Tree::decay()); } } } int main(){ init(); solve(); return 0; }   ","description":"","id":60,"section":"posts","tags":["æœŸæœ›","æ ‘å½¢ç»“æ„"],"title":"ã€ŒCF68Dã€Half-decay tree-æœŸæœ›çæé¢˜","uri":"https://blog.chenqiqian.com/posts/cf68d/"},{"content":"æˆ‘ä»¬å®šä¹‰ä¸€ä¸ª DNA åºåˆ—ä¸ºä»…æœ‰ ATCG å››ä¸ªå­—æ¯çš„å­—ç¬¦ä¸²ã€‚\nç»™å‡º $m(1 \\le m \\le 10)$ ä¸ª DNA åºåˆ—æ¨¡å¼ä¸² $s_i$ï¼Œæ¯ä¸ªé•¿åº¦å‡ä¸è¶…è¿‡ $10$ ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ª DNA åºåˆ— $w$ æ˜¯å¥½çš„ï¼Œå½“ä¸”ä»…å½“å¯¹äº $w$ çš„æ¯ä¸€ä¸ªä½ç½® $i$ ï¼Œéƒ½å­˜åœ¨è‡³å°‘ä¸€ä¸ªæ¨¡å¼ä¸² $s_j$ ï¼Œ ä½¿å¾— $w[l\u0026hellip;r] = s_j$ï¼ˆ $w[l\u0026hellip;r]$ è¡¨ç¤ºä¸€ä¸ªåŸå­—ç¬¦ä¸²çš„ä¸€ä¸ªå­ä¸²ï¼‰ ï¼Œ å…¶ä¸­ $1 \\le l \\le i \\le r \\le |w|$ï¼ˆ $|w|$ ä¸º DNAåºåˆ— $w$ çš„é•¿åº¦ï¼‰ ã€‚\nè¯·ä½ è®¡ç®—å‡ºæ‰€æœ‰é•¿åº¦ä¸º $n(1 \\le n \\le 1000)$ çš„å¥½çš„ DNA åºåˆ—çš„ä¸ªæ•°ã€‚\nç­”æ¡ˆå¯¹ $1000000009(10^9+9)$ å–æ¨¡ã€‚\né“¾æ¥ Codeforces\né¢˜è§£ æˆ‘ä»¬å¯¹æ‰€æœ‰æ¨¡å¼ä¸²å»ºç«‹ AC è‡ªåŠ¨æœºï¼Œè·å– fail æŒ‡é’ˆï¼ŒåŒæ—¶è®¡ç®— fail é“¾ä¸Šçš„æœ€é•¿çš„ç»“æŸå­—ç¬¦ä¸²çš„é•¿åº¦ $l[x]$ ï¼Œè¡¥å…¨ Trie å›¾ã€‚\nè®¾çŠ¶æ€å¦‚ $dp[\\text{len}][\\text{nownode}][\\text{nowleft}]$ ï¼Œå…¶ä¸­ $\\text{len}$ è¡¨ç¤ºè¿˜å‰©ä½™çš„ä½æ•°ï¼Œ$\\text{nownode}$ è¡¨ç¤ºå½“å‰åœ¨ AC è‡ªåŠ¨æœºçš„å“ªä¸ªç‚¹ï¼Œ$\\text{nowleft}$ è¡¨ç¤ºå½“å‰æœªåŒ¹é…çš„åç¼€é•¿åº¦è¿˜æœ‰å¤šå°‘ã€‚\næˆ‘ä»¬æ¯æ¬¡æšä¸¾ä¸‹ä¸€ä½å¡«ä»€ä¹ˆã€‚å¦‚æœæˆ‘ä»¬å‘ç°åˆ°è¾¾çš„ä½ç½®å¯ä»¥å­˜åœ¨ä¸€ä¸ªè¦†ç›– $\\text{nowleft}$ çš„æ¨¡å¼ä¸²ï¼Œæˆ‘ä»¬å°±æ›´æ–°ä¸€ä¸‹ $\\text{nowleft} = 0$ ï¼Œå¦åˆ™ $\\text{nowleft}$ åŠ  $1$ å³å¯ã€‚\nå¦‚æœè¿›è¡Œåˆ°æŸä¸ªçŠ¶æ€ï¼Œå‰©ä¸‹çš„çš„åç¼€å¤§äºä½ æœ€å¤§çš„å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œå°±å¯ä»¥ç›´æ¥è¿”å› $0$ äº†ã€‚\næ—¶é—´å¤æ‚åº¦ $O(n m \\cdot \\text{maxlen}^2)$ ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89  #include \u0026lt;bits/stdc++.h\u0026gt;using namespace std; const int MAXN = 1005,mod = 1e9+9; namespace AC{ int c[MAXN][5],len[MAXN],maxlen[MAXN],fail[MAXN],cnt,rt; void ins(char *s){ int n = strlen(s); int now = rt; for(int i = 0;i\u0026lt;n;i++){ int a = s[i] - \u0026#39;a\u0026#39;; if(!c[now][a]) c[now][a] = ++cnt; now = c[now][a]; } len[now] = max(len[now],n); } void getfail(){ queue\u0026lt;int\u0026gt; q; for(int i = 0;i\u0026lt;4;i++){ if(c[rt][i] != 0){ fail[c[rt][i]] = rt; q.push(c[rt][i]); } } while(!q.empty()){ int nown = q.front();q.pop(); for(int i = 0;i\u0026lt;4;i++){ int \u0026amp;v = c[nown][i]; if(v == 0){ v = c[fail[nown]][i]; } else{ fail[v] = c[fail[nown]][i]; len[v] = max(len[v],len[fail[v]]); q.push(v); } } } } } int n,m; int dp[MAXN][105][12]; char s[MAXN]; int dfs(int len,int nownode,int nowleft){ if(nowleft \u0026gt; 10) return 0; if(dp[len][nownode][nowleft] != -1){ return dp[len][nownode][nowleft]; } if(len == 0 \u0026amp;\u0026amp; nowleft == 0) return 1; else if(len == 0) return 0; int ans = 0; for(int i = 0;i\u0026lt;4;i++){ int v = AC::c[nownode][i]; ans += dfs(len-1,v,(AC::len[v] \u0026gt;= nowleft+1)?0:nowleft+1); ans %= mod; } return dp[len][nownode][nowleft] = ans; } void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m); for(int i = 1;i\u0026lt;=m;i++){ scanf(\u0026#34;%s\u0026#34;,s); int t = strlen(s); for(int i = 0;i\u0026lt;t;i++){ if(s[i] == \u0026#39;A\u0026#39;){s[i] = \u0026#39;a\u0026#39;;} else if(s[i] == \u0026#39;C\u0026#39;){s[i] = \u0026#39;b\u0026#39;;} else if(s[i] == \u0026#39;T\u0026#39;){s[i] = \u0026#39;c\u0026#39;;} else if(s[i] == \u0026#39;G\u0026#39;){s[i] = \u0026#39;d\u0026#39;;} else{printf(\u0026#34;-1\\n\u0026#34;);} } AC::ins(s); } } void solve(){ AC::getfail(); memset(dp,-1,sizeof(dp)); printf(\u0026#34;%d\\n\u0026#34;,dfs(n,0,0)); } int main(){ init(); solve(); return 0; }   ","description":"","id":61,"section":"posts","tags":["å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","ACè‡ªåŠ¨æœº"],"title":"ã€ŒCF86Cã€Genetic engineering-ACè‡ªåŠ¨æœº+dp","uri":"https://blog.chenqiqian.com/posts/cf86c/"},{"content":"ç»™å‡ºä¸‰ä¸ªæ•´æ•° $l,r,k (1 \\le l \\leq r \\le 2\\cdot10^9, 2 \\le k \\le 2 \\cdot 10^9)$ ã€‚\næ±‚åœ¨åŒºé—´ $[l,r]$ å†…æ»¡è¶³ $k \\mid i$ ï¼Œ ä¸”å¯¹äºä»»æ„ $j \\in [2,k-1]$ éƒ½ä¸æ»¡è¶³ $k \\mid i$ çš„æ•° $i$ çš„ä¸ªæ•°ã€‚\né“¾æ¥ Codeforces\né¢˜è§£ å¯ä»¥å‘ç°ï¼Œé—®é¢˜å¯ä»¥è½¬åŒ–ä¸ºåœ¨ $[l,r]$ ä¸­æœ€å°è´¨å› æ•°æ˜¯ $k$ çš„æ•°çš„ä¸ªæ•°ã€‚\nç°å°†é—®é¢˜å·®åˆ†ï¼Œå˜æˆåœ¨ $[1,n]$ ä»¥å†…æœ€å°è´¨å› æ•°æ˜¯ $k$ çš„æ•°çš„ä¸ªæ•°ã€‚\næˆ‘ä»¬è€ƒè™‘è½¬åŒ–é—®é¢˜ï¼Œå¦‚æœæˆ‘ä»¬ä»¤ $f[i]$ ä¸º $i$ çš„æœ€å°è´¨å› æ•°ï¼Œé‚£ä¹ˆæ˜¾ç„¶è¿™ä¸ªå¯ä»¥åœ¨çº¿æ€§çš„æ—¶é—´å†…ç­›å‡ºæ¥ï¼ˆæˆ‘ä»¬é¢„å¤„ç†ä¸€äº›ï¼Œå‡è®¾åˆ° $\\text{MAX}$ ï¼‰ã€‚\næˆ‘ä»¬çš„é—®é¢˜å°±å¯ä»¥å˜æˆï¼š\næ±‚å‡ºåœ¨ $[1,n]$ ä¸­ï¼Œ$f[i] = k$ çš„æ•°çš„ä¸ªæ•°ï¼Œæ˜æ˜¾å‘ç°ï¼Œè¿™ä¸ªå¯ä»¥è½¬åŒ–ä¸ºåœ¨ $[1,\\lfloor\\frac{n}{k}\\rfloor]$ å†…ï¼Œ $f[i] \\ge k$ çš„æ•°çš„ä¸ªæ•°ã€‚\næˆ‘ä»¬å¯ä»¥å¯¹æ•°æ®è¿›è¡Œåˆ†æ²»ï¼Œå¦‚æœæˆ‘ä»¬å‘ç°ï¼š\næˆ‘ä»¬å¯ä»¥å¯¹æ•°æ®è¿›è¡Œåˆ†æ²»ï¼Œå¦‚æœæˆ‘ä»¬å‘ç°ï¼š\n $\\lfloor\\frac{n}{k}\\rfloor \u0026lt; \\text{MAX}$ï¼Œç›´æ¥çº¿æ€§è§£å†³è¿™ä¸ªé—®é¢˜ $\\lfloor\\frac{n}{k}\\rfloor \\ge \\text{MAX}$ï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœæˆ‘ä»¬çº¿æ€§ç­›ç­›çš„æ¯”è¾ƒå¤§ï¼Œå‰©ä¸‹çš„ $k$ åº”è¯¥ä¼šæ¯”è¾ƒå°ã€‚è¿™ä¸ªæ—¶å€™äº‹å®ä¸Šæˆ‘ä»¬è¦æ±‚çš„æ˜¯æ‰€æœ‰ $[1,n]$ å½“ä¸­æœ‰å¤šå°‘ä¸ªæ•°å­˜åœ¨ä¸€ä¸ªå°äº $k$ çš„è´¨å› æ•°ï¼Œè¿™ä¸ªä¸œè¥¿å¯ä»¥å®¹æ–¥è§£å†³ã€‚å®¹æ–¥çš„å¤æ‚åº¦æ˜¯ $2^k$ï¼Œé‚£ä¹ˆæˆ‘ä»¬åº”è¯¥è®©çº¿æ€§ç­›ç­›å‡ºæ¥çš„ä¸œè¥¿å°½é‡å¤§å³å¯ã€‚è€Œä¸”äº‹å®ä¸Šæˆ‘ä»¬å¯ä»¥åŠ å…¥ä¸€ä¸ªå‰ªæï¼Œä¹Ÿå°±æ˜¯ä¸€æ—¦ä½ ç°åœ¨è¦å®¹æ–¥çš„æ•°å·²ç»è¶…è¿‡äº† $n$ ï¼Œå°±ç›´æ¥ break æ‰ã€‚  è¿™æ ·çš„è¯ï¼Œå¤æ‚åº¦å¤§çº¦æ˜¯å¯ä»¥è¿‡æ‰çš„ã€‚\nå®é™…ä¸Šå¯èƒ½è¦è°ƒä¸€è°ƒçº¿æ€§ç­›çš„ $\\text{MAX}$ ï¼Œä½†è¿™ä¸ªé¢˜ç›®æ—¶é™æ¯”è¾ƒå®½æ¾ï¼Œä¹Ÿæ˜¯å¯ä»¥è¿‡æ‰çš„ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78  #include \u0026lt;bits/stdc++.h\u0026gt;using namespace std; const int MAXN = 10000000; int prime[MAXN],cnt; bool vis[MAXN]; int f[MAXN];// æœ€å°è´¨å› æ•°  void sieve(){ memset(vis,0,sizeof(vis)); f[1] = 1; for(int i = 2;i\u0026lt;MAXN;i++){ if(vis[i] == 0){ f[i] = i; prime[++cnt] = i; } for(int j = 1;i*prime[j]\u0026lt; MAXN \u0026amp;\u0026amp; j\u0026lt;=cnt;j++){ vis[i*prime[j]] = 1; f[i*prime[j]] = prime[j]; if(i%prime[j] == 0) break; } } } bool is_prime(int k){ int t = sqrt(k); for(int i = 2;i\u0026lt;=t;i++){ if(k % i == 0)return 0; } return 1; } int cal1(int n,int k){ int ans = 0; for(int i = 1;i\u0026lt;=n;i++){ if(i == 1 || f[i] \u0026gt;= k) ans++; } return ans; } int LIM = 0,lim = 0;// LIM è´¨æ•°ä¸ªæ•°ï¼Œlim ä¸º n/k #define ll long long ll ans = 0; void dfs(int p,ll now,ll f){ if(now \u0026gt; lim) return; if(p \u0026gt; LIM) { ans += f * (lim/now);return; } dfs(p+1,now,f); dfs(p+1,now*prime[p],-f); } int cal2(int n,int k){ LIM = 0,lim = n,ans = 0; for(int i = 1;prime[i] \u0026lt; k;i++)LIM++; dfs(1,1,1); return int(ans); } int calc(int n,int k){ if(!n || !is_prime(k)) return 0; if(n/k \u0026lt; MAXN) return cal1(n/k,k); else return cal2(n/k,k); } int l,r,k; int main(){ scanf(\u0026#34;%d %d %d\u0026#34;,\u0026amp;l,\u0026amp;r,\u0026amp;k); sieve(); printf(\u0026#34;%d\\n\u0026#34;,calc(r,k) - calc(l-1,k)); return 0; }   ","description":"","id":62,"section":"posts","tags":["æ•°è®º","å®¹æ–¥åŸç†"],"title":"ã€ŒCF83Dã€Numbers-å®¹æ–¥åŸç†","uri":"https://blog.chenqiqian.com/posts/cf83d/"},{"content":"ç°åœ¨æœ‰ä¸€ä¸ªç”±æ‰€æœ‰æ­£æ•´æ•°ç»„æˆçš„æ— é™é€’å¢åºåˆ—ï¼š $p = {1,2,3,\u0026hellip;}$ ã€‚\nå¯¹è¿™ä¸ªåºåˆ—æ‰§è¡Œ $n$ æ¬¡äº¤æ¢æ“ä½œã€‚æ¯æ¬¡ä¸€ä¸ªæ“ä½œï¼Œç»™å‡ºä¸¤ä¸ªæ•´æ•° $a,b$ï¼Œäº¤æ¢ä½ç½® $a$ å’Œ $b$ å¤„çš„å…ƒç´ ã€‚\nä½ çš„ä»»åŠ¡æ˜¯åœ¨æ‰€æœ‰æ“ä½œç»“æŸåï¼Œè¾“å‡ºæœ€ç»ˆåºåˆ—çš„é€†åºå¯¹ä¸ªæ•°ï¼Œå³æ»¡è¶³ $i \u0026lt; j$ ä¸” $p_i \u0026gt; p_j$ çš„æœ‰åºæ•°å¯¹ $(i,j)$ çš„æ•°é‡ã€‚\né“¾æ¥ Codeforces\né¢˜è§£ æˆ‘ä»¬å‘ç°ï¼Œä¸¤ä¸ªæ²¡æœ‰ç»è¿‡ä»»ä½•äº¤æ¢çš„ä½ç½®ä¹‹é—´æ˜¯ä¸å¯èƒ½äº§ç”Ÿé€†åºå¯¹çš„ï¼Œå¯èƒ½äº§ç”Ÿé€†åºå¯¹çš„åªæœ‰ï¼š\n æ¢çš„ä¸æ²¡æ¢çš„ æ¢çš„ä¸æ¢çš„  æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦è€ƒè™‘è¢«æ¢çš„èƒ½äº§ç”Ÿçš„é€†åºå¯¹å³å¯ï¼Œå¯ä»¥å‘ç°è¿™æ ·ç»Ÿè®¡æ˜¯å®Œå…¨çš„ã€‚\næˆ‘ä»¬è€ƒè™‘å…ˆç”¨ $map$ è®°å½•äº¤æ¢æœ€åçš„ç»“æœå’Œå“ªäº›ä½ç½®æœ‰äº¤æ¢ï¼Œè¿™å—éå¸¸ç®€å•ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯ $O(n\\log n)$ çš„ã€‚\næˆ‘ä»¬æ¥ä¸‹æ¥è€ƒè™‘æœ€åæ•°åˆ—çš„é€†åºå¯¹ä¸ªæ•°ã€‚\nå…ˆè€ƒè™‘ç¬¬ä¸€ç§æƒ…å†µï¼šæ¢çš„ä¸æ²¡æ¢çš„äº§ç”Ÿäº†é€†åºå¯¹ã€‚\nå¯¹äºæ¯ä¸€ä¸ªäº¤æ¢çš„æ•°ï¼Œæˆ‘ä»¬è€ƒè™‘ä¸¤ç§æƒ…å†µï¼šåœ¨å…¶å‰é¢ï¼Œæ¯”å…¶å¤§ï¼Œåœ¨å…¶åé¢ï¼Œæ¯”å…¶å¤§ã€‚\næˆ‘ä»¬è€ƒè™‘åˆ°æ¢çš„åœ¨ 1e9 èŒƒå›´å†…æ¯”è¾ƒå°ï¼Œå¯ä»¥å¼€ä¸€ä¸ªåŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘ç»´æŠ¤å“ªäº›ä½ç½®è¢«xæ‰äº†ï¼Œç„¶åæŸ¥è¯¢åŒºé—´å’Œå°±å¯ä»¥çŸ¥é“ç¬¬ä¸€ä¸ªé—®é¢˜çš„ç­”æ¡ˆäº†ã€‚\næˆ‘ä»¬è€ƒè™‘ç¬¬äºŒç§æƒ…å†µï¼šä¸¤ä¸ªæ¢äº†çš„äº§ç”Ÿäº†é€†åºå¯¹ã€‚\nè¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªéœ€è¦è€ƒè™‘åœ¨å‰é¢çš„ï¼Œæ¯”ä»–å¤§çš„ä¸ªæ•°å³å¯ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸ªäºŒç»´æ•°ç‚¹é—®é¢˜ã€‚\nç»´æŠ¤æ‰«æçº¿ï¼Œå’ŒåŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘ï¼Œå¯ä»¥åœ¨ $O(n \\log V)$ æ—¶é—´å†…è§£å†³ã€‚\næœ€åæ—¶é—´å¤æ‚åº¦ï¼š $O(n (\\log V + \\log n))$ï¼Œç©ºé—´ $O(n \\log V)$\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77  #include \u0026lt;bits/stdc++.h\u0026gt;#define ll long long using namespace std; const int MAXN = 101000,logn = 35; struct SegTree{ int sumn[MAXN*logn],ls[MAXN*logn],rs[MAXN*logn],cnt = 0; #define mid ((l+r)/2)  void update(int \u0026amp;nown,int l,int r,int pos,int v){ if(!nown) nown = ++cnt; if(l == r) sumn[nown] += v; else{ sumn[nown] += v; if(pos \u0026lt;= mid) update(ls[nown],l,mid,pos,v); if(pos \u0026gt;= mid+1) update(rs[nown],mid+1,r,pos,v); } } int query(int nown,int l,int r,int ql,int qr){ if(ql \u0026gt; qr) return qr - ql + 1;//ä»¥ä¾¿åé¢å’Œè´Ÿæ•°åŒºé—´å¯¹æ‰ï¼Œå…¶ä½™éƒ¨åˆ†æœ€å¤šåªä¼šå·®1ï¼Œè¿”å›0æ²¡æœ‰é”…  if(!nown) return 0; if(ql \u0026lt;= l \u0026amp;\u0026amp; r \u0026lt;= qr) return sumn[nown]; else{ int ans = 0; if(ql \u0026lt;= mid) ans += query(ls[nown],l,mid,ql,qr); if(qr \u0026gt;= mid+1) ans += query(rs[nown],mid+1,r,ql,qr); return ans; } } }T1,T2; int n,MAX = 1e9; map\u0026lt;int,int\u0026gt; S; // pos-\u0026gt;val int getval(int x){return S.count(x)?S[x]:x;} void _swap(int a,int b){ int va = getval(a),vb = getval(b); S[a] = vb,S[b] = va; } void init(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n); for(int i = 1;i\u0026lt;=n;i++){ int a,b; scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;a,\u0026amp;b); _swap(a,b); } } ll ans = 0; int rt1,rt2; void solve(){ for(auto it = S.begin();it!=S.end();it++){ T1.update(rt1,1,MAX,it-\u0026gt;first,1); } for(auto it = S.begin();it!=S.end();it++){ int p = it-\u0026gt;first,v = it-\u0026gt;second; ans += ((p-1)-(v+1)+1) - T1.query(rt1,1,MAX,v+1,p-1);//å‰é¢æ¯”ä»–å¤§çš„  ans += ((v-1)-(p+1)+1) - T1.query(rt1,1,MAX,p+1,v-1);//åé¢æ¯”ä»–å°çš„  } for(auto it = S.begin();it!=S.end();it++){ int v = it-\u0026gt;second; ans += T2.query(rt2,1,MAX,v+1,MAX); T2.update(rt2,1,MAX,v,1); } printf(\u0026#34;%lld\\n\u0026#34;,ans); } int main(){ init(); solve(); return 0; }   ","description":"","id":63,"section":"posts","tags":["æ•°æ®ç»“æ„","çº¿æ®µæ ‘"],"title":"ã€ŒCF540Eã€Infinite Inversions-åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘","uri":"https://blog.chenqiqian.com/posts/cf540e/"},{"content":"ç»™ä½ ä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„åºåˆ— $a_1,a_2,\u0026hellip;,a_n$ ï¼Œä½ éœ€è¦æŠŠè¿™ $n$ ä¸ªå…ƒç´ åˆ†æˆä¸‰ç±»ï¼š$1,2,3$ï¼Œæ¯ç±»çš„æ¡ä»¶å¦‚ä¸‹ï¼š\n  æ‰€æœ‰çš„æœ€é•¿ä¸Šå‡å­åºåˆ—éƒ½ä¸åŒ…å«è¿™ä¸ªå…ƒç´ \n  æœ‰ä½†éæ‰€æœ‰çš„æœ€é•¿ä¸Šå‡å­åºåˆ—åŒ…å«è¿™ä¸ªå…ƒç´ \n  æ‰€æœ‰çš„æœ€é•¿ä¸Šå‡å­åºåˆ—éƒ½åŒ…å«è¿™ä¸ªå…ƒç´ \n  é“¾æ¥ Codeforces\né¢˜è§£ ç”±æ™®é€š $\\text{LIS}$ çš„ $O(n \\log n)$ ç®—æ³•æ‰©å±•å¾—åˆ°è¿™ä¸ªé—®é¢˜çš„ $O(n \\log n)$ çš„è§£æ³•ã€‚\nåœ¨åŸæ¥çš„ LIS è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬åªç»´æŠ¤ $f[i]$ ä¸ºæŸå€¼æ—¶ï¼Œ $a_i$ çš„å€¼æœ€å°ä¸ºå¤šå°‘ã€‚ç°åœ¨æˆ‘ä»¬å°†è¿™äº› $a_i$ é€šé€šæ‰”åˆ° $n$ ä¸ª vector é‡Œé¢ï¼ˆè€Œä¸æ˜¯å– $\\max$ ï¼‰ï¼Œå¯ä»¥å‘ç°ï¼Œåœ¨æ¯ä¸ª vector é‡Œé¢ï¼Œæˆ‘ä»¬çš„ $a[i]$ åº”å½“æ˜¯å•è°ƒé€’å‡çš„ï¼ˆæˆ‘ä»¬å°†æ¯ä¸ª vector é‡Œé¢æœ€åä¸€ä¸ªæ•°å½“ä½œæ™®é€š LIS é‡Œé¢çš„æ•°ç»„çš„æ•°ï¼‰ã€‚\nç„¶åæˆ‘ä»¬è€ƒè™‘å¦‚ä½•è®¡ç®—æ–¹æ¡ˆæ•°ã€‚\næˆ‘ä»¬äºŒåˆ†å¾—åˆ°åº”å½“è€ƒè™‘çš„ $f[i]$ çš„å€¼ï¼Œç„¶ååœ¨è¿™ä¸ª vector é‡Œé¢äºŒåˆ†å¾—åˆ°ä¸€ä¸ªä½ç½®ï¼Œç„¶åç”¨å¦ä¸€ä¸ª vector é‡Œé¢ç»´æŠ¤çš„å‰ç¼€å’Œè®¡ç®—å¾—åˆ°è¿™ä¸ªèƒ½ä»å¤šå°‘ç§ $f[i]-1$ çš„æ–¹æ¡ˆè½¬ç§»è¿‡æ¥ã€‚æœ€åæˆ‘ä»¬è¦æ‰«ä¸€éå…¨æ•°ç»„ï¼Œå¾—åˆ°å…¨éƒ¨çš„ LIS æ¡æ•°ã€‚\nä¸ºä»€ä¹ˆæˆ‘ä»¬è¦è®¡ç®—æ–¹æ¡ˆæ•°å‘¢ï¼Ÿå› ä¸ºè¿™æ ·å¯ä»¥è®¡ç®—å‡º $F1_i,F2_i$ ï¼ˆæ°å¥½ä»¥ $i$ ç»“å°¾ã€å¼€å§‹çš„æœ€é•¿ LIS é•¿åº¦ï¼‰ï¼Œ $G1_i,G2_i$ ï¼ˆä¸Šè¿° LIS çš„ä¸ªæ•°ï¼‰ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥åˆ†ç±»äº†ã€‚\næˆ‘ä»¬æŠŠè¿™ä¸ªæ•°åˆ—çš„æœ€é•¿é•¿åº¦ç§°ä¸º $\\mathrm{MAXLEN}$ ï¼Œæ€»å…±çš„ LIS æ¡æ•°è®°ä½œ $\\mathrm{tot_cnt}$ ï¼š\n å¦‚æœ $F1[i] + F2[i] - 1 \u0026lt; \\mathrm{MAXLEN}$ï¼Œåˆ™è¯¥ç±»å‹æ˜¯ $1$ ï¼› å¦‚æœ $G1[i] * G2[i] = \\mathrm{tot_cnt}$ï¼Œåˆ™è¯¥ç±»å‹æ˜¯ $3$ ï¼› å¦åˆ™ï¼Œè¯¥ç±»å‹æ˜¯ $2$ ã€‚  è¿™é‡Œçš„ $G$ ä¼šå¾ˆå¤§ï¼Œå¦‚ä½•åˆ¤æ–­ç›¸ç­‰ï¼Ÿæœ¬æ¥æƒ³ç”¨è‡ªç„¶æº¢å‡ºï¼Œåæ¥è€ƒè™‘åˆ°å› ä¸ºéƒ½æ˜¯ä¹˜æ³•ï¼Œå¾ˆæœ‰å¯èƒ½åœ¨ $\\bmod 2^{64}$ æ„ä¹‰ä¸‹åŒä½™ï¼Œæ‰€ä»¥å¯¹ä¸€ä¸ªå¤§è´¨æ•° $10^9+9$ å–æ¨¡ã€‚ï¼ˆäº‹å®ä¸Šè¿™é‡Œä¸¤ä¸ªå–æ¨¡ç”šè‡³æ›´å¤šä¼šæ›´å¥½ï¼Œä½†æ•°æ®å¹¶ä¸æ˜¯å¾ˆå¼ºï¼‰\næ—¶é—´å¤æ‚åº¦æ˜¯ $O(n \\log n)$ ã€‚\nä»£ç  ä¸­é—´æœ‰ä¸€æ®µå¤åˆ¶çš„ï¼Œæ‰€ä»¥äº‹å®ä¸Šè¦å†™çš„ä¹Ÿæ²¡å¤šå°‘å‘¢\u0026hellip;\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92  #include \u0026lt;bits/stdc++.h\u0026gt;#define ll long long using namespace std; const ll mod = 1e9+9; const int MAXN = 210000; int n; int a[MAXN]; void init(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n); for(int i = 1;i\u0026lt;=n;i++) scanf(\u0026#34;%d\u0026#34;,\u0026amp;a[i]); } namespace Solve1{ int f[MAXN],t[MAXN],now,MAXANS; vector\u0026lt;int\u0026gt; v[MAXN]; vector\u0026lt;ll\u0026gt; sum[MAXN];ll g[MAXN],tot[MAXN]; void output(int n,int *ff,ll *gg){ for(int i = 1;i\u0026lt;=n;i++)ff[i] = f[i],gg[i] = g[i]; } void solve(){ a[0] = 0,f[0] = 0,g[0] = 1,t[0] = 0; v[0].push_back(0),sum[0].push_back(1),tot[0] = 1; now = 0; for(int i = 1;i\u0026lt;=n;i++){ int tmp = lower_bound(t,t+now+1,a[i]) - t; if(tmp == now+1) ++now; f[i] = tmp,t[tmp] = a[i]; int w = upper_bound(v[f[i]-1].begin(),v[f[i]-1].end(),a[i],greater\u0026lt;int\u0026gt;()) - v[f[i]-1].begin(); ll ans = w == 0?0:sum[f[i]-1][w-1]; ans = (tot[f[i]-1] - ans)%mod; g[i] = ans \u0026lt; 0?ans+mod:ans; v[f[i]].push_back(a[i]); tot[f[i]] = (tot[f[i]] + g[i])%mod; sum[f[i]].push_back(tot[f[i]]); MAXANS = max(MAXANS,f[i]); } } } namespace Solve2{ int f[MAXN],t[MAXN],now,MAXANS; vector\u0026lt;int\u0026gt; v[MAXN]; vector\u0026lt;ll\u0026gt; sum[MAXN];ll g[MAXN],tot[MAXN]; void output(int n,int *ff,ll *gg){ for(int i = 1;i\u0026lt;=n;i++)ff[i] = f[i],gg[i] = g[i]; } void solve(){ a[n+1] = 1e9,f[n+1] = 0,g[n+1] = 1,t[0] = 1e9; v[0].push_back(1e9),sum[0].push_back(1),tot[0] = 1; now = 0; for(int i = n;i\u0026gt;=1;i--){// è¿™é‡Œç›¸å¯¹ä¸Šé¢æœ‰æ›´æ”¹  int tmp = lower_bound(t,t+now+1,a[i],greater\u0026lt;int\u0026gt;()) - t;//è¿™é‡Œç›¸å¯¹ä¸Šé¢æœ‰æ›´æ”¹  if(tmp == now+1) ++now; f[i] = tmp,t[tmp] = a[i]; int w = upper_bound(v[f[i]-1].begin(),v[f[i]-1].end(),a[i]) - v[f[i]-1].begin();//è¿™é‡Œç›¸å¯¹ä¸Šé¢æœ‰æ›´æ”¹  ll ans = w == 0?0:sum[f[i]-1][w-1]; ans = (tot[f[i]-1] - ans)%mod; g[i] = ans \u0026lt; 0?ans+mod:ans; v[f[i]].push_back(a[i]); tot[f[i]] = (tot[f[i]] + g[i])%mod; sum[f[i]].push_back(tot[f[i]]); MAXANS = max(MAXANS,f[i]); } } } int F1[MAXN],F2[MAXN];ll G1[MAXN],G2[MAXN]; void solve(){ Solve1::solve(),Solve1::output(n,F1,G1); Solve2::solve(),Solve2::output(n,F2,G2); int maxans = Solve1::MAXANS;ll totans = 0; for(int i = 1;i\u0026lt;=n;i++){ if(F1[i] == maxans) totans+=G1[i]; totans %= mod; } for(int i = 1;i\u0026lt;=n;i++){ if(F1[i] + F2[i] - 1 \u0026lt; maxans) printf(\u0026#34;1\u0026#34;); else if(G1[i] * G2[i] % mod == totans) printf(\u0026#34;3\u0026#34;); else printf(\u0026#34;2\u0026#34;); } printf(\u0026#34;\\n\u0026#34;); } int main(){ init(); solve(); return 0; }   ","description":"","id":64,"section":"posts","tags":["åŠ¨æ€è§„åˆ’","æ•°æ®ç»“æ„"],"title":"ã€ŒCF486Eã€LIS of Sequence-ç®€å•æ•°æ®ç»“æ„","uri":"https://blog.chenqiqian.com/posts/cf486e/"},{"content":"ç»™å‡ºä¸‰ä¸ªä»…ç”±å°å†™å­—æ¯æ„æˆçš„ä¸² $A, B, C$ ï¼Œå¯¹äºæ¯ä¸ª $L \\in [1, \\min(len_A,len_B,len_C)]$ ï¼Œæ±‚æ»¡è¶³$A[a,a+L-1] = B[b,b+L-1] = C[c,c+L-1]$ çš„ä¸‰å…ƒç»„ $(a,b,c)$ çš„æ•°é‡ã€‚\nç­”æ¡ˆå¯¹ $1000000007 (10 ^ 9 + 7)$ å–æ¨¡ï¼Œå­—ç¬¦æ€»æ•°å°äº $3 \\times 10^5$ã€‚\né“¾æ¥ Codeforces\né¢˜è§£ æŠŠä¸‰ä¸ªä¸²æ¥åœ¨ä¸€èµ·ï¼ˆä¸­é—´æœ‰é—´éš”ç¬¦ï¼‰ï¼Œä¸Šåç¼€æ•°ç»„ï¼Œæ±‚å‡º $ht$ æ•°ç»„ï¼Œç„¶åç”¨å¹¶æŸ¥é›†æŒ‰ç…§ $ht$ ä»å¤§åˆ°å°åˆå¹¶ï¼Œåˆå¹¶è¿‡ç¨‹ä¸­ç»´æŠ¤åŒºé—´ä¸­å±äºç¬¬ä¸€ä¸ªã€ç¬¬äºŒä¸ªã€ç¬¬ä¸‰ä¸ªå­—ç¬¦ä¸²çš„ä½ç½®ä¸ªæ•°ï¼Œç„¶ååˆå¹¶æ—¶æ›´æ–°è´¡çŒ®å³å¯ã€‚\næ—¶é—´å¤æ‚åº¦ $O(n \\log n)$ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128  #include \u0026lt;bits/stdc++.h\u0026gt;#define ll long long using namespace std; const int mod = 1e9+7; const int MAXN = 340000; namespace SA{ int s[MAXN],sa[MAXN],cnt[MAXN],rk[MAXN],x[MAXN],y[MAXN],ht[MAXN]; void get_sa(int n,int m){ for(int i = 0;i\u0026lt;m;i++) cnt[i] = 0; for(int i = 0;i\u0026lt;n;i++) cnt[s[i]]++; for(int i = 1;i\u0026lt;m;i++) cnt[i] += cnt[i-1]; for(int i=n-1;~i;--i) sa[--cnt[s[i]]] = i; m = rk[sa[0]] = 0; for(int i = 1;i\u0026lt;n;i++) rk[sa[i]] = s[sa[i]] == s[sa[i-1]]?m:++m; for(int j = 1;;j\u0026lt;\u0026lt;=1){ if(++m == n) break; for(int i = 0;i\u0026lt;j;i++) y[i] = n-j+i; for(int i=0,k=j;i\u0026lt;n;i++) if(sa[i] \u0026gt;= j) y[k++] = sa[i]-j; for(int i = 0;i\u0026lt;n;i++) x[i] = rk[y[i]]; for(int i = 0;i\u0026lt;m;i++) cnt[i] = 0; for(int i = 0;i\u0026lt;n;i++) cnt[x[i]]++; for(int i = 1;i\u0026lt;m;i++) cnt[i] += cnt[i-1]; for(int i =n-1;~i;--i) sa[--cnt[x[i]]] = y[i],y[i] = rk[i]; m = rk[sa[0]] = 0; for(int i = 1;i\u0026lt;n;i++) rk[sa[i]] = (y[sa[i]] == y[sa[i-1]] \u0026amp;\u0026amp; y[sa[i]+j] == y[sa[i-1]+j])?m:++m; } } void getheight(int n){ for(int i = 0,h = ht[0] = 0;i\u0026lt;n;i++){ int j = sa[rk[i]-1]; while(i+h \u0026lt; n \u0026amp;\u0026amp; j+h \u0026lt; n \u0026amp;\u0026amp; s[i+h] == s[j+h]) h++; ht[rk[i]] = h; if(h) h--; } } void solve(int *str,int n){ for(int i = 0;i\u0026lt;n;i++) s[i] = str[i]; get_sa(++n,200); getheight(n); } } ll ANS = 0,ans[MAXN]; namespace BCJ{ int f[MAXN],num[MAXN][4]; void init(int n,int *own){ for(int i = 0;i\u0026lt;=n;i++) f[i] = i,num[i][own[i]] = 1; } int find(int x){ return f[x] == x?x:f[x] = find(f[x]); } int cal(int x){ return 1LL * num[x][1] * num[x][2] * num[x][3] % mod; } void merge(int x,int y){ int fx = find(x),fy = find(y); if(fx == fy) return; ANS -= cal(fx),ANS -= cal(fy); f[fx] = fy; for(int i = 1;i\u0026lt;=3;i++) num[fy][i] += num[fx][i]; ANS += cal(fy); ANS = (ANS%mod); if(ANS \u0026lt; 0) ANS += mod; } } int ss; int S[MAXN]; int own[MAXN]; void addchar(int c,int x = 0){own[ss] = x;S[ss] = c;ss++;} int l1,l2,l3; char s1[MAXN],s2[MAXN],s3[MAXN]; void init(){ scanf(\u0026#34;%s\u0026#34;,s1);l1 = strlen(s1); scanf(\u0026#34;%s\u0026#34;,s2);l2 = strlen(s2); scanf(\u0026#34;%s\u0026#34;,s3);l3 = strlen(s3); for(int i = 0;i\u0026lt;l1;i++) addchar(s1[i],1); addchar(\u0026#39;z\u0026#39;+1); for(int i = 0;i\u0026lt;l2;i++) addchar(s2[i],2); addchar(\u0026#39;z\u0026#39;+2); for(int i = 0;i\u0026lt;l3;i++) addchar(s3[i],3); addchar(\u0026#39;z\u0026#39;+3); } struct Node{ int pos,v; bool operator \u0026lt; (const Node \u0026amp;x)const{ return v \u0026gt; x.v; } }; vector\u0026lt;Node\u0026gt; v; void solve(){ BCJ::init(ss+1,own); SA::solve(S,ss); for(int i = 1;i\u0026lt;ss+1;i++){ v.push_back((Node){i,SA::ht[i]}); } sort(v.begin(),v.end()); int now = 0; int t = min(l1,min(l2,l3)); for(int i = t;i\u0026gt;=1;--i){ while(now \u0026lt; int(v.size())-1 \u0026amp;\u0026amp; v[now].v \u0026gt;= i){ int tmp = v[now].pos; BCJ::merge(SA::sa[tmp],SA::sa[tmp-1]); now++; } ans[i] = ANS; } for(int i = 1;i\u0026lt;=t;i++){ printf(\u0026#34;%lld \u0026#34;,ans[i]); } printf(\u0026#34;\\n\u0026#34;); } int main(){ init(); solve(); return 0; }   ","description":"","id":65,"section":"posts","tags":["å­—ç¬¦ä¸²","åç¼€æ•°ç»„"],"title":"ã€ŒCF452Eã€Three strings-åç¼€æ•°ç»„","uri":"https://blog.chenqiqian.com/posts/cf452e/"},{"content":"Inna æœ‰ä¸€ä¸ªä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„æ•°åˆ— $a_1 [1],a_1 [2],\\dots,a_1 [n]$ã€‚\nå¥¹ä¼šè¿›è¡Œå¦‚ä¸‹æ“ä½œï¼Œåˆ†ä¸º $n$ ä¸ªé˜¶æ®µï¼š\nåœ¨ç¬¬ä¸€é˜¶æ®µï¼ŒInna ä»æ•°ç»„ $a_1$ä¸­å†™å‡ºæ‰€æœ‰æ•°å­—ï¼Œåœ¨ç¬¬ $i$ ä¸ª $(i \\ge 2)$ é˜¶æ®µ Inna ä¼šå†™å‡ºæ•°ç»„çš„æ‰€æœ‰å…ƒç´  $a_i$ ï¼Œç”± $n - i + 1$ ä¸ªæ•´æ•°ç»„æˆ; æ•°ç»„ $a_i$ çš„ç¬¬ $k$ ä¸ªæ•°å®šä¹‰å¦‚ä¸‹ï¼š$a_{i} [k] = a_{i-1} [k]\\ \\mathrm{AND}\\ a_{i-1} [k + 1]$ ã€‚ è¿™é‡Œ $\\mathrm{AND}$ æ˜¯äºŒè¿›åˆ¶çš„é€ä½ä¸è¿ç®—ã€‚\nDima å†³å®šæ£€éªŒ Inna çš„æŠ€èƒ½ã€‚ ä»–è¦æ±‚ Inna æ”¹å˜é˜µåˆ—ï¼Œè¿›è¡Œç»ƒä¹ å¹¶è¯´å‡ºå¥¹åœ¨å½“å‰ç»ƒä¹ ä¸­å†™å‡ºçš„æ‰€æœ‰å…ƒç´ çš„æ€»å’Œï¼Œå³ï¼š\n$$\n\\sum_{i=1}^n \\sum_{j=1}^{n-i+1} a_i[j]\n$$\nè¯·å¸®åŠ© Inna å›ç­”é—®é¢˜ï¼\né“¾æ¥ Codeforces\né¢˜è§£ æ¯ä½è´¡çŒ®ç‹¬ç«‹ï¼Œæ–¹ä¾¿åˆå¹¶ï¼Œä¸€çœ‹å°±è¦åˆ†ä½è€ƒè™‘å˜›ã€‚\næˆ‘ä»¬åˆ†ä½è€ƒè™‘åï¼Œå°±åªå‰©ä¸‹åªåŒ…å« 0/1 ï¼Œæ¯æ¬¡æŠŠä¸€ä¸ªä½ç½® 0-\u0026gt;1 æˆ–è€… 1-\u0026gt;0 ï¼Œç„¶åé‡æ–°è®¡ç®—è¿™ä¸€ä½çš„è´¡çŒ®ã€‚\näº‹å®ä¸Šï¼Œæˆ‘ä»¬åœ¨ä¸€ä½çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªè¦è®¡ç®—å‡ºå¤šå°‘é•¿åº¦åœ¨ $[1,n]$ çš„åŒºé—´åŒ…å«è‡³å°‘ 1 ä¸ª 0 ã€‚\næˆ‘ä»¬è€ƒè™‘ç”¨å”¯ä¸€æ€§ç¡®å®šè¿™ä¸ªäº‹æƒ…ï¼ˆç”¨æœ€å…ˆå‡ºç°çš„ 0 è®¡ç®—è´¡çŒ®ï¼‰ï¼Œå°±æ˜¯å·¦ç«¯ç‚¹ä»ä¸Šä¸€ä¸ª 0 åˆ°è¿™ä¸ª 0 çš„åŒºé—´ï¼Œå³ç«¯ç‚¹åœ¨è¿™ä¸ª 0 ä»¥å³çš„åŒºé—´ã€‚\nç”¨ set ç»´æŠ¤æ¯ä¸ª 0 å‡ºç°çš„ä½ç½®ï¼Œæ¯æ¬¡ä¿®æ”¹è®¡ç®—ä¸‹è´¡çŒ®å°±å¥½äº†ã€‚\næ—¶é—´å¤æ‚åº¦æ˜¯ $O(n \\log n \\log V)$ ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65  #include \u0026lt;bits/stdc++.h\u0026gt;#define int long long using namespace std; const int MAXN = 210000,logn = 21; int n,m,ANS = 0; int num[MAXN]; set\u0026lt;int\u0026gt; S[logn];// ç»´æŠ¤0å‡ºç°çš„ä½ç½®  int getpre(int pos,int x){// å°äº pos çš„ç¬¬ä¸€ä¸ª x  auto it = S[x].lower_bound(pos); return *(--it); } int getnex(int pos,int x){// å¤§äº pos çš„ç¬¬ä¸€ä¸ª x  auto it = S[x].upper_bound(pos); return *it; } int calc(int now,int last,int x){ return (now-last) * (n-now+1) * (1LL\u0026lt;\u0026lt;x); } void update(int p,int v){ for(int i = 0;i\u0026lt;logn;i++){ int tmp = (v\u0026amp;(1\u0026lt;\u0026lt;i))!=0; if(tmp != (int)(S[i].count(p))) continue; int last = getpre(p,i),nex = getnex(p,i); if(!tmp){ ANS += calc(nex,last,i); ANS -= calc(nex,p,i);ANS -= calc(p,last,i); S[i].insert(p); } else{ ANS -= calc(nex,last,i); ANS += calc(nex,p,i);ANS += calc(p,last,i); S[i].erase(p); } } } void init(){ scanf(\u0026#34;%lld %lld\u0026#34;,\u0026amp;n,\u0026amp;m); for(int x = 0;x\u0026lt;logn;x++) for(int i = 1;i\u0026lt;=n;i++) S[x].insert(i); for(int i = 0;i\u0026lt;logn;i++) S[i].insert(0),S[i].insert(n+1); for(int i = 1;i\u0026lt;=n;i++){ scanf(\u0026#34;%lld\u0026#34;,\u0026amp;num[i]); update(i,num[i]); } } void solve(){ int v,p; for(int i = 1;i\u0026lt;=m;i++){ scanf(\u0026#34;%lld %lld\u0026#34;,\u0026amp;p,\u0026amp;v); update(p,v); printf(\u0026#34;%lld\\n\u0026#34;,ANS); } } signed main(){ init(); solve(); return 0; }   ","description":"","id":66,"section":"posts","tags":["æ•°æ®ç»“æ„"],"title":"ã€ŒCF400Eã€Inna and Binary Logic-ç®€å•æ•°æ®ç»“æ„","uri":"https://blog.chenqiqian.com/posts/cf400e/"},{"content":"ä½ æ˜¯ä¸€ä¸ªç¨‹åºçŒ¿ï¼Œç°åœ¨æœ‰ä¸€æ£µæ–°å¹´æ ‘ï¼ˆå¹¶ä¸æ˜¯ä¼ ç»Ÿçš„å¸¦ç€å¶å­çš„æ ‘ï¼‰â€”â€”å®ƒæœ‰å››ä¸ªèŠ‚ç‚¹ï¼š $1$ ï¼Œ$2$ ï¼Œ$3$ ï¼Œ$4$ . å…¶ä¸­$2$ ï¼Œ$3$ ï¼Œ$4$ çš„çˆ¶äº²éƒ½æ˜¯ $1$ .\næ–°å¹´é‡Œï¼Œç¨‹åºçŒ¿ä»¬å¾€å¾€ä¼šåšä¸€äº›æœ‰è¶£çš„äº‹æƒ…ã€‚ä½ åˆ™é€‰æ‹©ä»¥å¾€è¿™æ£µæ ‘ä¸ŠåŠ èŠ‚ç‚¹æ¥å–ä¹ã€‚ ä¸€ä¸ªæ·»åŠ èŠ‚ç‚¹çš„æ“ä½œæ˜¯è¿™æ ·çš„ï¼š\n æ‰¾åˆ°æ ‘ä¸Šçš„ä¸€ä¸ªå¶å­ç»“ç‚¹ $v$ . è®¾ç°åœ¨æ ‘ä¸Šæœ‰ $n$ ä¸ªèŠ‚ç‚¹ï¼Œé‚£ä¹ˆä½ ç°åœ¨ä¼šåŠ å…¥ä¸¤ä¸ªèŠ‚ç‚¹$n+1$ å’Œ $n+2$ ï¼Œå®ƒä»¬éƒ½ä¼šæˆä¸º $v$ çš„å„¿å­.  ä½ çš„ä»»åŠ¡æ˜¯åœ¨åš $q$ æ¬¡è¿™æ ·çš„æ“ä½œï¼Œå¹¶åœ¨æ¯åšå®Œä¸€æ¬¡åè®¡ç®—ä¸€æ¬¡æ ‘çš„ç›´å¾„ã€‚æ¥å§ï¼Œæˆ‘ä»¬ä¸€èµ·æ¥è§£å†³è¿™é“æ–°å¹´é—®é¢˜å§ï¼\né“¾æ¥ Codeforces\nä¼ªé¢˜è§£ æˆ‘ä»¬è€ƒè™‘æ ‘å½¢dpè®¡ç®—æ ‘çš„ç›´å¾„çš„è¿‡ç¨‹ã€‚\næˆ‘ä»¬å¦‚æœä»¤ $f[i]$ ä¸ºä»¥ $i$ ä¸ºæ ¹çš„å­æ ‘ä¸­æœ€é•¿çš„é“¾çš„é•¿åº¦ï¼Œ$g[i]$ ä¸ºä»¥ $i$ ä¸ºæ ¹çš„å­æ ‘ä¸­çš„ç›´å¾„é•¿åº¦ï¼ˆè¿‡æ ¹èŠ‚ç‚¹ï¼‰ï¼Œé‚£ä¹ˆå°±æœ‰å¦‚ä¸‹è½¬ç§»ï¼š\n$$\nf[v] = \\max(f[v_1] + f[v_2]) + 1\\\ng[v] = f[v_1] + f[v_2] + 2\n$$\nå¦‚æœæˆ‘ä»¬ä»¤ $dep[v]$ ä¸º $v$ çš„æ·±åº¦ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°†ç¬¬ä¸€ä¸ªæ”¹å†™å¦‚ä¸‹ï¼š\n$$\nf[v] = \\max_{v_i \\text{ is in the subtree of } v}(dep[v_i]) - dep[v]\n$$\næˆ‘ä»¬å¯ä»¥ç”¨å€å¢åœ¨ $O(\\log n)$ çš„æ—¶é—´å†…æ‰¾åˆ°ç¬¬ä¸€ä¸ªä¸éœ€è¦æ›´æ–°çš„ä½ç½®ï¼Œç„¶ååœ¨å€å¢ä¸Šç”¨ $O(\\log n)$ çš„æ—¶é—´å†…æ›´æ–° $f$ å€¼ï¼Œè®¡ç®—å¾—åˆ° $delta$ï¼ˆæ¯æ¬¡æ·±åº¦åªå¢åŠ 1ï¼Œæ‰€ä»¥ä¸€å®šä¼šåªæœ‰ä¸€ä¸ªdeltaï¼‰ï¼Œç„¶åå°† $g$ ä¿®æ”¹ç»´æŠ¤å³å¯ã€‚\nçœ‹äº† Tutorial ä¹‹åæœ‰äº›è‡ªé—­ï¼Œé¢˜è§£ç»™å‡ºäº†ä¸€ä¸ªéå¸¸è½»æ¾æ„‰æ‚¦çš„åŠæ³•ã€‚\né¢˜è§£ æˆ‘ä»¬æ€è€ƒ $\\text{dfs}$ è®¡ç®—ç›´å¾„çš„è¿‡ç¨‹ï¼Œä»ä¸€ä¸ªèŠ‚ç‚¹æ‰¾åˆ°æœ€è¿œçš„ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè¿™ä¸ªèŠ‚ç‚¹ä¸€å®šæ˜¯ç›´å¾„çš„ä¸€ä¸ªç«¯ç‚¹ï¼Œç„¶åæˆ‘ä»¬å†è¿›è¡Œä¸€é $\\text{dfs}$ æœ€è¿œç‚¹å°±æ˜¯ç›´å¾„çš„å¦ä¸€ä¸ªçš„ç«¯ç‚¹ã€‚\næ‰€ä»¥æˆ‘ä»¬è€ƒè™‘ä»æ ¹èŠ‚ç‚¹è¿›è¡Œç¬¬ä¸€æ¬¡ $\\text{dfs}$ ï¼Œæ‰¾åˆ°æœ€è¿œçš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆäº‹å®ä¸Šæ˜¯æ·±åº¦æœ€å¤§çš„èŠ‚ç‚¹ä¹‹ä¸€çš†å¯ï¼‰ã€‚\nå¦‚æœæˆ‘ä»¬ç»™ä¸€ä¸ªèŠ‚ç‚¹æ–°å»ºäº†ä¸¤ä¸ªå­èŠ‚ç‚¹ï¼Œæˆ‘ä»¬å‘ç°å®ƒä»¬çš„çˆ¶äº²æ˜¯å½“å‰æœ€è¿œçš„èŠ‚ç‚¹ï¼Œé‚£ä¹ˆç­”æ¡ˆä¸€å®šå¢åŠ ä¸”åªå¢åŠ äº† $1$ ï¼›\nå¦åˆ™ï¼Œç­”æ¡ˆåªæœ‰å¯èƒ½è¢«å½“å‰æœ€è¿œçš„èŠ‚ç‚¹å’Œæ–°å¢åŠ çš„èŠ‚ç‚¹ä¹‹é—´çš„è·ç¦»æ›´æ–°ã€‚\né‚£ä¹ˆå°±å¯ä»¥å€å¢ç»´æŠ¤ $\\text{LCA}$ è®¡ç®—æ ‘ä¸Šè·ç¦»ï¼Œåœ¨ $O(n \\log n)$ çš„æ—¶é—´å†…è§£å†³è¿™ä¸ªé—®é¢˜ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59  #include \u0026lt;bits/stdc++.h\u0026gt;using namespace std; const int MAXN = 1001000,logn = 22; int q; int f[MAXN][logn],dep[MAXN],t[MAXN]; int lca(int x,int y){ if(dep[x] \u0026lt; dep[y]) swap(x,y); for(int i = logn-1;i\u0026gt;=0;--i){ if(dep[f[x][i]] \u0026gt;= dep[y]) x = f[x][i]; } if(x == y) return x; for(int i = logn-1;i\u0026gt;=0;--i){ if(f[x][i] != f[y][i]) x = f[x][i],y = f[y][i]; } return f[x][0]; } void addnode(int x,int fa){ f[x][0] = fa,dep[x] = dep[fa]+1; for(int i = 1;i\u0026lt;logn;i++){ f[x][i] = f[f[x][i-1]][i-1]; } } int caldis(int x,int y){ return dep[x] + dep[y] - 2 * dep[lca(x,y)]; } void init(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;q); for(int i = 1;i\u0026lt;=q;i++) scanf(\u0026#34;%d\u0026#34;,\u0026amp;t[i]); } void solve(){ dep[1] = 1,dep[2] = dep[3] = dep[4] = 2; f[2][0] = f[3][0] = f[4][0] = 1; int maxdep = 2,maxnode = 2,ans = 2,n = 4; for(int i = 1;i\u0026lt;=q;i++){ int x = t[i]; addnode(++n,x),addnode(++n,x); if(dep[x] == maxdep){ maxdep++,maxnode = n,ans++; } else{ ans = max(ans,caldis(maxnode,n)); } printf(\u0026#34;%d\\n\u0026#34;,ans); } } int main(){ init(); solve(); return 0; }   ","description":"","id":67,"section":"posts","tags":["æ•°æ®ç»“æ„","æ ‘å½¢ç»“æ„","æ ‘çš„ç›´å¾„"],"title":"ã€ŒCF379Fã€New Year Tree-æ ‘çš„ç›´å¾„-å€å¢","uri":"https://blog.chenqiqian.com/posts/cf379f/"},{"content":"æœ‰ $n$ æ¡çº¿æ®µï¼Œåˆ†åˆ«ä¸º $[l_i,r_i]$ ã€‚\næœ‰ $m$ ä¸ªè¯¢é—®ï¼Œåˆ†åˆ«ä¸º $cnt_i,p_1,p_2,\u0026hellip;,p_{cnt_i}$ ã€‚\nå¯¹äºæ¯ä¸ªè¯¢é—®ï¼Œè¾“å‡ºæœ‰å¤šå°‘çº¿æ®µè‡³å°‘è¦†ç›–è¿™ $cnt_i$ â€‹ä¸ªç‚¹ä¸­çš„ä¸€ä¸ªã€‚ï¼ˆ$\\sum cnt_i \\le 3 \\cdot 10^5$ï¼‰\né“¾æ¥ Codeforces\né¢˜è§£ æˆ‘ä»¬å¯ä»¥è€ƒè™‘ä¸€ä¸ªç‚¹çš„è´¡çŒ®ä¼šå‡ºç°åœ¨å“ªäº›åŒºé—´ã€‚\næˆ‘ä»¬æœ€å¤§çš„é—®é¢˜æ˜¯æ¯ä¸ªåŒºé—´å¯èƒ½è¢«å¤šä¸ªç‚¹åœ¨å†…ï¼Œæˆ‘ä»¬å¦‚æœæŒ‰ç…§æ¯ä¸ªç‚¹åœ¨å†…ï¼ˆå·¦ç«¯ç‚¹åœ¨å·¦ï¼Œå³ç«¯ç‚¹åœ¨å³ï¼‰çš„è¯ï¼Œä¼šé‡å¤ç»Ÿè®¡ä¸€äº›åŒºé—´ã€‚\næˆ‘ä»¬è€ƒè™‘ç”¨å”¯ä¸€æ€§ç¡®å®šè¿™ä¸ªè´¡çŒ®ï¼Œç”¨æœ€å·¦ä¾§çš„ç‚¹ç»™åŒºé—´è®¡ç®—è´¡çŒ®ã€‚æ‰€ä»¥æˆ‘ä»¬æ¯ä¸ªç‚¹å¯èƒ½ç”Ÿå‘å‡ºè´¡çŒ®çš„åŒºé—´æ˜¯ä»å·¦è¾¹çš„ä¸Šä¸€ä¸ªç‚¹å³è¾¹ä¸€ç›´åˆ°è¿™ä¸ªç‚¹å³è¾¹æœ€å³ä¾§ä½ç½®ã€‚\næˆ‘ä»¬å¯ä»¥è€ƒè™‘ç”¨æ‰«æçº¿è®¡ç®—è¿™ä¸ªä¸œè¥¿ï¼Œæˆ‘ä»¬è€ƒè™‘å¯¹æ¯æ¬¡ç»™å‡ºçš„ç‚¹æ’åºï¼Œç„¶åæ‰«æçº¿ç»´æŠ¤å³å¯ã€‚\næˆ‘ä»¬å¯ä»¥ç»´æŠ¤ä¸¤ä¸ªBIT/çº¿æ®µæ ‘ï¼Œç„¶åæŸ¥è¯¢åŒºé—´å’Œå³å¯ã€‚\néœ€è¦ KD Tree æˆ–è€…æ ‘å¥—æ ‘æˆ–è€… CDQ åˆ†æ²»æ¥å®ŒæˆäºŒç»´æ•°ç‚¹çš„ä»»åŠ¡ã€‚\nå¯ä»¥çº¿æ®µæ ‘å¥— vector è§£å†³è¿™ä¸ªé—®é¢˜ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106  #include \u0026lt;bits/stdc++.h\u0026gt;using namespace std; const int MAXN = 310000; int n,m,cnt = 0; struct Line{ int l,r; bool operator \u0026lt; (const Line x)const{ if(l != x.l) return l \u0026lt; x.l; else return r \u0026lt; x.r; } }a[MAXN]; int t[MAXN],back[MAXN]; map\u0026lt;int,int\u0026gt; S; void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m); for(int i = 1;i\u0026lt;=n;i++){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;a[i].l,\u0026amp;a[i].r); S[a[i].l] = 0; } sort(a+1,a+n+1); for(auto it = S.begin();it!=S.end();it++){ it-\u0026gt;second = ++cnt; back[cnt] = it-\u0026gt;first; } } namespace SegTree{ vector\u0026lt;int\u0026gt; v[MAXN\u0026lt;\u0026lt;2]; #define lson (nown\u0026lt;\u0026lt;1)  #define rson (nown\u0026lt;\u0026lt;1|1)  #define mid ((l+r)\u0026gt;\u0026gt;1)  void build(int nown,int l,int r,int *a){ for(int i = l;i\u0026lt;=r;i++) v[nown].push_back(a[i]); sort(v[nown].begin(),v[nown].end()); if(l == r) return; else build(lson,l,mid,a),build(rson,mid+1,r,a); } int a,b; void query(int nown,int l,int r,int ql,int qr,int \u0026amp;ans){ if(ql \u0026lt;= l \u0026amp;\u0026amp; r \u0026lt;= qr){ ans += upper_bound(v[nown].begin(),v[nown].end(),b) - lower_bound(v[nown].begin(),v[nown].end(),a); } else{ if(ql \u0026lt;= mid) query(lson,l,mid,ql,qr,ans); if(qr \u0026gt;= mid+1) query(rson,mid+1,r,ql,qr,ans); } } int query(int n,int x1,int x2,int y1,int y2){ if(x1 \u0026gt; x2) return 0; a = y1,b = y2; int ans = 0; query(1,1,n,x1,x2,ans); return ans; } } void build(){ static int tmp[MAXN]; for(int i = 1;i\u0026lt;=n;i++){ tmp[i] = a[i].r; } for(int i = 1;i\u0026lt;=n;i++){ t[i] = back[S[a[i].l]]; } SegTree::build(1,1,n,tmp); } int s[MAXN]; int getval(int x){ return upper_bound(t+1,t+n+1,x) - t; } void solve_case(){ int p; scanf(\u0026#34;%d\u0026#34;,\u0026amp;p); for(int i = 1;i\u0026lt;=p;i++) scanf(\u0026#34;%d\u0026#34;,\u0026amp;s[i]); sort(s+1,s+p+1); s[0] = -1e9; int ans = 0; for(int i = 1;i\u0026lt;=p;i++){ ans += SegTree::query(n,getval(s[i-1]),getval(s[i])-1,s[i],1e9); } printf(\u0026#34;%d\\n\u0026#34;,ans); } void solve(){ for(int i = 1;i\u0026lt;=m;i++){ solve_case(); } } int main(){ init(); build(); solve(); return 0; }   ","description":"","id":68,"section":"posts","tags":["æ•°æ®ç»“æ„","çº¿æ®µæ ‘","æ ‘å¥—æ ‘"],"title":"ã€ŒCF369Eã€Valera and Queries-çº¿æ®µæ ‘","uri":"https://blog.chenqiqian.com/posts/cf369e/"},{"content":"Zxr960115 æ˜¯ä¸€ä¸ªå¤§å†œåœºä¸»ã€‚ä»–å…»äº† $m$ åªå¯çˆ±çš„çŒ«å­,é›‡ä½£äº† $p$ ä¸ªé“²å±å®˜ã€‚è¿™é‡Œæœ‰ä¸€æ¡åˆç›´åˆé•¿çš„é“è·¯ç©¿è¿‡äº†å†œåœºï¼Œæœ‰ $n$ ä¸ªå±±ä¸˜åè½åœ¨é“è·¯å‘¨å›´ï¼Œç¼–å·è‡ªå·¦å¾€å³ä»1åˆ°nã€‚å±±ä¸˜ $i$ ä¸å±±ä¸˜ $i-1$ çš„è·ç¦»æ˜¯ $d_i$ ç±³ã€‚é“²å±å®˜ä»¬ä½åœ¨ $1$ å·å±±ä¸˜ã€‚\nä¸€å¤©ï¼ŒçŒ«å­ä»¬å¤–å‡ºç©è€ã€‚çŒ«å­ $i$ å»å±±ä¸˜ $h_i$ æ¸¸ç©ï¼Œåœ¨ $t_i$ æ—¶é—´ç»“æŸä»–çš„æ¸¸ç©ï¼Œç„¶ååœ¨å±±ä¸˜ $h_i$ å‚»ç­‰é“²å±å®˜ã€‚é“²å±å®˜ä»¬å¿…é¡»æŠŠæ‰€æœ‰çš„çŒ«å­å¸¦ä¸Šã€‚æ¯ä¸ªé“²å±å®˜éƒ½ä¼šä» $1$ èµ°åˆ° $n$ å·å±±ä¸˜ï¼Œå¯ä»¥ä¸èŠ±è´¹æ—¶é—´çš„æŠŠæ‰€æœ‰è·¯é€”ä¸Šæ¸¸ç©ç»“æŸçš„çŒ«å­å¸¦ä¸Šã€‚æ¯ä¸ªé“²å±å®˜çš„é€Ÿåº¦ä¸ºä¸€ç±³æ¯å•ä½æ—¶é—´ï¼Œå¹¶ä¸”è¶³å¤Ÿå¼ºå£®æ¥å¸¦ä¸Šä»»æ„æ•°é‡çš„çŒ«å­ã€‚\nä½ çš„ä»»åŠ¡æ˜¯å®‰æ’æ¯ä¸ªé“²å±å®˜å‡ºå‘çš„æ—¶é—´ï¼Œæœ€å°åŒ–çŒ«å­ä»¬ç­‰å¾…çš„æ—¶é—´ä¹‹å’Œã€‚\né“¾æ¥ Codeforces\né¢˜è§£ æˆ‘ä»¬ä»¤\n$$\nD[i] = \\sum_{j=2}^i d[j]\n$$\né‚£æˆ‘ä»¬å¯ä»¥å§æ‰€æœ‰çš„ $t[i]$ å‡å» $D[h[i]]$ ï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„ $t[i]$ ï¼Œé‚£ä¹ˆå¦‚æœä¸€ä¸ªé¥²å…»å‘˜åœ¨ $t \\le t[i]$ ä¹‹å‰å‡ºå‘ï¼Œå°±èƒ½å¤Ÿæ”¶é›†åˆ°è¿™ä¸ªçŒ«ï¼ŒçŒ«çš„ç­‰å¾…æ—¶é—´ä¸º $t[i] - t$ã€‚\næˆ‘ä»¬å†ä»¤\n$$\nT[i] = \\sum_{j = 1}^{i-1} t[j]\n$$\næˆ‘ä»¬æŠŠçŒ«æŒ‰ç…§æ–°è·å¾— $t[i]$ æ’åºä¹‹åï¼Œæˆ‘ä»¬å¦‚æœä»¤ $dp[i][j]$ ä¸ºæ°å¥½å–åˆ°å‰ $i$ åªçŒ«ï¼Œç”¨å» $j$ ä¸ªé¥²å…»å‘˜æ—¶å€™çš„æœ€å°ä»£ä»·ã€‚\nå¾ˆæ˜æ˜¾æœ‰å¦‚ä¸‹è½¬ç§»ï¼š\n$$\ndp[i][w] = \\max_{0 \\le j \\le i-1}(dp[j][w-1] + t[i]\\times (i-j) - (T[i] - T[j]))\n$$\næˆ‘ä»¬å½“ $j \\le k$æ—¶ï¼Œ$k$ æ¯” $j$ ä¼˜ç­‰ä»·äºï¼š\n$$\ndp[j][w-1] + t[i]\\times (i-j) - T[i] + T[j] \\ge dp[k][w-1] + t[i]\\times (i-k) - T[i] + T[k]\\\ndp[j][w-1] - t[i]\\times j + T[j] \\ge dp[k][w-1] - t[i]\\times k + T[k]\\\ndp[j][w-1] + T[j] -dp[k][w-1] - T[k] \\ge t[i]\\times j - t[i]\\times k \\\ndp[j][w-1] + T[j] -dp[k][w-1] - T[k] \\ge t[i]\\times (j - k) \\\n\\frac{dp[j][w-1] + T[j] -dp[k][w-1] - T[k]}{(j - k)} \\le t[i] \\\n\\frac{Y(j) - Y(k)}{X(j)-X(k)} \\le t[i]\n$$\n$t[i]$ å•è°ƒé€’å¢ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸€æ—¦ $k$ æ¯” $j$ ä¼˜ï¼Œé‚£ä¹ˆ $k$ å°±åœ¨ä¹‹åä¼šä¸€ç›´æ¯” $j$ ä¼˜ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨å•è°ƒé˜Ÿåˆ—ï¼ˆç»´æŠ¤ä¸€ä¸ªå•è°ƒé€’å¢çš„é˜Ÿåˆ—ï¼Ÿï¼‰ä¼˜åŒ–è¿™ä¸ªé—®é¢˜ï¼Œäº‹å®ä¸Šæ˜¯ç»´æŠ¤ä¸€ä¸ªå‡¸åŒ…..ï¼Ÿ\næ—¶é—´å¤æ‚åº¦ $O(n + mp)$ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64  #include \u0026lt;bits/stdc++.h\u0026gt;#define ll long long #define inf 1e18 using namespace std; const int MAXN = 110000; int n,m,p; int d[MAXN],h[MAXN],t[MAXN]; ll T[MAXN]; void init(){ scanf(\u0026#34;%d %d %d\u0026#34;,\u0026amp;n,\u0026amp;m,\u0026amp;p); for(int i = 2;i\u0026lt;=n;i++){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;d[i]); d[i] += d[i-1]; } for(int i = 1;i\u0026lt;=m;i++){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;h[i],\u0026amp;t[i]); t[i] -= d[h[i]]; } sort(t+1,t+m+1); for(int i = 1;i\u0026lt;=m;i++){ T[i] = T[i-1] + t[i]; } } ll a[MAXN],b[MAXN]; ll *dp,*last; int q[MAXN],fi,la; double caly(int x){return last[x] + T[x];} double calc(int j,int k){return (caly(j) - caly(k))/(j-k);} ll caldp(int i,int j){ return last[j] + 1LL * t[i] * (i-j) - (T[i] - T[j]); } void solve(){ dp = a,last = b; for(int i = 0;i\u0026lt;=m;i++) dp[i] = inf; dp[0] = 0; for(int w = 1;w\u0026lt;=p;w++){ fi = la = 0; q[0] = 0; swap(dp,last); for(int i = 1;i\u0026lt;=m;i++){ while(fi \u0026lt; la \u0026amp;\u0026amp; calc(q[fi],q[fi+1]) \u0026lt;= t[i]) fi++; dp[i] = caldp(i,q[fi]); while(fi \u0026lt; la \u0026amp;\u0026amp; calc(q[la-1],q[la]) \u0026gt;= calc(q[la],i)) la--; q[++la] = i; } } printf(\u0026#34;%lld\\n\u0026#34;,dp[m]); } int main(){ init(); solve(); return 0; }   ","description":"","id":69,"section":"posts","tags":["åŠ¨æ€è§„åˆ’","æ–œç‡ä¼˜åŒ–"],"title":"ã€ŒCF311Bã€Cats Transport-æ–œç‡ä¼˜åŒ–dp","uri":"https://blog.chenqiqian.com/posts/cf311b/"},{"content":"ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º $n(1 \\le n \\le 77777)$ çš„æ•°åˆ— $a$ ï¼Œåˆå§‹çš„æ—¶å€™å…¨ä¸º 0ã€‚\nç»™å‡ºä¸€ä¸ª $3 \\times 3$ çš„çŸ©é˜µ $w_{i,j}$ ï¼Œ$w_{i,j} = 1$ æ—¶ä»£è¡¨ $(i,j)$ è¿™ä¸ª**æœ‰åº**æ•°å¯¹ä¸ºå’Œè°çš„æ•°å¯¹ï¼Œå¦åˆ™ $(i,j)$ ä¸ä¸ºä¸€ä¸ªå’Œè°æ•°å¯¹ã€‚\nä¸€ä¸ªæ•°åˆ— $a$ æ˜¯å’Œè°çš„å½“ä¸”ä»…å½“å¯¹äºæ‰€æœ‰çš„ $1\\le i \\le n-1$ ï¼Œ $(a_i,a_{i+1})$ å‡ä¸ºå’Œè°æ•°å¯¹ã€‚\næœ‰ $m(1\\le m \\le 77777)$ æ¬¡ä¿®æ”¹å’Œè¯¢é—®ï¼Œæ¯æ¬¡ç»™å‡ºä¸¤ä¸ªæ•´æ•° $v_i,t_i$ï¼Œå°† $a_{v_i} (1 \\le v_i \\le n)$ ä¿®æ”¹ä¸º $t_i(0\\le t_i \\le 3)$ã€‚\næ¯æ¬¡ä¿®æ”¹åéƒ½è¯¢é—®ï¼Œå¦‚æœå°†æ•°åˆ—é‡Œæ‰€æœ‰çš„ $0$ éƒ½æ›¿æ¢ä¸ºä»»æ„ $1$ åˆ° $3$ ä¹‹é—´çš„æ•´æ•°ï¼ˆä¸åŒä½ç½®çš„ $0$ å¯ä»¥æ›¿æ¢ä¸ºä¸åŒçš„æ•°ï¼‰ï¼Œé‚£ä¹ˆæœ€åäº§ç”Ÿçš„å’Œè°çš„æ•°åˆ—æœ‰å¤šå°‘ç§ã€‚æ¯æ¬¡ä¿®æ”¹åçš„æŸ¥è¯¢å¹¶ä¸ä¼šä½¿æ•°åˆ—å‘ç”Ÿä»»ä½•æ”¹å˜ã€‚\nç­”æ¡ˆå¯¹ $777777777$ å–æ¨¡ã€‚\né“¾æ¥ Codeforces\né¢˜è§£ æˆ‘ä»¬ç»´æŠ¤ä¸€ä¸ªçº¿æ®µæ ‘ï¼Œæ¯ä¸ªåŒºé—´ä¸Šéƒ½ç»´æŠ¤ä¸€ä¸ª $f[i][j]$ ä»£è¡¨è¿™ä¸ªåŒºé—´å·¦ç«¯ç‚¹æ•°å­—ä¸º $i$ çš„æ—¶å€™ï¼Œå³ç«¯ç‚¹ä¸º $j$ çš„æ—¶å€™ï¼Œæ»¡è¶³ä»¥ä¸Šæ¡ä»¶çš„æ–¹æ¡ˆæ•°ã€‚\nåˆå¹¶ç›´æ¥æšä¸¾ä¸¤è¾¹å„ä¹ç§ç»„åˆåˆå¹¶å³å¯ã€‚\næ—¶é—´å¤æ‚åº¦ $O(n \\log n \\times 81)$ ï¼Œè²Œä¼¼å¯ä»¥è¿‡ã€‚\næˆ‘æƒ³äº†ä¸€ä¸ªéº»çƒ¦æ­»çš„çº¿æ€§åŠ¨æ€ $dp$ï¼Œå¥½åƒä¹Ÿå¯ä»¥åšï¼Œæ—¶é—´å¤æ‚åº¦åº”è¯¥æ˜¯ä¸€æ ·çš„ï¼Œä½†ä¸æƒ³å†™äº†\u0026hellip;\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103  #include \u0026lt;bits/stdc++.h\u0026gt;#define ll long long #define mod 777777777LL using namespace std; const int MAXN = 80000; int w[3][3]; namespace SegTree{ struct Node{ ll f[3][3]; Node(){ f[0][0] = f[0][1] = f[0][2] = 0; f[1][0] = f[1][1] = f[1][2] = 0; f[2][0] = f[2][1] = f[2][2] = 0; } void clear(){ f[0][0] = f[0][1] = f[0][2] = 0; f[1][0] = f[1][1] = f[1][2] = 0; f[2][0] = f[2][1] = f[2][2] = 0; } ll *operator [](const int x){return f[x];} }tree[MAXN*4]; #define lson (nown\u0026lt;\u0026lt;1)  #define rson (nown\u0026lt;\u0026lt;1|1)  #define mid ((l+r)\u0026gt;\u0026gt;1)  Node merge(Node \u0026amp;l,Node \u0026amp;r){ Node ans; for(int i = 0;i\u0026lt;3;i++){ for(int j = 0;j\u0026lt;3;j++){ for(int x = 0;x\u0026lt;3;x++){ for(int y = 0;y\u0026lt;3;y++){ ans[i][j] += w[x][y] * l[i][x] * r[y][j]; } } ans[i][j] %= mod; } } return ans; } void build(int nown,int l,int r){ if(l == r){ tree[nown].clear(); tree[nown][0][0] = tree[nown][1][1] = tree[nown][2][2] = 1; } else{ build(lson,l,mid),build(rson,mid+1,r); tree[nown] = merge(tree[lson],tree[rson]); } } void update(int nown,int l,int r,int pos,int v){ // printf(\u0026#34;%d %d %d\\n\u0026#34;,l,r,pos);  if(l == r){ tree[nown].clear(); if(v == 0){tree[nown][0][0] = tree[nown][1][1] = tree[nown][2][2] = 1;} else {tree[nown][v-1][v-1] = 1;} // printf(\u0026#34;!!\\n\u0026#34;);  } else{ if(pos \u0026lt;= mid) update(lson,l,mid,pos,v); if(pos \u0026gt;= mid+1) update(rson,mid+1,r,pos,v); tree[nown] = merge(tree[lson],tree[rson]); // printf(\u0026#34;a:%d %d %d\\n\u0026#34;,l,r,pos);  } } ll query(){ ll ans = 0; for(int i = 0;i\u0026lt;3;i++){ for(int j = 0;j\u0026lt;3;j++){ ans += tree[1][i][j]; } } return ans % mod; } } int n,m; void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m); for(int i = 0;i\u0026lt;3;i++){ for(int j = 0;j\u0026lt;3;j++){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;w[i][j]); } } SegTree::build(1,1,n); } void solve(){ for(int i = 1;i\u0026lt;=m;i++){ int p,v; scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;p,\u0026amp;v); SegTree::update(1,1,n,p,v); printf(\u0026#34;%lld\\n\u0026#34;,SegTree::query()); } } int main(){ init(); solve(); return 0; }   ","description":"","id":70,"section":"posts","tags":["æ•°æ®ç»“æ„","çº¿æ®µæ ‘"],"title":"ã€ŒCF256Eã€Lucky Arrays-ç®€å•çº¿æ®µæ ‘","uri":"https://blog.chenqiqian.com/posts/cf256e/"},{"content":"ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„æ•°åˆ— $a_1,a_2,\u0026hellip;,a_n$ï¼Œå®šä¹‰ $f(x,k) = \\min_{i=0}^{k-1} (a_{x+i})$ ï¼Œè¯·å¯¹äºæ¯ä¸€ä¸ª $k = 1$ åˆ° $n$ ï¼Œæ±‚å‡º $\\sum_{i=1}^{n-k+1} f(i,k)$ çš„å€¼ã€‚\né“¾æ¥ Codeforces\né¢˜è§£ æˆ‘æ‹¥æœ‰ä¸€ä¸ªéå¸¸ä¸‘é™‹çš„åšæ³•ï¼ˆ\næˆ‘ä»¬ç»´æŠ¤ä¸€ä¸ªå¹¶æŸ¥é›†ï¼Œç„¶åæˆ‘ä»¬ä»å¤§å¾€å°åŠ å…¥æ¯ä¸ªæ•° $a[i]$ï¼Œæ¯æ¬¡æ’å…¥ $a[i]$ éƒ½å°è¯•ä¸ $i$ å·¦è¾¹/å³è¾¹çš„é›†åˆåˆå¹¶ã€‚\næˆ‘ä»¬å‘ç°ï¼Œåˆå¹¶çš„åŒºé—´ä¸­é—´æœ‰ä¸€ä¸ªåŒºé—´æœ€å°çš„æ•° $a[i]$ ï¼Œé‚£ä¹ˆæˆ‘ä»¬å‘ç°ä¼šæ–°å‡ºç°ä¸€äº›åŒºé—´ï¼Œå®ƒä»¬çš„æœ€å°å€¼å‡ä¸º $a[i]$ ã€‚å‡è®¾å·¦è¾¹çš„é›†åˆå¤§å°ä¸º $L$ï¼Œå³è¾¹çš„é›†åˆå¤§å°ä¸º $R$ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ–°å¢çš„åŒºé—´å°±æ˜¯ï¼š\n åŠ ä¸Šé•¿åº¦ä¸º $L+R+1$ çš„åŒºé—´çš„æ‰€æœ‰å­åŒºé—´ï¼Œæœ€å°å€¼ä¸º $a[i]$ å‡å»é•¿åº¦åˆ†åˆ«ä¸º $L$ å’Œ $R$ çš„åŒºé—´çš„æ‰€æœ‰å­åŒºé—´ï¼Œæœ€å°å€¼ä¸º $a[i]$  æˆ‘ä»¬å‘ç°é•¿åº¦ä¸º $x$ çš„åŒºé—´çš„å­åŒºé—´äº‹å®ä¸Šæ˜¯ï¼š\n é•¿åº¦ä¸º $1$ çš„å­åŒºé—´ï¼š $x$ ä¸ª é•¿åº¦ä¸º $2$ çš„å­åŒºé—´ï¼š $x-1$ ä¸ª $\\cdots$ é•¿åº¦ä¸º $x-1$ çš„å­åŒºé—´ï¼š$2$ ä¸ª é•¿åº¦ä¸º $x$ çš„å­åŒºé—´ï¼š $1$ ä¸ª  äº‹å®ä¸Šæ˜¯ä¸€ä¸ªç­‰å·®æ•°åˆ—\u0026hellip;æ‰€ä»¥å¦‚æœæˆ‘ä»¬ç»´æŠ¤å·®åˆ†å€¼çš„è¯ï¼Œå°±ç›¸å½“äºä¸€ä¸ªæŸä½ç½®å•ç‚¹åŠ  $x$ï¼Œå…¶ä½™ä½ç½®åŒºé—´å‡ $1$ çš„æ“ä½œ ..ï¼Ÿï¼ˆäº‹å®ä¸Šè¿˜è¦ä¹˜ä¸Šä¸€ä¸ª $a[i]$ ï¼‰\nç¬¬ä¸€ä¸ªæ“ä½œæˆ‘ä»¬ç»´æŠ¤ä¸€ä¸ªå·®åˆ†æ•°ç»„ï¼Œç¬¬äºŒä¸ªæ“ä½œæˆ‘ä»¬ç»´æŠ¤ä¸€ä¸ªäºŒé˜¶å·®åˆ†æ•°ç»„ï¼Œè¿™ä¸ªé¢˜å¤§æ¦‚å°±å¯ä»¥åšäº†ï¼Ÿ\næœ€åçº¿æ€§é€’æ¨å‡ºæ‰€æœ‰çš„ç­”æ¡ˆå³å¯ã€‚\nå¸¸æ•°å·¨å¤§æ— æ¯”è­¦å‘Š\u0026hellip;å¤§çº¦æ˜¯ $O(n \\alpha(n))$ ..ï¼Ÿ\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79  #include \u0026lt;bits/stdc++.h\u0026gt;#define int long long using namespace std; const int MAXN = 1100000; namespace BCJ{ int f[MAXN],siz[MAXN]; void init(int n){ for(int i = 1;i\u0026lt;=n;i++) f[i] = i,siz[i] = 1; } int find(int x){ return f[x] == x?x:f[x] = find(f[x]); } void merge(int x,int y){ int fx = find(x),fy = find(y); if(fx == fy) return; f[fx] = fy; siz[fy] += siz[fx]; } int getsize(int x){return siz[find(x)];} } int n,m; int num[MAXN],s[MAXN],vis[MAXN]; int c1[MAXN],c2[MAXN],ans[MAXN]; bool cmp(int a,int b){return num[a] \u0026gt; num[b];} void init(){ scanf(\u0026#34;%lld\u0026#34;,\u0026amp;n); for(int i = 1;i\u0026lt;=n;i++){ scanf(\u0026#34;%lld\u0026#34;,\u0026amp;num[i]); } BCJ::init(n); } void addc(int x,int v,int val){ if(x == 0) return; // printf(\u0026#34;add: x:%lld val:%lld v:%lld\\n\u0026#34;,x,val,v);  c1[1] += v*x*val; c2[1] -= v*1*val,c2[x+1] += v*1*val; } void calc(){ for(int i = 1;i\u0026lt;=n;i++) s[i] = i; sort(s+1,s+n+1,cmp); for(int i = 1;i\u0026lt;=n;i++){ int t = s[i]; vis[t] = 1; int L = 0,R = 0; if(vis[t-1]) L = BCJ::getsize(t-1),BCJ::merge(t,t-1); if(vis[t+1]) R = BCJ::getsize(t+1),BCJ::merge(t,t+1); addc(L+R+1,1,num[t]),addc(L,-1,num[t]),addc(R,-1,num[t]); } } void solve(){ for(int i = 1;i\u0026lt;=n;i++) c2[i] = c2[i-1] + c2[i]; for(int i = 1;i\u0026lt;=n;i++) c2[i] = c2[i-1] + c2[i]; for(int i = 1;i\u0026lt;=n;i++) c1[i] = c1[i-1] + c1[i]; ans[1] = c1[1]; for(int i = 1;i\u0026lt;=n;i++) ans[i+1] = c1[i] + c2[i]; scanf(\u0026#34;%lld\u0026#34;,\u0026amp;m); for(int i = 1;i\u0026lt;=m;i++){ int t; scanf(\u0026#34;%lld\u0026#34;,\u0026amp;t); printf(\u0026#34;%.10lf\\n\u0026#34;,double(ans[t])/(n-t+1)); } } signed main(){ init(); calc(); solve(); return 0; }   ","description":"","id":71,"section":"posts","tags":["æ•°æ®ç»“æ„"],"title":"ã€ŒCF212Dã€Cutting a Fence-ç®€å•æ•°æ®ç»“æ„","uri":"https://blog.chenqiqian.com/posts/cf212d/"},{"content":"ç»™ä½ ä¸€ç‰‡æ£®æ—ï¼Œæ¯æ¬¡è¯¢é—®ä¸€ä¸ªç‚¹ä¸å¤šå°‘ä¸ªç‚¹æ‹¥æœ‰å…±åŒçš„ $K$ çº§ç¥–å…ˆã€‚\né¢˜è§£ ç”¨å€å¢å¤„ç†å‡º $k$ çº§ç¥–å…ˆï¼Œç„¶åç¦»çº¿æ‰€æœ‰è¯¢é—®åˆ°ä¸€ä¸ªæ•°å¯¹ï¼š $(x,d)$ è¡¨ç¤ºéœ€è¦æŸ¥è¯¢åœ¨ $x$ ä¸ºæ ¹çš„å­æ ‘ä¸­æ·±åº¦ä¸º $d$ çš„èŠ‚ç‚¹ä¸ªæ•°ï¼Œæ¯ä¸ªè¯¢é—®çš„ç­”æ¡ˆå°±æ˜¯è¿™ä¸ªèŠ‚ç‚¹ä¸ªæ•°å‡ $1$ ã€‚\næˆ‘ä»¬å¯ä»¥ç”¨çº¿æ®µæ ‘åˆå¹¶è§£å†³è¿™ä¸ªé—®é¢˜ã€‚\næ—¶é—´å¤æ‚åº¦ $O((n+m) \\log n)$ ï¼Œç©ºé—´å¤æ‚åº¦ $O(n \\log n)$ ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131  #include \u0026lt;bits/stdc++.h\u0026gt;using namespace std; const int MAXN = 110000,logn = 20; struct Edge{ int v,nex; }edge[MAXN*2]; int fir[MAXN],ecnt = 2; void addedge(int a,int b){ edge[ecnt] = (Edge){b,fir[a]}; fir[a] = ecnt++; } namespace SegTree{ int sumn[MAXN*logn*5],ls[MAXN*logn*5],rs[MAXN*logn*5],cnt = 0; #define mid ((l+r)\u0026gt;\u0026gt;1)  void update(int \u0026amp;nown,int l,int r,int pos,int v){ if(!nown) nown = ++cnt; if(l == r) sumn[nown] += v; else{ if(pos \u0026lt;= mid) update(ls[nown],l,mid,pos,v); if(pos \u0026gt;= mid+1) update(rs[nown],mid+1,r,pos,v); sumn[nown] = sumn[ls[nown]] + sumn[rs[nown]]; } } int query(int nown,int l,int r,int pos){ if(!nown) return 0; if(l == r) return sumn[nown]; else{ if(pos \u0026lt;= mid) return query(ls[nown],l,mid,pos); else return query(rs[nown],mid+1,r,pos); } } void merge(int \u0026amp;lt,int rt,int l,int r){ if(lt == 0 || rt == 0){lt = lt + rt;return;} if(l == r) sumn[lt] += sumn[rt]; else{ merge(ls[lt],ls[rt],l,mid); merge(rs[lt],rs[rt],mid+1,r); sumn[lt] = sumn[ls[lt]] + sumn[rs[lt]]; } } } int n,m; int fa[MAXN][logn],dep[MAXN]; struct Q{int d,id;}; vector\u0026lt;Q\u0026gt; q[MAXN]; void init(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n); for(int i = 1;i\u0026lt;=n;i++){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;fa[i][0]); if(fa[i][0] != 0) addedge(fa[i][0],i); } } void dfs0(int nown,int depth){ dep[nown] = depth; for(int nowe = fir[nown];nowe;nowe = edge[nowe].nex){ int v = edge[nowe].v; dfs0(v,depth+1); } } int find_kth(int x,int k){ int t = dep[x] - k; for(int i = logn-1;i\u0026gt;=0;i--){ if(dep[fa[x][i]] \u0026gt;= t) x = fa[x][i]; } return x; } void build(){ for(int j = 1;j\u0026lt;logn;j++) for(int i = 1;i\u0026lt;=n;i++) fa[i][j] = fa[fa[i][j-1]][j-1]; for(int i = 1;i\u0026lt;=n;i++) if(fa[i][0] == 0) dfs0(i,1); } int ans[MAXN]; void pre_calc(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;m); for(int i = 1;i\u0026lt;=m;i++){ int v,p; scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;v,\u0026amp;p); int x = find_kth(v,p); if(x == 0) continue; q[x].push_back((Q){dep[x]+p,i}); } } int rt[MAXN]; void dfs1(int nown){ SegTree::update(rt[nown],1,n,dep[nown],1); for(int nowe = fir[nown];nowe;nowe = edge[nowe].nex){ int v = edge[nowe].v; dfs1(v); SegTree::merge(rt[nown],rt[v],1,n); } for(unsigned i = 0;i\u0026lt;q[nown].size();i++){ int id = q[nown][i].id,dd = q[nown][i].d; if(dd \u0026gt; n) continue; ans[id] = SegTree::query(rt[nown],1,n,dd) - 1; } } void solve(){ for(int i = 1;i\u0026lt;=n;i++) if(fa[i][0] == 0) dfs1(i); for(int i = 1;i\u0026lt;=m;i++) printf(\u0026#34;%d \u0026#34;,ans[i]); printf(\u0026#34;\\n\u0026#34;); } int main(){ init(); build(); pre_calc(); solve(); return 0; }   ","description":"","id":72,"section":"posts","tags":["æ•°æ®ç»“æ„","æ ‘å½¢ç»“æ„","çº¿æ®µæ ‘åˆå¹¶"],"title":"ã€ŒCF208Eã€Blood Cousins-çº¿æ®µæ ‘åˆå¹¶","uri":"https://blog.chenqiqian.com/posts/cf208e/"},{"content":"Bertown å¤§è¡—å¯ä»¥æŠ½è±¡ä¸ºä¸€æ¡æ•°è½´ã€‚åœ¨æ•°è½´ä¸Šæœ‰ $10^9$ ä¸ªå·´å£«ç«™ã€‚ç«™ç‚¹æŒ‰ç…§å®ƒä»¬åœ¨æ•°è½´ä¸Šçš„é¡ºåºä» $1$ åˆ° $10^9$ çš„æ•´æ•°ç¼–å·ã€‚è¿™ä¸ªåŸå¸‚æœ‰ $n$ è¾†å…¬å…±æ±½è½¦ã€‚æ¯å¤©ç¬¬ $i$ ä¸ªå…¬å…±æ±½è½¦ä» $s_i$ ä½ç½®å‡ºå‘ï¼Œåˆ° $f_i$ ä½ç½®åœæ­¢ï¼ˆ $s_i \u0026lt; f_i$ ï¼‰ï¼Œå®ƒåœ¨æ‰€æœ‰ä½äº $s_i$ ä¸ $f_i$ çš„ä¸­é—´ç«™ç‚¹åœé å¹¶ä¸”ä»…åœ¨æ™šä¸Šè¿”å›ã€‚å…¬å…±æ±½è½¦åœ¨æ—¶é—´ $t_i$ å¼€å§‹è¡Œé©¶ï¼Œå¹¶ä¸”å®ƒä¹Ÿåœ¨æ—¶é—´ $t_i$ å®Œæˆè¡Œé©¶ï¼ˆè¡Œé©¶ã€åœé éƒ½æ˜¯ç¬é—´çš„ï¼‰ã€‚æ‰€æœ‰å…¬å…±æ±½è½¦çš„å¼€å§‹æ—¶é—´ $t_i$ éƒ½ä¸åŒã€‚å…¬äº¤è½¦æœ‰æ— é™çš„å®¹é‡ã€‚\nBertown æœ‰å¾ˆå¤šå±…æ°‘ã€‚ä»Šå¤©ç¬¬ $i$ ä¸ªäººè¦ä» $l_i$ ä½ç½®å‡ºå‘åˆ° $r_i$ ä½ç½®ç»“æŸï¼ˆ $l_i \u0026lt; r_i$ ï¼‰ï¼›ç¬¬ $i$ ä¸ªäººåœ¨æ—¶é—´ $b_i$ è¿›å…¥ä»–çš„å‡ºå‘ä½ç½®ï¼ˆ $l_i$ ï¼‰ã€‚ä¸€æ–¹é¢ï¼Œæ¯ä¸ªäººéƒ½å¸Œæœ›å°½å¿«åˆ°è¾¾ç›®çš„åœ°ï¼Œå¦ä¸€æ–¹é¢ï¼Œä»–ä¸æƒ³æ¢ä¹˜å…¬äº¤è½¦ã€‚\nä¹Ÿå°±æ˜¯ï¼šä¸ºç¬¬ $i$ ä¸ªäººæŒ‘é€‰çš„å…¬äº¤æ±½è½¦ $j$ ï¼Œæ»¡è¶³ $s_j \\leq l_i$, $r_i \\leq f_j$ å’Œ $b_i \\leq t_j$ çš„æ¡ä»¶ä¸‹ï¼Œ$t_j$ æœ€å°ã€‚\nä½ çš„ä»»åŠ¡æ˜¯ç¡®å®šæ¯ä¸ªäººä»Šå¤©æ˜¯å¦å¯ä»¥åˆ°è¾¾ç›®çš„åœ°ï¼Œå¦‚æœå¯ä»¥ï¼Œæ‰¾åˆ°æ¯ä¸ªäººå°†ä¹˜åçš„å…¬äº¤è½¦çš„å·ç ï¼Œä¸å¯ä»¥åˆ™è¾“å‡º $-1$ ã€‚\né¢˜è§£ æˆ‘åªæƒ³åˆ°äº†ä¸€ä¸ªçº¿æ®µæ ‘å¥—setçš„ $O(n \\log^2 n)$ çš„åšæ³•ï¼Œä½† tutorial ç»™å‡ºäº†ä¸€ä¸ª $O((n+m) \\log (n+m))$ çš„ä¼˜ç§€åšæ³•ã€‚\næˆ‘ä»¬åœ¨è¿™é‡Œä» $t$ ä»å°å¾€å¤§å¤„ç†ï¼ŒæŒ‰æ—¶é—´é¡ºåºåŠ å…¥æ¯ä¸ªäººï¼›åŠ å…¥è½¦çš„æ—¶å€™åªéœ€è¦åˆ¤æ–­å“ªäº›äººå¯ä»¥è¢«è¿™ä¸ªè½¦å¸¦èµ°ï¼Œç„¶åè¿™ä¸ªè½¦å°±æ˜¯è¿™äº›äººçš„ç­”æ¡ˆã€‚\næˆ‘ä»¬è€ƒè™‘ä½¿ç”¨ä¸€ä¸ªçº¿æ®µæ ‘ç»´æŠ¤è¿™ä¸ªæ‰€æœ‰äººã€‚æˆ‘ä»¬æ ¹æ® $l[i]$ ä»å°åˆ°å¤§å»ºç«‹è¿™ä¸ªæ ‘ï¼Œæ¯ä¸ªä½ç½®æ”¾ç½®ä¸€ä¸ªäººï¼Œç»´æŠ¤åŒºé—´çš„ $r[i]$ æœ€å°å€¼åŠå‡ºç°ä½ç½®ã€‚\nå½“æˆ‘ä»¬åŠ å…¥ä¸€ä¸ª $s_i,f_i$ çš„è½¦çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨æ‰€æœ‰ $l[i]$ å¤§äº $s[i]$ çš„éƒ¨åˆ†ä¸­ï¼Œæ‰¾åˆ°ä¸€ä¸ª $r[i]$ æœ€å°çš„äººï¼ŒæŠŠå®ƒåˆ æ‰ï¼Œç„¶åæŒç»­åˆ°æ‰¾ä¸åˆ°è¿™ä¸ªäººå³å¯ã€‚æœ€åè¿˜åœ¨æ ‘é‡Œé¢çš„éƒ½æ˜¯æ— æ³•ä¹˜è½¦çš„äººã€‚\nè¿™ä¸ªæ–¹æ³•å¾ˆå¥½å•Šï¼Œæ¯”æˆ‘æ ‘å¥—æ ‘ä¸çŸ¥é“é«˜åˆ°å“ªé‡Œå»äº†\u0026hellip;\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118  #include \u0026lt;bits/stdc++.h\u0026gt;#define inf 0x3f3f3f3f using namespace std; typedef pair\u0026lt;int,int\u0026gt; pii; const int MAXN = 210000; struct B{ int l,r,t,id; bool operator \u0026lt; (const B \u0026amp;x)const{return t \u0026lt; x.t;} }bus[MAXN],p[MAXN]; bool cmp(B \u0026amp;x,B \u0026amp;y){return x.l \u0026lt; y.l;} struct Node{ int minn,pos,id; bool operator \u0026lt; (const Node \u0026amp;x)const{return minn \u0026lt; x.minn;} }; int n,m; pii LL[MAXN]; namespace SegTree{ Node t[MAXN\u0026lt;\u0026lt;2]; #define lson (nown\u0026lt;\u0026lt;1)  #define rson (nown\u0026lt;\u0026lt;1|1)  #define mid ((l+r)/2)  void build(int nown,int l,int r,int *id){ if(l == r){ t[nown] = (Node){inf,l,id[l]}; } else{ build(lson,l,mid,id),build(rson,mid+1,r,id); t[nown] = min(t[lson],t[rson]); } } void update(int nown,int l,int r,int pos,int v){//change v  if(l == r) t[nown].minn = v; else{ if(pos \u0026lt;= mid) update(lson,l,mid,pos,v); if(pos \u0026gt;= mid+1) update(rson,mid+1,r,pos,v); t[nown] = min(t[lson],t[rson]); } } Node query(int nown,int l,int r,int ql,int qr){ if(ql \u0026lt;= l \u0026amp;\u0026amp; r \u0026lt;= qr) return t[nown]; else{ Node ans = (Node){inf,0,0}; if(ql \u0026lt;= mid) ans = min(ans,query(lson,l,mid,ql,qr)); if(qr \u0026gt;= mid+1) ans = min(ans,query(rson,mid+1,r,ql,qr)); return ans; } } #undef lson  #undef rson  #undef mid } void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m); for(int i = 1;i\u0026lt;=n;i++){ scanf(\u0026#34;%d %d %d\u0026#34;,\u0026amp;bus[i].l,\u0026amp;bus[i].r,\u0026amp;bus[i].t); bus[i].id = i; } for(int i = 1;i\u0026lt;=m;i++){ scanf(\u0026#34;%d %d %d\u0026#34;,\u0026amp;p[i].l,\u0026amp;p[i].r,\u0026amp;p[i].t); LL[i] = make_pair(p[i].l,i); p[i].id = i; } sort(LL+1,LL+m+1); sort(p+1,p+m+1),sort(bus+1,bus+n+1); } int xx[MAXN]; int tmp[MAXN],pos[MAXN],ans[MAXN]; void build(){ for(int i = 1;i\u0026lt;=m;i++) tmp[i] = LL[i].second,xx[i] = LL[i].first,pos[LL[i].second] = i; SegTree::build(1,1,m,tmp); } void add_person(int now){ SegTree::update(1,1,m,pos[p[now].id],p[now].r); } void add_bus(int now){ int L = lower_bound(xx+1,xx+m+1,bus[now].l) - xx; if(L == m+1) return; while(true){ Node t = SegTree::query(1,1,m,L,m); if(t.minn \u0026gt; bus[now].r) break; else{ ans[t.id] = bus[now].id; SegTree::update(1,1,m,t.pos,inf); } } } void solve(){ int nx = 1,ny = 1; while(true){ if(nx == (n+1)) break; if((nx != n+1 \u0026amp;\u0026amp; ny == m+1) || bus[nx].t \u0026lt; p[ny].t ) add_bus(nx++);// æ–°åŠ å…¥äººï¼Ÿæ–°åŠ å…¥è½¦ï¼Ÿ  else add_person(ny++); } for(int i = 1;i\u0026lt;=m;i++) printf(\u0026#34;%d \u0026#34;,ans[i] == 0?-1:ans[i]); printf(\u0026#34;\\n\u0026#34;); } int main(){ init(); build(); solve(); return 0; }   ","description":"","id":73,"section":"posts","tags":["æ•°æ®ç»“æ„","çº¿æ®µæ ‘"],"title":"ã€ŒCF160Eã€Buses and People-çº¿æ®µæ ‘","uri":"https://blog.chenqiqian.com/posts/cf160e/"},{"content":"ä½ æ˜¯ä¸€ä¸ªèµ›è½¦æ¯”èµ›çš„ç»„ç»‡è€…ï¼Œæƒ³åœ¨çº¿æ€§ç‹å›½ä¸­å®‰æ’ä¸€äº›æ¯”èµ›ã€‚\nçº¿æ€§ç‹å›½æœ‰ $n$ æ¡è¿ç»­çš„ä»å·¦åˆ°å³çš„é“è·¯ã€‚é“è·¯ä»å·¦åˆ°å³ä¾æ¬¡ç¼–å·ä¸ºä» $1$ åˆ° $n$ ï¼Œå› æ­¤é“è·¯æŒ‰ç…§å‡åºæ’åˆ—ã€‚åœ¨è¿™äº›é“è·¯ä¸Šå¯èƒ½ä¼šæœ‰å‡ åœºæ¯”èµ›ï¼Œæ¯ä¸€åœºæ¯”èµ›éƒ½å°†ä½¿ç”¨è¿™äº›é“è·¯çš„æŸä¸ªè¿ç»­çš„å­åºåˆ—ã€‚è€Œä¸”ï¼Œå¦‚æœæŸåœºæ¯”èµ›ä¸¾è¡Œäº†ï¼Œä½ å°†è·å¾—ä¸€å®šæ•°é¢çš„é‡‘é’±ã€‚æ²¡æœ‰æ¯”èµ›åœ¨æ—¶é—´ä¸Šé‡å ï¼Œæ‰€ä»¥æ¯ä¸€æ®µé“è·¯å¯ä»¥åœ¨å¤šä¸ªæ¯”èµ›ä¸­ä½¿ç”¨ã€‚\nä¸å¹¸çš„æ˜¯ï¼Œæ‰€æœ‰é“è·¯çš„çŠ¶å†µéƒ½ä¸ä½³ï¼Œéœ€è¦ä¿®ç†ã€‚æ¯æ¡è·¯éƒ½æœ‰ä¸ä¹‹ç›¸å…³çš„ç»´ä¿®è´¹ç”¨ï¼Œä½ éœ€è¦æ”¯ä»˜è¿™ç¬”è´¹ç”¨æ¥ä¿®ç†é“è·¯ã€‚åªæœ‰åœ¨æŸåœºæ¯”èµ›ä¸­éœ€è¦ä½¿ç”¨çš„æ‰€æœ‰é“è·¯éƒ½è¿›è¡Œäº†ä¿®å¤ï¼Œæ‰èƒ½è¿›è¡Œæ¯”èµ›ã€‚ä½ çš„ä»»åŠ¡æ˜¯ä¿®å¤é“è·¯å¹¶ä½¿ä½ çš„åˆ©æ¶¦æœ€å¤§åŒ–ã€‚ä½ çš„åˆ©æ¶¦è¢«å®šä¹‰ä¸ºä½ ä»æ¯”èµ›ä¸­è·å¾—çš„æ€»é‡‘é¢å‡å»ä½ èŠ±åœ¨ä¿®ç†é“è·¯ä¸Šçš„é’±ã€‚è¯·æ³¨æ„ï¼Œæ‚¨å¯ä»¥å†³å®šä¸ä¿®ä»»ä½•é“è·¯ï¼Œå¹¶è·å¾—åˆ©æ¶¦ $0$ ã€‚\nè¾“å‡ºä½ èƒ½è·å¾—çš„æœ€å¤§åˆ©æ¶¦ã€‚\né“¾æ¥ Codeforces\né¢˜è§£ è€ƒè™‘åŠ¨æ€è§„åˆ’ã€‚æˆ‘ä»¬ä»¤ $dp[i][j]$ ä¸ºåªè€ƒè™‘å‰ $i$ ä¸ªè·¯ï¼Œä¸Šä¸€ä¸ªæ²¡ä¿®çš„è·¯åœ¨ $j$ ä½ç½®å¤„çš„ç­”æ¡ˆã€‚\næˆ‘ä»¬æ˜¾ç„¶æœ‰ä»¥ä¸‹çŠ¶æ€è½¬ç§»ï¼š\n$$\ndp[i][j] = \\left {\n\\begin{aligned}{}\ndp[i-1][j] - c[i] + p[i][j]\u0026amp;,j \u0026lt; i\\\nmax(dp[i-1][k])\u0026amp;,j = i\\\n\\end{aligned}\n\\right.\n$$\nå…¶ä¸­ $p[i][j]$ ç”±æ‰€æœ‰å·¦ç«¯ç‚¹åœ¨ $j$ å³ä¾§ï¼Œå³ç«¯ç‚¹åœ¨ $i$ çš„èµ›é“æ„æˆï¼Œäº‹å®ä¸Šæˆ‘ä»¬å¯ä»¥æ¯ä¸ªèµ›é“çš„è´¡çŒ®å‡ºç°åœ¨å…¶å·¦ç«¯ç‚¹å·¦ä¾§ï¼Œæ‰€ä»¥æ˜¯ä¸€ä¸ªåŒºé—´åŠ ã€‚\næˆ‘ä»¬è€ƒè™‘å¦‚ä½•å¿«é€Ÿè½¬ç§»ï¼Œé’ˆå¯¹ç¬¬ä¸€ä¸ªæ“ä½œï¼Œåªè¦æ”¯æŒåŒºé—´åŠ å‡å³å¯ã€‚\nå¯¹äºç¬¬äºŒä¸ªåªè¦æ”¯æŒåŒºé—´æœ€å€¼æŸ¥è¯¢ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸€ä¸ªçº¿æ®µæ ‘å°±å¯ä»¥è§£å†³äº†ã€‚\næœ‰è¶£çš„ä¼˜åŒ–\u0026hellip;\næ—¶é—´å¤æ‚åº¦ï¼š$O(n \\log n)$ ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101  #include \u0026lt;bits/stdc++.h\u0026gt;#define inf 0x3f3f3f3f3f3f3f3f #define ll long long using namespace std; const int MAXN = 210000; int n,m; ll num[MAXN]; namespace SegTree{ #define lson (nown\u0026lt;\u0026lt;1)  #define rson (nown\u0026lt;\u0026lt;1|1)  #define mid ((l+r)\u0026gt;\u0026gt;1)  ll maxn[MAXN\u0026lt;\u0026lt;2],addn[MAXN\u0026lt;\u0026lt;2]; void add(int nown,ll v){ maxn[nown] += v,addn[nown] += v; } void push_down(int nown){ if(addn[nown] != 0){ add(lson,addn[nown]),add(rson,addn[nown]); addn[nown] = 0; } } void update(int nown,int l,int r,int ql,int qr,ll v){ if(ql \u0026lt;= l \u0026amp;\u0026amp; r \u0026lt;= qr){ add(nown,v); } else{ push_down(nown); if(ql \u0026lt;= mid) update(lson,l,mid,ql,qr,v); if(qr \u0026gt;= mid+1) update(rson,mid+1,r,ql,qr,v); maxn[nown] = max(maxn[lson],maxn[rson]); } } ll query(int nown,int l,int r,int ql,int qr){ if(ql \u0026lt;= l \u0026amp;\u0026amp; r \u0026lt;= qr){ return maxn[nown]; } else{ push_down(nown); ll ans = -inf; if(ql \u0026lt;= mid) ans = max(ans,query(lson,l,mid,ql,qr)); if(qr \u0026gt;= mid+1) ans = max(ans,query(rson,mid+1,r,ql,qr)); return ans; } } void _set(int nown,int l,int r,int pos,ll v){ if(l == r){ maxn[nown] = v; } else{ push_down(nown); if(pos \u0026lt;= mid) _set(lson,l,mid,pos,v); if(pos \u0026gt;= mid+1) _set(rson,mid+1,r,pos,v); maxn[nown] = max(maxn[lson],maxn[rson]); } } } typedef pair\u0026lt;ll,ll\u0026gt; pll; vector\u0026lt;pll\u0026gt; V[MAXN];//first-\u0026gt;pos,second-\u0026gt;val  void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m); for(int i = 1;i\u0026lt;=n;i++){ scanf(\u0026#34;%lld\u0026#34;,\u0026amp;num[i]); } for(int i = 1;i\u0026lt;=m;i++){ ll a,b,c; scanf(\u0026#34;%lld %lld %lld\u0026#34;,\u0026amp;a,\u0026amp;b,\u0026amp;c); V[b].push_back(make_pair(a,c)); } } void solve(){ // çº¿æ®µæ ‘èŒƒå›´ [0,n]  SegTree::update(1,0,n,0,n,-inf); SegTree::_set(1,0,n,0,0); for(int i = 1;i\u0026lt;=n;i++){ ll tmp = SegTree::query(1,0,n,0,i-1); // printf(\u0026#34;%d:%d\\n\u0026#34;,i,tmp);  SegTree::_set(1,0,n,i,tmp); SegTree::update(1,0,n,0,i-1,-num[i]); for(int j = 0;j\u0026lt;int(V[i].size());j++){ ll L = V[i][j].first, val = V[i][j].second; SegTree::update(1,0,n,0,L-1,val); } } printf(\u0026#34;%lld\\n\u0026#34;,SegTree::query(1,0,n,0,n)); } int main(){ init(); solve(); return 0; }   ","description":"","id":74,"section":"posts","tags":["åŠ¨æ€è§„åˆ’","æ•°æ®ç»“æ„","çº¿æ®µæ ‘"],"title":"ã€ŒCF115Eã€Linear Kingdom Races-dp+çº¿æ®µæ ‘ä¼˜åŒ–","uri":"https://blog.chenqiqian.com/posts/cf115e/"},{"content":"æœ‰ $n$ ä¸ªæµ·è±¡ï¼ˆç¼–å·ä¸º $1$ åˆ° $n$ ï¼‰å‚åŠ æ¯”èµ›å»ºé€ è‡ªå·±çš„æ‘©å¤©å¤§æ¥¼ ã€‚åœ¨ $t=0$ æ—¶ï¼Œç¬¬ $i$ ä¸ªæµ·è±¡çš„æ‘©å¤©å¤§æ¥¼çš„é«˜åº¦ä¸º $a_i$ ã€‚æ¯ä¸€æ—¶åˆ»ï¼Œç¼–å·ä¸º $i$ çš„æµ·è±¡ä¼šå®Œæˆ $b_i$ å±‚æ¥¼çš„å»ºé€ ã€‚\nåœ¨å¥¥è¿ä¼šç°åœºæŠ¥é“çš„è®°è€…å‘æ´»åŠ¨ç»„ç»‡è€…æå‡ºäº† $q$ æ¬¡è¯¢é—®ã€‚æ¯æ¬¡è¯¢é—®ç»™å‡ºä¸‰ä¸ªæ•°å­— $l_i$ ï¼Œ$r_i$ ï¼Œ$t_i$ã€‚æ´»åŠ¨ç»„ç»‡è€…ç”¨æ•°å­— $x$ å›ç­”æ¯ä¸ªæŸ¥è¯¢ï¼Œ$x$ æ»¡è¶³ï¼š\n  æ•°å­— $x$ ä½äºä» $l_i$ åˆ° $r_i$ çš„åŒºé—´ï¼Œå³ $l_i \\leq x \\leq r_i$ ã€‚\n  ç¼–å·ä¸º $x$ çš„æµ·è±¡çš„æ‘©å¤©å¤§æ¥¼åœ¨ $t_i$ æ—¶åˆ»æ‹¥æœ‰ç¼–å·åœ¨ $[l_i,r_i]$ ä¸­æ‰€æœ‰æµ·è±¡çš„æ‘©å¤©å¤§æ¥¼ä¸­çš„æœ€å¤§é«˜åº¦ã€‚\n  å¯¹äºæ¯ä½è®°è€…çš„æŸ¥è¯¢ï¼Œè¾“å‡ºç¬¦åˆä¸Šè¿°æ ‡å‡†çš„æµ·è±¡çš„ç¼–å· $x$ ã€‚å¦‚æœæœ‰å¤šä¸ªå¯èƒ½çš„ç­”æ¡ˆï¼Œè¯·è¾“å‡ºå…¶ä¸­ä»»ä½•ä¸€ä¸ªã€‚\né“¾æ¥ Codeforces\né¢˜è§£ å¯ä»¥é‡‡ç”¨åˆ†å—+ç¦»çº¿çš„æ–¹æ³•è¿‡æ‰è¿™é“é¢˜ã€‚\næ¯ä¸ªæµ·è±¡çš„æ¥¼çš„é«˜åº¦éƒ½å¯ä»¥è§†ä½œä¸€æ¡ç›´çº¿ $y = bx + a$ ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„é—®é¢˜å°±å˜æˆäº†æ‰¾è¿™æ®µåŒºé—´å†…çš„ç›´çº¿åœ¨ $x = t$ å¤„çš„æœ€å¤§å€¼ã€‚\næˆ‘ä»¬æ³¨æ„åˆ°ï¼Œå¦‚æœæˆ‘ä»¬å°†æ‰€æœ‰ç›´çº¿æ’åœ¨ä¸€èµ·ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨æ¯ä¸€æ—¶åˆ»æœ€å¤§å€¼ä¸€å®šæ¥è‡ªäºä¸€å †æ–œç‡é€’å¢çš„ç›´çº¿ï¼ˆå°±æ˜¯ä¸€ä¸ªä¸‹å‡¸åŒ…ï¼‰ã€‚\næˆ‘ä»¬è¦åœ¨å—å†…å¤„ç†å‡ºæŒ‰ç…§æ—¶é—´é¡ºåºå¯èƒ½å–åˆ°çš„ç›´çº¿ã€‚æˆ‘ä»¬å…ˆåœ¨å—å†…æŒ‰æ–œç‡ $b$ ä»å°åˆ°å¤§æ’åºï¼Œç„¶åå»æ‰ $b$ ç›¸åŒçš„ç›´çº¿åã€‚æˆ‘ä»¬å¯ä»¥å†ç”¨ $O(\\sqrt{n} \\times \\sqrt{n})$ çš„æ—¶é—´æšä¸¾è¯¥æ¡ç›´çº¿ä¸‹ä¸€æ¡åº”è¯¥æ˜¯å“ªæ¡åé¢çš„ç›´çº¿ï¼ˆåˆ¤æ–­è°çš„äº¤ç‚¹æœ€é å·¦ï¼‰ï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°è¿™ $O(\\sqrt{n})$ æ¡ç›´çº¿çš„ä¸‹å‡¸åŒ…ã€‚\nå¾—åˆ°è¿™ä¸ªå‡¸åŒ…ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—ç­”æ¡ˆã€‚\næˆ‘ä»¬æŠŠè¯¢é—®å¯¹æ—¶é—´æ’åºï¼Œæ•´å—åˆ¤æ–­èƒ½ä¸èƒ½æ›´æ–°è¯¥ç‚¹çš„å‡¸åŒ…æ˜¯ä¸æ˜¯éœ€è¦ä¸‹ä¸€æ¡ç›´çº¿ï¼Œé›¶æ•£ç›´æ¥æš´åŠ›å³å¯ã€‚\næ—¶é—´å¤æ‚åº¦ï¼š $O((m+n) \\sqrt{n})$ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123  #include \u0026lt;bits/stdc++.h\u0026gt;#define inf 1e18 #define pii pair\u0026lt;int,int\u0026gt; using namespace std; const int MAXN = 110000; const int MAXQ = 500; struct Query{ int l,r,t,id; bool operator \u0026lt; (const Query \u0026amp;a)const{ return t \u0026lt; a.t; } }q[MAXN]; int n,m,Q; int lb[MAXN],rb[MAXN],bl[MAXN]; struct P{ int a,b,id; bool operator \u0026lt; (const P \u0026amp;x) const{ if(b != x.b) return b \u0026lt; x.b; if(a != x.a) return a \u0026gt; x.a; return 0; } }p[MAXN]; double calv(P x,int t){ return double(x.a) + double(x.b)*t; } bool cmp(P x,P y,int t){// å‰é¢ä¼˜ï¼Œè¿”å›1ï¼Œåé¢ä¼˜ç§€ï¼Œè¿”å› 0  if(calv(x,t) != calv(y,t)) return calv(x,t) \u0026gt; calv(y,t); else return x.b \u0026gt; y.b; } double calj(P x,P y){ if(x.b == y.b) return inf; return double(x.a-y.a)/(y.b-x.b); } void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m); for(int i = 1;i\u0026lt;=n;i++){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;p[i].a,\u0026amp;p[i].b); p[i].id = i; } for(int i = 1;i\u0026lt;=m;i++){ scanf(\u0026#34;%d %d %d\u0026#34;,\u0026amp;q[i].l,\u0026amp;q[i].r,\u0026amp;q[i].t); q[i].id = i; } sort(q+1,q+m+1); } vector\u0026lt;P\u0026gt; V[MAXQ]; vector\u0026lt;P\u0026gt; tmp; void build(){ Q = sqrt(n); for(int i = 1;i\u0026lt;=n;i++){ bl[i] = (i-1)/Q + 1; if(bl[i] != bl[i-1]) lb[bl[i]] = i,rb[bl[i-1]] = i-1; } rb[bl[n]] = n; for(int x = 1;x\u0026lt;=bl[n];x++){ int L = lb[x],R = rb[x]; for(int i = L;i\u0026lt;=R;i++) V[x].push_back(p[i]); sort(V[x].begin(),V[x].end()); tmp.clear(); tmp.push_back(V[x][0]); for(int i = 1;i \u0026lt; int(V[x].size());i++){ if(V[x][i].b != V[x][i-1].b) tmp.push_back(V[x][i]); } V[x].clear(); V[x].push_back(tmp[0]); for(int i = 0;i \u0026lt; int(tmp.size())-1;){ int t = i; for(int j = i+1;j\u0026lt;int(tmp.size());j++) if(calj(tmp[i],tmp[j]) \u0026lt; calj(tmp[i],tmp[t])) t = j; V[x].push_back(tmp[i = t]); } V[x].push_back(tmp.back()); } } int now[MAXQ]; int ans[MAXN]; void solve(){ for(int i = 1;i\u0026lt;=m;i++){ int L = q[i].l,R = q[i].r,t = q[i].t; int BL = bl[L],BR = bl[R],tmp = 0; if(BL == BR){ for(int i = L;i\u0026lt;=R;i++) if(cmp(p[i],p[tmp],t)) tmp = i; ans[q[i].id] = tmp; continue; } for(int i = BL+1;i\u0026lt;=BR-1;i++){ while(now[i]+1 \u0026lt; int(V[i].size()) \u0026amp;\u0026amp; calv(V[i][now[i]],t) \u0026lt;= calv(V[i][now[i]+1],t)) now[i]++; if(cmp(V[i][now[i]],p[tmp],t)) tmp = V[i][now[i]].id; } for(int i = L;i\u0026lt;=rb[BL];i++) if(cmp(p[i],p[tmp],t)) tmp = i; for(int i = lb[BR];i\u0026lt;=R;i++) if(cmp(p[i],p[tmp],t)) tmp = i; ans[q[i].id] = tmp; } for(int i = 1;i\u0026lt;=m;i++){ printf(\u0026#34;%d\\n\u0026#34;,ans[i]); } } int main(){ init(); build(); solve(); return 0; }   ","description":"","id":75,"section":"posts","tags":["æ•°æ®ç»“æ„","åˆ†å—"],"title":"ã€ŒCF91Eã€Igloo Skyscraper-åˆ†å—","uri":"https://blog.chenqiqian.com/posts/cf91e/"},{"content":"æ±‚\n$$\n\\sum_{i=1}^n\\sum_{j=1}^n ij\\gcd(i,j))~mod~p\n$$\nå…¶ä¸­ $n \u0026lt; 10^{10}$ã€‚\né¢˜è§£ $$\nans =\\sum_{i=1}^n\\sum_{j=1}^n ij\\gcd(i,j))~mod~p\\\n=\\sum_{d=1}^n d\\sum_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum_{j=1}^{\\lfloor\\frac{n}{d}\\rfloor}ijd^2[\\gcd(i,j) == 1]\\\n=\\sum_{d=1}^n d^3 \\sum_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum_{j=1}^{\\lfloor\\frac{n}{d}\\rfloor}ij[\\gcd(i,j) == 1]\\\n$$\nå¦‚æœæˆ‘ä»¬ä»¤\n$$\nf(d) = \\sum_{i=1}^{n}\\sum_{j=1}^{n}ij[\\gcd(i,j) == d]\\\ng(d) = \\sum_{d|k} f(k) = d^2\\sum_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum_{j=1}^{\\lfloor\\frac{n}{d}\\rfloor} ij\\\ng(d) = d^2{\\left[\\frac{\\lfloor\\frac{n}{d}\\rfloor(\\lfloor\\frac{n}{d}\\rfloor + 1)}{2}\\right]}^2\n$$\nä»¤ $sum(x) = \\frac{x(x+1)}{2}$ï¼ŒåŸå¼åŒ–ä¸ºï¼š\n$$\ng(d) = d^2 \\cdot sum(\\lfloor\\frac{n}{d}\\rfloor)^2\n$$\nå°±æœ‰ï¼š\n$$\nf(d) = \\sum_{d|k} \\mu(k) g(\\frac{k}{d})\\\nf(1) = \\sum_{i=1}^n \\mu (i) g(i)\\\nf(1) = \\sum_{i=1}^n \\mu (i) i^2 sum(\\lfloor\\frac{n}{i}\\rfloor)^2\n$$\né‚£ä¹ˆï¼š\n$$\nans = \\sum_{d=1}^n d^3 \\sum_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor} \\mu (i) i^2 sum(\\lfloor\\frac{n}{di}\\rfloor)^2\n$$\næšä¸¾ $id = T$ï¼Œåˆ™æœ‰\n$$\nans = \\sum_{T = 1}^n sum(\\lfloor\\frac{n}{T}\\rfloor)^2 \\sum_{d|T} d^3 \\mu(\\frac{T}{d}) \\times {(\\frac{T}{d})}^2\\\n= \\sum_{T=1}^n T^2 sum(\\lfloor\\frac{n}{T}\\rfloor)^2 \\sum_{d|T} d \\mu(\\frac{T}{d}) \\\n$$\næœ‰ $id*\\mu = \\varphi$ ï¼Œ æ‰€ä»¥\n$$\nans = \\sum_{T=1}^n sum(\\lfloor\\frac{n}{T}\\rfloor)^2 T^2 \\varphi(T) \\\n$$\nä»¤ $f(x) = x^2 \\varphi(x)$ï¼Œæˆ‘ä»¬å°±æœ‰\n$$\nans = \\sum_{T=1}^n sum(\\lfloor\\frac{n}{T}\\rfloor)^2 f(T)\n$$\næ³¨æ„åˆ° $\\lfloor\\frac{n}{T}\\rfloor$ åªæœ‰æ ¹å·ä¸ªå–å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬æƒ³è¦å¤„ç†å‡º $f(T)$ çš„å‰ç¼€å’Œã€‚\næœæ•™ç­›ï¼š\n$$\nS(n) = \\sum_{i=1}^{n} h(i) - \\sum_{d = 2}^{n} g(d)S(\\lfloor \\frac{n}{d} \\rfloor)\n$$\nå¦‚æœæˆ‘ä»¬ä»¤ $g(n) = n^2$ ï¼Œé‚£ä¹ˆ\n$$\nh(i) = (g*f)(i)=\\sum_{d|i}f(d)g(\\frac{i}{d})=\\sum_{d|i}d^2\\varphi(d){(\\frac{i}{d})}^2\\\n= \\sum_{d|i}\\varphi(d)i^2 = i^3\\\n$$\nåˆå› ä¸º\n$$\n\\sum_{i=1}^n i^3 = \\left[\\frac{n(n+1)}{2}\\right]^2\n$$\næ‰€ä»¥æˆ‘ä»¬å°±æœ‰\n$$\nS(n) = \\sum_{i=1}^{n} h(i) - \\sum_{d = 2}^{n} g(d)S(\\lfloor \\frac{n}{d} \\rfloor)\\\n= \\left[\\frac{n(n+1)}{2}\\right]^2 - \\sum_{d = 2}^{n} d^2S(\\lfloor \\frac{n}{d} \\rfloor)\\\n$$\nç»¼ä¸Šï¼š\n$$\nans = \\sum_{T=1}^n sum(\\lfloor\\frac{n}{T}\\rfloor)^2 f(T)\\\nS(n) = \\left[\\frac{n(n+1)}{2}\\right]^2 - \\sum_{d = 2}^{n} d^2S(\\lfloor \\frac{n}{d} \\rfloor)\\\n$$\nä»£ç å®ç°ä¸€å®šè¦å¤šå–æ¨¡\u0026hellip;\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84  #include \u0026lt;bits/stdc++.h\u0026gt;#define ll long long using namespace std; const int MAXN = 8500000; ll pow(ll x,ll k,ll p){ ll ans = 1; for(ll i = k;i;i\u0026gt;\u0026gt;=1,x = (x*x)%p) if(i \u0026amp; 1) ans = (ans*x)%p; return ans; } ll inv(ll x,ll p){return pow(x,p-2,p);} ll p,n,rev_6,rev_2; map\u0026lt;ll,ll\u0026gt; s; ll pre_s[MAXN]; void sieve(){ static ll prime[MAXN],phi[MAXN],cnt = 0; static int vis[MAXN]; phi[1] = 1; for(int i = 2;i\u0026lt;=MAXN-1;i++){ if(vis[i] == 0){ prime[++cnt] = i; phi[i] = i-1; } for(int j = 1;i * prime[j] \u0026lt;= MAXN-1 \u0026amp;\u0026amp; j\u0026lt;=cnt;j++){ vis[i*prime[j]] = 1; if(i % prime[j] == 0){ phi[i*prime[j]] = phi[i] * (prime[j]); break; } else{ phi[i*prime[j]] = phi[i] * (prime[j]-1); } } } for(int i = 1;i\u0026lt;=MAXN-1;i++){ pre_s[i] = phi[i]%p * i % p * i % p; pre_s[i] += pre_s[i-1]; pre_s[i] %= p; } } ll sum(ll x){x%=p;return x%p *(x+1)%p *rev_2%p;} ll sums(ll x){x%=p;return x%p *(x+1)%p *(x+x+1)%p *rev_6%p;} ll S(ll n){ if(n \u0026lt; MAXN) return pre_s[n]; if(s.count(n))return s[n]; ll ans = sum(n)%p; ans = ans*ans%p; for(ll l = 2,r;l \u0026lt;= n;l = r+1){ r = (n/(n/l)); ans -= S(n/l)%p * (sums(r) - sums(l-1)+p)%p; ans = ans % p; } return s[n] = ans % p; } void init(){ scanf(\u0026#34;%lld %lld\u0026#34;,\u0026amp;p,\u0026amp;n); rev_6 = inv(6,p),rev_2 = inv(2,p); } ll calc(ll n){ ll ans = 0; for(ll l = 1,r;l \u0026lt;= n;l = r+1){ r = (n/(n/l)); ll tmp = (S(r) - S(l-1) + p) % p; ll summ = sum(n/l) %p; ans += summ%p * summ%p * tmp%p; ans %= p; } return ans; } int main(){ init(); sieve(); printf(\u0026#34;%lld\\n\u0026#34;,calc(n)); return 0; }   ","description":"","id":76,"section":"posts","tags":["æ•°è®º","æ•°è®ºå‡½æ•°","æœæ•™ç­›"],"title":"ã€ŒLuogu3768ã€ç®€å•çš„æ•°å­¦é¢˜-æœæ•™ç­›","uri":"https://blog.chenqiqian.com/posts/luogu-3768/"},{"content":"ä¸€å®¶é¤å…æœ‰ $n$ é“èœï¼Œç¼–å· $1,\\dots,n$ ï¼Œå¤§å®¶å¯¹ç¬¬ $i$ é“èœçš„è¯„ä»·å€¼ä¸º $a_i(1 \\leq i \\leq n)$ã€‚æœ‰ $m$ ä½é¡¾å®¢ï¼Œç¬¬ $i$ ä½é¡¾å®¢çš„æœŸæœ›å€¼ä¸º $b_i$ï¼Œè€Œä»–çš„åå¥½å€¼ä¸º $x_i$ ã€‚å› æ­¤ï¼Œç¬¬ $i$ ä½é¡¾å®¢è®¤ä¸ºç¬¬ $j$ é“èœçš„ç¾å‘³åº¦ä¸º $b_i\\ \\text{XOR}\\ (a_j+x_i)$ ï¼Œ$\\text{XOR}$ è¡¨ç¤ºå¼‚æˆ–è¿ç®—ã€‚\nç¬¬ $i$ ä½é¡¾å®¢å¸Œæœ›ä»è¿™äº›èœä¸­æŒ‘å‡ºä»–è®¤ä¸ºæœ€ç¾å‘³çš„èœï¼Œå³ç¾å‘³å€¼æœ€å¤§çš„èœï¼Œä½†ç”±äºä»·æ ¼ç­‰å› ç´ ï¼Œä»–åªèƒ½ä»ç¬¬ $l_i$ é“åˆ°ç¬¬ $r_i$ é“ä¸­é€‰æ‹©ã€‚è¯·ä½ å¸®åŠ©ä»–ä»¬æ‰¾å‡ºæœ€ç¾å‘³çš„èœã€‚\né“¾æ¥ Luogu P3293\né¢˜è§£ æˆ‘ä»¬è§‚å¯Ÿåˆ°åŒºé—´é™åˆ¶ï¼Œå¾ˆå®¹æ˜“è®©æˆ‘ä»¬æƒ³åˆ°ä¸»å¸­æ ‘ï¼Œå†è§‚å¯Ÿåˆ°å¼‚æˆ–è¿ç®—ã€æœ€å¤§ï¼Œå¾ˆå®¹æ˜“è”æƒ³åˆ° 0/1 Trie æ ‘ã€‚\næ‰€ä»¥æˆ‘ä»¬å°±æŒ‰ç…§ä¸»å¸­æ ‘çš„æ–¹æ³•å»ºä¸€é¢— 0/1 å¯æŒä¹…åŒ– Trie æ ‘ã€‚\nå¦‚æœæ²¡æœ‰ $x_i$ çš„è¿ç®—ï¼Œä¸Šé¢çš„è§£æ³•å°±å¯ä»¥è§£å†³äº†ã€‚æˆ‘ä»¬ç›´æ¥æŒ‰ç…§ $a_j$ ä»é«˜å¾€ä½æ¯ä½è´ªå¿ƒå–åå³å¯ï¼Œä½†æˆ‘ä»¬æ³¨æ„åˆ°æœ‰äº†ä¸€ä¸ª $(a_j + x_i)$ çš„é™åˆ¶ã€‚\nè¿™ä¸ªé—®é¢˜ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å»ºç«‹ä¸€ä¸ªæƒå€¼çº¿æ®µæ ‘ï¼ˆå¯æŒä¹…åŒ–ï¼‰ï¼Œå†æ¯ä½è´ªå¿ƒï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦å†çº¿æ®µæ ‘ä¸ŠæŠŠé‚£ä¸€æ®µæ‰¾å‡ºæ¥ï¼Œç„¶åå†èµ°å‘å·¦å³åŒºé—´ã€‚\næ—¶é—´å¤æ‚åº¦æ˜¯ä¸¤ä¸ª $log$ ï¼Œå› ä¸ºå…¶ç‰¹æ®Šæ€§ä¸èƒ½åœ¨çº¿æ®µæ ‘ä¸Šç›´æ¥äºŒåˆ†ï¼Œå› æ­¤å¤æ‚åº¦ï¼š$O(m \\log^2 10^5 )$ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77  #include \u0026lt;bits/stdc++.h\u0026gt;using namespace std; const int MAX = 210000; const int MAXN = 210000,logn = 19; int n,m,a[MAXN],rt[MAXN]; namespace prSegTree{ int sumn[MAXN*logn],ls[MAXN*logn],rs[MAXN*logn],cnt; #define mid ((l+r)\u0026gt;\u0026gt;1)  void update(int \u0026amp;nown,int pre,int l,int r,int pos,int v){ nown = ++cnt;ls[nown] = ls[pre],rs[nown] = rs[pre],sumn[nown] = sumn[pre]; if(l == r) sumn[nown] += v; else{ if(pos \u0026lt;= mid) update(ls[nown],ls[pre],l,mid,pos,v); if(pos \u0026gt;= mid+1) update(rs[nown],rs[pre],mid+1,r,pos,v); sumn[nown] = sumn[ls[nown]] + sumn[rs[nown]]; } } int query(int nown,int l,int r,int ql,int qr){ if(!nown) return 0; if(ql \u0026lt;= l \u0026amp;\u0026amp; r \u0026lt;= qr){ return sumn[nown]; } else{ int ans = 0; if(ql \u0026lt;= mid) ans += query(ls[nown],l,mid,ql,qr); if(qr \u0026gt;= mid+1) ans += query(rs[nown],mid+1,r,ql,qr); return ans; } } int query(int lx,int rx,int ql,int qr){ ql = max(1,ql),qr = min(qr,MAX); if(ql \u0026gt; qr) return 0; return query(rx,1,MAX,ql,qr) - query(lx,1,MAX,ql,qr); } } void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m); for(int i = 1;i\u0026lt;=n;i++) scanf(\u0026#34;%d\u0026#34;,\u0026amp;a[i]); for(int i = 1;i\u0026lt;=n;i++) prSegTree::update(rt[i],rt[i-1],1,MAX,a[i],1); } int query(int b,int x,int l,int r){ int ans = 0,tmp = 0; for(int i = 20;i\u0026gt;=0;i--){//è¯¥è€ƒè™‘ (1\u0026lt;\u0026lt;i) çš„ä½ç½®  if(b\u0026amp;(1\u0026lt;\u0026lt;i)){ if(prSegTree::query(rt[l-1],rt[r],tmp-x,tmp+(1\u0026lt;\u0026lt;i)-x-1) \u0026gt; 0) ans += (1\u0026lt;\u0026lt;i); else tmp += (1\u0026lt;\u0026lt;i); } else{ if(prSegTree::query(rt[l-1],rt[r],tmp+(1\u0026lt;\u0026lt;i)-x,tmp+(1\u0026lt;\u0026lt;(i+1))-x-1) \u0026gt; 0) ans += (1\u0026lt;\u0026lt;i),tmp += (1\u0026lt;\u0026lt;i); } } return ans; } void solve(){ for(int i = 1;i\u0026lt;=m;i++){ int b,x,l,r; scanf(\u0026#34;%d %d %d %d\u0026#34;,\u0026amp;b,\u0026amp;x,\u0026amp;l,\u0026amp;r); printf(\u0026#34;%d\\n\u0026#34;,query(b,x,l,r)); } } int main(){ init(); solve(); return 0; }   ","description":"","id":77,"section":"posts","tags":["æ•°æ®ç»“æ„","çº¿æ®µæ ‘","å¯æŒä¹…åŒ–ä¸»å¸­æ ‘"],"title":"ã€ŒSCOI2016ã€ç¾å‘³-å¯æŒä¹…åŒ–çº¿æ®µæ ‘","uri":"https://blog.chenqiqian.com/posts/scoi2016-delicious/"},{"content":"å…±æœ‰ $m$ éƒ¨ç”µå½±ï¼Œç¼–å·ä¸º $1$ åˆ° $m$ï¼Œç¬¬ $i$ éƒ¨ç”µå½±çš„å¥½çœ‹å€¼ä¸º $w[i]$ã€‚åœ¨ $n$ å¤©ä¹‹ä¸­ï¼ˆä» $1$ åˆ° $n$ ç¼–å·ï¼‰æ¯å¤©ä¼šæ”¾æ˜ ä¸€éƒ¨ç”µå½±ï¼Œç¬¬ $i$ å¤©æ”¾æ˜ çš„æ˜¯ç¬¬ $f[i]$ éƒ¨ã€‚ä½ å¯ä»¥é€‰æ‹© $l,r(1 \\leq l \\leq r \\leq n)$ ï¼Œå¹¶è§‚çœ‹ç¬¬ $l,l+1,\\dots , r$ å¤©å†…æ‰€æœ‰çš„ç”µå½±ã€‚å¦‚æœåŒä¸€éƒ¨ç”µå½±ä½ è§‚çœ‹å¤šäºä¸€æ¬¡ï¼Œä½ ä¼šæ„Ÿåˆ°æ— èŠï¼Œäºæ˜¯æ— æ³•è·å¾—è¿™éƒ¨ç”µå½±çš„å¥½çœ‹å€¼ã€‚æ‰€ä»¥ä½ å¸Œæœ›æœ€å¤§åŒ–è§‚çœ‹ä¸”ä»…è§‚çœ‹è¿‡ä¸€æ¬¡çš„ç”µå½±çš„å¥½çœ‹å€¼çš„æ€»å’Œã€‚\né“¾æ¥ Luogu P3582\né¢˜è§£ æˆ‘ä»¬å¯ä»¥è®°å½•ä¸€ä¸ªä¸Šä¸€ä¸ªå‡ºç°è¿™ä¸ªç”µå½±çš„ä½ç½®ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥ç”¨çº¿æ®µæ ‘ç»´æŠ¤ä¸€ä¸ªåç¼€å’Œçš„æœ€å¤§å€¼ï¼Œæ¯æ¬¡ $O(\\log n)$ ä¿®æ”¹ï¼Œç„¶å $O(\\log n)$ æŸ¥è¯¢å³å¯ã€‚\næ—¶é—´å¤æ‚åº¦ï¼š $O(n \\log n)$\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85  #include \u0026lt;bits/stdc++.h\u0026gt;#define ll long long using namespace std; const int MAXN = 1100000; int n,m; int f[MAXN],pre[MAXN],w[MAXN]; int last[MAXN]; void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m); for(int i = 1;i\u0026lt;=n;i++){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;f[i]); pre[i] = last[f[i]],last[f[i]] = i; } for(int i = 1;i\u0026lt;=m;i++){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;w[i]); } } namespace SegTree{ ll maxn[MAXN\u0026lt;\u0026lt;2],addn[MAXN\u0026lt;\u0026lt;2]; #define lson (nown\u0026lt;\u0026lt;1)  #define rson (nown\u0026lt;\u0026lt;1|1)  #define mid ((l+r)\u0026gt;\u0026gt;1)  void addlabel(int nown,ll v){ maxn[nown] += v,addn[nown] += v; } void push_down(int nown){ if(addn[nown] != 0){ addlabel(lson,addn[nown]),addlabel(rson,addn[nown]); addn[nown] = 0; } } void push_up(int nown){ maxn[nown] = max(maxn[lson],maxn[rson]); } void update(int nown,int l,int r,int ql,int qr,ll v){ if(ql \u0026lt;= l \u0026amp;\u0026amp; r \u0026lt;= qr){ addlabel(nown,v); } else{ push_down(nown); if(ql \u0026lt;= mid) update(lson,l,mid,ql,qr,v); if(qr \u0026gt;= mid+1) update(rson,mid+1,r,ql,qr,v); push_up(nown); } } ll query(int nown,int l,int r,int ql,int qr){ if(ql \u0026lt;= l \u0026amp;\u0026amp; r \u0026lt;= qr){ return maxn[nown]; } else{ ll ans = -0x3f3f3f3f3f3f; push_down(nown); if(ql \u0026lt;= mid) ans = max(ans,query(lson,l,mid,ql,qr)); if(qr \u0026gt;= mid+1) ans = max(ans,query(rson,mid+1,r,ql,qr)); return ans; } } } void update(int l,int r,int x){ if(l \u0026lt;= 0 || r \u0026gt;= n+1 || l \u0026gt; r) return; SegTree::update(1,1,n,l,r,x); } void solve(){ ll ans = -0x3f3f3f3f3f3f; for(int i = 1;i\u0026lt;=n;i++){ update(pre[i]+1,i,w[f[i]]); if(pre[i] != 0) update(pre[pre[i]]+1,pre[i],-w[f[i]]); ans = max(ans,SegTree::query(1,1,n,1,i)); } printf(\u0026#34;%lld\\n\u0026#34;,ans); } int main(){ init(); solve(); return 0; }   ","description":"","id":78,"section":"posts","tags":["æ•°æ®ç»“æ„","çº¿æ®µæ ‘"],"title":"ã€ŒPOI2015ã€Kinoman-çº¿æ®µæ ‘","uri":"https://blog.chenqiqian.com/posts/poi2015-kinoman/"},{"content":"è€ƒè™‘ä¸€ä¸ªè¾¹æƒä¸ºéè´Ÿæ•´æ•°çš„æ— å‘è¿é€šå›¾ï¼ŒèŠ‚ç‚¹ç¼–å·ä¸º $1$ åˆ° $N$ ï¼Œè¯•æ±‚å‡ºä¸€æ¡ä» $1$ å·èŠ‚ç‚¹åˆ° $N$ å·èŠ‚ç‚¹çš„è·¯å¾„ï¼Œä½¿å¾—è·¯å¾„ä¸Šç»è¿‡çš„è¾¹çš„æƒå€¼çš„ $\\text{XOR}$ å’Œæœ€å¤§ã€‚\nè·¯å¾„å¯ä»¥é‡å¤ç»è¿‡æŸäº›ç‚¹æˆ–è¾¹ï¼Œå½“ä¸€æ¡è¾¹åœ¨è·¯å¾„ä¸­å‡ºç°äº†å¤šæ¬¡æ—¶ï¼Œå…¶æƒå€¼åœ¨è®¡ç®— $\\text{XOR}$ å’Œæ—¶ä¹Ÿè¦è¢«è®¡ç®—ç›¸åº”å¤šçš„æ¬¡æ•°ã€‚\nå›¾ä¸­å¯èƒ½æœ‰é‡è¾¹æˆ–è‡ªç¯ã€‚\né“¾æ¥ Luogu P4151\né¢˜è§£ ä¸€ä¸ªæœ‰å¯èƒ½æ¯”è¾ƒå¸¸è§çš„å¥—è·¯ï¼š\nè€ƒè™‘ $1\\rightarrow n$ çš„è·¯å¾„ï¼Œä¸€å®šç”±ä¸€æ¡è·¯å¾„å’Œä¸€äº›ç¯è·å¾—ã€‚\næˆ‘ä»¬æ³¨æ„åˆ°è€ƒè™‘æŒ‚åœ¨è·¯å¾„ä¸Šçš„ç¯çš„å½±å“æ—¶ï¼Œä¸å¿…è€ƒè™‘ç¯å¦‚ä½•åˆ°è¾¾è·¯å¾„ï¼Œå› ä¸ºæˆ‘ä»¬å¿…ç„¶æœ‰ä¸€æ¡è·¯å¾„ä½¿å¾—â€œå»ç¯â€å’Œâ€œç¦»å¼€ç¯â€æ°å¥½æŠµæ¶ˆã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥éšä¾¿åŠ ç¯ã€‚\næˆ‘ä»¬ç”šè‡³è¿˜æ³¨æ„åˆ°ï¼Œ$1\\rightarrow n$ è·¯å¾„ä¹Ÿå¯ä»¥éšä¾¿é€‰ï¼Œå› ä¸ºå¦‚æœæ˜¯å¦ä¸€æ¡è·¯å¾„çš„è¯ï¼Œäº‹å®ä¸Šå¼‚æˆ–ä¸€ä¸ªç»è¿‡ $1$ å’Œ $n$ çš„å¤§ç¯å°±å¯ä»¥å¾—åˆ°å¦ä¸€æ¡ $1 \\rightarrow n$ çš„è·¯å¾„äº†ã€‚\næ‰¾ç¯å°±ç”¨ dfs ï¼Œå…¶ä¸­æ¯ä¸€æ¡è¿”ç¥–è¾¹éƒ½å¯ä»¥å¯¹åº”ä¸€ä¸ªç¯ã€‚å³ä½¿æ˜¯æœ‰å…¬å…±è¾¹çš„ç¯ä¹Ÿå¯ä»¥ç”¨å°ç¯å¼‚æˆ–å‡ºæ¥ï¼Œæ‰€ä»¥è¿”ç¥–è¾¹ç›´æ¥å¤„ç†ç¯å³å¯ã€‚\næ—¶é—´å¤æ‚åº¦ $O(n \\times 64)$.\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81  #include \u0026lt;cstdio\u0026gt;using namespace std; typedef long long ll; const int MAXN = 51000,MAXM = 110000,logn = 61; struct LB{ ll basis[logn]; void insert(ll x){ if(!x) return; for(int i = logn-1;i\u0026gt;=0;--i){ if((x \u0026amp; (1LL\u0026lt;\u0026lt;i)) == 0) continue; if(basis[i] == 0){ basis[i] = x; break; } else{ x ^= basis[i]; } } } ll getmax(ll ans = 0){ for(int i = logn-1;i\u0026gt;=0;--i){ if((ans^basis[i]) \u0026gt; ans){ ans ^= basis[i]; } } return ans; } }B; struct Edge{ int to,nex; ll len; }edge[MAXM*2]; int fir[MAXN],ecnt = 2; void addedge(int a,int b,ll c){ edge[ecnt] = (Edge){b,fir[a],c}; fir[a] = ecnt++; } int n,m; void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m); int a,b;ll c; for(int i = 1;i\u0026lt;=m;i++){ scanf(\u0026#34;%d %d %lld\u0026#34;,\u0026amp;a,\u0026amp;b,\u0026amp;c); addedge(a,b,c); addedge(b,a,c); } } ll dis[MAXN];bool vis[MAXN]; void dfs(int nown){ vis[nown] = 1; for(int nowe = fir[nown];nowe;nowe = edge[nowe].nex){ int v = edge[nowe].to;ll len = edge[nowe].len; if(vis[v] == 1){ B.insert(dis[nown]^dis[v]^len); } else{ dis[v] = dis[nown] ^ len; dfs(v); } } } void solve(){ dfs(1); printf(\u0026#34;%lld\\n\u0026#34;,B.getmax(dis[n])); } int main(){ init(); solve(); return 0; }   ","description":"","id":79,"section":"posts","tags":["æ•°å­¦","çº¿æ€§åŸº"],"title":"ã€ŒWC2011ã€æœ€å¤§XORè·¯å¾„-dfs+çº¿æ€§åŸº","uri":"https://blog.chenqiqian.com/posts/wc2011-xor/"},{"content":"æ¯ä¸ªéª‘å£«éƒ½æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªè‡ªå·±æœ€åŒæ¶çš„éª‘å£«ï¼ˆå½“ç„¶ä¸æ˜¯ä»–è‡ªå·±ï¼‰ï¼Œä»–æ˜¯ç»å¯¹ä¸ä¼šä¸è‡ªå·±æœ€åŒæ¶çš„äººä¸€åŒå‡ºå¾çš„ã€‚\nè¯·ä½ ä»æ‰€æœ‰çš„éª‘å£«ä¸­é€‰å‡ºä¸€ä¸ªéª‘å£«å†›å›¢ï¼Œä½¿å¾—å†›å›¢å†…æ²¡æœ‰çŸ›ç›¾çš„ä¸¤äººï¼ˆä¸å­˜åœ¨ä¸€ä¸ªéª‘å£«ä¸ä»–æœ€ç—›æ¨çš„äººä¸€åŒè¢«é€‰å…¥éª‘å£«å†›å›¢çš„æƒ…å†µï¼‰ï¼Œå¹¶ä¸”ä½¿å¾—è¿™æ”¯éª‘å£«å†›å›¢æœ€å…·æœ‰æˆ˜æ–—åŠ›ã€‚\nä¸ºäº†æè¿°æˆ˜æ–—åŠ›ï¼Œæˆ‘ä»¬å°†éª‘å£«æŒ‰ç…§ $1$ è‡³ $n$ ç¼–å·ï¼Œç»™æ¯åéª‘å£«ä¸€ä¸ªæˆ˜æ–—åŠ›çš„ä¼°è®¡ï¼Œä¸€ä¸ªå†›å›¢çš„æˆ˜æ–—åŠ›ä¸ºæ‰€æœ‰éª‘å£«çš„æˆ˜æ–—åŠ›æ€»å’Œã€‚\né“¾æ¥ LuoguP2607\né¢˜è§£ å…ˆè€ƒè™‘ä¸€ä¸ª $n$ æ¡è¾¹ã€ $n$ ä¸ªç‚¹çš„æ— å‘è¿é€šå›¾çš„æƒ…å†µã€‚è¿™ä¸ªç¯ä¸­åªæœ‰ä¸€ä¸ªç¯ï¼Œæˆ‘ä»¬åœ¨ä»»æ„ä½ç½®æ–­æ‰è¿™ä¸ªç¯ï¼ˆå¹¶æŸ¥é›†ï¼‰ï¼Œè®©è¿™ä¸ªå›¾æˆä¸ºä¸€ä¸ªæ ‘ï¼Œè®°ä¸¤ç«¯ç‚¹ä¸º $X$,$Y$ã€‚\næ³¨æ„åˆ°ç”±äº $X$ å’Œ $Y$ ä¸èƒ½åŒæ—¶å–å¾—ï¼Œå¦‚æœæˆ‘ä»¬åˆ†åˆ«ä»¥ $X$ å’Œ $Y$ ä½œä¸ºæ ‘æ ¹è¿›è¡Œä¸€æ¬¡æ ‘å½¢ dp ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ç­”æ¡ˆè‚¯å®šåœ¨ç¬¬ä¸€æ¬¡çš„ $dp[X][0]$ å’Œç¬¬äºŒæ¬¡çš„ $dp[Y][0]$ ä¸­çš„æŸä¸€ä¸ªï¼Œå› ä¸ºä¸å¯èƒ½ä¸¤ä¸ªéƒ½é€‰ï¼Œæˆ‘ä»¬ä»¤ä¸€ä¸ªä¸é€‰ä¹‹åï¼Œå‰©ä¸‹çš„å°±åªå‰©ä¸‹æ ‘çš„é™åˆ¶ï¼Œæˆ‘ä»¬ä¹Ÿä¸€å®šèƒ½å¤Ÿè¾¾æˆæœ€å¤§çš„æƒ…å†µã€‚\nä¸æ˜¯ç‰¹åˆ«å¥½ç†è§£ï¼Œä½†å¥½å¥½ç†ä¸€ä¸‹ä¹Ÿä¸æ˜¯ç‰¹åˆ«éš¾å§ã€‚\nè¿™é‡Œæ²¡æœ‰ä¿è¯è”é€šï¼Œä½†å¯¹äºä»»æ„ä¸€ä¸ªè”é€šå—ç”±äºå…¶ç‰¹æ®Šçš„å»ºå›¾æ–¹å¼ï¼Œå¯¼è‡´ä¹Ÿå‡ä¸ºåŸºç¯æ ‘æˆ–æ ‘ã€‚\næ—¶é—´å¤æ‚åº¦ï¼š $O(n)$.\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cstring\u0026gt;#include \u0026lt;algorithm\u0026gt;#define ll long long using namespace std; const int MAXN = 1e6+10; struct Edge{ int to,nex; }edge[MAXN*2]; int fir[MAXN],ecnt = 2; void addedge(int a,int b){ edge[ecnt] = (Edge){b,fir[a]}; fir[a] = ecnt++; } int n; namespace BCJ{ int f[MAXN]; void init(int n){ for(int i = 1;i\u0026lt;=n;i++){ f[i] = i; } } int find(int x){ return f[x] == x ? x : f[x] = find(f[x]); } } int X[MAXN],Y[MAXN],cnt; bool vis[MAXN]; ll p[MAXN]; void init(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n); BCJ::init(n); int a,b; for(int i = 1;i\u0026lt;=n;i++){ scanf(\u0026#34;%lld %d\u0026#34;,\u0026amp;p[i],\u0026amp;b); a = i; int fa = BCJ::find(a),fb = BCJ::find(b); if(fa == fb){ X[++cnt] = a, Y[cnt] = b; } else{ addedge(a,b),addedge(b,a); BCJ::f[fa] = fb; } } } ll dp[MAXN][2]; void dfs(int nown,int fa){ dp[nown][0] = dp[nown][1] = 0; vis[nown] = 1; for(int nowe = fir[nown];nowe;nowe = edge[nowe].nex){ int v = edge[nowe].to; if(v == fa) continue; dfs(v,nown); dp[nown][1] += dp[v][0]; dp[nown][0] += max(dp[v][0],dp[v][1]); } dp[nown][1] += p[nown]; } void solve(){ ll ans = 0; for(int i = 1;i\u0026lt;=cnt;i++){ ll tmp = 0; dfs(X[i],0); tmp = max(dp[X[i]][0],tmp); dfs(Y[i],0); tmp = max(dp[Y[i]][0],tmp); ans += tmp; } for(int i = 1;i\u0026lt;=n;i++){ if(vis[i] == 0){ dfs(i,0); ans += max(dp[i][0],dp[i][1]); } } printf(\u0026#34;%lld\\n\u0026#34;,ans); } int main(){ init(); solve(); return 0; }   ","description":"","id":80,"section":"posts","tags":["åŸºç¯æ ‘","åŠ¨æ€è§„åˆ’"],"title":"ã€ŒZJOI2008ã€éª‘å£«-åŸºç¯æ ‘+dp","uri":"https://blog.chenqiqian.com/posts/zjoi2008-knight/"},{"content":"æœ‰ä¸€ä¸ªçƒå½¢ç©ºé—´äº§ç”Ÿå™¨èƒ½å¤Ÿåœ¨ $n$ ç»´ç©ºé—´ä¸­äº§ç”Ÿä¸€ä¸ªåšç¡¬çš„çƒä½“ã€‚ç°åœ¨ï¼Œä½ è¢«å›°åœ¨äº†è¿™ä¸ª $n$ ç»´çƒä½“ä¸­ï¼Œä½ åªçŸ¥é“çƒé¢ä¸Š $n+1$ ä¸ªç‚¹çš„åæ ‡ï¼Œä½ éœ€è¦ä»¥æœ€å¿«çš„é€Ÿåº¦ç¡®å®šè¿™ä¸ª $n$ ç»´çƒä½“çš„çƒå¿ƒåæ ‡ï¼Œä»¥ä¾¿äºæ‘§æ¯è¿™ä¸ªçƒå½¢ç©ºé—´äº§ç”Ÿå™¨ã€‚\næç¤ºï¼šç»™å‡ºä¸¤ä¸ªå®šä¹‰ï¼š\n çƒå¿ƒï¼šåˆ°çƒé¢ä¸Šä»»æ„ä¸€ç‚¹è·ç¦»éƒ½ç›¸ç­‰çš„ç‚¹ã€‚ è·ç¦»ï¼šè®¾ä¸¤ä¸ªnä¸ºç©ºé—´ä¸Šçš„ç‚¹A, Bçš„åæ ‡ä¸º$(a_1, a_2, \\cdots , a_n)$ , $(b_1, b_2, \\cdots , b_n)$ï¼Œåˆ™ AB çš„è·ç¦»å®šä¹‰ä¸ºï¼š$dist = \\sqrt{ \\sum_{i=1}^{n}(a_i - b_i)^2 }$  é“¾æ¥ Luogu P4035\né¢˜è§£ è®¾åœ†å¿ƒä¸º $(x_1,x_2, \\cdots ,x_n)$ ã€‚\nåˆ™æˆ‘ä»¬æœ‰ $n$ ä¸ªå¼å­ï¼Œå½¢å¦‚\n$$\n\\sum_{i=1}^{n}(p[j][i] - x_i)^2 = \\sum_{i=1}^{n}(p[j+1][i] - x_i)^2\n$$\nåŒ–ç®€å¾—åˆ°\n$$\n\\sum_{i=1}^{n}(p[j][i]^2 - 2p[j][i] \\cdot x_i) = \\sum_{i=1}^{n}(p[j+1][i]^2 - 2p[j+1][i] \\cdot x_i)\\\n\\sum_{i=1}^{n} [2(p[j+1][i]-p[j][i]) \\cdot x_i] = - \\sum_{i=1}^{n}(p[j][i]^2 - p[j+1][i]^2)\n$$\né«˜æ–¯æ¶ˆå…ƒå³å¯\u0026hellip;\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cmath\u0026gt;#include \u0026lt;cstdlib\u0026gt;#include \u0026lt;algorithm\u0026gt;using namespace std; const double eps = 1e-8; double squ(double x){return x * x;} const int MAXN = 410; int n; double p[MAXN][MAXN]; void init(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n); for(int i = 1;i\u0026lt;=n+1;i++){ for(int j = 1;j\u0026lt;=n;j++){ scanf(\u0026#34;%lf\u0026#34;,\u0026amp;p[i][j]); } } } bool gauss(int n,double a[MAXN][MAXN]){ for(int i = 1;i\u0026lt;=n;i++){ int r = i; for(int j = i+1;j\u0026lt;=n;j++){ if(fabs(a[j][i]) \u0026gt; fabs(a[r][i])) r = j; } if(fabs(a[r][i]) \u0026lt;= eps) return false; if(r != i){ for(int j = 1;j\u0026lt;=n+1;j++) swap(a[i][j],a[r][j]); } for(int j = 1;j\u0026lt;=n;j++)if(j!=i){ double d = a[j][i]/a[i][i]; for(int k = 1;k\u0026lt;=n+1;k++){ a[j][k] -= d * a[i][k]; } } } for(int i = 1;i\u0026lt;=n;i++){ a[i][n+1] /= a[i][i]; a[i][i] = 1; } return true; } void solve(){ static double a[MAXN][MAXN]; for(int j = 1;j\u0026lt;=n;j++){ for(int i = 1;i\u0026lt;=n;i++){ a[j][i] = 2 * (p[j+1][i] - p[j][i]); a[j][n+1] -= squ(p[j][i]) - squ(p[j+1][i]); } } gauss(n,a); for(int i = 1;i\u0026lt;=n;i++){ printf(\u0026#34;%.3lf \u0026#34;,a[i][n+1]); } printf(\u0026#34;\\n\u0026#34;); } int main(){ init(); solve(); return 0; }   ","description":"","id":81,"section":"posts","tags":["æ•°å­¦","é«˜æ–¯æ¶ˆå…ƒ"],"title":"ã€ŒJSOI2008ã€çƒå½¢ç©ºé—´äº§ç”Ÿå™¨-é«˜æ–¯æ¶ˆå…ƒ","uri":"https://blog.chenqiqian.com/posts/jsoi2008-sphere/"},{"content":"åƒåœ¾ CCF\næ¯æˆ‘é’æ˜¥\nDay 0 è®²è¯„è¯•å·ï¼Œæ—·æ‰äº†ã€‚åœ¨æœºæˆ¿åˆ·æ¨¡æ¿é¢˜ï¼Œæ™šä¸Šåˆ·ä¸åŠ¨äº†å°±å¼€å§‹ç–¯ç‹‚é¢„æµ‹åä¸¤å¤©çš„é¢˜ç›®ï¼š\nèƒ¡ä¹±é¢„æµ‹äº†ä¸€äº›éå¸¸ç¥å¥‡çš„ä¸œè¥¿ï¼šT1æ•°è®º/æ¨¡æ‹Ÿï¼ŒT2/T3èƒŒåŒ…ã€æ ‘å½¢dpã€åŸºç¯æ ‘ã€å›¾è®º+ç¼©ç‚¹+å€å¢ã€‚\næˆ‘æ˜¯ä¸æ˜¯è¦è¢«ç¦èµ›ä¸€å¹´äº†å•Šã€‚\nDay 1 sb Day1ï¼Œä¸åšè¯„è®ºã€‚\nT1ï¼šé“ºè®¾é“è·¯ é¢˜é¢ æ˜¥æ˜¥æ˜¯ä¸€åé“è·¯å·¥ç¨‹å¸ˆï¼Œè´Ÿè´£é“ºè®¾ä¸€æ¡é•¿åº¦ä¸º $n$ çš„é“è·¯ã€‚\né“ºè®¾é“è·¯çš„ä¸»è¦å·¥ä½œæ˜¯å¡«å¹³ä¸‹é™·çš„åœ°è¡¨ã€‚æ•´æ®µé“è·¯å¯ä»¥çœ‹ä½œæ˜¯ $n$ å—é¦–å°¾ç›¸è¿çš„åŒºåŸŸï¼Œä¸€å¼€å§‹ï¼Œç¬¬ $i$ å—åŒºåŸŸä¸‹é™·çš„æ·±åº¦ä¸º $d_i$ ã€‚\næ˜¥æ˜¥æ¯å¤©å¯ä»¥é€‰æ‹©ä¸€æ®µè¿ç»­åŒºé—´ $[L,R]$ ï¼Œå¡«å……è¿™æ®µåŒºé—´ä¸­çš„æ¯å—åŒºåŸŸï¼Œè®©å…¶ä¸‹é™·æ·±åº¦å‡å°‘ $1$ ã€‚åœ¨é€‰æ‹©åŒºé—´æ—¶ï¼Œéœ€è¦ä¿è¯ï¼ŒåŒºé—´å†…çš„æ¯å—åŒºåŸŸåœ¨å¡«å……å‰ä¸‹é™·æ·±åº¦å‡ä¸ä¸º $0$ ã€‚\næ˜¥æ˜¥å¸Œæœ›ä½ èƒ½å¸®ä»–è®¾è®¡ä¸€ç§æ–¹æ¡ˆï¼Œå¯ä»¥åœ¨æœ€çŸ­çš„æ—¶é—´å†…å°†æ•´æ®µé“è·¯çš„ä¸‹é™·æ·±åº¦éƒ½å˜ä¸º $0$ ã€‚\né¢˜è§£ å¼€å§‹çœ‹é¢˜å±…ç„¶æ—©äº†ä¸€äº›ï¼Œè¢«å–æ­¢å…³ä¸Šé¢˜é¢çš„æ—¶å€™å·²ç»è®°ä¸‹æ¥è¿™é“é¢˜äº†ï¼Œäºæ˜¯åœ¨å¼€è€ƒå‰å°±è„‘è¡¥å‡ºäº†è¿™é“é¢˜çš„è§£æ³•\u0026hellip;å¼€è€ƒ5åˆ†é’Ÿæ•²å®Œè¿‡å¤§æ ·ä¾‹\u0026hellip;\næˆ‘ä»¬ç»´æŠ¤ä¸€ä¸ªå·®åˆ†æ•°ç»„ $c[i] = d[i] - d[i-1]$ ï¼Œå¦‚æœ $c[i] \u0026gt; 0$ æˆ‘ä»¬å°±å°†å…¶ç´¯åŠ åˆ°è´¡çŒ®ä¸­ã€‚\næ­£ç¡®æ€§ä¼¼ä¹ååˆ†æ˜¾ç„¶ï¼Œä½ ä¸å¯èƒ½æ‰¾åˆ°ä¸€ä¸ªæ›´å°çš„æ–¹æ¡ˆæ¥è¦†ç›–äº†ã€‚\nèµ›åå¾—çŸ¥è¯¥é¢˜æ˜¯NOIp2013åŸé¢˜ï¼Œä¼¼ä¹æ¨¡æ‹Ÿèµ›é‡Œæˆ‘è¿˜åšè¿‡è¿™é“é¢˜ï¼ˆä¸è¿‡å½“æ—¶è¿˜WAäº†\nè€—æ—¶5åˆ†é’Ÿã€‚\næœŸæœ›å¾—åˆ†ï¼š100ï¼Œå®é™…å¾—åˆ†ï¼š100\nT2ï¼šè´§å¸ç³»ç»Ÿ é¢˜é¢ åœ¨ç½‘å‹çš„å›½åº¦ä¸­å…±æœ‰ $n$ ç§ä¸åŒé¢é¢çš„è´§å¸ï¼Œç¬¬ $i$ ç§è´§å¸çš„é¢é¢ä¸º $a[i]$ ï¼Œä½ å¯ä»¥å‡è®¾æ¯ä¸€ç§è´§å¸éƒ½æœ‰æ— ç©·å¤šå¼ ã€‚ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬æŠŠè´§å¸ç§æ•°ä¸º $n$ ã€é¢é¢æ•°ç»„ä¸º $a[1..n]$ çš„è´§å¸ç³»ç»Ÿè®°ä½œ $(n,a)$ã€‚\nåœ¨ä¸€ä¸ªå®Œå–„çš„è´§å¸ç³»ç»Ÿä¸­ï¼Œæ¯ä¸€ä¸ªéè´Ÿæ•´æ•°çš„é‡‘é¢ $x$ éƒ½åº”è¯¥å¯ä»¥è¢«è¡¨ç¤ºå‡ºï¼Œå³å¯¹æ¯ä¸€ä¸ªéè´Ÿæ•´æ•° $x$ ï¼Œéƒ½å­˜åœ¨ $n$ ä¸ªéè´Ÿæ•´æ•° $t[i]$ æ»¡è¶³ $a[i] \\times t[i]$ çš„å’Œä¸º xxã€‚ç„¶è€Œï¼Œ åœ¨ç½‘å‹çš„å›½åº¦ä¸­ï¼Œè´§å¸ç³»ç»Ÿå¯èƒ½æ˜¯ä¸å®Œå–„çš„ï¼Œå³å¯èƒ½å­˜åœ¨é‡‘é¢ $x$ ä¸èƒ½è¢«è¯¥è´§å¸ç³»ç»Ÿè¡¨ç¤ºå‡ºã€‚ä¾‹å¦‚åœ¨è´§å¸ç³»ç»Ÿ $n=3$, $a=[2,5,9]$ ä¸­ï¼Œé‡‘é¢ $1,3$ å°±æ— æ³•è¢«è¡¨ç¤ºå‡ºæ¥ã€‚\nä¸¤ä¸ªè´§å¸ç³»ç»Ÿ $(n,a)$ å’Œ $(m,b)$ æ˜¯ç­‰ä»·çš„ï¼Œå½“ä¸”ä»…å½“å¯¹äºä»»æ„éè´Ÿæ•´æ•° $x$ï¼Œå®ƒè¦ä¹ˆå‡å¯ä»¥è¢«ä¸¤ä¸ªè´§å¸ç³»ç»Ÿè¡¨å‡ºï¼Œè¦ä¹ˆä¸èƒ½è¢«å…¶ä¸­ä»»ä½•ä¸€ä¸ªè¡¨å‡ºã€‚\nç°åœ¨ç½‘å‹ä»¬æ‰“ç®—ç®€åŒ–ä¸€ä¸‹è´§å¸ç³»ç»Ÿã€‚ä»–ä»¬å¸Œæœ›æ‰¾åˆ°ä¸€ä¸ªè´§å¸ç³»ç»Ÿ $(m,b)$ï¼Œæ»¡è¶³ $(m,b)$ ä¸åŸæ¥çš„è´§å¸ç³»ç»Ÿ $(n,a)$ ç­‰ä»·ï¼Œä¸” $m$ å°½å¯èƒ½çš„å°ã€‚ä»–ä»¬å¸Œæœ›ä½ æ¥ååŠ©å®Œæˆè¿™ä¸ªè‰°å·¨çš„ä»»åŠ¡ï¼šæ‰¾åˆ°æœ€å°çš„ $m$ã€‚\né¢˜è§£ å¼€å§‹è¿˜å¾€æ•°è®ºçš„æ–¹é¢è€ƒè™‘äº†ä¸€æ³¢ï¼Œç”šè‡³æƒ³åˆ°åˆšå­¦çš„çº¿æ€§åŸºï¼Œäº‹å®ä¸Šå¹¶æ²¡æœ‰ä»€ä¹ˆåµç”¨\u0026hellip;\u0026hellip;æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªè´ªå¿ƒ+ç±»ä¼¼èƒŒåŒ…dpçš„ä¸œè¥¿å§ã€‚\né¦–å…ˆè€ƒè™‘ä¸€äº›æ€§è´¨ã€‚\né¦–å…ˆå‘ç°ä¸å¯èƒ½å‡ºç°åœ¨è¿™ $n$ ä¸ªè´§å¸é¢é¢ä¹‹å¤–é¢é¢çš„è´§å¸ï¼Œå…¶æ¬¡å‘ç°æœ€å°çš„è´§å¸å¿…ç„¶è¦å–åˆ°ï¼Œç„¶åæˆ‘ä»¬è€ƒè™‘åˆ°ï¼Œå–ä¸€ä¸ªæ›´å°çš„è´§å¸ä¸€å®šå¯¹äºä½ å‡‘å‡ºä¸€ä¸ªå¤§çš„é¢å€¼æ›´æœ‰å¸®åŠ©ï¼Œæ‰€ä»¥æˆ‘ä»¬ä»å°å¾€å¤§çš„è´ªå¿ƒã€‚\nç»´æŠ¤ä¸€ä¸ªæ•°ç»„ $vis[i]$ï¼Œè¡¨ç¤º $i$ é¢å€¼èƒ½ä¸èƒ½è¢«ä¹‹å‰çš„è´§å¸å‡‘å‡ºæ¥ã€‚é¦–å…ˆåˆ¤æ–­æ–°åŠ å…¥çš„æ•°èƒ½ä¸èƒ½ç”¨å·²ç»æœ‰çš„é¢é¢å‡‘å‡ºï¼Œå¦‚æœèƒ½å°±å¯ä»¥è·³è¿‡è¿™ä¸ªé¢å€¼ï¼Œå¦åˆ™å°±å¿…é¡»åŠ å…¥æ–°çš„æœ€å°è´§å¸ç³»ç»Ÿã€‚\næˆ‘ä»¬å¦‚ä½•æ›´æ–° $vis$ æ•°ç»„å‘¢ï¼Ÿç¨æœ‰èƒŒåŒ…dpç»éªŒï¼ˆæˆ–è€…æ»¡è„‘å­èƒŒåŒ…çš„äººï¼‰å°±ä¼šé€šè¿‡ç‰©å“æ— é™è”æƒ³åˆ°å®Œå…¨èƒŒåŒ…ã€‚\næ‰«ææ•°ç»„ç”¨ä½ä½æ›´æ–°é«˜ä½å³å¯ã€‚\næ—¶é—´å¤æ‚åº¦$O(T \\times n \\cdot \\text{MAXV})$ã€‚\næ­¤æ—¶åˆšåˆš 9:05 ã€‚\næœŸæœ›å¾—åˆ†ï¼š100ï¼Œå®é™…å¾—åˆ†ï¼š100\nT3ï¼šèµ›é“ä¿®å»º ä¹Ÿè¿˜ç®—ä¸€é“å¥½é¢˜å§ï¼Œåªä¸è¿‡ä½ç½®éå¸¸å°´å°¬\u0026hellip;(æ¥è‡ªä¸€ä¸ªå‡ ä¹æƒ³å¯¹ç®—æ³•ç„¶åæŒ‚æ‰çš„é€‰æ‰‹çš„æ€¨å¿µ)\né¢˜æ„ C åŸå°†è¦ä¸¾åŠä¸€ç³»åˆ—çš„èµ›è½¦æ¯”èµ›ã€‚åœ¨æ¯”èµ›å‰ï¼Œéœ€è¦åœ¨åŸå†…ä¿®å»º $m$ æ¡èµ›é“ã€‚\nC åŸä¸€å…±æœ‰ $n$ ä¸ªè·¯å£ï¼Œè¿™äº›è·¯å£ç¼–å·ä¸º $1,2,â€¦,n$ï¼Œæœ‰ $nâˆ’1$ æ¡é€‚åˆäºä¿®å»ºèµ›é“çš„åŒå‘é€šè¡Œçš„é“è·¯ï¼Œæ¯æ¡é“è·¯è¿æ¥ç€ä¸¤ä¸ªè·¯å£ã€‚å…¶ä¸­ï¼Œç¬¬ $i$ æ¡é“è·¯è¿æ¥çš„ä¸¤ä¸ªè·¯å£ç¼–å·ä¸º $a_i$ å’Œ $b_i$â€‹ï¼Œè¯¥é“è·¯çš„é•¿åº¦ä¸º $l_i$ã€‚å€ŸåŠ©è¿™ $n-1$ æ¡é“è·¯ï¼Œä»ä»»ä½•ä¸€ä¸ªè·¯å£å‡ºå‘éƒ½èƒ½åˆ°è¾¾å…¶ä»–æ‰€æœ‰çš„è·¯å£ã€‚\nä¸€æ¡èµ›é“æ˜¯ä¸€ç»„äº’ä¸ç›¸åŒçš„é“è·¯ $e_1,e_2,â€¦,e_k$â€‹ï¼Œæ»¡è¶³å¯ä»¥ä»æŸä¸ªè·¯å£å‡ºå‘ï¼Œä¾æ¬¡ç»è¿‡ é“è·¯ $e_1,e_2,â€¦,e_k$â€‹ï¼ˆæ¯æ¡é“è·¯ç»è¿‡ä¸€æ¬¡ï¼Œä¸å…è®¸è°ƒå¤´ï¼‰åˆ°è¾¾å¦ä¸€ä¸ªè·¯å£ã€‚ä¸€æ¡èµ›é“çš„é•¿åº¦ç­‰äºç»è¿‡çš„å„é“è·¯çš„é•¿åº¦ä¹‹å’Œã€‚ä¸ºä¿è¯å®‰å…¨ï¼Œè¦æ±‚æ¯æ¡é“è·¯è‡³å¤šè¢«ä¸€æ¡èµ›é“ç»è¿‡ã€‚\nç›®å‰èµ›é“ä¿®å»ºçš„æ–¹æ¡ˆå°šæœªç¡®å®šã€‚ä½ çš„ä»»åŠ¡æ˜¯è®¾è®¡ä¸€ç§èµ›é“ä¿®å»ºçš„æ–¹æ¡ˆï¼Œä½¿å¾—ä¿®å»ºçš„ $m$ æ¡èµ›é“ä¸­é•¿åº¦æœ€å°çš„èµ›é“é•¿åº¦æœ€å¤§ï¼ˆå³ $m$ æ¡èµ›é“ä¸­æœ€çŸ­èµ›é“çš„é•¿åº¦å°½å¯èƒ½å¤§ï¼‰\né¢˜è§£ è€ƒåœºä¸Šçš„åšæ³•æœ‰é”…ä»¥è‡³äºå¤§æ ·ä¾‹éƒ½è¿‡ä¸äº†\u0026hellip;ç„¶åä¿¡ä»°randäº¤ä¸Šå»äº†\u0026hellip;å‘ç°æ•°æ®éšæœºçš„è¯å¾ˆéš¾å¡æ‰\u0026hellip;æ‰€ä»¥æˆ‘äº‹å®ä¸Šåº”è¯¥å°‘randå‡ æ¬¡\u0026hellip;æ²¡å‡†è¿˜èƒ½æ··åˆ°95\u0026hellip;\næ­£è§£çš„åšæ³•å¦‚ä¸‹ï¼š\näºŒåˆ†éå¸¸æ˜¾ç„¶ï¼Œç„¶åå°±å˜æˆåˆ¤æ–­ä¸å°äº $x$ çš„ä¸ç›¸äº¤è·¯å¾„æœ‰å¤šå°‘æ¡ã€‚\nå¯¹äºæ¯ä¸€ä¸ªå­æ ‘åˆ†åˆ«è€ƒè™‘çš„è¯ï¼Œå‘ç°æ¯ä¸ªå­æ ‘æœ€å¤šåªæœ‰ä¸€æ¡ä»æ ¹å‡ºå‘çš„è·¯å¾„èƒ½è¢«ç¥–å…ˆèŠ‚ç‚¹ä½¿ç”¨ï¼Œå†åŠ ä¸ŠèŠèŠ±å›¾çš„æš—ç¤ºï¼Œå¤§æ¦‚èƒ½å¤Ÿå¾—åˆ°ä»¥ä¸‹çš„æ€è·¯ï¼Œè´ªå¿ƒçš„ä½¿ä»…åœ¨å­æ ‘é‡Œèƒ½å¤Ÿæ‹¼å‡ºæ¥çš„è·¯å¾„æœ€å¤šçš„æƒ…å†µä¸‹ï¼Œèƒ½å¾€ä¸Šä¼ é€’çš„é“¾çš„é•¿åº¦æœ€å¤§ã€‚\nè¿™ä¸ªå¯ä»¥ç”¨ä¸€ä¸ª pair\u0026lt;int,int\u0026gt; ç»´æŠ¤ã€‚æˆ‘ä»¬æ³¨æ„åˆ°æˆ‘ä»¬åœ¨è€ƒè™‘æ¯ä¸ªå­æ ‘è¿”å›çš„è·¯å¾„æ—¶ï¼Œå¦‚æœ f[v] + len \u0026gt;= TAR ï¼Œé‚£ä¹ˆè¯´æ˜è¿™ä¸ªè·¯å¾„å¯ä»¥è‡ªå·±æˆä¸€æ¡èµ›é“ï¼Œç›´æ¥ç´¯åŠ è´¡çŒ®å³å¯ï¼›å‰©ä¸‹çš„æ‰”åˆ°ä¸€ä¸ªmultiset/vectoré‡Œé¢ï¼Œç°åœ¨æˆ‘ä»¬å°±æœ‰äº†è‹¥å¹²æ¡é•¿åº¦å°äº TAR çš„è·¯å¾„ï¼Œæˆ‘ä»¬è¦ç»„åˆå‡ºæœ€å¤šçš„ä¸å°äº TAR çš„è·¯å¾„ï¼Œè€Œä¸”è¿˜è¦æ±‚å‡ºè¿™ä¸ªæƒ…å†µä¸‹èƒ½è¿”å›çš„æœ€é•¿çš„è¿‡å½“å‰å­æ ‘æ ¹èŠ‚ç‚¹çš„é“¾çš„é•¿åº¦ã€‚\næˆ‘ä»¬æœ‰ä¸¤ç§å¤„ç†æ–¹æ³•ï¼š\nä¸€ç§æ˜¯ multiset å¤„ç†ï¼Œæˆ‘ä»¬ä»çŸ­å¾€é•¿è´ªå¿ƒçš„è€ƒè™‘æ¯æ¡è¾¹ï¼Œlower_bound æŸ¥å‡ºæœ€å°èƒ½ä¸å°äº TAR çš„å¦ä¸€æ¡é“¾ï¼Œç„¶åæŠŠä»–ä»¬ä¿©éƒ½åˆ æ‰ï¼Œè®¡ç®—è´¡çŒ®ã€‚ç›´åˆ°æ‰¾ä¸åˆ°èƒ½åŒ¹é…çš„è¾¹ï¼Œå°±å°† multiset é‡Œé¢çš„æœ€å¤§å€¼ä½œä¸ºè¿”å›æœ€é•¿é“¾çš„ç­”æ¡ˆã€‚ï¼ˆæ­£ç¡®æ€§ä¸æ˜¾ç„¶ï¼Œä½†æ˜¯æˆ‘ä»¬æœºæˆ¿è®¨è®ºæ²¡æœ‰å‰æ‰ï¼Œæ‰€ä»¥å¤§çº¦æ˜¯å¯¹çš„ï¼‰ã€‚\nè¿˜æœ‰ä¸€ç§æ˜¯å†äºŒåˆ†çš„å¤„ç†ã€‚\nå…ˆè€ƒè™‘å¦‚ä½•çº¿æ€§è®¡ç®—å‡ºæœ€å¤šçš„è´¡çŒ®ï¼Œå°±æ˜¯ç”¨åŒæŒ‡é’ˆè´ªå¿ƒå³å¯ï¼Œå›ºå®šçš„æ˜¯å¤§çš„é“¾ã€‚ç„¶åæˆ‘ä»¬äºŒåˆ†å¾€å›çš„è¾¹æ˜¯å“ªæ¡ï¼Œæ˜¾ç„¶æœ‰å•è°ƒæ€§ï¼Œç„¶åæ¯æ¬¡çº¿æ€§è®¡ç®—ä¸‹æ˜¯å¦è´¡çŒ®èƒ½è¾¾åˆ°æœ€å¤§å€¼å°±å¯ä»¥äº†ã€‚\næ—¶é—´å¤æ‚åº¦ï¼š$O(n \\log^2 n)$ã€‚\næœŸæœ›å¾—åˆ†ï¼š $55-80$ï¼Œå®é™…å¾—åˆ†ï¼š50\nDay1æ€»ç»“ åšå®Œå‰ä¸¤é¢˜æç„¶è§‰å¾—è‡ªå·±å˜å¼ºäº†å¥½å¤šå•Šï¼Œè½»æ¾ä¸€å¤©200+\u0026hellip;ç»“æœç¬¬ä¸‰é¢˜æ­»æ´»æ²¡è°ƒå‡ºæ¥ã€‚å›å®¶å†™äº†å†™ï¼Œå‘ç°è€ƒåœºä¸Šé”™è¯¯çš„ç®—æ³•ï¼ˆåˆå†™äº†ä¸€éä»ç„¶æ²¡è¿‡å¤§æ ·ä¾‹\u0026hellip;ï¼‰Luogu/nowcoderè‡ªæµ‹ä¹Ÿèƒ½æ‹¿95\u0026hellip;æˆ‘ä¸ºä»€ä¹ˆè¦rand\u0026hellip;æˆ‘æ˜¯ä¸æ˜¯å‚»å­\u0026hellip;\nDay 2ä¹‹ååˆ·çŸ¥ä¹å‘ç°å‡ºé¢˜äºº immortalCO åˆè¯´æ•°æ®å¾ˆå¼±\u0026hellip;\næš´æ€’\u0026hellip;\næœŸæœ›å¾—åˆ†ï¼š100+100+55~80 = 255~280ï¼Œå®é™…å¾—åˆ†ï¼š100+100+50 = 250\nDay 2 è€ƒè¯•å‰æŸç¥ä»™åœ¨pyqé‡Œé¢è°ƒä¾ƒï¼šDay1 ä¸€æ—¶çˆ½ï¼ŒDay2 ç«è‘¬åœºã€‚\næ„Ÿè§‰åˆè¦è¢«ç¦èµ›ä¸€å¹´äº†ã€‚\nT1ï¼šæ—…è¡Œ é¢˜é¢ å° Y æ˜¯ä¸€ä¸ªçˆ±å¥½æ—…è¡Œçš„ OIerã€‚å¥¹æ¥åˆ° X å›½ï¼Œæ‰“ç®—å°†å„ä¸ªåŸå¸‚éƒ½ç©ä¸€éã€‚\nå°Yäº†è§£åˆ°ï¼Œ X å›½çš„ $n$ ä¸ªåŸå¸‚ä¹‹é—´æœ‰ $m(m \\leq n)$ æ¡åŒå‘é“è·¯ã€‚æ¯æ¡åŒå‘é“è·¯è¿æ¥ä¸¤ä¸ªåŸå¸‚ã€‚ ä¸å­˜åœ¨ä¸¤æ¡è¿æ¥åŒä¸€å¯¹åŸå¸‚çš„é“è·¯ï¼Œä¹Ÿä¸å­˜åœ¨ä¸€æ¡è¿æ¥ä¸€ä¸ªåŸå¸‚å’Œå®ƒæœ¬èº«çš„é“è·¯ã€‚å¹¶ä¸”ï¼Œ ä»ä»»æ„ä¸€ä¸ªåŸå¸‚å‡ºå‘ï¼Œé€šè¿‡è¿™äº›é“è·¯éƒ½å¯ä»¥åˆ°è¾¾ä»»æ„ä¸€ä¸ªå…¶ä»–åŸå¸‚ã€‚å° Y åªèƒ½é€šè¿‡è¿™äº› é“è·¯ä»ä¸€ä¸ªåŸå¸‚å‰å¾€å¦ä¸€ä¸ªåŸå¸‚ã€‚\nå° Y çš„æ—…è¡Œæ–¹æ¡ˆæ˜¯è¿™æ ·çš„ï¼šä»»æ„é€‰å®šä¸€ä¸ªåŸå¸‚ä½œä¸ºèµ·ç‚¹ï¼Œç„¶åä»èµ·ç‚¹å¼€å§‹ï¼Œæ¯æ¬¡å¯ ä»¥é€‰æ‹©ä¸€æ¡ä¸å½“å‰åŸå¸‚ç›¸è¿çš„é“è·¯ï¼Œèµ°å‘ä¸€ä¸ªæ²¡æœ‰å»è¿‡çš„åŸå¸‚ï¼Œæˆ–è€…æ²¿ç€ç¬¬ä¸€æ¬¡è®¿é—®è¯¥ åŸå¸‚æ—¶ç»è¿‡çš„é“è·¯åé€€åˆ°ä¸Šä¸€ä¸ªåŸå¸‚ã€‚å½“å° Y å›åˆ°èµ·ç‚¹æ—¶ï¼Œå¥¹å¯ä»¥é€‰æ‹©ç»“æŸè¿™æ¬¡æ—…è¡Œæˆ– ç»§ç»­æ—…è¡Œã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå° Y è¦æ±‚åœ¨æ—…è¡Œæ–¹æ¡ˆä¸­ï¼Œæ¯ä¸ªåŸå¸‚éƒ½è¢«è®¿é—®åˆ°ã€‚\nä¸ºäº†è®©è‡ªå·±çš„æ—…è¡Œæ›´æœ‰æ„ä¹‰ï¼Œå° Y å†³å®šåœ¨æ¯åˆ°è¾¾ä¸€ä¸ªæ–°çš„åŸå¸‚ï¼ˆåŒ…æ‹¬èµ·ç‚¹ï¼‰æ—¶ï¼Œå°† å®ƒçš„ç¼–å·è®°å½•ä¸‹æ¥ã€‚å¥¹çŸ¥é“è¿™æ ·ä¼šå½¢æˆä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„åºåˆ—ã€‚å¥¹å¸Œæœ›è¿™ä¸ªåºåˆ—çš„å­—å…¸åº æœ€å°ï¼Œä½ èƒ½å¸®å¸®å¥¹å—ï¼Ÿ å¯¹äºä¸¤ä¸ªé•¿åº¦å‡ä¸º $n$ çš„åºåˆ— $A$ å’Œ $B$ï¼Œå½“ä¸”ä»…å½“å­˜åœ¨ä¸€ä¸ªæ­£æ•´æ•° $x$ï¼Œæ»¡è¶³ä»¥ä¸‹æ¡ä»¶æ—¶ï¼Œ æˆ‘ä»¬è¯´åºåˆ— $A$ çš„å­—å…¸åºå°äº $B$ã€‚\n å¯¹äºä»»æ„æ­£æ•´æ•° $1 \\leq i \u0026lt; x$ï¼Œåºåˆ— $A$ çš„ç¬¬ $i$ ä¸ªå…ƒç´  $A_i$ å’Œåºåˆ— $B$ çš„ç¬¬ $i$ ä¸ªå…ƒç´  $B_i$â€‹ ç›¸åŒã€‚ åºåˆ— $A$ çš„ç¬¬ $x$ ä¸ªå…ƒç´ çš„å€¼å°äºåºåˆ— $B$ çš„ç¬¬ $x$ ä¸ªå…ƒç´ çš„å€¼ã€‚  é¢˜è§£ å¼€å§‹æ²¡çœ‹è§ $m \\leq n$ï¼Œæç„¶ä»¥ä¸ºä¸å¯åš\u0026hellip;\nç„¶ååˆæ²¡çœ‹è§ $n \\leq 5000$ï¼Œå†æ¬¡è§‰å¾—ä¸å¯åš\u0026hellip;\næ®è¯´æœ‰çº¿æ€§åšæ³•\u0026hellip;æˆ‘åªæƒ³åˆ°ä¸€ä¸ª $n^2$ åšæ³•\nå‘ç°å° Y äº‹å®ä¸Šå°±æ˜¯åœ¨dfs\u0026hellip;æˆ‘ä»¬ç†Ÿæ‚‰æ ‘ä¸Šçš„é‚£å¥—ç†è®ºï¼Œæˆ‘ä»¬å‘ç°æ ‘ä¸Šçš„è¿™ä¸ªä¸œè¥¿æ˜¯å¾ˆå¥½æ±‚çš„ï¼Œè´ªå¿ƒdfså³å¯\u0026hellip;\nå¸¦ç¯çš„æ ‘ä¹Ÿå¯ä»¥ç”¨ç±»ä¼¼çš„è´ªå¿ƒåšåˆ° $O(n)$ çš„å¤æ‚åº¦ï¼Œåªä¸è¿‡æˆ‘è¿˜ä¸å¤ªä¼š\u0026hellip;\n$O(n^2)$ çš„è¯ï¼Œæšä¸¾æ–­è¾¹ï¼Œdfså³å¯\u0026hellip;æœ€ååˆ¤ä¸‹å…¨éƒ¨åˆ°è¾¾å³å¯ã€‚\næˆ‘ä»¬è¿˜å‘ç°ä¸€ç‚¹ï¼Œè¿™é‡Œéœ€è¦å¯¹è¾¹æ’åºæ¥ä¿è¯å¤æ‚åº¦ï¼Œå¦‚æœæˆ‘ä»¬æ¯æ¬¡éƒ½éå†åœ¨sortå¾ˆæœ‰å¯èƒ½TLE\u0026hellip;æ‰€ä»¥æˆ‘ä»¬åœ¨å¤–é¢é€†åºsortå¥½åå†åŠ è¾¹å³å¯\u0026hellip;\nç„¶åèµ›åè‡ªæµ‹çš„æ˜¯å¦å‘ç°è‡ªå·±å¾ˆæœ‰å¯èƒ½æœ‰ä¸ªåœ°æ–¹å¿˜å¼€ä¸¤å€æ•°ç»„\u0026hellip;æ„Ÿè§‰è‡ªå·±è¦å‡‰\u0026hellip; -= 32 åˆ†\u0026hellip;ä¸è¿‡luoguè‡ªæµ‹ä¸Šé¢éƒ½èƒ½è¿‡æœ€åä¸‰ä¸ªç‚¹ï¼Œä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆ\u0026hellip;\næœŸæœ›åˆ†æ•°ï¼š68-100ï¼ˆä¸‡ä¸€æˆ‘å¼€äº†2å€å‘¢\u0026hellip;ï¼‰ï¼Œå®é™…å¾—åˆ†ï¼š100\nT2ï¼šå¡«æ•°æ¸¸æˆ é¢˜é¢ éº»çƒ¦æ­»äº†ï¼Œä¸å¤åˆ¶äº†ï¼Œé“¾æ¥ï¼šLuogu P5023 å¡«æ•°æ¸¸æˆ\né¢˜è§£ è€ƒåœºä¸Šä¸€çœ‹æ•°æ®èŒƒå›´ï¼šé«˜å•Šï¼Œä¸€çœ‹å°±æ˜¯çŠ¶å‹dp+çŸ©é˜µå¿«é€Ÿå¹‚\u0026hellip;äºæ˜¯æ¨äº†æ¨è½¬ç§»çŸ©é˜µ ç ç ç  * n\u0026hellip;ç„¶åå‘ç° n=3,m=3 éƒ½è¿‡ä¸äº†\u0026hellip;çº ç»“ä¸€ä¸ªå°æ—¶ä¹Ÿæ²¡èƒ½è°ƒå®Œ\u0026hellip;å’•å’•å’•\u0026hellip;æœ€åå†™äº†ä¸€ä¸ªæš´åŠ›æœç´¢å’Œ n = 2 çš„ç‰¹æ®Šæƒ…å†µ\u0026hellip;è€ƒåå¬å„è·¯ç¥ä»™åšæ³•éƒ½ä¸å¤ªä¸€æ ·\u0026hellip;\nç›®å‰å¬åˆ°çš„ä¸€ç§åšæ³•æ˜¯è¿™æ ·çš„\u0026hellip;\né¦–å…ˆä½ å‘ç°ä¸€ä¸ªè§„å¾‹\u0026hellip;å½“ $m \\geq n+2$ æ—¶ï¼Œ $F(n,m) = 3F(n,m-1)$ã€‚\nç„¶åä½ æš´æœå‡ºæ¥ $F(n,n+1)$ çš„ç­”æ¡ˆå³å¯ã€‚ç›´æ¥æš´åŠ›æœç´¢ä¼šTLEï¼Œè€ƒè™‘ä¸€äº›å¾®å°çš„ä¼˜åŒ–ï¼Œæ¯”å¦‚å¯¹è§’çº¿çš„å•è°ƒæ€§ï¼Œæ¯”å¦‚å­çŸ©é˜µçš„å¿…ç„¶åˆæ³•å•¥çš„ã€‚\nå…·ä½“æ²¡å†™å‘¢\u0026hellip;æœ€å¥½çš„æ–¹æ³•è²Œä¼¼æ˜¯æ‰“è¡¨ï¼Ÿç­‰è¿‡å‡ å¤©å†æ¥å¡«ã€‚\nè€ƒåœºä¸Šå¤§æ¦‚åªæœ‰50åˆ†å¯ä»¥æ‹¿åˆ°ã€‚å…¶å®æœºçµç‚¹å¯ä»¥å‘ç° n = 3,m=4å’Œn=3,m=5 çš„è§„å¾‹çš„ï¼Œç„¶åå¤§æ¦‚å¯ä»¥å¤šæ‹¿ $15$ åˆ†..?\nwxhçš„åšæ³•\næœŸæœ›å¾—åˆ†ï¼š50ï¼Œå®é™…å¾—åˆ†ï¼š20ï¼ˆæ¨¡æ•°å¤šæ‰“ä¸€ä¸ª0çš„æ‚²ä¼¤QAQï¼‰\nT3ï¼šä¿å«ç‹å›½ åˆtmä¸€é“æ ‘å½¢dp\u0026hellip;\né¢˜é¢ï¼š Z å›½æœ‰ $n$ åº§åŸå¸‚ï¼Œ$n - 1$ æ¡åŒå‘é“è·¯ï¼Œæ¯æ¡åŒå‘é“è·¯è¿æ¥ä¸¤åº§åŸå¸‚ï¼Œä¸”ä»»æ„ä¸¤åº§åŸå¸‚ éƒ½èƒ½é€šè¿‡è‹¥å¹²æ¡é“è·¯ç›¸äº’åˆ°è¾¾ã€‚\nZ å›½çš„å›½é˜²éƒ¨é•¿å° Z è¦åœ¨åŸå¸‚ä¸­é©»æ‰å†›é˜Ÿã€‚é©»æ‰å†›é˜Ÿéœ€è¦æ»¡è¶³å¦‚ä¸‹å‡ ä¸ªæ¡ä»¶ï¼š\n ä¸€åº§åŸå¸‚å¯ä»¥é©»æ‰ä¸€æ”¯å†›é˜Ÿï¼Œä¹Ÿå¯ä»¥ä¸é©»æ‰å†›é˜Ÿã€‚ ç”±é“è·¯ç›´æ¥è¿æ¥çš„ä¸¤åº§åŸå¸‚ä¸­è‡³å°‘è¦æœ‰ä¸€åº§åŸå¸‚é©»æ‰å†›é˜Ÿã€‚ åœ¨åŸå¸‚é‡Œé©»æ‰å†›é˜Ÿä¼šäº§ç”ŸèŠ±è´¹ï¼Œåœ¨ç¼–å·ä¸ºiçš„åŸå¸‚ä¸­é©»æ‰å†›é˜Ÿçš„èŠ±è´¹æ˜¯ $p_i$ã€‚  å° Z å¾ˆå¿«å°±è§„åˆ’å‡ºäº†ä¸€ç§é©»æ‰å†›é˜Ÿçš„æ–¹æ¡ˆï¼Œä½¿æ€»èŠ±è´¹æœ€å°ã€‚ä½†æ˜¯å›½ç‹åˆç»™å° Z æå‡º äº† $m$ ä¸ªè¦æ±‚ï¼Œæ¯ä¸ªè¦æ±‚è§„å®šäº†å…¶ä¸­ä¸¤åº§åŸå¸‚æ˜¯å¦é©»æ‰å†›é˜Ÿã€‚å° Z éœ€è¦é’ˆå¯¹æ¯ä¸ªè¦æ±‚é€ä¸€ ç»™å‡ºå›ç­”ã€‚å…·ä½“è€Œè¨€ï¼Œå¦‚æœå›½ç‹æå‡ºçš„ç¬¬ $j$ä¸ªè¦æ±‚èƒ½å¤Ÿæ»¡è¶³ä¸Šè¿°é©»æ‰æ¡ä»¶ï¼ˆä¸éœ€è¦è€ƒè™‘ ç¬¬ $j$ ä¸ªè¦æ±‚ä¹‹å¤–çš„å…¶å®ƒè¦æ±‚ï¼‰ï¼Œåˆ™éœ€è¦ç»™å‡ºåœ¨æ­¤è¦æ±‚å‰æä¸‹é©»æ‰å†›é˜Ÿçš„æœ€å°å¼€é”€ã€‚å¦‚æœ å›½ç‹æå‡ºçš„ç¬¬ $j$ä¸ªè¦æ±‚æ— æ³•æ»¡è¶³ï¼Œåˆ™éœ€è¦è¾“å‡º $-1$ ($1 \\leq j \\leq m$)ã€‚ç°åœ¨è¯·ä½ æ¥å¸®åŠ©å° Zã€‚\né¢˜è§£ æ€ä¹ˆè¯´å‘¢ï¼Œæ„Ÿè§‰æ˜¯é“å¥½é¢˜ï¼Œå°±æ˜¯æ”¾åœ¨NOIpçš„ä½ç½®å¹¶ä¸æ˜¯ç‰¹åˆ«åˆé€‚\u0026hellip;è€Œä¸”ç¡®åˆ‡çš„è¯´æ˜¯æ”¾åœ¨è¿™ä¹ˆææ€–çš„ Day 2 å¹¶ä¸æ˜¯å¾ˆåˆé€‚ã€‚\nè¯¥é¢˜è²Œä¼¼ç›®å‰è¿˜æ²¡æœ‰äººèƒ½ç»™æˆ‘å®Œå…¨è®²æ˜ç™½\u0026hellip;æœºæˆ¿å­¦é•¿è®²äº†ä¸€éåŠ¨æ€dpä½†æ˜¯æˆ‘ä¹Ÿæ²¡å¤ªææ‡‚åªå¬æ˜ç™½é“¾ä¸Šçš„æƒ…å†µï¼Œä¹Ÿå°±æ˜¯çº¿æ®µæ ‘ç»´æŠ¤è½¬ç§»çŸ©é˜µï¼ˆä¸€èˆ¬æ¯”è¾ƒå°ï¼‰åšåˆ°å¿«é€Ÿçš„ä¿®æ”¹ã€‚\nå¥½åƒè¿˜å¯ä»¥å€å¢åšï¼Œä¹Ÿå¯ä»¥ç”¨è™šæ ‘çš„æ€æƒ³ã€‚æˆ‘éƒ½ä¸ä¼šï¼Œä»¥åæ…¢æ…¢è¡¥ï¼ˆå’•å’•.jpegï¼‰ã€‚\nå†™äº†ä¸ªæœ€å $O(n^2)$ æš´åŠ›ä¹Ÿä¸çŸ¥é“å¯¹ä¸å¯¹ã€‚\næœŸæœ›å¾—åˆ†ï¼š44ï¼Œå®é™…å¾—åˆ†ï¼š44\nDay2æ€»ç»“ å®Œå…¨æ²¡æœ‰åŒºåˆ†åº¦çš„ä¸€å¤©\u0026hellip;ååæˆ‘è¿˜æŒ‚é¢˜äº†\u0026hellip;å¤ªå¹´è½»äº†å•Š\u0026hellip;è€ƒè¯•ç»“æŸä¸€ä¸ªå°æ—¶å‰å¼€å§‹ä½›ç³»æ£€æŸ¥\u0026hellip;è¿˜æ²¡å‘ç°è‡ªå·±çš„æ•°ç»„å¼€å°\u0026hellip;\nå®åä¸¾æŠ¥T2å’ŒT3æ ·ä¾‹å¤ªå°\u0026hellip;æ„Ÿè§‰å¾ˆè™šå•Šqaq\næœŸæœ›å¾—åˆ†ï¼š68~100 + 50 + 44 = 162~194ï¼Œå®é™…å¾—åˆ†ï¼š100 + 20 + 44 = 164\næ€»ç»“ éš¾åº¦å¤§çº¦æ˜¯ $T1-T2-T4-T3-T5-T6$ é€’å¢å§\u0026hellip;\nè¿™ä¸ª noip å’‹å›äº‹å•Š\u0026hellip;æ„Ÿè§‰åŒºåˆ†åº¦ç®€ç›´è·Ÿ NOI Day2 ä¼¼çš„ï¼Œä¼šçš„å¤§å®¶éƒ½èƒ½æ‰“ï¼Œä¸ä¼šçš„ï¼ˆåŸºæœ¬ä¸Šï¼‰æ²¡äººèƒ½åš\u0026hellip;\næŸç¥ä»™ï¼šâ€œè¿™ä¸å°±æ˜¯æ¯”è°FSTå°‘å—ï¼Ÿâ€\nå¯æˆ‘ååå°±æŒ‚é¢˜äº†å•Š\u0026hellip;\nå†™äº†è¿™ä¹ˆå¤šï¼Œä¼¼ä¹ä¹Ÿæ˜¯æƒ³ä½“ç°ä¸€ä¸‹è‡ªå·±å¯¹äº OI çš„çƒ­çˆ±å§\u0026hellip;å¯æ˜¯å½“æ¯”èµ›å®Œæˆåï¼Œçƒ­æƒ…ä¸€ç‚¹ç‚¹æ¶ˆé€€ï¼Œå†°å†·çš„åˆ†æ•°è®©ä½ ä¸å¾—ä¸ä½œå‡ºä¸¤éš¾çš„é€‰æ‹©ã€‚ææ€•ä¸€åˆ‡éƒ½ä¸é‚£ä¹ˆç®€å•å§ã€‚\nèµ›å‰åå¤æ‹…å¿ƒè‡ªå·±ä¼šå¡åœ¨ç®€å•é¢˜ä¸Šï¼Œæœ€åå‘ç°è¿˜æ˜¯éš¾é¢˜æ”»åšèƒ½åŠ›ä¸è¡Œã€‚èµ›æ—¶å¿ƒæ€ææ€•ä¹Ÿæœ‰äº›è¿‡äºç´§å¼ ï¼Œä¹Ÿæ²¡èƒ½å¤šæ£€æŸ¥å‡ éæ•°ç»„æœ‰æ²¡æœ‰å¼€å°çš„é—®é¢˜\u0026hellip;ä¹Ÿå¯ä»¥è¯´æ˜¯è‡ªå·±åŸ‹è‘¬äº†è‡ªå·±å§ã€‚\nå¦‚æœä¸€åˆ‡éƒ½æŒ‰ç…§æœ€å¥½çš„å®åŠ›å‘æŒ¥ï¼Œæˆ‘æ˜¯æœ‰å¸Œæœ›ä¸Š500çš„ï¼Œå¯ç°åœ¨ä¹Ÿåªèƒ½åœ¨ 400 ä¸‹æŒ£æ‰ã€‚ææ€•ä¹Ÿæ˜¯è‡ªå·±å¤ªå¹´è½»è€ä½œæ­»å§ï¼Œè¿™ç§äº‹æƒ…ä¹Ÿæ€¨ä¸å¾—åˆ«äººï¼Œä½†æ˜¯ç»„é¢˜äººè¿˜æ˜¯å¯ä»¥éª‚çš„\u0026hellip;\nè€ƒè¯•ç»“æŸå‰ç´§å¼ äº†ä¸€ä¼šï¼Œå‘ç°è‡ªå·±æŒ‚é¢˜åç´§å¼ äº†ä¸€ä¼š\u0026hellip;ä¸è¿‡ç°åœ¨ä¹Ÿéƒ½é‡Šç„¶äº†\u0026hellip;è¿™ç®—ä»€ä¹ˆå¤§äº‹å•Šï¼Œçœé€‰AKç…§æ ·Aé˜Ÿç¨³ç¨³çš„2333å†µä¸”æ–‡åŒ–è¯¾ä¹Ÿä¸æ˜¯ä¸Šä¸äº†æ¸…åå•Š233\næœ€åå¤§æ¦‚æœŸæœ›å¾—åˆ†ï¼š255+162 = 417\u0026hellip;è¿™ä¸ªåˆ†æ•°å¥½å°´å°¬å•Š\u0026hellip;ä¼°è®¡çœé€‰ä»€ä¹ˆçš„æ˜¯è¦å‡‰äº†23333ç­‰å‡ºåˆ†äº†å†æ¥updå§\nå¦ï¼ŒCCFæ¢å°‘çˆ·æœºäº†\u0026hellip;è¿™å°±æ˜¯æŠ¥åè´¹+=200çš„ç†ç”±å—233333\nå‡ºåˆ†åupdate è‡ªå·±èœä¹Ÿä¸èƒ½æ€ªåˆ«äººå•Šqaq\nä¸è¿‡æ‰“é”™æ¨¡æ•°50-\u0026gt;20åˆ†\u0026hellip;å¤§æ ·ä¾‹ä¸è¿‡80åˆ†ç¡¬è®©æˆ‘è°ƒæˆ50çš„äº‹æƒ…å˜›\u0026hellip;ä¹Ÿä¸çŸ¥é“è¯¥è¯´ä»€ä¹ˆ\u0026hellip;å¦‚æœIOIèµ›åˆ¶ææ€•ä¸ä¼šæœ‰è¿™äº›å¥‡æ€ªçš„äº‹æƒ…\u0026hellip;ä¸è¿‡ä¹Ÿæ²¡é‚£ä¹ˆå¤šå¦‚æœå•Šqaq\nçœé€‰å¤§çº¦è¿˜è¦ç»§ç»­åˆ’æ°´\u0026hellip;ç°åœ¨è¿˜æ˜¯ååˆ†è¿·èŒ«\u0026hellip;\n","description":"","id":82,"section":"posts","tags":null,"title":"NOIp2018 æ¸¸è®°\u0026é¢˜è§£","uri":"https://blog.chenqiqian.com/posts/trip-noip2018/"},{"content":"ç»™ä½  $N$ é¢—å®çŸ³ï¼Œæ¯é¢—å®çŸ³éƒ½æœ‰é‡é‡ $w_i$ å’Œä»·å€¼ $v_i$ã€‚è¦ä½ ä»è¿™äº›å®çŸ³ä¸­é€‰å–ä¸€äº›å®çŸ³ï¼Œä¿è¯å…¶æ€»é‡é‡ä¸è¶…è¿‡ $W$ ï¼Œä¸”æ€»ä»·å€¼æœ€å¤§ã€‚\nè¯·ä½ è¾“å‡ºæœ€å¤§çš„æ€»ä»·å€¼ã€‚\næ•°æ®èŒƒå›´ï¼š$N \\leq 100;W \\leq 2^{30}$ï¼Œå¹¶ä¸”ä¿è¯æ¯é¢—å®çŸ³çš„é‡é‡ç¬¦åˆ $w_i = a \\cdot 2^b$ï¼ˆ $a \\leq 10;b \\leq 30$ ï¼‰ã€‚\né¢˜è§£ å…ˆæŒ‰ç…§ $w_i = a_i \\cdot 2^{b_i}$ ä¸­ $b_i$ ä¸ºç¬¬ä¸€å…³é”®å­—ï¼Œ $a_i$ ä¸ºç¬¬äºŒå…³é”®å­—å‡ä»å¤§åˆ°å°ç»™ç‰©å“æ’åºã€‚\næˆ‘ä»¬å‘ç°ï¼Œå¦‚æœ $dp$ è¿‡ç¨‹ä¸­è€ƒè™‘å½“å‰ç‰©ä½“çš„é‡é‡æ˜¯ $a_i \\cdot 2^{b_i}$ ï¼Œï¼ˆå› ä¸ºå‰©ä¸‹çš„ç‰©ä½“ä¸å¯èƒ½è¶…è¿‡ $n \\leq 100$ ä¸ªï¼Œæ¯ä¸ªç‰©ä½“çš„é‡é‡åˆä¸è¶…è¿‡ $a_i \\cdot 2^{b_i}$ï¼Œåˆ $a_i \\leq 10$ï¼Œï¼‰é‚£ä¹ˆå‰©ä¸‹æ‰€æœ‰çš„ç‰©å“çš„é‡é‡ä¹‹å’Œä¹Ÿä¸å¯èƒ½è¶…è¿‡ $n \\times a_i \\cdot 2^{b_i} \\leq 1024 \\cdot 2^{b_i}$ ã€‚ï¼ˆå› ä¸ºå‰©ä¸‹çš„ç‰©å“çš„é‡é‡ä¹‹å’Œä¸è¶…è¿‡ $2^{10} \\cdot 2^{b_i}$ï¼Œï¼‰è¿™æ„å‘³ç€å‰©ä½™çš„é‡é‡åªæœ‰åœ¨æ¯” $b_i$ é«˜çš„å‰ $10$ ä¸ªäºŒè¿›åˆ¶ä½ç½®ï¼ˆä¹Ÿå°±æ˜¯ä»£è¡¨ $2^{b_{i+1}},\u0026hellip;,2^{b_{i+10}}$ çš„äºŒè¿›åˆ¶ä½ï¼‰æ˜¯å¯èƒ½æœ‰ç”¨çš„ï¼Œå¦åˆ™å¦‚æœå‰©ä½™é‡é‡åœ¨ï¼ˆæ¯” $b_i$ é«˜çš„ï¼‰ç¬¬ $11$ ä¸ªä½ç½®ï¼ˆæˆ–æ›´é«˜ä½ï¼‰å­˜åœ¨ä¸€ä¸ª $1$ï¼Œï¼ˆä¹Ÿå°±æ˜¯å‰©ä¸‹çš„é‡é‡å¤§äºç­‰äº $2^{11} \\cdot 2^{b_i}$ ï¼Œä¹Ÿå°±å¤§äº $2^{10} \\cdot 2^{b_i}$ ï¼Œä½ å‰©ä¸‹çš„æ‰€æœ‰ç‰©å“çš„é‡é‡ï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™çš„æœ€ä¼˜ç­–ç•¥ä¸€å®šæ˜¯æŠŠå‰©ä¸‹çš„å…¨å–å®Œï¼Œé‡é‡è¿˜å¯ä»¥æœ‰å‰©ä½™ï¼Œï¼ˆè¿™æ ·å¯¹ç­”æ¡ˆçš„è´¡çŒ®è®¡ç®—æ˜¯ $O(1)$ çš„ï¼‰ã€‚\næ­£å¸¸çš„èƒŒåŒ…ä¸­æˆ‘ä»¬çš„çŠ¶æ€æœ‰ä¸¤ä¸ªç»´åº¦ï¼Œå½“å‰è€ƒè™‘çš„ç‰©å“å’Œå‰©ä½™çš„èƒŒåŒ…å®¹ç§¯ã€‚ä½†æ˜¯è¿™é‡Œçš„ $W$ è¿‡äºå¤§ï¼Œä»¥è‡³äºè¿™ç§è¡¨ç¤ºæ–¹æ³•ä¸èƒ½æˆç«‹ã€‚ä½†ä¸Šé¢æåˆ°æˆ‘ä»¬äº‹å®ä¸Šåªéœ€è¦æ¯” $b_i$ é«˜çš„é‚£ $10$ ä¸ªäºŒè¿›åˆ¶ä½çš„çŠ¶å†µï¼Œå¦åˆ™æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥æ›´æ–°æœ€åçš„ç­”æ¡ˆã€‚\næ‰€ä»¥çŠ¶æ€å°±å¯ä»¥è¡¨ç¤ºä¸º $dp[i][s]$ï¼Œè¡¨ç¤ºè€ƒè™‘å®Œå‰ $i$ ä¸ªç‰©å“æ—¶ï¼Œ $s$ ä¸ºè€ƒè™‘åˆ°å½“å‰ç‰©å“æ—¶å‰©ä½™çš„ $W$ åœ¨ $b_i$ å‰ $10$ ä¸ªäºŒè¿›åˆ¶ä½ï¼ˆå‹ç¼©æˆä¸€ä¸ª $1 åˆ° 1024$ çš„åè¿›åˆ¶æ•´æ•°ï¼‰çš„æƒ…å†µã€‚æˆ‘ä»¬æ³¨æ„åˆ°æˆ‘ä»¬è€ƒè™‘åˆ°ç¬¬ $i$ ä¸ªç‰©å“çš„æ—¶å€™ï¼Œå¯¹äºæ‰€æœ‰æ¯” $b_i$ ä½çš„äºŒè¿›åˆ¶ä½æˆ‘ä»¬ä¸å¯èƒ½åœ¨å‰ $i$ ä¸ªç‰©å“ä¸­æ”¹å˜ï¼Œæ‰€ä»¥å‰©ä½™é‡é‡æ¯” $2^{b_i}$ ä½çš„äºŒè¿›åˆ¶ä½äº‹å®ä¸Šå°±æ˜¯ $W$ çš„è¿™äº›äºŒè¿›åˆ¶ä½ï¼Œæˆ‘ä»¬ä¸åœ¨ dp çŠ¶æ€ä¸­æ˜¾æ€§è¡¨ç¤ºç½¢äº†ã€‚\næˆ‘ä»¬è€ƒè™‘è¿™ä¸ªç‰©ä½“å†³ç­–å–æˆ–è€…ä¸å–ï¼Œè½¬ç§»æ˜¯éå¸¸ç®€å•çš„ï¼Œå°±æ˜¯æ™®é€šèƒŒåŒ…çš„è½¬ç§»å°±å¯ä»¥äº†ã€‚\nå½“æˆ‘ä»¬è€ƒè™‘å®Œäº†å½“å‰çš„ç‰©å“ï¼Œè€ƒè™‘ä¸‹ä¸€ä¸ªç‰©å“ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦åšä¸€äº›å˜æ¢ã€‚\nç°åœ¨æˆ‘ä»¬æœ‰ä¸¤ç§æƒ…å†µï¼Œç¬¬ä¸€ç§æ˜¯ $w_{i+1}$ å’Œ $w_i$ çš„äºŒè¿›åˆ¶é $0$ æœ€ä½ä½ç›¸åŒï¼Œé‚£æˆ‘ä»¬å°±ä¸éœ€è¦åšä»€ä¹ˆç‰¹æ®Šçš„å¤„ç†ï¼Œç›´æ¥ç”¨ $w_i$ è½¬ç§»å¾—åˆ°æ•°ç»„å³å¯ã€‚\nç¬¬äºŒç§æƒ…å†µæ˜¯ $w_{i+1}$ çš„æœ€ä½é $0$ äºŒè¿›åˆ¶ä½æ¯” $w_i$ çš„ä½ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éå†æ‰€æœ‰1024ç§çŠ¶æ€ï¼Œå¦‚æœå·¦ç§»åˆ°æœ€ä½ä½ä¹‹åè¿™ä¸ªçŠ¶æ€çš„å‰©ä½™ä»·å€¼å¤§äºç­‰äº $2^{10} \\cdot 2^{b_{w+1}}$ ï¼Œé‚£ä¹ˆç›´æ¥å¤„ç†æ‰è¿™ä¸ªçŠ¶æ€ï¼Œå¦åˆ™å°±åŠ ä¸Š $W$ çš„ä½ä½ä¹‹åè½¬ç§»å³å¯ã€‚\næ—¶é—´å¤æ‚åº¦å¤§çº¦æ˜¯ $O((n+30) \\times 2^{10})$ ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69  #include \u0026lt;algorithm\u0026gt;#include \u0026lt;cstdio\u0026gt;#define inf 0x3f3f3f3f #define maxn 1024 using namespace std; const int MAXN = 1100; int n,W; struct wupin{ int a,b,v; bool operator \u0026lt; (const wupin \u0026amp;x)const{ if(b != x.b) return b \u0026gt; x.b; else return a \u0026gt; x.a; } }w[MAXN]; bool init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;W); if(n == -1 \u0026amp;\u0026amp; W == -1) return 0; for(int i = 1;i\u0026lt;=n;i++){ int weight,val,cnt = 0; scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;weight,\u0026amp;val); while((weight \u0026amp; 1) == 0) weight \u0026gt;\u0026gt;= 1,cnt++; w[i] = (wupin){weight,cnt,val}; } return 1; } void solve(){ sort(w+1,w+n+1); static int sum[MAXN], dp[MAXN],tmp[MAXN];//dp[j] -\u0026gt; dp[i][j]ï¼Œå10ä½çš„çŠ¶å†µ  int noww = 31,ans = 0;; for(int i = 1;i\u0026lt;=n;i++) sum[i] = sum[i-1] + w[i].v; for(int j = 0;j\u0026lt;maxn;j++) dp[j] = -inf; dp[0] = 0; for(int i = 1;i\u0026lt;=n;i++){ while(noww \u0026gt; w[i].b){ for(int j = 0;j\u0026lt;maxn;j++) tmp[j] = -inf; for(int j = 0;j\u0026lt;maxn;j++){ if((j\u0026lt;\u0026lt;1) \u0026gt;= maxn) ans = max(ans,dp[j] + sum[n] - sum[i-1]); else{ int newn = (j\u0026lt;\u0026lt;1) | ((W\u0026gt;\u0026gt;(noww-1))\u0026amp;1); tmp[newn] = max(tmp[newn],dp[j]); } } for(int j = 0;j\u0026lt;maxn;j++) dp[j] = tmp[j]; noww--; } for(int j = 0;j\u0026lt;maxn;j++) tmp[j] = -inf; for(int j = 0;j\u0026lt;maxn;j++){//(111111111)_2  tmp[j] = max(tmp[j],dp[j]); if(j - w[i].a \u0026gt;= 0) tmp[j-w[i].a] = max(tmp[j-w[i].a],dp[j] + w[i].v); } for(int j = 0;j\u0026lt;maxn;j++) dp[j] = tmp[j]; } for(int j = 0;j\u0026lt;maxn;j++) ans = max(ans,dp[j]); printf(\u0026#34;%d\\n\u0026#34;,ans); } signed main(){ while(init()) solve(); return 0; }   ","description":"","id":83,"section":"posts","tags":["åŠ¨æ€è§„åˆ’","èƒŒåŒ…"],"title":"ã€ŒHNOI2007ã€æ¢¦å¹»å²›å®ç -èƒŒåŒ…dp","uri":"https://blog.chenqiqian.com/posts/hnoi2007-diamond/"},{"content":"ä¸€ä¸ªç”±è‡ªç„¶æ•°ç»„æˆçš„æ•°åˆ—æŒ‰ä¸‹å¼å®šä¹‰ï¼š\nå¯¹äº $i \\leq k$ ï¼š$a_i = b_i$\nå¯¹äº $i \u0026gt; k$ : $a_i = c_1a_{i-1} + c_2a_{i-2} + \u0026hellip; + c_ka_{i-k}$\nå…¶ä¸­ $b_j$ å’Œ $c_j$ ï¼ˆ $1 \\leq j \\leq k$ï¼‰æ˜¯ç»™å®šçš„è‡ªç„¶æ•°ã€‚å†™ä¸€ä¸ªç¨‹åºï¼Œç»™å®šè‡ªç„¶æ•° $m \\leq n$, è®¡ç®— $a_m + a_{m+1} + a_{m+2} + \u0026hellip; + a_n$, å¹¶è¾“å‡ºå®ƒé™¤ä»¥ç»™å®šè‡ªç„¶æ•° $p$ çš„ä½™æ•°çš„å€¼ã€‚\nå¯¹äº 100% çš„æµ‹è¯•æ•°æ®ï¼š\n$1 \\leq k \\leq 15,1 \\leq m \\leq n \\leq 10^{18},0 \\le b_1, b_2,\u0026hellip; b_k, c_1, c_2,\u0026hellip;, c_k \\leq 10^9,1 \\leq p \\leq 10^8$\né“¾æ¥ Luogu P2461\né¢˜è§£ $$\na_i = \\sum {j=1}^{k} c_k a{j-k}\n$$\næ„é€ ä¸€ä¸ªçŸ©é˜µ\n$$\nM_i\n=\\begin{bmatrix}\nS_i \\\na_i \\\na_{i-1}\\\n\\vdots\\\na_{i-k+2}\\\na_{i-k+1}\\\n\\end{bmatrix}\n$$\nè½¬ç§»çŸ©é˜µä¸ºï¼š\n$$\nZ\n=\\begin{bmatrix}\n1 \u0026amp; c_{1} \u0026amp; c_{2} \u0026amp; \\cdots \u0026amp; c_{k-1} \u0026amp; c_{k} \\\n0 \u0026amp; c_{1} \u0026amp; c_{2} \u0026amp; \\cdots \u0026amp; c_{k-1} \u0026amp; c_{k} \\\n0 \u0026amp; 1 \u0026amp; 0 \u0026amp; \\cdots \u0026amp; 0 \u0026amp; 0\\\n\\vdots \u0026amp; \\vdots \u0026amp; \\vdots \u0026amp; \\ddots \u0026amp; 0 \u0026amp; 0\\\n0 \u0026amp; 0 \u0026amp; 0 \u0026amp; 1 \u0026amp; 0 \u0026amp; 0 \\\n0 \u0026amp; 0 \u0026amp; 0 \u0026amp; 0 \u0026amp; 1 \u0026amp; 0 \\\n\\end{bmatrix}\n$$\nåˆå§‹çš„çŸ©é˜µä¸º\n$$\nC\n=\\begin{bmatrix}\nS_k\\\nb_k \\\nb_{k-1}\\\n\\vdots\\\nb_{2}\\\nb_{1} \\\n\\end{bmatrix}\n$$\n$$\nZ \\times C = M_{k+1}\\\nZ \\times M_i = M_{i+1}\\\n$$\næˆ‘ä»¬æœ‰\n$$\nZ^{n-k} \\times C = M_{n}\n$$\nçŸ©é˜µå¿«é€Ÿå¹‚å³å¯ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cstring\u0026gt;#include \u0026lt;cstdlib\u0026gt;#include \u0026lt;algorithm\u0026gt;#define ll long long using namespace std; const int MAXN = 20; ll N,M,K,P,S; ll b[MAXN],c[MAXN]; struct Matrix{ ll num[MAXN][MAXN]; Matrix(int op = 0){ memset(num,0,sizeof(num)); if(op){for(int i = 1;i\u0026lt;MAXN;i++) num[i][i] = 1;} } ll* operator [] (const int n){ return num[n]; } }; Matrix mul(Matrix \u0026amp;_x,Matrix \u0026amp;_y){ Matrix ans; for(int i = 1;i\u0026lt;=S;i++){ for(int j = 1;j\u0026lt;=S;j++){ for(int k = 1;k\u0026lt;=S;k++){ ans[i][j] += _x[i][k] * _y[k][j]; } ans[i][j] %= P; } } return ans; } Matrix pow(Matrix x,ll k){ Matrix ans(1); for(ll i = k;i;i\u0026gt;\u0026gt;=1,x = mul(x,x)){ if(i \u0026amp; 1) ans = mul(ans,x); } return ans; } Matrix Z,C; void init(){ scanf(\u0026#34;%lld\u0026#34;,\u0026amp;K); S = K+1; for(int i = 1;i\u0026lt;=K;i++) scanf(\u0026#34;%lld\u0026#34;,\u0026amp;b[i]); for(int i = 1;i\u0026lt;=K;i++) scanf(\u0026#34;%lld\u0026#34;,\u0026amp;c[i]); scanf(\u0026#34;%lld %lld %lld\u0026#34;,\u0026amp;M,\u0026amp;N,\u0026amp;P); for(int i = 1;i\u0026lt;=K;i++) b[i] %= P,c[i] %= P; } ll query(ll x){ ll ans = 0; if(x \u0026lt;= K){ for(int i = 1;i\u0026lt;=x;i++) ans += b[i]; } else{ Matrix a = pow(Z,x-K); for(int i = 1;i\u0026lt;=S;i++) ans += C[i][1] * a[1][i]; } return ans % P; } void build(){ ll sum = 0; for(int i = 1;i\u0026lt;=K;i++){ C[S-i+1][1] = b[i]; sum += b[i]; } C[1][1] = sum % P; Z[1][1] = 1; for(int i = 1;i\u0026lt;=K;i++){ Z[1][i+1] = c[i]; Z[2][i+1] = c[i]; } for(int i = 2;i\u0026lt;=K;i++){ Z[i+1][i] = 1; } } int main(){ init(); build(); printf(\u0026#34;%lld\\n\u0026#34;,((query(N)-query(M-1))%P+P)%P); return 0; }   ","description":"","id":84,"section":"posts","tags":["çŸ©é˜µå¿«é€Ÿå¹‚","æ•°å­¦"],"title":"ã€ŒSDOI2008ã€é€’å½’æ•°åˆ—-çŸ©é˜µå¿«é€Ÿå¹‚","uri":"https://blog.chenqiqian.com/posts/sdoi2008-sequence/"},{"content":"åœ¨2016å¹´ï¼Œä½³åª›å§å§åˆšåˆšå­¦ä¹ äº†æ ‘ï¼Œéå¸¸å¼€å¿ƒã€‚ç°åœ¨ä»–æƒ³è§£å†³è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼šç»™å®šä¸€é¢—æœ‰æ ¹æ ‘ï¼ˆæ ¹ä¸º $1$ï¼‰ï¼Œæœ‰ä»¥ä¸‹ä¸¤ç§æ“ä½œï¼š\n  æ ‡è®°æ“ä½œï¼šå¯¹æŸä¸ªç»“ç‚¹æ‰“ä¸Šæ ‡è®°ï¼ˆåœ¨æœ€å¼€å§‹ï¼Œåªæœ‰ç»“ç‚¹1æœ‰æ ‡è®°ï¼Œå…¶ä»–ç»“ç‚¹å‡æ— æ ‡è®°ï¼Œè€Œä¸”å¯¹äºæŸä¸ªç»“ç‚¹ï¼Œå¯ä»¥æ‰“å¤šæ¬¡æ ‡è®°ã€‚ï¼‰\n  è¯¢é—®æ“ä½œï¼šè¯¢é—®æŸä¸ªç»“ç‚¹æœ€è¿‘çš„ä¸€ä¸ªæ‰“äº†æ ‡è®°çš„ç¥–å…ˆï¼ˆè¿™ä¸ªç»“ç‚¹æœ¬èº«ä¹Ÿç®—è‡ªå·±çš„ç¥–å…ˆï¼‰\n  ä½ èƒ½å¸®å¸®å¥¹å—?\né“¾æ¥ Luogu P4092\né¢˜è§£ æˆ‘ä»¬æŒ‰ç…§ dfs åºç»´æŠ¤ä¸€æ£µæ ‡è®°æ°¸ä¹…åŒ–çš„çº¿æ®µæ ‘ã€‚\næ¯æ¬¡æŸ¥è¯¢ç›´æ¥æŸ¥è¯¢è¯¥ä½ç½®ä¸Šæ‰€æœ‰æ ‡è®°çš„æœ€å¤§å€¼å³å¯ï¼Œä¿®æ”¹ç›´æ¥åœ¨çº¿æ®µæ ‘ä¸Šæ‰“ä¸Š $\\log n$ ä¸ªæ ‡è®°ï¼Œæ›´æ–°æ ‡è®°å– $\\max$ å³å¯ã€‚\næ—¶é—´å¤æ‚åº¦ $O(n \\log n)$ ã€‚\nè¿™ä¸ªé¢˜ä¹Ÿå¯ä»¥è€ƒè™‘ç¦»çº¿é€†åºå¤„ç†å³ä¸ºåˆ é™¤æ ‡è®°ï¼Œç”¨å¹¶æŸ¥é›†ç»´æŠ¤èƒ½åˆ°è¾¾çš„æœ€ä¸Šæ–¹ï¼ˆæ²¡æœ‰æ ‡è®°ï¼‰çš„èŠ‚ç‚¹ï¼Œç„¶ååˆ é™¤æ ‡è®°æ˜¯ $\\text{union}$ æ ‡è®°ä¸¤ä¾§é›†åˆå³å¯ï¼Œç»´æŠ¤ä¸€ä¸ªå½“å‰é›†åˆçš„æœ€å°å€¼ã€‚\næ—¶é—´å¤æ‚åº¦ $O(n \\alpha(n))$ ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96  #include \u0026lt;bits/stdc++.h\u0026gt;using namespace std; const int MAXN = 110000; struct Edge{ int to,nex; }edge[MAXN*2];int ecnt = 2; int fir[MAXN]; void addedge(int a,int b){ edge[ecnt] = (Edge){b,fir[a]}; fir[a] = ecnt++; } int n,q,id[MAXN],siz[MAXN],cnt; int back[MAXN]; namespace SegTree{ #define lson (nown\u0026lt;\u0026lt;1)  #define rson (nown\u0026lt;\u0026lt;1|1)  #define mid ((l+r)\u0026gt;\u0026gt;1)  int maxn[MAXN\u0026lt;\u0026lt;2]; void build(int nown,int l,int r){ maxn[nown] = 1; if(l == r) return; build(lson,l,mid); build(rson,mid+1,r); } void modify(int nown,int l,int r,int ql,int qr,int v){ if(ql \u0026lt;= l \u0026amp;\u0026amp; r \u0026lt;= qr){ maxn[nown] = max(maxn[nown],v); } else{ if(ql \u0026lt;= mid) modify(lson,l,mid,ql,qr,v); if(qr \u0026gt;= mid+1) modify(rson,mid+1,r,ql,qr,v); } } int query(int nown,int l,int r,int pos){ if(l == r){ return maxn[nown]; } else{ if(pos \u0026lt;= mid) return max(maxn[nown],query(lson,l,mid,pos)); if(pos \u0026gt;= mid+1) return max(maxn[nown],query(rson,mid+1,r,pos)); } return 1; } } void dfs(int nown,int fa){ id[nown] = ++cnt; back[cnt] = nown; siz[nown] = 1; for(int nowe = fir[nown];nowe;nowe = edge[nowe].nex){ int v = edge[nowe].to; if(v == fa) continue; dfs(v,nown); siz[nown] += siz[v]; } } void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;q); for(int i = 2;i\u0026lt;=n;i++){ int a,b; scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;a,\u0026amp;b); addedge(a,b),addedge(b,a); } } void solve(){ dfs(1,0); SegTree::build(1,1,n); for(int i = 1;i\u0026lt;=q;i++){ char s[5];int x; scanf(\u0026#34;%s %d\u0026#34;,s,\u0026amp;x); if(s[0] == \u0026#39;C\u0026#39;){ SegTree::modify(1,1,n,id[x],id[x]+siz[x]-1,id[x]); } if(s[0] == \u0026#39;Q\u0026#39;){ int t = SegTree::query(1,1,n,id[x]); printf(\u0026#34;%d\\n\u0026#34;,back[t]); } } } int main(){ init(); solve(); return 0; }   ","description":"","id":85,"section":"posts","tags":["çº¿æ®µæ ‘","æ ‘å½¢ç»“æ„"],"title":"ã€ŒHEOI2016/TJOI2016ã€æ ‘-çº¿æ®µæ ‘","uri":"https://blog.chenqiqian.com/posts/heoi2016-tjoi2016-tree/"},{"content":"Alice å’Œ Bob ç°åœ¨è¦ä¹˜é£æœºæ—…è¡Œï¼Œä»–ä»¬é€‰æ‹©äº†ä¸€å®¶ç›¸å¯¹ä¾¿å®œçš„èˆªç©ºå…¬å¸ã€‚è¯¥èˆªç©ºå…¬å¸ä¸€å…±åœ¨ $n$ ä¸ªåŸå¸‚è®¾æœ‰ä¸šåŠ¡ï¼Œè®¾è¿™äº›åŸå¸‚åˆ†åˆ«æ ‡è®°ä¸º $0$ åˆ° $n-1$ï¼Œä¸€å…±æœ‰ $m$ ç§èˆªçº¿ï¼Œæ¯ç§èˆªçº¿è¿æ¥ä¸¤ä¸ªåŸå¸‚ï¼Œå¹¶ä¸”èˆªçº¿æœ‰ä¸€å®šçš„ä»·æ ¼ã€‚\nAliceå’ŒBobç°åœ¨è¦ä»ä¸€ä¸ªåŸå¸‚æ²¿ç€èˆªçº¿åˆ°è¾¾å¦ä¸€ä¸ªåŸå¸‚ï¼Œé€”ä¸­å¯ä»¥è¿›è¡Œè½¬æœºã€‚èˆªç©ºå…¬å¸å¯¹ä»–ä»¬è¿™æ¬¡æ—…è¡Œä¹Ÿæ¨å‡ºä¼˜æƒ ï¼Œä»–ä»¬å¯ä»¥å…è´¹åœ¨æœ€å¤š $k$ ç§èˆªçº¿ä¸Šæ­ä¹˜é£æœºã€‚é‚£ä¹ˆAliceå’ŒBobè¿™æ¬¡å‡ºè¡Œæœ€å°‘èŠ±è´¹å¤šå°‘ï¼Ÿ\né“¾æ¥ Luogu P4568\né¢˜è§£ å»ºå‡º $k+1$ å±‚å›¾ï¼Œ$i$ å±‚å¾€ $i+1$ å±‚åœ¨åŸå›¾è¾¹ä¸Šçš„ä½ç½®åŠ è¾¹æƒä¸º $0$ çš„è¾¹ï¼Œå…¶ä½™æ¯å±‚æ­£å¸¸åŠ è¾¹ï¼Œç¬¬ä¸€å±‚çš„ $s$ å‘ $k+1$ å±‚çš„ $t$ è·‘æœ€çŸ­è·¯å³å¯ã€‚\næ•°ç»„è¦å¼€å¤Ÿemmm\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81  #include \u0026lt;bits/stdc++.h\u0026gt;using namespace std; const int MAXN = 510000,MAXM = 4010000; struct Edge{ int to,len,nex; }edge[MAXM];int ecnt = 2; int fir[MAXN]; void addedge(int a,int b,int c){ edge[ecnt] = (Edge){b,c,fir[a]}; fir[a] = ecnt++; } int n,m,k,s,t; int _hash(int nown,int c){ return (c-1) * n + nown; } void init(){ scanf(\u0026#34;%d %d %d %d %d\u0026#34;,\u0026amp;n,\u0026amp;m,\u0026amp;k,\u0026amp;s,\u0026amp;t); s++,t++; for(int i = 1;i\u0026lt;=m;i++){ int a,b,c; scanf(\u0026#34;%d %d %d\u0026#34;,\u0026amp;a,\u0026amp;b,\u0026amp;c); a++,b++; for(int w = 1;w\u0026lt;=k+1;w++){ addedge(_hash(a,w),_hash(b,w),c); addedge(_hash(b,w),_hash(a,w),c); if(w != k+1){ addedge(_hash(a,w),_hash(b,w+1),0); addedge(_hash(b,w),_hash(a,w+1),0); } } } } int dis[MAXN],vis[MAXN]; struct Node{ int x,d;\tbool operator \u0026lt; (const Node \u0026amp;_n)const{ return d \u0026gt; _n.d; } }; priority_queue\u0026lt;Node\u0026gt; q; void dij(){ while(!q.empty()) q.pop(); memset(dis,0x3f,sizeof(dis)); memset(vis,0,sizeof(vis)); int ss = _hash(s,1),tt = _hash(t,k+1); dis[ss] = 0; q.push((Node){ss,0}); while(!q.empty()){ Node now = q.top();q.pop(); int nown = now.x,nowd = now.d; if(vis[nown] == 1) continue; vis[nown] = 1,dis[nown] = nowd; for(int nowe = fir[nown];nowe;nowe = edge[nowe].nex){ int v = edge[nowe].to,len = edge[nowe].len; if(nowd + len \u0026lt; dis[v]){ dis[v] = nowd + len; q.push((Node){v,dis[v]}); } } } } void solve(){ dij(); printf(\u0026#34;%d\\n\u0026#34;,dis[_hash(t,k+1)]); } int main(){ init(); solve(); return 0; }   ","description":"","id":86,"section":"posts","tags":["å›¾è®º","æœ€çŸ­è·¯","åˆ†å±‚å›¾"],"title":"ã€ŒJLOI2011ã€é£è¡Œè·¯çº¿-åˆ†å±‚å›¾æœ€çŸ­è·¯","uri":"https://blog.chenqiqian.com/posts/jloi2011-flight/"},{"content":" 2018å¹´10æœˆ25æ—¥ï¼Œå†œå†æˆŠæˆŒå¹´ä¹æœˆåä¸ƒã€‚\n å‰å‡ æ—¥çš„æœˆï¼Œä¼¼ä¹æ ¼å¤–çš„åœ†ã€‚\næœ€è¿‘å‡ ä¹æ¯å¤©æ™šä¸Šéƒ½åœ¨æ“åœºä¸Šè·‘æ­¥ï¼Œç”±è¥¿å‘ä¸œçš„ç›´é“ä¸Šï¼ŒæŠ¬å¤´å°±æ˜¯ä¸€è½®æ˜æœˆã€‚äº®æ™ƒæ™ƒçš„æœˆæ™•ç…§äº®äº†å¤©é™…çš„è–„äº‘ï¼Œä¹Ÿä¸çŸ¥é“æ˜¯æ˜æœˆçš„ç¼˜æ•…ï¼Œè¿˜æ˜¯ç¯å…‰çš„æ±¡æŸ“ï¼ŒåŸå¸‚çš„å¤œç©ºç«Ÿæ˜¾å¾—å¦‚æ­¤çš„äº®ã€‚\nè¦è¯´èµ·ä¸ºä»€ä¹ˆè¦è·‘æ­¥ï¼Œå…¶å®ä¹Ÿå¯ä»¥è¯´æ˜¯å¹´è½»äººçš„ä¸€æ—¶å†²åŠ¨ã€‚åŒå­¦åœ¨ç­é‡Œå¿½æ‚ ç€å¤§å®¶ä¸€èµ·å»è·‘æ­¥ï¼Œä½•ä¹è€Œä¸ä¸ºå‘¢ï¼Ÿä½†å…¶å®æ›´å¤šçš„å¤§çº¦è¿˜æ˜¯çœ‹ä¸­äº†è·‘æ­¥çš„ä¸€äº›ä¼˜ç‚¹ï¼Œä½†ä»”ç»†æƒ³æ¥ï¼Œä¹Ÿä¸èƒ½å®Œå…¨ç®—æ˜¯ä¼˜ç‚¹ã€‚\nè·‘æ­¥å…¶å®æ˜¯ä¸€é¡¹éå¸¸æ— è¶£çš„è¿åŠ¨ã€‚ä½ æ‰€è¦åšçš„å…¨éƒ¨å°±æ˜¯ä¸æ–­çš„æ¨åŠ¨ä½ çš„åŒè…¿ï¼Œåœ¨æ“åœºä¸Šä¸€åœˆä¸€åœˆåˆä¸€åœˆçš„è·‘ç€ï¼Œè„‘å­é‡Œä¸éœ€è¦æƒ³ä»€ä¹ˆï¼Œç”šè‡³å¯ä»¥ç©ºç©ºå¦‚ä¹Ÿï¼Œæ²‰æµ¸åœ¨ç©ºè¡çš„æ“åœºï¼Œèƒ¶çº¢çš„è·‘é“ä¹‹ä¸­ã€‚å¹³æ—¶çš„é‚£äº›çäº‹ã€ä¸å¿«ã€ç†æƒ³å’Œç°å®ï¼Œä»¿ä½›éƒ½åœ¨è¿™ç§çœ‹ä¼¼åŠ±å¿—çš„è·‘æ­¥ä¸­ç¦»æˆ‘è€Œå»äº†ã€‚\nå…¶å®å§ï¼Œæ—¶é—´éš¾å†æ¥ã€‚æ›¾è®°å¾—åˆä¸‰çš„æ—¶å€™ï¼Œæ¥è¿çš„è€ƒè¯•è®©æˆ‘é¢‘é¢‘æƒ³åˆ°æˆ‘çš„å°å­¦æˆ–è€…åˆä¸­ä½å¹´çº§æ—¶å€™çš„ç”Ÿæ´»ã€‚é‚£ä¸ªæ—¶å€™ææ€•ä¹Ÿä¸ä¼šæƒ³åˆ°ï¼Œåˆ°äº†é«˜äºŒä»¥åï¼Œå´åè€Œå´ä¼šé¢‘é¢‘æƒ³èµ·åˆä¸‰çš„ç”Ÿæ´»å§ã€‚\nä¹Ÿå°±æ˜¯å‰ä¸¤å¤©ï¼Œè¯­æ–‡è€ƒè¯•ã€‚çªç„¶å°±æ„Ÿè§‰è¿™ç•Œé¢ä¼¼æ›¾ç›¸è¯†ã€‚è¿å¿™è§‚å¯Ÿå››å‘¨ï¼Œè®°å½•ä¸‹æœ€å¤šå¯èƒ½çš„ç»†èŠ‚ã€‚æ•™å®¤é‡Œå¾ˆå®‰é™ï¼Œç¬”åˆ’è¿‡çº¸é¢çš„åˆ·åˆ·å£°ä»ç„¶åœ¨èƒŒæ™¯å£°éŸ³ä¸­æ¸¸è¡ï¼ŒåŒæ¡Œå·²ç»åšå®Œäº†å·å­ï¼Œæ”¾ä¸‹äº†ç¬”ï¼›è€Œè€å¸ˆæ­£åœ¨è®²å°ä¸Šæ•°ç€å·å­ï¼Œå¥‡å¦™çš„å·å­æ‘©æ“¦çš„å£°éŸ³ä¹Ÿé—´æ­‡çš„å‘å‡ºã€‚\nå½“ä½ çš„ç”Ÿæ´»ä¸­æ‰€åšçš„äº‹æƒ…å¯èƒ½å¸¦æ¥çš„ä»£ä»·ä¸å†ä»¥ä¸€èŠ‚è¯¾ã€ä¸€ä¸ªå·¥ä½œæ—¥ã€ä¸€å‘¨ã€ä¸€ä¸ªå­¦æœŸèƒ½å¤Ÿè¡¡é‡æ—¶ï¼Œå½“ä½ çš„ç”Ÿæ´»ä¸­çš„å‹åŠ›ä¸å†èƒ½ç”¨è·‘å‡ åœˆæ­¥ã€å’Œäººè°ˆè°ˆå¿ƒèƒ½å¤Ÿè§£å†³çš„æ—¶å€™ï¼Œäººææ€•æ‰çœŸæ­£é•¿å¤§ã€‚\nåˆ°ç°åœ¨ï¼Œå’ŒåŒå­¦åœ¨æ“åœºä¸Šæ”¾ç€å¥‡æ€ªçš„æ­Œæ›²ï¼Œä¸ç®¡åˆ«äººçš„çœ¼ç¥å’Œâ€œå§æ§½â€ï¼Œä¸€åœˆåœˆçš„åœ¨æ“åœºä¸Šè·‘æ­¥çš„æƒ…æ™¯è¿˜æ˜¯èƒ½è®°å¾—æ˜æ˜ç™½ç™½ï¼Œé‚£ç§åŒè…¿é…¸ç—›ä½†æ˜¯ç¡çš„æ²‰æ²‰çš„æ»¡è¶³ä¹Ÿéš¾ä»¥å¿˜å´ã€‚\nåªæ˜¯å¦‚æ­¤çš„åœ†æœˆï¼Œææ€•æ˜¯å†éš¾è§åˆ°äº†ã€‚\n","description":"","id":87,"section":"posts","tags":null,"title":"ã€Œéšç¬”ã€æœˆåœ†","uri":"https://blog.chenqiqian.com/posts/essay-moon/"},{"content":"çŒªç‹å›½çš„æ–‡æ˜æºè¿œæµé•¿ï¼Œåšå¤§ç²¾æ·±ã€‚\niPig åœ¨å¤§è‚¥çŒªå­¦æ ¡å›¾ä¹¦é¦†ä¸­æŸ¥é˜…èµ„æ–™ï¼Œå¾—çŸ¥è¿œå¤æ—¶æœŸçŒªæ–‡æ–‡å­—æ€»ä¸ªæ•°ä¸º $N$ ã€‚å½“ç„¶ï¼Œä¸€ç§è¯­è¨€å¦‚æœå­—æ•°å¾ˆå¤šï¼Œå­—å…¸ä¹Ÿç›¸åº”ä¼šå¾ˆå¤§ã€‚å½“æ—¶çš„çŒªç‹å›½å›½ç‹è€ƒè™‘åˆ°å¦‚æœä¿®ä¸€æœ¬å­—å…¸ï¼Œè§„æ¨¡æœ‰å¯èƒ½è¿œè¿œè¶…è¿‡åº·ç†™å­—å…¸ï¼ŒèŠ±è´¹çš„çŒªåŠ›ã€ç‰©åŠ›å°†éš¾ä»¥ä¼°é‡ã€‚æ•…è€ƒè™‘å†ä¸‰æ²¡æœ‰è¿›è¡Œè¿™ä¸€é¡¹åŠ³çŒªä¼¤è´¢ä¹‹ä¸¾ã€‚å½“ç„¶ï¼ŒçŒªç‹å›½çš„æ–‡å­—åæ¥éšç€å†å²å˜è¿é€æ¸è¿›è¡Œäº†ç®€åŒ–ï¼Œå»æ‰äº†ä¸€äº›ä¸å¸¸ç”¨çš„å­—ã€‚\niPig æ‰“ç®—ç ”ç©¶å¤æ—¶æŸä¸ªæœä»£çš„çŒªæ–‡æ–‡å­—ã€‚æ ¹æ®ç›¸å…³æ–‡çŒ®è®°è½½ï¼Œé‚£ä¸ªæœä»£æµä¼ çš„çŒªæ–‡æ–‡å­—æ°å¥½ä¸ºè¿œå¤æ—¶æœŸçš„ $k$ åˆ†ä¹‹ä¸€ï¼Œå…¶ä¸­ $k$ æ˜¯ $N$ çš„ä¸€ä¸ªæ­£çº¦æ•°ï¼ˆå¯ä»¥æ˜¯ $1$ å’Œ $N$ ï¼‰ã€‚ä¸è¿‡å…·ä½“æ˜¯å“ª $k$ åˆ†ä¹‹ä¸€ï¼Œä»¥åŠ $k$ æ˜¯å¤šå°‘ï¼Œç”±äºå†å²è¿‡äºä¹…è¿œï¼Œå·²ç»æ— ä»è€ƒè¯äº†ã€‚\niPigè§‰å¾—åªè¦ç¬¦åˆæ–‡çŒ®ï¼Œæ¯ä¸€ç§èƒ½æ•´é™¤ $N$ çš„ $k$ éƒ½æ˜¯æœ‰å¯èƒ½çš„ã€‚ä»–æ‰“ç®—è€ƒè™‘åˆ°æ‰€æœ‰å¯èƒ½çš„ $k$ ã€‚æ˜¾ç„¶å½“ $k$ ç­‰äºæŸä¸ªå®šå€¼æ—¶ï¼Œè¯¥æœçš„çŒªæ–‡æ–‡å­—ä¸ªæ•°ä¸º $\\frac{N}{k}$ã€‚ç„¶è€Œä» $N$ ä¸ªæ–‡å­—ä¸­ä¿ç•™ä¸‹ $\\frac{N}{k}$ ä¸ªçš„æƒ…å†µä¹Ÿæ˜¯ç›¸å½“å¤šçš„ã€‚iPigé¢„è®¡ï¼Œå¦‚æœæ‰€æœ‰å¯èƒ½çš„ $k$ çš„æ‰€æœ‰æƒ…å†µæ•°åŠ èµ·æ¥ä¸º $P$ çš„è¯ï¼Œé‚£ä¹ˆä»–ç ”ç©¶å¤ä»£æ–‡å­—çš„ä»£ä»·å°†ä¼šæ˜¯ $G$ çš„ $P$ æ¬¡æ–¹ã€‚\nç°åœ¨ä»–æƒ³çŸ¥é“çŒªç‹å›½ç ”ç©¶å¤ä»£æ–‡å­—çš„ä»£ä»·æ˜¯å¤šå°‘ã€‚ç”±äºiPigè§‰å¾—è¿™ä¸ªæ•°å­—å¯èƒ½æ˜¯å¤©æ–‡æ•°å­—ï¼Œæ‰€ä»¥ä½ åªéœ€è¦å‘Šè¯‰ä»–ç­”æ¡ˆé™¤ä»¥999911659çš„ä½™æ•°å°±å¯ä»¥äº†ã€‚\né“¾æ¥ é¢˜è§£ ä¾æ®é¢˜æ„æ¨å‡ºå¼å­\n$$\nt = \\sum_{k|N} C^{k}_{N}\\\nans = G^t\n$$\næˆ‘ä»¬æœ‰æŒ‡æ•°çš„ä¸€ä¸ªæ€§è´¨\n$$\na ^ b \\equiv a ^ {b\\ \\bmod\\ p-1} \\pmod p\n$$\nä¹Ÿå°±æ˜¯æŒ‡æ•°çš„å¾ªç¯èŠ‚æ˜¯ $p-1$ ã€‚\næ‰€ä»¥æˆ‘ä»¬åªéœ€è¦\n$$\nans = G^t = G^{t\\ \\bmod\\ (p-1)} \\pmod p\n$$\næ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ç®—å‡º $t \\bmod p-1$ å³å¯ã€‚\næˆ‘ä»¬æ³¨æ„åˆ° $p-1 = 999911659-1 = 2 \\times 3 \\times 4679 \\times 35617$ ï¼Œåˆ†åˆ« $Lucas$ å† $CRT$ åˆå¹¶å³å¯ã€‚\näº‹å®ä¸Šæˆ‘ä»¬å¯ä»¥åªåšä¸€æ¬¡ $CRT$ ï¼Œå³æˆ‘ä»¬æ¯æ¬¡éƒ½ç®—å‡ºåœ¨æ¨¡æŸæ•°æ„ä¹‰ä¸‹çš„ $t$ ï¼Œæœ€ååˆå¹¶ä¸€æ¬¡å³å¯ã€‚\nè¿˜è¦ç‰¹åˆ¤ $G = P$ çš„æƒ…å†µã€‚\næ—¶é—´å¤æ‚åº¦å¤§çº¦æ˜¯ $O(\\sqrt n \\times \\log n )$ ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cmath\u0026gt;#include \u0026lt;cstdlib\u0026gt;#define ll long long using namespace std; const ll P = 999911659; const int MAXN = 100000; ll pow(ll x,ll k,ll p){ ll ans = 1; for(ll i = k;i;i\u0026gt;\u0026gt;=1,x = x*x%p) if(i \u0026amp; 1) ans = (ans * x) % p; return ans; } ll inv(ll x,ll p){return pow(x,p-2,p);} ll mod[5] = {2,3,4679,35617},pw[MAXN]; void init(ll p){ pw[0] = 1; for(int i = 1;i\u0026lt;p;i++) pw[i]= pw[i-1] * i % p; } ll c(ll n,ll m,ll p){//C_n^m mod mod[num]  if(m \u0026gt; n) return 0; return (pw[n] * inv(pw[m],p) % p) * inv(pw[n-m],p) % p; } ll lucas(ll n,ll m,ll p){ if(!m) return 1; return c(n%p,m%p,p) * lucas(n/p,m/p,p) % p; } ll N,G,ans[5]; ll CRT(){ ll sum = 0; for(int i = 0;i\u0026lt;4;i++){ ll now = (P-1)/mod[i]; sum = sum + ans[i] * now * inv(now,mod[i]); sum %= (P-1); } return sum; } ll solve(){ for(int num = 0;num\u0026lt;4;num++){ ll p = mod[num],q = sqrt(N); init(p); ans[num] = 0; for(int i = 1;i\u0026lt;=q;i++){ if(N % i != 0) continue; ans[num] = ans[num] + lucas(N,i,p); if(i * i == N) continue; ans[num] = ans[num] + lucas(N,N/i,p); ans[num] %= p; } } return CRT(); } int main(){ scanf(\u0026#34;%lld %lld\u0026#34;,\u0026amp;N,\u0026amp;G); if(G == P) printf(\u0026#34;%d\\n\u0026#34;,0); else printf(\u0026#34;%lld\\n\u0026#34;,pow(G,solve(),P)); return 0; }   ","description":"","id":88,"section":"posts","tags":["ä¸­å›½å‰©ä½™å®šç†","Lucaså®šç†","æ•°è®º"],"title":"ã€ŒSDOI2010ã€å¤ä»£çŒªæ–‡-Lucas+CRT","uri":"https://blog.chenqiqian.com/posts/sdoi2010-pig/"},{"content":" å¾ˆå¤šäº‹ï¼Œè™½è¯´ã€Œäººå®šèƒœå¤©ã€ï¼Œä½†å¤©å‘½æ¯•ç«Ÿä¸å¯è¿ã€‚\n å¾ˆçŸ­çš„ä¸€ç¯‡éšç¬”ï¼Œè®°å¿µé€å»ä¹‹æ–¯äººã€‚\nè¯´èµ·æ¥ï¼Œæˆ‘ä¸æ˜¯ä¸€ä¸ªç‰¹åˆ«å®¹æ˜“æ„Ÿä¼¤çš„äººã€‚ä¸€ç›´ä»¥æ¥ï¼Œæˆ‘ä¸€ç›´ä¸èƒ½å˜æ¸…ç”Ÿç¦»ä¸æ­»åˆ«ï¼Œå¤©æ¶¯æµ·è§’çš„ç¦»äººæ„Ÿæƒ…ä¹‹é—´çš„ä¸æ¯«ç‰‡ç¼•å…³ç³»ã€‚\nå…¶å®ä¹Ÿä¸å¥‡æ€ªã€‚å¦‚æœè¿™äº›éƒ½é‚£ä¹ˆè½»æ˜“éƒ½èƒ½å¾—åˆ°ä¸€ä¸ªç»“è®ºçš„è¯ï¼Œå“ªé‡Œä¼šæœ‰å¤ä»Šä¸­å¤–çš„è¯—äººæ­Œè€…ä¸–ä¸–ä»£ä»£åœ¨æ­Œå’ï¼Œå¯»æ±‚è¿™äº›çœ‹èµ·æ¥å¾ˆæ˜æ˜¾çš„é—®é¢˜å‘¢ï¼Ÿ\næˆ‘æƒ³ï¼Œæˆ‘å¯¹äºç”Ÿä¸æ­»çš„è§‚å¿µï¼Œå¤§çº¦æ˜¯åœ¨æˆ‘çš„å°å­¦æ—¶å…‰é‡Œå½¢æˆçš„ã€‚ä¸€ä¸ªäººåªæœ‰æœ‰äº†é—²æƒ…é€¸è‡´ï¼Œææ€•æ‰ä¼šå»å¯»æ€è¿™äº›è™šæ— ç¼¥ç¼ˆçš„ä¸œè¥¿ã€‚ä¸€ä¸ªå°å­©å­èººåœ¨é»‘æ¼†æ¼†ç©ºè¡è¡çš„å±‹å­é‡Œï¼Œå¿ƒé‡Œéƒ½ä¼šæƒ³äº›ä»€ä¹ˆå‘¢ï¼Ÿå¤§å¤šæˆ‘éƒ½ä¸è®°å¾—äº†ã€‚\nä¹Ÿè®¸æ˜¯å°æ—¶çš„æ—¶å…‰å¤ªè¿‡æ‚ é—²ï¼Œä»¥è‡³äºä¸Šåˆä¸­ååˆ°ç°åœ¨å‰å‰ååä¹Ÿ 4 å¹´å¤šäº†ï¼Œå¿™æ¥å¿™å»ä¹‹é—´ï¼Œä¹Ÿæ²¡æœ‰ä»€ä¹ˆæ—¶é—´å†å»æ€è€ƒç”Ÿæ­»è¿™æ ·çš„é—®é¢˜ã€‚ä»¥è‡³äºç°åœ¨ï¼Œç«Ÿç„¶éœ€è¦å†æ·±å¤œæ€è€ƒè¿™æ ·çš„é—®é¢˜è€Œæ¯«æ— å›å¿†ã€‚\nè€Œä¸”ä»”ç»†æƒ³æ¥ï¼Œå°æ—¶åœ¨èº«è¾¹äº²è¿‘çš„äººä¼¼ä¹ä¹Ÿæ²¡æœ‰ä»€ä¹ˆå¤§çš„å˜æ•…ï¼Œä¸€åˆ‡éƒ½é‚£ä¹ˆç¾å¥½ï¼Œå°±åƒç«¥è¯é‡Œè¯´çš„é‚£æ ·ã€Œä»–ä»¬ä»æ­¤è¿‡ä¸Šäº†å¹¸ç¦çš„ç”Ÿæ´»ã€ï¼Œä»¿ä½›æ²¡æœ‰äººä¼šå˜è€ï¼Œä¸€åˆ‡éƒ½å¯ä»¥ç»´æŒåœ¨å°å­¦ä¸‰å››å¹´çº§ï¼Œå†™å®Œä½œä¸šä¹‹åç‰µç€ä¸€åŒå¤§å¤§çš„æ‰‹ï¼Œä¸€èµ·èµ°åœ¨æ–‘é©³çš„ç™½çŸ³æ¿ç –ä¸Šï¼Œæ—¶æ—¶åˆ»åˆ»æƒ³è¦æŒ£è„±é‚£ä¸€åŒå¤§æ‰‹çš„ç®¡è¾–ï¼Œåˆ°è‡ªå·±çš„å¤©åœ°é‡Œå»é©°éª‹ã€‚\næœ‰è®¸å¤šç†Ÿè¯†çš„äººã€å’Œé‚£äº›ä¸æ€ä¹ˆç†Ÿæ‚‰çš„äººï¼›æœ‰ä¸€äº›äººè®©ä½ è®°å¿†çŠ¹æ–°ï¼Œæ›´å¤šäººåˆ™æ˜¯å·²ç»å‡ è¿‘å¿˜å´ï¼›è€Œæ— è®ºè¿™äº›äººæ˜¯è°ã€åœ¨å“ªã€åœ¨åšä»€ä¹ˆï¼Œä»–ä»¬éƒ½åœ¨æ¸æ¸ç¦»æˆ‘è€Œå»äº†ã€‚\näººä¸èƒ½ä¸€ç›´æ´»åœ¨ç«¥è¯é‡Œï¼Œç«¥è¯é‡Œçš„å°ç”·å­©æˆ–è®¸ä¹Ÿåº”è¯¥é•¿å¤§äº†ã€‚\n","description":"","id":89,"section":"posts","tags":null,"title":"ã€Œéšç¬”ã€å¤©å‘½ äººäº‹","uri":"https://blog.chenqiqian.com/posts/essay-r.i.p./"},{"content":"ä¸–ç•Œæ ‘çš„å½¢æ€å¯ä»¥ç”¨ä¸€ä¸ªæ•°å­¦æ¨¡å‹æ¥æè¿°ï¼šä¸–ç•Œæ ‘ä¸­æœ‰ $n$ ä¸ªç§æ—ï¼Œç§æ—çš„ç¼–å·åˆ†åˆ«ä» $1$ åˆ° $n$ï¼Œåˆ†åˆ«ç”Ÿæ´»åœ¨ç¼–å·ä¸º $1$ åˆ° $n$ çš„èšå±…åœ°ä¸Šï¼Œç§æ—çš„ç¼–å·ä¸å…¶èšå±…åœ°çš„ç¼–å·ç›¸åŒã€‚æœ‰çš„èšå±…åœ°ä¹‹é—´æœ‰åŒå‘çš„é“è·¯ç›¸è¿ï¼Œé“è·¯çš„é•¿åº¦ä¸º $1$ã€‚ä¿è¯è¿æ¥çš„æ–¹å¼ä¼šå½¢æˆä¸€æ£µæ ‘ç»“æ„ï¼Œå³æ‰€æœ‰çš„èšå±…åœ°ä¹‹é—´å¯ä»¥äº’ç›¸åˆ°è¾¾ï¼Œå¹¶ä¸”ä¸ä¼šå‡ºç°ç¯ã€‚å®šä¹‰ä¸¤ä¸ªèšå±…åœ°ä¹‹é—´çš„è·ç¦»ä¸ºè¿æ¥ä»–ä»¬çš„é“è·¯çš„é•¿åº¦ï¼›ä¾‹å¦‚ï¼Œè‹¥èšå±…åœ° $a$ å’Œ $b$ ä¹‹é—´æœ‰é“è·¯ï¼Œ$b$ å’Œ $c$ ä¹‹é—´æœ‰é“è·¯ï¼Œå› ä¸ºæ¯æ¡é“è·¯é•¿åº¦ä¸º $1$ è€Œä¸”åˆä¸å¯èƒ½å‡ºç°ç¯ï¼Œæ‰€ä»¥ $a$ ä¸ $c$ ä¹‹é—´çš„è·ç¦»ä¸º $2$ã€‚\nå‡ºäºå¯¹å…¬å¹³çš„è€ƒè™‘ï¼Œç¬¬ $i$ å¹´ï¼Œä¸–ç•Œæ ‘çš„å›½ç‹éœ€è¦æˆæƒ $m_i$ ä¸ªç§æ—çš„èšå±…åœ°ä¸ºä¸´æ—¶è®®äº‹å¤„ã€‚å¯¹äºæŸä¸ªç§æ— $x$ï¼ˆ$x$ ä¸ºç§æ—çš„ç¼–å·ï¼‰ï¼Œå¦‚æœè·ç¦»è¯¥ç§æ—æœ€è¿‘çš„ä¸´æ—¶è®®äº‹å¤„ä¸º $y$ï¼ˆ$y$ ä¸ºè®®äº‹å¤„æ‰€åœ¨èšå±…åœ°çš„ç¼–å·ï¼‰ï¼Œåˆ™ç§æ— $x$ å°†æ¥å— $y$ è®®äº‹å¤„çš„ç®¡è¾–ï¼ˆå¦‚æœæœ‰å¤šä¸ªä¸´æ—¶è®®äº‹å¤„åˆ°è¯¥èšå±…åœ°çš„è·ç¦»ä¸€æ ·ï¼Œåˆ™ $y$ ä¸ºå…¶ä¸­ç¼–å·æœ€å°çš„ä¸´æ—¶è®®äº‹å¤„ï¼‰ã€‚\nç°åœ¨å›½ç‹æƒ³çŸ¥é“ï¼Œåœ¨ $q$ å¹´çš„æ—¶é—´é‡Œï¼Œæ¯ä¸€å¹´å®Œæˆæˆæƒåï¼Œå½“å¹´æ¯ä¸ªä¸´æ—¶è®®äº‹å¤„å°†ä¼šç®¡ç†å¤šå°‘ä¸ªç§æ—ï¼ˆè®®äº‹å¤„æ‰€åœ¨çš„èšå±…åœ°ä¹Ÿå°†æ¥å—è¯¥è®®äº‹å¤„ç®¡ç†ï¼‰ã€‚ ç°åœ¨è¿™ä¸ªä»»åŠ¡äº¤ç»™äº†ä»¥æ™ºæ…§è‘—ç§°çš„çµé•¿ç±»çš„ä½ ï¼šç¨‹åºçŒ¿ã€‚è¯·å¸®å›½ç‹å®Œæˆè¿™ä¸ªä»»åŠ¡å§ã€‚\né“¾æ¥ Luogu P3233\né¢˜è§£ æˆ‘ä»¬å¯ä»¥å¯¹äºæ¯æ¬¡è¯¢é—®å…ˆæ„é€ å‡ºè™šæ ‘ã€‚\nå¯¹äºè™šæ ‘ä¸Šçš„èŠ‚ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ $O(m_i)$ çš„æ—¶é—´æ±‚å‡ºè™šæ ‘ä¸Šçš„æ¯ä¸ªèŠ‚ç‚¹è·ç¦»æœ€è¿‘çš„ç‚¹ã€‚ï¼ˆæ ‘å½¢ dp æ±‚å‡ºæ¯ä¸ªèŠ‚ç‚¹ä¸Šæ–¹å’Œä¸‹æ–¹çš„èŠ‚ç‚¹çš„æœ€è¿‘è·ç¦»ç„¶åå– minï¼‰\nç„¶åæˆ‘ä»¬å¯¹äºæ¯æ¡è¾¹åˆ†ç±»è®¨è®ºï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—å‡ºæ¥æ‰€æœ‰è¿æ¥åˆ°è¿™ä¸ªè™šæ ‘è¾¹ä¸Šçš„ç‚¹çš„ä¸ªæ•°ï¼Œä¹Ÿå°±æ˜¯ $siz[u] - siz[v]$ã€‚å¦‚æœè¿™ä¸ªæ—¶å€™æˆ‘ä»¬çš„ $u,v$ èƒ½å¤Ÿåˆ°è¾¾çš„æœ€è¿‘å…³é”®ç‚¹ç›¸åŒï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±æŠŠè¿åˆ°è¿™ä¸ªè¾¹ä¸Šçš„ç‚¹å…¨éƒ¨éƒ½åˆ’åˆ†ç»™è¿™ä¸ªç›¸åŒçš„å…³é”®ç‚¹ï¼›å¦åˆ™æˆ‘ä»¬æ±‚å‡ºä¸¤ä¸ªç‚¹åˆ°å…³é”®çš„è·ç¦»å·®ï¼Œç„¶åæ‰¾åˆ°åˆ’åˆ†æœ€è¿‘å…³é”®ç‚¹ï¼Œç”¨å€å¢æ‰¾åˆ°è¿™ä¸ªç‚¹ï¼Œç„¶ååˆ’åˆ†å‡ºä¸¤éƒ¨åˆ†åˆ†åˆ«ç´¯åŠ è‡³å¯¹åº”å…³é”®ç‚¹å³å¯ã€‚ï¼ˆçœ‹èµ·æ¥æ²¡å‡ å¥è¯ï¼Œè°ƒèµ·æ¥emmmï¼‰\næ—¶é—´å¤æ‚åº¦å¤§çº¦æ˜¯ $O(n \\log n)$ ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229  #include \u0026lt;bits/stdc++.h\u0026gt;using namespace std; const int MAXN = 310000,logn = 19; struct Graph{ struct Edge{ int to,nex; }edge[MAXN*2];int ecnt; int fir[MAXN]; void addedge(int u,int v){ edge[ecnt] = (Edge){v,fir[u]}; fir[u] = ecnt++; } Edge \u0026amp; operator [](int e){ return edge[e]; } Graph(){ ecnt = 2; } }G1,G2; int n,q,m; struct Node{ int x; }h[MAXN]; int f[MAXN][logn],vis[MAXN],dfn[MAXN],ans[MAXN],siz[MAXN],dep[MAXN],cnt; bool cmp(Node a,Node b){ return dfn[a.x] \u0026lt; dfn[b.x]; } int lca(int x,int y){ if(x == 0 || y == 0) return 0; if(dep[x] \u0026lt; dep[y]) swap(x,y); for(int j = logn-1;j\u0026gt;=0;j--){ if(dep[f[x][j]] \u0026gt;= dep[y]) x = f[x][j]; } if(x == y) return x; for(int j = logn-1;j\u0026gt;=0;j--){ if(f[x][j] != f[y][j]) x = f[x][j],y = f[y][j]; } return f[x][0]; } int find_fa(int x,int t){ int tar = dep[x]-t; for(int j = logn-1;j\u0026gt;=0;--j){ if(dep[f[x][j]] \u0026gt;= tar) x = f[x][j]; } return x; } int dis(int x,int y){ return dep[x] + dep[y] - 2*dep[lca(x,y)]; } void dfs0(int nown,int fa,int depth){ f[nown][0] = fa,dfn[nown] = ++cnt,siz[nown] = 1; dep[nown] = depth; for(int nowe = G1.fir[nown];nowe;nowe = G1[nowe].nex){ int v = G1[nowe].to; if(v == fa) continue; dfs0(v,nown,depth+1); siz[nown] += siz[v]; } } void build(){ dfs0(1,0,1); for(int j = 1;j\u0026lt;=logn-1;j++){ for(int i = 1;i\u0026lt;=n;i++){ f[i][j] = f[f[i][j-1]][j-1]; } } } void build_tree(){ if(vis[1] == 0) h[++m] = (Node){1}; G2.ecnt = 2; sort(h+1,h+m+1,cmp); static int stk[MAXN];int top = 0;//[0,top]  for(int i = 1;i\u0026lt;=m;i++){ int L = lca(h[i].x,stk[top]); if(L == stk[top]){ stk[++top] = h[i].x; } else{ while(top \u0026gt;= 1 \u0026amp;\u0026amp; dep[stk[top-1]] \u0026gt;= dep[L]){ int nown = stk[top-1],v = stk[top]; G2.addedge(nown,v); top--; } if(stk[top] != L){ G2.addedge(L,stk[top]); stk[top] = L; } stk[++top] = h[i].x; } } while(top \u0026gt;= 1){ G2.addedge(stk[top-1],stk[top]); top--; } } int near[MAXN],dist[MAXN]; void dfs1(int nown,int fa){ if(vis[nown] == 1) near[nown] = nown,dist[nown] = 0; else dist[nown] = 0x3f3f3f3f; for(int nowe = G2.fir[nown];nowe;nowe = G2[nowe].nex){ int v = G2[nowe].to; dfs1(v,nown); int d = dist[v] - dep[nown] + dep[v]; if(d \u0026lt; dist[nown] || (d == dist[nown] \u0026amp;\u0026amp; near[v] \u0026lt; near[nown])){ near[nown] = near[v]; dist[nown] = d; } } } void dfs2(int nown,int fa,int nst){ int d = dis(nst,nown); if(nst != -1 \u0026amp;\u0026amp; (d \u0026lt; dist[nown] || (d == dist[nown] \u0026amp;\u0026amp; nst \u0026lt; near[nown]))){ near[nown] = nst; dist[nown] = d; } else{ nst = near[nown]; } for(int nowe = G2.fir[nown];nowe;nowe = G2[nowe].nex){ int v = G2[nowe].to; if(v == fa) continue; dfs2(v,nown,nst); } } int id[MAXN]; void dfs3(int nown,int fa){ int _siz = 0; for(int nowe = G2.fir[nown];nowe;nowe = G2[nowe].nex){ int v = G2[nowe].to,len = dep[v] - dep[nown]; dfs3(v,nown); _siz += siz[find_fa(v,len-1)]; } ans[id[near[nown]]] += siz[nown] - _siz; // ç›´æ¥ä¸å½“å‰èŠ‚ç‚¹ç›¸é‚»çš„å­æ ‘ï¼ˆä¸åœ¨è™šæ ‘è·¯å¾„ä¸Šï¼‰éƒ½å±äºè¯¥èŠ‚ç‚¹  for(int nowe = G2.fir[nown];nowe;nowe = G2[nowe].nex){ int v = G2[nowe].to,len = dep[v] - dep[nown]; int tmp = siz[find_fa(v,len-1)] - siz[v];// æ‰€æœ‰å¯èƒ½è¢«è¿™ä¸¤ä¸ªèŠ‚ç‚¹æŒæ§çš„èŠ‚ç‚¹  if(len == 1) continue; if(near[nown] == near[v]){ ans[id[near[nown]]] += tmp; continue; } else{ int ww = dist[nown] - dist[v] + len;// ç†è®ºä¸Šç¬¬ ww/2 ä¸ªç¥–å…ˆç›¸åŒè·ç¦»  if(ww == 0){ ans[id[near[nown]]] += tmp;continue; } if(ww == 2*len){ ans[id[near[v]]] += tmp; continue; } if((ww \u0026amp; 1) == 0){ int x = find_fa(v,ww/2-1),y = f[x][0]; ans[id[min(near[v],near[nown])]] += siz[y] - siz[x]; tmp -= (siz[y] - siz[x]); } int xx = find_fa(v,(ww-1)/2),tt = siz[xx] - siz[v]; ans[id[near[v]]] += tt,ans[id[near[nown]]] += tmp - tt; } } G2.fir[nown] = 0; } void calc(){ build_tree(); dfs1(1,0); dfs2(1,0,-1); dfs3(1,0); } void init(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n); for(int i = 1;i\u0026lt;=n-1;i++){ int u,v; scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;u,\u0026amp;v); G1.addedge(u,v),G1.addedge(v,u); } } void solve(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;q); for(int i = 1;i\u0026lt;=q;i++){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;m); for(int j = 1;j\u0026lt;=m;j++){ int x; scanf(\u0026#34;%d\u0026#34;,\u0026amp;x); h[j] = (Node){x}; ans[j] = 0,id[x] = j; vis[x] = 1; } int mm = m; calc(); for(int j = 1;j\u0026lt;=mm;j++){ printf(\u0026#34;%d \u0026#34;,ans[j]); vis[h[j].x] = 0; } vis[h[m].x] = 0; printf(\u0026#34;\\n\u0026#34;); } } int main(){ init(); build(); solve(); return 0; }   ","description":"","id":90,"section":"posts","tags":["è™šæ ‘","æ ‘å½¢ç»“æ„","æ ‘å½¢dp"],"title":"ã€ŒHNOI2014ã€ä¸–ç•Œæ ‘-è™šæ ‘+æ ‘å½¢dp","uri":"https://blog.chenqiqian.com/posts/hnoi2014-worldtree/"},{"content":"è‘—åçš„ç”µå­äº§å“å“ç‰Œ SHOI åˆšåˆšå‘å¸ƒäº†å¼•é¢†ä¸–ç•Œæ½®æµçš„ä¸‹ä¸€ä»£ç”µå­äº§å“â€”â€” æ¦‚ç‡å……ç”µå™¨ï¼š\nâ€œé‡‡ç”¨å…¨æ–°çº³ç±³çº§åŠ å·¥æŠ€æœ¯ï¼Œå®ç°å…ƒä»¶ä¸å¯¼çº¿èƒ½å¦é€šç”µå®Œå…¨ç”±çœŸéšæœºæ•°å†³å®šï¼SHOI æ¦‚ç‡å……ç”µå™¨ï¼Œæ‚¨ç”Ÿæ´»ä¸å¯æˆ–ç¼ºçš„å¿…éœ€å“ï¼èƒ½å……ä¸Šç”µå—ï¼Ÿç°åœ¨å°±è¯•è¯•çœ‹å§ï¼â€\nSHOI æ¦‚ç‡å……ç”µå™¨ç”± $n-1$ æ¡å¯¼çº¿è¿é€šäº† $n$ ä¸ªå……ç”µå…ƒä»¶ã€‚è¿›è¡Œå……ç”µæ—¶ï¼Œæ¯æ¡å¯¼ çº¿æ˜¯å¦å¯ä»¥å¯¼ç”µä»¥æ¦‚ç‡å†³å®šï¼Œæ¯ä¸€ä¸ªå……ç”µå…ƒä»¶è‡ªèº«æ˜¯å¦ç›´æ¥è¿›è¡Œå……ç”µä¹Ÿç”±æ¦‚ç‡ å†³å®šã€‚éšåç”µèƒ½å¯ä»¥ä»ç›´æ¥å……ç”µçš„å…ƒä»¶ç»è¿‡é€šç”µçš„å¯¼çº¿ä½¿å¾—å…¶ä»–å……ç”µå…ƒä»¶è¿›è¡Œé—´æ¥å……ç”µã€‚\nä½œä¸º SHOI å…¬å¸çš„å¿ å®å®¢æˆ·ï¼Œä½ æ— æ³•æŠ‘åˆ¶è‡ªå·±è´­ä¹° SHOI äº§å“çš„å†²åŠ¨ã€‚åœ¨æ’ äº†ä¸€ä¸ªæ˜ŸæœŸçš„é•¿é˜Ÿä¹‹åç»ˆäºå…¥æ‰‹äº†æœ€æ–°å‹å·çš„ SHOI æ¦‚ç‡å……ç”µå™¨ã€‚ä½ è¿«ä¸åŠå¾…åœ°å°† SHOI æ¦‚ç‡å……ç”µå™¨æ’å…¥ç”µæºâ€”â€”è¿™æ—¶ä½ çªç„¶æƒ³çŸ¥é“ï¼Œè¿›å…¥å……ç”µçŠ¶æ€çš„å…ƒä»¶ä¸ªæ•°çš„æœŸæœ›æ˜¯å¤šå°‘å‘¢ï¼Ÿ\né“¾æ¥ Luogu P4284\né¢˜è§£ æˆ‘ä»¬æ³¨æ„åˆ°è¿™é“é¢˜å¯ä»¥ç”¨æ ‘å½¢dpçš„æ–¹æ³•æ¥è§£å†³ã€‚\nè®¾ $f[x]$ è¡¨ç¤º $x$ èŠ‚ç‚¹ç”±ä¸è¢«å…¶å­èŠ‚ç‚¹ï¼ˆå«æœ¬èº«ï¼‰ç‚¹äº®çš„æ¦‚ç‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬æœ‰å¦‚ä¸‹è½¬ç§»ï¼š\nå¯¹äºæ¯ä¸ªå­èŠ‚ç‚¹ï¼Œ $f[x]$ åˆ†ä¸ºè¿™å‡ éƒ¨åˆ†ï¼šå­èŠ‚ç‚¹ä¸è¢«ç‚¹äº® æˆ– è¯¥èŠ‚ç‚¹çš„è¾¹ ä¸è¢«ç‚¹äº®ï¼Œç”¨å…¬å¼è¡¨ç¤ºå³ä¸ºï¼š\næˆ‘ä»¬ä»¤ $s(i,j) = i+j-i \\times j$ï¼Œ ä»¤ $w[x] = s(f[v],1-q_{(fa[x],x)})$ï¼Œé‚£ä¹ˆï¼š\n$$\nf[x] = (1-p[x]) \\prod_{\\text{v is x\u0026rsquo;s son}} w[v]\n$$\næˆ‘ä»¬å®šä¹‰è¯¥èŠ‚ç‚¹ä¸è¢«å…¶çˆ¶èŠ‚ç‚¹ç‚¹äº®çš„æ¦‚ç‡ä¸º $g[x]$ã€‚ $g[x]$ å³ä¸º çˆ¶èŠ‚ç‚¹ä¸è¢«å…¶çˆ¶èŠ‚ç‚¹ç‚¹äº® ä¸” çˆ¶èŠ‚ç‚¹ä¸è¢«å…¶ä»–å­èŠ‚ç‚¹ï¼ˆå«æœ¬èº«ï¼‰ç‚¹äº® æˆ– å¯¼çº¿ä¸é€šï¼Œå¯ä»¥å¾—åˆ° $g[x]$ è¡¨è¾¾å¼ä¸ºï¼š\n$$\ng[x] = s(q_{(fa[x],x)} , g[fa[x]] \\times \\frac{f[x]}{w[x]} )\n$$\nï¼ˆæ­¤å¤„è‹¥ $w[x] = 0$ï¼Œåˆ™ç›´æ¥ä»¤ $g[x] = 0$ å³å¯ï¼‰\nç­”æ¡ˆå³ä¸º\n$$\nans[x] = 1 - f[x] \\times g[x]\n$$\næ ‘å½¢ $dp$ å³å¯ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75  #include \u0026lt;cstdio\u0026gt;using namespace std; const int MAXN= 510000; struct Edge{ int to,nex; double q; }edge[MAXN*2];int ecnt = 2; int fir[MAXN]; void addedge(int a,int b,double q){ edge[ecnt] = (Edge){b,fir[a],q}; fir[a] = ecnt++; } int n; double p[MAXN]; double f[MAXN],g[MAXN],w[MAXN]; double s(double i,double j){ return i+j-i*j; } void dfs1(int x,int fa){ f[x] = 1; for(int nowe = fir[x];nowe;nowe = edge[nowe].nex){ int v = edge[nowe].to;double q = edge[nowe].q; if(v == fa) continue; dfs1(v,x); w[v] = s(f[v],1-q); f[x] *= w[v]; } f[x] *= (1-p[x]); } void dfs2(int x,int fa){ for(int nowe = fir[x];nowe;nowe = edge[nowe].nex){ int v = edge[nowe].to;double q = edge[nowe].q; if(v == fa) continue; if(w[v] != 0){ g[v] = s(1-q,g[x] * f[x] / w[v]); } dfs2(v,x); } } void solve(){ g[1] = 1; dfs1(1,0),dfs2(1,0); double ans = 0; for(int i = 1;i\u0026lt;=n;i++){ //printf(\u0026#34;f:%lf g:%lf\\n\u0026#34;,f[i],g[i]);  ans += 1-f[i]*g[i]; } printf(\u0026#34;%.6lf\\n\u0026#34;,ans); } void init(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n); for(int i = 2;i\u0026lt;=n;i++){ int a,b,p; scanf(\u0026#34;%d %d %d\u0026#34;,\u0026amp;a,\u0026amp;b,\u0026amp;p); addedge(a,b,double(p)/100); addedge(b,a,double(p)/100); } for(int i = 1;i\u0026lt;=n;i++){ scanf(\u0026#34;%lf\u0026#34;,\u0026amp;p[i]); p[i]/=100; } } int main(){ init(); solve(); return 0; }   ","description":"","id":91,"section":"posts","tags":["æ ‘å½¢dp","æœŸæœ›","æ ‘å½¢ç»“æ„"],"title":"ã€ŒSHOI2014ã€æ¦‚ç‡å……ç”µå™¨-æ ‘å½¢dp","uri":"https://blog.chenqiqian.com/posts/shoi2014-charger/"},{"content":"L å…¬å¸æœ‰ $N$ ä¸ªå·¥å‚ï¼Œç”±é«˜åˆ°åº•åˆ†å¸ƒåœ¨ä¸€åº§å±±ä¸Šã€‚å·¥å‚ $1$ åœ¨å±±é¡¶ï¼Œå·¥å‚ $N$ åœ¨å±±è„šã€‚\nç”±äºåœ°å½¢çš„ä¸åŒï¼Œåœ¨ä¸åŒå·¥å‚å»ºç«‹ä»“åº“çš„è´¹ç”¨å¯èƒ½æ˜¯ä¸åŒçš„ã€‚ç¬¬ $i$ ä¸ªå·¥å‚ç›®å‰å·²æœ‰æˆå“ $P_i$ ä»¶ï¼Œåœ¨ç¬¬ $i$ ä¸ªå·¥å‚ä½ç½®å»ºç«‹ä»“åº“çš„è´¹ç”¨æ˜¯ $C_i$ ã€‚\nå¯¹äºæ²¡æœ‰å»ºç«‹ä»“åº“çš„å·¥å‚ï¼Œå…¶äº§å“åº”è¢«è¿å¾€å…¶ä»–çš„ä»“åº“è¿›è¡Œå‚¨è—ï¼Œè€Œç”±äº L å…¬å¸äº§å“çš„å¯¹å¤–é”€å”®å¤„è®¾ç½®åœ¨å±±è„šçš„å·¥å‚ $N$ ï¼Œæ•…äº§å“åªèƒ½å¾€å±±ä¸‹è¿ï¼ˆå³åªèƒ½è¿å¾€ç¼–å·æ›´å¤§çš„å·¥å‚çš„ä»“åº“ï¼‰ï¼Œå½“ç„¶è¿é€äº§å“ä¹Ÿæ˜¯éœ€è¦è´¹ç”¨çš„ï¼Œå‡è®¾ä¸€ä»¶äº§å“è¿é€ $1$ ä¸ªå•ä½è·ç¦»çš„è´¹ç”¨æ˜¯ $1$ ã€‚\nå‡è®¾å»ºç«‹çš„ä»“åº“å®¹é‡éƒ½éƒ½æ˜¯è¶³å¤Ÿå¤§çš„ï¼Œå¯ä»¥å®¹ä¸‹æ‰€æœ‰çš„äº§å“ã€‚ä½ å°†å¾—åˆ°ä»¥ä¸‹æ•°æ®ï¼š\n å·¥å‚ $i$ è·ç¦»å·¥å‚ $1$ çš„è·ç¦» $X_i$ï¼ˆå…¶ä¸­ $X_1=0$ ï¼‰; å·¥å‚ $i$ ç›®å‰å·²æœ‰æˆå“æ•°é‡ $P_i$ ; åœ¨å·¥å‚ $i$ å»ºç«‹ä»“åº“çš„è´¹ç”¨ $C_i$ ;  è¯·ä½ å¸®åŠ© L å…¬å¸å¯»æ‰¾ä¸€ä¸ªä»“åº“å»ºè®¾çš„æ–¹æ¡ˆï¼Œä½¿å¾—æ€»çš„è´¹ç”¨ï¼ˆå»ºé€ è´¹ç”¨+è¿è¾“è´¹ç”¨ï¼‰æœ€å°ã€‚\né“¾æ¥ Luogu P2120\né¢˜è§£ æš´åŠ›ææå¼å­ï¼š\n$$\ndp[i] = \\min_{j=0}^{i-1}(dp[j] + c_i +\\sum_{w=j+1}^{i} (x_i - x_w)\\times p_w)\\\ndp[i] = \\min_{j=0}^{i-1}(dp[j] + c_i +\\sum_{w=j+1}^{i} (x_i \\times p_w - x_w \\times p_w) )\\\ndp[i] = \\min_{j=0}^{i-1}(dp[j] +x_i \\sum_{w=j+1}^{i}p_w - \\sum_{w=j+1}^{i} x_w \\times p_w) ) + c_i $$\nä»¤ $a_i = \\sum_{w=1}^{i} p_w$ ï¼Œ $b_i = \\sum_{w=1}^{i} x_w \\times p_w$ï¼ŒåŸå¼åŒ–ä¸º\n$$\ndp[i] = \\min_{j=0}^{i-1}(dp[j] +x_i \\times(a_i-a_j) - (b_i-b_j) ) + c_i\n$$\nå¦‚æœä»¤ $j \u0026lt; k \u0026lt; i$ ï¼Œåˆ™ $k$ æ¯” $j$ ä¼˜ç­‰ä»·äºï¼š\n$$\ndp[j] +x_i \\times(a_i-a_j) - (b_i-b_j) \\geq dp[k] +x_i \\times(a_i-a_k) - (b_i-b_k)\\\ndp[j] - x_i \\times a_j + b_j \\geq dp[k] -x_i \\times a_k + b_k\\\n(dp[j]+b_j) - (dp[k] + b_k) \\geq x_i(a_j-a_k)\n$$\nå› ä¸º $a_j \u0026lt; a_k$ ï¼Œå³ $a_j - a_k \u0026lt; 0$ ï¼Œæ‰€ä»¥æœ‰\n$$\n\\frac{(dp[j]+b_j) - (dp[k] + b_k)}{a_j-a_k} \\leq x_i\n$$\næ³¨æ„åˆ° $x_i$ å•è°ƒé€’å¢ï¼Œå³å¦‚æœåœ¨æŸä¸ªæ—¶åˆ» $k$ æ¯” $j$ ä¼˜ï¼Œåˆ™ä»¥åå…¶ä¼šä¸€ç›´æ›´ä¼˜ï¼Œå•è°ƒé˜Ÿåˆ—ç»´æŠ¤å³å¯ã€‚\nä»£ç  1    ","description":"","id":92,"section":"posts","tags":["åŠ¨æ€è§„åˆ’","æ–œç‡ä¼˜åŒ–"],"title":"ã€ŒZJOI2007ã€ä»“åº“å»ºè®¾-æ–œç‡ä¼˜åŒ–","uri":"https://blog.chenqiqian.com/posts/zjoi2007-warehouse/"},{"content":"å° R çƒ­è¡·äºåšé»‘æš—æ–™ç†ï¼Œå°¤å…¶æ˜¯æ··åˆæœæ±ã€‚\nå•†åº—é‡Œæœ‰ $n$ ç§æœæ±ï¼Œç¼–å·ä¸º $0,1,\\cdots,n-1$ ã€‚$i$ å·æœæ±çš„ç¾å‘³åº¦æ˜¯ $d_i$ ï¼Œæ¯å‡ä»·æ ¼ä¸º $p_i$â€‹ ã€‚å° R åœ¨åˆ¶ä½œæ··åˆæœæ±æ—¶ï¼Œè¿˜æœ‰ä¸€äº›ç‰¹æ®Šçš„è§„å®šï¼Œå³åœ¨ä¸€ç“¶æ··åˆæœæ±ä¸­ï¼Œ$i$ å·æœæ±æœ€å¤šåªèƒ½æ·»åŠ  $l_i$ å‡ã€‚\nç°åœ¨æœ‰ $m$ ä¸ªå°æœ‹å‹è¿‡æ¥æ‰¾å° R è¦æ··åˆæœæ±å–ï¼Œä»–ä»¬éƒ½å¸Œæœ›å° R ç”¨å•†åº—é‡Œçš„æœæ±åˆ¶ä½œæˆä¸€ç“¶æ··åˆæœæ±ã€‚å…¶ä¸­ï¼Œç¬¬ $j$ ä¸ªå°æœ‹å‹å¸Œæœ›ä»–å¾—åˆ°çš„æ··åˆæœæ±æ€»ä»·æ ¼ä¸å¤§äº $g_j$ ï¼Œä½“ç§¯ä¸å°äº $L_j$â€‹ ã€‚åœ¨ä¸Šè¿°è¿™äº›é™åˆ¶æ¡ä»¶ä¸‹ï¼Œå°æœ‹å‹ä»¬è¿˜å¸Œæœ›æ··åˆæœæ±çš„ç¾å‘³åº¦å°½å¯èƒ½åœ°é«˜ï¼Œä¸€ç“¶æ··åˆæœæ±çš„ç¾å‘³åº¦ç­‰äºæ‰€æœ‰å‚ä¸æ··åˆçš„æœæ±çš„ç¾å‘³åº¦çš„æœ€å°å€¼ã€‚è¯·ä½ è®¡ç®—æ¯ä¸ªå°æœ‹å‹èƒ½å–åˆ°çš„æœ€ç¾å‘³çš„æ··åˆæœæ±çš„ç¾å‘³åº¦ã€‚\né“¾æ¥ Luogu P4602\né¢˜è§£ è¿™ä¸ªé¢˜å¯ä»¥æ•´ä½“äºŒåˆ†ã€‚\nå¯¹ $d$ è¿›è¡Œ $\\text{sort}$ åï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ $\\text{multiset}$ ç»´æŠ¤å‰ç¼€çš„æœæ±æŒ‰ç…§ $p$ æ’åºä¹‹åçš„é¡ºåºï¼Œç„¶åæŠŠå½“å‰è¯¢é—®æŒ‰ç…§ $g$ æ’åºï¼Œé€æ­¥åŠ å…¥æ¯ç§æœæ±ï¼Œåˆ¤æ–­æ˜¯å¦å¯ä»¥è¾¾æˆ $l$ çš„ä½“ç§¯ä½œä¸ºäºŒåˆ†ä¾æ®ã€‚\nå‡è£…å¤æ‚åº¦å¤§çº¦æ˜¯ $O(n \\log^2 n)$ã€‚\nåæ­£å¯è¿‡ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127  // Code By Chen Qiqian on 2018.10.16 #include \u0026lt;bits/stdc++.h\u0026gt;#define ll long long using namespace std; const int MAXN = 210000; int n,m; struct Node{ ll d,p,l; bool operator \u0026lt; (const Node \u0026amp;a)const{ if(d != a.d) return d \u0026gt; a.d; else return p \u0026lt; a.p; } }t[MAXN]; bool cmp(const int \u0026amp;a,const int \u0026amp;b){ if(t[a].p != t[b].p) return t[a].p \u0026lt; t[b].p; else return t[a].l \u0026lt; t[b].l; } struct Query{ ll g,l,id; }q[MAXN]; int ans[MAXN]; void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m); for(int i = 1;i\u0026lt;=n;i++){ ll a,b,c; scanf(\u0026#34;%lld %lld %lld\u0026#34;,\u0026amp;a,\u0026amp;b,\u0026amp;c); t[i] = (Node){a,b,c}; } sort(t+1,t+n+1); for(int i = 1;i\u0026lt;=m;i++){ scanf(\u0026#34;%lld %lld\u0026#34;,\u0026amp;q[i].g,\u0026amp;q[i].l); q[i].id = i; } } int a1[MAXN],a2[MAXN]; struct T{ ll p,l; bool operator \u0026lt; (const T \u0026amp;w)const{ if(p != w.p) return p \u0026lt; w.p; else return l \u0026lt; w.l; } }; multiset\u0026lt;T\u0026gt; K; int pos = 0;//[1,pos]  bool cmp2(const int a,const int b){ return q[a].g \u0026lt; q[b].g; } void solve(int *a,int n1,int l,int r){// *a å­˜å‚¨è¯¢é—®ç¼–å· åœ¨ [l,r] æœæ±å†…äºŒåˆ†  if(n1 == 0) return; if(l == r){ for(int i = 0;i\u0026lt;n1;i++) ans[q[a[i]].id] = t[l].d; return; } // å¯»æ‰¾åˆ°æœ€å°çš„éœ€è¦çš„ n  // d æŒ‰ä»å¤§åˆ°å°æ’åº  int mid = (l+r)\u0026gt;\u0026gt;1; //åˆ¤æ–­ 1 -\u0026gt; mid åŒºé—´æ˜¯å¦å¯ä»¥æ»¡è¶³é™åˆ¶ (g_i,l_i)  //ç»´æŠ¤multisetä½¿å…¶å¯ä»¥åŒ…æ‹¬ [1,mid] æ‰€æœ‰æœæ±  while(pos \u0026lt; mid){ pos++; K.insert((T){t[pos].p,t[pos].l}); } while(pos \u0026gt; mid){ K.erase(K.lower_bound((T){t[pos].p,t[pos].l})); pos--; } ll G = 0,L = 0,acnt = 0,bcnt = 0; sort(a,a+n1,cmp2); multiset\u0026lt;T\u0026gt;::iterator it = K.begin(); #define xp it-\u0026gt;p  #define xl it-\u0026gt;l  for(int i = 0;i\u0026lt;n1;i++){ while(it != K.end() \u0026amp;\u0026amp; G + xp * xl \u0026lt;= q[a[i]].g){ G += xp * xl,L += xl; it++; } if(L \u0026gt;= q[a[i]].l || (it != K.end() \u0026amp;\u0026amp; (q[a[i]].l-L) * xp + G \u0026lt;= q[a[i]].g)) a1[acnt++] = a[i]; else a2[bcnt++] = a[i]; } memcpy(a,a1,sizeof(int)*acnt),memcpy(a+acnt,a2,sizeof(int)*bcnt); solve(a,acnt,l,mid),solve(a+acnt,bcnt,mid+1,r); #undef xp  #undef xl } void solve(){ static int qq[MAXN]; for(int i = 1;i\u0026lt;=m;i++) qq[i] = i; t[n+1].d=-1;t[n+1].p=0;t[n+1].l=1e18;++n; solve(qq+1,m,1,n); for(int i = 1;i\u0026lt;=m;i++) printf(\u0026#34;%d\\n\u0026#34;,ans[i]); } signed main(){ init(); solve(); return 0; }   ","description":"","id":93,"section":"posts","tags":["æ•´ä½“äºŒåˆ†","set"],"title":"ã€ŒCTSC2018ã€æ··åˆæœæ±-æ•´ä½“äºŒåˆ†","uri":"https://blog.chenqiqian.com/posts/ctsc2018-mix/"},{"content":"åœ¨ä¸€äº›æ‰‘å…‹æ¸¸æˆé‡Œï¼Œå¦‚å¾·å·æ‰‘å…‹ï¼Œå‘ç‰Œæ˜¯æœ‰è®²ç©¶çš„ã€‚ä¸€èˆ¬ç§°å‘¼ä¸“ä¸šçš„å‘ç‰Œæ‰‹ä¸ºè·å®˜ã€‚è·å®˜åœ¨å‘ç‰Œå‰ï¼Œå…ˆè¦é”€ç‰Œã€‚æ‰€è°“é”€ç‰Œï¼Œå°±æ˜¯æŠŠå½“å‰åœ¨ç‰Œåº“é¡¶çš„é‚£ä¸€å¼ ç‰Œç§»åŠ¨åˆ°ç‰Œåº“åº•ï¼Œå®ƒç”¨æ¥é˜²æ­¢ç©å®¶çŒœç‰Œè€Œå½±å“æ¸¸æˆã€‚\nå‡è®¾ä¸€å¼€å§‹ï¼Œè·å®˜æ‹¿å‡ºäº†ä¸€å‰¯æ–°ç‰Œï¼Œè¿™å‰¯ç‰Œæœ‰ $N$ å¼ ä¸åŒçš„ç‰Œï¼Œç¼–å·ä¾æ¬¡ä¸º $1$ åˆ° $N$ ã€‚ç”±äºæ˜¯æ–°ç‰Œï¼Œæ‰€ä»¥ç‰Œæ˜¯æŒ‰ç…§é¡ºåºæ’å¥½çš„ï¼Œä»ç‰Œåº“é¡¶å¼€å§‹ï¼Œä¾æ¬¡ä¸º $1, 2, \\dots$ ç›´åˆ°$N$ ï¼Œ$N$ å·ç‰Œåœ¨ç‰Œåº“åº•ã€‚ä¸ºäº†å‘å®Œæ‰€æœ‰çš„ç‰Œï¼Œè·å®˜ä¼šè¿›è¡Œ$N$ æ¬¡å‘ç‰Œæ“ä½œï¼Œåœ¨ç¬¬ $i$ æ¬¡å‘ç‰Œä¹‹å‰ï¼Œä»–ä¼šè¿ç»­è¿›è¡Œ $R_i$ æ¬¡é”€ç‰Œæ“ä½œï¼Œ $R_i$ ç”±è¾“å…¥ç»™å®šã€‚è¯·é—®æœ€åç©å®¶æ‹¿åˆ°è¿™å‰¯ç‰Œçš„é¡ºåºæ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ\né“¾æ¥ Luogu P3988\né¢˜è§£ $\\text{fhq Treap}$ æ¨¡æ‹Ÿå³å¯ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74  #include \u0026lt;bits/stdc++.h\u0026gt;using namespace std; const int MAXN = 800000; namespace treap{ int val[MAXN],fhq[MAXN],siz[MAXN],c[MAXN][2]; int cnt,root; void push_up(int x){ if(!x) return; siz[x] = siz[c[x][0]] + siz[c[x][1]] + 1; } int newnode(int v){ int x = ++cnt; val[x] = v;fhq[x] = rand(); push_up(x); return x; } void split(int x,int k,int \u0026amp;l,int \u0026amp;r){ if(!x){ l = r = 0; return; } if(siz[c[x][0]] + 1 \u0026lt;= k) l = x,split(c[x][1],k-siz[c[x][0]]-1,c[l][1],r); else r = x,split(c[x][0],k,l,c[r][0]); push_up(l),push_up(r); } int merge(int l,int r){//å°æ ¹å †  if(l == 0 || r == 0) return l+r; int x; if(fhq[l] \u0026lt;= fhq[r]){ x = l,c[x][1] = merge(c[l][1],r);\t} else{ x = r,c[x][0] = merge(l,c[r][0]); } push_up(x); return x; } void build(int n){ for(int i = 1;i\u0026lt;=n;i++){ root = merge(root,newnode(i)); } } int del(int k){// åˆ é™¤å¹¶è¿”å› rnk = k çš„æ•°å­—çš„å€¼  int a,b; int l,m,r; split(root,k,a,b); split(a,k-1,l,m),r = b; root = merge(r,l); return val[m]; } } int n; void solve(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n); treap::build(n); for(int i = 1;i\u0026lt;=n;i++){ int r; scanf(\u0026#34;%d\u0026#34;,\u0026amp;r); r %= (n-i+1); printf(\u0026#34;%d\\n\u0026#34;,treap::del(r+1)); } } int main(){ solve(); return 0; }   ","description":"","id":94,"section":"posts","tags":["æ•°æ®ç»“æ„","å¹³è¡¡æ ‘","Treap"],"title":"ã€ŒSHOI2013ã€å‘ç‰Œ-fhq Treap","uri":"https://blog.chenqiqian.com/posts/shoi2013-card/"},{"content":"ç»™å®šä¸€ä¸ª $n$ ä¸ªç‚¹ï¼Œä»¥ $1$ ä¸ºæ ¹çš„æœ‰æ ¹æ ‘ï¼Œç æ–­ç¬¬ $i$ æ¡è¾¹çš„ä»£ä»·ä¸º $c_i$ã€‚æœ‰ $m$ æ¬¡è¯¢é—®ï¼Œæ¯æ¬¡ç»™å‡º $k_i$ ä¸ªå…³é”®ç‚¹ï¼ˆä¿è¯å…³é”®ç‚¹ä¸å« $1$ å·èŠ‚ç‚¹ï¼‰ï¼Œè¯¢é—®èƒ½å¤Ÿä½¿ $1$ å·èŠ‚ç‚¹ä¸èƒ½åˆ°è¾¾ä»»ä½•å…³é”®ç‚¹ï¼Œæ‰€è¦ç æ–­è¾¹çš„ä»£ä»·å’Œæœ€å°æ˜¯å¤šå°‘ã€‚\næ•°æ®èŒƒå›´ï¼š$n,m \\leq 250000,\\sum {k_i} \\leq 5 \\times 10^5$\né“¾æ¥ Luogu P2495\né¢˜è§£ å¯ä»¥å…ˆæ€è€ƒåªæœ‰ä¸€ä¸ªè¯¢é—®çš„æƒ…å†µã€‚\nå¦‚æœè®¾ $i$ åˆ° $1$ çš„è·¯å¾„ä¸Šæ‰€æœ‰è¾¹ä»£ä»·æœ€å°çš„è¾¹çš„ä»£ä»·ä¸º $w[i]$ï¼Œä½¿ $i$ çš„å­æ ‘é‡Œé¢çš„æ‰€æœ‰ç‚¹éƒ½ä¸èƒ½åˆ°è¾¾ $1$ èŠ‚ç‚¹çš„æœ€å°ä»£ä»·ä¸º $f[i]$ ï¼Œé‚£ä¹ˆæœ‰å¦‚ä¸‹çš„è½¬ç§»ï¼ˆ $v$ æ˜¯ $i$ çš„å­èŠ‚ç‚¹ï¼‰ï¼š\n$$\nf[i] = \\min(w[i],\\sum {f[v]})\n$$\nè¿™ä¸ª $\\text{dp}$ çš„æ­£ç¡®æ€§å¥½åƒå¹¶ä¸æ˜¯é‚£ä¹ˆæ˜¾ç„¶\u0026hellip;ç®€å•è¯æ˜å¯ä»¥è¿™æ ·ï¼š$\\min$ ä¸­çš„ç¬¬ä¸€ä¸ªæ˜¯éå¸¸æ˜¾ç„¶çš„ä¸€ä¸ªå¯è¡Œè§£ï¼Œç¬¬äºŒä¸ªæœ‰è¿™ä¹ˆå‡ ç§æƒ…å†µï¼šå¦‚æœå­˜åœ¨æŸä¸ª $f[v]$ ç”± $w[v]$ è½¬ç§»è€Œæ¥ï¼Œé‚£ä¹ˆå¦‚æœå­˜åœ¨ $w[v] = w[i]$ï¼Œé‚£ä¹ˆå¿…ç„¶å°±æ˜¯ç¬¬ä¸€ç§æƒ…å†µå†åŠ ä¸Šè‹¥å¹²æ¡è¾¹ï¼Œå– $\\min$ ä¹‹åæ˜¾ç„¶ä¸å½±å“ç­”æ¡ˆã€‚\næˆ‘ä»¬æ³¨æ„åˆ°ä»¥ä¸Š $\\text{dp}$ çš„å¤æ‚åº¦ä¸º $O(\\text{æ ‘çš„èŠ‚ç‚¹æ•°})$ï¼Œè€Œæˆ‘ä»¬çš„ $\\sum{k_i}$ æ˜¯ $500000$ ã€‚å¦‚æœ $O(n)$ çš„ $\\text{dfs}$ é¢„å¤„ç†å‡ºæ ‘é“¾å‰–åˆ†å’Œ $w[i]$ ï¼Œå¯¹äºæ¯æ¬¡è¯¢é—®ç”¨ $O(k_i \\log n)$ çš„æ—¶é—´å»ºå‡ºè™šæ ‘ï¼ˆè™šæ ‘ä¸Šåªéœ€è¦ç»´æŠ¤ $w[i]$ ï¼‰ï¼Œå† $O(k_i)$ çš„åšä¸€æ¬¡æ ‘å½¢ $\\text{dp}$ï¼Œæœ€åæ—¶é—´å¤æ‚åº¦å°±æ˜¯ $O( n + \\sum k_i \\log n)$ ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152  // Code By Chen Qiqian on 2018.10.13 #include \u0026lt;cstdio\u0026gt;#include \u0026lt;algorithm\u0026gt;#include \u0026lt;vector\u0026gt;#include \u0026lt;unistd.h\u0026gt;#define ll long long #define inf 0x3f3f3f3f3f3f using namespace std; const int MAXN = 610000; struct Edge{ int to,len,nex; }edge[MAXN];int ecnt = 2,fir[MAXN]; void addedge(int a,int b,int c){ edge[ecnt] = (Edge){b,c,fir[a]}; fir[a] = ecnt++; } int n,m; ll w[MAXN]; int dep[MAXN],siz[MAXN],son[MAXN],fa[MAXN],top[MAXN],dfn[MAXN],tot; void init(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n); for(int i = 1;i\u0026lt;=n-1;i++){ int u,v,c; scanf(\u0026#34;%d %d %d\u0026#34;,\u0026amp;u,\u0026amp;v,\u0026amp;c); addedge(u,v,c),addedge(v,u,c); } } void dfs1(int nown,int f,int depth){ dep[nown] = depth,fa[nown] = f; siz[nown] = 1,son[nown] = 0; for(int nowe = fir[nown];nowe;nowe = edge[nowe].nex){ int v = edge[nowe].to,l = edge[nowe].len; if(v == fa[nown]) continue; w[v] = min(w[nown],(ll)l); dfs1(v,nown,depth+1); siz[nown] += siz[v]; if(siz[v] \u0026gt; siz[son[nown]]) son[nown] = v; } } void dfs2(int nown,int topf){ dfn[nown] = ++tot;top[nown] = topf; if(!son[nown]) return; dfs2(son[nown],topf); for(int nowe = fir[nown];nowe;nowe = edge[nowe].nex){ int v = edge[nowe].to;//l = edge[nowe].len;  if(v == fa[nown] || v == son[nown]) continue; dfs2(v,v); } } int lca(int x,int y){ if(x == 0 || y == 0) return 0; while(top[x] != top[y]){ if(dep[top[x]] \u0026lt; dep[top[y]]) swap(x,y); x = fa[top[x]]; } if(dep[x] \u0026gt; dep[y]) swap(x,y); return x; } void build(){ w[1] = inf; dfs1(1,0,1); dfs2(1,1); } int k,kp[MAXN],type[MAXN]; bool cmp(int a,int b){ return dfn[a] \u0026lt; dfn[b]; } Edge _edge[MAXN];int _ecnt = 2,_fir[MAXN]; void _addedge(int a,int b,int c = 0){ _edge[_ecnt] = (Edge){b,c,_fir[a]}; _fir[a] = _ecnt++; } ll _dfs(int nown){ ll tmp = 0; if(type[nown]) return (ll)w[nown]; for(int nowe = _fir[nown];nowe;nowe = _edge[nowe].nex){ int v = _edge[nowe].to; tmp += _dfs(v); } return min(tmp,(ll)w[nown]); } void solve_tree(){ sort(kp+1,kp+k+1,cmp); _ecnt = 2; static int stk[MAXN];int top = 0,cnt = k;//[0,top]  for(int i = 1;i\u0026lt;=k;i++){ type[kp[i]] = 1; int L = lca(kp[i],stk[top]); if(L == stk[top]) stk[++top] = kp[i]; else{ while(top \u0026gt;= 1 \u0026amp;\u0026amp; dep[stk[top-1]] \u0026gt;= dep[L]){ int nown = stk[top-1],v = stk[top]; _addedge(nown,v); top--; } if(stk[top] != L){ _addedge(L,stk[top]); stk[top] = L; kp[++cnt] = L; } stk[++top] = kp[i]; } } while(top \u0026gt;= 1) _addedge(stk[top-1],stk[top]),top--; type[1] = 0; printf(\u0026#34;%lld\\n\u0026#34;,_dfs(1)); for(int i = 1;i\u0026lt;=k;i++) type[kp[i]] = 0; for(int i = 1;i\u0026lt;=cnt;i++) _fir[kp[i]] = 0; } void solve(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;m); for(int i = 1;i\u0026lt;=m;i++){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;k); for(int j = 1;j\u0026lt;=k;j++) scanf(\u0026#34;%d\u0026#34;,\u0026amp;kp[j]); kp[++k] = 1; solve_tree(); } } signed main(){ init(); build(); solve(); return 0; }   ","description":"","id":95,"section":"posts","tags":["æ ‘å½¢ç»“æ„","è™šæ ‘","æ ‘å½¢dp","åŠ¨æ€è§„åˆ’"],"title":"ã€ŒSDOI2011ã€æ¶ˆè€—æˆ˜-è™šæ ‘+æ ‘å½¢dp","uri":"https://blog.chenqiqian.com/posts/sdoi2011-war/"},{"content":"æœ‰ä¸€ä¸ª $n$ è¡Œ $m$ åˆ—çš„æ£‹ç›˜ï¼Œæ£‹ç›˜ä¸Šå¯ä»¥æ”¾å¾ˆå¤šç‰¹æ®Šçš„æ£‹å­ï¼Œæ¯ä¸ªæ£‹å­çš„æ”»å‡»èŒƒå›´æ˜¯ $3$ è¡Œ $p$ åˆ—ã€‚è¾“å…¥æ•°æ®ç”¨ä¸€ä¸ª $3 \\times p$ çš„çŸ©é˜µç»™å‡ºäº†æ£‹å­æ”»å‡»èŒƒå›´çš„æ¨¡æ¿ï¼Œæ£‹å­è¢«é»˜è®¤åœ¨æ¨¡æ¿ä¸­çš„ç¬¬ [äºŒ] è¡Œï¼Œç¬¬ [$k+1$] åˆ—ï¼Œæ¨¡æ¿ä¸­æ£‹å­èƒ½æ”»å‡»åˆ°çš„ä½ç½®æ ‡è®°ä¸º 1ï¼Œä¸èƒ½æ”»å‡»åˆ°çš„ä½ç½®æ˜¯ 0 $(1 \\leq p \\leq m, 0 \\leq k \u0026lt; p)$ã€‚è¾“å…¥æ•°æ®ä¿è¯æ¨¡æ¿ä¸­çš„ç¬¬ [äºŒ] è¡Œç¬¬ [$k+1$] åˆ—æ˜¯ 1ã€‚\næ‰“å¼€é—¨çš„å¯†ç æ˜¯è¿™æ ·çš„ï¼šåœ¨è¦æ±‚æ£‹å­äº’ç›¸ä¸èƒ½æ”»å‡»åˆ°çš„å‰æä¸‹ï¼Œæ‘†æ”¾æ£‹å­çš„æ–¹æ¡ˆæ•°ã€‚æ³¨æ„ä»€ä¹ˆæ£‹å­éƒ½ä¸æ‘†ä¹Ÿç®—ä½œä¸€ç§å¯è¡Œæ–¹æ¡ˆã€‚è¯·æ±‚å‡ºæ–¹æ¡ˆå¯¹ $2^{32}$ å–ä½™çš„ç»“æœå³å¯ã€‚\næ³¨ï¼šä¸ºä½¿é¢˜é¢ç¬¦åˆæ­£å¸¸äººçš„æ€ç»´ï¼Œå¯¹å…¶åšäº†å¾®å°çš„ä¿®æ”¹ï¼Œå·²ç»ç”¨ç²—ä½“æ ‡å‡ºã€‚\né¢˜è§£ å¾ˆæ˜¾ç„¶ï¼Œ $m$ é‚£ä¹ˆå°ï¼Œæˆ‘ä»¬è‚¯å®šå¯ä»¥çŠ¶æ€å‹ç¼©äº†ã€‚\næˆ‘ä»¬æ³¨æ„åˆ°ï¼Œç›¸å½“äºä½ åœ¨æŸä¸€è¡Œæ”¾ç½®çš„æ£‹å­ï¼Œéƒ½åªä¼šå¯¹æœ¬è¡Œå’Œå‰åå„ä¸€è¡Œè¡Œäº§ç”Ÿå½±å“ï¼Œæ‰€ä»¥äº‹å®ä¸Šå¦‚æœæˆ‘ä»¬è®°å½•å‰ä¸€è¡Œå°±å¯ä»¥å®ŒæˆçŠ¶æ€çš„è®°å½•ã€‚\næˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€ä¸ªçŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼Œä»¤ $i$ ä¸ºè¿˜å‰©ä¸‹çš„è¡Œæ•°ï¼Œ $S$ ä¸ºä¸Šä¸€è¡Œçš„çŠ¶æ€ï¼š\n$$\ndp[i][S] =\n\\left{\n\\begin{aligned}{}\n\u0026amp;[S\\text{ä¸ºåˆæ³•çŠ¶æ€}]\u0026amp;,\u0026amp;i = 0\\\n\u0026amp;\\sum dp[i-1][S'] ,SS'\\text{æ»¡è¶³æ¡ä»¶A} \u0026amp;,\u0026amp;i \\neq 0 \\\n\\end{aligned}\n\\right.\n$$\nå…¶ä¸­æ¡ä»¶ $A$ ä¸º $S,S\u0026rsquo;å‡åˆæ³• ä¸” SS' ä¸å†²çª$ã€‚\nè®¡ç®—åˆæ³•ã€ä¸å†²çªå°±ç›´æ¥çŠ¶å‹æŒ‰ç…§è§„åˆ™æ¥å°±å¯ä»¥äº†ï¼Œæšä¸¾æ¯ä¸ªä½ç½®ï¼Œç„¶åè®¡ç®—ä¸èƒ½æ”¾æ£‹å­çš„ä½ç½®ï¼Œåœ¨å–ä¸€ä¸ªä¸å³å¯ã€‚\næ³¨æ„åˆ°å¤æ‚åº¦æœ‰äº›é«˜\u0026hellip;è²Œä¼¼æ˜¯ $O(n(2^m)^2) = 10^6 \\times 64 \\times 64 \\approx 4 \\times 10^9$ ï¼Œå†åŠ ä¸Šæˆ‘ä»¬å¯¹äºä»»æ„çš„ $i$ ï¼Œæˆ‘ä»¬çš„è½¬ç§»æ˜¯ä¸€æ ·ï¼Œå°±å¯ä»¥å¥—ä¸ŠçŸ©é˜µå¿«é€Ÿå¹‚ï¼Œå¤æ‚åº¦å³ä¸º $O((2^m)^3 \\times \\log n) \\approx 5 \\times 10^6$ å¯è¿‡\u0026hellip;\nå–æ¨¡ä½¿ç”¨ unsigned int è‡ªç„¶æº¢å‡ºå³å¯ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cstring\u0026gt;#include \u0026lt;algorithm\u0026gt;#define ui unsigned int using namespace std; const int MAXN = 70; int n,m,p,k,M; int limit[3]; struct Matrix{ ui num[MAXN][MAXN]; Matrix(int op = 0){ memset(num,0,sizeof(num)); for(int i = 0;i\u0026lt;MAXN;i++){num[i][i] = op;} } ui * operator [](int n){return num[n];} }; Matrix mul(Matrix \u0026amp;_x,Matrix \u0026amp;_y){ Matrix ans; for(int i = 0;i\u0026lt;M;i++) for(int j = 0;j\u0026lt;M;j++) for(int k = 0;k\u0026lt;M;k++) ans[i][j] += _x[i][k] * _y[k][j]; return ans; } Matrix pow(Matrix x,int k){ Matrix ans(1); for(int i = k;i;i\u0026gt;\u0026gt;=1,x = mul(x,x)) if(i\u0026amp;1) ans = mul(ans,x); return ans; } int getv(int x,int op){ int ans = 0; for(int i = 0;i\u0026lt;m;i++) if(x\u0026amp;(1\u0026lt;\u0026lt;i)) ans |= (i\u0026lt;=k?limit[op]\u0026gt;\u0026gt;(k-i):limit[op]\u0026lt;\u0026lt;(i-k)); return ans; } bool judge_self(int x){return x \u0026amp; getv(x,1);} bool judge_next(int L,int R){return (L \u0026amp; getv(R,0)) || (R \u0026amp; getv(L,2));} void init(){ scanf(\u0026#34;%d %d %d %d\u0026#34;,\u0026amp;n,\u0026amp;m,\u0026amp;p,\u0026amp;k);M = 1 \u0026lt;\u0026lt; m; for(int i = 0;i\u0026lt;3;i++){ for(int j = 0;j\u0026lt;p;j++){ int t;scanf(\u0026#34;%d\u0026#34;,\u0026amp;t); limit[i] |= t * (1\u0026lt;\u0026lt;j); } } limit[1] -= (1\u0026lt;\u0026lt;k); } void solve(){ Matrix a; for(int i = 0;i\u0026lt;M;i++){ if(judge_self(i)) continue; for(int j = 0;j\u0026lt;M;j++){ if(judge_self(j)) continue; if(!judge_next(j,i)){ a[i][j]++; } } } a = pow(a,n); ui ans = 0; for(int i = 0;i\u0026lt;M;i++){ if(!judge_self(i)) ans += a[0][i]; } printf(\u0026#34;%u\\n\u0026#34;,ans); } int main(){ init(); solve(); return 0; }   ","description":"","id":96,"section":"posts","tags":["çŠ¶å‹dp","åŠ¨æ€è§„åˆ’","çŸ©é˜µå¿«é€Ÿå¹‚"],"title":"ã€ŒTJOI2015ã€æ£‹ç›˜-çŠ¶å‹dp+çŸ©é˜µå¿«é€Ÿå¹‚","uri":"https://blog.chenqiqian.com/posts/tjoi2015-board/"},{"content":"æ–¹ä¼¯ä¼¯æ­£åœ¨åšä»–çš„ OJ ã€‚ç°åœ¨ä»–åœ¨å¤„ç† OJ ä¸Šçš„ç”¨æˆ·æ’åé—®é¢˜ã€‚ OJ ä¸Šæ³¨å†Œäº† $n$ ä¸ªç”¨æˆ·ï¼Œç¼–å·ä¸º $1$ ï½ $n$ ï¼Œä¸€å¼€å§‹ä»–ä»¬æŒ‰ç…§ç¼–å·æ’åã€‚\næ–¹ä¼¯ä¼¯ä¼šæŒ‰ç…§å¿ƒæƒ…å¯¹è¿™äº›ç”¨æˆ·åšä»¥ä¸‹å››ç§æ“ä½œï¼Œä¿®æ”¹ç”¨æˆ·çš„æ’åå’Œç¼–å· ï¼Œå…±æœ‰ $m$ æ¬¡æ“ä½œï¼š\n  æ“ä½œæ ¼å¼ä¸º 1 x y ï¼Œæ„å‘³ç€å°†ç¼–å·ä¸º $x$ çš„ç”¨æˆ·ç¼–å·æ”¹ä¸º $y$ ï¼Œè€Œæ’åä¸å˜ï¼Œæ‰§è¡Œå®Œè¯¥æ“ä½œåéœ€è¦è¾“å‡ºè¯¥ç”¨æˆ·åœ¨é˜Ÿåˆ—ä¸­çš„ä½ç½®ï¼Œæ•°æ®ä¿è¯ $x$ å¿…ç„¶å‡ºç°åœ¨é˜Ÿåˆ—ä¸­ï¼ŒåŒæ—¶ï¼Œ $y$ æ˜¯ä¸€ä¸ªå½“å‰ä¸åœ¨æ’åä¸­çš„ç¼–å·ã€‚\n  æ“ä½œæ ¼å¼ä¸º 2 x ï¼Œæ„å‘³ç€å°†ç¼–å·ä¸º $x$ çš„ç”¨æˆ·çš„æ’åæå‡åˆ°ç¬¬ä¸€ä½ï¼Œæ‰§è¡Œå®Œè¯¥æ“ä½œåéœ€è¦è¾“å‡ºæ‰§è¡Œè¯¥æ“ä½œå‰ç¼–å·ä¸º $x$ ç”¨æˆ·çš„æ’åã€‚\n  æ“ä½œæ ¼å¼ä¸º 3 x ï¼Œæ„å‘³ç€å°†ç¼–å·ä¸º $x$ çš„ç”¨æˆ·çš„æ’åé™åˆ°æœ€åä¸€ä½ï¼Œæ‰§è¡Œå®Œè¯¥æ“ä½œåéœ€è¦è¾“å‡ºæ‰§è¡Œè¯¥æ“ä½œå‰ç¼–å·ä¸º $x$ ç”¨æˆ·çš„æ’åã€‚\n  æ“ä½œæ ¼å¼ä¸º 4 kï¼Œæ„å‘³ç€æŸ¥è¯¢å½“å‰æ’åä¸º $k$ çš„ç”¨æˆ·ç¼–å·ï¼Œæ‰§è¡Œå®Œè¯¥æ“ä½œåéœ€è¦è¾“å‡ºå½“å‰æ“ä½œç”¨æˆ·çš„ç¼–å·ã€‚\n  å¯¹äº $100%$ çš„æ•°æ®ï¼Œ $1 \\leq n \\leq 10^8,1 \\leq m \\leq 10^5$ã€‚\nå¼ºåˆ¶åœ¨çº¿ã€‚\né“¾æ¥ Luogu P3285\né¢˜è§£ ä¸€é“æœ‰(du)è¶£(liu)çš„æ•°æ®ç»“æ„é¢˜ã€‚\næ³¨æ„åˆ° $n$ çš„èŒƒå›´æ¯”è¾ƒå¤§ï¼Œ $m$ çš„èŒƒå›´æ¯”è¾ƒå°ï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥æŠŠå¹³è¡¡æ ‘å»ºå‡ºæ¥ï¼Œè¦ä¸ç„¶ç©ºé—´/æ—¶é—´å’•å’•å’•\u0026hellip;\næ‰€ä»¥æˆ‘ä»¬éœ€è¦æƒ³åŠæ³•ä¼˜åŒ–ä¸€ä¸‹ã€‚æ³¨æ„åˆ° $m$ çš„èŒƒå›´æ˜¯ $10^5$ ï¼Œè€Œä¸”åªæœ‰åœ¨ä¸¤ç«¯æ·»åŠ çš„æ“ä½œï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘ä»£æ›¿å¹³è¡¡æ ‘ã€‚\n NOIP 2017 D2T3 å‘Šè¯‰æˆ‘ä»¬ï¼Œå¦‚æœä¸€ä¸ªå¹³è¡¡æ ‘åªæœ‰åœ¨æœ«å°¾/å¼€å¤´æ·»åŠ å’Œåˆ é™¤æ“ä½œï¼Œé‚£ä¹ˆæˆ‘ä»¬å®Œå…¨å¯ä»¥ç”¨åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘å–ä»£å®ƒã€‚å®ç°å¤æ‚åº¦å’Œæ—¶é—´å¤æ‚åº¦éƒ½ä¼šå¤§å¹…ä¼˜åŒ–ã€‚\n æˆ‘ä»¬ç”¨ä¸€ä¸ªå¾ˆå¤§å¾ˆå¤§çš„åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘å–ä»£å¹³è¡¡æ ‘ï¼Œå…·ä½“æ¥è¯´å°±æ˜¯æˆ‘ä»¬å‡è£…æˆ‘ä»¬çº¿æ®µæ ‘çš„ $[1,10^8]$ ä¹‹é—´éƒ½å¡æ»¡äº†æ•°ï¼Œä½†æ˜¯äº‹å®ä¸Šä¸€ä¸ªéƒ½æ²¡æœ‰ï¼Œåªæœ‰æˆ‘ä»¬è¦å¯¹å®ƒè¿›è¡Œä¿®æ”¹çš„æ—¶å€™æ‰å»æŠŠæŸä¸ªä½ç½®åˆ°æ ¹çš„è·¯å¾„å˜æˆçœŸå®å­˜åœ¨çš„å³å¯ã€‚\næŠŠä¸€ä¸ªæ•°æ”¾åˆ°å¤´éƒ¨å°±ç›¸å½“äºåœ¨åŸä½ç½®æ ‡è®°æˆ‘ä»¬å·²ç»åˆ é™¤äº†è¿™ä¸ªæ•°ï¼Œç„¶ååœ¨ $(- \\infty,0]$ è¿™ä¸ªåŒºé—´é‡Œé¡ºæ¬¡å¾€å¤–æ’å…¥å³å¯ï¼›æ”¾åˆ°å°¾éƒ¨åŒç†ï¼Œå°±ç›¸å½“äºä»å†…å‘å¤–åœ¨ $[n+1,+\\infty)$ å¾€é‡Œæ’å…¥æ•°å³å¯ã€‚\nç„¶åæˆ‘ä»¬è¿˜è¦è®°å½•ä¸€ä¸ªæ•°åœ¨çº¿æ®µæ ‘é‡çš„ä½ç½®ï¼Œè¿™é‡Œä½¿ç”¨ä¸€ä¸ª map ï¼Œåœ¨çº¿æ®µæ ‘ä¸­ $x$ æ•°å‡ºç°çš„ä½ç½®ï¼Œæ²¡æœ‰è¯¥ key åˆ™ä¸ºæ²¡æœ‰åŠ¨è¿‡ï¼Œä»åœ¨ $x$ ä½ç½®ã€‚\nç”±äº $m$ è¾ƒ $n$ æ¯”è¾ƒå°ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦ $O(m \\log n)$ ï¼Œç©ºé—´å¤æ‚åº¦ $O(m \\log n)$ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;map\u0026gt;#include \u0026lt;algorithm\u0026gt;using namespace std; const int MAXN = 100000,logn = 35; const int L = -1e7,R=1e8+1e7; struct SegTree{ int siz[MAXN*logn],val[MAXN*logn],ls[MAXN*logn],rs[MAXN*logn]; int root,cnt; #define mid ((l+r)\u0026gt;\u0026gt;1)  void update(int \u0026amp;nown,int l,int r,int pos,int v){ if(!nown) nown = ++cnt; if(l == r) val[nown] = v,siz[nown] = 0; else{ if(pos \u0026lt;= mid) update(ls[nown],l,mid,pos,v); if(pos \u0026gt;= mid+1) update(rs[nown],mid+1,r,pos,v); siz[nown] = siz[ls[nown]] + siz[rs[nown]]; } } void remove(int \u0026amp;nown,int l,int r,int pos){ if(!nown) nown = ++cnt; if(l == r) siz[nown] = -1; else{ if(pos \u0026lt;= mid) remove(ls[nown],l,mid,pos); if(pos \u0026gt;= mid+1) remove(rs[nown],mid+1,r,pos); siz[nown] = siz[ls[nown]] + siz[rs[nown]]; } } int kth(int nown,int l,int r,int k,int \u0026amp;v){ if(k \u0026gt; (r-l+1) + siz[nown]) return -1; if(l == r){ v = val[nown]; return l; } else{ int sz = (mid-l+1) + siz[ls[nown]]; if(k \u0026lt;= sz) return kth(ls[nown],l,mid,k,v); if(k \u0026gt; sz) return kth(rs[nown],mid+1,r,k-sz,v); return -1; } } int getsum(int nown,int l,int r,int ql,int qr){ if(!nown) return 0; if(ql \u0026lt;= l \u0026amp;\u0026amp; r \u0026lt;= qr){ return siz[nown]; } else{ int ans = 0; if(ql \u0026lt;= mid) ans += getsum(ls[nown],l,mid,ql,qr); if(qr \u0026gt;= mid+1) ans += getsum(rs[nown],mid+1,r,ql,qr); return ans; } } void update(int pos,int v){update(root,L,R,pos,v);} void remove(int pos){remove(root,L,R,pos);} int kth(int k){int v=0,t = kth(root,L,R,k,v);return v!=0?v:t;} int getsum(int l,int r){return getsum(root,L,R,l,r);} }T; int n,m,nowl,nowr; map\u0026lt;int,int\u0026gt; M;//åœ¨çº¿æ®µæ ‘ä¸­ x å‡ºç°çš„ä½ç½®ï¼Œæ²¡æœ‰åˆ™ä¸ºæ²¡æœ‰åŠ¨è¿‡  int getpos(int x){ return M.count(x)?M[x]:x; } int push_top(int x){ int pos = getpos(x),ans = (pos-nowl+1) + T.getsum(nowl,pos); T.remove(pos),T.update(--nowl,x); M[x] = nowl; return ans; } int push_bottom(int x){ int pos = getpos(x),ans = (pos-nowl+1) + T.getsum(nowl,pos); T.remove(pos),T.update(++nowr,x); M[x] = nowr; return ans; } int change_id(int x,int y){ int pos = getpos(x),ans = (pos-nowl+1) + T.getsum(nowl,pos); T.update(pos,y); M[y] = pos; return ans; } int query_id(int k){ return T.kth((nowl-L)+k); } void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m); nowl = 1,nowr = n; } void solve(){ int lastans = 0; for(int i = 1;i\u0026lt;=m;i++){ int op,x,y,k; scanf(\u0026#34;%d\u0026#34;,\u0026amp;op); if(op == 1){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;x,\u0026amp;y); x -= lastans,y -= lastans; lastans = change_id(x,y); } else if(op == 2){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;x);x -= lastans; lastans = push_top(x); } else if(op == 3){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;x);x -= lastans; lastans = push_bottom(x); } else if(op == 4){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;k);k -= lastans; lastans = query_id(k); } printf(\u0026#34;%d\\n\u0026#34;,lastans); } } int main(){ init(); solve(); return 0; }   ","description":"","id":97,"section":"posts","tags":["æ•°æ®ç»“æ„","çº¿æ®µæ ‘"],"title":"ã€ŒSCOI2014ã€æ–¹ä¼¯ä¼¯çš„OJ-åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘","uri":"https://blog.chenqiqian.com/posts/scoi2014-onlinejudge/"},{"content":"ç»™å®šä¸€ä¸ªæ— å‘è¿é€šå›¾ï¼Œå…¶èŠ‚ç‚¹ç¼–å·ä¸º $1$ åˆ° $N$ï¼Œå…¶è¾¹çš„æƒå€¼ä¸ºéè´Ÿæ•´æ•°ã€‚è¯•æ±‚å‡ºä¸€æ¡ä» $1$ å·èŠ‚ç‚¹åˆ° $N$ å·èŠ‚ç‚¹çš„è·¯å¾„ï¼Œä½¿å¾—è¯¥è·¯å¾„ä¸Šç»è¿‡çš„è¾¹çš„æƒå€¼çš„ â€œ $\\text{XOR}$ å’Œâ€ æœ€å¤§ã€‚è¯¥è·¯å¾„å¯ä»¥é‡å¤ç»è¿‡æŸäº›èŠ‚ç‚¹æˆ–è¾¹ï¼Œå½“ä¸€æ¡è¾¹åœ¨è·¯å¾„ä¸­å‡ºç°å¤šæ¬¡æ—¶ï¼Œå…¶æƒå€¼åœ¨è®¡ç®— â€œ$\\text{XOR}$ å’Œâ€ æ—¶ä¹Ÿè¦è¢«é‡å¤è®¡ç®—ç›¸åº”å¤šçš„æ¬¡æ•°ã€‚\nç›´æ¥æ±‚è§£ä¸Šè¿°é—®é¢˜æ¯”è¾ƒå›°éš¾ï¼Œäºæ˜¯ä½ å†³å®šä½¿ç”¨éå®Œç¾ç®—æ³•ã€‚å…·ä½“æ¥è¯´ï¼Œä» $1$ å·èŠ‚ç‚¹å¼€å§‹ï¼Œä»¥ç›¸ç­‰çš„æ¦‚ç‡ï¼Œéšæœºé€‰æ‹©ä¸å½“å‰èŠ‚ç‚¹ç›¸å…³è”çš„æŸæ¡è¾¹ï¼Œå¹¶æ²¿è¿™æ¡è¾¹èµ°åˆ°ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œé‡å¤è¿™ä¸ªè¿‡ç¨‹ï¼Œç›´åˆ°èµ°åˆ° $N$ å·èŠ‚ç‚¹ä¸ºæ­¢ï¼Œä¾¿å¾—åˆ°ä¸€æ¡ä» $1$ å·èŠ‚ç‚¹åˆ° $N$ å·èŠ‚ç‚¹çš„è·¯å¾„ã€‚æ˜¾ç„¶å¾—åˆ°æ¯æ¡è¿™æ ·çš„è·¯å¾„çš„æ¦‚ç‡æ˜¯ä¸åŒçš„ï¼Œå¹¶ä¸”æ¯æ¡è¿™æ ·çš„è·¯å¾„çš„ â€œ $\\text{XOR}$ å’Œâ€ ä¹Ÿä¸ä¸€æ ·ã€‚ç°åœ¨è¯·ä½ æ±‚å‡ºè¯¥ç®—æ³•å¾—åˆ°çš„è·¯å¾„çš„ â€œ $\\text{XOR}$ å’Œâ€ çš„æœŸæœ›å€¼ã€‚\né“¾æ¥ Luogu P3211\né¢˜è§£ æ³¨æ„åˆ°æ¯ä½ç‹¬ç«‹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è€ƒè™‘åˆ†åˆ«è€ƒè™‘æ¯ä½å†è¿›è¡Œç›¸åŠ ã€‚\nå…·ä½“æ¥è¯´ï¼Œå¦‚æœæˆ‘ä»¬ç”¨ $P[i]$ è¡¨ç¤ºåœ¨ $i$ å·èŠ‚ç‚¹æ—¶ï¼Œåˆ°è¾¾ $N$ å·èŠ‚ç‚¹æ—¶è¯¥ä½ä¸º $1$ çš„æ¦‚ç‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬æœ‰å¦‚ä¸‹è½¬ç§»ï¼š\n$$\nP[i] =\n\\left{\n\\begin{aligned}{}\n\u0026amp;\\sum_{\\text{i,j have a edge}} \\frac{P[j]}{d[i]}\u0026amp;,i \\neq N\\\n\u0026amp;1\u0026amp;,i = N\n\\end{aligned}\n\\right.\n$$\nå…¶ä¸­ $d[i]$ ä¸º $i$ èŠ‚ç‚¹åº¦æ•°ã€‚\né«˜æ–¯æ¶ˆå…ƒå³å¯ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cmath\u0026gt;#include \u0026lt;cstring\u0026gt;#include \u0026lt;algorithm\u0026gt;using namespace std; const double eps = 1e-7; const int MAXN = 110,MAXM = 11000; struct Edge{ int to,len; int nex; }edge[MAXM*2];int ecnt = 2; int fir[MAXN]; void addedge(int u,int v,int c){ edge[ecnt] = (Edge){v,c,fir[u]}; fir[u] = ecnt++; } int n,m; double de[MAXN]; void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m); for(int i = 1;i\u0026lt;=m;i++){ int u,v,c; scanf(\u0026#34;%d %d %d\u0026#34;,\u0026amp;u,\u0026amp;v,\u0026amp;c); addedge(u,v,c);de[u]++; if(u!=v){ addedge(v,u,c);de[v]++; } } } bool gauss(double a[MAXN][MAXN],int n){ for(int i = 1;i\u0026lt;=n;i++){ int r = i; for(int j = i+1;j\u0026lt;=n;j++){ if(fabs(a[j][i]) \u0026gt; fabs(a[r][i])) r = j; } if(r != i){ for(int j = 1;j\u0026lt;=n+1;j++) swap(a[i][j],a[r][j]); } if(fabs(a[i][i]) \u0026lt; eps) return 0; for(int j = 1;j\u0026lt;=n;j++)if(j!=i){ double t = a[j][i]/a[i][i]; for(int k = 1;k\u0026lt;=n+1;k++){ a[j][k] -= a[i][k] * t; } } } for(int i = 1;i\u0026lt;=n;i++) a[i][n+1]/=a[i][i],a[i][i] = 1; return 1; } double ju[MAXN][MAXN]; int num[MAXN]; void solve(){ double ans = 0; for(int i = 0;i\u0026lt;30;i++){ // printf(\u0026#34;i:%d\\n\u0026#34;,i);  memset(ju,0,sizeof(ju)); for(int nown = 1;nown\u0026lt;=n;nown++){ int cnt = 0; ju[nown][nown] = 1; for(int nowe = fir[nown];nowe;nowe = edge[nowe].nex){ int v = edge[nowe].to,l = edge[nowe].len; if((l \u0026amp; (1\u0026lt;\u0026lt;i)) == 0) ju[nown][v] += -1/de[nown]; else ju[nown][v] += 1/de[nown],cnt++; } ju[nown][n+1] = cnt/de[nown]; } for(int i = 1;i\u0026lt;=n;i++) ju[n][i] = 0; ju[n][n] = 1,ju[n][n+1] = 0; gauss(ju,n); ans += ju[1][n+1] * pow(2,i); // printf(\u0026#34;--------------------\\n\u0026#34;);  } printf(\u0026#34;%.3lf\\n\u0026#34;,ans); } int main(){ init(); solve(); return 0; }   ","description":"","id":98,"section":"posts","tags":["æœŸæœ›","é«˜æ–¯æ¶ˆå…ƒ"],"title":"ã€ŒHNOI2011ã€XORå’Œè·¯å¾„-é«˜æ–¯æ¶ˆå…ƒ","uri":"https://blog.chenqiqian.com/posts/hnoi2011-xor/"},{"content":"ç»™å®šä¸€ä¸ª $n$ ä¸ªç‚¹ï¼Œ $m$ æ¡è¾¹çš„æ— å‘å›¾ã€‚èªèªå¼€å§‹çš„æ—¶å€™åœ¨ Sï¼Œå¯å¯åœ¨èŠ‚ç‚¹ T å¤„ã€‚ä»¥åçš„æ¯ä¸ªæ—¶é—´å•ä½ï¼Œå¯å¯éƒ½ä¼šé€‰æ‹©å»ç›¸é‚»çš„æ™¯ç‚¹(å¯èƒ½æœ‰å¤šä¸ª)ä¸­çš„ä¸€ä¸ªæˆ–åœç•™åœ¨åŸæ™¯ç‚¹ä¸åŠ¨ã€‚è€Œå»è¿™äº›åœ°æ–¹æ‰€å‘ç”Ÿçš„æ¦‚ç‡æ˜¯ç›¸ç­‰çš„ã€‚å‡è®¾æœ‰ $P$ ä¸ªæ™¯ç‚¹ä¸æ™¯ç‚¹ M ç›¸é‚»ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯æ™¯ç‚¹ Rã€ æ™¯ç‚¹ Sï¼Œâ€¦â€¦ï¼Œæ™¯ç‚¹ Qï¼Œåœ¨æ—¶åˆ» $i$ å¯å¯å¤„åœ¨æ™¯ç‚¹ Mï¼Œåˆ™åœ¨ $i+1$ æ—¶åˆ»ï¼Œå¯å¯æœ‰ $\\frac{1}{1+P}$ çš„å¯èƒ½åœ¨æ™¯ç‚¹ Rï¼Œæœ‰ $\\frac{1}{1+P}$ çš„å¯èƒ½åœ¨æ™¯ç‚¹ Sï¼Œâ€¦â€¦ï¼Œæœ‰ $\\frac{1}{1+P}$ çš„å¯èƒ½åœ¨æ™¯ç‚¹ Qï¼Œè¿˜æœ‰ $\\frac{1}{1+P}$ çš„å¯èƒ½åœåœ¨æ™¯ç‚¹ Mã€‚\nå½“èªèªåœ¨æ™¯ç‚¹ C æ—¶ï¼Œå¥¹ä¼šé€‰ä¸€ä¸ªæ›´é è¿‘å¯å¯çš„æ™¯ç‚¹ï¼Œå¦‚æœè¿™æ ·çš„æ™¯ç‚¹æœ‰å¤šä¸ªï¼Œå¥¹ä¼šé€‰ä¸€ä¸ªæ ‡å·æœ€å°çš„æ™¯ç‚¹ã€‚å¦‚æœèµ°å®Œç¬¬ä¸€æ¬¡ç§»åŠ¨ä»¥åä»ç„¶æ²¡åƒåˆ°å¯å¯ï¼Œå¥¹è¿˜å¯ä»¥åœ¨æœ¬æ®µæ—¶é—´å†…å†å‘å¯å¯è¿›è¡Œä¸€æ¬¡ç§»åŠ¨ã€‚\nåœ¨æ¯ä¸ªæ—¶é—´å•ä½ï¼Œå‡è®¾èªèªå…ˆèµ°ï¼Œå¯å¯åèµ°ã€‚åœ¨æŸä¸€æ—¶åˆ»ï¼Œè‹¥èªèªå’Œå¯å¯ä½äºåŒä¸€ä¸ªæ™¯ç‚¹ï¼Œåˆ™å¯æ€œçš„å¯å¯å°±è¢«åƒæ‰äº†ã€‚\nè¯·æ±‚å‡ºå¹³å‡æƒ…å†µä¸‹ï¼Œèªèªç”¨å‡ ä¸ªæ—¶é—´å•ä½å°±å¯èƒ½åƒåˆ°å¯å¯ã€‚\né“¾æ¥ Luogu P4206\né¢˜è§£ æœ‰è¶£çš„æœŸæœ›dpã€‚\næˆ‘ä»¬æ³¨æ„åˆ°ï¼Œå¦‚æœæˆ‘ä»¬çŸ¥é“å¯å¯å’Œèªèªçš„ä½ç½®ï¼Œé‚£ä¹ˆèªèªçš„ä¸¤æ¬¡ç§»åŠ¨æˆ‘ä»¬éƒ½æ˜¯å”¯ä¸€çš„ã€‚\næ‰€ä»¥æˆ‘ä»¬ç”¨ $n$ æ¬¡ $\\text{bfs}$ å¤„ç†å‡ºæ‰€æœ‰ç‚¹å¯¹é—´çš„æœ€çŸ­è·¯ï¼Œç„¶åé’ˆå¯¹ $n$ ä¸ªå¯å¯å¯èƒ½åœ¨çš„ç‚¹ï¼Œå¯¹æ¯ä¸ªèŠ‚ç‚¹è¿›è¡Œä¸€æ¬¡éå†ï¼ˆè¾¹ï¼‰ï¼Œæ‰¾åˆ°æœ€è¿‘çš„å‡ºåº¦ã€‚ä»¥ä¸Šä¸¤ä¸ªè¿‡ç¨‹éƒ½æ˜¯ $O(n^2)$ çš„ã€‚\nç°åœ¨æˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œè½¬ç§»äº†ã€‚\nè®¾ $dp[u][v]$ ä¸ºèªèªåœ¨ $u$ ï¼Œå¯å¯åœ¨ $v$ æ—¶çš„æœŸæœ›æ­¥æ•°ï¼Œç„¶åè½¬ç§»å³å¯ã€‚æ³¨æ„åˆ°æˆ‘ä»¬éœ€è¦éå† $v$ è¿™ä¸ªç‚¹å¯¹åº”çš„æ‰€æœ‰çš„è¾¹ï¼Œä½†æ˜¯æ— å‘å›¾çš„è¯ï¼Œæ‰€æœ‰çš„è¾¹ä¼šè¢«éå†ä¸¤éï¼Œæ‰€ä»¥å¯¹äºæ¯ä¸ª $v$ ï¼Œè½¬ç§»æ˜¯ $O(n)$ çš„ï¼Œç„¶åè½¬ç§»çš„å¤æ‚åº¦ä¹Ÿæ˜¯ $O(n^2)$ ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;vector\u0026gt;#include \u0026lt;queue\u0026gt;#include \u0026lt;unistd.h\u0026gt;using namespace std; const int MAXN = 1100; int n,m,s,t; vector\u0026lt;int\u0026gt; edge[MAXN]; int dis[MAXN][MAXN],near[MAXN][MAXN]; double dp[MAXN][MAXN]; queue\u0026lt;int\u0026gt; q; void init(){ scanf(\u0026#34;%d %d %d %d\u0026#34;,\u0026amp;n,\u0026amp;m,\u0026amp;s,\u0026amp;t); for(int i = 1;i\u0026lt;=m;i++){ int u,v; scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;u,\u0026amp;v); edge[u].push_back(v); edge[v].push_back(u); } } void bfs(int st){ while(!q.empty()) q.pop(); q.push(st);dis[st][st] = 0; while(!q.empty()){ int nown = q.front();q.pop(); // printf(\u0026#34;%d\\n\u0026#34;,nown);  for(unsigned i = 0;i\u0026lt;edge[nown].size();i++){ int v = edge[nown][i]; // printf(\u0026#34; v:%d\\n\u0026#34;,v);  if(dis[st][v] == 0 \u0026amp;\u0026amp; v != st){ dis[st][v] = dis[st][nown] + 1; q.push(v); } } } } void get_near(int to){ for(int nown = 1;nown\u0026lt;=n;nown++){ if(nown == to) continue;//cautious  near[nown][to] = 0x3f3f3f3f; for(unsigned i = 0;i\u0026lt;edge[nown].size();i++){ int v = edge[nown][i]; if(dis[v][to] \u0026lt; dis[nown][to] \u0026amp;\u0026amp; near[nown][to] \u0026gt; v){ near[nown][to] = v; } } } } double dfs(int u,int v){ int uu = u,vv = v; if(dp[uu][vv] != 0) return dp[u][v]; if(u == v) return 0; if(near[u][v] == v || near[near[u][v]][v] == v){ return dp[u][v] = 1; } u = near[near[u][v]][v]; double ans = 0; for(unsigned i = 0;i\u0026lt;edge[v].size();i++){ int to = edge[v][i]; ans += (dfs(u,to)+1); } ans += dfs(u,v)+1; return dp[uu][vv] = ans/(edge[v].size()+1); } void solve(){ for(int i = 1;i\u0026lt;=n;i++) bfs(i); for(int i = 1;i\u0026lt;=n;i++) get_near(i); double ans = dfs(s,t); printf(\u0026#34;%.3lf\\n\u0026#34;,ans); } int main(){ init(); solve(); return 0; }   ","description":"","id":99,"section":"posts","tags":["åŠ¨æ€è§„åˆ’","æœŸæœ›dp"],"title":"ã€ŒNOI2005ã€èªèªä¸å¯å¯-æœŸæœ›dp","uri":"https://blog.chenqiqian.com/posts/noi2005-clever-and-cute/"},{"content":"ç»™ä¸€ä¸ªæ•°å­—ä¸² $s$ å’Œæ­£æ•´æ•° $d$ , ç»Ÿè®¡ $s$ æœ‰å¤šå°‘ç§ä¸åŒçš„æ’åˆ—èƒ½è¢« $d$ æ•´é™¤ï¼ˆå¯ä»¥æœ‰å‰å¯¼ $0$ ï¼‰ã€‚\né“¾æ¥ Luogu P4163\né¢˜è§£ ç®€å•çŠ¶å‹dpã€‚\næˆ‘ä»¬å…ˆè€ƒè™‘æ¯ä¸ªæ•°å­—éƒ½ä¸åŒçš„æƒ…å†µï¼Œç„¶ååœ¨é™¤æ‰æ¯ä¸ªæ•°å­—å‡ºç°æ¬¡æ•°çš„é˜¶ä¹˜å³å¯ã€‚\næˆ‘ä»¬ä»¤ $s$ çš„é•¿åº¦ä¸º $n$ï¼Œè®¾çŠ¶æ€ $dp[S][r]$ ä¸ºç›®å‰é€‰äº†é›†åˆ $S$ ï¼Œæ¨¡ $d$ ä½™æ•°ä¸º $r$ çš„æƒ…å†µæ•°ï¼Œæœ‰å¦‚ä¸‹è½¬ç§»æ–¹ç¨‹ï¼š\n$$\ndp[S][r] = \\sum dp[S | 2^i][r*10 + s[i]],\\text{if } S \u0026amp; 2^i = 0\n$$\nè¾¹ç•Œæƒ…å†µå°±æ˜¯ $dp[2^{n+1}-1][0] = 1$ å…¶ä½™å‡ä¸º $0$ã€‚\n$\\text{dfs}$ å³å¯ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º $O(n2^n \\times d)$ï¼Œäº‹å®ä¸Šè·‘ä¸æ»¡\u0026hellip;\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cstring\u0026gt;using namespace std; const int MAXN = 11; char str[MAXN];int n,d; int dp[1\u0026lt;\u0026lt;MAXN][1001]; void init(){ scanf(\u0026#34;%s\u0026#34;,str); n = strlen(str); scanf(\u0026#34;%d\u0026#34;,\u0026amp;d); memset(dp,-1,sizeof(dp)); // printf(\u0026#34;str:%s d:%d\\n\u0026#34;,str,d); } int dfs(int now,int r){ if(now == (1\u0026lt;\u0026lt;n)-1) return r == 0; if(dp[now][r] != -1) return dp[now][r]; int ans = 0; for(int i = 0;i\u0026lt;n;i++){ if((now \u0026amp; (1\u0026lt;\u0026lt;i)) == 0){ ans += dfs(now|(1\u0026lt;\u0026lt;i),(r*10+(str[i]-48))%d); } } return dp[now][r] = ans; } void solve(){ dfs(0,0); int t[MAXN],power[MAXN]; for(int i = 0;i\u0026lt;=9;i++) t[i] = 0; for(int i = 0;i\u0026lt;n;i++) t[int(str[i]-48)]++; power[0] = 1; for(int i = 1;i\u0026lt;=n;i++) power[i] = power[i-1] * i; int ans = dp[0][0]; for(int i = 0;i\u0026lt;=9;i++) ans /= power[t[i]]; printf(\u0026#34;%d\\n\u0026#34;,ans); } int main(){ int T; scanf(\u0026#34;%d\u0026#34;,\u0026amp;T); for(int i = 1;i\u0026lt;=T;i++){ init(); solve(); } return 0; }   ","description":"","id":100,"section":"posts","tags":["çŠ¶å‹dp","åŠ¨æ€è§„åˆ’"],"title":"ã€ŒSCOI2007ã€æ’åˆ—-çŠ¶å‹dp","uri":"https://blog.chenqiqian.com/posts/scoi2007-permutation/"},{"content":"ç»™å®šä¸€ä¸ª $n$ ä¸ªèŠ‚ç‚¹çš„æœ‰æ ¹æ ‘ï¼Œå¼€å§‹æ—¶æ¯ä¸ªèŠ‚ç‚¹çš„æƒå€¼éƒ½ä¸º $0$ ã€‚ä¸€å…±æœ‰ $q$ ä¸ªæ—¶åˆ»ï¼Œæ¯ä¸ªæ—¶åˆ»å¯èƒ½æœ‰å¦‚ä¸‹ä¸¤ä¸ªæ“ä½œä¹‹ä¸€ï¼š\n  ç»™å®šä¸€ä¸ªèŠ‚ç‚¹ $x$ ï¼Œä»ä¸‹ä¸€ä¸ªæ—¶åˆ»èµ·æ¯ä¸ªæ—¶åˆ»éƒ½ç»™è¯¥èŠ‚ç‚¹çš„æƒå€¼ $+1$ï¼ˆæ¯ä¸ªèŠ‚ç‚¹åªä¼šæœ‰ä¸€æ¬¡è¯¥æ“ä½œï¼‰ï¼›\n  ç»™å®šä¸¤ä¸ªèŠ‚ç‚¹ $x,y$ ä»¥åŠä¸€ä¸ªæ•° $C$ ï¼Œæ±‚è¿™ä¸¤ä¸ªèŠ‚ç‚¹çš„ç®€å•è·¯å¾„ä¸Šæƒå€¼å¤§äº $C$ çš„èŠ‚ç‚¹ä¸ªæ•°ï¼Œä»¥åŠç®€å•è·¯å¾„ä¸Šçš„æ‰€æœ‰èŠ‚ç‚¹ä¸ªæ•°ã€‚\n  é“¾æ¥ Luogu P4216\né¢˜è§£ è®¾ç›®å‰æ—¶åˆ» $t$ï¼Œé‚£ä¹ˆç¬¬äºŒä¸ªæ“ä½œäº‹å®ä¸Šå¯ä»¥è½¬åŒ–æˆè¿›è¡Œä¸€æ“ä½œæ—¶é—´åœ¨ $t-C$ ä¹‹å‰çš„èŠ‚ç‚¹ä¸ªæ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç¦»çº¿æ“ä½œï¼Œå»ºä¸€æ£µä»¥æ ‘é“¾å‰–åˆ† $\\text{dfs}$ åºä¸ºåºåˆ—ä¸‹æ ‡çš„ä¸»å¸­æ ‘ï¼Œåœ¨ç»“åˆæ ‘é“¾å‰–åˆ†ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ $O(log^2 n)$ çš„æ—¶é—´å†…å›ç­”è¯¢é—®ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;vector\u0026gt;#include \u0026lt;algorithm\u0026gt;using namespace std; const int MAXN = 200100,logn = 17; int n,q; vector\u0026lt;int\u0026gt; edge[MAXN]; int rt,fa[MAXN]; int dep[MAXN],siz[MAXN],son[MAXN]; int top[MAXN],id[MAXN],last[MAXN],cnt; int ti[MAXN]; struct Query{ int t,x,y,c; }Q[MAXN*2];int qcnt; void init(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n); int p; for(int i = 1;i\u0026lt;=n;i++){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;p); if(p != 0){ edge[p].push_back(i); fa[i] = p; } else{ rt = i; } } scanf(\u0026#34;%d\u0026#34;,\u0026amp;q); for(int i = 1;i\u0026lt;=q;i++){ int op,x,y,c; scanf(\u0026#34;%d\u0026#34;,\u0026amp;op); if(op == 1){ scanf(\u0026#34;%d %d %d\u0026#34;,\u0026amp;x,\u0026amp;y,\u0026amp;c); Q[++qcnt] = (Query){i,x,y,c}; } else{ scanf(\u0026#34;%d\u0026#34;,\u0026amp;x); ti[x] = i; } } } void dfs1(int nown,int depth){ siz[nown] = 1,dep[nown] = depth; for(unsigned i = 0;i\u0026lt;edge[nown].size();i++){ int v = edge[nown][i]; dfs1(v,depth+1); siz[nown] += siz[v]; if(siz[v] \u0026gt; siz[son[nown]]) son[nown] = v; } } void dfs2(int nown,int topf){ top[nown] = topf;id[nown] = ++cnt; last[cnt] = nown; if(!son[nown]) return; dfs2(son[nown],topf); for(unsigned i = 0;i\u0026lt;edge[nown].size();i++){ int v = edge[nown][i]; if(v == son[nown]) continue; dfs2(v,v); } } namespace prSegTree{ int ls[MAXN*logn],rs[MAXN*logn],sumn[MAXN*logn],cnt; #define mid ((l+r)\u0026gt;\u0026gt;1)  void insert(int \u0026amp;nown,int pre,int l,int r,int pos,int val){ nown = ++cnt;ls[nown] = ls[pre],rs[nown] = rs[pre],sumn[nown] = sumn[pre]; if(l == r){ sumn[nown] += val; } else{ if(pos \u0026lt;= mid) insert(ls[nown],ls[pre],l,mid,pos,val); if(pos \u0026gt;= mid+1) insert(rs[nown],rs[pre],mid+1,r,pos,val); sumn[nown] = sumn[ls[nown]] + sumn[rs[nown]]; } } int query(int nown,int l,int r,int ql,int qr){ if(ql \u0026gt; qr) return 0; if(ql \u0026lt;= l \u0026amp;\u0026amp; r \u0026lt;= qr){ return sumn[nown]; } else{ int ans = 0; if(ql \u0026lt;= mid){ ans += query(ls[nown],l,mid,ql,qr); } if(qr \u0026gt;= mid+1){ ans += query(rs[nown],mid+1,r,ql,qr); } return ans; } } } int root[MAXN]; int query_tree(int l,int r,int c){ return prSegTree::query(root[r],1,q+1,1,c) - prSegTree::query(root[l-1],1,q+1,1,c); } void build(){ dfs1(rt,1); dfs2(rt,rt); for(int i = 1;i\u0026lt;=n;i++){ if(ti[last[i]]) prSegTree::insert(root[i],root[i-1],1,q+1,ti[last[i]]+1,1); else root[i] = root[i-1]; } } void query(int x,int y,int c,int \u0026amp;tot,int \u0026amp;ans){ ans = 0;tot = 0; while(top[x] != top[y]){ if(dep[top[x]] \u0026lt; dep[top[y]]) swap(x,y); tot += dep[x] - dep[top[x]] + 1; ans += query_tree(id[top[x]],id[x],c); x = fa[top[x]]; } if(dep[x] \u0026gt; dep[y]) swap(x,y); tot += dep[y] - dep[x] + 1; ans += query_tree(id[x],id[y],c); } void solve(){ int ans = 0,tot = 0; for(int i = 1;i\u0026lt;=qcnt;i++){ Query \u0026amp; qq = Q[i]; query(qq.x,qq.y,qq.t-qq.c,tot,ans); printf(\u0026#34;%d %d\\n\u0026#34;,tot,ans); } } int main(){ init(); build(); solve(); return 0; }   ","description":"","id":101,"section":"posts","tags":["æ•°æ®ç»“æ„","æ ‘é“¾å‰–åˆ†","ä¸»å¸­æ ‘"],"title":"ã€ŒSCOI2015ã€æƒ…æŠ¥ä¼ é€’-æ ‘é“¾å‰–åˆ†-ä¸»å¸­æ ‘","uri":"https://blog.chenqiqian.com/posts/scoi2015-intelligence/"},{"content":"æœ‰ $n$ å®¶æ´—è½¦åº—ä»å·¦å¾€å³æ’æˆä¸€æ’ï¼Œæ¯å®¶åº—éƒ½æœ‰ä¸€ä¸ªæ­£æ•´æ•°ä»·æ ¼ $p_i$ ã€‚æœ‰ $m$ ä¸ªäººè¦æ¥æ¶ˆè´¹ï¼Œç¬¬ $i$ ä¸ªäººä¼šé©¶è¿‡ç¬¬ $a_i$ ä¸ªå¼€å§‹ä¸€ç›´åˆ°ç¬¬ $b_i$ ä¸ªæ´—è½¦åº—ï¼Œä¸”ä¼šé€‰æ‹©è¿™äº›åº—ä¸­æœ€ä¾¿å®œçš„ä¸€ä¸ªè¿›è¡Œä¸€æ¬¡æ¶ˆè´¹ã€‚ä½†æ˜¯å¦‚æœè¿™ä¸ªæœ€ä¾¿å®œçš„ä»·æ ¼å¤§äº $c_i$ï¼Œé‚£ä¹ˆè¿™ä¸ªäººå°±ä¸æ´—è½¦äº†ã€‚\nè¯·ç»™æ¯å®¶åº—æŒ‡å®šä¸€ä¸ªä»·æ ¼ï¼Œä½¿å¾—æ‰€æœ‰äººèŠ±çš„é’±çš„æ€»å’Œæœ€å¤§ã€‚\né“¾æ¥ Luogu P3592\né¢˜è§£ é¦–å…ˆæˆ‘ä»¬å¯ä»¥æ˜æ˜¾çš„å‘ç°ä¸€ä¸ªç»“è®ºï¼šæ‰€æœ‰ $p_i$ éƒ½åªå¯èƒ½æ˜¯ç»™å®šçš„ $c_i$ ä¸­çš„æ•°ã€‚\næ‰€ä»¥æˆ‘ä»¬å¯ä»¥å…ˆå¯¹ $c_i$ ç¦»æ•£åŒ–ï¼Œè¿™æ ·æˆ‘ä»¬çš„ $c_i$ çš„èŒƒå›´å°±æ˜¯ $[1,4000]$ äº†ã€‚æˆ‘ä»¬åªè¦è®¡ç®—å‡ºæ¯ä¸ªäººä»¥å“ªä¸ª $c_i$ ä½œä¸ºæœ€å°å€¼ï¼Œä¸€æ ·å¯ä»¥æ±‚å¾—ç­”æ¡ˆã€‚\nå¦‚æœæˆ‘ä»¬çŸ¥é“ä¸€ä¸ªåŒºé—´çš„æœ€å°å€¼åœ¨ä»€ä¹ˆä½ç½®ï¼Œé‚£ä¹ˆæˆ‘ä»¬äº‹å®ä¸Šå¯ä»¥æŠŠæ‰€æœ‰ç»è¿‡è¿™ä¸ªç‚¹çš„äººçš„èŠ±è´¹ç›´æ¥è®¡ç®—ï¼Œå‰©ä¸‹çš„äººé€‰æ‹©çš„åŒºé—´ï¼ˆå‡è®¾æˆ‘ä»¬åªè€ƒè™‘è¢« $[l,r]$ åŒ…å«çš„çº¿æ®µ ï¼‰éƒ½ä¸ä¼šè·¨è¿‡ä¸­é—´çš„æœ€å°å€¼ï¼Œé‚£ä¹ˆå®Œå…¨å¯ä»¥é€’å½’å­é—®é¢˜è§£å†³ã€‚\næ‰€ä»¥æˆ‘ä»¬ $dp$ è§£å†³è¿™ä¸ªé—®é¢˜ã€‚\næˆ‘ä»¬è®¾ $f[i][j][k]$ è¡¨ç¤ºæ‰€æœ‰è¢« $[l,r]$ åŒ…å«çš„çº¿æ®µä¸­ï¼ŒåŒºé—´ä¸­å­˜åœ¨æœ€å°å€¼ä¸º $k$ ï¼ˆç¦»æ•£åŒ–åï¼‰çš„ç‚¹ã€‚\né‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æšä¸¾å€¼ä¸º $k$ çš„ç‚¹çš„å‡ºç°ä½ç½® $p$ ï¼Œå°±å¯ä»¥å¾—åˆ°ä»¥ä¸‹çš„æ–¹ç¨‹ï¼š\n$$\nf[l][r][k] = \\max_{p=l}^{r}(g[l][p-1][k] + g[p+1][r][k] + v[k] \\times c[p][k])\n$$\nå…¶ä¸­ï¼š\n$g[l][r][k] = \\max_{w = k}^{n} (f[l][r][w])$æ„ä¸ºè¿™ä¸ªåŒºé—´ä¸­æœ€å°å€¼å¤§äºç­‰äº $k$ çš„æƒ…å†µä¸‹ï¼Œæ”¶è´¹çš„æœ€å¤§å€¼ï¼›$c[p][k]$ æ„ä¸ºåœ¨æ‰€æœ‰è¢« $[l,r]$ åŒ…å«ä¸”ç©¿è¿‡ $p$ ä½ç½®è€Œä¸” $c_i \\geq k$ çš„çº¿æ®µçš„ä¸ªæ•°ï¼› $v[k]$ ä»£è¡¨ $k$ çš„çœŸå®å¤§å°ã€‚\næœ€åç­”æ¡ˆå³ä¸º $g[1][n][1]$ã€‚\nåˆ†æä¸‹å¤æ‚åº¦ï¼š\næšä¸¾åŒºé—´ $[l,r]$ ä¸º $O(n^2)$ ï¼Œå¯¹äºæ¯ä¸€ä¸ªåŒºé—´ï¼Œæˆ‘ä»¬è®¡ç®— $c[p][k]$ å¤æ‚åº¦ä¸º $O(nm)$ ï¼›æˆ‘ä»¬æšä¸¾æ–­ç‚¹ã€æœ€å°ä»·æ ¼çš„å¤æ‚åº¦ä¹Ÿæ˜¯ $O(nm)$ï¼›$g$ æ•°ç»„è®¡ç®—çš„å¤æ‚åº¦æ˜æ˜¾å¯ä»¥åœ¨ä¸€ä¸ªè¾ƒä½çš„å¤æ‚åº¦ä¸‹è¿›è¡Œï¼Œæœ€åçš„æ—¶é—´å¤æ‚åº¦å°±æ˜¯ $O(n^3m)$ï¼›ç©ºé—´å¤æ‚åº¦ $O(n^2m)$ ã€‚\nè®¡ç®—è·¯å¾„çš„æ—¶å€™ï¼Œæˆ‘ä»¬è®°å½•æ¯ä¸ª $f[l][r][k]$ å¯¹åº”çš„æœ€ä¼˜åˆ†å‰²ä½ç½® $p$ ä»¥åŠ $g[l][r][k]$ çš„æœ€ä¼˜æƒå€¼é€‰æ‹© $k$ ï¼Œå°±å¯ä»¥é€’å½’è®¡ç®—äº†ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;map\u0026gt;#include \u0026lt;unistd.h\u0026gt;#include \u0026lt;algorithm\u0026gt;using namespace std; const int MAXN = 60,MAXM = 4100; int n,m; int A[MAXM],B[MAXM],C[MAXM]; map\u0026lt;int,int\u0026gt; S;int val[MAXM],cnt; int f[MAXN][MAXN][MAXM],g[MAXN][MAXN][MAXM]; int pp[MAXN][MAXN][MAXM],gk[MAXN][MAXN][MAXM]; // pp è®°å½• f çš„ä½ç½®ï¼Œ gk è®°å½• g çš„æƒå€¼ï¼ˆè®°å½•è·¯å¾„ç”¨ï¼‰ int c[MAXN][MAXM]; void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m); for(int i = 1;i\u0026lt;=m;i++){ scanf(\u0026#34;%d %d %d\u0026#34;,\u0026amp;A[i],\u0026amp;B[i],\u0026amp;C[i]); S[C[i]] = 0; } for(map\u0026lt;int,int\u0026gt;::iterator it = S.begin();it != S.end();it++){ it-\u0026gt;second = ++cnt; val[cnt] = it-\u0026gt;first; } for(int i = 1;i\u0026lt;=m;i++){ C[i] = S[C[i]]; } } void solve(){ for(int len = 1;len\u0026lt;=n;len++){ for(int l = 1,r = len;r\u0026lt;=n;l++,r++){ //è®¡ç®—c  for(int pos = l;pos\u0026lt;=r;pos++){ for(int i = 1;i\u0026lt;=m;i++) c[pos][i] = 0; for(int s = 1;s\u0026lt;=m;s++){ if(l \u0026lt;= A[s] \u0026amp;\u0026amp; B[s] \u0026lt;= r \u0026amp;\u0026amp; A[s] \u0026lt;= pos \u0026amp;\u0026amp; pos \u0026lt;= B[s]){ c[pos][C[s]]++; } } for(int i = m;i\u0026gt;=1;i--) c[pos][i] += c[pos][i+1]; } // è½¬ç§» f ä»¥åŠ pp  for(int k = 1;k\u0026lt;=m;k++){ for(int p = l;p\u0026lt;=r;p++){ int t = g[l][p-1][k]+g[p+1][r][k]+val[k]*c[p][k]; if(t \u0026gt; f[l][r][k]) pp[l][r][k] = p; //æœ€ä¼˜çš„è½¬ç§»ä½ç½® p  f[l][r][k] = max(f[l][r][k],t); } g[l][r][k] = f[l][r][k]; } // è®¡ç®— k ä»¥åŠ gk  for(int k = m;k\u0026gt;=1;k--){ gk[l][r][k] = g[l][r][k] \u0026gt; g[l][r][k+1]?k:gk[l][r][k+1]; g[l][r][k] = max(g[l][r][k],g[l][r][k+1]); } } } printf(\u0026#34;%d\\n\u0026#34;,g[1][n][1]); } int ans[MAXN]; void output(int l,int r,int k){ if(l\u0026gt;r) return; if(g[l][r][k] == 0){ for(int i = l;i\u0026lt;=r;i++) ans[i] = val[cnt];// è¿™é‡Œè¦è®¾ç½®æˆæœ€å¤§å€¼  // å› ä¸ºè¿™ä¸ªåŒºé—´ä¸å­˜åœ¨å¯èƒ½çš„è´¡çŒ®ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±ç›´æ¥èµ‹æƒå€¼æœ€å¤§ï¼Œé˜²æ­¢å¯¹å…¶ä»–é€ æˆå½±å“  } else{ int _k = gk[l][r][k],_p = pp[l][r][_k]; ans[_p] = val[_k]; output(l,_p-1,_k),output(_p+1,r,_k); } } void output(){ output(1,n,1); for(int i = 1;i\u0026lt;=n;i++) printf(\u0026#34;%d \u0026#34;,ans[i]); printf(\u0026#34;\\n\u0026#34;); } int main(){ init(); solve(); output(); return 0; }   ","description":"","id":102,"section":"posts","tags":["åŠ¨æ€è§„åˆ’","åŒºé—´dp"],"title":"ã€ŒPOI2015ã€Myjnie-åŒºé—´dp","uri":"https://blog.chenqiqian.com/posts/poi2015-myjnie/"},{"content":"ä½³åª›å§å§è¿‡ç”Ÿæ—¥çš„æ—¶å€™ï¼Œå¥¹çš„å°ä¼™ä¼´ä»æŸå®ä¸Šä¹°äº†ä¸€ä¸ªæœ‰è¶£çš„ç©å…·é€ç»™ä»–ã€‚ç©å…·ä¸Šæœ‰ä¸€ä¸ªæ•°åˆ—ï¼Œæ•°åˆ—ä¸­æŸäº›é¡¹çš„å€¼å¯èƒ½ä¼šå˜åŒ–ï¼Œä½†åŒä¸€ä¸ªæ—¶åˆ»æœ€å¤šåªæœ‰ä¸€ä¸ªå€¼å‘ç”Ÿå˜åŒ–ã€‚\nç°åœ¨ä½³åª›å§å§å·²ç»ç ”ç©¶å‡ºäº†æ‰€æœ‰å˜åŒ–çš„å¯èƒ½æ€§ï¼Œå¥¹æƒ³è¯·æ•™ä½ ï¼Œèƒ½å¦é€‰å‡ºä¸€ä¸ªå­åºåˆ—ï¼Œä½¿å¾—åœ¨ä»»æ„ä¸€ç§å˜åŒ–ä¸­ï¼Œè¿™ä¸ªå­åºåˆ—éƒ½æ˜¯ä¸é™çš„ï¼Ÿè¯·ä½ å‘Šè¯‰å¥¹è¿™ä¸ªå­åºåˆ—çš„æœ€é•¿é•¿åº¦å³å¯ ã€‚\næ³¨æ„ï¼šæ¯ç§å˜åŒ–æœ€å¤šåªæœ‰ä¸€ä¸ªå€¼å‘ç”Ÿå˜åŒ–ã€‚\né“¾æ¥ Luogu P4093\né¢˜è§£ æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå¦‚æœ $x$ ä½ç½®çš„å˜åŒ–èƒ½å¤Ÿå½±å“åˆ°ç»è¿‡å®ƒçš„æœ€é•¿ä¸é™å­åºåˆ—ï¼Œé‚£ä¹ˆéœ€è¦å…³å¿ƒçš„åªæœ‰ä¸¤ä¸ªå€¼ï¼šè¯¥ç‚¹å¯èƒ½å˜åŒ–åˆ°çš„æœ€å°å€¼ $\\min_x$ ä¸å¯èƒ½å˜åŒ–åˆ°çš„æœ€å¤§å€¼ $\\max_x$ ã€‚æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦å­˜å‚¨æ¯ä¸ªä½ç½®çš„ $\\min_x$ å’Œ $\\max_x$ å³å¯ã€‚\nç„¶åæˆ‘ä»¬å‘ç°è¿™ä¸ªä¸œè¥¿å¯ä»¥ç”¨ $O(n^2)$ çš„æœ´ç´  $dp$ æ¥å®Œæˆå¯¹ $\\text{LIS}$ çš„è®¡ç®—ã€‚\næ–¹ç¨‹ä¸ºï¼ˆå…¶ä¸­ $a_0 = max_0 = min_0 = - \\inf$ï¼‰ï¼š\n$$\ndp[i] =\n\\left{\n\\begin{aligned}{}\n\u0026amp;0\u0026amp;,;\u0026amp;\\text{if } i = 0\\\n\u0026amp;\\max_{j=0}^{i-1}{(dp[j] + 1)}\u0026amp;,;\u0026amp; \\text{if } \\text{max}_j \\leq a_i \\text{ and } a_j \\leq \\text{min}_i\n\\end{aligned}\n\\right.\n$$\nå‘ç° $\\text{max}_j \\leq a_i$ ä¸” $a_j \\leq \\text{min}_i$ äº‹å®ä¸Šæ˜¯ä¸€ä¸ªäºŒç»´çš„ååºå…³ç³»ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨ $\\text{CDQ}$ åˆ†æ²»è®¡ç®—æ»¡è¶³è¯¥æ¡ä»¶çš„ $dp$ æœ€å¤§å€¼ã€‚\nä½†æ˜¯è¿™é‡Œæœ‰ä¸€ä¸ªä¸æ™®é€š $\\text{CDQ}$ ä¸ç›¸åŒçš„åœ°æ–¹ï¼Œæˆ‘ä»¬å¿…é¡»è¦è®¡ç®—å®Œåœ¨ $i$ å‰é¢çš„ $dp$ å€¼ï¼Œæ‰èƒ½å¼€å§‹è®¡ç®— $dp[i]$ã€‚\næ‰€ä»¥è¿™é‡Œçš„ $\\text{CDQ}$ åˆ†æ²»åº”å½“åšä¸€äº›å¾®å°çš„æ›´æ”¹ã€‚\næˆ‘ä»¬ä¸ç”¨å½’å¹¶å®Œæˆå¯¹ $2d$ çš„æ’åºï¼Œè€Œæ˜¯ç›´æ¥è°ƒç”¨ $sort$ ã€‚\nå¯¹äºåŒºé—´ $[l,r]$ ï¼Œæˆ‘ä»¬å…ˆé€’å½’å®Œæˆ $[l,mid]$ ï¼Œæ’åºç¬¬äºŒå…³é”®å­—åå¤„ç†å·¦åŠå¯¹å³åŠçš„è´¡çŒ®ï¼Œç„¶åé‡æ–°æŒ‰ç…§ç¬¬ä¸€å…³é”®å­—æ’åºåå†é€’å½’è§£å†³ $[mid+1,r]$ å­é—®é¢˜ã€‚\næœ€è¿‘ $\\text{CDQ}$ è€å†™é”™å­—æ¯emmm å¤§çº¦æ²¡æ•‘äº†\u0026hellip;\næ—¶é—´å¤æ‚åº¦ $O(n \\log ^2 n)$ ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135  // luogu-judger-enable-o2 #include \u0026lt;cstdio\u0026gt;#include \u0026lt;algorithm\u0026gt;#include \u0026lt;cstdio\u0026gt;#define inf 0x3f3f3f3f using namespace std; const int MAXN = 210000; struct T{ int id,op,a,b; T(){id=op=a=b=0;} T(int _id,int _op,int _a,int _b){ id = _id,op = _op,a = _a,b = _b; } // op = 1 -\u0026gt; (max_j,a_j) ä¿®æ”¹  // op = 2 -\u0026gt; (a_i,min_i) æŸ¥è¯¢ }q[MAXN];int tot; struct BIT{ int maxn[MAXN]; int lowbit(int x){ return x \u0026amp; (-x); } void update(int x,int v){ while(x \u0026lt;= 100000){ maxn[x] = max(maxn[x],v); x += lowbit(x); } } int query(int x){ int ans = 0; while(x \u0026gt;= 1){ ans = max(ans,maxn[x]); x -= lowbit(x); } return ans; } void clear(int x){ while(x \u0026lt;= 100000){ if(maxn[x] == 0) break; maxn[x] = 0; x += lowbit(x); } } }S; int n,m; int dp[MAXN]; int num[MAXN],maxn[MAXN],minn[MAXN]; void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m); for(int i = 1;i\u0026lt;=n;i++){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;num[i]); maxn[i] = minn[i] = num[i]; } for(int i = 1;i\u0026lt;=m;i++){ int x,v; scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;x,\u0026amp;v); minn[x] = min(minn[x],v); maxn[x] = max(maxn[x],v); } q[++tot] = T(0,1,-inf,1); for(int i = 1;i\u0026lt;=n;i++){ q[++tot] = T(i,2,num[i],minn[i]); q[++tot] = T(i,1,maxn[i],num[i]); } } bool cmp1d(int x,int y){ if(q[x].a != q[y].a){ return q[x].a \u0026lt; q[y].a; } else{ return q[x].id \u0026lt; q[y].id; } } bool cmpid(int x,int y){ if(q[x].id != q[y].id){ return q[x].id \u0026lt; q[y].id; } else{ return q[x].op \u0026gt; q[y].op; } } int cdq[MAXN]; int tmp1d[MAXN]; void CDQ(int *w,int l,int r){ #define ql q[w[L]]  #define qr q[w[R]]  if(l == r) return; int mid = (l+r)\u0026gt;\u0026gt;1; CDQ(w,l,mid); sort(w+l,w+mid+1,cmp1d),sort(w+mid+1,w+r+1,cmp1d); int L = l,R = mid+1,c = l; while(c \u0026lt;= r){ if(R \u0026gt; r ||(L \u0026lt;= mid \u0026amp;\u0026amp; ql.a \u0026lt;= qr.a)){ if(ql.op == 1) S.update(ql.b,dp[ql.id]); tmp1d[c++] = L++; } else{ if(qr.op == 2){ //printf(\u0026#34;%d qr.id:%d\\n\u0026#34;,w[R],qr.id);  int t = S.query(qr.b); dp[qr.id] = max(dp[qr.id],t+1); } tmp1d[c++] = R++; } } for(int i = l;i\u0026lt;=mid;i++) S.clear(q[w[i]].b); sort(w+l,w+r+1,cmpid); CDQ(w,mid+1,r); #undef ql  #undef qr } void solve(){ for(int i = 1;i\u0026lt;=tot;i++) cdq[i] = i; CDQ(cdq,1,tot); int ans = 0; for(int i = 1;i\u0026lt;=n;i++){ ans = max(ans,dp[i]); } printf(\u0026#34;%d\\n\u0026#34;,ans); } int main(){ init(); solve(); return 0; }   ","description":"","id":103,"section":"posts","tags":["CDQåˆ†æ²»","åŠ¨æ€è§„åˆ’"],"title":"ã€ŒHEOI2016/TJOI2016ã€åºåˆ—-CDQåˆ†æ²»ä¼˜åŒ–dp","uri":"https://blog.chenqiqian.com/posts/heoi2016-tjoi2016-sequence/"},{"content":"æŸå›½ä¸ºäº†é˜²å¾¡æ•Œå›½çš„å¯¼å¼¹è¢­å‡»ï¼Œå‘å±•å‡ºä¸€ç§å¯¼å¼¹æ‹¦æˆªç³»ç»Ÿã€‚ä½†æ˜¯è¿™ç§å¯¼å¼¹æ‹¦æˆªç³»ç»Ÿæœ‰ä¸€ä¸ªç¼ºé™·ï¼šè™½ç„¶å®ƒçš„ç¬¬ä¸€å‘ç‚®å¼¹èƒ½å¤Ÿåˆ°è¾¾ä»»æ„çš„é«˜åº¦ã€å¹¶ä¸”èƒ½å¤Ÿæ‹¦æˆªä»»æ„é€Ÿåº¦çš„å¯¼å¼¹ï¼Œä½†æ˜¯ä»¥åæ¯ä¸€å‘ç‚®å¼¹éƒ½ä¸èƒ½é«˜äºå‰ä¸€å‘çš„é«˜åº¦ï¼Œå…¶æ‹¦æˆªçš„å¯¼å¼¹çš„é£è¡Œé€Ÿåº¦ä¹Ÿä¸èƒ½å¤§äºå‰ä¸€å‘ã€‚æŸå¤©ï¼Œé›·è¾¾æ•æ‰åˆ°æ•Œå›½çš„å¯¼å¼¹æ¥è¢­ã€‚ç”±äºè¯¥ç³»ç»Ÿè¿˜åœ¨è¯•ç”¨é˜¶æ®µï¼Œæ‰€ä»¥åªæœ‰ä¸€å¥—ç³»ç»Ÿï¼Œå› æ­¤æœ‰å¯èƒ½ä¸èƒ½æ‹¦æˆªæ‰€æœ‰çš„å¯¼å¼¹ã€‚\nåœ¨ä¸èƒ½æ‹¦æˆªæ‰€æœ‰çš„å¯¼å¼¹çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å½“ç„¶è¦é€‰æ‹©ä½¿å›½å®¶æŸå¤±æœ€å°ã€ä¹Ÿå°±æ˜¯æ‹¦æˆªå¯¼å¼¹çš„æ•°é‡æœ€å¤šçš„æ–¹æ¡ˆã€‚ä½†æ˜¯æ‹¦æˆªå¯¼å¼¹æ•°é‡çš„æœ€å¤šçš„æ–¹æ¡ˆæœ‰å¯èƒ½æœ‰å¤šä¸ªï¼Œå¦‚æœæœ‰å¤šä¸ªæœ€ä¼˜æ–¹æ¡ˆï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¼šéšæœºé€‰å–ä¸€ä¸ªä½œä¸ºæœ€ç»ˆçš„æ‹¦æˆªå¯¼å¼¹è¡ŒåŠ¨è“å›¾ã€‚\næˆ‘æ–¹é—´è°å·²ç»è·å–äº†æ‰€æœ‰æ•Œå†›å¯¼å¼¹çš„é«˜åº¦å’Œé€Ÿåº¦ï¼Œä½ çš„ä»»åŠ¡æ˜¯è®¡ç®—å‡ºåœ¨æ‰§è¡Œä¸Šè¿°å†³ç­–æ—¶ï¼Œæ¯æšå¯¼å¼¹è¢«æ‹¦æˆªæ‰çš„æ¦‚ç‡ã€‚\né“¾æ¥ Luogu P2487\né¢˜è§£ â€‹ $\\text{CDQ}$ åˆ†æ²»ä¼˜åŒ– $dp$â€‹ ã€‚\nè¿™æ˜¯ä¸€ä¸ªä¸‰ç»´ååºé—®é¢˜ã€‚\nå¦‚æœæˆ‘ä»¬ä»¤ $a_i$ ä¸ºç¬¬ $i$ ä¸ªå¯¼å¼¹çš„é«˜åº¦ï¼Œ $b_i$ ä¸ºç¬¬ $i$ ä¸ªå¯¼å¼¹çš„é€Ÿåº¦ï¼Œ$dp[i]$ ä¸ºä»¥ç¬¬ $i$ ä¸ªç»“å°¾çš„å¯¼å¼¹èƒ½æ‹¦æˆªçš„æœ€å¤§æ•°é‡ï¼Œ $sum[i]$ ä¸ºä»¥ç¬¬ $i$ ä¸ªå¯¼å¼¹ä¸ºç»“å°¾èƒ½å¤Ÿæ‹¦æˆªæœ€å¤§å¯¼å¼¹æ•°çš„æ–¹æ¡ˆæ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬æœ‰å¦‚ä¸‹çš„è½¬ç§»ï¼š\n$$\ndp[i] =\n\\left{\n\\begin{aligned}{}\n\u0026amp;0\u0026amp;,;\u0026amp;\\text{if } i = 0\\\n\u0026amp;\\max_{j=0}^{i-1}{(dp[j] + 1)}\u0026amp;,;\u0026amp; \\text{if } a_j \\geq a_i \\text{ and } b_j \\geq b_i\n\\end{aligned}\n\\right.\n$$\n$$\nsum[i] =\n\\left{\n\\begin{aligned}{}\n\u0026amp;1\u0026amp;,;\u0026amp;\\text{if } i = 0\\\n\u0026amp;\\sum_{j=0}^{i-1}{sum[j]}\u0026amp;,;\u0026amp; \\text{if } a_j \\geq a_i \\text{ and } b_j \\geq b_i \\text{ and }dp[j] = dp[i]-1\n\\end{aligned}\n\\right.\n$$\næˆ‘ä»¬è®¾ $M = \\max_{i=1}^n dp[i]$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è®¡ç®—å‡ºæ‰€æœ‰çš„é•¿åº¦ä¸ºæœ€é•¿å€¼çš„åºåˆ—çš„ä¸ªæ•°ï¼Œå°±æ˜¯ï¼š\n$$\ntot = \\sum_{i=1}^{n} [dp[i] = M] \\times sum[i]\n$$\nç„¶åæˆ‘ä»¬åªè¦è®¡ç®—å‡ºæ¯ä¸ªç‚¹ç»è¿‡çš„è·¯å¾„æ¡æ•°å°±å¯ä»¥äº†ã€‚\nå¯¹äº $sum[i]$ ï¼Œå…¶å®æˆ‘ä»¬å¯ä»¥åœ¨ $\\text{CDQ}$ åˆ†æ²»çš„é€”ä¸­ä¸€å¹¶è®¡ç®—ã€‚\næ³¨æ„åˆ°ï¼Œæ¯ä¸ªä½ç½®ä¸Šæˆ‘äº‹å®ä¸Šéƒ½ç»´æŠ¤äº†ä¸€ä¸ªæœ€å¤§å€¼ï¼Œå®ƒæ ‡è®°ç€ä» $ï¼ˆi-\\text{lowbit}(i),i]$ çš„æœ€å¤§å€¼ï¼Œæˆ‘ä»¬åœ¨åŒæ ·çš„ä½ç½®ç»´æŠ¤ä¸€ä¸ª $sum$ å³å¯ã€‚\næˆ‘ä»¬æŠŠæ•°å­—å–åï¼Œæ•°ç»„ç¿»è½¬ï¼Œå†åšä¸€é $\\text{CDQ}$ åˆ†æ²»ï¼Œç„¶åå¾—åˆ°çš„ä¸¤ä¸ªå¯¹åº”ä½ç½®ä¸Šï¼Œå¦‚æœæœ‰ $dp1[i] + dp2[i] - 1 = M$ ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ $path[i] = sum1[i] \\times sum2[i]$ ï¼Œå¦åˆ™å°±æ˜¯ $0$ã€‚\næ³¨æ„è¿™é¢˜è¦ç¦»æ•£åŒ–ã€‚\nè¿™é“é¢˜å¾—åˆ°çš„å¯ç¤ºï¼š\næˆ‘ä»¬æœ‰çš„æ—¶å€™è®¡ç®—ç»è¿‡æŸç‚¹çš„è·¯å¾„å¯ä»¥æŒ‰ç…§è¯¥ç‚¹åˆ†åˆ«è®¡ç®—ä¸¤ä¸ªè·¯å¾„ç„¶åä¹˜æ³•åŸç†ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cstring\u0026gt;#include \u0026lt;algorithm\u0026gt;#include \u0026lt;map\u0026gt;using namespace std; const int MAXN = 100000; struct T{ int a,b; }q[MAXN]; int cnt = 0; int n; struct BIT{ int maxn[MAXN];double sumn[MAXN]; int lowbit(int x){ return x \u0026amp; (-x); } void update(int x,int mx,double g){ while(x \u0026lt;= n){ if(maxn[x] == mx) sumn[x] += g; else if(mx \u0026gt; maxn[x]) sumn[x] = g; maxn[x] = max(maxn[x],mx); x += lowbit(x); } } void query(int x,int \u0026amp;mx,double \u0026amp;s){ mx = s = 0; while(x \u0026gt;= 1){ if(maxn[x] == mx) s += sumn[x]; else if(maxn[x] \u0026gt; mx) s = sumn[x]; mx = max(mx,maxn[x]); x -= lowbit(x); } } void clear(int x){ while(x \u0026lt;= n){ maxn[x] = 0,sumn[x] = 0; x += lowbit(x); } } }T; int nowa[MAXN],nowb[MAXN]; map\u0026lt;int,int\u0026gt; A,B; void init(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n); for(int i = 1;i\u0026lt;=n;i++){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;q[i].a,\u0026amp;q[i].b); A[q[i].a] = 0; B[q[i].b] = 0; } for(map\u0026lt;int,int\u0026gt;::iterator it = A.begin();it!=A.end();it++) it-\u0026gt;second = ++cnt; cnt = 0; for(map\u0026lt;int,int\u0026gt;::iterator it = B.begin();it!=B.end();it++) it-\u0026gt;second = ++cnt; for(int i = 1;i\u0026lt;=n;i++){ q[i].a = n-A[q[i].a]+1; q[i].b = n-B[q[i].b]+1; } } bool cmpa(int x,int y){return nowa[x] \u0026lt; nowa[y];} bool cmpid(int x,int y){return x \u0026lt; y;} int cdq[MAXN]; int tmp1d[MAXN]; int dp[MAXN];double sum[MAXN]; int dp1[MAXN],dp2[MAXN],mx; double ans1[MAXN],ans2[MAXN],tot; void CDQ1d(int *w,int l,int r){ if(l == r) return; int mid = (l+r)\u0026gt;\u0026gt;1; CDQ1d(w,l,mid); sort(w+l,w+mid+1,cmpa),sort(w+mid+1,w+r+1,cmpa); int L = l,R = mid+1,c = l; while(c \u0026lt;= r){ if(R \u0026gt; r || (L \u0026lt;= mid \u0026amp;\u0026amp; nowa[w[L]] \u0026lt;= nowa[w[R]])){ T.update(nowb[w[L]],dp[w[L]],sum[w[L]]); c++;L++; } else{ int mx = 0;double g = 0; T.query(nowb[w[R]],mx,g); mx++; if(mx == dp[w[R]]) sum[w[R]] += g; else if(mx \u0026gt; dp[w[R]]) sum[w[R]] = g; dp[w[R]] = max(mx,dp[w[R]]); sum[w[R]] = max(1.0,sum[w[R]]); c++;R++; } } for(int i = l;i\u0026lt;=mid;i++) T.clear(nowb[w[i]]); sort(w+l,w+r+1,cmpid); CDQ1d(w,mid+1,r); } void solve(){ memset(dp,0,sizeof(dp)),memset(sum,0,sizeof(sum)); dp[1] = 1,sum[1] = 1; for(int i = 1;i\u0026lt;=n;i++) cdq[i] = i,nowa[i] = q[i].a,nowb[i] = q[i].b; CDQ1d(cdq,1,n); for(int i = 1;i\u0026lt;=n;i++) mx = max(mx,dp[i]); for(int i = 1;i\u0026lt;=n;i++){ if(dp[i] == mx) tot += sum[i]; dp1[i] = dp[i]; ans1[i] = sum[i]; } memset(dp,0,sizeof(dp)),memset(sum,0,sizeof(sum)); dp[1] = 1,sum[1] = 1; for(int i = 1;i\u0026lt;=n;i++) cdq[i] = i,nowa[i] = n - q[n-i+1].a + 1,nowb[i] = n - q[n-i+1].b + 1; CDQ1d(cdq,1,n); for(int i = 1;i\u0026lt;=n;i++){ dp2[i] = dp[n-i+1]; ans2[i] = sum[n-i+1]; } printf(\u0026#34;%d\\n\u0026#34;,mx); for(int i = 1;i\u0026lt;=n;i++){ if(dp1[i] + dp2[i] - 1 == mx) printf(\u0026#34;%.10lf \u0026#34;,double(ans1[i]) * ans2[i] / tot); else printf(\u0026#34;%.10lf \u0026#34;,0.0); } printf(\u0026#34;\\n\u0026#34;); } int main(){ init(); solve(); return 0; }   ","description":"","id":104,"section":"posts","tags":["CDQåˆ†æ²»","æ ‘çŠ¶æ•°ç»„","åŠ¨æ€è§„åˆ’"],"title":"ã€ŒSDOI2011ã€æ‹¦æˆªå¯¼å¼¹-CDQåˆ†æ²»ä¼˜åŒ–dp","uri":"https://blog.chenqiqian.com/posts/sdoi2011-missile/"},{"content":"åœ¨å®šä½ç³»ç»Ÿä¸­ï¼Œä¸–ç•Œè¢«è®¤ä¸ºæ˜¯ä¸€ä¸ª $W \\times W$ çš„æ­£æ–¹å½¢åŒºåŸŸï¼Œç”± $1 \\times 1$ çš„æ–¹æ ¼ç»„æˆã€‚æ¯ä¸ªæ–¹æ ¼éƒ½æœ‰ä¸€ä¸ªåæ ‡ $(x,y)$ ï¼Œ $1 \\leq x,y \\leq W$ã€‚\næœ‰ä¸‰ç§å‘½ä»¤ï¼Œæ„ä¹‰å¦‚ä¸‹ï¼š\n 0 W åˆå§‹åŒ–ä¸€ä¸ªå…¨é›¶çŸ©é˜µã€‚æœ¬å‘½ä»¤ä»…å¼€å§‹æ—¶å‡ºç°ä¸€æ¬¡ã€‚ 1 x y A å‘æ–¹æ ¼ $(x,y)$ ä¸­æ·»åŠ Aä¸ªç”¨æˆ·ã€‚Aæ˜¯æ­£æ•´æ•°ã€‚ 2 X1 Y1 X2 Y2 æŸ¥è¯¢ $X1 \\leq x \\leq X_2$ ï¼Œ $Y_1 \\leq y \\leq Y_2$ æ‰€è§„å®šçš„çŸ©å½¢ä¸­çš„ç”¨æˆ·æ•°é‡ 3 æ— å‚æ•° ç»“æŸç¨‹åºã€‚æœ¬å‘½ä»¤ä»…ç»“æŸæ—¶å‡ºç°ä¸€æ¬¡ã€‚  é“¾æ¥ Luogu P4390\né¢˜è§£ äºŒç»´åŠ¨æ€æ•°ç‚¹é—®é¢˜ã€‚\næœ‰å¾ˆå¤šç§è§£æ³•ï¼Œæ ‘å¥—æ ‘ï¼Œ$\\text{CDQ}$ åˆ†æ²» + æ ‘çŠ¶æ•°ç»„ï¼Œ$\\text{CDQ}$ åˆ†æ²»å¥— $\\text{CDQ}$ åˆ†æ²»ã€‚\nè¿™é‡Œé€‰æ‹©äº†æœ€åä¸€ç§æ–¹æ³•ï¼Œç»ƒä¹ ä¸€ä¸‹ $\\text{CDQ}$ åˆ†æ²»ã€‚\né¦–å…ˆè¦æ˜ç¡®ï¼Œç¬¬ $x$ ä¸ªç»´åº¦çš„ $\\text{CDQ}$ åˆ†æ²»è§£å†³çš„æ˜¯æ‰€æœ‰åœ¨å‰ $x-1$ æ¬¡åˆ†æ²»ä¸­åˆ’åˆ†çš„ï¼ˆå·¦/å³ï¼‰éƒ½ç›¸åŒçš„è¯¢é—®ä¸­ï¼Œå·¦-\u0026gt;å³çš„è´¡çŒ®ã€‚\nåœ¨è¿™é‡Œå™è¿°ä¸€ä¸‹ $\\text{CDQ}$ å¥— $\\text{CDQ}$ è§£å†³ä¸‰ç»´ååºé—®é¢˜ï¼ˆä¹Ÿå¯ä»¥æ¨å¹¿åˆ°æ›´é«˜ç»´çš„ä¸€ä¸ªè¿‡ç¨‹ï¼‰ï¼š\nä»¥ä¸‰ç»´ååºä¸ºä¾‹å­ï¼Œæˆ‘ä»¬çš„ä¸‰å…ƒç»„ä»¤å…¶ä¸º $(a,b,c)$ ã€‚\né¢„å¤„ç†ï¼ˆç›¸å½“äºæ¶ˆæ‰ä¸€ä¸ªç»´åº¦ï¼‰ï¼š\n å¯¹ç¬¬ä¸€ç»´ $a$ è¿›è¡Œæ’åº  å¯¹ç¬¬ä¸€ç»´åˆ†æ²» CDQ1d(L,R)ï¼š\nå¯¹ç¬¬ä¸€ç»´ $a$ è¿›è¡Œåˆ†æ²»ï¼Œé€’å½’å¤„ç† CDQ1d(L,mid) å’Œ CDQ1d(mid,R) æŒ‰ç¬¬äºŒç»´ $b$ è¿›è¡Œå½’å¹¶ï¼Œæ­¤æ—¶ä¸è®¡ç®—ç­”æ¡ˆï¼Œåªè®°å½•åœ¨è¿™æ¬¡åˆ†æ²»ä¸­ï¼Œè¯¥è¯¢é—®/ä¿®æ”¹å±äºå·¦åŠåŒºé—´ $\\text{LEFT}$ æˆ–è€… å³åŠåŒºé—´ $\\text{RIGHT}$ ã€‚ å¤åˆ¶ä¸€ä»½å½’å¹¶åçš„è¯¥åŒºé—´ $[l,r]$ çš„è¯¢é—®æ•°ç»„ï¼Œç”¨å…¶è¿›è¡Œç¬¬äºŒç»´çš„åˆ†æ²»ã€‚  å¯¹ç¬¬äºŒç»´åˆ†æ²» CDQ2d(L,R)ï¼š\nå¯¹ç¬¬äºŒç»´ $b$ è¿›è¡Œåˆ†æ²»ï¼Œé€’å½’å¤„ç† CDQ2d(L,mid) å’Œ CDQ2d(mid,R) æŒ‰ç¬¬ä¸‰ç»´ $c$ è¿›è¡Œå½’å¹¶ï¼Œæ­¤æ—¶éœ€è¦è®¡ç®—ç­”æ¡ˆï¼Œè®°å½•ä¸€ä¸ªä¸´æ—¶å˜é‡ $\\text{tmp}$ ï¼ˆæ ‘çŠ¶æ•°ç»„ï¼‰ã€‚å¦‚æœå½’å¹¶å·¦ä¾§æ–°åŠ å…¥çš„æŸ¥è¯¢/ä¿®æ”¹åœ¨ä¹‹å‰ç»´åº¦çš„åˆ†æ²»ä¸­å‡å±äºå·¦åŠåŒºé—´ $\\text{LEFT}$ ï¼Œåˆ™ç»™ $\\text{tmp}$ ï¼ˆæ ‘çŠ¶æ•°ç»„ï¼‰åšå¯¹åº”çš„ä¿®æ”¹ï¼› å¦‚æœå½’å¹¶å³ä¾§æ–°åŠ å…¥çš„æŸ¥è¯¢/ä¿®æ”¹åœ¨ä¹‹å‰ç»´åº¦çš„åˆ†æ²»ä¸­å‡å±äºå³åŠåŒºé—´ $\\text{RIGHT}$ ï¼Œåˆ™è®¡ç®—ç›¸å…³è´¡çŒ®ã€‚  å¯ä»¥å‘ç°ï¼Œè¿™ä¸ªé€’å½’æ˜¯å¯ä»¥å†æ¬¡åµŒå¥—çš„ï¼Œåªæœ‰æœ€å¤–é¢ä¸€ç»´æ˜¯éœ€è¦è®¡ç®—è´¡çŒ®çš„ï¼Œå‰é¢åªè¦è®°å½•æ¯ä¸€ç»´çš„ $\\text{LEFT}$ æˆ– $\\text{RIGHT}$ï¼Œåœ¨æœ€åè®¡ç®—å³å¯ã€‚\näº‹å®ä¸Šï¼Œæˆ‘ä»¬åœ¨æœ€åä¸€å±‚é€’å½’éœ€è¦è®¡ç®—çš„åªæœ‰ $(\\text{LEFT},\u0026hellip;,\\text{LEFT},x_1)$ å¯¹ $(\\text{RIGHT},..,\\text{RIGHT},x_2)$ çš„è´¡çŒ®ã€‚\nä¸ºä»€ä¹ˆè¿™æ ·å°±å¯ä»¥è®¡ç®—å®Œå…¨å‘¢ï¼Ÿ\næˆ‘ä»¬è€ƒè™‘åˆ°ï¼Œå¦‚æœåœ¨å‰ $x-1$ ä¸ªç»´åº¦å…¶æœ‰ä»»æ„ä¸€ä¸ªç»´åº¦è¢«åˆ’åˆ†åˆ°äº†ä¸€ä¸ªåŒºé—´ï¼Œé‚£ä¹ˆä»–ä»¬å°±ä¼šå…±åŒè¿›å…¥ä¸€æ¬¡åˆ†æ²»ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªè¯¢é—®/æŸ¥è¯¢ä¹‹é—´çš„å½±å“å°±ä¼šåœ¨å­é—®é¢˜é‡Œé¢è¢«è§£å†³ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™æ ·åšçš„æ­£ç¡®æ€§æ˜¯å¯ä»¥ä¿è¯çš„ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104  #include \u0026lt;cstdio\u0026gt;using namespace std; const int MAXN = 300000; int n,qaq; struct T{ int id,op,a,b,add,ans,part; //add = 1/-1  T(){ id = op = a = b = add = ans = part = 0; } T(int _id,int _op,int _a,int _b,int _add,int _ans = 0,int _p = 0){ id = _id,op = _op,a = _a,b = _b,add = _add,ans = _ans,part = _p; } }t[MAXN];int tot; int ans[MAXN],vis[MAXN]; int cdq[MAXN],tmp1d[MAXN],tmp2d[MAXN]; const int LEFT = 0,RIGHT = 1; void CDQ2d(int *w,int l,int r){//å¯¹ç¬¬äºŒç»´(a) åˆ†æ²»ï¼Œå¯¹ç¬¬ä¸‰ç»´ (b) åˆå¹¶  // è¿™é‡Œç»™å‡ºåºåˆ— w çš„æ—¶å€™åº”è¯¥å…¶ç¬¬ä¸€ç»´åæ ‡ (a) å·²ç»æœ‰åº  if(l == r) return; int mid = (l+r)\u0026gt;\u0026gt;1; CDQ2d(w,l,mid),CDQ2d(w,mid+1,r);//é€’å½’è§£å†³å­é—®é¢˜  int L = l,R = mid+1,c = l;//ç°åœ¨å·¦è¾¹ç¬¬äºŒç»´å…¨éƒ¨å°äºå³è¾¹  int tmp = 0; // è·¨è¶Šç»´åº¦çš„åˆ†æ²»åªéœ€è¦è€ƒè™‘ (L,b1) å¯¹ (R,b2) çš„å½±å“ï¼Œå‰©ä½™çš„åœ¨1dçš„åˆ†æ²»é‡Œé¢å·²ç»è§£å†³  // æ›´é«˜ç»´åº¦çš„åˆ†æ²»åŒç†ï¼Œåªéœ€è¦è€ƒè™‘ (L,...,L,b1) å¯¹ (R,...,R,b2) çš„å½±å“ï¼›  // ç¬¬ä¸€ç»´ç›¸åŒçš„åœ¨ 1d é‡Œé¢è§£å†³ï¼Œç¬¬äºŒç»´ç›¸åŒçš„åœ¨ 2d é‡Œé¢è§£å†³  while(c \u0026lt;= r){// å¯¹ç¬¬ä¸‰ç»´åº¦è¿›è¡Œå½’å¹¶æ’åº  if(R \u0026gt; r || (L\u0026lt;=mid \u0026amp;\u0026amp; t[w[L]].b \u0026lt;= t[w[R]].b)){ if(t[w[L]].part == LEFT \u0026amp;\u0026amp; t[w[L]].op == 1) tmp += t[w[L]].add; tmp2d[c++] = w[L++]; } else{ if(t[w[R]].part == RIGHT \u0026amp;\u0026amp; t[w[R]].op == 2) t[w[R]].ans += tmp; tmp2d[c++] = w[R++]; } } for(int i = l;i\u0026lt;=r;i++) w[i] = tmp2d[i]; } void CDQ1d(int *w,int l,int r){//å¯¹ç¬¬ä¸€ç»´ï¼ˆéšå»ï¼‰åˆ†æ²»ï¼Œå¯¹ç¬¬äºŒç»´åˆå¹¶  if(l == r) return; int mid = (l+r)\u0026gt;\u0026gt;1; CDQ1d(w,l,mid),CDQ1d(w,mid+1,r);// é€’å½’è§£å†³å­é—®é¢˜  int L = l,R = mid+1,c = l; while(c \u0026lt;= r){ if(R \u0026gt; r || (L \u0026lt;= mid \u0026amp;\u0026amp; t[w[L]].a \u0026lt;= t[w[R]].a))// å¯¹ç¬¬äºŒç»´è¿›è¡Œå½’å¹¶  t[w[L]].part = LEFT,tmp1d[c++] = w[L++]; else t[w[R]].part = RIGHT,tmp1d[c++] = w[R++]; } for(int i = l;i\u0026lt;=r;i++) w[i] = tmp1d[i];// tmp1dç›¸å½“äºå¤åˆ¶çš„ä¸€ä»½  CDQ2d(tmp1d,l,r); } void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;qaq,\u0026amp;n); for(int i = 1;;i++){ int op,x,y,x1,y1,v; scanf(\u0026#34;%d\u0026#34;,\u0026amp;op); if(op == 3){break;} if(op == 1){ scanf(\u0026#34;%d %d %d\u0026#34;,\u0026amp;x,\u0026amp;y,\u0026amp;v); t[++tot] = T(i,1,x,y,v); } else if(op == 2){ vis[i] = 1; scanf(\u0026#34;%d %d %d %d\u0026#34;,\u0026amp;x,\u0026amp;y,\u0026amp;x1,\u0026amp;y1); t[++tot] = T(i,2,x-1,y-1,1); t[++tot] = T(i,2,x-1,y1,-1); t[++tot] = T(i,2,x1,y-1,-1); t[++tot] = T(i,2,x1,y1,1); } else{return;} } } void solve(){ for(int i = 1;i\u0026lt;=tot;i++){ cdq[i] = i; } CDQ1d(cdq,1,tot); for(int i = 1;i\u0026lt;=tot;i++){ if(vis[t[i].id]) ans[t[i].id] += t[i].add * t[i].ans; } for(int i = 1;i\u0026lt;=tot;i++){ if(vis[i]){ printf(\u0026#34;%d\\n\u0026#34;,ans[i]); } } } int main(){ init(); solve(); return 0; }   ","description":"","id":105,"section":"posts","tags":["CDQåˆ†æ²»","æ•°æ®ç»“æ„"],"title":"ã€ŒBOI2007ã€Mokia-CDQåˆ†æ²»å¥—CDQåˆ†æ²»","uri":"https://blog.chenqiqian.com/posts/boi2007-mokia/"},{"content":"ç»™å®šäº†ä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„æ•°åˆ—å’Œ $m$ ä¸ªè¯¢é—®ã€‚\næ¯ä¸ªè¯¢é—®ç»™å®šæ•°åˆ—çš„ä¸€ä¸ªåŒºé—´ $[l,r]$ ï¼Œä½ è¦å›ç­”ä¸¤ä¸ªé—®é¢˜ï¼š\n è¯¥åŒºé—´å†…å¤§äºç­‰äº $a$ ï¼Œå°äºç­‰äº $b$ çš„æ•°çš„ä¸ªæ•°ï¼Œ æ‰€æœ‰å¤§äºç­‰äº $a$ ï¼Œå°äºç­‰äº $b$ çš„ï¼Œä¸”åœ¨è¯¥åŒºé—´ä¸­å‡ºç°è¿‡çš„æ•°å€¼çš„ä¸ªæ•°ã€‚  é“¾æ¥ Luogu P4396\né¢˜è§£ æ¥è¿‘è«é˜Ÿæ¨¡ç‰ˆé¢˜\u0026hellip;\nè¿™ä¸ªé¢˜çš„å…³é”®åœ¨äºï¼Œä½ ç»´æŠ¤æ¯ä¸€ä¸ªæ•°å‡ºç°çš„ $times[i]$ å’Œæ˜¯å¦å‡ºç° $vis[i]$ éƒ½å¯ä»¥åšåˆ° $O(1)$ æ›´æ–°ï¼Œä½†æ˜¯è¿™ä¸ªæ—¶å€™ä½ è¦ $O(1)$ æŸ¥è¯¢è¿™ä¸¤ä¸ªçš„æ•°åˆ—çš„ $[a,b]$ åŒºé—´å†…çš„å’Œå°±æ¯”è¾ƒå›°éš¾ã€‚\næˆ‘ä»¬æƒ³åˆ°å¯ä»¥ç”¨æ ‘çŠ¶æ•°ç»„æ¥ç»´æŠ¤ï¼Œä½†æ˜¯è¿™æ ·çš„è¯ $O( (n+m) \\sqrt n \\log n)$ çš„å¤æ‚åº¦æœ‰ç‚¹è™š\u0026hellip;\næ³¨æ„åˆ°æˆ‘ä»¬æ€»å…±æœ‰ $O((n+m) \\sqrt n)$ æ¬¡ä¿®æ”¹ï¼Œä½†åªæœ‰ $O(m)$ æ¬¡æŸ¥è¯¢ï¼Œæ‰€ä»¥æˆ‘ä»¬å¦‚æœç»´æŠ¤ä¸€ä¸ªæ”¯æŒ $O(1)$ å•ç‚¹ä¿®æ”¹ï¼Œ $O(1)$ å•ç‚¹æ±‚å’Œï¼Œ $O(\\sqrt n)$ åŒºé—´æ±‚å’Œçš„å€¼åŸŸåˆ†å—ï¼Œé‚£ä¹ˆå¤æ‚åº¦å°±é™åˆ° $O((n+m) \\sqrt n)$ ï¼Œå……åˆ†å¯è¿‡ã€‚\næ³¨æ„éœ€è¦ç¦»æ•£åŒ–ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cmath\u0026gt;#include \u0026lt;cstring\u0026gt;#include \u0026lt;algorithm\u0026gt;#include \u0026lt;map\u0026gt;using namespace std; const int MAXN = 110000,MAXQ = 4000; struct FQ{ int num[MAXN],sumn[MAXQ],n,Q; int block[MAXN],lb[MAXQ],rb[MAXQ]; void init(int _n){ memset(num,0,sizeof(num)); memset(block,0,sizeof(block)); memset(lb,0,sizeof(lb)); memset(rb,0,sizeof(rb)); memset(sumn,0,sizeof(sumn)); n = _n,Q = sqrt(n)+1; for(int i = 1;i\u0026lt;=n;i++){ block[i] = (i/Q)+1; if(block[i] != block[i-1]){ lb[block[i]] = i; rb[block[i-1]] = i-1; } } rb[block[n]] = n; } void build(int n,int *_num = NULL){ init(n); if(_num){ for(int i = 1;i\u0026lt;=n;i++){ num[i] = _num[i]; sumn[block[i]] += num[i]; } } } void update(int pos,int v){ num[pos] += v; sumn[block[pos]] += v; } int query(int l,int r){ int ll = block[l],rr = block[r],ans = 0; if(l \u0026gt; r) return 0; if(ll == rr){ for(int i = l;i\u0026lt;=r;i++) ans += num[i]; return ans; } else{ for(int i = ll + 1;i\u0026lt;rr;i++) ans += sumn[i]; for(int i = l;i\u0026lt;=rb[ll];i++) ans += num[i]; for(int i = lb[rr];i\u0026lt;=r;i++) ans += num[i]; } return ans; } }A,B; int n,m,Q; int num[MAXN]; int back[MAXN]; int ans1[MAXN],ans2[MAXN]; map\u0026lt;int,int\u0026gt; S; struct Query{ int id,l,r,a,b; }q[MAXN]; bool cmp(Query \u0026amp;_a,Query \u0026amp;_b){ if(_a.l/Q == _b.l/Q) return _a.r \u0026lt; _b.r; else return _a.l/Q \u0026lt; _b.l/Q; } void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m); Q = sqrt(n)+1; for(int i = 1;i\u0026lt;=n;i++){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;num[i]); S[num[i]] = 0; } for(int i = 1;i\u0026lt;=m;i++){ scanf(\u0026#34;%d %d %d %d\u0026#34;,\u0026amp;q[i].l,\u0026amp;q[i].r,\u0026amp;q[i].a,\u0026amp;q[i].b); q[i].id = i; } int cnt = 0; for(map\u0026lt;int,int\u0026gt;::iterator it = S.begin();it!=S.end();it++){ it-\u0026gt;second = ++cnt; back[cnt] = it-\u0026gt;first; } for(int i = 1;i\u0026lt;=n;i++){ num[i] = S[num[i]]; } for(int i = 1;i\u0026lt;=m;i++){ q[i].a = lower_bound(back+1,back+cnt+1,q[i].a) - (back); q[i].b = upper_bound(back+1,back+cnt+1,q[i].b) - (back+1); } sort(q+1,q+m+1,cmp); } void add(int pos){ if(A.query(num[pos],num[pos]) == 0) B.update(num[pos],1); A.update(num[pos],1); } void del(int pos){ A.update(num[pos],-1); if(A.query(num[pos],num[pos]) == 0) B.update(num[pos],-1); } void solve(){ A.build(n),B.build(n); int L = 1,R = 0; for(int i = 1;i\u0026lt;=m;i++){ while(q[i].l \u0026lt; L) add(--L); while(R \u0026lt; q[i].r) add(++R); while(L \u0026lt; q[i].l) del(L++); while(q[i].r \u0026lt; R) del(R--); ans1[q[i].id] = A.query(q[i].a,q[i].b); ans2[q[i].id] = B.query(q[i].a,q[i].b); } for(int i = 1;i\u0026lt;=m;i++){ printf(\u0026#34;%d %d\\n\u0026#34;,ans1[i],ans2[i]); } } int main(){ init(); solve(); return 0; }   ","description":"","id":106,"section":"posts","tags":["è«é˜Ÿ","æ•°æ®ç»“æ„"],"title":"ã€ŒAHOI2013ã€ä½œä¸š-è«é˜Ÿ","uri":"https://blog.chenqiqian.com/posts/ahoi2013-homework/"},{"content":"ç»™å‡ºæ­£æ•´æ•° $n$ å’Œ $k$ ï¼Œè®¡ç®—\n$$\n\\sum_{i=1}^{n} k \\bmod i\n$$\né“¾æ¥ Luogu P2261\né¢˜è§£ æ¨ä¸€å‘å¼å­ï¼š\n$$\n\\sum_{i=1}^{n} k \\bmod i\\\n= \\sum_{i=1}^{n} k - \\lfloor \\frac{k}{i} \\rfloor \\cdot i\\\n= n k - \\sum_{i=1}^{n} \\lfloor \\frac{k}{i} \\rfloor \\cdot i\\\n$$\né‚£ä¹ˆï¼Œé—®é¢˜å°±å˜æˆæˆ‘ä»¬è¦æ±‚å‡ºä¸‹å¼çš„å€¼ï¼š\n$$\n\\sum_{i=1}^{n} \\lfloor \\frac{k}{i} \\rfloor \\cdot i\n$$\næˆ‘ä»¬å‘ç°ï¼Œè¿™ä¸ªå¼å­å½“ $i \u0026gt; k$ æ—¶æ²¡å•¥æ„ä¹‰ï¼Œæ‰€ä»¥åŒ–æˆï¼š\n$$\n\\sum_{i=1}^{\\min(n,k)} \\lfloor \\frac{k}{i} \\rfloor \\cdot i\n$$\næˆ‘ä»¬æ³¨æ„åˆ° $\\lfloor \\frac{k}{i} \\rfloor$ æœ€å¤šåªæœ‰ $2\\sqrt{n}$ ç§å–å€¼ï¼Œæ‰€ä»¥å¯ä»¥è¿›è¡Œæ•°è®ºåˆ†å—ï¼Œå¯¹äºç›¸åŒçš„ä¸€æ®µå–å€¼ï¼Œæˆ‘ä»¬è®¡ç®—å‡ºè¿™æ®µé‡Œé¢çš„ $\\sum i$ ï¼Œå°±å¯ä»¥åœ¨ $O(\\sqrt{\\min(n,k)})$ çš„æ—¶é—´å†…è®¡ç®—å‡ºç»“æœäº†ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;algorithm\u0026gt;#define ll long long using namespace std; ll n,k; void init(){ scanf(\u0026#34;%lld %lld\u0026#34;,\u0026amp;n,\u0026amp;k); } void solve(){ ll ans = n*k; for(ll l = 1,r;l \u0026lt;= n \u0026amp;\u0026amp; l \u0026lt;= k;l = r+1){ r = min((k/(k/l)),n); ans -= (k/l) * (r+l)*(r-l+1)/2; } printf(\u0026#34;%lld\\n\u0026#34;,ans); } int main(){ init(); solve(); return 0; }   ","description":"","id":107,"section":"posts","tags":["æ•°å­¦","åˆ†å—"],"title":"ã€ŒCQOI2007ã€ä½™æ•°æ±‚å’Œ-æ•°è®º+åˆ†å—","uri":"https://blog.chenqiqian.com/posts/cqoi2007-sum/"},{"content":"ç®€å•é¢˜æ„ï¼š\nç»™å®šä¸€ä¸ªè´¨æ•° $P$ å’Œå…¶åŸæ ¹ $g$ï¼Œç»™å®š $X$ æ±‚ $g^x \\equiv X \\pmod p$ çš„éè´Ÿæ•´æ•°è§£ $x$ã€‚\nå‡å®šé€šè®¯åŒæ–¹åä¸º $\\text{Alice}$ å’Œ $\\text{Bob}$ ï¼Œåè®®çš„å·¥ä½œè¿‡ç¨‹æè¿°å¦‚ä¸‹(å…¶ä¸­ $\\bmod$ è¡¨ç¤ºå–æ¨¡è¿ç®—) :\n  åè®®è§„å®šä¸€ä¸ªå›ºå®šçš„è´¨æ•° $P$ ï¼Œä»¥åŠæ¨¡ $P$ çš„ä¸€ä¸ªåŸæ ¹ $g$ ã€‚ $P$ å’Œ $g$ çš„æ•°å€¼éƒ½æ˜¯å…¬å¼€çš„ï¼Œæ— éœ€ä¿å¯†ã€‚\n  $\\text{Alice}$ ç”Ÿæˆä¸€ä¸ªéšæœºæ•° $a$ ï¼Œå¹¶è®¡ç®— $A=g^a \\bmod P$, å°† $A$ é€šè¿‡ä¸å®‰å…¨ä¿¡é“å‘é€ç»™Bobã€‚\n  $\\text{Bob}$ ç”Ÿæˆä¸€ä¸ªéšæœºæ•° $b$ ï¼Œå¹¶è®¡ç®— $B=g^b \\bmod P$ ï¼Œå°† $B$ é€šè¿‡ä¸å®‰å…¨ä¿¡é“å‘é€ç»™ $\\text{Alice}$ ã€‚\n  $\\text{Bob}$ æ ¹æ®æ”¶åˆ°çš„ $A$ è®¡ç®—å‡º $K=A^b\\bmod P$ ï¼Œè€Œ Alice æ ¹æ®æ”¶åˆ°çš„ $B$ è®¡ç®—å‡º$K=B^a\\bmod P$ã€‚\n  åŒæ–¹å¾—åˆ°äº†ç›¸åŒçš„ $K$ å³ $g^{ab} \\bmod P$ã€‚ $K$ å¯ä»¥ç”¨äºä¹‹åé€šè®¯çš„åŠ å¯†å¯†é’¥ã€‚\n  å¯è§ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­å¯èƒ½è¢«çªƒå¬çš„åªæœ‰ $A,B$ ï¼Œè€Œ $a,b,K$ æ˜¯ä¿å¯†çš„ã€‚å¹¶ä¸”æ ¹æ® $A,B,P,g$ è¿™ $4$ ä¸ªæ•°ï¼Œä¸èƒ½è½»æ˜“è®¡ç®—å‡º $K$ ï¼Œå› æ­¤ $K$ å¯ä»¥ä½œä¸ºä¸€ä¸ªå®‰å…¨çš„å¯†é’¥ã€‚\nå½“ç„¶å®‰å…¨æ˜¯ç›¸å¯¹çš„ï¼Œè¯¥åè®®çš„å®‰å…¨æ€§å–å†³äºæ•°å€¼çš„å¤§å°ï¼Œé€šå¸¸ $a,b,P$ éƒ½é€‰å–æ•°ç™¾ä½ä»¥ä¸Šçš„å¤§æ•´æ•°ä»¥é¿å…è¢«ç ´è§£ã€‚ç„¶è€Œå¦‚æœ $\\text{Alice}$ å’Œ $\\text{Bob}$ ç¼–ç¨‹æ—¶å·æ‡’ï¼Œä¸ºäº†é¿å…å®ç°å¤§æ•°è¿ç®—ï¼Œé€‰æ‹©çš„æ•°å€¼éƒ½å°äº $2^{31}$ ï¼Œé‚£ä¹ˆç ´è§£ä»–ä»¬çš„å¯†é’¥å°±æ¯”è¾ƒå®¹æ˜“äº†ã€‚\né“¾æ¥ Luogu P4454\né¢˜è§£ $\\text{BSGS}$ æ¨¡ç‰ˆé¢˜ï¼Œç”šè‡³è¿åˆ†ç±»è®¨è®ºéƒ½æ²¡æœ‰\u0026hellip;\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cmath\u0026gt;#include \u0026lt;map\u0026gt;#define ll long long using namespace std; ll gcd(ll a,ll b){ return b==0?a:gcd(b,a%b); } ll pow(ll x,ll k,ll p){ x %= p; ll ans = 1; for(ll i = k;i;i\u0026gt;\u0026gt;=1,x=x*x%p) if(i \u0026amp; 1) ans = ans * x % p; return ans; } ll bsgs(ll a,ll b,ll p){ //printf(\u0026#34;a:%lld b:%lld P:%lld\\n\u0026#34;,a,b,p);  a %= p,b %= p; if(b == 1) return 0; ll cnt = 0,t = 1; for(ll g = gcd(a,p);g!=1;g = gcd(a,p)){ if(b % g) return -1; a /= g,p /= g, t = t * a/g % p; cnt++; if(t == b) return cnt; } map\u0026lt;ll,ll\u0026gt; S; ll m = (ll)(sqrt(p)) + 1; ll base = b; for(ll i = 0;i\u0026lt;m;i++){ S[base] = i; base = base * a % p; } ll now = t; base = pow(a,m,p); for(ll i = 1;i\u0026lt;=m+1;i++){ now = now * base % p; if(S.count(now)){ return i*m-S[now]+cnt; } } return -1; } ll n; ll p,G; ll cal(ll A,ll B){ ll a = bsgs(G,A,p),b = bsgs(G,B,p); //printf(\u0026#34;a:%lld b:%lld\\n\u0026#34;,a,b);  return pow(G,a*b,p); } void init(){ scanf(\u0026#34;%lld %lld\u0026#34;,\u0026amp;G,\u0026amp;p); } void solve(){ scanf(\u0026#34;%lld\u0026#34;,\u0026amp;n); for(int i = 1;i\u0026lt;=n;i++){ ll a,b; scanf(\u0026#34;%lld %lld\u0026#34;,\u0026amp;a,\u0026amp;b); printf(\u0026#34;%lld\\n\u0026#34;,cal(a,b)); } } int main(){ init(); solve(); return 0; }   ","description":"","id":108,"section":"posts","tags":["æ•°å­¦","æ•°è®º","BSGSç®—æ³•"],"title":"ã€ŒCQOI2018ã€ç ´è§£D-Håè®®-BSGSç®—æ³•","uri":"https://blog.chenqiqian.com/posts/cqoi2018-crack/"},{"content":"å·²çŸ¥ä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„æ•´æ•°æ•°åˆ— $a_1,a_2,\u0026hellip;,a_n$ ï¼Œç»™å®šæŸ¥è¯¢å‚æ•° $l$ ã€ $r$ ï¼Œé—®åœ¨ $a_l,a_{l+1},\u0026hellip;,a_r$ â€‹åŒºé—´å†…ï¼Œæœ‰å¤šå°‘å­åºåˆ—æ»¡è¶³å¼‚æˆ–å’Œç­‰äº $k$ ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºæ‰€æœ‰çš„ $x,y$ $(l \\leq x \\leq y \\leq r)$ ï¼Œèƒ½å¤Ÿæ»¡è¶³ $a_x \\bigoplus a_{x+1} \\bigoplus \u0026hellip; \\bigoplus a_y = k$ çš„ $x,y$ æœ‰å¤šå°‘ç»„ã€‚\né“¾æ¥ Luogu P4462\né¢˜è§£ è€ƒè™‘åˆ°è¿™é¢˜æ²¡æœ‰ä¿®æ”¹ï¼Œè€Œä¸”æ˜¯åŒºé—´æŸ¥è¯¢é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è€ƒè™‘ä¸€ä¸‹è«é˜Ÿç®—æ³•ã€‚\nå¦‚æœæˆ‘ä»¬ç”¨è«é˜Ÿçš„è¯ï¼Œé‚£ä¹ˆåº”è¯¥è®©è¿™ä¸ªæ•°å¯¹ $(x,y)$ çš„æ•°ç›®èƒ½å¤Ÿåœ¨ $O(1)$ çš„æ—¶é—´ç»´æŠ¤ã€‚\nå› ä¸ºå¼‚æˆ–æœ‰ç»“åˆå¾‹ï¼Œä»¥åŠ $a\\bigoplus a = 0$ ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬ä»¤ $S_i = a_1 \\bigoplus a_2 \\bigoplus \u0026hellip; \\bigoplus a_i$ ï¼Œé‚£ä¹ˆ $a_x \\bigoplus a_{x+1} \\bigoplus \u0026hellip; \\bigoplus a_y$ å°±ç­‰äº $S_y \\bigoplus S_{x-1}$ã€‚\nè¿™ä¸ªæ—¶å€™å¦‚æœæˆ‘ä»¬ä»¤ $T_i = S_{i-1} \\bigoplus k(S_0 = 0)$ ï¼Œ é‚£ä¹ˆ $(x,y)$ æ˜¯åˆæ³•æ•°å¯¹çš„æ¡ä»¶å°±åŒ–ä½œ $S_y = T_x$ ã€‚\né‚£ä¹ˆé—®é¢˜è½¬åŒ–ä¸ºåœ¨ $l \\leq x\\leq y \\leq r$ çš„åŒºé—´å†…ï¼Œæœ‰å¤šå°‘å¯¹ $(x,y)$ æ»¡è¶³ $T_x = S_y$ ï¼Œå…¶ä¸­çš„ ${T_n}$ å’Œ ${S_n}$ éƒ½å¯ä»¥ $O(n)$ çš„è®¡ç®—ã€‚\nè«é˜Ÿå¥—å¥—å¥—ï¼Œè®°å½•ä¸€ä¸‹åœ¨å½“å‰åŒºé—´æ¯ä¸ªæ•°åœ¨ ${T_n}$ å’Œ ${S_n}$ ä¸­å‡ºç°æ¬¡æ•°ï¼Œè½¬ç§»çš„æ—¶å€™æ³¨æ„åˆ†å·¦å³è®¨è®ºä¸€ä¸‹å°±å¥½äº†ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95  // luogu-judger-enable-o2 #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cmath\u0026gt;#include \u0026lt;algorithm\u0026gt;#define ll long long using namespace std; const int MAXN = 110000; int n,m,k,Q; int num[MAXN]; int xor1[MAXN],xor2[MAXN]; ll ans[MAXN]; struct Query{ int l,r,id; bool operator \u0026lt;(const Query _q)const{ if(l/Q != _q.l/Q){ return l/Q \u0026lt; _q.l/Q; } else{ return r \u0026lt; _q.r; } } }q[MAXN]; void init(){ scanf(\u0026#34;%d %d %d\u0026#34;,\u0026amp;n,\u0026amp;m,\u0026amp;k); Q = sqrt(n); for(int i = 1;i\u0026lt;=n;i++){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;num[i]); } for(int i = 1;i\u0026lt;=m;i++){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;q[i].l,\u0026amp;q[i].r); q[i].id = i; } sort(q+1,q+m+1); } void build(){ for(int i = 1;i\u0026lt;=n;i++){ xor1[i] = xor1[i-1] ^ num[i]; xor2[i] = xor2[i-1] ^ num[i]; } for(int i = 0;i\u0026lt;=n;i++) xor2[i] ^= k; for(int i = n;i\u0026gt;=0;i--) xor2[i+1] = xor2[i]; } ll ANS = 0; ll num1[MAXN],num2[MAXN]; void addl(int pos){ num1[xor1[pos]]++; num2[xor2[pos]]++; ANS += num1[xor2[pos]]; } void addr(int pos){ num1[xor1[pos]]++; num2[xor2[pos]]++; ANS += num2[xor1[pos]]; } void dell(int pos){ ANS -= num1[xor2[pos]]; num1[xor1[pos]]--; num2[xor2[pos]]--; } void delr(int pos){ ANS -= num2[xor1[pos]]; num1[xor1[pos]]--; num2[xor2[pos]]--; } void solve(){ int L = 1,R = 0; for(int i = 1;i\u0026lt;=m;i++){ while(q[i].l \u0026lt; L) addl(--L); while(R \u0026lt; q[i].r) addr(++R); while(L \u0026lt; q[i].l) dell(L++); while(q[i].r \u0026lt; R) delr(R--); ans[q[i].id] = ANS; } for(int i = 1;i\u0026lt;=m;i++){ printf(\u0026#34;%lld\\n\u0026#34;,ans[i]); } } int main(){ init(); build(); solve(); return 0; }   ","description":"","id":109,"section":"posts","tags":["è«é˜Ÿ","åˆ†å—"],"title":"ã€ŒCQOI2018ã€å¼‚æˆ–åºåˆ—-è«é˜Ÿ","uri":"https://blog.chenqiqian.com/posts/cqoi2018-xor-sequence/"},{"content":"å–œæ¬¢é’»ç ”é—®é¢˜çš„ $JS$ åŒå­¦ï¼Œæœ€è¿‘åˆè¿·ä¸Šäº†å¯¹åŠ å¯†æ–¹æ³•çš„æ€è€ƒã€‚ä¸€å¤©ï¼Œä»–çªç„¶æƒ³å‡ºäº†ä¸€ç§ä»–è®¤ä¸ºæ˜¯ç»ˆæçš„åŠ å¯†åŠæ³•ï¼šæŠŠéœ€è¦åŠ å¯†çš„ä¿¡æ¯æ’æˆä¸€åœˆï¼Œæ˜¾ç„¶ï¼Œå®ƒä»¬æœ‰å¾ˆå¤šç§ä¸åŒçš„è¯»æ³•ã€‚\nä¾‹å¦‚ JSOI07 ï¼Œå¯ä»¥è¯»ä½œï¼š JSOI07 SOI07J OI07JS I07JSO 07JSOI 7JSOI0 ï¼ŒæŠŠå®ƒä»¬æŒ‰ç…§å­—ç¬¦ä¸²çš„å¤§å°æ’åºï¼š\n 07JSOI 7JSOI0 I07JSO JSOI07 OI07JS SOI07J  è¯»å‡ºæœ€åä¸€åˆ—å­—ç¬¦ï¼šI0O7SJï¼Œå°±æ˜¯åŠ å¯†åçš„å­—ç¬¦ä¸²ã€‚ ä½†æ˜¯ï¼Œå¦‚æœæƒ³åŠ å¯†çš„å­—ç¬¦ä¸²å®åœ¨å¤ªé•¿ï¼Œä½ èƒ½å†™ä¸€ä¸ªç¨‹åºå®Œæˆè¿™ä¸ªä»»åŠ¡å—ï¼Ÿ\né“¾æ¥ Luogu P4051\né¢˜è§£ å¤åˆ¶å­—ç¬¦ä¸²ï¼Œç„¶åè·‘ $SA$ ï¼Œå¾—åˆ° $sa$ æ•°ç»„ï¼Œç„¶ååœ¨ä¸Šé¢é¡ºåºæ‰«æï¼Œæ‰«æåˆ°æœ€å‰é¢ $n$ ä¸ªåœ¨ $1$ åˆ° $n$ ä¹‹é—´å¼€å§‹çš„åç¼€ï¼Œç„¶åè·å–å…¶ç¬¬ $n$ ä¸ªå­—ç¬¦å³å¯ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cstring\u0026gt;using namespace std; const int MAXN = 210000; namespace SA{ int s[MAXN],sa[MAXN],rk[MAXN],x[MAXN],y[MAXN],cnt[MAXN]; void get_sa(int n,int m){ for(int i = 0;i\u0026lt;m;i++) cnt[i] = 0; for(int i = 0;i\u0026lt;n;i++) cnt[s[i]] ++; for(int i = 1;i\u0026lt;m;i++) cnt[i] += cnt[i-1]; for(int i = n-1;~i;--i) sa[--cnt[s[i]]] = i; m = rk[sa[0]] = 0; for(int i = 1;i\u0026lt;n;i++) rk[sa[i]] = s[sa[i]] == s[sa[i-1]] ? m : ++m; for(int j = 1;;j\u0026lt;\u0026lt;=1){ if(++m == n) return; //printf(\u0026#34;!!!\\n\u0026#34;);  for(int i = 0;i\u0026lt;j;i++) y[i] = n-j+i; for(int i = 0,k=j;i\u0026lt;n;i++) if(sa[i] \u0026gt;= j) y[k++] = sa[i] - j; for(int i = 0;i\u0026lt;n;i++) x[i] = rk[y[i]]; for(int i = 0;i\u0026lt;m;i++) cnt[i] = 0; for(int i = 0;i\u0026lt;n;i++) cnt[x[i]]++; for(int i = 1;i\u0026lt;m;i++) cnt[i] += cnt[i-1]; for(int i = n-1;~i;--i) sa[--cnt[x[i]]] = y[i],y[i] = rk[i]; m = rk[sa[0]] = 0; for(int i = 1;i\u0026lt;n;i++) rk[sa[i]] = (y[sa[i]]==y[sa[i-1]]\u0026amp;\u0026amp;y[sa[i]+j]==y[sa[i-1]+j])?m:++m; } } void solve(char *str,int n){ for(int i = 0;i\u0026lt;n;i++){ s[i] = str[i]; } s[n] = 0; get_sa(++n,127); } void get_ans(char *ans,int n){ int cnt = 0; for(int i = 1;i\u0026lt;=2*n;i++){ int t = sa[i]; if(t \u0026lt; n){ ans[cnt++] = s[t+n-1]; } } } } int n; char s[MAXN]; char ans[MAXN]; void init(){ scanf(\u0026#34;%s\u0026#34;,s); n = strlen(s); } void solve(){ for(int i = 0;i\u0026lt;n;i++) s[n+i] = s[i]; SA::solve(s,2*n); SA::get_ans(ans,n); printf(\u0026#34;%s\\n\u0026#34;,ans); } int main(){ init(); solve(); return 0; }   ","description":"","id":110,"section":"posts","tags":["å­—ç¬¦ä¸²","åç¼€æ•°ç»„"],"title":"ã€ŒJSOI2007ã€å­—ç¬¦åŠ å¯†-åç¼€æ•°ç»„","uri":"https://blog.chenqiqian.com/posts/jsoi2007-character/"},{"content":"ä½ è¢«è¦æ±‚è®¾è®¡ä¸€ä¸ªè®¡ç®—å™¨å®Œæˆä»¥ä¸‹ä¸‰é¡¹ä»»åŠ¡ï¼š\n  ç»™å®š $y,z,p$ ï¼Œè®¡ç®— $y^z \\bmod p$ çš„å€¼ï¼›\n  ç»™å®š $y,z,p$ ï¼Œè®¡ç®—æ»¡è¶³ $xy \\equiv z \\pmod p$ çš„æœ€å°éè´Ÿæ•´æ•° $x$ï¼›\n  ç»™å®š $y,z,p$ ï¼Œè®¡ç®—æ»¡è¶³ $y^x \\equiv z \\pmod p$ çš„æœ€å°éè´Ÿæ•´æ•° $x$ã€‚\n  ä¿è¯ $p$ ä¸ºè´¨æ•°ã€‚\né“¾æ¥ Luogu P2485\né¢˜è§£ ç¬¬ä¸€ä¸ªå¿«é€Ÿå¹‚ï¼Œç¬¬äºŒä¸ªæ‰©å±•æ¬§å‡ é‡Œå¾—ï¼Œç¬¬ä¸‰ä¸ª $\\text{BSGS}$ ç®—æ³•ã€‚\næ¨¡ç‰ˆé¢˜ï¼Œä¸è¯´äº†ã€‚\nBSGSç®—æ³•ä»‹ç»ï¼š Miskcoo\u0026rsquo;s Blog\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;map\u0026gt;#include \u0026lt;cmath\u0026gt;#define ll long long using namespace std; ll gcd(ll a,ll b){ return b == 0?a:gcd(b,a%b); } ll pow(ll x,ll k,ll p){ ll ans = 1; for(ll i = k;i;i\u0026gt;\u0026gt;=1,x = (x*x)%p) if(i \u0026amp; 1) ans = (ans * x)%p; return ans; } ll exgcd(ll a,ll b,ll \u0026amp;x,ll \u0026amp;y){ if(b == 0){ x = 1,y = 0; return a; } else{ ll d = exgcd(b,a%b,y,x); y -= (a/b) * x; return d; } } ll module_formation(ll a,ll b,ll p){ ll x,y,d = exgcd(a,p,x,y); //printf(\u0026#34;%lld*%lld+%lld*%lld=%lld\\n\u0026#34;,a,x,p,y,d);  if(b%d) return -1; x *= b/d; return (x % (p/d) + (p/d)) % (p/d); } ll bsgs(ll a,ll b,ll p){ // æ±‚è§£ A^x \\equiv B (mod p)  a %= p,b %= p;// åˆ©ç”¨åŒä½™æ€§è´¨å¯¹ p å–æ¨¡  if(b == 1) return 0; ll t = 1,cnt = 0; for(ll g = gcd(a,p);g != 1;g = gcd(a,p)){// æ’é™¤æ‰€æœ‰å…¬å› æ•°ï¼Œä½¿ (a,p) = 1  if(b % g) return -1; b/=g,p/=g,t = t * a/g % p; cnt++; if(b == t) return cnt; } map\u0026lt;ll,ll\u0026gt; hash; int m = int(sqrt(p)) + 1; ll base = b; for(int i = 0;i\u0026lt;m;i++){ // è®¡ç®— A çš„ 0 -\u0026gt; m-1 æ¬¡æ–¹  hash[base] = i; base = base * a % p; } ll now = t;base = pow(a,m,p); for(int i = 1;i\u0026lt;=m+1;i++){// æšä¸¾ A^{im} æ¬¡æ–¹ï¼Œå¯»æ‰¾ç›¸ç­‰çš„ A^j  // è¿™é‡Œçš„æšä¸¾ä¸Šé™æ˜¯ m+1 å› ä¸ºåé¢çš„ j æ˜¯å‡è¿‡å»çš„  now = now * base % p; if(hash.count(now)) // ç­”æ¡ˆå³ä¸º A^{im-j(+cnt)}  return i * m - hash[now] + cnt; } return -1; } ll n,k,a,b,p; void init(){ scanf(\u0026#34;%lld %lld\u0026#34;,\u0026amp;n,\u0026amp;k); } void solve(){ for(int i = 1;i\u0026lt;=n;i++){ scanf(\u0026#34;%lld %lld %lld\u0026#34;,\u0026amp;a,\u0026amp;b,\u0026amp;p); ll ans = -1; if(k == 1) ans = pow(a,b,p); if(k == 2) ans = module_formation(a,b,p); if(k == 3) ans = bsgs(a,b,p); if(ans == -1) printf(\u0026#34;Orz, I cannot find x!\\n\u0026#34;); else printf(\u0026#34;%lld\\n\u0026#34;,ans); } } int main(){ init(); solve(); return 0; }   ","description":"","id":111,"section":"posts","tags":["æ•°è®º","å¿«é€Ÿå¹‚","æ‰©å±•æ¬§å‡ é‡Œå¾—","BSGSç®—æ³•"],"title":"ã€ŒSDOI2011ã€è®¡ç®—å™¨-å¿«é€Ÿå¹‚+æ‰©å±•æ¬§å‡ é‡Œå¾—+BSGSç®—æ³•","uri":"https://blog.chenqiqian.com/posts/sdoi2011-calculator/"},{"content":"å° $W$ å–œæ¬¢è¯»ä¹¦ï¼Œå°¤å…¶å–œæ¬¢è¯»ã€Šçº¦ç¿°å…‹é‡Œæ–¯æœµå¤«ã€‹ã€‚æœ€è¿‘å°Wå‡†å¤‡è¯»ä¸€æœ¬æ–°ä¹¦ï¼Œè¿™æœ¬ä¹¦ä¸€å…±æœ‰ $P$ é¡µï¼Œé¡µç èŒƒå›´ä¸º $0 \u0026hellip; P-1$ã€‚\nå° $W$ å¾ˆå¿™ï¼Œæ‰€ä»¥æ¯å¤©åªèƒ½è¯»ä¸€é¡µä¹¦ã€‚ä¸ºäº†ä½¿äº‹æƒ…æœ‰è¶£ä¸€äº›ï¼Œä»–æ‰“ç®—ä½¿ç”¨ $\\text{NOI2012}$ ä¸Šå­¦ä¹ çš„çº¿æ€§åŒä½™æ³•ç”Ÿæˆä¸€ä¸ªåºåˆ—ï¼Œæ¥å†³å®šæ¯å¤©å…·ä½“è¯»å“ªä¸€é¡µã€‚\næˆ‘ä»¬ç”¨ $X_i$ æ¥è¡¨ç¤ºé€šè¿‡è¿™ç§æ–¹æ³•ç”Ÿæˆå‡ºæ¥çš„ç¬¬ $i$ ä¸ªæ•°ï¼Œä¹Ÿå³å° $W$ ç¬¬ $i$ å¤©ä¼šè¯»å“ªä¸€é¡µã€‚è¿™ä¸ªæ–¹æ³•éœ€è¦è®¾ç½® $3$ ä¸ªå‚æ•° $a,b,X_1$ ï¼Œæ»¡è¶³ $0 \\leq a,b,X_1 \\leq p-1$ ï¼Œä¸” $a,b,X_1$ éƒ½æ˜¯æ•´æ•°ã€‚æŒ‰ç…§ä¸‹é¢çš„å…¬å¼ç”Ÿæˆå‡ºæ¥ä¸€ç³»åˆ—çš„æ•´æ•°ï¼š$X_{i+1} =(aX_i+b)\\bmod p$ å…¶ä¸­ $\\bmod$ è¡¨ç¤ºå–ä½™æ“ä½œã€‚\nä½†æ˜¯è¿™ç§æ–¹æ³•å¯èƒ½å¯¼è‡´æŸä¸¤å¤©è¯»çš„é¡µç ä¸€æ ·ã€‚\nå° $W$ è¦è¯»è¿™æœ¬ä¹¦çš„ç¬¬ $t$ é¡µï¼Œæ‰€ä»¥ä»–æƒ³çŸ¥é“æœ€æ—©åœ¨å“ªä¸€å¤©èƒ½è¯»åˆ°ç¬¬ $t$ é¡µï¼Œæˆ–è€…æŒ‡å‡ºä»–æ°¸è¿œä¸ä¼šè¯»åˆ°ç¬¬ $t$ é¡µã€‚\né“¾æ¥ Luogu P3306\né¢˜è§£ å…ˆå¿½ç•¥æ¨¡æ•°ï¼Œæ±‚ $X_n$ çš„é€šé¡¹å…¬å¼ã€‚\nåˆšå­¦çš„é«˜ä¸­æ•°å­¦å¿…ä¿®äº”ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œè¿™ä¸ªå‡½æ•°å¯ä»¥å˜å½¢æˆç±»ç­‰æ¯”æ•°åˆ—ã€‚\nå› ä¸º $a,b$ éƒ½æ˜¯å¸¸æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è®¾ï¼š\n$$\nX_{i+1} + \\lambda= a(X_i + \\lambda)\\\nX_{i+1} = aX_i + \\lambda(a-1)\\\n$$\næ‰€ä»¥ï¼š\n$$\n\\lambda(a-1) = b\\\n\\lambda = \\frac{b}{a-1}\n$$\nè®¾ $Y_i = X_i+\\lambda$ ï¼Œåˆ™æœ‰ï¼š\n$$\nY_{i+1} = a Y_i\n$$\nåˆ $Y_1 = X_1 + \\lambda$ï¼Œæ‰€ä»¥å¾—åˆ° $Y_i$ çš„é€šé¡¹å…¬å¼ï¼š\n$$\nY_i = (X_1+\\lambda) \\times a^{i-1}\n$$\nåˆ™ï¼š\n$$\nX_i = Y_i - \\lambda = (X_1+\\lambda) \\times a^{i-1} - \\lambda\n$$\né‚£ä¹ˆé—®é¢˜å°±è½¬æ¢æˆæ±‚ï¼š\n$$\n(X_1+\\lambda) \\times a^{i-1} - \\lambda \\equiv t \\pmod p\n$$\nçš„æœ€å°æ­£æ•´æ•°è§£ $i$ã€‚\nå¦‚æœæˆ‘ä»¬ç”¨ $x$ ä»£è¡¨ $i-1$ï¼Œé‚£ä¹ˆå°±å˜æˆæ±‚ï¼š\n$$\na^{x} \\equiv (t + \\lambda) \\times (X_1+\\lambda)^{-1} \\pmod p\n$$\nç„¶åè¿™é‡Œçš„ $\\lambda = b \\times a^{-1}$ ã€‚\nå¦‚æœä»¤ $A = a, B = (t + \\lambda) \\times (X_1+\\lambda)^{-1}$ ï¼Œé‚£ä¹ˆè¿™ä¸ªå¼å­å°±å˜æˆäº† $\\text{BSGS}$ çš„æ ‡å‡†å¼ï¼š\n$$\nA^x \\equiv B \\pmod p\n$$\nå¥—ç”¨ $\\text{BSGS}$ ç®—æ³•è§£å‡º $x$ï¼Œ$x+1$ å³æ˜¯ç­”æ¡ˆã€‚\næ³¨æ„å¤„ç†æ— è§£å’Œç‰¹æ®Šæƒ…å†µã€‚\nå½“ $a = 1$ æ—¶ï¼Œè¿™ä¸ªä¸œè¥¿ä¸å†èƒ½åŒ–æˆç±»ç­‰æ¯”æ•°åˆ—ï¼Œå°±æ˜¯ä¸€ä¸ªç±»ç­‰å·®æ•°åˆ—ï¼Œç”¨é€†å…ƒæ±‚è§£å³å¯ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cmath\u0026gt;#include \u0026lt;algorithm\u0026gt;#include \u0026lt;map\u0026gt;#define ll long long using namespace std; ll pow(ll x,ll k,ll p){ x %= p; ll ans = 1; for(ll i = k;i;i\u0026gt;\u0026gt;=1,x=x*x%p) if(i\u0026amp;1) ans = ans*x%p; return ans; } ll inv(ll x,ll p){ return pow(x%p,p-2,p); } ll gcd(ll a,ll b){ return b == 0?a:gcd(b,a%b); } ll bsgs(ll a,ll b,ll p){ //printf(\u0026#34;bsgs a:%lld b:%lld p:%lld\\n\u0026#34;,a,b,p);  a %= p,b %= p; ll t = 1,cnt = 0; if(b == 1) return 0; for(ll g = gcd(a,p);g != 1;g = gcd(a,p)){ if(b % g) return -2; a /= g,p /= g,t = t * a/g % p; ++cnt; if(b == t) return cnt; } map\u0026lt;ll,ll\u0026gt; S; ll m = (ll)(sqrt(p)) + 1; ll base = b; for(int i = 0;i\u0026lt;m;i++){ S[base] = i; base = base * a % p; } base = pow(a,m,p); ll now = t; for(int i = 1;i\u0026lt;=m+1;i++){ now = now * base % p; if(S.count(now)) return i * m - S[now] + cnt; } return -2; } ll cal(ll p,ll a,ll b,ll x_1,ll t){ if(x_1 == t) return 1; if(a == 0){ if(x_1==t) return 1; else if(b==t) return 2; else return -1; } if(a == 1){ //X_i = X_1 + (n-1) * b  if(b == 0){ if(x_1 == t) return 1; else return -1; } else{ return (((t-x_1+p)%p) * inv(b,p) % p)%p + 1; } } else{ ll lam = b * inv(a-1,p); ll A = a, B = ((t + lam)%p) * inv(x_1+lam,p) % p; return bsgs(A,B,p)+1; } } void solve(){ ll p,a,b,x_1,t; scanf(\u0026#34;%lld %lld %lld %lld %lld\u0026#34;,\u0026amp;p,\u0026amp;a,\u0026amp;b,\u0026amp;x_1,\u0026amp;t); printf(\u0026#34;%lld\\n\u0026#34;,cal(p,a,b,x_1,t)); } int main(){ int T; scanf(\u0026#34;%d\u0026#34;,\u0026amp;T); for(int i = 1;i\u0026lt;=T;i++){ solve(); } return 0; }   ","description":"","id":112,"section":"posts","tags":["æ•°è®º","BSGSç®—æ³•"],"title":"ã€ŒSDOI2013ã€éšæœºæ•°ç”Ÿæˆå™¨-BSGSç®—æ³•","uri":"https://blog.chenqiqian.com/posts/sdoi2013-random/"},{"content":"ä½œä¸ºä½“è‚²å§”å‘˜ï¼Œ $C$ å›è´Ÿè´£è¿™æ¬¡è¿åŠ¨ä¼šä»ªä»—é˜Ÿçš„è®­ç»ƒã€‚ä»ªä»—é˜Ÿæ˜¯ç”±å­¦ç”Ÿç»„æˆçš„ $N \\times N$ çš„æ–¹é˜µï¼Œä¸ºäº†ä¿è¯é˜Ÿä¼åœ¨è¡Œè¿›ä¸­æ•´é½åˆ’ä¸€ï¼Œ $C$ å›ä¼šè·Ÿåœ¨ä»ªä»—é˜Ÿçš„å·¦åæ–¹ï¼Œæ ¹æ®å…¶è§†çº¿æ‰€åŠçš„å­¦ç”Ÿäººæ•°æ¥åˆ¤æ–­é˜Ÿä¼æ˜¯å¦æ•´é½(å¦‚ä¸‹å›¾)ã€‚\nç°åœ¨ï¼Œ $C$ å›å¸Œæœ›ä½ å‘Šè¯‰ä»–é˜Ÿä¼æ•´é½æ—¶èƒ½çœ‹åˆ°çš„å­¦ç”Ÿäººæ•°ã€‚\né“¾æ¥ Luogu P2158\né¢˜è§£ å­¦äº†ä¸€å¹´ $\\text{OI}$ æ‰ä¼šåšè¿™é“é¢˜ï¼Œé€€å½¹é€€å½¹QAQ\næˆ‘ä»¬è§‚å¯Ÿå³ä¸‹ä¸‰è§’å½¢çš„æƒ…å†µï¼Œç­”æ¡ˆåªè¦å†åšä¸€äº›ç®€å•çš„åŠ å‡ä¹˜é™¤å°±å¯ä»¥äº†ã€‚\n$(x,y)$ ä» $(0,0)$ èƒ½è¢«çœ‹è§çš„æ¡ä»¶ï¼Œå°±æ˜¯åœ¨è¿™ä¸¤ä¸ªç‚¹ä¹‹é—´æ²¡æœ‰å…¶ä»–æ•´ç‚¹ã€‚å¯ä»¥å‘ç°ï¼Œå¦‚æœæœ‰ä¸å°‘äºä¸€ä¸ªæ•´ç‚¹ï¼Œé‚£ä¹ˆå¿…ç„¶è¿™ä¸ªåŒºé—´ä¼šè¢«æ•´ç‚¹è‹¥å¹²ç­‰åˆ†ï¼ˆè¿™è‹¥å¹²ä¸ªæ•´ç‚¹ä¹‹é—´æ–œç‡ç›¸åŒï¼‰ï¼Œæ‰€ä»¥ä¹Ÿå°±æ˜¯æ»¡è¶³ $\\gcd(x,y) \u0026gt; 1$ ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æ±‚ï¼š\n$$\n\\sum_{i = 1}^{n-1} \\sum_{j=1}^{n-1} [\\gcd(i,j) = 1]\n$$\nä¸¤ä¸ªå¾ªç¯ç›¸åŒï¼Œç›´æ¥ç”¨æ¬§æ‹‰å‡½æ•°æ±‚è§£å°±å¥½ã€‚\næ—¶é—´å¤æ‚åº¦ï¼š$O(n)$ ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39  #include \u0026lt;cstdio\u0026gt;using namespace std; const int MAXN = 100000; bool flag[MAXN]; int prime[MAXN],cnt; int phi[MAXN]; void sieve(int n){ phi[1] = 1;flag[1] = 1; for(int i = 2;i\u0026lt;=n;i++){ if(flag[i] == 0){ prime[++cnt] = i,phi[i] = i-1; } for(int j = 1;j\u0026lt;=cnt \u0026amp;\u0026amp; i * prime[j] \u0026lt;= n;j++){ flag[i*prime[j]] = 1; if(i % prime[j]){ phi[i * prime[j]] = phi[i] * (prime[j]-1); } else{ phi[i * prime[j]] = phi[i] * prime[j]; break; } } } } int main(){ int n; scanf(\u0026#34;%d\u0026#34;,\u0026amp;n); sieve(n); long long ans = 0; for(int i = 2;i\u0026lt;=n-1;i++){ ans += phi[i]; } printf(\u0026#34;%lld\\n\u0026#34;,n==1?0:ans*2+3); return 0; }   ","description":"","id":113,"section":"posts","tags":["æ•°å­¦","æ•°è®º","æ¬§æ‹‰å‡½æ•°"],"title":"ã€ŒSDOI2008ã€ä»ªä»—é˜Ÿ-æ¬§æ‹‰å‡½æ•°","uri":"https://blog.chenqiqian.com/posts/sdoi2008-guard/"},{"content":"ä¸€æ®µæ–‡ç«  $T$ æ˜¯ç”±è‹¥å¹²å°å†™å­—æ¯æ„æˆã€‚ä¸€ä¸ªå•è¯ $W$ ä¹Ÿæ˜¯ç”±è‹¥å¹²å°å†™å­—æ¯æ„æˆã€‚ä¸€ä¸ªå­—å…¸ $D$ æ˜¯è‹¥å¹²ä¸ªå•è¯çš„é›†åˆã€‚æˆ‘ä»¬ç§°ä¸€æ®µæ–‡ç«  $T$ åœ¨æŸä¸ªå­—å…¸ $D$ ä¸‹æ˜¯å¯ä»¥è¢«ç†è§£çš„ï¼Œæ˜¯æŒ‡å¦‚æœæ–‡ç«  $T$ å¯ä»¥è¢«åˆ†æˆè‹¥å¹²éƒ¨åˆ†ï¼Œä¸”æ¯ä¸€ä¸ªéƒ¨åˆ†éƒ½æ˜¯å­—å…¸ $D$ ä¸­çš„å•è¯ã€‚\nç»™å®šä¸€ä¸ªå­—å…¸ $D$ ï¼Œä½ çš„ç¨‹åºéœ€è¦åˆ¤æ–­è‹¥å¹²æ®µæ–‡ç« åœ¨å­—å…¸ $D$ ä¸‹æ˜¯å¦èƒ½å¤Ÿè¢«ç†è§£ã€‚å¹¶ç»™å‡ºå…¶åœ¨å­—å…¸ $D$ ä¸‹èƒ½å¤Ÿè¢«ç†è§£çš„æœ€é•¿å‰ç¼€çš„ä½ç½®ã€‚\né“¾æ¥ Luogu P2292\né¢˜è§£ å¯ä»¥æƒ³åˆ°ä¸€ä¸ªç®€å•çš„ $\\text{dp}$ ï¼Œç”¨ $dp[i]$ è¡¨ç¤ºä»¥ $i$ ä¸ºç»“å°¾çš„åç¼€èƒ½å¦è¢«ç†è§£ï¼š\n$$\ndp[i] = \\max(dp[i-\\text{len}_j]) ,\\text{if} ; \\text{str}_j \\text{åœ¨ i ä½ç½®ä¸Šå‡ºç°}\n$$\nç„¶åç”¨æ¨¡ç‰ˆä¸² $\\text{AC}$ è‡ªåŠ¨æœºè·‘ä¸€éæ¯ä¸²ï¼Œå¾—åˆ°æ¯ä¸ªæ¨¡ç‰ˆä¸²åœ¨æ¯ä¸²ä¸­å‡ºç°çš„ä½ç½®ï¼Œç„¶ååˆ·è¡¨ $dp$ å³å¯ã€‚\næ³¨æ„å¾€å›ä¸èƒ½æš´åŠ›è·³ $fail$ ï¼Œä¸€ä¸ªç®€å•çš„ä¼˜åŒ–æ˜¯è®°å½•æœ€è¿‘çš„ $\\text{end}$ èŠ‚ç‚¹ $g_i$ ï¼Œç„¶åæ¯æ¬¡éƒ½æŒ‰ç…§ $g_i$ è·³ï¼Œç»Ÿè®¡å‡ºç°ä½ç½®å³å¯ã€‚\næ—¶é—´å¤æ‚åº¦ $O(n \\times \\text{ç„å­¦})$ ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cstring\u0026gt;#include \u0026lt;queue\u0026gt;using namespace std; const int MAXN = 1000,sigma_size = 26; vector\u0026lt;int\u0026gt; pos[MAXN]; namespace AC{ int c[MAXN][sigma_size],fail[MAXN],g[MAXN]; int end[MAXN]; int root,cnt,wcnt; void insert(char *s){ int n = strlen(s),nown = root; for(int i = 0;i\u0026lt;n;i++){ if(c[nown][s[i]-\u0026#39;a\u0026#39;] == 0){ c[nown][s[i]-\u0026#39;a\u0026#39;] = ++cnt; } nown = c[nown][s[i]-\u0026#39;a\u0026#39;]; } end[nown] = ++wcnt; } void build(){ queue\u0026lt;int\u0026gt; q; for(int i = 0;i\u0026lt;sigma_size;i++){ if(c[root][i]){ fail[c[root][i]] = root; q.push(c[root][i]); } } while(!q.empty()){ int nown = q.front();q.pop(); for(int i = 0;i\u0026lt;sigma_size;i++){ g[nown] = end[fail[nown]]?fail[nown]:g[fail[nown]]; if(c[nown][i] == 0){ c[nown][i] = c[fail[nown]][i]; } else{ fail[c[nown][i]] = c[fail[nown]][i]; q.push(c[nown][i]); } } } } void query(char *s){ for(int i = 1;i\u0026lt;=20;i++){ pos[i].clear(); } int n = strlen(s),nown = root; for(int i = 0;i\u0026lt;n;i++){ nown = c[nown][s[i] - \u0026#39;a\u0026#39;]; for(int t = nown;t;t = g[t]){ if(end[t]){ pos[end[t]].push_back(i); } } } } } int n,m; int now[MAXN],l[MAXN]; char s[1100000]; bool dp[1100000]; int cal(char *s){ memset(now,0,sizeof(now)); memset(dp,0,sizeof(dp));//dp -\u0026gt; len  int len = strlen(s),ans = 0; AC::query(s); dp[0] = 1; for(int i = 1;i\u0026lt;=len;i++){ for(int j = 1;j \u0026lt;= n;j++){ if(now[j] != pos[j].size() \u0026amp;\u0026amp; pos[j][now[j]] == (i-1)){ dp[i] |= dp[i-l[j]]; now[j] ++; } if(dp[i] == 1){ ans = max(ans,i); continue; } } } return ans; } void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m); for(int i = 1;i\u0026lt;=n;i++){ scanf(\u0026#34;%s\u0026#34;,s); l[i] = strlen(s); AC::insert(s); } AC::build(); } void solve(){ for(int i = 1;i\u0026lt;=m;i++){ scanf(\u0026#34;%s\u0026#34;,s); printf(\u0026#34;%d\\n\u0026#34;,cal(s)); } } int main(){ init(); solve(); return 0; }   ","description":"","id":114,"section":"posts","tags":["å­—ç¬¦ä¸²","ACè‡ªåŠ¨æœº"],"title":"ã€ŒHNOI2004ã€Lè¯­è¨€-ACè‡ªåŠ¨æœº","uri":"https://blog.chenqiqian.com/posts/hnoi2004-language/"},{"content":"ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º $N$ çš„æ•°åˆ—ï¼Œæ¯æ¬¡ä¸€ä¸ªæ“ä½œæˆ–è¯¢é—®ï¼š\n æŠŠé—­åŒºé—´ $[L, R]$ å†…çš„æ•°å…¨éƒ¨åŠ ä¸Šä¸€ä¸ªæ•´æ•° $W$ é—®é—­åŒºé—´ $[L, R]$ å†…æœ‰å¤šå°‘è‹±é›„èº«é«˜å¤§äºç­‰äº $C$  é“¾æ¥ Luogu P2801\né¢˜è§£ åˆ†å—ï¼Œæ¯å—ç»´æŠ¤ä¸€ä¸ª $\\text{add}$ æ ‡è®°ï¼Œä¿è¯å—å†…æœ‰åºã€‚\næ•´å—çš„ä¿®æ”¹ç›´æ¥æ‰“æ ‡è®°ï¼Œé›¶æ•£æ•°å…ˆå‡å»æ ‡è®°åé€ä¸ªä¿®æ”¹ï¼Œå—å†…é‡æ’ã€‚\næ•´å—æŸ¥è¯¢å‡å»æ ‡è®°åäºŒåˆ†ï¼Œé›¶æ•£æ•°æš´åŠ›åˆ¤æ–­ã€‚\næ³¨æ„è¾¹ç•Œã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;algorithm\u0026gt;#include \u0026lt;cstring\u0026gt;#include \u0026lt;cmath\u0026gt;using namespace std; const int MAXN = 1100000,MAXQ = 50000; void read(int \u0026amp;x){scanf(\u0026#34;%d\u0026#34;,\u0026amp;x);} void read(char *x){scanf(\u0026#34;%s\u0026#34;,x);} int n,m,a[MAXN],Q; int add[MAXN]; int num[MAXN]; bool cmp(int a,int b){return a \u0026gt; b;} void cpy(int q){memcpy(num+q*Q,a+q*Q,sizeof(int)*Q);} void sort(int q){sort(num+q*Q,num+min(n,(q+1)*Q),cmp);} int query(int q,int c){ int t = upper_bound(num+q*Q,num+min(n,(q+1)*Q),c,cmp) - (num+q*Q); // printf(\u0026#34;q:%d c:%d t:%d\\n\u0026#34;,q,c,t);  return t; } void init(){ read(n),read(m);Q = sqrt(n)+1; for(int i = 0;i\u0026lt;n;i++){ read(a[i]); if(i/Q != (i+1)/Q || i == n-1) cpy(i/Q),sort(i/Q); } } void modify(int l,int r,int w){ int lq = l/Q,rq = r/Q; if(lq == rq || lq + 1 == rq){ for(int i = l;i\u0026lt;=r;i++) a[i] += w; cpy(lq),sort(lq); cpy(rq),sort(rq); } else{ for(int i = lq+1;i\u0026lt;=rq-1;i++) add[i] += w; for(int i = l;i\u0026lt;(lq+1)*Q;i++) a[i] += w; for(int i = rq*Q;i\u0026lt;=r;i++) a[i] += w; cpy(lq),sort(lq); cpy(rq),sort(rq); } } int query(int l,int r,int c){ int lq = l/Q,rq = r/Q,ans = 0; if(lq == rq || lq + 1 == rq){ for(int i = l;i\u0026lt;=r;i++) if(a[i] + add[i/Q] \u0026gt;= c) ans ++; return ans; } else{ for(int i = lq+1;i\u0026lt;=rq-1;i++) ans += query(i,c-add[i]); for(int i = l;i\u0026lt;(lq+1)*Q;i++) if(a[i] + add[i/Q] \u0026gt;= c) ans ++; for(int i = rq*Q;i\u0026lt;=r;i++) if(a[i] + add[i/Q] \u0026gt;= c) ans ++; return ans; } } void solve(){ char op[10]; int l,r,c; for(int i = 1;i\u0026lt;=m;i++){ read(op),read(l),read(r),read(c); if(op[0] == \u0026#39;M\u0026#39;) modify(l-1,r-1,c); if(op[0] == \u0026#39;A\u0026#39;) printf(\u0026#34;%d\\n\u0026#34;,query(l-1,r-1,c)); } } int main(){ init(); solve(); return 0; }   ","description":"","id":115,"section":"posts","tags":["åˆ†å—","æ•°æ®ç»“æ„"],"title":"ã€ŒLuogu 2801ã€æ•™ä¸»çš„é­”æ³•-åˆ†å—","uri":"https://blog.chenqiqian.com/posts/luogu-2801/"},{"content":"åœ¨ $2016$ å¹´ï¼Œä½³åª›å§å§å–œæ¬¢ä¸Šäº†æ•°å­—åºåˆ—ã€‚å› è€Œä»–ç»å¸¸ç ”ç©¶å…³äºåºåˆ—çš„ä¸€äº›å¥‡å¥‡æ€ªæ€ªçš„é—®é¢˜ï¼Œç°åœ¨ä»–åœ¨ç ”ç©¶ä¸€ä¸ªéš¾é¢˜ï¼Œéœ€è¦ä½ æ¥å¸®åŠ©ä»–ã€‚è¿™ä¸ªéš¾é¢˜æ˜¯è¿™æ ·å­çš„ï¼šç»™å‡ºä¸€ä¸ª $1$ åˆ° $n$ çš„å…¨æ’åˆ—ï¼Œç°åœ¨å¯¹è¿™ä¸ªå…¨æ’åˆ—åºåˆ—è¿›è¡Œ $m$ æ¬¡å±€éƒ¨æ’åºï¼Œæ’åºåˆ†ä¸ºä¸¤ç§ï¼š\n $(0,l,r)$è¡¨ç¤ºå°†åŒºé—´ $[l,r]$ çš„æ•°å­—å‡åºæ’åº $(1,l,r)$è¡¨ç¤ºå°†åŒºé—´ $[l,r]$ çš„æ•°å­—é™åºæ’åº\næœ€åè¯¢é—®ç¬¬ $q$ ä½ç½®ä¸Šçš„æ•°å­—ã€‚  é“¾æ¥ Luogu P2824\né¢˜è§£ å¥½é¢˜å•Šã€‚\nå› ä¸ºè¿™ä¸ªé—®é¢˜åªæœ‰ä¸€ä¸ªè¯¢é—®ï¼Œæ‰€ä»¥æˆ‘ä»¬è€ƒè™‘äºŒåˆ†ç­”æ¡ˆã€‚\nå‡è®¾å½“å‰çš„è€ƒè™‘è¦åˆ¤å®šçš„ç­”æ¡ˆæ˜¯ $mid$ ä¸ $p$ ä½ç½®ä¸Šæ•°çš„å¤§å°å…³ç³»ï¼Œé€šè¿‡ $O(\\log n)$ æ¬¡äºŒåˆ†ï¼Œå°±å¯ä»¥æ±‚å‡ºæœ€åè¿™ä¸ªä½ç½®ä¸Šçš„æ•°å­—ã€‚\næ‰€ä»¥é—®é¢˜è½¬åŒ–ä¸ºï¼šæ±‚å‡º $p$ ä½ç½®ä¸Šçš„æ•°ä¸ $k$ çš„å¤§å°å…³ç³»ã€‚æˆ‘ä»¬å…³æ³¨åˆ°ï¼Œå¦‚æœæˆ‘ä»¬åªå…³å¿ƒå…¶ä½ç½®ä¸Šçš„æ•°ç›¸å¯¹äºæŸä¸€ä¸ªæ•°çš„å¤§å°å…³ç³»ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥å°†å°äºç­‰äº $k$ çš„æ•°è®¾ç½®æˆ $0$ ï¼Œå¤§äº $k$ çš„æ•°è®¾ç½®æˆ $1$ï¼Œé‚£ä¹ˆæ’åºå°±æ¯”è¾ƒå®¹æ˜“äº†ï¼Œåªéœ€è¦ä¸€ä¸ª $0/1$ çº¿æ®µæ ‘ï¼Œç»´æŠ¤åŒºé—´å’Œï¼Œæ”¯æŒåŒºé—´è¦†ç›–å³å¯ã€‚æ¯æ¬¡æˆ‘ä»¬æŸ¥è¯¢åˆ° $sum(l,r)$ï¼Œç„¶åæ ¹æ®è¿™ä¸ª $sum$ çš„å€¼å’Œæ’åºçš„ç§ç±»å¯¹åŒºé—´è¿›è¡Œè¦†ç›–ï¼Œå‡åºå³ä¸º $0\u0026hellip;01\u0026hellip;1$ï¼Œé™åºåˆ™ä¸º $1\u0026hellip;10\u0026hellip;0$ã€‚\næœ€åæŸ¥è¯¢ $q$ è¿™ä¸ªä½ç½®ä¸Šçš„å€¼ï¼Œå¦‚æœæ˜¯ $0$ ï¼Œå°±è¯´æ˜è¿™ä¸ªä½ç½®ä¸Šçš„æ•°å°äºç­‰äº $k$ ï¼Œå¦åˆ™å°±æ˜¯å¤§äº $k$ ã€‚\näºŒåˆ†ç­”æ¡ˆå³å¯ã€‚\næ—¶é—´å¤æ‚åº¦ï¼š $O(n \\log^2 n)$\nè¿™é¢˜ä¹Ÿæœ‰ç”¨å¯åˆå¹¶ã€åˆ†è£‚çš„çº¿æ®µæ ‘çš„åšæ³•ï¼Œå¯ä»¥å¤„ç†å¤šç»„è¯¢é—®ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120  #include \u0026lt;cstdio\u0026gt;using namespace std; const int MAXN = 31000; namespace SegTree{ #define lson (nown\u0026lt;\u0026lt;1)  #define rson (nown\u0026lt;\u0026lt;1|1)  #define mid ((l+r)\u0026gt;\u0026gt;1)  int sumn[MAXN\u0026lt;\u0026lt;2],lazy[MAXN\u0026lt;\u0026lt;2];// -1 -\u0026gt; no label  void add_label(int nown,int l,int r,int op){ lazy[nown] = op,sumn[nown] = (r-l+1)*op; } void push_down(int nown,int l,int r){ if(lazy[nown] != -1){ add_label(lson,l,mid,lazy[nown]); add_label(rson,mid+1,r,lazy[nown]); lazy[nown] = -1; } } void push_up(int nown){ sumn[nown] = sumn[lson] + sumn[rson]; } void build(int nown,int l,int r,int k,int *a){ lazy[nown] = -1; if(l == r){ sumn[nown] = k \u0026lt; a[l];// æ»¡è¶³æ¡ä»¶ï¼ˆ\u0026lt;=ï¼‰çš„ sumn ä¸º 0  } else{ build(lson,l,mid,k,a),build(rson,mid+1,r,k,a); push_up(nown); } } int query(int nown,int l,int r,int ql,int qr){ if(ql \u0026lt;= l \u0026amp;\u0026amp; r \u0026lt;= qr){ return sumn[nown]; } else{ push_down(nown,l,r); int ans = 0; if(ql \u0026lt;= mid) ans += query(lson,l,mid,ql,qr); if(qr \u0026gt;= mid+1) ans += query(rson,mid+1,r,ql,qr); return ans; } } void update(int nown,int l,int r,int ql,int qr,int op){ if(ql \u0026lt;= l \u0026amp;\u0026amp; r \u0026lt;= qr){ add_label(nown,l,r,op); } else{ push_down(nown,l,r); if(ql \u0026lt;= mid) update(lson,l,mid,ql,qr,op); if(qr \u0026gt;= mid+1) update(rson,mid+1,r,ql,qr,op); push_up(nown); } } void print(int nown,int l,int r){ printf(\u0026#34;nown:%d l,r:%d %d sumn:%d lazy:%d\\n\u0026#34;,nown,l,r,sumn[nown],lazy[nown]); if(l == r) return; print(lson,l,mid); print(rson,mid+1,r); } void sort(int n,int l,int r,int op){// op ä¸º 0 æ­£åº ï¼Œ op ä¸º 1 é€†åº  int b = query(1,1,n,l,r),a = (r-l+1) - b; //printf(\u0026#34;a:%d b:%d\\n\u0026#34;,a,b);  if(op == 0){ if(a) update(1,1,n,l,l+a-1,0); if(b) update(1,1,n,r-b+1,r,1); } else{ if(b) update(1,1,n,l,l+b-1,1); if(a) update(1,1,n,r-a+1,r,0); } } #undef lson  #undef rson  #undef mid } int n,m,q; int a[MAXN]; int o[MAXN],l[MAXN],r[MAXN]; void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m); for(int i = 1;i\u0026lt;=n;i++) scanf(\u0026#34;%d\u0026#34;,\u0026amp;a[i]); for(int i = 1;i\u0026lt;=m;i++) scanf(\u0026#34;%d %d %d\u0026#34;,\u0026amp;o[i],\u0026amp;l[i],\u0026amp;r[i]); scanf(\u0026#34;%d\u0026#34;,\u0026amp;q); } bool check(int k){//æ£€æŸ¥ q ä½ç½®ä¸Šçš„æ•°æ˜¯ä¸æ˜¯å°äºç­‰äº k  SegTree::build(1,1,n,k,a); for(int i = 1;i\u0026lt;=m;i++) SegTree::sort(n,l[i],r[i],o[i]); return SegTree::query(1,1,n,q,q) == 0; } void solve(){ int b = 1,e = n; while(b!=e){ int mid = (b+e)\u0026gt;\u0026gt;1; //printf(\u0026#34;%d %d:%d\\n\u0026#34;,b,e,mid);  if(check(mid)) e = mid; else b = mid+1; } printf(\u0026#34;%d\\n\u0026#34;,b); } int main(){ init(); solve(); return 0; }   ","description":"","id":116,"section":"posts","tags":["çº¿æ®µæ ‘","æ’åº","äºŒåˆ†ç­”æ¡ˆ"],"title":"ã€ŒHEOI2016/TJOI2016ã€æ’åº-çº¿æ®µæ ‘","uri":"https://blog.chenqiqian.com/posts/heoi2016-tjoi2016-sort/"},{"content":"å° $Y$ æœ€è¿‘åœ¨ä¸€å®¶é‡‘åˆ¸äº¤æ˜“æ‰€å·¥ä½œã€‚è¯¥é‡‘åˆ¸äº¤æ˜“æ‰€åªå‘è¡Œäº¤æ˜“ä¸¤ç§é‡‘åˆ¸ï¼š$A$ çºªå¿µåˆ¸ï¼ˆä»¥ä¸‹ç®€ç§° $A$ åˆ¸ï¼‰å’Œ $B$ çºªå¿µåˆ¸ï¼ˆä»¥ä¸‹ç®€ç§° $B$ åˆ¸ï¼‰ã€‚æ¯ä¸ªæŒæœ‰é‡‘åˆ¸çš„é¡¾å®¢éƒ½æœ‰ä¸€ä¸ªè‡ªå·±çš„å¸æˆ·ã€‚é‡‘åˆ¸çš„æ•°ç›®å¯ä»¥æ˜¯ä¸€ä¸ªå®æ•°ã€‚æ¯å¤©éšç€å¸‚åœºçš„èµ·ä¼æ³¢åŠ¨ï¼Œä¸¤ç§é‡‘åˆ¸éƒ½æœ‰è‡ªå·±å½“æ—¶çš„ä»·å€¼ï¼Œå³æ¯ä¸€å•ä½é‡‘åˆ¸å½“å¤©å¯ä»¥å…‘æ¢çš„äººæ°‘å¸æ•°ç›®ã€‚æˆ‘ä»¬è®°å½•ç¬¬ $K$ å¤©ä¸­ $A$ åˆ¸ å’Œ $B$ åˆ¸çš„ä»·å€¼åˆ†åˆ«ä¸º $A_K$ å’Œ $B_K$ï¼ˆå…ƒ/å•ä½é‡‘åˆ¸ï¼‰ã€‚ä¸ºäº†æ–¹ä¾¿é¡¾å®¢ï¼Œé‡‘åˆ¸äº¤æ˜“æ‰€æä¾›äº†ä¸€ç§éå¸¸æ–¹ä¾¿çš„äº¤æ˜“æ–¹å¼ï¼šæ¯”ä¾‹äº¤æ˜“æ³•ã€‚æ¯”ä¾‹äº¤æ˜“æ³•åˆ†ä¸ºä¸¤ä¸ªæ–¹é¢ï¼š\nï¼ˆaï¼‰å–å‡ºé‡‘åˆ¸ï¼šé¡¾å®¢æä¾›ä¸€ä¸ª $[0,100]$ å†…çš„å®æ•° $OP$ ä½œä¸ºå–å‡ºæ¯”ä¾‹ï¼Œå…¶æ„ä¹‰ä¸ºï¼šå°† $OP%$ çš„ $A$ åˆ¸å’Œ $OP%$ çš„ $B$ åˆ¸ä»¥å½“æ—¶çš„ä»·å€¼å…‘æ¢ä¸ºäººæ°‘å¸ï¼›\nï¼ˆbï¼‰ä¹°å…¥é‡‘åˆ¸ï¼šé¡¾å®¢æ”¯ä»˜ $IP$ å…ƒäººæ°‘å¸ï¼Œäº¤æ˜“æ‰€å°†ä¼šå…‘æ¢ç»™ç”¨æˆ·æ€»ä»·å€¼ä¸º $IP$ çš„é‡‘åˆ¸ï¼Œå¹¶ä¸”ï¼Œæ»¡è¶³æä¾›ç»™é¡¾å®¢çš„ $A$ åˆ¸å’Œ $B$ åˆ¸çš„æ¯”ä¾‹åœ¨ç¬¬ $K$ å¤©æ°å¥½ä¸º $Rate_K$ ï¼›\næ³¨æ„åˆ°ï¼ŒåŒä¸€å¤©å†…å¯ä»¥è¿›è¡Œå¤šæ¬¡æ“ä½œã€‚å° $Y$ æ˜¯ä¸€ä¸ªå¾ˆæœ‰ç»æµå¤´è„‘çš„å‘˜å·¥ï¼Œé€šè¿‡è¾ƒé•¿æ—¶é—´çš„è¿ä½œå’Œè¡Œæƒ…æµ‹ç®—ï¼Œä»–å·²ç»çŸ¥é“äº†æœªæ¥ $N$ å¤©å†…çš„ $A$ åˆ¸å’Œ $B$ åˆ¸çš„ä»·å€¼ä»¥åŠ $Rate$ ã€‚ä»–è¿˜å¸Œæœ›èƒ½å¤Ÿè®¡ç®—å‡ºæ¥ï¼Œå¦‚æœå¼€å§‹æ—¶æ‹¥æœ‰ $S$ å…ƒé’±ï¼Œé‚£ä¹ˆ $N$ å¤©åæœ€å¤šèƒ½å¤Ÿè·å¾—å¤šå°‘å…ƒé’±ã€‚\nä¾‹å¦‚ï¼Œå‡å®šæ¥ä¸‹æ¥ $3$ å¤©å†…çš„ $A_k$ã€$B_k$ã€$Rate_K$ çš„å˜åŒ–åˆ†åˆ«ä¸ºï¼š\nå‡å®šåœ¨ç¬¬ä¸€å¤©æ—¶ï¼Œç”¨æˆ·æ‰‹ä¸­æœ‰ $100$ å…ƒ äººæ°‘å¸ä½†æ˜¯æ²¡æœ‰ä»»ä½•é‡‘åˆ¸ã€‚ç”¨æˆ·å¯ä»¥æ‰§è¡Œä»¥ä¸‹çš„æ“ä½œï¼š\næç¤ºï¼š\n è¾“å…¥æ–‡ä»¶å¯èƒ½å¾ˆå¤§ï¼Œè¯·é‡‡ç”¨å¿«é€Ÿçš„è¯»å…¥æ–¹å¼ã€‚ å¿…ç„¶å­˜åœ¨ä¸€ç§æœ€ä¼˜çš„ä¹°å–æ–¹æ¡ˆæ»¡è¶³ï¼šæ¯æ¬¡ä¹°è¿›æ“ä½œä½¿ç”¨å®Œæ‰€æœ‰çš„äººæ°‘å¸ï¼›æ¯æ¬¡å–å‡ºæ“ä½œå–å‡ºæ‰€æœ‰çš„é‡‘åˆ¸ã€‚  é“¾æ¥ LOJ 2353\nBZOJ 1492\nLuogu P4027\né¢˜è§£ æœ€ä¼˜ç­–ç•¥è‚¯å®šæ˜¯åªæœ‰ä¸¤ç§çŠ¶æ€ï¼šå…¨ä»“/ç©ºä»“ï¼Œç„¶åæ¯å¤©æˆ‘ä»¬åªæœ‰è‹¥å¹²ç§é€‰æ‹©ï¼šå…¨ä¹°ï¼Œå…¨å–ï¼Œå…¨ä¹°+å…¨å–ï¼Œå•¥éƒ½ä¸åšã€‚\næ³¨æ„åˆ°æˆ‘ä»¬å¯ä»¥ $dp$ \u0026hellip;\nå…ˆå†™æš´åŠ›è½¬ç§»\u0026hellip;æ³¨æ„åˆ°æˆ‘ä»¬äº‹å®ä¸Šåªéœ€è¦è®°å½•æˆ‘ä»¬æœ‰å¤šå°‘é’±ï¼Œåœ¨å“ªå¤©ä¹°å…¥çš„è¯å°±ä¼šæœ‰å¤šå°‘çš„æ¯”ä¾‹ã€‚\næ‰€ä»¥æˆ‘ä»¬ä»¤ $dp[i]$ ä¸ºåœ¨ç¬¬ $i$ å¤©æ‹¥æœ‰çš„æœ€å¤šé’±ï¼Œå‡è®¾æˆ‘ä»¬ä¸Šæ¬¡å…¨éƒ¨å–å‡º+å…¨éƒ¨ä¹°å…¥åœ¨ç¬¬ $j$ å¤©ï¼ŒçŠ¶æ€è½¬ç§»ï¼š\n$$\ndp[i] = \\max\\left(\\max_{j=1}^{i-1}(dp[j]\\times \\frac{r[j]*a[i] + b[i]}{r[j]*a[j]+b[j]}),dp[i-1]\\right)\n$$\nå¾ˆå¥½ç†è§£å˜›\u0026hellip;å°±æ˜¯ä¸€ä¸ªå†³ç­–åœ¨å“ªå¤©å…¨ä¹°/å…¨å–çš„é—®é¢˜ã€‚\næš´åŠ›è½¬ç§»å¯ä»¥æ‹¿åˆ° $60$ åˆ†â€¦ä¸Šå¤æ—¶ä»£çš„æš´åŠ›åˆ†è¿˜æ˜¯å¾ˆå¥½æ‹¿çš„ã€‚\næ­£è§£çš„è¯ï¼Œéœ€è¦æˆ‘ä»¬æ·±å…¥æŒ–æ˜è¿™ä¸ªå¼å­ã€‚\næˆ‘ä»¬å…ˆå¿½ç•¥æœ€åä¸€ä¸ªä¸ä¹°ä¸å–çš„æƒ…å†µï¼Œæ¥ç»§ç»­çœ‹ï¼š\n$$\ndp[i] = \\max_{j=1}^{i-1}(dp[j]\\times \\frac{r[j]\\cdot a[i] + b[i]}{r[j] \\cdot a[j]+b[j]})\n$$\nå¯¹äºç»™å®šçš„å†³ç­–ç‚¹ $j$ ï¼Œåˆ™æœ‰ï¼š\n$$\ndp[i] = dp[j] \\times \\frac{r[j]\\cdot a[i] + b[i]}{r[j]\\cdot a[j]+b[j]}\\\ndp[i] = (r[j]\\cdot a[i] + b[i])\\times \\frac{dp[j]}{r[j]\\cdot a[j]+b[j]}\\\ndp[i] = b[i]\\times \\frac{dp[j]}{r[j]\\cdot a[j]+b[j]} + a[i] \\times \\frac{r[j]\\cdot dp[j]}{r[j]\\cdot a[j]+b[j]}\n$$\nå¦‚æœæˆ‘ä»¬ä»¤ï¼š\n$$\nx[j] = \\frac{r[j]\\cdot dp[j]}{r[j]*a[j]+b[j]}, y[j] = \\frac{dp[j]}{r[j]\\cdot a[j]+b[j]}\n$$\né‚£ä¹ˆå¼å­å°±ä¼šå˜æˆï¼š\n$$\ndp[i] = a[i] \\times x[j] + b[i] \\times y[j]\n$$\nç•¥å¾®å˜æ¢ï¼š\n$$\ny[j] = - \\frac{a[i]}{b[i]} \\cdot x[j] + \\frac{dp[i]}{b[i]}\n$$\næˆ‘ä»¬æ³¨æ„åˆ°ï¼Œè¿™é‡Œé¢çš„æ–œç‡ä»…ä¸ $i$ ç›¸å…³ï¼Œ$x,y$ å‡åªä¸ $j$ ç›¸å…³ï¼Œæœ€åçš„æˆªè·ä¸‹é¢é™¤çš„æ˜¯ä¸€ä¸ªå¸¸æ•°ï¼Œé‚£ä¹ˆåªè¦æˆªè·æœ€å¤§ï¼Œ $dp[i]$ å°±ä¼šæœ€å¤§ã€‚\nè€Œä¸”ï¼Œåªè¦ $x[j]$ å’Œ $y[j]$ ä¸€ç»ç¡®å®šï¼Œä¾¿ä¸æ”¹å˜ã€‚\næ‰€ä»¥ç°åœ¨é—®é¢˜å˜æˆï¼šæ”¯æŒæ’å…¥ç‚¹ï¼ŒæŸ¥è¯¢æŸä¸ªç»™å®šæ–œç‡çš„ç›´çº¿ä¸”ç»è¿‡æŸä¸ªç‚¹ï¼Œä½¿å¾—è¿™æ¡ç›´çº¿çš„æˆªè·æœ€å¤§ã€‚\nåœ¨ä»¥å¾€çš„æ–œç‡ä¼˜åŒ–é—®é¢˜é‡Œé¢ï¼Œæˆ‘ä»¬ä¸€èˆ¬æœ‰ä¸¤ä¸ªå•è°ƒæ€§ï¼šæ’å…¥çš„ç‚¹çš„ $x$ åæ ‡å•è°ƒï¼Œç›´çº¿çš„æ–œç‡å•è°ƒã€‚é‚£ä¹ˆæˆ‘ä»¬ç”¨å•è°ƒé˜Ÿåˆ—å°±å¯ä»¥ç»´æŠ¤å‡¸åŒ…ï¼Œç„¶è€Œè¿™é‡Œæˆ‘ä»¬è¿™ä¸¤ä¸ªæ€§è´¨å…¨éƒ½æ²¡æœ‰ï¼Œæ‰€ä»¥æˆ‘ä»¬åªèƒ½ç”¨æ›´é«˜çº§çš„ä¸œè¥¿ï¼Œæ¯”å¦‚ $\\text{CDQ}$ åˆ†æ²»ï¼Œæ¯”å¦‚ $\\text{Splay}$ ã€‚\næˆ‘ç”¨äº† $\\text{Splay}$ æ¥ç»´æŠ¤è¿™ä¸ªä¸Šå‡¸åŒ…ã€‚\nå…·ä½“å®ç°çš„è¯ï¼Œå°±æ˜¯éœ€è¦å¤„ç†ä¸¤ä¸ªé—®é¢˜ï¼šæ‰¾åˆ°ç¬¬ä¸€ä¸ªæ–œç‡è¾ƒç»™å®šå€¼å¤§çš„ç‚¹ï¼Œå’Œæ’å…¥ä¸€ä¸ªç‚¹ã€‚\n  åœ¨ $\\text{Splay}$ ä¸ŠäºŒåˆ†å³å¯ã€‚æœ€å¥½æ˜¯æ¯ä¸ªç‚¹ä»£è¡¨è¿™ä¸ªç‚¹åˆ°å‰ä¸€ä¸ªç‚¹çš„æ–œç‡ã€‚\n  å…ˆåˆ¤æ–­åœ¨ä¸åœ¨å‡¸åŒ…é‡Œï¼Œå†æ ¹æ®xåæ ‡æ’å…¥ï¼Œç„¶ååœ¨å‘ä¸¤è¾¹popï¼Œç»´æŠ¤å‡¸åŒ…æ€§è´¨ã€‚æ³¨æ„popçš„æ¡ä»¶æ¯”è¾ƒå®¹æ˜“å†™é”™ã€‚\n  ä¸çŸ¥é“ä¸ºå•¥ï¼ŒBZOJ ä¸Šè¿‡ä¸äº†ã€‚æœ¬åœ°ä¸‹ä¸‹æ¥æ•°æ®ã€ä¼ åˆ° luogu ä¸Šéƒ½å¯ä»¥è¿‡ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;algorithm\u0026gt;#include \u0026lt;ctime\u0026gt;#include \u0026lt;cmath\u0026gt;#include \u0026lt;cstring\u0026gt;#define eps 1e-10 #define inf 1e10 using namespace std; const int MAXN = 1100000; int n,s; double a[MAXN],b[MAXN],r[MAXN]; double dp[MAXN]; int last[MAXN]; double calx(int j){if(j == 0) return inf;return dp[j]*r[j] / (r[j]*a[j] + b[j]);} double caly(int j){return dp[j] / (r[j]*a[j]+b[j]);} double calc(int i,int j){return calx(j) * a[i] + caly(j) * b[i]; } double cals(int i,int j){ if(j == 0) return -inf; if(i == 0) return inf; double _x = calx(i)-calx(j); double _y = caly(i)-caly(j); //if(fabs(_x) \u0026lt; eps) return _y\u0026gt;0?inf:-inf;  return _y/_x; } namespace Splay{ int p[MAXN\u0026lt;\u0026lt;2];double v[MAXN\u0026lt;\u0026lt;2]; int f[MAXN\u0026lt;\u0026lt;2],c[MAXN\u0026lt;\u0026lt;2][2],cnt; int root;//v å‘å·¦è¿  int newnode(int point,double val = 0){ int x = ++cnt; v[x] = val,p[x] = point; c[x][0] = c[x][1] = 0; return x; } void rotate(int x){ if(!x) return; int y = f[x],z = f[y],t = c[y][1] == x,w = c[x][1-t]; if(z) c[z][c[z][1]==y] = x; c[y][t] = w,c[x][1-t] = y; if(w) f[w] = y; f[x] = z;f[y] = x; if(!f[x]) root = x; } void splay(int x,int tar = 0){ while(f[x]!=tar){ int y = f[x],z = f[y]; if(f[y] != tar){ (c[y][1]==x)^(c[z][1]==y)?rotate(x):rotate(y); }rotate(x); } } int find(int x,double _v){ if(!x) return 0; if(_v \u0026gt; v[x]) return find(c[x][0],_v); else{ int j = find(c[x][1],_v); return j!=0?j:x; } } int nxt(int x,int tmp){ if(!x) return 0; splay(x); int r = c[x][tmp]; if(!r) return 0; while(1){ if(c[r][1-tmp]) r = c[r][1-tmp]; else return r; } } int insert(int x,int fa,int point){ if(!x){ int w = newnode(point); if(fa == 0) root = w; c[fa][calx(point) \u0026gt; calx(p[fa])] = w,f[w] = fa; int _x = nxt(w,0),_y = nxt(w,1); v[w] = cals(p[_x],p[w]); if(_y) v[_y] = cals(p[w],p[_y]); return w; } int tmp = calx(point) \u0026gt; calx(p[x]); return insert(c[x][tmp],x,point); } void erase(int x){ int _x = nxt(x,0),_y = nxt(x,1); if(!_x \u0026amp;\u0026amp; !_y) root = 0; else if(!_x || !_y){ int t = _x == 0?_y:_x,tmp = _x==0?0:1; splay(t),c[t][tmp] = 0; } else{ splay(_x),splay(_y,_x); c[_y][0] = 0; } if(_y) v[_y] = cals(p[_x],p[_y]); } void update(int i){ int w = insert(root,0,i); int x,y; x = nxt(w,0),y = nxt(w,1); if(y \u0026amp;\u0026amp; cals(p[x],p[y]) \u0026lt; v[y]){ erase(w);return; } x = nxt(w,1),y = nxt(x,1); while(y!=0){ if(cals(i,p[x]) \u0026gt; cals(i,p[y])) break; erase(x); x = y; y = nxt(x,1); } x = nxt(w,0),y = nxt(x,0); while(y!=0){ if(cals(p[y],i) \u0026gt; cals(p[x],i)) break; erase(x); x = y; y = nxt(x,0); } } int query(int i){ return find(root,-a[i]/b[i]); } }; int main(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;s); for(int i = 1;i\u0026lt;=n;i++) scanf(\u0026#34;%lf %lf %lf\u0026#34;,\u0026amp;a[i],\u0026amp;b[i],\u0026amp;r[i]); dp[1] = s; Splay::update(1); for(int i = 2;i\u0026lt;=n;i++){ dp[i] = dp[i-1],last[i] = i; int j = Splay::query(i); if(calc(i,j) \u0026gt; dp[i]) last[i] = j,dp[i] = calc(i,j); Splay::update(i); } printf(\u0026#34;%.6lf\\n\u0026#34;,dp[n]); return 0; }   ","description":"","id":117,"section":"posts","tags":["Splay","å¹³è¡¡æ ‘","æ–œç‡ä¼˜åŒ–","åŠ¨æ€è§„åˆ’"],"title":"ã€ŒNOI2007ã€è´§å¸å…‘æ¢-Splay+æ–œç‡ä¼˜åŒ–","uri":"https://blog.chenqiqian.com/posts/noi2007-cash/"},{"content":"ä¸ºäº†åº†ç¥ $NOI$ çš„æˆåŠŸå¼€å¹•ï¼Œä¸»åŠæ–¹ä¸ºå¤§å®¶å‡†å¤‡äº†ä¸€åœºå¯¿å¸æ™šå®´ã€‚å° $G$ å’Œå° $W$ ä½œä¸ºå‚åŠ  $NOI$ çš„é€‰æ‰‹ï¼Œä¹Ÿè¢«é‚€è¯·å‚åŠ äº†å¯¿å¸æ™šå®´ã€‚\nåœ¨æ™šå®´ä¸Šï¼Œä¸»åŠæ–¹ä¸ºå¤§å®¶æä¾›äº† $nâˆ’1$ ç§ä¸åŒçš„å¯¿å¸ï¼Œç¼–å· $1,2,3,â‹¯,n-1$ ï¼Œå…¶ä¸­ç¬¬ç§å¯¿å¸çš„ç¾å‘³åº¦ä¸º $i+1$ï¼ˆå³å¯¿å¸çš„ç¾å‘³åº¦ä¸ºä» $2$ åˆ° $n$ ï¼‰ã€‚\nç°åœ¨å° $G$ å’Œå° $W$ å¸Œæœ›æ¯äººé€‰ä¸€äº›å¯¿å¸ç§ç±»æ¥å“å°ï¼Œä»–ä»¬è§„å®šä¸€ç§å“å°æ–¹æ¡ˆä¸ºä¸å’Œè°çš„å½“ä¸”ä»…å½“ï¼šå° $G$ å“å°çš„å¯¿å¸ç§ç±»ä¸­å­˜åœ¨ä¸€ç§ç¾å‘³åº¦ä¸º $x$ çš„å¯¿å¸ï¼Œå° $W$ å“å°çš„å¯¿å¸ä¸­å­˜åœ¨ä¸€ç§ç¾å‘³åº¦ä¸º $y$ çš„å¯¿å¸ï¼Œè€Œ $x$ ä¸ $y$ ä¸äº’è´¨ã€‚\nç°åœ¨å° $G$ å’Œå° $W$ å¸Œæœ›ç»Ÿè®¡ä¸€å…±æœ‰å¤šå°‘ç§å’Œè°çš„å“å°å¯¿å¸çš„æ–¹æ¡ˆï¼ˆå¯¹ç»™å®šçš„æ­£æ•´æ•° $p$ å–æ¨¡ï¼‰ã€‚æ³¨æ„ä¸€ä¸ªäººå¯ä»¥ä¸åƒä»»ä½•å¯¿å¸ã€‚\né“¾æ¥ Luogu P2150\né¢˜è§£ éš¾æ­»äº†qaq\nå¯¹äºæ²¡æœ‰ä»€ä¹ˆç‰¹æ®ŠèƒŒæ™¯çš„è®¡æ•°é¢˜ï¼Œå¾ˆå¤§å¯èƒ½ä¸Šéƒ½æ˜¯ $dp$ ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¥å¦‚ä½• $dp$ ã€‚\nè¿™é‡Œé¢æœ€éš¾æ»¡è¶³çš„æ¡ä»¶æ˜¯ï¼š\n å° $G$ å“å°çš„å¯¿å¸ç§ç±»ä¸­å­˜åœ¨ä¸€ç§ç¾å‘³åº¦ä¸º $x$ çš„å¯¿å¸ï¼Œå° $W$ å“å°çš„å¯¿å¸ä¸­å­˜åœ¨ä¸€ç§ç¾å‘³åº¦ä¸º $y$ çš„å¯¿å¸ï¼Œè€Œ $x$ ä¸ $y$ ä¸äº’è´¨ã€‚\n ä¸¤ä¸ªæ•°ä¸äº’è´¨çš„æƒ…å†µå³ä¸ºï¼šä¸¤ä¸ªæ•°åˆ†è§£è´¨å› æ•°ä¹‹åæœ‰ç›¸åŒçš„è´¨å› å­ï¼Œè€Œä¸”ä¸è¯¥è´¨å› å­å‡ºç° $1$ æ¬¡è¿˜æ˜¯ $2$ æ¬¡æ— å…³ã€‚\nç„¶åæˆ‘ä»¬æœ‰æ³¨æ„åˆ°æ‰€æœ‰çš„ $n$ å‡å°äº $500$ ï¼Œè¿™æ„å‘³ç€æœ€å¤šåªä¼šæœ‰ä¸€ä¸ªè´¨å› å­å¤§äº $\\sqrt {500} \\approx 22.36 \u0026lt; 23$ ï¼Œå°äº $23$ çš„è´¨æ•°ä¸€å…±æœ‰ $8$ ä¸ªï¼š $2,3,5,7,11,13,17,19$ ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å‹ä½å­˜å‚¨è¿™äº›è´¨å› æ•°æœ‰æ²¡æœ‰å‡ºç°ï¼Œå¯¹äºå¯èƒ½å‡ºç°çš„æœ€åä¸€ä¸ªå¤§è´¨å› æ•°ï¼Œæˆ‘ä»¬å†ç”¨ä¸€ä¸ª int å­˜å‚¨ï¼ˆæ²¡æœ‰åˆ™ä¸º $1$ ï¼‰ï¼Œè¿™æ ·çš„è¯æˆ‘ä»¬å°±ç”¨ä¸€ä¸ªç®€å•æ¯”è¾ƒçš„æ–¹å¼å­˜å‚¨äº†è¿™ä¸ªæ•°æ‰€æœ‰å¯¹é€‰å–é€ æˆå½±å“çš„å†…å®¹ã€‚\nç„¶åæˆ‘ä»¬æ€è€ƒå¦‚ä½•è¡¨ç¤ºçŠ¶æ€ã€‚\næ˜¾ç„¶ï¼Œæˆ‘ä»¬ä¸å¯èƒ½å°†å¤§è´¨æ•°è¡¨ç¤ºè¿›çŠ¶æ€é‡Œé¢ï¼Œå¦åˆ™çš„è¯æ˜¯éå¸¸éš¾ä»¥è½¬ç§»è€Œä¸”ç©ºé—´å¤§çº¦æ˜¯å¼€ä¸ä¸‹çš„ã€‚\næ‰€ä»¥æˆ‘ä»¬æ€è€ƒä¸€ä¸‹å¦‚ä½•é¿å…å¤§è´¨æ•°çš„å½±å“ã€‚\nå¦‚æœæŸäº›æ•°å­—éƒ½å…·æœ‰ä¸€ä¸ªå¤§è´¨å› å­ï¼Œé‚£ä¹ˆè¿™äº›æ•°å­—å¿…ç„¶æ˜¯ä¸èƒ½åŒæ—¶é€‰çš„ï¼Œé‚£ä¹ˆåªæœ‰ä¸¤ç§å¯èƒ½æ€§ï¼š\n åªæœ‰å° $\\text{G}$ é€‰äº†å…·æœ‰è¿™ä¸ªå¤§è´¨å› å­çš„æ•°ä¸­çš„æŸäº›æ•° åªæœ‰å° $\\text{W}$ é€‰äº†å…·æœ‰è¿™ä¸ªå¤§è´¨å› å­çš„æ•°ä¸­çš„æŸäº›æ•° ä¸¤ä¸ªäººéƒ½æ²¡é€‰è¿™ä¸¤ä¸ªç»„ä¸­çš„ä»»ä½•ä¸€ä¸ªæ•°  é‚£ä¹ˆæˆ‘ä»¬è€ƒè™‘è¿™æ ·åˆ†ç±»ã€‚\né‚£ä¹ˆæˆ‘ä»¬åˆ†åˆ«å¯¹æ¯ä¸€ä¸ªå¤§è´¨å› æ•°è¿›è¡Œè®¨è®ºï¼ˆæ²¡æœ‰å¤§è´¨å› æ•°çš„æ—¶å€™ï¼Œå°±æ˜¯æ¯ä¸€ä¸ªæ•°å°±ç›¸å½“äºå¤§è´¨å› æ•°çš„æ”¹å˜ï¼Œå› ä¸ºä¸€ä¸ªæ•°ä¸èƒ½è¢«ä¸¤ä¸ªäººåŒæ—¶é€‰ï¼‰ï¼š\nè®¾ $g[k][0/1][S_i][S_j]$ ä¸ºå½“å‰å·²ç»è€ƒè™‘å®Œè¯¥ç»„çš„å‰ $k-1$ ä¸ªæ•°ï¼Œç”±å° $\\text{G}$ æˆ–è€…å° $\\text{W}$ å–å…·æœ‰è¿™ä¸ªå¤§è´¨æ•°çš„æ•°ï¼Œç›®å‰çš„å° $\\text{G}$ çš„å°è´¨æ•°é›†åˆæ˜¯ $S_i$ ï¼Œå° $\\text{W}$ çš„å°è´¨æ•°é›†åˆæ˜¯ $S_j$ ï¼Œç¬¬ $k$ ä¸ªæ•°çš„å°è´¨æ•°é›†åˆä¸º $N_k$ï¼Œé‚£ä¹ˆæˆ‘ä»¬æœ‰å¦‚ä¸‹çš„è½¬ç§»ï¼š\n$$\ng ([k+1])[0][S_i \\cap N_k][S_j] = g([k])[0][S_i \\cap N_k][S_j] + g([k])[0][S_i][S_j]\\\ng ([k+1])[1][S_i][S_j \\cap N_k] = g([k])[1][S_i][S_j \\cap N_k] + g([k])[1][S_i][S_j]\n$$\nä¹Ÿå°±æ˜¯å¯¹äºä¸¤ç§æƒ…å†µéƒ½æœ‰ä¸¤ç§å†³ç­–ï¼šå–æˆ–è€…ä¸å–è¿™ä¸ªæ•°ã€‚\nè¿™é‡Œéœ€è¦ç”¨æ»šåŠ¨æ•°ç»„ï¼Œæ‰€ä»¥ç¬¬ä¸€ç»´éƒ½æ‰“ä¸Šäº†æ‹¬å·ï¼Œè¿™é‡Œéœ€è¦é€†åºè½¬ç§»ã€‚\nä¸ºäº†ä»åˆ†ç»„è®¡ç®—è½¬æ¢åˆ°æœ€åçš„ç­”æ¡ˆï¼Œæˆ‘ä»¬éœ€è¦å†è®¾è®¡ä¸€ç»„çŠ¶æ€ï¼Œå°±æ˜¯è¡¨è¾¾åœ¨è¿™è‹¥å¹²ç»„ä¹‹é—´çš„ä¸€ä¸ªå…³ç³»ã€‚\næ¯”å¦‚æˆ‘ä»¬è®¾ $f[k][S_i][S_j]$ è¡¨ç¤ºè€ƒè™‘å®Œå‰ $k-1$ ç»„ï¼Œç”±å° $\\text{G}$ æˆ–è€…å° $\\text{W}$ å–å…·æœ‰è¿™ä¸ªå¤§è´¨æ•°çš„æ•°ï¼Œç›®å‰çš„å° $\\text{G}$ çš„å°è´¨æ•°é›†åˆæ˜¯ $S_i$ ï¼Œå° $\\text{W}$ çš„å°è´¨æ•°é›†åˆæ˜¯ $S_j$ ï¼Œç¬¬ $k$ ç»„çš„æ•°çš„æ•°ç›®æ˜¯ $num_{k}$ é‚£ä¹ˆæˆ‘ä»¬æœ‰å¦‚ä¸‹çš„è½¬ç§»ï¼š\n$$\nf([k])[S_i][S_j] = g([num_k])[0][S_i][S_j] + g([num_k])[1][S_i][S_j] - f([k-1])[S_i][S_j]\n$$\nè€Œä¸”è¿™ä¸ªæ—¶å€™**$g([0])[0/1][S_i][S-j] = f([k-1])[S_i][S_j]$** ï¼Œè¿™ä¸ªæ„æ€å°±æ˜¯ï¼šè®©å° $\\text{G}$ é€‰è¿™ä¸€ç»„ï¼Œæˆ–è€…è®©å° $\\text{W}$ é€‰è¿™ä¸€ç»„ã€‚ä½†æ˜¯å®ƒä»¬éƒ½æœ‰å¯èƒ½å¾ˆè°¦è™šä¸€ä¸ªéƒ½ä¸é€‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬æœ€åè¦å‰ªæ‰ä¸€ä¸ªä¸¤ä¸ªéƒ½ä¸é€‰çš„æ•°ç›®ã€‚\n$f$ æ•°ç»„ä¹Ÿå¯ä»¥ç”¨æ»šåŠ¨æ•°ç»„ä¼˜åŒ–ã€‚\næœ€åç©ºé—´å¤æ‚åº¦æ˜¯ $O(n \\times 2^{16})$ ï¼Œç©ºé—´å¤æ‚åº¦ $O(2\\times 2^{16})$ ã€‚\nä»£ç  #include \u0026lt;cstdio\u0026gt; #include \u0026lt;cstring\u0026gt; #include \u0026lt;algorithm\u0026gt; using namespace std; #define pii pair\u0026lt;int,int\u0026gt; #define ll long long const int MAXN = 256; int prime[8] = {2,3,5,7,11,13,17,19}; ll n,p; ll f[MAXN][MAXN],g[2][MAXN][MAXN]; pii s[MAXN*2]; void init(){ scanf(\u0026quot;%lld %lld\u0026quot;,\u0026amp;n,\u0026amp;p); for(int i = 2;i\u0026lt;=n;i++){ int t = i; for(int j = 0;j\u0026lt;8;j++){ while(t % prime[j] == 0){ s[i].second |= (1\u0026lt;\u0026lt;j); t/=prime[j]; } } s[i].first = t; } sort(s+2,s+n+1); //\tfor(int i = 2;i\u0026lt;=n;i++){ //\tprintf(\u0026quot;%d:%d %d\\n\u0026quot;,i,s[i].first,s[i].second); //\t} } void calc(){ f[0][0] = 1; for(int i = 2;i\u0026lt;=n;i++){ if(i==2||s[i].first==1||s[i].first != s[i-1].first){ memcpy(g[0],f,sizeof(f)),memcpy(g[1],f,sizeof(f)); } for(int j = MAXN-1;~j;--j){ for(int k = MAXN-1;~k;--k){ if((k \u0026amp; s[i].second) == 0) (g[0][j|s[i].second][k] += g[0][j][k])%=p; if((j \u0026amp; s[i].second) == 0) (g[1][j][k|s[i].second] += g[1][j][k])%=p; } } if(i==n || s[i].first==1||s[i].first != s[i+1].first){ for(int j = 0;j\u0026lt;MAXN;j++){ for(int k = 0;k\u0026lt;MAXN;k++){ if((j\u0026amp;k)==0) f[j][k] = (g[0][j][k] + g[1][j][k] - f[j][k])%p; } } } } } void output(){ ll ans = 0; for(int i = 0;i\u0026lt;MAXN;i++){ for(int j = 0;j\u0026lt;MAXN;j++){ if((i\u0026amp;j)==0) (ans += f[i][j])%=p; } } printf(\u0026quot;%lld\\n\u0026quot;,(ans%p+p)%p); } int main(){ init(); calc(); output(); return 0; } ","description":"","id":118,"section":"posts","tags":["åŠ¨æ€è§„åˆ’","çŠ¶å‹dp"],"title":"ã€ŒNOI2015ã€å¯¿å¸æ™šå®´-çŠ¶å‹dp","uri":"https://blog.chenqiqian.com/posts/noi2015-dinner/"},{"content":"ä»¥ä¸‹æœ‰å‡ é“è«æ¯”ä¹Œæ–¯åæ¼”å…¥é—¨é¢˜çš„è¯¦å°½ç‰ˆçš„é¢˜è§£ï¼ˆå…¬å¼æ¨æ¼”ï¼‰ã€‚\n[POI2007]ZAP-Queries é¢˜æ„ æ±‚ï¼š\n$$\n\\sum_{i=1}^n \\sum_{j=1}^m [\\gcd(i,j)=d]\n$$\nè§£æ³•1 å€’ä¸€å€’å¼å­ï¼š\n$$\n\\text{ans} = \\sum_{i=1}^n \\sum_{j=1}^m [\\gcd(i,j)=d]\\\n=\\sum_{i=1}^{\\lfloor \\frac{n}{d} \\rfloor} \\sum_{j=1}^{\\lfloor \\frac{m}{d} \\rfloor} [\\gcd(i,j)=1]\\\n$$\nè®¾\n$$\nf(d) = \\sum_{i=1}^{x}\\sum_{j=1}^{y} [\\gcd(i,j)=d]\\\n$$\nè‹¥ï¼š\n$$\ng(d) = \\sum_{d|k} f(k)\n$$\nåˆ™å¯ä»¥å‘ç° $g(d) = \\lfloor \\frac{x}{d} \\rfloor \\cdot \\lfloor \\frac{y}{d} \\rfloor$\nåæ¼”å¾—ï¼š\n$$\nf(d) = \\sum_{d|k} \\mu(\\frac{k}{d}) g(k)\n$$\né‚£ä¹ˆï¼š\n$$\nf(1) = \\sum_{k=1}^{\\min(x,y)} \\mu(k) g(k)\n$$\næ‰€ä»¥ï¼š\n$$\n\\text{ans} = f(1) = \\sum_{k=1}^{\\min(\\lfloor \\frac{n}{d} \\rfloor,\\lfloor \\frac{m}{d} \\rfloor)} \\mu(k) g(k)\\\n= \\sum_{k=1}^{\\min(\\lfloor \\frac{n}{d} \\rfloor,\\lfloor \\frac{m}{d} \\rfloor)} \\mu(k) \\cdot \\lfloor \\frac{x}{d} \\rfloor \\lfloor \\frac{y}{d} \\rfloor\\\n$$\nå¯ä»¥åˆ©ç”¨æ•´é™¤åˆ†å—ï¼Œå•æ¬¡æŸ¥è¯¢æ—¶é—´æ—¶é—´å¤æ‚åº¦ $O(\\sqrt n)$ã€‚æ‰€ä»¥æ—¶é—´å¤æ‚åº¦æ˜¯ $O(n + T\\sqrt n)$ ã€‚\n[HAOI2011]Problem b é¢˜æ„ æ±‚ï¼š\n$$\n\\sum_{x=a}^b \\sum_{y=c}^d [gcd(x,y)=d]\n$$\nè§£æ³• è®¾ï¼š\n$$\n\\text{ans} = F(a,b,c,d) = \\sum_{x=a}^b \\sum_{y=c}^d [gcd(x,y)=d],\\\nG(n,m) = \\sum_{x=1}^n \\sum_{y=1}^m [gcd(x,y)=d]\n$$\nåˆ©ç”¨å®¹æ–¥åŸç†ï¼Œå¯ä»¥å‘ç°è¿™ä¸ªå¼å­å¯ä»¥è½¬åŒ–æˆ\n$$\nF(a,b,c,d) \\= G(b,d) - G(a-1,d) - G(b,c-1) + G(a-1,c-1)\n$$\nç„¶åæ¯ä¸€ä¸ª $G(n,m)$ éƒ½å¯ä»¥æŒ‰ç…§ä¸Šé¢˜çš„å•æ¬¡ $O(\\sqrt n)$ çš„åšæ³•æ±‚å‡ºã€‚æ‰€ä»¥æ—¶é—´å¤æ‚åº¦æ˜¯ $O(n + T\\sqrt n)$ ã€‚\nYYçš„GCD é¢˜æ„ æ±‚ï¼š\n$$\n\\sum_{i=1}^{k} \\sum_{x=1}^n \\sum_{y=1}^m [gcd(i,j)=p_i]\\\n$$\nè§£æ³•1 $$\n\\sum_{i=1}^{k} \\sum_{x=1}^n \\sum_{y=1}^m [gcd(i,j)=p_i]\\\n= \\sum_{i=1}^k \\sum_{x=1}^{\\lfloor \\frac{n}{p_i} \\rfloor} \\sum_{y=1} ^{\\lfloor \\frac{m}{p_i}\\rfloor}\n[gcd(i,j)=1]\n$$\nè®¾\n$$\nf(k) = \\sum_{i=1}^n \\sum_{j=1}^m [gcd(i,j)=k]\n$$\nè‹¥\n$$\ng(k) = \\sum_{k|d} f(d)\n= \\lfloor \\frac{n}{k} \\rfloor \\cdot \\lfloor \\frac{m}{k} \\rfloor\n$$\nè«æ¯”ä¹Œæ–¯åæ¼”å¾—\n$$\nf(k) = \\sum_{k|d} \\mu(\\frac{d}{k}) g(d)\n= \\sum_{i = 1}^{\\lfloor \\frac{\\min(n,m)}{k} \\rfloor}\\mu(i)g(ik)\\\n= \\sum_{i = 1}^{\\lfloor \\frac{\\min(n,m)}{k} \\rfloor}\\mu(i) \\lfloor \\frac{n}{ik} \\rfloor \\cdot \\lfloor \\frac{m}{ik} \\rfloor\n$$\næ‰€ä»¥\n$$\nf(1) = \\sum_{i = 1}^{ \\min(n,m) }\\mu(i) \\cdot \\lfloor \\frac{n}{i} \\rfloor \\cdot \\lfloor \\frac{m}{i} \\rfloor\n$$\nåˆ™åŸå¼ï¼š\n$$\n\\sum_{i=1}^k \\sum_{x=1}^{\\lfloor \\frac{n}{p_i} \\rfloor} \\sum_{y=1} ^{\\lfloor \\frac{m}{p_i}\\rfloor}\n[gcd(i,j)=1]\\\n= \\sum_{i=1}^k \\sum_{d=1}^{\\min(\\lfloor \\frac{n}{p_i} \\rfloor,\\lfloor \\frac{m}{p_i} \\rfloor )}\\mu(d) \\cdot \\lfloor \\frac{n}{d p_i} \\rfloor \\cdot \\lfloor \\frac{m}{dp_i} \\rfloor\\\n$$\nè®¾$T_i = d p_i$ï¼Œåˆ™æœ‰ï¼š\nåŸå¼\n$$\n\\sum_{i=1}^k \\sum_{d=1}^{\\min(\\lfloor \\frac{n}{p_i} \\rfloor,\\lfloor \\frac{m}{p_i} \\rfloor )}\\mu(d) \\cdot \\lfloor \\frac{n}{d p_i} \\rfloor \\cdot \\lfloor \\frac{m}{dp_i} \\rfloor\\\n= \\sum_{i=1}^k \\sum_{d=1}^{\\min(\\lfloor \\frac{n}{p_i} \\rfloor,\\lfloor \\frac{m}{p_i} \\rfloor )}\\mu(\\frac{T_i}{p_i}) \\cdot \\lfloor \\frac{n}{T_i} \\rfloor \\cdot \\lfloor \\frac{m}{T_i} \\rfloor\\\n= \\sum_{i=1}^k \\sum_{p_i | T}\\mu(\\frac{T}{p_i}) \\cdot \\lfloor \\frac{n}{T} \\rfloor \\cdot \\lfloor \\frac{m}{T} \\rfloor\\\n= \\sum_{T=1}^{\\min(n,m)} \\sum_{p_i|T} \\mu(\\frac{T}{p_i}) \\cdot \\lfloor \\frac{n}{T} \\rfloor \\cdot \\lfloor \\frac{m}{T} \\rfloor\\\n= \\sum_{T=1}^{\\min(n,m)} \\lfloor \\frac{n}{T} \\rfloor \\lfloor \\frac{m}{T} \\rfloor \\sum_{p_i|T} \\mu(\\frac{T}{p_i}) \\\n$$\nä»¤\n$$\nh(x) = \\sum_{p_i|x} \\mu(\\frac{x}{p_i})\n$$\næ‰€ä»¥åŸå¼åŒ–ä¸ºï¼š\n$$\n\\sum_{T=1}^{\\min(n,m)} \\lfloor \\frac{n}{T} \\rfloor \\lfloor \\frac{m}{T} \\rfloor \\sum_{p_i|T} \\mu(\\frac{T}{p_i}) \\\n= \\sum_{i=1}^{\\min(n,m)} \\lfloor \\frac{n}{i} \\rfloor \\lfloor \\frac{m}{i} \\rfloor h(i)\n$$\nåªéœ€è¦æ±‚å‡º $h(i)$ çš„å‰ç¼€å’Œï¼Œæˆ‘ä»¬å°±å¯ä»¥ $O(\\sqrt{n})$ æ•´é™¤åˆ†å—ç®—å‡ºã€‚\nè§‚å¯Ÿ\n$$\nh(x) = \\sum_{p_i|x} \\mu(\\frac{x}{p_i})\n$$\nå¯ä»¥å‘ç°ï¼Œå¦‚æœæˆ‘ä»¬æšä¸¾æ¯ä¸ªè´¨æ•°ï¼Œå†å°†æ‰€æœ‰çš„è¯¥è´¨æ•°çš„å€æ•°çš„g[i * prime[j]] += mu[i]éƒ½åŠ ä¸Šå»ã€‚\nç”±äºæšä¸¾å€æ•°çš„è°ƒå’Œçº§æ•° $\\frac{n}{1} + \\frac{n}{2} + \\cdots + \\frac{n}{n} = O(\\ln n + r)$ ,æ‰€ä»¥è¿™ä¸ªæšä¸¾è¿‡ç¨‹çš„å¤æ‚åº¦æ˜¯ $O(n \\ln n)$ çš„ã€‚\næ³¨æ„åˆ°è¿™ä¸ª $h(x)$ åº”å½“ä¹Ÿæ˜¯ä¸€ä¸ªç§¯æ€§å‡½æ•°ï¼Œæ‰€ä»¥äº‹å®ä¸Šå¯ä»¥åœ¨çº¿æ€§ç´ æ•°ç­›çš„æ—¶å€™ç›´æ¥è®¡ç®—å‡º $h(x)$ çš„å€¼ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±æ˜¯ $O(n)$ çš„ã€‚\n[NOI2010]èƒ½é‡é‡‡é›† é¢˜æ„ ç»™å®šä¸¤ä¸ªæ•´æ•°$n,m$ï¼Œå¯¹äºå¹³é¢ä¸Šçš„æ•´ç‚¹ ${(x,y)|x \\in [1,n],y \\in [1,m],x,y \\in \\mathbb Z}$ ã€‚è‹¥ $(x,y)$ ä¸ $(0,0)$ çš„è¿çº¿ä¸Šæœ‰ $k$ ä¸ªæ•´ç‚¹ï¼ˆä¸åŒ…æ‹¬ $(0,0)$ , $(n,m)$ï¼‰ï¼Œåˆ™äº§ç”Ÿçš„è´¡çŒ®ä¸º $2k+1$ ã€‚æ±‚æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„ç‚¹çš„è´¡çŒ®æ€»å’Œã€‚\nè§£æ³• ä¸€ä¸ªç»“è®ºï¼šä» $(0,0)$ åˆ° $(n,m)$ çš„çº¿è·¯ä¸Šï¼Œæœ‰ $\\gcd(n,m)-1$ ä¸ªæ•´ç‚¹(ä¸åŒ…æ‹¬ $(0,0)$ , $(n,m)$ )ã€‚\næƒ³ä¸€æƒ³å¾ˆå¥½æ˜ç™½ï¼šä»¤ $t$ æ˜¯ $n,m$ çš„å…¬å› æ•° $(\\frac {n}{t} , \\frac {m}{t})$ å°±ç›¸å½“äºæ­¥é•¿ï¼Œ $m,n$ ä¸€å®šæ—¶ $t$ è¶Šå¤§ï¼Œæ­¥é•¿è¶Šå°ï¼Œæ•´ç‚¹å°±è¶Šå¤šã€‚ $\\gcd(n,m)$ æ˜¯ $n$ ,$ m$ çš„æœ€å¤§å…¬å› æ•°ï¼Œæ‰€ä»¥å°±æ˜¯æœ€å¤šæ•´ç‚¹çš„ä¸ªæ•°äº†ã€‚\næ‰€ä»¥é—®é¢˜è½¬åŒ–ä¸ºï¼š\næ±‚\n$$\n\\sum_{i = 1}^{n} \\sum_{j = 1}^{m}2\\times \\gcd(n,m)-1\n$$\nçš„å€¼ã€‚\næˆ‘ä»¬è¿›è¡Œä¸€äº›å¾®å°çš„å˜æ¢ï¼š\n$$\n\\sum_{i = 1}^{n} \\sum_{j = 1}^{m}2\\times \\gcd(n,m)-1\\\n= (2 \\sum_{i = 1}^{n} \\sum_{j = 1}^{m}\\gcd(n,m)) - n \\times m\n$$\né—®é¢˜è½¬åŒ–ä¸ºæ±‚ï¼š\n$$\n\\sum_{i = 1}^{n} \\sum_{j = 1}^{m}\\gcd(n,m)\n$$\n$$\n\\text{ans} = \\sum_{i = 1}^{n} \\sum_{j = 1}^{m}\\gcd(n,m)\\\n= \\sum_{d=1}^{\\min(n,m)} d \\times (\\sum_{i=1}^{\\lfloor \\frac{n}{d} \\rfloor} \\sum_{j=1}^{\\lfloor \\frac{m}{d} \\rfloor} [\\gcd(i,j)=1])\\\n$$\nè®¾ï¼š\n$$\nf(d) = \\sum_{i=1}^{x} \\sum_{j=1}^{y} [\\gcd(i,j)=d]\n$$\nç”±ç¬¬ä¸€é¢˜ï¼Œå¯ä»¥å‘ç°ï¼š\n$$\nf(1) = \\sum_{i = 1}^{ \\min(x,y) }\\mu(i) \\cdot \\lfloor \\frac{x}{i} \\rfloor \\cdot \\lfloor \\frac{y}{i} \\rfloor\n$$\nå›ä»£å¾—ï¼š\n$$\n\\text{ans} = \\sum_{d=1}^{\\min(n,m)} d \\times (\\sum_{i = 1}^{ \\min(\\lfloor \\frac{n}{d} \\rfloor,\\lfloor \\frac{m}{d} \\rfloor) }\\mu(i) \\cdot \\lfloor \\frac{n}{id} \\rfloor \\cdot \\lfloor \\frac{m}{id} \\rfloor)\\\n$$\nè®¾ $T = id$ï¼Œå¯ä»¥å¾—åˆ°ï¼š\n$$\n\\text{ans} = \\sum_{d=1}^{\\min(n,m)} d \\times (\\sum_{i = 1}^{ \\min(\\lfloor \\frac{n}{d} \\rfloor,\\lfloor \\frac{m}{d} \\rfloor) }\\mu(i) \\cdot \\lfloor \\frac{n}{T} \\rfloor \\cdot \\lfloor \\frac{m}{T} \\rfloor)\\\n$$\næ”¹ä¸ºæšä¸¾ $T$ï¼Œå¾—åˆ°ï¼š\n$$\n\\text{ans} = \\sum_{T=1}^{\\min(n,m)} \\lfloor \\frac{n}{T} \\rfloor \\cdot \\lfloor \\frac{m}{T} \\rfloor (\\sum_{d|T} \\mu(\\frac{T}{d}) \\cdot d)\n$$\nå¦‚æœä»¤ï¼š\n$$\nh(T) = \\sum_{d|T} \\mu(\\frac{T}{d}) \\cdot d\n$$\nå‘ç° $h(T)$ æ˜¯ä¸€ä¸ªç§¯æ€§å‡½æ•°ï¼Œæ‰€ä»¥å¯ä»¥ $O(n)$ çº¿æ€§ç­›å‡ºæ¥ï¼Œ ç„¶åå°±å¯ä»¥å¾—åˆ°ï¼š\n$$\n\\text{ans} = \\sum_{T=1}^{\\min(n,m)} h(T) \\cdot \\lfloor \\frac{n}{T} \\rfloor \\cdot \\lfloor \\frac{m}{T} \\rfloor\n$$\nåˆ©ç”¨æ•´é™¤åˆ†å—å¯ä»¥åšåˆ° $O(\\sqrt n)$ å•æ¬¡è¯¢é—®ã€‚\næ—¶é—´å¤æ‚åº¦ï¼š $O(n + \\sqrt n)$\nè¿™é¢˜äº¦å¯ $O(n \\log n)$ æ‰‹åŠ¨æ¨¡æ‹Ÿå®¹æ–¥åŸç†ã€‚\n[å›½å®¶é›†è®­é˜Ÿ]Crashçš„æ•°å­—è¡¨æ ¼ é¢˜æ„ æ±‚ï¼š\n$$\n\\sum_{x=1}^{n} \\sum_{y=1}^{m} \\text{lcm}(x,y)\n$$\næ•°æ®èŒƒå›´ï¼š $n,m \\leq 10^7$\nè§£æ³•1 $O(n)$ $$\n\\sum_{x=1}^{n} \\sum_{y=1}^{m} \\text{lcm}(x,y)\\\n= \\sum_{x=1}^{n} \\sum_{y=1}^{m} \\frac{xy}{\\gcd(x,y)}\n$$\næˆ‘ä»¬å¯ä»¥æšä¸¾ $\\gcd(x,y)$ çš„å€¼ $d$ ï¼Œç„¶åå°±æŠŠå¼å­åŒ–æˆï¼š\n$$\n\\sum_{x=1}^{n} \\sum_{y=1}^{m} \\frac{xy}{\\gcd(x,y)}\\\n= \\sum_{d=1}^{\\min(n,m)}\\sum_{x=1}^{n} \\sum_{y=1}^m \\frac{xy}{d} [\\gcd(x,y) = d]\\\n= \\sum_{d=1}^{\\min(n,m)} d ; \\sum_{i=1}^{\\lfloor \\frac{n}{d} \\rfloor} \\sum_{j=1}^{\\lfloor \\frac{m}{d} \\rfloor} ij[\\gcd(i,j)=1]\\\n$$\nè®¾ï¼š\n$$\nF(x,y) = \\sum_{i=1}^{x} \\sum_{j=1}^{y} ij[\\gcd(i,j)=1]\\\n$$\nåˆ™ï¼š\n$$\n\\text{ans} = \\sum_{d=1}^{\\min(n,m)} d \\cdot F(\\lfloor \\frac{n}{d}\\rfloor,\\lfloor \\frac{m}{d}\\rfloor)\n$$\nè®¾ï¼š\n$$\nh(x,y) = \\sum_{i=1}^x \\sum_{j=1}^y ij\n= \\frac{x(x+1)}{2} \\cdot \\frac{y(y+1)}{2}\n$$\n$h(x,y)$ å¯ä»¥ $O(1)$ è®¡ç®—å¾—åˆ°ã€‚\næˆ‘ä»¬è¿›è¡Œè«æ¯”ä¹Œæ–¯åæ¼”ï¼Œå°è¯•æ±‚å‡º $F(x,y)$ çš„å€¼ï¼š\nï¼ˆä»¥ä¸‹é»˜è®¤ä¸Šç•Œåˆ†åˆ«ä¸º $x,y$ï¼‰\nè®¾\n$$\nf(d) = \\sum_{i=1}^{x} \\sum_{j=1}^{y} ij[\\gcd(i,j)=d],g(d) = \\sum_{d|k} f(k)\\\n$$\næˆ‘ä»¬å‘ç°ï¼Œ $g(d)$ äº‹å®ä¸Šå¯ä»¥è¡¨ç¤ºä¸ºï¼š\n$$\ng(d) = d^2 \\times \\sum_{i=1}^{\\lfloor \\frac{x}{d} \\rfloor} \\sum_{j=1}^{\\lfloor \\frac{y}{d} \\rfloor} ij = d^2 \\times h(\\lfloor \\frac{x}{d} \\rfloor, \\lfloor \\frac{y}{d} \\rfloor)\n$$\nç»è¿‡åæ¼”ï¼š\n$$\nf(d) = \\sum_{d|k} \\mu(\\frac{k}{d}) g(k)\\\n= \\sum_{d|k} \\mu(\\frac{k}{d}) \\cdot k^2 \\cdot h(\\lfloor \\frac{x}{k} \\rfloor, \\lfloor \\frac{y}{k} \\rfloor)\n$$\næ‰€ä»¥ï¼š\n$$\nf(1) = \\sum_{k=1}^{\\min(x,y)} \\mu(k) \\cdot k^2 \\cdot h(\\lfloor \\frac{x}{k} \\rfloor, \\lfloor \\frac{y}{k} \\rfloor)\n$$\né‚£ä¹ˆï¼Œ\n$$\nF(x,y) = f(1) = \\sum_{k=1}^{\\min(x,y)} \\mu(k) \\cdot k^2 \\cdot h(\\lfloor \\frac{x}{k} \\rfloor, \\lfloor \\frac{y}{k} \\rfloor)\n$$\nè¿™ä¸ªä¸œè¥¿å¯ä»¥æ•´é™¤åˆ†å—ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¯è®¡ç®—ä¸€ä¸ª $F(x,y)$ çš„å¤æ‚åº¦æ˜¯ $O(\\sqrt{n})$ï¼Œæ ¹æ®ï¼š\n$$\n\\text{ans} = \\sum_{d=1}^{\\min(n,m)} d \\cdot F(\\lfloor \\frac{n}{d}\\rfloor,\\lfloor \\frac{m}{d}\\rfloor)\n$$\næˆ‘ä»¬å‘ç°ï¼Œè¿™é‡Œå¯¹äºæ‰€æœ‰çš„ $d$ æ¥è¯´ï¼Œ $\\lfloor \\frac{n}{d}\\rfloor$ ä¸ $\\lfloor \\frac{m}{d}\\rfloor$ ä¹Ÿæœ€å¤šåˆ†åˆ«æœ‰ $\\sqrt{n}$ ä¸ªå–å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ€å¤šåªéœ€è¦è®¡ç®— $O(\\sqrt{n})$ æ¬¡ $F(x,y)$ ï¼Œæ‰€ä»¥æœ€åçš„æ—¶é—´å¤æ‚åº¦æ˜¯ $O(n)$ã€‚\nè§£æ³•2 $O(n + T\\sqrt {n})$ æˆ‘ä»¬æœ‰\n$$\n\\text{ans} = \\sum_{d=1}^{\\min(n,m)} d \\cdot F(\\lfloor \\frac{n}{d}\\rfloor,\\lfloor \\frac{m}{d}\\rfloor)\n$$\nåˆï¼š\n$$\nF(x,y) = \\sum_{k=1}^{\\min(x,y)} \\mu(k) \\cdot k^2 \\cdot h(\\lfloor \\frac{x}{k} \\rfloor, \\lfloor \\frac{y}{k} \\rfloor)\\\n$$\nä»£å…¥å¾—ï¼š\n$$\n\\text{ans} = \\sum_{d=1}^{\\min(n,m)} d \\cdot \\sum_{k=1}^{\\min(\\lfloor \\frac{n}{d}\\rfloor,\\lfloor \\frac{m}{d}\\rfloor)} \\mu(k) \\cdot k^2 \\cdot h(\\lfloor \\frac{n}{dk} \\rfloor, \\lfloor \\frac{m}{dk} \\rfloor)\n$$\nè®¾ $dk = T$ï¼Œåˆ™æœ‰ï¼š\n$$\n\\text{ans} = \\sum_{d=1}^{\\min(n,m)} d \\cdot \\sum_{k=1}^{\\min(\\lfloor \\frac{n}{d}\\rfloor,\\lfloor \\frac{m}{d}\\rfloor)} \\mu(k) \\cdot k^2 \\cdot h(\\lfloor \\frac{n}{T} \\rfloor, \\lfloor \\frac{m}{T} \\rfloor)\n$$\næšä¸¾ $T$ ï¼Œåˆ™æœ‰ï¼š\n$$\n\\text{ans} = \\sum_{T=1}^{\\min(n,m)} \\sum_{d|T} d \\cdot {\\lfloor \\frac{T}{d} \\rfloor}^2 \\mu(\\lfloor \\frac{T}{d} \\rfloor) \\cdot h(\\lfloor \\frac{n}{T} \\rfloor, \\lfloor \\frac{m}{T} \\rfloor)\n$$\nç®€å•æ•´ç†ä¸‹ï¼š\n$$\n\\text{ans} = \\sum_{T=1}^{\\min(n,m)} h(\\lfloor \\frac{n}{T} \\rfloor, \\lfloor \\frac{m}{T} \\rfloor) \\sum_{d|T} \\lfloor \\frac{T}{d} \\rfloor \\cdot {d}^2 \\mu(d)\n$$\næ‹å‡ºæ¥åé¢çš„ä¸€å¨ï¼š\n$$\nf'(T) = \\sum_{d|T} \\lfloor \\frac{T}{d} \\rfloor \\cdot {d}^2 \\mu(d)\n$$\nå‘ç°è¿™æ˜¯ä¸€ä¸ªç§¯æ€§å‡½æ•°ï¼Œæ‰€ä»¥å¯ä»¥ $O(n)$ çº¿æ€§ç­›å‡ºæ¥ï¼Œç„¶åå°±å¯ä»¥é…åˆæ•´é™¤åˆ†å— $O(\\sqrt n)$ å®Œæˆå•è¯è¯¢é—®ã€‚\n[SDOI2015]çº¦æ•°ä¸ªæ•°å’Œ é¢˜æ„ è®¾ $d(x)$ ä¸º $x$ çš„çº¦æ•°ä¸ªæ•°ï¼Œç»™å®š $N$ ã€$M$ ï¼Œæ±‚\n$$\\sum^N_{i=1}\\sum^M_{j=1}d(ij)$$\nè§£æ³• æˆ‘ä»¬æœ‰å¦‚ä¸‹ç»“è®ºï¼š\n$$\nd(ij) = \\sum_{x|i} \\sum_{y|j} [\\gcd(x,y) = 1]\n$$\nè¯æ˜ï¼š\næˆ‘ä»¬å¯¹ $i$ å’Œ $j$ ä¸¤ä¸ªæ•°åšå”¯ä¸€åˆ†è§£ ï¼Œå¾—åˆ°ï¼š\n$$\ni = {p_1}^{a_1} \\times {p_2}^{a_2} \\times \\cdots \\times {p_n}^{a_n}\\\nj = {p_1}^{b_1} \\times {p_2}^{b_2} \\times \\cdots \\times {p_n}^{b_n}\\\n$$\næ‰€ä»¥æˆ‘ä»¬çŸ¥é“\n$$\nd(ij) = \\prod_{x=1}^n {(a_x + b_x + 1)}\n$$\næˆ‘ä»¬éœ€è¦è¯æ˜ï¼Œåˆ†åˆ«ä» $i$ å’Œ $j$ ä¸­é€‰æ‹©ä¸¤ä¸ªäº’è´¨çš„çº¦æ•°çš„æ–¹æ¡ˆæ•°ä¹Ÿç­‰äºä¸Šå¼ã€‚\næˆ‘ä»¬å‘ç°ï¼Œåœ¨çº¦æ•°çš„æ„é€ ä¸­ï¼Œä¸åŒè´¨å› å­çš„é€‰å–æ˜¯ç‹¬ç«‹çš„ã€‚æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦è€ƒè™‘ä¸€ä¸ªè´¨å› å­çš„é€‰å–æ–¹æ¡ˆæ•°ï¼Œç„¶åæŠŠæ‰€æœ‰è´¨å› å­åšä¸€ä¸ªè¿ä¹˜å³å¯ã€‚\nå› ä¸ºä¸èƒ½æœ‰å…¬å…±çš„å› å­ï¼Œæ‰€ä»¥å¯¹ $p_1$ è¿™ä¸ªè´¨å› å­æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥æ­£å¥½æ‰¾å‡º $a_1+b_1+1$ ç§é€‰å–æ–¹æ³•ï¼Œåˆ†åˆ«ä¸ºï¼š\n$$\n(1,0),(2,0),\\cdots,(a_1,0)\\\n(0,1),(0,2),\\cdots,(0,b_1)\\\n(0,0)\n$$\nå¯ä»¥è¯æ˜ï¼Œè¿™äº›ä¸åŒçš„çš„é€‰å–å¯ä»¥ä¿è¯æˆ‘ä»¬é€‰æ‹©çš„å› æ•°ä¸ä¼šå®Œå…¨ç›¸åŒã€‚\næ‰€ä»¥å¯ä»¥è¯æ˜ï¼š\n$$\nd(ij) = \\sum_{x|i} \\sum_{y|j} [\\gcd(x,y) = 1]\n$$\nåŸå¼ï¼š\n$$\n\\sum^N_{i=1}\\sum^M_{j=1}d(ij)\\\n= \\sum^N_{i=1}\\sum^M_{j=1}\\sum_{x|i} \\sum_{y|j} [\\gcd(x,y) = 1]\\\n= \\sum_{x=1}^N\\sum_{y=1}^M\\sum_{x|i} \\sum_{y|j} [\\gcd(x,y) = 1]\\\n= \\sum_{x=1}^N\\sum_{y=1}^M [\\gcd(x,y) = 1] \\sum_{x|i} \\sum_{y|j} 1\\\n= \\sum_{x=1}^N\\sum_{y=1}^M [\\gcd(x,y) = 1] \\lfloor \\frac{N}{x} \\rfloor \\lfloor \\frac{M}{y} \\rfloor\\\n$$\nè®¾\n$$\nf(d) = \\sum_{x=1}^N\\sum_{y=1}^M [\\gcd(x,y) = d] \\lfloor \\frac{N}{x} \\rfloor \\lfloor \\frac{M}{y} \\rfloor\\\n$$\nè‹¥\n$$\ng(d) = \\sum_{d|i} f(i)\n$$\nå¯ä»¥å‘ç°ï¼Œæ­¤æ—¶ $x,y$ ä¸ºæ‰€æœ‰ $d$ çš„å€æ•°ï¼Œæ‰€ä»¥ï¼š\n$$\ng(d) = \\sum_{i=1}^{\\lfloor \\frac{N}{d} \\rfloor} \\sum_{j=1}^{\\lfloor \\frac{M}{d} \\rfloor} \\lfloor \\frac{N}{id} \\rfloor \\lfloor \\frac{M}{jd} \\rfloor\n$$\nè¿›è¡Œä¸€æ­¥åæ¼”ï¼š\n$$\nf(d) = \\sum_{d|k} \\mu(\\frac{k}{d}) g(k)\n$$\nåˆ™ï¼š\n$$\nf(1) = \\sum_{k=1}^{\\min(n,m)} \\mu(k) g(k)\\\n= \\sum_{k=1}^{\\min(n,m)} \\mu(k) \\sum_{i=1}^{\\lfloor \\frac{N}{k} \\rfloor} \\sum_{j=1}^{\\lfloor \\frac{M}{k} \\rfloor} \\lfloor \\frac{N}{ik} \\rfloor \\lfloor \\frac{M}{jk} \\rfloor\\\n= \\sum_{k=1}^{\\min(n,m)} \\mu(k) (\\sum_{i=1}^{\\lfloor \\frac{N}{k} \\rfloor}\\lfloor \\frac{N}{ik} \\rfloor) (\\sum_{j=1}^{\\lfloor \\frac{M}{k} \\rfloor} \\lfloor \\frac{M}{jk} \\rfloor)\\\n$$\næˆ‘ä»¬å‘ç°ï¼š\n$$\n\\sum_{x=1}^nd(x) = \\sum_{i=1}^{n}\\lfloor \\frac{n}{i} \\rfloor\n$$\næ‰€ä»¥ï¼š\n$$\n\\text{ans} = \\sum_{k=1}^{\\min(n,m)} \\mu(k) (\\sum_{i=1}^{\\lfloor \\frac{N}{k} \\rfloor}\\lfloor \\frac{N}{ik} \\rfloor) (\\sum_{j=1}^{\\lfloor \\frac{M}{k} \\rfloor} \\lfloor \\frac{M}{jk} \\rfloor)\\\n= \\sum_{k=1}^{\\min(n,m)} \\mu(k) \\sum_{i=1}^{\\lfloor \\frac{N}{k} \\rfloor}d(i) \\sum_{j=1}^{\\lfloor \\frac{M}{k} \\rfloor} d(j)\\\n$$\nä»¤ï¼š\n$$\nh(x) = \\sum_{i=1}^x d(i)\n$$\nåˆ™ï¼š\n$$\n\\text{ans} = \\sum_{k=1}^{\\min(n,m)} \\mu(k) \\cdot h(\\lfloor \\frac{N}{k} \\rfloor) \\cdot h(\\lfloor \\frac{M}{k} \\rfloor)\\\n$$\næˆ‘ä»¬å‘ç° $d(i)$ æ˜¯ä¸€ä¸ªç§¯æ€§å‡½æ•°ï¼Œå¯ä»¥ $O(n)$ çº¿æ€§ç­›ï¼Œç„¶å $h(x)$ å¯ä»¥ $O(n)$ å‰ç¼€å’Œï¼Œç„¶åå°±å¯ä»¥ $O(\\sqrt n)$ æ•´é™¤åˆ†å—å•æ¬¡å‡ºè§£ã€‚\n","description":"","id":119,"section":"posts","tags":["æ•°å­¦","è«æ¯”ä¹Œæ–¯åæ¼”"],"title":"è«æ¯”ä¹Œæ–¯åæ¼”å…¥é—¨é¢˜ç›®-é¢˜è§£","uri":"https://blog.chenqiqian.com/posts/notes-mobius-inversion/"},{"content":"å° $\\text{G}$ æ˜¯ä¸€ä¸ªå‡ºè‰²çš„è¯—äººï¼Œç»å¸¸ä½œè¯—è‡ªå¨±è‡ªä¹ã€‚ä½†æ˜¯ï¼Œä»–ä¸€ç›´è¢«ä¸€ä»¶äº‹æƒ…æ‰€å›°æ‰°ï¼Œé‚£å°±æ˜¯è¯—çš„æ’ç‰ˆé—®é¢˜ã€‚\nä¸€é¦–è¯—åŒ…å«äº†è‹¥å¹²ä¸ªå¥å­ï¼Œå¯¹äºä¸€äº›è¿ç»­çš„çŸ­å¥ï¼Œå¯ä»¥å°†å®ƒä»¬ç”¨ç©ºæ ¼éš”å¼€å¹¶æ”¾åœ¨ä¸€è¡Œä¸­ï¼Œæ³¨æ„ä¸€è¡Œä¸­å¯ä»¥æ”¾çš„å¥å­æ•°ç›®æ˜¯æ²¡æœ‰é™åˆ¶çš„ã€‚å° $\\text{G}$ ç»™æ¯é¦–è¯—å®šä¹‰äº†ä¸€ä¸ªè¡Œæ ‡å‡†é•¿åº¦ï¼ˆè¡Œçš„é•¿åº¦ä¸ºä¸€è¡Œä¸­ç¬¦å·çš„æ€»ä¸ªæ•°ï¼‰ï¼Œä»–å¸Œæœ›æ’ç‰ˆåæ¯è¡Œçš„é•¿åº¦éƒ½å’Œè¡Œæ ‡å‡†é•¿åº¦ç›¸å·®ä¸è¿œã€‚æ˜¾ç„¶æ’ç‰ˆæ—¶ï¼Œä¸åº”æ”¹å˜åŸæœ‰çš„å¥å­é¡ºåºï¼Œå¹¶ä¸”å° $\\text{G}$ ä¸å…è®¸æŠŠä¸€ä¸ªå¥å­åˆ†åœ¨ä¸¤è¡Œæˆ–è€…æ›´å¤šçš„è¡Œå†…ã€‚åœ¨æ»¡è¶³ä¸Šé¢ä¸¤ä¸ªæ¡ä»¶çš„æƒ…å†µä¸‹ï¼Œå° $\\text{G}$ å¯¹äºæ’ç‰ˆä¸­çš„æ¯è¡Œå®šä¹‰äº†ä¸€ä¸ªä¸åè°ƒåº¦, ä¸ºè¿™è¡Œçš„å®é™…é•¿åº¦ä¸è¡Œæ ‡å‡†é•¿åº¦å·®å€¼ç»å¯¹å€¼çš„ $P$ æ¬¡æ–¹ï¼Œè€Œä¸€ä¸ªæ’ç‰ˆçš„ä¸åè°ƒåº¦ä¸ºæ‰€æœ‰è¡Œä¸åè°ƒåº¦çš„æ€»å’Œã€‚\nå° $\\text{G}$ æœ€è¿‘åˆä½œäº†å‡ é¦–è¯—ï¼Œç°åœ¨è¯·ä½ å¯¹è¿™é¦–è¯—è¿›è¡Œæ’ç‰ˆï¼Œä½¿å¾—æ’ç‰ˆåçš„è¯—å°½é‡åè°ƒï¼ˆå³ä¸åè°ƒåº¦å°½é‡å°ï¼‰ï¼Œå¹¶æŠŠæ’ç‰ˆçš„ç»“æœå‘Šè¯‰ä»–ã€‚\né“¾æ¥ Luogu P1912\né¢˜è§£ æ²¡çœ‹è§åŠ ç²—çš„è¯\u0026hellip;å› è€Œç–¯ç‹‚ä¸ä¼šåšï¼Œç„¶åå›å®¶ä»”ç»†è¯»é¢˜\u0026hellip;\nç„¶åè¿˜æ˜¯ä¸ä¼šåšã€‚\nè®¾ $dp[i]$ æ˜¯å‰ $i$ å¥è¯çš„ä¸åè°ƒåº¦çš„æœ€å°å€¼ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ˜¾ç„¶æœ‰ä»¥ä¸‹çš„çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š\n$$\ndp[i] = \\min_{j=0}^{i-1}(dp[j] + {|sum[i]-sum[j]+(i-j-1)-L|}^p)\n$$\næ‰“è¡¨å‘ç°å†³ç­–å•è°ƒæ€§ã€‚\nç”¨é˜Ÿåˆ—ç»´æŠ¤ä¸€ä¸ªå†³ç­–é˜Ÿåˆ—ï¼Œç”¨ä¸‰å…ƒç»„ $(p,l,r)$ ï¼Œä»£è¡¨åœ¨ $[l,r]$ åŒºé—´ä¸­çš„æœ€æœ‰å†³ç­–ç‚¹éƒ½æ˜¯ $p$ ï¼Œç±»ä¼¼ï¼š$11122333356 \\rightarrow (1,1,3) + (2,4,5) + (3,6,9) + (5,10,10) + (6,11,11)$ ï¼Œç„¶åæ¯æ¬¡ä»åå¾€å‰ $pop$ ï¼Œç›´åˆ°ä¸èƒ½ $pop$ æ‰æ•´æ®µä¹‹åå†å»äºŒåˆ†çœ‹æœ€åä¸€å—å…·ä½“çš„åˆ†ç•Œçº¿åœ¨å“ªé‡Œï¼Œç„¶ååœ¨æ¯æ¬¡æŸ¥è¯¢ä¹‹å‰è¦æŠŠ $r \u0026lt; i-1$ çš„åŒºé—´ç»™ $pop$ æ‰ã€‚\nè·¯å¾„çš„è¯è®°å½•å†³ç­–ç‚¹å³å¯ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cstring\u0026gt;#include \u0026lt;cstdlib\u0026gt;#include \u0026lt;algorithm\u0026gt;#include \u0026lt;cmath\u0026gt;//#define ll long long #define ll long double using namespace std; const int MAXN = 110000; ll pow(ll x,int p){ ll ans = 1; for(int i = 1;i\u0026lt;=p;i++) ans *= x; return ans; } struct Node{ int p,l,r; }; int n,l,p; char s[MAXN][50]; ll sum[MAXN],dp[MAXN]; int last[MAXN]; ll calc(int i,int j){ return dp[j] + pow(fabs(sum[i] - sum[j] - l - 1),p); } int find(int l,int r,int now,int last){ // æ‰¾åˆ°åœ¨[l,r]åŒºé—´å†…ç¬¦åˆ now å†³ç­–æ¯” last ä¼˜çš„æœ€å‰é¢çš„ä½ç½®  // last,...,last,[now],now  while(l!=r){ int mid = (l+r)\u0026gt;\u0026gt;1; if(calc(mid,last) \u0026gt; calc(mid,now)) r = mid; else l = mid+1; } return l; } void init(){ scanf(\u0026#34;%d %d %d\u0026#34;,\u0026amp;n,\u0026amp;l,\u0026amp;p); for(int i = 1;i\u0026lt;=n;i++){ scanf(\u0026#34;%s\u0026#34;,s[i]); sum[i] = strlen(s[i]); sum[i] += sum[i-1] + 1; } } void solve(){ static Node q[MAXN]; memset(dp,0,sizeof(dp)); memset(last,0,sizeof(last)); int fi=0,la=1;q[0] = (Node){0,1,n}; for(int i = 1;i\u0026lt;=n;i++){ if(fi != la \u0026amp;\u0026amp; q[fi].r \u0026lt;= i-1) fi++; int j = q[fi].p; dp[i] = calc(i,j);last[i] = j; if(calc(n,q[la-1].p) \u0026lt; calc(n,i)) continue;// åœ¨nå¤„iéƒ½ä¸ä¼˜äºq[la-1].p  while(fi != la \u0026amp;\u0026amp; calc(q[la-1].l,q[la-1].p) \u0026gt; calc(q[la-1].l,i)) la--; // pop æ‰æ•´ä¸ªå°¾æ®µçš„æ¡ä»¶ï¼ši ç‚¹åœ¨ q[la-1].l ç”šè‡³éƒ½æ˜¯ä¸€ä¸ªæ›´ä¼˜çš„å†³ç­–ç‚¹  if(fi==la) q[la++] = (Node){i,i+1,n}; else{ Node \u0026amp;t = q[la-1]; int x = find(t.l,n,i,t.p); t.r = x-1; q[la++] = (Node){i,x,n}; } } } void output(){ if(dp[n] \u0026gt; 1e18) printf(\u0026#34;Too hard to arrange\\n\u0026#34;); else{ static int route[MAXN]; int cnt = 0,now = n; printf(\u0026#34;%lld\\n\u0026#34;,(long long)(dp[n])); while(now != 0){ route[++cnt] = now; now = last[now]; } for(int i = 1,t=cnt;i\u0026lt;=n;i++){ printf(\u0026#34;%s\u0026#34;,s[i]); if(i!=route[t]) putchar(\u0026#39; \u0026#39;); else putchar(\u0026#39;\\n\u0026#39;),t--; } } printf(\u0026#34;--------------------\\n\u0026#34;); } int main(){ int T; scanf(\u0026#34;%d\u0026#34;,\u0026amp;T); for(int i = 1;i\u0026lt;=T;i++){ init(); solve(); output(); } return 0; }   ","description":"","id":120,"section":"posts","tags":["åŠ¨æ€è§„åˆ’","å†³ç­–å•è°ƒæ€§","äºŒåˆ†æŸ¥æ‰¾"],"title":"ã€ŒNOI2009ã€è¯—äººå°G-åŠ¨æ€è§„åˆ’+å†³ç­–å•è°ƒæ€§","uri":"https://blog.chenqiqian.com/posts/noi2009-poet/"},{"content":"ä½ æ­£åœ¨ç©ä¸€ä¸ªå…³äºé•¿åº¦ä¸º $n$ çš„éè´Ÿæ•´æ•°åºåˆ—çš„æ¸¸æˆã€‚è¿™ä¸ªæ¸¸æˆä¸­ä½ éœ€è¦æŠŠåºåˆ—åˆ†æˆ $k + 1$ ä¸ªéç©ºçš„å—ã€‚ä¸ºäº†å¾—åˆ° $k + 1$ å—ï¼Œä½ éœ€è¦é‡å¤ä¸‹é¢çš„æ“ä½œ $k$ æ¬¡ï¼š\n é€‰æ‹©ä¸€ä¸ªæœ‰è¶…è¿‡ä¸€ä¸ªå…ƒç´ çš„å—ï¼ˆåˆå§‹æ—¶ä½ åªæœ‰ä¸€å—ï¼Œå³æ•´ä¸ªåºåˆ—ï¼‰  é€‰æ‹©ä¸¤ä¸ªç›¸é‚»å…ƒç´ æŠŠè¿™ä¸ªå—ä»ä¸­é—´åˆ†å¼€ï¼Œå¾—åˆ°ä¸¤ä¸ªéç©ºçš„å—ã€‚    æ¯æ¬¡æ“ä½œåä½ å°†è·å¾—é‚£ä¸¤ä¸ªæ–°äº§ç”Ÿçš„å—çš„å…ƒç´ å’Œçš„ä¹˜ç§¯çš„åˆ†æ•°ã€‚ä½ æƒ³è¦æœ€å¤§åŒ–æœ€åçš„æ€»å¾—åˆ†ã€‚\né“¾æ¥ Luogu P3648\n$$\na(b+c) + bc = ab+ac+bc = (a+b)c + ab \\rightarrow \\text{ä¸‰ä¸ªæ•°æ€ä¹ˆåˆ‡ç»“æœéƒ½ä¸€æ ·}\\\na(b+c+d) + (bc+cd+ad) = ab + ac + ad + bc + bd + cd = (a+b+c)d + (ab+bc+ac)\n$$\nè¿™ä¸ªå¼å­å†æ¨å¹¿çš„è¯ï¼Œå°±å‘Šè¯‰æˆ‘ä»¬ï¼šåˆ‡å‰²æ–¹æ¡ˆçš„åˆ†æ•°åªä¸åˆ‡å‰²çš„ä½ç½®æœ‰å…³ã€‚\nä»¤ $dp[i][w]$ ä¸ºå‰ $i$ ä¸ªæ•°å­—åˆ‡å‰²wæ¬¡èƒ½æ‹¿åˆ°çš„æœ€å°å€¼ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å†™å‡ºçŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š\n$$\ndp[i][w] = \\max_{j=1}^{i-1}(dp[j][w-1] + sum[j] \\times (sum[i]-sum[j]))\n$$\nç„¶åå¦‚æœ $k$ æ¯” $j$ ä¼˜ç§€ï¼Œåˆ™æœ‰ï¼š\n$$\ndp[j][w-1] + sum[j] \\times (sum[i]-sum[j]) \u0026lt; dp[k][w-1] + sum[k] \\times (sum[i]-sum[k])\\\n\\frac{(dp[j][w-1]-{sum[j]}^2)-(dp[k][w-1]-{sum[k]}^2)}{sum[j]-sum[k]} \u0026gt; -sum[i]\\\n$$\nç°åœ¨æˆ‘ä»¬éœ€è¦è€ƒè™‘ $sum[j] = sum[k]$ çš„æƒ…å†µï¼Œæˆ‘ä»¬æ³¨æ„åˆ°è¿™ä¸ªæ—¶å€™åº”è¯¥æ˜¯ $ k$ ä¸€å®šæ˜¯ä¸æ¯” $j$ åçš„ï¼Œä½†æ˜¯æˆ‘ä»¬ç”±äºè¦è¾“å‡ºæ–¹æ¡ˆä¸­ï¼Œä¸èƒ½åˆ‡åœ¨å¼€å¤´çš„ä½ç½®ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å°½é‡å¾€ååˆ‡ï¼Œå°±å¿…é¡»ä»¤ $k$ æ¯” $j$ ä¼˜ï¼Œå°±åº”è¯¥è®©è¿™ä¸ªå¼å­è¿”å›æ— ç©·å¤§ã€‚\nå› ä¸º $sum$ æ˜¯å•è°ƒçš„ï¼Œå°±å¯ä»¥å•è°ƒé˜Ÿåˆ—ç»´æŠ¤å‡¸åŒ…äº†ã€‚\nè¾“å‡ºè·¯å¾„çš„è¯ï¼Œå°±ç›´æ¥ç»´æŠ¤ä¸€ä¸ªå†³ç­–ç‚¹ï¼Œæ²¿ç€å†³ç­–ç‚¹å¾€å›è·³ï¼Œç„¶åè¾“å‡ºå°±å¯ä»¥äº†ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;algorithm\u0026gt;#include \u0026lt;cstdlib\u0026gt;#define ld long double #define ll long long using namespace std; const int MAXN = 110000; int n,k; ll num[MAXN],sum[MAXN],a[MAXN],b[MAXN]; int last[MAXN][210]; ll *dp,*now; ld calc(int i,int j){ if(sum[i] == sum[j]) return 1e18; return (ld)(dp[i]-sum[i]*sum[i]-dp[j]+sum[j]*sum[j])/(ld)(sum[i]-sum[j]); } void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;k); for(int i = 1;i\u0026lt;=n;i++){ scanf(\u0026#34;%lld\u0026#34;,\u0026amp;sum[i]); sum[i] += sum[i-1]; } } void solve(){ static int q[MAXN]; dp = a,now = b; int fi = 0,la = 0; for(int x = 1;x\u0026lt;=k;x++){ fi = la = 0;q[0] = 0; for(int i = 1;i\u0026lt;=n;i++){ while(fi \u0026lt; la \u0026amp;\u0026amp; calc(q[fi],q[fi+1]) \u0026gt;= -sum[i]) fi++; now[i] = dp[q[fi]] + (sum[i]-sum[q[fi]])*sum[q[fi]]; last[i][x] = q[fi]; while(fi \u0026lt; la \u0026amp;\u0026amp; calc(q[la-1],q[la]) \u0026lt;= calc(q[la],i)) la--; q[++la] = i; } swap(dp,now); } printf(\u0026#34;%lld\\n\u0026#34;,dp[n]); for(int i = k,t = n;i\u0026gt;=1;--i){ printf(\u0026#34;%d \u0026#34;,last[t][i]); t = last[t][i]; } printf(\u0026#34;\\n\u0026#34;); } int main(){ init(); solve(); return 0; }   ","description":"","id":121,"section":"posts","tags":["åŠ¨æ€è§„åˆ’","æ–œç‡ä¼˜åŒ–"],"title":"ã€ŒAPIO2014ã€åºåˆ—åˆ†å‰²-åŠ¨æ€è§„åˆ’-æ–œç‡ä¼˜åŒ–","uri":"https://blog.chenqiqian.com/posts/apio2014-sequence/"},{"content":"å°†è¦è¯»äºŒå¹´çº§çš„å° Q ä¹°äº†ä¸€æ¬¾æ–°å‹ç›Šæ™ºç©å…·â€”â€”é­”å¹»æ£‹ç›˜ï¼Œå®ƒæ˜¯ä¸€ä¸ª $N$ è¡Œ $M$ åˆ—çš„ç½‘æ ¼æ£‹ç›˜ï¼Œæ¯ä¸ªæ ¼å­ä¸­å‡æœ‰ä¸€ä¸ªæ­£æ•´æ•°ã€‚æ£‹ç›˜å®ˆæŠ¤è€…åœ¨æ£‹ç›˜çš„ç¬¬ $X$ è¡Œç¬¬ $Y$ åˆ—ï¼ˆè¡Œä¸åˆ—å‡ä» $1$ å¼€å§‹ç¼–å·ï¼‰å¹¶ä¸”å§‹ç»ˆä¸ä¼šç§»åŠ¨ã€‚æ£‹ç›˜å®ˆæŠ¤è€…ä¼šè¿›è¡Œä¸¤ç§æ“ä½œï¼š\n  è¯¢é—®ï¼šä»–ä¼šä»¥è‡ªå·±æ‰€åœ¨ä½ç½®ä¸ºåŸºç¡€ï¼Œå‘å››å‘¨éšæœºæ‰©å±•å‡ºä¸€å—å¤§å°ä¸å®šçš„çŸ©å½¢åŒºåŸŸï¼Œå‘ä½ è¯¢é—®è¿™ä¸€åŒºåŸŸå†…æ‰€æœ‰æ•°çš„æœ€å¤§å…¬çº¦æ•°æ˜¯å¤šå°‘ã€‚\n  ä¿®æ”¹ï¼šä»–ä¼šéšæ„æŒ‘é€‰æ£‹ç›˜ä¸Šçš„ä¸€å—çŸ©å½¢åŒºåŸŸï¼Œå°†è¿™ä¸€åŒºåŸŸå†…çš„æ‰€æœ‰æ•°åŒæ—¶åŠ ä¸Šä¸€ä¸ªç»™å®šçš„æ•´æ•°ã€‚\n  æ¸¸æˆè¯´æ˜ä¹¦ä¸Šé™„æœ‰è¿™æ ·ä¸€å¥è¯â€œèªæ˜çš„å°æœ‹å‹ï¼Œå½“ä½ è¿ç»­ç­”å¯¹ $19930324$ æ¬¡è¯¢é—®åä¼šå¾—åˆ°ä¸€ä¸ªæƒŠå–œå™¢ï¼â€ã€‚å° Q ååˆ†æƒ³å¾—åˆ°è¿™ä¸ªæƒŠå–œï¼Œäºæ˜¯æ¯å¤©éƒ½åœ¨ç©è¿™ä¸ªç©å…·ã€‚ä½†ç”±äºä»–ç²—å¿ƒå¤§æ„ï¼Œç»å¸¸ç®—é”™æ•°ï¼Œéš¾ä»¥è¾¾åˆ°è¿™ä¸ªç›®æ ‡ã€‚äºæ˜¯ä»–æ¥å‘ä½ å¯»æ±‚å¸®åŠ©ï¼Œå¸Œæœ›ä½ å¸®ä»–å†™ä¸€ä¸ªç¨‹åºæ¥å›ç­”æ£‹ç›˜å®ˆæŠ¤è€…çš„è¯¢é—®ï¼Œå¹¶ä¿è¯ $100%$ çš„æ­£ç¡®ç‡ã€‚\nä¸ºäº†ç®€åŒ–é—®é¢˜ï¼Œä½ çš„ç¨‹åºåªéœ€è¦å®Œæˆæ£‹ç›˜å®ˆæŠ¤è€…çš„ $T$ æ¬¡æ“ä½œï¼Œå¹¶ä¸”é—®é¢˜ä¿è¯ä»»ä½•æ—¶åˆ»æ£‹ç›˜ä¸Šçš„æ•°å­—å‡ä¸ºä¸è¶…è¿‡ $2^{62} - 1$ çš„æ­£æ•´æ•°ã€‚\né“¾æ¥ Luogu P2086\né¢˜è§£ æˆ‘ä»¬å‘ç°ï¼Œå¦‚æœåªæœ‰å•ç‚¹ä¿®æ”¹ï¼Œè¿™ä¸ªä¸œè¥¿æ˜¯å¾ˆå¥½è§£å†³çš„ï¼ŒåŒºé—´ä¿®æ”¹ï¼ˆåŠ ï¼‰å°±ä¸å¤ªå¥½åšã€‚\næˆ‘ä»¬æœ‰å¦‚ä¸‹ç»“è®ºï¼š\n$$\n\\gcd(a,b) = \\gcd(a,b-a)\n$$\nç„¶åæˆ‘ä»¬å‘ç°æˆ‘ä»¬æ‰€æœ‰çš„æŸ¥è¯¢éƒ½æ˜¯åŒ…å«åŒä¸€ä¸ªç‚¹çš„ï¼Œè¿™ä¹Ÿå¯ä»¥ç»™æˆ‘ä»¬æä¾›ä¸€ç‚¹æ€è·¯ã€‚\næˆ‘ä»¬å¦‚æœå¯¹äºæ‰€æœ‰ç‚¹ï¼Œæˆ‘ä»¬å¯¹æŸç‚¹åšä¸€ä¸ªäºŒç»´çš„å·®åˆ†ï¼ˆä¹Ÿå°±æ˜¯çŸ©å½¢çš„å‰ç¼€å’Œç­‰äºè¿™ä¸ªä½ç½®åŸæ¥çš„å€¼ï¼‰ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥ç›´æ¥å¯¹è¿™ä¸ªå·®åˆ†è¿›è¡Œ $\\gcd$ çš„æŸ¥è¯¢ã€‚\næˆ‘ä»¬å»ºç«‹ä¸€ä¸ªäºŒç»´çº¿æ®µæ ‘ï¼Œç»´æŠ¤å·®åˆ†åçš„æ•°ç»„ï¼Œæˆ‘ä»¬éœ€è¦å»ºç«‹ä¸¤ä¸ªä¸€ç»´çº¿æ®µæ ‘æ¥è¾…åŠ©å·®åˆ†ã€‚ä¿®æ”¹çŸ©å½¢çš„æ—¶å€™ï¼Œæˆ‘ä»¬å› ä¸ºæ˜¯ä»¥å·¦ä¸Šè§’å·®åˆ†çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¿®æ”¹å››ä¸ªç‚¹ï¼Œå°±æ˜¯çŸ©å½¢çš„å››ä¸ªè§’ï¼Œæ³¨æ„ $+1$ å’Œ $-1$ çš„é—®é¢˜ã€‚\nåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä¸å¿…ä»¥ä¸­å¿ƒç‚¹ä¸ºåŸºå‡†å·®åˆ†ï¼Œäº‹å®ä¸Šå¯ä»¥ä»¥ä»»æ„ç‚¹å·®åˆ†ã€‚\nå‚è€ƒï¼šSengXian\u0026rsquo;s Blog\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cstdlib\u0026gt;#include \u0026lt;cstring\u0026gt;#include \u0026lt;cctype\u0026gt;using namespace std; #define ll long long  namespace fast_io{ //... }using namespace fast_io; const int MAXN = 510000; ll gcd(ll a,ll b){ return b==0?abs(a):gcd(b,a%b); } #define lson (nown\u0026lt;\u0026lt;1) #define rson (nown\u0026lt;\u0026lt;1|1) #define mid ((l+r)\u0026gt;\u0026gt;1) struct SegTree1D{ ll *gg; SegTree1D(int m){gg = new ll[m\u0026lt;\u0026lt;2];} void build(int nown,int l,int r,const ll *lt,const ll *rt){ if(r \u0026lt; l) return gg[nown] = 0,void(); if(l == r) gg[nown] = rt == NULL?lt[l]: gcd(lt[nown],rt[nown]); else{ build(lson,l,mid,lt,rt),build(rson,mid+1,r,lt,rt); gg[nown] = gcd(gg[lson],gg[rson]); } } ll query(int nown,int l,int r,int ql,int qr){ if(qr \u0026lt; l || r \u0026lt; ql) return 0; if(ql \u0026lt;= l \u0026amp;\u0026amp; r \u0026lt;= qr) return gg[nown]; else{ ll ans = 0; if(ql \u0026lt;= mid) ans = gcd(ans,query(lson,l,mid,ql,qr)); //if(ans == 1) return ans;  if(qr \u0026gt;= mid+1) ans = gcd(ans,query(rson,mid+1,r,ql,qr)); return ans; } } void modify(int nown,int l,int r,int pos,ll v){ if(pos \u0026lt; l || pos \u0026gt; r) return; if(l == r) gg[nown] += v; else{ if(pos \u0026lt;= mid) modify(lson,l,mid,pos,v); else modify(rson,mid+1,r,pos,v); gg[nown] = gcd(gg[lson],gg[rson]); } } void modify(int nown,int l,int r,int pos,const ll *ltree,const ll *rtree){ if(pos \u0026lt; l || pos \u0026gt; r) return; if(l == r) gg[nown] = gcd(ltree[nown],rtree[nown]); else{ if(pos \u0026lt;= mid) modify(lson,l,mid,pos,ltree,rtree); else modify(rson,mid+1,r,pos,ltree,rtree); gg[nown] = gcd(ltree[nown],rtree[nown]); } } }*C,*D; int n,m,xx,yy,t; ll *a[MAXN],*b[MAXN]; ll c[MAXN],d[MAXN],val;//cæ¨ªdçºµ  struct SegTree2D{ // æ¯ä¸€è¡Œå»º1æ£µ1Dçº¿æ®µæ ‘  // ä¸€å…±næ£µï¼Œæ¯æ£µå¤§å°å‡ä¸ºm  SegTree1D *t[MAXN\u0026lt;\u0026lt;2]; int a,b,c,d;//è¡Œä» a-\u0026gt;b, åˆ—ä» c-\u0026gt;d or (a,b)  ll v; void build(int nown,int l,int r,int m,ll **num){ t[nown] = new SegTree1D(m); if(l == r) t[nown]-\u0026gt;build(1,1,m,num[l],NULL); else{ build(lson,l,mid,m,num),build(rson,mid+1,r,m,num); t[nown]-\u0026gt;build(1,1,m,t[lson]-\u0026gt;gg,t[rson]-\u0026gt;gg); } } void modify(int nown,int l,int r){//(a,b) += v  if(r \u0026lt; a || l \u0026gt; a) return; if(l == r) t[nown]-\u0026gt;modify(1,1,m,b,v); else{ if(a \u0026lt;= mid) modify(lson,l,mid); else modify(rson,mid+1,r); t[nown]-\u0026gt;modify(1,1,m,b,t[lson]-\u0026gt;gg,t[rson]-\u0026gt;gg); } } ll query(int nown,int l,int r){ if(b \u0026lt; l || r \u0026lt; a) return 0; if(a \u0026lt;= l \u0026amp;\u0026amp; r \u0026lt;= b) return t[nown]-\u0026gt;query(1,1,m,c,d); else{ ll ans = 0; if(a \u0026lt;= mid) ans = gcd(ans,query(lson,l,mid)); //if(ans == 1) return ans;  if(b \u0026gt;= mid+1) ans = gcd(ans,query(rson,mid+1,r)); return ans; } } }T; void modify(int x,int y,ll v){ T.a = x,T.b = y,T.v = v; if(1 \u0026lt;= x \u0026amp;\u0026amp; x \u0026lt;= n \u0026amp;\u0026amp; 1 \u0026lt;= y \u0026amp;\u0026amp; y \u0026lt;= m) T.modify(1,1,n); } ll query(int x1,int x2,int y1,int y2){ ll ans = val; x1 = xx - x1,x2 = xx + x2,y1 = yy - y1,y2 = yy + y2; ans = gcd(ans,gcd(D-\u0026gt;query(1,1,n,x1+1,x2),C-\u0026gt;query(1,1,m,y1+1,y2))); T.a = x1+1,T.b = x2,T.c = y1+1,T.d = y2; ans = gcd(ans,T.query(1,1,n)); return abs(ans); } void modify(int x1,int x2,int y1,int y2,ll v){ if(x1 \u0026lt;= xx \u0026amp;\u0026amp; xx \u0026lt;= x2 \u0026amp;\u0026amp; y1 \u0026lt;= yy \u0026amp;\u0026amp; yy \u0026lt;= y2) val += v; if(x1 \u0026lt;= xx \u0026amp;\u0026amp; xx \u0026lt;= x2) C-\u0026gt;modify(1,1,m,y1,v),C-\u0026gt;modify(1,1,m,y2+1,-v); if(y1 \u0026lt;= yy \u0026amp;\u0026amp; yy \u0026lt;= y2) D-\u0026gt;modify(1,1,n,x1,v),D-\u0026gt;modify(1,1,n,x2+1,-v); modify(x1,y1,v),modify(x1,y2+1,-v),modify(x2+1,y1,-v),modify(x2+1,y2+1,v); } void init(){ read(n),read(m),read(xx),read(yy),read(t); for(int i = 0;i\u0026lt;=n+10;i++){ ll t = m+10; a[i] = new ll[t],b[i] = new ll[t]; memset(a[i],0,sizeof(ll) * t),memset(b[i],0,sizeof(ll) * t); } for(int i = 1;i\u0026lt;=n;i++) for(int j = 1;j\u0026lt;=m;j++) read(a[i][j]); } void build(){ for(int i = 1;i\u0026lt;=n;i++) for(int j = 1;j\u0026lt;=m;j++) b[i][j] = a[i][j] - a[i-1][j] - a[i][j-1] + a[i-1][j-1]; for(int i = 1;i\u0026lt;=m;i++) c[i] = a[xx][i] - a[xx][i-1]; for(int i = 1;i\u0026lt;=n;i++) d[i] = a[i][yy] - a[i-1][yy]; val = a[xx][yy]; C = new SegTree1D(m),D = new SegTree1D(n); C-\u0026gt;build(1,1,m,c,NULL),D-\u0026gt;build(1,1,n,d,NULL); T.build(1,1,n,m,b); } void solve(){ static int op,x1,x2,y1,y2; static ll v; for(int i = 1;i\u0026lt;=t;i++){ read(op),read(x1),read(y1),read(x2),read(y2); if(op == 0){ print(query(x1,x2,y1,y2)),print(\u0026#39;\\n\u0026#39;); } else{ read(v); modify(x1,x2,y1,y2,v); } } } signed main(){ init(); build(); solve(); flush(); return 0; }   ","description":"","id":122,"section":"posts","tags":["çº¿æ®µæ ‘","æ ‘å¥—æ ‘","æ•°æ®ç»“æ„","å·®åˆ†"],"title":"ã€ŒNOI2012ã€é­”å¹»æ£‹ç›˜-å·®åˆ†+æ ‘å¥—æ ‘","uri":"https://blog.chenqiqian.com/posts/noi2012-board/"},{"content":"ç»™å®šæ­£æ•´æ•° $n,m,a,c,X[0],g$ ï¼Œæ±‚æŒ‰ç…§ $X[n+1] = (a X[n] + c) \\bmod m$ ç”Ÿæˆå‡ºçš„ç¬¬ $n$ é¡¹ $X[n] \\bmod g$ çš„å€¼ã€‚\næ•°æ®èŒƒå›´ï¼š $n,m,a,c,X[0] \\leq 10^{18}$\né“¾æ¥ Luogu P2044\né¢˜è§£ æ„é€ è½¬ç§»çŸ©é˜µï¼š\n$$\n\\left[\\begin{matrix}\na \u0026amp; c \\\n0 \u0026amp; 1\n\\end{matrix}\\right]\n\\times\n\\left[\\begin{matrix}\nx_{n}\\\n1\n\\end{matrix} \\right] \\left[\\begin{matrix}\na x_n + c \\\n0 + 1\n\\end{matrix} \\right] \\left[\\begin{matrix}\nx_{n+1} \\\n1\n\\end{matrix} \\right]\n$$\nå¿«é€Ÿå¹‚å³å¯ã€‚\nè¿™é‡Œçš„ä¹˜æ³•éœ€è¦å¿«é€Ÿä¹˜ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cstring\u0026gt;using namespace std; #define ld long double #define ll long long  ll m,a,c,x0,n,g; ll mul(ll a,ll b){ a%=m,b%=m; return ((a*b - (ll)((ll)(((ld)a/m) * b + 1e-3) * m))%m+m)%m; } struct Matrix{ ll a[3][3]; Matrix(){ memset(a,0,sizeof(a)); } }; Matrix mul(Matrix \u0026amp;_a,Matrix \u0026amp;_b){ Matrix ans; for(int i = 1;i\u0026lt;=2;i++){ for(int j = 1;j\u0026lt;=2;j++){ for(int k = 1;k\u0026lt;=2;k++){ (ans.a[i][j] += mul(_a.a[i][k],_b.a[k][j]))%=m; } } } return ans; } Matrix pow(Matrix x,ll p){ Matrix ans; ans.a[1][1] = ans.a[2][2] = 1; for(ll i = p;i;x = mul(x,x),i\u0026gt;\u0026gt;=1) if(i \u0026amp; 1) ans = mul(ans,x); return ans; } int main(){ scanf(\u0026#34;%lld %lld %lld %lld %lld %lld\u0026#34;,\u0026amp;m,\u0026amp;a,\u0026amp;c,\u0026amp;x0,\u0026amp;n,\u0026amp;g);x0 %= m; Matrix tmp; tmp.a[1][1] = a % m, tmp.a[1][2] = c % m,tmp.a[2][2] = 1; tmp = pow(tmp,n); ll ans = ((mul(tmp.a[1][1],x0) + tmp.a[1][2])%m)%g; printf(\u0026#34;%lld\\n\u0026#34;,ans); return 0; }   ","description":"","id":123,"section":"posts","tags":["æ•°å­¦","çŸ©é˜µå¿«é€Ÿå¹‚","é€’æ¨"],"title":"ã€ŒNOI2012ã€éšæœºæ•°ç”Ÿæˆå™¨-çŸ©é˜µå¿«é€Ÿå¹‚","uri":"https://blog.chenqiqian.com/posts/noi2012-random/"},{"content":" é¢˜é¢è¯·ç‚¹å‡»æŸ¥çœ‹å…¨æ–‡\n $\\text{YT}$ å¸‚æ˜¯ä¸€ä¸ªè§„åˆ’è‰¯å¥½çš„åŸå¸‚ï¼ŒåŸå¸‚è¢«ä¸œè¥¿å‘å’Œå—åŒ—å‘çš„ä¸»å¹²é“åˆ’åˆ†ä¸º $n\\times n$ ä¸ªåŒºåŸŸã€‚ç®€å•èµ·è§ï¼Œå¯ä»¥å°† $\\text{YT}$ å¸‚çœ‹ä½œä¸€ä¸ªæ­£æ–¹å½¢ï¼Œæ¯ä¸€ä¸ªåŒºåŸŸä¹Ÿå¯çœ‹ä½œä¸€ä¸ªæ­£æ–¹å½¢ã€‚ä»è€Œï¼Œ$YT$ åŸå¸‚ä¸­åŒ…æ‹¬ $(n+1) \\times (n+1)$ ä¸ªäº¤å‰è·¯å£å’Œ $2n \\times (n+1)$ æ¡åŒå‘é“è·¯ï¼ˆç®€ç§°é“è·¯ï¼‰ï¼Œæ¯æ¡åŒå‘é“è·¯è¿æ¥ä¸»å¹²é“ä¸Šä¸¤ä¸ªç›¸é‚»çš„äº¤å‰è·¯å£ã€‚\nå° $\\text{Z}$ ä½œä¸ºè¯¥å¸‚çš„å¸‚é•¿ï¼Œä»–æ ¹æ®ç»Ÿè®¡ä¿¡æ¯å¾—åˆ°äº†æ¯å¤©ä¸Šç­é«˜å³°æœŸé—´ $\\text{YT}$ å¸‚æ¯æ¡é“è·¯ä¸¤ä¸ªæ–¹å‘çš„äººæµé‡ï¼Œå³åœ¨é«˜å³°æœŸé—´æ²¿ç€è¯¥æ–¹å‘é€šè¿‡è¿™æ¡é“è·¯çš„äººæ•°ã€‚æ¯ä¸€ä¸ªäº¤å‰è·¯å£éƒ½æœ‰ä¸åŒçš„æµ·æ‹”é«˜åº¦å€¼ï¼Œ $\\text{YT}$ å¸‚å¸‚æ°‘è®¤ä¸ºçˆ¬å¡æ˜¯ä¸€ä»¶éå¸¸ç´¯çš„äº‹æƒ…ï¼Œæ¯å‘ä¸Šçˆ¬ $h$ çš„é«˜åº¦ï¼Œå°±éœ€è¦æ¶ˆè€— $h$ çš„ä½“åŠ›ã€‚å¦‚æœ æ˜¯ä¸‹å¡çš„è¯ï¼Œåˆ™ä¸éœ€è¦è€—è´¹ä½“åŠ›ã€‚å› æ­¤å¦‚æœä¸€æ®µé“è·¯çš„ç»ˆç‚¹æµ·æ‹”å‡å»èµ·ç‚¹æµ·æ‹”çš„å€¼ä¸º $h$ (æ³¨æ„ $h$ å¯èƒ½æ˜¯è´Ÿæ•°)ï¼Œé‚£ä¹ˆä¸€ä¸ªäººç»è¿‡è¿™æ®µè·¯æ‰€æ¶ˆè€—çš„ä½“åŠ›æ˜¯ $\\max(0, h)$ ã€‚\nå° $\\text{Z}$ è¿˜æµ‹é‡å¾—åˆ°è¿™ä¸ªåŸå¸‚è¥¿åŒ—è§’çš„äº¤å‰è·¯å£æµ·æ‹”ä¸º $0$ ï¼Œä¸œå—è§’çš„äº¤å‰è·¯å£æµ·æ‹”ä¸º $1$ ï¼Œä½†å…¶å®ƒäº¤å‰è·¯å£çš„æµ·æ‹”é«˜åº¦éƒ½æ— æ³•å¾—çŸ¥ã€‚å° $\\text{Z}$ æƒ³çŸ¥é“åœ¨æœ€ç†æƒ³çš„æƒ…å†µä¸‹ï¼ˆå³ä½ å¯ä»¥ä»»æ„å‡è®¾å…¶ä»–è·¯å£çš„æµ·æ‹”é«˜åº¦ï¼‰ï¼Œæ¯å¤©ä¸Šç­é«˜å³°æœŸé—´æ‰€æœ‰äººçˆ¬å¡æ¶ˆè€—çš„æ€»ä½“åŠ›å’Œçš„æœ€å°å€¼ã€‚\n é“¾æ¥ Luogu P2046\né¢˜è§£ å¯ä»¥å‘ç°ï¼Œåº”è¯¥æ‰€æœ‰ç‚¹çš„æµ·æ‹”éƒ½è¦ä¹ˆæ˜¯ $0$ ï¼Œè¦ä¹ˆæ˜¯ $1$ ï¼Œå¯ä»¥å–åˆ°æœ€ä¼˜è§£ã€‚è€Œä¸”åˆ†ç•Œçº¿åº”è¯¥æ˜¯ä¸€æ¡è¿ç»­çš„çº¿ï¼Œè®©æˆ‘ä»¬è”æƒ³åˆ°æœ€å°å‰²ã€‚\nä½†æ˜¯è¿™ä¸ªæ•°æ®èŒƒå›´å¤ªå¤§äº†ï¼Œç›´æ¥è·‘æœ€å¤§æµä¼šè¶…æ—¶ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†è¿™ä¸ªå›¾è½¬åŒ–æˆå¯¹å¶å›¾ï¼Œæ ¹æ®åˆ‡å‰²æ–¹å‘é€‰æ‹©è¾¹çš„é•¿åº¦ï¼Œç„¶åè·‘æœ€çŸ­è·¯å³å¯ã€‚æ³¨æ„ä¸èƒ½ç”¨ $\\text{SPFA}$ ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;queue\u0026gt;#include \u0026lt;algorithm\u0026gt;#include \u0026lt;cstring\u0026gt;#define ll long long using namespace std; const int MAXN = 300000,MAXM = 2400000; const int N = 510; struct Edge{ int from,to; ll len;int nex; }edge[MAXM]; int n,m,s,t; int fir[MAXN],ecnt = 2; int a[N][N],b[N][N],c[N][N],d[N][N]; void addedge(int a,int b,int c){s edge[ecnt] = (Edge){a,b,c,fir[a]}; fir[a] = ecnt++; } struct Point{ int x;ll d; bool operator \u0026lt;(const Point \u0026amp;a)const{ return d \u0026gt; a.d; } }; ll dis[MAXN]; bool vis[MAXN]; priority_queue\u0026lt;Point\u0026gt; q; void dij(){ for(int i = 1;i\u0026lt;=n*n+2;i++) dis[i] = 2147483647; dis[s] = 0; q.push((Point){s,0}); while(!q.empty()){ Point now = q.top();q.pop(); int nown = now.x,nowd = dis[nown]; if(vis[nown]) continue; vis[nown] = 1; for(int nowe = fir[nown];nowe;nowe = edge[nowe].nex){ int v = edge[nowe].to,l = edge[nowe].len; if(dis[v] \u0026gt; nowd + l){ dis[v] = nowd + l; q.push((Point){v,dis[v]}); } } } } int _hash(int i,int j){ if(i \u0026lt;= 0 || j \u0026gt; n) return s; if(j \u0026lt;= 0 || i \u0026gt; n) return t; return (i-1)*n+j; } void init(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n);n++; for(int i = 1;i\u0026lt;=n;i++) for(int j = 1;j\u0026lt;=n-1;j++) scanf(\u0026#34;%d\u0026#34;,\u0026amp;a[i][j]); for(int i = 1;i\u0026lt;=n-1;i++) for(int j = 1;j\u0026lt;=n;j++) scanf(\u0026#34;%d\u0026#34;,\u0026amp;b[i][j]); for(int i = 1;i\u0026lt;=n;i++) for(int j = 2;j\u0026lt;=n;j++) scanf(\u0026#34;%d\u0026#34;,\u0026amp;c[i][j]); for(int i = 2;i\u0026lt;=n;i++) for(int j = 1;j\u0026lt;=n;j++) scanf(\u0026#34;%d\u0026#34;,\u0026amp;d[i][j]); n--; } void solve(){ s = n*n+1,t = n*n+2; for(int i = 1;i\u0026lt;=n;i++){ for(int j = 1;j\u0026lt;=n;j++){ addedge(_hash(i,j),_hash(i+1,j),a[i+1][j]); addedge(_hash(i,j),_hash(i,j+1),d[i+1][j+1]); addedge(_hash(i,j),_hash(i-1,j),c[i][j+1]); addedge(_hash(i,j),_hash(i,j-1),b[i][j]); } } for(int i = 1;i\u0026lt;=n;i++){ addedge(s,_hash(1,i),a[1][i]); addedge(s,_hash(i,n),b[i][n+1]); //addedge(,s,),addedge(,s,);  } for(int i = 1;i\u0026lt;=n;i++){ addedge(_hash(i,1),t,b[i][1]); addedge(_hash(n,i),t,a[n+1][i]); //addedge(t,,),addedge(t,,);  } dij(); printf(\u0026#34;%lld\\n\u0026#34;,dis[t]); } signed main(){ init(); solve(); return 0; }   ","description":"","id":124,"section":"posts","tags":["æœ€çŸ­è·¯","ç½‘ç»œæµ","å¯¹å¶å›¾"],"title":"ã€ŒNOI2010ã€æµ·æ‹”-ç½‘ç»œæµ/æœ€çŸ­è·¯","uri":"https://blog.chenqiqian.com/posts/noi2010-altitude/"},{"content":"ç»™å®šä¸€ä¸ª $n$ ä¸ªç‚¹ï¼Œ$m$ æ¡è¾¹çš„æ— å‘å›¾ï¼Œæ¯æ¡è¾¹æœ‰ä¸¤ç§æƒå€¼ï¼š $0$ æˆ–è€… $1$ ã€‚\nå…ˆè¯¢é—®èƒ½ä¸èƒ½æ‰¾å‡ºä¸€ä¸ªç”Ÿæˆæ ‘ï¼Œä½¿å¾—å…¶ä¸­æ°æœ‰ $k$ æ¡ $0$ è¾¹ï¼Œè‹¥å­˜åœ¨ï¼Œè¾“å‡ºä»»æ„ä¸€ä¸ªæ–¹æ¡ˆï¼Œå¦åˆ™è¾“å‡º no solution ã€‚\né“¾æ¥ Luogu P3623\né¢˜è§£ ä¸å¤ªä¼šå…¶å®ã€‚é¦–å…ˆå°† $0$ è¾¹ä½œä¸ºå¤§è¾¹ï¼Œç„¶ååšä¸€æ¬¡æœ€å°ç”Ÿæˆæ ‘ï¼Œå¾—åˆ°å¿…é¡»åŠ å…¥çš„æœ€å°‘çš„ $0$ è¾¹ï¼Œæ­¤æ—¶å¦‚æœè¿™ä¸ª $0$ è¾¹çš„æ•°ç›®å¤§äº $k$ ï¼Œé‚£ä¹ˆå°±æ— è§£ï¼›\nç„¶åæˆ‘ä»¬å…ˆå°†æ‰€æœ‰çš„ $0$ è¾¹å°è¯•åŠ å…¥ï¼Œå¦‚æœèƒ½æ»¡è¶³ä¸æˆç¯ä¸”æœ€åæ°å¥½èƒ½åˆ° $k$ æ¡è¾¹ï¼Œå°±åŠ å…¥å‰©ä¸‹çš„ $1$ è¾¹ï¼Œæ„æˆç”Ÿæˆæ ‘å³å¯ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;algorithm\u0026gt;#include \u0026lt;cstring\u0026gt;using namespace std; const int MAXN = 110000; int n,m,k; struct Edge{ int from,to,len; }edge[MAXN]; bool cmp(Edge a,Edge b){ return a.len \u0026lt; b.len; } int f[MAXN]; void init(int n){ for(int i = 1;i\u0026lt;=n;i++) f[i] = i; } int find(int x){ return f[x] == x?x:f[x] = find(f[x]); } void solve(){ static Edge ans[MAXN]; int tot = 0; init(n); sort(edge+1,edge+m+1,cmp); for(int i = 1;i\u0026lt;=m;i++){ Edge \u0026amp;e = edge[i]; int fx = find(e.from),fy = find(e.to); if(fx != fy){ f[fx] = fy; if(e.len == 1){ tot++; ans[tot] = e; } } if(e.len == 1){ e.len = -1; }\t} init(n); sort(edge+1,edge+m+1,cmp); if(tot \u0026gt; k){ printf(\u0026#34;no solution\\n\u0026#34;); return; } for(int i = 1;i\u0026lt;=tot;i++){ int fx = find(ans[i].from),fy = find(ans[i].to); //printf(\u0026#34;%d %d\\n\u0026#34;,ans[i].from,ans[i].to);  f[fx] = fy; } for(int i = 1;i\u0026lt;=m;i++){ Edge \u0026amp;e = edge[i]; if(tot == n-1) break; int fx = find(e.from),fy = find(e.to); if(tot == k \u0026amp;\u0026amp; e.len == -1) continue; if(tot \u0026lt; k \u0026amp;\u0026amp; e.len != -1){ printf(\u0026#34;no solution\\n\u0026#34;); return; } if(fx != fy){ f[fx] = fy; ans[++tot] = e; } }\tif(tot!=n-1){ printf(\u0026#34;no solution\\n\u0026#34;); return; } for(int i = 1;i\u0026lt;=n-1;i++){ printf(\u0026#34;%d %d %d\\n\u0026#34;,ans[i].from,ans[i].to,1-abs(ans[i].len)); } } void init(){ scanf(\u0026#34;%d %d %d\u0026#34;,\u0026amp;n,\u0026amp;m,\u0026amp;k); for(int i = 1;i\u0026lt;=m;i++){ scanf(\u0026#34;%d %d %d\u0026#34;,\u0026amp;edge[i].from,\u0026amp;edge[i].to,\u0026amp;edge[i].len); edge[i].len^=1; } } int main(){ init(); solve(); return 0; }   ","description":"","id":125,"section":"posts","tags":["å›¾è®º","ç”Ÿæˆæ ‘","æ•°æ®ç»“æ„","å¹¶æŸ¥é›†"],"title":"ã€ŒAPIO2008ã€å…è´¹é“è·¯-ç”Ÿæˆæ ‘+å¹¶æŸ¥é›†","uri":"https://blog.chenqiqian.com/posts/apio2008-road/"},{"content":"ä½ çš„é¢å‰æœ‰ $n$ ä¸ªæ•°æ’æˆä¸€è¡Œï¼Œåˆ†åˆ«ä¸º $a_1,a_2,\u0026hellip;,a_n$ ã€‚ä½ æ‰“ç®—åœ¨æ¯ç›¸é‚»çš„ä¸¤ä¸ª $a_i$cå’Œ $a_{i+1}$ é—´éƒ½æ’å…¥ä¸€ä¸ªåŠ å·ã€å‡å·æˆ–è€…ä¹˜å·ã€‚é‚£ä¹ˆä¸€å…±æœ‰ $3^{n-1}$ ç§å¯èƒ½çš„è¡¨è¾¾å¼ã€‚\nä½ å¯¹æ‰€æœ‰å¯èƒ½çš„è¡¨è¾¾å¼çš„å€¼çš„å’Œéå¸¸æ„Ÿå…´è¶£ã€‚ä½†è¿™æ¯•ç«Ÿå¤ªç®€å•äº†ï¼Œæ‰€ä»¥ä½ è¿˜æ‰“ç®—æ”¯æŒä¸€ä¸ªä¿®æ”¹æ“ä½œï¼Œå¯ä»¥ä¿®æ”¹æŸä¸ª $a_i$ çš„å€¼ã€‚\nä½ èƒ½å¤Ÿç¼–å†™ä¸€ä¸ªç¨‹åºå¯¹æ¯ä¸ªä¿®æ”¹éƒ½è¾“å‡ºä¿®æ”¹å®Œä¹‹åæ‰€æœ‰å¯èƒ½è¡¨è¾¾å¼çš„å’Œå—ï¼Ÿæ³¨æ„ï¼Œä¿®æ”¹æ˜¯æ°¸ä¹…çš„ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯æ¬¡ä¿®æ”¹éƒ½æ˜¯åœ¨ä¸Šä¸€æ¬¡ä¿®æ”¹çš„åŸºç¡€ä¸Šè¿›è¡Œï¼Œè€Œä¸æ˜¯åœ¨æœ€åˆçš„è¡¨è¾¾å¼ä¸Šè¿›è¡Œã€‚\né“¾æ¥ Luogu P4340\né¢˜è§£ å¥½é¢˜å¥½é¢˜ã€‚å¯ä»¥è¿ç”¨äººç±»çš„æ™ºæ…§è§£å†³ã€‚\nå¯ä»¥å‘ç°ï¼Œæ‰€æœ‰è¡¨è¾¾å¼çš„å’Œé‡Œé¢ï¼Œæœ‰ä¸€äº›åŠ å·å’Œå‡å·å…¶å®æ˜¯å¯ä»¥æŠµæ¶ˆçš„ã€‚\næˆ‘ä»¬é‡ç‚¹å…³æ³¨æ‰€æœ‰è¡¨è¾¾å¼ç¬¬ä¸€ä¸ªä¸æ˜¯ä¹˜å·çš„ä½ç½®ã€‚\nå¦‚æœæˆ‘ä»¬æœ‰è¿™ä¹ˆä¸€ä¸ªè¡¨è¾¾å¼ï¼š\n$$\na_1 \\times a_2 \\times \u0026hellip; \\times a_i + (a_{i+1} \u0026hellip; a_{n})\n$$\né‚£ä¹ˆå¿…ç„¶æœ‰ä¸€ä¸ªè¡¨è¾¾å¼ï¼š\n$$\na_1 \\times a_2 \\times \u0026hellip; \\times a_i - (a_{i+1} \u0026hellip; a_{n})\n$$\né‚£ä¹ˆä»–ä»¬çš„å’Œå°±æ˜¯ï¼š\n$$\n2 \\times a_1 \\times a_2 \\times \u0026hellip; \\times a_i\n$$\nè¿™æ ·çš„å¯¹æ•°ä¸€å…±æœ‰ $3^{n-i-1}$ å¯¹ï¼Œæ‰€ä»¥æ‰€æœ‰åœ¨ç¬¬ $i$ ä¸ªæ•°å­—åå‡ºç°ç¬¬ä¸€ä¸ªéä¹˜å·çš„è¿™æ ·çš„è¡¨è¾¾å¼çš„å’Œæ˜¯\n$$\n2 \\times 3^{n-i-1} \\times a_1 \\times a_2 \\times \u0026hellip; \\times a_i\n$$\næ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ¨å‡ºæ‰€æœ‰çš„è¡¨è¾¾å¼çš„å’Œå°±æ˜¯ï¼š\n$$\n\\sum_{i = 1}^{n-1} (2 \\times 3^{n-i-1} \\times a_1 \\times a_2 \\times \u0026hellip; \\times a_i)\n$$\nå¦‚æœæŒ‰ç…§ $i$ å»ºç«‹ä¸€æ£µçº¿æ®µæ ‘ï¼Œé‚£ä¹ˆæˆ‘ä»¬å‘ç°ï¼Œæ¯æ¬¡ä¿®æ”¹çš„éƒ½æ˜¯æŸäº›è¿ç»­çš„åŒºé—´ï¼Œé™¤å»åŸæ¥çš„æ•°ï¼Œç„¶åä¹˜ä¸Šæ–°çš„æ•°å³å¯ã€‚å› ä¸ºæ¨¡æ•°æ˜¯ä¸€ä¸ªç´ æ•°ï¼Œæ‰€ä»¥é™¤å»ä¸€ä¸ªæ•°å¯ä»¥ç”¨ä¹˜ä¸Šé€†å…ƒæ¥ä»£æ›¿ã€‚\nå»ºå¥½æ ‘ä¹‹ååªéœ€ç»´æŠ¤ä¸€ä¸ªæ”¯æŒåŒºé—´ä¹˜æ³•ï¼Œç»´æŠ¤åŒºé—´å’Œçš„çº¿æ®µæ ‘å³å¯ã€‚\næ—¶é—´å¤æ‚åº¦ï¼š$O(q (\\log{n} + \\log{\\text{mod}}))$\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106  #include \u0026lt;cstdio\u0026gt;using namespace std; typedef long long ll; #define mod 1000000007  const int MAXN = 110000; ll pow(ll x,ll k){ ll ans = 1; for(ll i = k;i;i\u0026gt;\u0026gt;=1,x = (x*x)%mod) if(i\u0026amp;1) ans = (ans * x)%mod; return ans; } ll niyuan(ll x){ return pow(x,mod-2); } namespace SegTree{ ll sum[MAXN\u0026lt;\u0026lt;2],lazy[MAXN\u0026lt;\u0026lt;2]; #define lson (nown\u0026lt;\u0026lt;1) #define rson (nown\u0026lt;\u0026lt;1|1) #define mid ((l+r)\u0026gt;\u0026gt;1) void push_up(int nown){ sum[nown] = (sum[lson] + sum[rson])%mod; } void build(int nown,int l,int r,ll *num){ lazy[nown] = 1; if(l == r) sum[nown] = num[l]; else{ build(lson,l,mid,num); build(rson,mid+1,r,num); push_up(nown); } } void addlabel(int nown,ll v){ (sum[nown] *= v)%=mod; (lazy[nown] *= v)%=mod; } void push_down(int nown){ if(lazy[nown]){ addlabel(lson,lazy[nown]),addlabel(rson,lazy[nown]); lazy[nown] = 1; } } void update(int nown,int l,int r,int ql,int qr,ll v){ if(ql \u0026lt;= l \u0026amp;\u0026amp; r \u0026lt;= qr){ addlabel(nown,v); } else{ push_down(nown); if(ql \u0026lt;= mid) update(lson,l,mid,ql,qr,v); if(qr \u0026gt;= mid+1) update(rson,mid+1,r,ql,qr,v); push_up(nown); } } ll query(){ return sum[1]; } } int n,m; ll a[MAXN]; ll s[MAXN]; ll tmp[MAXN]; void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m); for(int i = 1;i\u0026lt;=n;i++) scanf(\u0026#34;%lld\u0026#34;,\u0026amp;a[i]); } void build(){ s[1] = s[2] = 1; for(int i = 3;i\u0026lt;=n;i++) s[i] = (s[i-1] * 3)%mod; for(int i = 2;i\u0026lt;=n;i++) (s[i] *= 2)%=mod; tmp[n+1] = 1; for(int i = 1;i\u0026lt;=n;i++){ int ttt = n-i+1; tmp[ttt] = (tmp[ttt+1] * a[i])%mod; } for(int i = 1;i\u0026lt;=n;i++) (tmp[i] *= s[i]) %= mod; SegTree::build(1,1,n,tmp); } void solve(){ ll pos,v; for(int i = 1;i\u0026lt;=m;i++){ scanf(\u0026#34;%lld %lld\u0026#34;,\u0026amp;pos,\u0026amp;v); SegTree::update(1,1,n,1,n-pos+1,(niyuan(a[pos]) * v)%mod); a[pos] = v; printf(\u0026#34;%lld\\n\u0026#34;,SegTree::query()); } } int main(){ init(); build(); solve(); return 0; }   ","description":"","id":126,"section":"posts","tags":["çº¿æ®µæ ‘","æ•°æ®ç»“æ„"],"title":"ã€ŒSHOI2016ã€éšæœºåºåˆ—-çº¿æ®µæ ‘","uri":"https://blog.chenqiqian.com/posts/shoi2016-sequence/"},{"content":"å‡è®¾ç›®å‰è¢«å»¶è¯¯èˆªç­å…±æœ‰ $n$ ä¸ªï¼Œç¼–å·ä¸º $1$ è‡³ $n$ ã€‚æœºåœºåªæœ‰ä¸€æ¡èµ·é£è·‘é“ï¼Œæ‰€æœ‰çš„èˆªç­éœ€æŒ‰æŸä¸ªé¡ºåºä¾æ¬¡èµ·é£ï¼ˆç§°è¿™ä¸ªé¡ºåºä¸ºèµ·é£åºåˆ—ï¼‰ã€‚å®šä¹‰ä¸€ä¸ªèˆªç­çš„èµ·é£åºå·ä¸ºè¯¥èˆªç­åœ¨èµ·é£åºåˆ—ä¸­çš„ä½ç½®ï¼Œå³æ˜¯ç¬¬å‡ ä¸ªèµ·é£çš„èˆªç­ã€‚\nèµ·é£åºåˆ—è¿˜å­˜åœ¨ä¸¤ç±»é™åˆ¶æ¡ä»¶ï¼š\n  ç¬¬ä¸€ç±»ï¼ˆæœ€æ™šèµ·é£æ—¶é—´é™åˆ¶ï¼‰ï¼šç¼–å·ä¸º $i$ çš„èˆªç­èµ·é£åºå·ä¸å¾—è¶…è¿‡ $k_i$ ;\n  ç¬¬äºŒç±»ï¼ˆç›¸å¯¹èµ·é£é¡ºåºé™åˆ¶ï¼‰ï¼šå­˜åœ¨ä¸€äº›ç›¸å¯¹èµ·é£é¡ºåºé™åˆ¶ $(a, b)$ ï¼Œè¡¨ç¤ºèˆªç­ $a$ çš„èµ·é£æ—¶é—´å¿…é¡»æ—©äºèˆªç­ $b$ ï¼Œå³èˆªç­ $a$ çš„èµ·é£åºå·å¿…é¡»å°äºèˆªç­ $b$ çš„èµ·é£åºå·ã€‚\n  å° $\\text{X}$ æ€è€ƒçš„ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œè‹¥ç»™å®šä»¥ä¸Šä¸¤ç±»é™åˆ¶æ¡ä»¶ï¼Œæ˜¯å¦å¯ä»¥è®¡ç®—å‡ºä¸€ä¸ªå¯è¡Œçš„èµ·é£åºåˆ—ã€‚ç¬¬äºŒä¸ªé—®é¢˜åˆ™æ˜¯ï¼Œåœ¨è€ƒè™‘ä¸¤ç±»é™åˆ¶æ¡ä»¶çš„æƒ…å†µä¸‹ï¼Œå¦‚ä½•æ±‚å‡ºæ¯ä¸ªèˆªç­åœ¨æ‰€æœ‰å¯è¡Œçš„èµ·é£åºåˆ—ä¸­çš„æœ€å°èµ·é£åºå·ã€‚\né“¾æ¥ Luogu P1954\né¢˜è§£ å¯¹äºè¿™äº›é™åˆ¶ï¼Œæˆ‘ä»¬å‘ç°å¯ä»¥è½¬æ¢æˆä¸€ä¸ªæ‹“æ‰‘åºçš„é—®é¢˜ã€‚ä½†æ˜¯æˆ‘ä»¬å‘ç°æœ€æ™šçš„èµ·é£æ—¶é—´é™åˆ¶æ¯”è¾ƒéš¾è¾¾æˆï¼Œè€Œä¸¤å‘çš„ç›¸å¯¹å…³ç³»åˆ™æ˜¯æ¯”è¾ƒè½»æ¾çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è€ƒè™‘åˆ°å¯ä»¥æŠŠæ•´ä¸ªæ—¶é—´è½´åå‘ï¼Œé‚£ä¹ˆå°±å˜æˆäº†æ‰€æœ‰é£æœºéƒ½æœ‰ä¸€ä¸ªæœ€æ—©èµ·é£çš„é™åˆ¶ï¼Œé‚£ä¹ˆå°±å¯ä»¥åŠ ä¸€ä¸ªè™šè¾¹ï¼ŒæŒ‰æ—¶é—´è§£é”ï¼Œè¿™ä¸ªé—®é¢˜å°±å¯ä»¥è§£å†³äº†ã€‚\nå¯¹äºç¬¬äºŒé—®ï¼Œæˆ‘ä»¬å°±ç›¸å½“äºæŠŠè¿™ä¸ªé£æœºï¼Œåå‘ä¹‹åèƒ½å‹å¤šåå°±å‹å¤šåï¼Œå°†æ‹“æ‰‘æ’åºé‡Œé¢çš„é˜Ÿåˆ—å˜ä¸ºä¼˜å…ˆé˜Ÿåˆ—ï¼Œå°±å¯ä»¥äº†ã€‚\nå¤æ‚åº¦æ˜¯ $O(n^2 \\log{n})$ï¼Œè²Œä¼¼ä¸æ˜¯æ­£è§£ï¼ŒBZOJå¯è¿‡ï¼ŒLuogu éœ€å¼€ O2 ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;vector\u0026gt;#include \u0026lt;queue\u0026gt;#include \u0026lt;cstring\u0026gt;#define inf 0x3f3f3f3f #define pii pair\u0026lt;int,int\u0026gt; using namespace std; const int MAXN = 2100; int n,m; int k[MAXN]; vector\u0026lt;int\u0026gt; edge[MAXN]; vector\u0026lt;int\u0026gt; qqq[MAXN]; int ans[MAXN]; priority_queue\u0026lt;pii\u0026gt; q; int toposort(int w = 0){ // printf(\u0026#34;w:%d\\n\u0026#34;,w);  static int in[MAXN]; memset(in,0,sizeof(in)); while(!q.empty()) q.pop(); for(int x = 1;x\u0026lt;=n;x++){ for(int i = 0;i\u0026lt;edge[x].size();i++){ in[edge[x][i]]++; } in[x]++; } for(int j = n;j\u0026gt;=1;--j){ for(int i = 0;i\u0026lt;qqq[j].size();i++){ int x = qqq[j][i]; if(--in[x] == 0){ q.push(make_pair((w==x?-inf:k[x]),x)); } } int x = q.top().second;q.pop(); if(x == w) return j; ans[j] = x; for(int i = 0;i\u0026lt;edge[x].size();i++){ int v = edge[x][i]; if(--in[v] == 0){ q.push(make_pair((w==v?-inf:k[v]),v)); } } } return 0; } void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m); for(int i = 1;i\u0026lt;=n;i++){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;k[i]); qqq[k[i]].push_back(i); } int a,b; for(int i = 1;i\u0026lt;=m;i++){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;a,\u0026amp;b); edge[b].push_back(a); } } void solve(){ toposort(); for(int i = 1;i\u0026lt;=n;i++) printf(\u0026#34;%d \u0026#34;,ans[i]); printf(\u0026#34;\\n\u0026#34;); for(int i = 1;i\u0026lt;=n;i++) printf(\u0026#34;%d \u0026#34;,toposort(i)); printf(\u0026#34;\\n\u0026#34;); } int main(){ init(); solve(); return 0; }   ","description":"","id":127,"section":"posts","tags":["å›¾è®º","æ‹“æ‰‘æ’åº"],"title":"ã€ŒNOI2010ã€èˆªç©ºç®¡åˆ¶-æ‹“æ‰‘æ’åº","uri":"https://blog.chenqiqian.com/posts/noi2010-airplane/"},{"content":"æœ‰ $n$ ä»¶ç‰©å“ï¼Œæ¯ä»¶ç‰©å“æœ‰ä¸‰ä¸ªå±æ€§ $a[i], b[i], c[i]$ , $(a[i] \u0026lt; b[i])$ ã€‚\nå†ç»™å‡º $q$ ä¸ªè¯¢é—®ï¼Œæ¯ä¸ªè¯¢é—®ç”±éè´Ÿæ•´æ•° $m$ , $k$ , $s$ ç»„æˆï¼Œé—®æ˜¯å¦èƒ½å¤Ÿé€‰å‡ºæŸäº›ç‰©å“ä½¿å¾—ï¼š\n  å¯¹äºæ¯ä¸ªé€‰çš„ç‰©å“ $i$ ï¼Œæ»¡è¶³ $a[i] \\leq m$ ä¸” $b[i]\u0026gt;m+s$ ã€‚\n  æ‰€æœ‰é€‰å‡ºç‰©å“çš„ $c[i]$ çš„å’Œæ­£å¥½æ˜¯ $k$ ã€‚\n  é“¾æ¥ Luogu P3537\né¢˜è§£ å¥½é¢˜å¥½é¢˜ã€‚\né¦–å…ˆæˆ‘ä»¬å‘ç°ï¼Œå¦‚æœæŠŠ $a[i]$ è¿™ä¸€ç»´ $sort$ æ‰ï¼Œä½¿ $a[i]$ å•å¢çš„è¯ï¼Œè¿™ä¸ªé—®é¢˜å°±å˜æˆäº†ç»™å®šè‹¥å¹²ä¸ªç‰©å“ï¼Œé—®èƒ½ä¸èƒ½å–è‹¥å¹²ä¸ªç‰©ä½“æ»¡è¶³ $\\sum c[i] = k$ ï¼Œä¸” $\\min(b[i]) \u0026gt; m + s$ã€‚\nç„¶åè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬æƒ³è¦æ¯åŠ å…¥ä¸€ä¸ªç‰©å“éƒ½èƒ½å¤Ÿæ›´æ–°ç­”æ¡ˆï¼Œå¯ä»¥ç”¨ $dp$ çš„æ–¹æ³•æ¥æ›´æ–°ï¼ŒçŠ¶æ€çš„ç¬¬ä¸€ç»´ä¹Ÿå°±å¾ˆå¥½è®¾ç½®ï¼Œè‚¯å®šæ˜¯å‰ $i$ ä¸ªç‰©å“å¦‚ä½•å¦‚ä½•ã€‚ç„¶åçœ‹åˆ°æ•°æ®èŒƒå›´ï¼Œæˆ‘ä»¬éœ€è¦æ€è€ƒå¦‚ä½•åœ¨ $O(\\log n)$ æˆ–è€… $O(1)$ çš„æ—¶é—´å†…å‡ºè§£ã€‚\næ ¹æ®æ—¶é—´çš„é™åˆ¶ï¼Œä¸‹é¢æˆ‘ä»¬åªèƒ½è®¾ç½®ä¸€ç»´äº†ï¼Œä¸å¯èƒ½åŒæ—¶è¡¨ç¤º $\\sum c[i]$ å’Œ $\\min(b[i])$ ã€‚è€ƒè™‘åˆ°è¿™åªæ˜¯ä¸€ä¸ªå¯è¡Œæ€§åˆ¤å®šï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸ç”¨éƒ½å­˜ä¸¤ä¸ªï¼Œåªè¦å­˜çš„è¿™ä¸€ç»´å’Œ$ dp$ æ•°ç»„çš„ä¿¡æ¯èƒ½å¤Ÿè®©æˆ‘ä»¬æ¨æ–­å‡ºæ¥å¯è¡Œä¸å¯è¡Œå°±å¯ä»¥ã€‚\næ‰€ä»¥æˆ‘ä»¬ä»¤ $dp[i][j]$ è¡¨ç¤ºå‰iä¸ªç‰©å“ï¼Œ$\\sum c[i]$ ä¸º $j$ çš„æƒ…å†µä¸‹ï¼Œæ‰€æœ‰æ–¹æ¡ˆä¸­ $\\min(b[i])$ æœ€å¤§çš„æ˜¯å¤šå°‘ã€‚\nè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬æŸ¥ $dp[i][k]$ ï¼Œè‹¥å…¶å¤§äºç­‰äº $k$ ï¼Œåˆ™æ— è§£ï¼›å¦åˆ™æœ‰è§£ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cstring\u0026gt;#include \u0026lt;set\u0026gt;#include \u0026lt;algorithm\u0026gt;using namespace std; const int MAXN = 1100,MAXM = 1100000; struct Query{ int id; int x,y,c; bool operator \u0026lt;(const Query \u0026amp;_q)const{ return x \u0026lt; _q.x; } }p[MAXN],q[MAXM]; int n,m; void init(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n); for(int i = 1;i\u0026lt;=n;i++){ scanf(\u0026#34;%d %d %d\u0026#34;,\u0026amp;p[i].c,\u0026amp;p[i].x,\u0026amp;p[i].y); } scanf(\u0026#34;%d\u0026#34;,\u0026amp;m); for(int i = 1;i\u0026lt;=m;i++){ scanf(\u0026#34;%d %d %d\u0026#34;,\u0026amp;q[i].x,\u0026amp;q[i].c,\u0026amp;q[i].y); q[i].y += q[i].x; q[i].id = i; } } void solve(){ sort(p+1,p+n+1),sort(q+1,q+m+1); static int dp[MAXM],ans[MAXM]; memset(dp,0,sizeof(dp)); dp[0] = 0x3f3f3f3f; int j = 1; p[n+1].x = 0x3f3f3f3f; for(int x = 1;x\u0026lt;=n+1;x++){ while(j \u0026lt;= m \u0026amp;\u0026amp; q[j].x \u0026lt; p[x].x){ ans[q[j].id] = dp[q[j].c] \u0026lt;= q[j].y ? 0: 1; j++; } if(x == n+1) break; for(int i = 100000;i\u0026gt;=p[x].c;i--) dp[i] = max(dp[i],min(dp[i-p[x].c],p[x].y)); } for(int i = 1;i\u0026lt;=m;i++){ printf(\u0026#34;%s\\n\u0026#34;,ans[i]?\u0026#34;TAK\u0026#34;:\u0026#34;NIE\u0026#34;); } } int main(){ init(); solve(); return 0; }   ","description":"","id":128,"section":"posts","tags":["åŠ¨æ€è§„åˆ’","èƒŒåŒ…"],"title":"ã€ŒPOI2012ã€Cloakroom-ç±»èƒŒåŒ…dp","uri":"https://blog.chenqiqian.com/posts/poi2012-cloakroom/"},{"content":"ç®€å•ç‰ˆé¢˜æ„ï¼š\nç»™å®šä¸€ä¸ª $R \\times C$ çš„çŸ©å½¢ï¼Œåœ¨å…¶ä¸­ $N$ ä¸ªä½ç½®æœ‰éšæœºç”Ÿæˆçš„èµ„æºç‚¹ã€‚ç°åœ¨è¯·ä½ æ±‚å‡ºåœ¨æ‰€æœ‰çš„å­çŸ©å½¢ä¸­ï¼Œè‡³å°‘åŒ…å«ä¸€ä¸ªèµ„æºç‚¹çš„çŸ©å½¢æ•°é‡ã€‚\nå®Œæ•´ç‰ˆé¢˜æ„ï¼š\nç»ˆäºåˆ°è¾¾äº†è¿™æ¬¡é€‰æ‹”èµ›çš„æœ€åä¸€é¢˜ï¼Œæƒ³å¿…ä½ å·²ç»åŒå€¦äº†å°è“å’Œå°ç™½çš„æ•…äº‹ï¼Œä¸ºäº†å›é¦ˆå„ä½æ¯”èµ›é€‰æ‰‹ï¼Œæ­¤é¢˜çš„ä¸»è§’æ˜¯è´¯ç©¿è¿™æ¬¡æ¯”èµ›çš„å…³é”®äººç‰©â€”â€”å°è“çš„å¥½å‹ã€‚\nåœ¨å¸®å°è“ç¡®å®šäº†æ—…æ¸¸è·¯çº¿åï¼Œå°è“çš„å¥½å‹ä¹Ÿä¸ä¼šæµªè´¹è¿™ä¸ªéš¾å¾—çš„æš‘å‡ã€‚ä¸å°è“ä¸åŒï¼Œå°è“çš„å¥½å‹å¹¶ä¸æƒ³å°†æ—¶é—´èŠ±åœ¨æ—…æ¸¸ä¸Šï¼Œè€Œæ˜¯ç›¯ä¸Šäº†æœ€è¿‘å‘è¡Œçš„å³æ—¶æˆ˜ç•¥æ¸¸æˆâ€”â€”SangoCraftã€‚ä½†åœ¨å‰å¾€é€šå…³ä¹‹è·¯çš„é“è·¯ä¸Šï¼Œä¸€ä¸ªå°æ¸¸æˆæŒ¡ä½äº†å°è“çš„å¥½å‹çš„æ­¥ä¼ã€‚\nâ€œå›½å®¶çš„æˆ˜äº‰å…¶æœ¬è´¨æ˜¯æŠ¢å¤ºèµ„æºçš„æˆ˜äº‰â€æ˜¯æ•´æ¬¾æ¸¸æˆçš„æ ¸å¿ƒç†å¿µï¼Œè¿™ä¸ªå°æ¸¸æˆä¹Ÿä¸ä¾‹å¤–ã€‚ç®€å•æ¥è¯´ï¼Œç”¨æˆ·éœ€è¦åœ¨ç»™å®šçš„å¤§å°ä¸º $R \\times C$ é•¿æ–¹å½¢åœŸåœ°ä¸Šé€‰å‡ºä¸€å—å­çŸ©å½¢ï¼Œè€Œç³»ç»Ÿéšæœºç”Ÿæˆäº† $N$ ä¸ªèµ„æºç‚¹ï¼Œä½äºç”¨æˆ·æ‰€é€‰çš„é•¿æ–¹å½¢åœŸåœ°ä¸Šçš„èµ„æºç‚¹è¶Šå¤šï¼Œç»™äºˆç”¨æˆ·çš„å¥–åŠ±ä¹Ÿè¶Šå¤šã€‚æ‚²å‰§çš„æ˜¯ï¼Œå°è“çš„å¥½å‹è™½ç„¶æ‹¥æœ‰ç€æå…¶ä¼˜ç§€çš„èƒ½åŠ›ï¼Œä½†åŒæ—¶ä¹Ÿæœ‰ç€æå·®çš„RPï¼Œå°è“çš„å¥½å‹æ‰€é€‰çš„åŒºåŸŸæ€»æ˜¯æ²¡æœ‰ä¸€ä¸ªèµ„æºç‚¹ã€‚\nç»ˆäºæœ‰ä¸€å¤©ï¼Œå°è“çš„å¥½å‹å†³å®šæŠ•è¯‰è¿™æ¬¾æ¸¸æˆçš„åˆ¶é€ å‚å•†ï¼Œä¸ºäº†æœé›†è¯æ®ï¼Œå°è“çš„å¥½å‹æƒ³ç®—å‡ºè‡³å°‘åŒ…å«ä¸€ä¸ªèµ„æºç‚¹çš„åŒºåŸŸçš„æ•°é‡ã€‚ä½œä¸ºå°è“çš„å¥½å‹ï¼Œè¿™è‡ªç„¶æ˜¯ä½ åˆ†å†…ä¹‹äº‹ã€‚\næ•°æ®èŒƒå›´ï¼šå¯¹äº$100%$çš„æ•°æ®ï¼Œ$R,C \\leq 40000$, $N \\leq 100000$ï¼Œèµ„æºç‚¹çš„ä½ç½®ä¸¤ä¸¤ä¸åŒï¼Œä¸”ä½ç½®ä¸º éšæœºç”Ÿæˆ ã€‚\n é“¾æ¥ Luogu P2611\né¢˜è§£ ç¥é¢˜orz\né¦–å…ˆæŠŠé—®é¢˜è½¬åŒ–æˆä¸åŒ…å«ä¸€ä¸ªèµ„æºç‚¹çš„å­çŸ©å½¢æ•°ç›®ã€‚\nç®€ç›´ä¸å¯åšå¥½å—ï¼æšä¸¾çŸ©å½¢éƒ½ggï¼Œç®€ç›´å¾ˆä¸å¯åš\u0026hellip;\næ‰€ä»¥è¯´ï¼Œæˆ‘ä»¬éœ€è¦ç”¨ä¸€äº›ä¸œè¥¿æ¥åŠ é€Ÿè¿™ä¸ªè¿‡ç¨‹ã€‚æˆ‘ä¹Ÿä¸çŸ¥é“ï¼Œæ€ä¹ˆå°±æƒ³åˆ°äº†ç¬›å¡å°”æ ‘\u0026hellip;\n ç¬›å¡å°”æ ‘æ˜¯ä¸€æ£µäºŒå‰æ ‘ï¼Œæ ‘çš„æ¯ä¸ªèŠ‚ç‚¹æœ‰ä¸¤ä¸ªå€¼ï¼Œä¸€ä¸ªä¸º $\\text{key}$ï¼Œä¸€ä¸ªä¸º $\\text{val}$ã€‚å…‰çœ‹ $\\text{key}$ çš„è¯ï¼Œç¬›å¡å°”æ ‘æ˜¯ä¸€æ£µäºŒå‰æœç´¢æ ‘ï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„å·¦å­æ ‘çš„ $\\text{key}$ éƒ½æ¯”å®ƒå°ï¼Œå³å­æ ‘éƒ½æ¯”å®ƒå¤§ï¼›å…‰çœ‹ $\\text{val}$ çš„è¯ï¼Œç¬›å¡å°”æ ‘æœ‰ç‚¹ç±»ä¼¼å †ï¼Œæ ¹èŠ‚ç‚¹çš„ $\\text{val}$ æ˜¯æœ€å°ï¼ˆæˆ–è€…æœ€å¤§ï¼‰çš„ï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„ $\\text{val}$ éƒ½æ¯”å®ƒçš„å­æ ‘è¦å¤§ã€‚\nFrom: SengXian\u0026rsquo;s Blog\n æˆ‘ä»¬ç”¨æ‰«æçº¿ï¼Œä»ä¸Šå¾€ä¸‹æ‰«æï¼Œç„¶åæˆ‘ä»¬çš„ç¬›å¡å°”æ ‘ç»´æŠ¤çš„æ˜¯æ¯ä¸€åˆ—ï¼Œä¸­åºéå†å°±æ˜¯åˆ—ä»å·¦åˆ°å³çš„é¡ºåºï¼Œæ¯ä¸€ä¸ªèŠ‚ç‚¹çš„ $\\text{val}$ å°±æ˜¯è¿™æ¡æ‰«æçº¿åˆ°è¿™ä¸€åˆ—æœ€ä½çš„èµ„æºç‚¹çš„é«˜åº¦ã€‚\nè¿™é‡Œçš„ç¬›å¡å°”æ ‘ï¼Œæˆ‘ä»¬ä¸ç»´æŠ¤ $\\text{key}$ ï¼Œæ˜¯ä»¥åºåˆ—ä¸‹æ ‡æ¥å»ºæ ‘ï¼Œç±»ä¼¼æ–‡è‰ºå¹³è¡¡æ ‘çš„ Splay ï¼›å †åˆ™æ˜¯å°æ ¹å †ã€‚\nç”±äºé«˜åº¦çš„éšæœºæ€§ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œè¿™æ£µç¬›å¡å°”æ ‘çš„æœŸæœ›é«˜åº¦æ˜¯ $O(\\log{n})$ çš„ã€‚\næ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç»´æŠ¤ä¸€ç‚¹ä¸œè¥¿ï¼Œæ¥åŠ é€Ÿæˆ‘ä»¬çš„è¿ç®—ã€‚\næˆ‘ä»¬ç»´æŠ¤ä¸€ä¸ª $sum$ ï¼Œä»£è¡¨ä¸‹ç•Œåœ¨å½“å‰æ‰«æçº¿ï¼Œä¸Šç•Œåœ¨è¿™ä¸ªèŠ‚ç‚¹é«˜åº¦ä»¥ä¸‹çš„å­çŸ©å½¢çš„ä¸ªæ•°ã€‚æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå½“å‰çš„èŠ‚ç‚¹çš„ $siz$ ï¼Œå°±æ˜¯ä¸Šç•Œé«˜åº¦åœ¨å…¶ä¸‹çš„å®½åº¦ï¼ˆåˆ—æ•°ï¼‰ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥å¾—å‡ºæ»¡è¶³è¿™ä¸ªæ¡ä»¶çš„å­çŸ©å½¢ã€‚ç„¶åæ‰€æœ‰çš„ä¸‹ç•Œåœ¨æ‰«æçº¿ä¸Šçš„çŸ©å½¢ï¼Œéƒ½å¯ä»¥åœ¨è¿™ä¸ªç¬›å¡å°”æ ‘çš„æ‰€æœ‰èŠ‚ç‚¹å¤„è¢«ä¸é‡ä¸æ¼çš„åŒ…å«ã€‚\nç„¶åæˆ‘ä»¬æ€è€ƒå¦‚ä½•æ›´æ–°ã€‚æ‰«æçº¿å¾€ä¸‹çš„è¯å°±æ˜¯æ‰€æœ‰çš„ $ht+1$ï¼Œå‘ç°å¯ä»¥æ‰“æ ‡è®° $O(1)$ è§£å†³ã€‚å‡ºç°ä¸€ä¸ªç‚¹äº‹å®ä¸Šå°±æ˜¯å•ç‚¹ä¿®æ”¹ä¼˜å…ˆå€¼ï¼ˆ $\\text{val}$ ï¼‰ï¼Œç„¶åå¾€ä¸Šè½¬ï¼Œä¹Ÿå¯ä»¥åœ¨ $O(\\log {n})$ å†…è§£å†³ã€‚\nç„¶åè®¡ç®—å°±å¥½äº†ã€‚æœ‰ä¸å°‘ç»†èŠ‚\u0026hellip;æ€ªéš¾è°ƒçš„\u0026hellip;è¦ä¸æ˜¯æ•°æ®ç»“æ„åŸºç¡€å¥½ä¼°è®¡å°±ggäº†\u0026hellip;\næœ€åçš„å¤æ‚åº¦å¤§çº¦æ˜¯ $O(C + N \\log R)$ ï¼Ÿ\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;algorithm\u0026gt;#include \u0026lt;cctype\u0026gt;#define ll long long typedef int T; using namespace std; #define calc(x) (((ll)(x)*((x)+1))/2)  namespace fast_io{ //... }using namespace fast_io; const int MAXN = 110000; namespace Treap{ //å°æ ¹å †  #define ls c[x][0]  #define rs c[x][1]  ll ans[MAXN],addn[MAXN]; int ht[MAXN],siz[MAXN]; int c[MAXN][2],cnt = 0; int root; void maintain(int x){//ç¡®ä¿åˆæ³•æ‰èƒ½maintain  siz[x] = siz[ls] + siz[rs] + 1; ans[x] = ans[ls] + ans[rs]; ans[x] += (ll)(ht[ls] - ht[x])*calc(siz[ls]); ans[x] += (ll)(ht[rs] - ht[x])*calc(siz[rs]); } int __build(int l,int r){ if(l \u0026gt; r) return 0; int x = ++cnt,mid = (l+r)\u0026gt;\u0026gt;1; siz[x] = 1; ls = __build(l,mid-1),rs = __build(mid+1,r); maintain(x); return x; } void add(int x,int v){ addn[x] += v,ht[x] += v; } void push_down(int x){ if(addn[x]){ add(ls,addn[x]),add(rs,addn[x]); addn[x] = 0; } } void rotate(int \u0026amp;x,int t){ int y = c[x][t]; c[x][t] = c[y][1-t]; c[y][1-t] = x; maintain(x),maintain(y); x = y; } void modify(int \u0026amp;x,int r){ push_down(x);int t = siz[ls] + 1; if(r == t){ ht[x] = 0;maintain(x);return; } else{ if(r \u0026lt; t){ modify(ls,r); if(ht[ls]\u0026lt;ht[x]) rotate(x,0); else maintain(x); } else{ modify(rs,r-t); if(ht[rs]\u0026lt;ht[x]) rotate(x,1); else maintain(x); } } } void add(){add(root,1);} void modify(int r){modify(root,r);} ll query(){return ans[root];} int getheight(){return ht[root];} void build(int n){root = __build(1,n);} } int n,m,k; struct Point{ int x,y; bool operator \u0026lt; (const Point \u0026amp; _a)const{ if(x != _a.x) return x \u0026lt; _a.x; else return y \u0026lt; _a.y; } }p[MAXN]; void init(){ read(n),read(m),read(k); for(int i = 1;i\u0026lt;=k;i++){ read(p[i].x),read(p[i].y); } } void build(){ sort(p+1,p+k+1); Treap::build(m); } void solve(){ static ll ans = calc(n)*calc(m); for(int i = 1,j = 1;i\u0026lt;=n;i++){ Treap::add(); //printf(\u0026#34;%d %d\\n\u0026#34;,p[j].x,p[j].y);  while(j \u0026lt;= k \u0026amp;\u0026amp; p[j].x == i){ Treap::modify(p[j].y);j++; } ans -= Treap::query() + calc(Treap::siz[Treap::root]) * Treap::getheight(); } printf(\u0026#34;%lld\\n\u0026#34;,ans); } int main(){ init(); build(); solve(); return 0; }   ","description":"","id":129,"section":"posts","tags":["æ•°æ®ç»“æ„","Treap"],"title":"ã€ŒZJOI2012ã€å°è“çš„å¥½å‹-Treap","uri":"https://blog.chenqiqian.com/posts/zjoi2012-friend/"},{"content":"æœ‰ä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„å­—ç¬¦ä¸²ï¼Œæ¯ä¸€ä½åªä¼šæ˜¯ $\\text{p}$ æˆ– $\\text{j}$ ã€‚æ±‚ä¸€ä¸ªæœ€é•¿å­ä¸²ï¼Œä½¿å¾—ä¸ç®¡æ˜¯ä»å·¦å¾€å³è¿˜æ˜¯ä»å³å¾€å·¦å–ï¼Œéƒ½ä¿è¯æ¯æ—¶æ¯åˆ»å·²å–å‡ºçš„ $\\text{p}$ çš„ä¸ªæ•°ä¸å°äº $\\text{j}$ çš„ä¸ªæ•°ã€‚\né“¾æ¥ Luogu P3564\né¢˜è§£ çæé¢˜ã€‚\næŠŠ $p$ çœ‹åš $1$ ï¼Œ$j$ çœ‹åš $-1$ ï¼Œé‚£ä¹ˆé—®é¢˜è½¬åŒ–ä¸ºï¼šæ±‚æœ€é•¿çš„å­ä¸² $s[l\u0026hellip;r]$ ï¼Œä½¿å¾— $sum[l-1] \\leq sum[i] \\leq sum[r]$ å¯¹äºä»»æ„ $i \\in [l,r]$ æˆç«‹ã€‚\næˆ‘ä»¬é¦–å…ˆå»ºä¸€ä¸ªç±»ä¼¼å›¾çš„ä¸œè¥¿ï¼ŒæŠŠæ‰€æœ‰ $sum$ ç›¸åŒçš„ä½è¿åˆ°ä¸€èµ·å»ï¼Œè®© $nex[i]$ è¡¨ç¤ºä¸‹ä¸€ä¸ª $sum[x] = sum[i]$ çš„ä½ç½®ï¼Œæ²¡æœ‰çš„è¯å°±æ˜¯ $-1$ ï¼›è®© $to[i-1]$ è¡¨ç¤ºæˆ‘ä»¬ä»ç¬¬$i$ä½å¼€å§‹æ‰¾åˆ°çš„æœ€è¿œçš„æ»¡è¶³è¯¥æ€§è´¨çš„ä½ç½®ã€‚\nç„¶åæˆ‘ä»¬å‘ç°ï¼Œç­”æ¡ˆå°±æ˜¯ $\\max(to[i-1]-i+1)$ ã€‚\næ‰€ä»¥æˆ‘ä»¬åªè¦æ¨å‡º $to[i]$ æ•°ç»„å°±å¯ä»¥äº†ã€‚\nå‰©ä¸‹çš„æˆ‘å°±è¯´ä¸æ˜ç™½äº†2333ï¼Œçœ‹ä»£ç æ„Ÿæ€§ç†è§£å§ã€‚\nä¸ºå•¥å®ƒæ˜¯æœ€é•¿çš„æˆ‘ä¹Ÿä¸çŸ¥é“ï¼Œåæ­£èƒ½è¿‡ã€‚\nå¤æ‚åº¦ $O(n)$ ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;algorithm\u0026gt;#include \u0026lt;cstring\u0026gt;using namespace std; const int MAXN = 1100000; int n; char str[MAXN]; int a[MAXN],sum[MAXN]; int minsum = 0; int fir[MAXN],nex[MAXN],to[MAXN]; // firä»…åšå»ºå›¾æ–¹ä¾¿ç”¨ï¼Œnexè¡¨ç¤ºä¸‹ä¸€ä¸ªsumç›¸åŒçš„ä½ç½® // toè¡¨ç¤ºåŒºé—´æœ€è¿œèƒ½å¤Ÿå»¶ä¼¸çš„è·ç¦»  void init(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n); scanf(\u0026#34;%s\u0026#34;,str + 1); memset(fir,-1,sizeof(fir)); for(int i = 1;i\u0026lt;=n;i++){ a[i] = str[i] == \u0026#39;p\u0026#39; ? 1 : -1; sum[i] = sum[i-1] + a[i]; minsum = min(sum[i],minsum); } for(int i = n;~i;--i){ int x = sum[i] - minsum; nex[i] = fir[x],to[i] = i,fir[x] = i; } } void solve(){ static int ans = 0; int r = n; for(int l = n;l\u0026gt;=1;--l){ if(a[l] == -1){ r = l-1; } else{ int t = nex[l-1]; if(~t \u0026amp;\u0026amp; sum[to[t]] \u0026gt;= sum[r]) r = to[t]; to[l-1] = r; ans = max(ans,r-l+1); } } printf(\u0026#34;%d\\n\u0026#34;,ans); } int main(){ init(); solve(); return 0; }   ","description":"","id":130,"section":"posts","tags":["çæ"],"title":"ã€ŒPOI2014ã€Salad Bar-çæ","uri":"https://blog.chenqiqian.com/posts/poi2014-salad-bar/"},{"content":"ç»™å®šä¸¤ä¸ªæ•°å­—ä¸² $A$ å’Œ $B$ ï¼Œé€šè¿‡å°† $A$ å’Œ $B$ è¿›è¡ŒäºŒè·¯å½’å¹¶å¾—åˆ°ä¸€ä¸ªæ–°çš„æ•°å­—ä¸² $T$ ï¼Œè¯·æ‰¾åˆ°å­—å…¸åºæœ€å°çš„ $T$ ã€‚\né“¾æ¥ BZOJ\nï¼ˆç¦»çº¿é¢˜é¢ï¼‰\ndataï¼ˆæ•°æ®ï¼‰\né¢˜è§£ å¦‚æœå‰é¢ä¸¤ä¸ªå­—ç¬¦ä¸åŒï¼Œæ˜¾ç„¶é€‰å–å°çš„ä¸€ä¸ªã€‚\nåˆ†æƒ…å†µè®¨è®ºï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå¦‚æœç›¸åŒï¼Œé‚£ä¹ˆå°±åº”è¯¥å–ç›®å‰åç¼€å­—å…¸åºè¾ƒå°çš„ä¸€ä¸ªã€‚\næ‰€ä»¥äº‹å®ä¸Šå°±æ˜¯å–åç¼€å­—å…¸åºæ¯”è¾ƒå°çš„ã€‚\næ­¤é¢˜äº¦å¯ hash äºŒåˆ†ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76  #include \u0026lt;cstdio\u0026gt;using namespace std; const int MAXN = 410000; namespace SA{ int s[MAXN],sa[MAXN],ht[MAXN],rk[MAXN],x[MAXN],y[MAXN]; int cnt[MAXN]; void get_sa(int n,int m){ for(int i = 0;i\u0026lt;m;i++) cnt[i] = 0; for(int i = 0;i\u0026lt;n;i++) cnt[s[i]]++; for(int i = 1;i\u0026lt;m;i++) cnt[i] += cnt[i-1]; for(int i = n-1;~i;--i) sa[--cnt[s[i]]] = i; m = rk[sa[0]] = 0; for(int i = 1;i\u0026lt;n;i++) rk[sa[i]] = s[sa[i]] != s[sa[i-1]]?++m:m; for(int j = 1;;j\u0026lt;\u0026lt;=1){ if(++m == n) break; for(int i = 0;i\u0026lt;j;i++) y[i] = n-j+i; for(int i = 0,k = j;i\u0026lt;n;i++) if(sa[i] \u0026gt;= j) y[k++] = sa[i] - j; for(int i = 0;i\u0026lt;n;i++) x[i] = rk[y[i]]; for(int i = 0;i\u0026lt;m;i++) cnt[i] = 0; for(int i = 0;i\u0026lt;n;i++) cnt[x[i]]++; for(int i = 1;i\u0026lt;m;i++) cnt[i] += cnt[i-1]; for(int i = n-1;~i;--i) sa[--cnt[x[i]]] = y[i]; m = rk[sa[0]] = 0; for(int i = 1;i\u0026lt;n;i++) rk[sa[i]] = (y[sa[i]] != y[sa[i-1]] || y[sa[i]+j] != y[sa[i-1]+j])?++m:m; } } void build(int n,int* str){ int m = 1002;str[n++] = 0; for(int i = 0;i\u0026lt;n;i++) s[i] = str[i]; get_sa(n,m); } bool cmp(int i,int j){ return rk[i+1] \u0026lt; rk[j+1]; } } int n; int u,v; int a[MAXN],b[MAXN],t[MAXN],ans[MAXN]; void init(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;u); for(int i = 0;i\u0026lt;u;i++) scanf(\u0026#34;%d\u0026#34;,\u0026amp;a[i]); scanf(\u0026#34;%d\u0026#34;,\u0026amp;v); for(int i = 0;i\u0026lt;v;i++) scanf(\u0026#34;%d\u0026#34;,\u0026amp;b[i]); for(int i = 0;i\u0026lt;u;i++) t[n++] = a[i]; t[n++] = 0; for(int i = 0;i\u0026lt;v;i++) t[n++] = b[i]; SA::build(n,t); } void solve(){ int l = 0,r = 0,t = 0; while(t \u0026lt;= u+v){ // printf(\u0026#34;l:%d,%d r:%d,%d\\n\u0026#34;,l,a[l],r,b[r]);  if(l == u) ans[t++] = b[r++]; else if(r == v) ans[t++] = a[l++]; else{ if(a[l]==b[r]) ans[t++] = SA::cmp(l,u+1+r)?a[l++]:b[r++]; else ans[t++] = a[l] \u0026lt; b[r]?a[l++]:b[r++]; } } for(int i = 0;i\u0026lt;u+v;i++) printf(\u0026#34;%d \u0026#34;,ans[i]); printf(\u0026#34;\\n\u0026#34;); } int main(){ init(); solve(); return 0; }   ","description":"","id":131,"section":"posts","tags":["åç¼€æ•°ç»„","å­—ç¬¦ä¸²"],"title":"ã€ŒBZOJ4278ã€[ONTAK2015]Tasowanie-åç¼€æ•°ç»„","uri":"https://blog.chenqiqian.com/posts/bzoj4278-tasowanie/"},{"content":"ç»™å®šä¸€ä¸ª $n$ ä¸ªç‚¹ï¼Œ$m$ æ¡è¾¹çš„æ— å‘è”é€šå›¾ï¼Œæ¯æ¡è¾¹çš„æƒå€¼å‡ä¸º $a$ã€‚\nåœ¨åŸå›¾æ‰€æœ‰æ»¡è¶³ $u$ èŠ‚ç‚¹å’Œ $v$ èŠ‚ç‚¹é—´æœ€çŸ­è·¯ä¸º $2 \\times a$ çš„ç‚¹å¯¹ $(u,v)$ é—´å»ºç«‹ä¸€æ¡æ— å‘è¾¹ï¼Œè¾¹çš„æƒå€¼å‡ä¸º $b$ã€‚\nç»™å®šä¸€ä¸ªèµ·å§‹èŠ‚ç‚¹$k$ï¼Œæ±‚åœ¨ä¸Šè¿°æ“ä½œåï¼Œ$k$åˆ°æ‰€æœ‰èŠ‚ç‚¹çš„æœ€çŸ­è·¯å¾„ã€‚\né“¾æ¥ Luogu P3547\né¢˜è§£ ç¬¬ä¸€éå†™è§‰å¾—æ˜¯sbé¢˜ï¼Œç¬¬äºŒéè§‰å¾—æ˜¯ç¥é¢˜oooorz\nå¯ä»¥å‘ç°ï¼Œä¸€å…±æœ‰ä¸‰ç§ä»kç‚¹åˆ°è¾¾å…¶ä»–ç‚¹çš„æ–¹å¼ï¼š\n å…¨èµ° $a$ è¾¹ èµ° $0/1$ æ¡è¾¹çš„ $a$ ï¼Œå‰©ä¸‹æ²¿æœ€çŸ­è·¯èµ° $b$ å…¨èµ° $b$ è¾¹ï¼ˆå¯èƒ½ç»•è¿œï¼‰  ç¬¬ä¸€ç§å’Œç¬¬äºŒç§æƒ…å†µå¯ä»¥ä¸€é $bfs$ è§£å†³ï¼Œè¿™ä¹Ÿå°±æ˜¯æˆ‘æ‰€æƒ³åˆ°çš„äº†ã€‚\nç„¶åäº¤ä¸Šå»ï¼Œ $WA$ ã€‚\nç¬¬ä¸‰ç§æƒ…å†µå¦‚æœç›´æ¥ä¸¤æ¬¡å¾€å¤–æ‰©å±•å»ºè¾¹ï¼Œé‚£ä¹ˆå¤æ‚åº¦æ˜¯ $O(m^2)$ ã€‚\nè¿™ä¸ªæ—¶å€™æˆ‘ä»¬æœ‰ä¸€ä¸ªå¾®å°çš„ä¼˜åŒ–ï¼Œå°±æ˜¯å»ºä¸¤ä»½çš„å›¾ï¼Œåˆ†åˆ«ç”¨ä½œä»ä¸€ä¸ªç‚¹ç¬¬ä¸€æ¬¡å’Œç¬¬äºŒæ¬¡æ‰©å±•çš„ç”¨çš„è¾¹ã€‚\næ¯æ¬¡æˆ‘ä»¬ä¸¤æ¬¡æ‰©å±•ï¼Œéƒ½æŠŠæ‰€æœ‰åˆæ³•çš„ç¬¬äºŒæ¬¡æ‰©å±•çš„è¾¹åˆ æ‰ï¼Œç†ç”±æ˜¯éå¸¸æ˜¾ç„¶çš„ï¼Œå› ä¸ºæˆ‘ä»¬å·²ç»è®¿é—®åˆ°äº†è¿™ä¸ªèŠ‚ç‚¹ï¼Œæ ¹æ®bfsçš„æ€§è´¨ï¼Œæ‰€æœ‰è¿™ä¸ªèŠ‚ç‚¹åœ¨ç¬¬äºŒå¼ å›¾çš„å…¥è¾¹éƒ½ä¸éœ€è¦äº†ï¼Œæ‰€ä»¥å°±å¯ä»¥åˆ æ‰ã€‚\nç„¶åå¤æ‚åº¦æ˜¯ $O(m \\sqrt{m})$ ã€‚\nå…·ä½“è¯æ˜å¦‚ä¸‹ï¼š\né¦–å…ˆï¼Œæ—¶é—´å¤æ‚åº¦çº¦ç­‰äºéå†çš„è¾¹çš„æ•°é‡ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦è€ƒè™‘é‚£äº›éå†äº†å´æ²¡è¢«åˆ æ‰çš„è¾¹çš„æ•°é‡ã€‚\nå¯¹äºæ¯ä¸€ä¸ªèŠ‚ç‚¹ $x$ ï¼Œç”±ä»–å¼€å§‹åªä¼šè¿›è¡Œä¸€æ¬¡éå†å†äºŒæ¬¡éå†ä¸­ï¼Œæ²¡è¢«åˆ æ‰çš„è¾¹åªæœ‰ä¸€ç§ï¼Œå°±æ˜¯åœ¨äºŒæ¬¡éå†ä¸­éå†åˆ°äº†ä¸€ä¸ªä»ç„¶ä¸ $x$ è·ç¦»ä¸º $1$ çš„ç‚¹ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªä¸‰å…ƒç¯ã€‚\næ‰€ä»¥å¯¹äºè¿™ä¸ªèŠ‚ç‚¹ $x$ ï¼Œå‡è®¾å’Œä»–è·ç¦»ä¸º $1$ çš„ç‚¹æœ‰ $k$ ä¸ªï¼ˆä¹Ÿå°±æ˜¯è¿™ä¸ªèŠ‚ç‚¹çš„åº¦æ•°ï¼‰ï¼Œé‚£ä¹ˆå¯¹äºæ¯ä¸€æ¬¡äºŒæ¬¡éå†ï¼Œé‚£ä¹ˆæœ€å¤šæœ‰ $k^2$ æ¡è¾¹éå†è¿‡ä½†æ²¡æœ‰è¢«åˆ æ‰ï¼Œåªæœ‰è¿™äº›è¾¹æœ‰å¯èƒ½åœ¨æ¥ä¸‹æ¥çš„éå†ä¸­è¢«å†æ¬¡éå†ï¼Œåˆå› ä¸ºç¬¬ä¸€æ¬¡éå†çš„è¾¹æ€»å…±æ˜¯ $m$ æ¡ï¼Œæ‰€ä»¥æ€»æ—¶é—´å¤æ‚åº¦å°±æ˜¯å®ƒä»¬çš„ç›¸ä¹˜ã€‚\n$$\n\\sum_{v \\in V} \\min(deg(v)^2,m) \\leq \\sum_{v \\in V} \\sqrt{deg(v)^2 \\cdot m} = \\sqrt {m} \\sum_{v \\in V} deg(v) = O(m \\sqrt{m})\n$$\nå‚è€ƒï¼š\nCSDN\nè¿™ä¸ªé¢˜å‘Šè¯‰æˆ‘ä»¬ï¼šé€‚å½“åˆ è¾¹å¯èƒ½é™ä½ä¸€äº›å¤æ‚åº¦ã€‚\norzå‡ºé¢˜äºº\u0026hellip;\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;queue\u0026gt;#include \u0026lt;cstring\u0026gt;#include \u0026lt;algorithm\u0026gt;using namespace std; const int MAXN = 210000,MAXM = 210000; struct Graph{ int to[MAXM],nex[MAXM],pre[MAXM]; int fir[MAXN];int ecnt; Graph(){ ecnt = 1; } void addedge(int u,int v){ int e = ecnt; pre[fir[u]] = e; to[e] = v,nex[e] = fir[u],pre[e] = 0; fir[u] = e; ecnt++; } void deledge(int x,int e){ int n = nex[e],p = pre[e]; if(!p) fir[x] = n; nex[p] = n,pre[n] = p; } }A,B; int n,m,k,a,b; long long ans[MAXN]; long long dis[MAXN]; queue\u0026lt;int\u0026gt; q; void init(){ scanf(\u0026#34;%d %d %d %d %d\u0026#34;,\u0026amp;n,\u0026amp;m,\u0026amp;k,\u0026amp;a,\u0026amp;b); int u,v; for(int i = 1;i\u0026lt;=m;i++){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;u,\u0026amp;v); A.addedge(u,v),A.addedge(v,u); B.addedge(u,v),B.addedge(v,u); } } void bfs1(){ while(!q.empty()) q.pop(); for(int i = 1;i\u0026lt;=n;i++) dis[i] = 1000000; dis[k] = 0;q.push(k); while(!q.empty()){ int nown = q.front();q.pop(); for(int nowe = A.fir[nown];nowe;nowe = A.nex[nowe]){ int v = A.to[nowe]; if(dis[v] \u0026gt; dis[nown] + 1){ dis[v] = dis[nown] + 1; q.push(v); } } } for(int i = 1;i\u0026lt;=n;i++) ans[i] = min(dis[i] * a,(dis[i]/2) * b + (dis[i]%2) * a); } void bfs2(){ static bool vis[MAXN]; while(!q.empty()) q.pop(); for(int i = 1;i\u0026lt;=n;i++) dis[i] = 1000000; dis[k] = 0;q.push(k); while(!q.empty()){ int nown = q.front();q.pop(); vis[nown] = 1; for(int e1 = A.fir[nown];e1;e1 = A.nex[e1]){ int v1 = A.to[e1]; vis[v1] = 1; } for(int e1 = A.fir[nown];e1;e1 = A.nex[e1]){ int v1 = A.to[e1]; for(int e2 = B.fir[v1];e2;e2 = B.nex[e2]){ int v2 = B.to[e2]; if(!vis[v2]){ // printf(\u0026#34;\tv2:%d\\n\u0026#34;,v2);  if(dis[v2] \u0026gt; dis[nown] + 1){ dis[v2] = dis[nown] + 1; q.push(v2); } B.deledge(v1,e2); } } } for(int e1 = A.fir[nown];e1;e1 = A.nex[e1]){ int v1 = A.to[e1]; vis[v1] = 0; } vis[nown] = 0; } for(int i = 1;i\u0026lt;=n;i++) ans[i] = min(ans[i],dis[i] * b); } void solve(){ memset(ans,0x3f,sizeof(ans)); bfs1(); bfs2(); for(int i = 1;i\u0026lt;=n;i++){ printf(\u0026#34;%lld\\n\u0026#34;,ans[i]); } } int main(){ init(); solve(); return 0; }   ","description":"","id":132,"section":"posts","tags":["å›¾è®º","æœ€çŸ­è·¯"],"title":"ã€ŒPOI2013ã€Price List-å›¾è®º","uri":"https://blog.chenqiqian.com/posts/poi2013-price-list/"},{"content":"ä¸€ä¸ªä¸²æ˜¯æœ‰é™ä¸ªå°å†™å­—ç¬¦çš„åºåˆ—,ç‰¹åˆ«çš„,ä¸€ä¸ªç©ºåºåˆ—ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªä¸². ä¸€ä¸ªä¸² $P$ æ˜¯ä¸² $A$ çš„å‰ç¼€, å½“ä¸”ä»…å½“å­˜åœ¨ä¸² $B$ , ä½¿å¾— $A = PB$. å¦‚æœ $P \\neq A$ å¹¶ä¸” $P$ ä¸æ˜¯ä¸€ä¸ªç©ºä¸²,é‚£ä¹ˆæˆ‘ä»¬è¯´ $P$ æ˜¯ $A$ çš„ä¸€ä¸ª $proper$ å‰ç¼€. å®šä¹‰ $Q$ æ˜¯ $A$ çš„å‘¨æœŸ, å½“ä¸”ä»…å½“ $Q$ æ˜¯ $A$ çš„ä¸€ä¸ª $proper$ å‰ç¼€å¹¶ä¸” $A$ æ˜¯ $QQ$ çš„å‰ç¼€(ä¸ä¸€å®šè¦æ˜¯ $proper$ å‰ç¼€).\næ¯”å¦‚ä¸² $abab$ å’Œ $ababab$ éƒ½æ˜¯ä¸² $abababa$ çš„å‘¨æœŸ. ä¸² $A$ çš„æœ€å¤§å‘¨æœŸå°±æ˜¯å®ƒæœ€é•¿çš„ä¸€ä¸ªå‘¨æœŸæˆ–è€…æ˜¯ä¸€ä¸ªç©ºä¸²(å½“ $A$ æ²¡æœ‰å‘¨æœŸçš„æ—¶å€™), æ¯”å¦‚è¯´, $ababab$ çš„æœ€å¤§å‘¨æœŸæ˜¯ $abab$ . ä¸² $abc$ çš„æœ€å¤§å‘¨æœŸæ˜¯ç©ºä¸². ç»™å‡ºä¸€ä¸ªä¸²,æ±‚å‡ºå®ƒæ‰€æœ‰å‰ç¼€çš„æœ€å¤§å‘¨æœŸé•¿åº¦ä¹‹å’Œ.\né“¾æ¥ Luogu P3435\né¢˜è§£ åˆ†æä¸€ä¸‹ï¼Œå¯ä»¥å‘ç°æˆ‘ä»¬è¦æ±‚çš„æ˜¯æ‰€æœ‰å‰ç¼€çš„æœ€çŸ­çš„ç›¸åŒçš„å‰åç¼€ï¼Œä¸”è¿˜æœ‰é•¿åº¦çš„é™åˆ¶ï¼Œä¸èƒ½è¶…è¿‡å­—ç¬¦ä¸²çš„ä¸€åŠã€‚\nè¿™ä¸ªå¯ä»¥è”æƒ³åˆ° $KMP$ ï¼Œæ‰€ä»¥æˆ‘ä»¬æ€è€ƒå¦‚ä½•åœ¨ $KMP$ çš„åŸºç¡€ä¸Šç»´æŠ¤è¿™ä¸ªäº‹æƒ…ã€‚å› ä¸º $KMP$ åœ¨å¾€å›è·³çš„è¯ï¼Œæ˜¯å¯ä»¥æ‰¾åˆ°æ‰€æœ‰çš„ç›¸åŒçš„å‰åç¼€çš„ã€‚æ‰€ä»¥ç»™å®šä¸€ä¸ªå‰ç¼€ï¼Œå®ƒæ²¿ $nex$ æ•°ç»„çš„è½¬ç§»æ˜¯ç¡®å®šçš„ï¼Œæˆ‘ä»¬ä¹Ÿå°±å¯ä»¥ç»´æŠ¤ä¸€ä¸ª $near[i]$ ï¼Œå°±æ˜¯æœ€è¿‘èƒ½å¤Ÿè·³åˆ°çš„é•¿åº¦ï¼Œä¹Ÿå°±æ˜¯ç›¸åŒçš„å‰åç¼€æœ€çŸ­å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥ $O(1)$ çš„æ ¹æ® $nex$ æ•°ç»„è®¡ç®—è¿™ä¸ª $near$ æ•°ç»„ï¼Œç„¶åå¾—åˆ°æœ€åçš„ç­”æ¡ˆã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43  #include \u0026lt;cstdio\u0026gt;using namespace std; const int MAXN = 1100000; char s[MAXN]; int n,nex[MAXN],near[MAXN]; void solve(){ int j;j = nex[0] = 0; for(int i = 1;i\u0026lt;n;i++){ while(j \u0026gt; 0 \u0026amp;\u0026amp; s[i] != s[j]) j = nex[j-1]; if(s[i]==s[j]) j++; nex[i] = j; } j = 0; long long ans = 0; near[0] = 0; for(int i = 1;i\u0026lt;n;i++){ int w = nex[i] - 1; if(w \u0026gt;= 0) near[i] = near[w] == -1?w:near[w]; else near[i] = -1; j = near[i]+1; if(j \u0026gt; 0 \u0026amp;\u0026amp; j \u0026lt;= (i+1)/2) ans += (i+1)-j; // printf(\u0026#34;i:%d j:%d\\n\u0026#34;,i,j);  } printf(\u0026#34;%lld\\n\u0026#34;,ans); } void init(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n); scanf(\u0026#34;%s\u0026#34;,s); } int main(){ init(); solve(); return 0; }   ","description":"","id":133,"section":"posts","tags":["å­—ç¬¦ä¸²","KMP"],"title":"ã€ŒPOI2006ã€Periods of Words-KMP","uri":"https://blog.chenqiqian.com/posts/poi2006-okr/"},{"content":"å¯è¯»ç‰ˆé¢˜æ„ï¼š\nç»™å®š $n$ ä¸ªä»…åŒ…å«å¤§å†™å­—æ¯çš„æ¨¡æ¿ä¸²ï¼Œæ±‚æ‰€æœ‰çš„é•¿åº¦ä¸º $M$ ä¸”ä»…åŒ…å«å¤§å†™å­—æ¯çš„ä¸åŒå­—ç¬¦ä¸²ä¸­ï¼Œæœ‰å¤šå°‘ä¸ªåŒ…å«è‡³å°‘ä¸€ä¸ªæ¨¡æ¿ä¸²ã€‚ç­”æ¡ˆå¯¹ $10007$ å–æ¨¡ã€‚\nåŸé¢˜æ„ï¼š\n$JSOI$ äº¤ç»™é˜Ÿå‘˜ ZYX ä¸€ä¸ªä»»åŠ¡ï¼Œç¼–åˆ¶ä¸€ä¸ªç§°ä¹‹ä¸ºâ€œæ–‡æœ¬ç”Ÿæˆå™¨â€çš„ç”µè„‘è½¯ä»¶ï¼šè¯¥è½¯ä»¶çš„ä½¿ç”¨è€…æ˜¯ä¸€äº›ä½å¹¼äººç¾¤ï¼Œä»–ä»¬ç°åœ¨ä½¿ç”¨çš„æ˜¯$GW$æ–‡æœ¬ç”Ÿæˆå™¨ $v6$ ç‰ˆã€‚\nè¯¥è½¯ä»¶å¯ä»¥éšæœºç”Ÿæˆä¸€äº›æ–‡ç« â€•â€•æ€»æ˜¯ç”Ÿæˆä¸€ç¯‡é•¿åº¦å›ºå®šä¸”å®Œå…¨éšæœºçš„æ–‡ç« ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç”Ÿæˆçš„æ–‡ç« ä¸­æ¯ä¸ªå­—èŠ‚éƒ½æ˜¯å®Œå…¨éšæœºçš„ã€‚å¦‚æœä¸€ç¯‡æ–‡ç« ä¸­è‡³å°‘åŒ…å«ä½¿ç”¨è€…ä»¬äº†è§£çš„ä¸€ä¸ªå•è¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¯´è¿™ç¯‡æ–‡ç« æ˜¯å¯è¯»çš„ï¼ˆæˆ‘ä»¬ç§°æ–‡ç«  $a$ åŒ…å«å•è¯ $b$ ï¼Œå½“ä¸”ä»…å½“å•è¯ $b$ æ˜¯æ–‡ç«  $a$ çš„å­ä¸²ï¼‰ã€‚ä½†æ˜¯ï¼Œå³ä½¿æŒ‰ç…§è¿™æ ·çš„æ ‡å‡†ï¼Œä½¿ç”¨è€…ç°åœ¨ä½¿ç”¨çš„ $GW$ æ–‡æœ¬ç”Ÿæˆå™¨ $v6$ ç‰ˆæ‰€ç”Ÿæˆçš„æ–‡ç« ä¹Ÿæ˜¯å‡ ä¹å®Œå…¨ä¸å¯è¯»çš„ã€‚ $ZYX$ éœ€è¦æŒ‡å‡º $GW$ æ–‡æœ¬ç”Ÿæˆå™¨ $v6$ ç”Ÿæˆçš„æ‰€æœ‰æ–‡æœ¬ä¸­å¯è¯»æ–‡æœ¬çš„æ•°é‡ï¼Œä»¥ä¾¿èƒ½å¤ŸæˆåŠŸè·å¾— $v7$ æ›´æ–°ç‰ˆã€‚ä½ èƒ½å¸®åŠ©å—ï¼Ÿ\né“¾æ¥ Luogu P4052\né¢˜è§£ æ­£éš¾åˆ™åã€‚ä¸å¦‚æˆ‘ä»¬è€ƒè™‘æ‰€æœ‰é•¿åº¦ä¸º $M$ çš„å­—ç¬¦ä¸²ï¼Œä¸€ä¸ªæ¨¡ç‰ˆä¸²éƒ½ä¸å‡ºç°çš„æƒ…å†µæ•°ã€‚\nç¥ä¼¼ GTè€ƒè¯• å•Šï¼Œåªä¸è¿‡æ¨¡ç‰ˆä»ä¸€ä¸ªå˜æˆäº†å¤šä¸ªï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ç”¨ACè‡ªåŠ¨æœºä»£æ›¿KMPã€‚\nçŠ¶æ€ï¼š$dp[i][j]$ è¡¨ç¤ºåœ¨ $AC$ è‡ªåŠ¨æœºçš„ç¬¬ $i$ ä¸ªèŠ‚ç‚¹ä¸Šï¼Œè¿˜æœ‰$j$ä½çš„ç¬¦åˆæ¡ä»¶çš„å­ä¸²æ•°é‡ã€‚\nå…ˆå»ºç«‹ $AC$ è‡ªåŠ¨æœºï¼Œè¡¥å…¨ $Trie$ å›¾ã€‚\nç„¶åå°†æ‰€æœ‰ä¸æ˜¯ $end$ èŠ‚ç‚¹ä¸” $fail$ æŒ‡é’ˆä¸€è·¯æŒ‡å‘çš„æ²¡æœ‰$end$èŠ‚ç‚¹çš„ç‚¹çš„ $dp[i][0]$ è®¾ä¸º $1$ ã€‚\nç„¶åå°†26ç§æƒ…å†µè½¬ç§»å³å¯ã€‚æ³¨æ„è¿™é‡Œä¹Ÿä¸è¦è½¬ç§»ä¸Šé¢çš„ $dp[i][0] = 0$ çš„èŠ‚ç‚¹ï¼Œæ¥æ–¹ä¾¿æˆ‘ä»¬çš„å¤„ç†ï¼Œä¸ç”¨ç‰¹åˆ¤ã€‚\næœ€åç­”æ¡ˆæ˜¯ $dp[root][M]$ ã€‚\nè¿™é‡Œæ¯”è¾ƒæœ‰è¶£ï¼Œæˆ‘æƒ³äº†æƒ³èƒ½ä¸èƒ½ç”¨çŸ©é˜µå¿«é€Ÿå¹‚ã€‚ä½†æ˜¯ï¼Œè¿™ä¸ªåœ°æ–¹çš„è½¬ç§»\u0008çŸ©é˜µæœ€å¤§æœ‰å¯èƒ½\u0008åˆ° $10000\\times 10000$ ï¼Œä¼šå‡‰å‡‰233ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cstring\u0026gt;#include \u0026lt;queue\u0026gt;#define ll long long #define mod 10007 #define sigma_size 26 using namespace std; const int MAXN = 7000,MAXM = 110; struct AC_automaton{ int c[MAXN][sigma_size],f[MAXN],end[MAXN]; int root,cnt; AC_automaton(){ root = cnt = 0; } void insert(char *str){ int n = strlen(str),nown = root; for(int i = 0;i\u0026lt;n;i++){ if(!c[nown][str[i]-\u0026#39;A\u0026#39;]) c[nown][str[i]-\u0026#39;A\u0026#39;] = ++cnt; nown = c[nown][str[i]-\u0026#39;A\u0026#39;];; } end[nown] |= 1; } void get_fail(){ queue\u0026lt;int\u0026gt; q; while(!q.empty()) q.pop(); for(int i = 0;i\u0026lt;sigma_size;i++){ if(c[root][i]){ f[c[root][i]] = root; q.push(c[root][i]); } } while(!q.empty()){ int nown = q.front();q.pop(); for(int i = 0;i\u0026lt;sigma_size;i++){ if(c[nown][i]){ f[c[nown][i]] = c[f[nown]][i]; end[c[nown][i]] |= end[f[c[nown][i]]]; q.push(c[nown][i]); } else c[nown][i] = c[f[nown]][i]; } } } }; AC_automaton AC; int n,m; char ch[MAXN]; void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m); for(int i = 1;i\u0026lt;=n;i++){ scanf(\u0026#34;%s\u0026#34;,ch); AC.insert(ch); } AC.get_fail(); } void solve(){ static ll dp[MAXN][MAXM]; for(int i = 0;i\u0026lt;=AC.cnt;i++) if(!AC.end[i]) dp[i][0] = 1; for(int j = 1;j\u0026lt;=m;j++){ for(int i = 0;i\u0026lt;=AC.cnt;i++){ if(!AC.end[i]){ for(int k = 0;k\u0026lt;sigma_size;k++) dp[i][j] += dp[AC.c[i][k]][j-1]; dp[i][j] %= mod; } } } int ans = 1; for(int i = 1;i\u0026lt;=m;i++){ ans *= sigma_size; ans %= mod; } printf(\u0026#34;%lld\\n\u0026#34;,(ans-dp[0][m]+mod)%mod); } int main(){ init(); solve(); return 0; }   ","description":"","id":134,"section":"posts","tags":["å­—ç¬¦ä¸²","ACè‡ªåŠ¨æœº","åŠ¨æ€è§„åˆ’"],"title":"ã€ŒJSOI2007ã€æ–‡æœ¬ç”Ÿæˆå™¨-ACè‡ªåŠ¨æœº+dp","uri":"https://blog.chenqiqian.com/posts/jsoi2007-generator/"},{"content":"å¯¹äºä¸€ä¸ª $0/1$ å­—ç¬¦ä¸²ï¼Œå¦‚æœå°†è¿™ä¸ªå­—ç¬¦ä¸² $0$ å’Œ $1$ å–ååï¼Œå†å°†æ•´ä¸ªä¸²åè¿‡æ¥å’ŒåŸä¸²ä¸€æ ·ï¼Œå°±ç§°ä½œâ€œåå¯¹ç§°â€å­—ç¬¦ä¸²ã€‚æ¯”å¦‚ $00001111$ å’Œ $010101$ å°±æ˜¯åå¯¹ç§°çš„ï¼Œ $1001$ å°±ä¸æ˜¯ã€‚\nç°åœ¨ç»™å‡ºä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„ $0/1$ å­—ç¬¦ä¸²ï¼Œæ±‚å®ƒæœ‰å¤šå°‘ä¸ªå­ä¸²æ˜¯åå¯¹ç§°çš„ã€‚\né“¾æ¥ LOJ 2452\nLuogu P3501\né¢˜è§£ æœ¬é¢˜æ˜¯èƒ¡æè¿‡å»çš„\u0026hellip;æ­£è§£å¥½åƒæ˜¯å›æ–‡è‡ªåŠ¨æœº\u0026hellip;åç¼€æ•°ç»„å¤æ‚åº¦å¤šä¸€ä¸ª $\\log$ \u0026hellip;ç„¶åå°±è¢«å¡çš„æ­»æ­»çš„emmmæœ€å LOJ 1000ms æé™æ“ä½œ233\næ³¨æ„åˆ°\u0026hellip;ä¸€ä¸ªä¸²å¦‚æœæƒ³æ˜¯åå¯¹ç§°çš„ï¼Œé¦–å…ˆè¦æ˜¯å¶æ•°é•¿åº¦ã€‚è€Œä¸”ä»ä¸­é—´åŠˆå¼€å¾€ä¸¤è¾¹çœ‹æ¯ä¸ªå¯¹åº”ä½ç½®éƒ½ç›¸åã€‚\næ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŠŠ è¿™ä¸ªä¸²+åˆ†éš”ç¬¦+è¿™ä¸ªä¸²çš„åå‘\u0026amp;å–å æä¸€ä¸ªåç¼€æ•°ç»„å‡ºæ¥ï¼Œç„¶åæšä¸¾ä¸­é—´ç‚¹ï¼Œåœ¨å‰åä¸²å¯¹åº”ä½ç½®å– LCP å°±æ˜¯å¯èƒ½çš„å¤§å°ï¼Œç„¶åæ±‚å’Œå³å¯ã€‚\nå¦‚æœåç¼€æ•°ç»„å’ŒSTè¡¨çš„åˆå§‹åŒ–å¤æ‚åº¦æ˜¯ $O(n \\log n)$ ï¼Œæœ€å $n$ æ¬¡æŸ¥è¯¢æ¯æ¬¡å¤æ‚åº¦éƒ½æ˜¯ $O(n)$ ã€‚\næ—¶é—´å¤æ‚åº¦æ˜¯ $O(n \\log {n})$ ï¼Œæ¯”æ­£è§£å¤šä¸€ä¸ª $\\log$ å‹‰å¼ºå¡è¿‡233\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102  // Code By Chen Qiqian on 2018.08.10 #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cmath\u0026gt;#include \u0026lt;algorithm\u0026gt;using namespace std; inline int min(int a,int b){return a\u0026gt;b?b:a;} int n,m; const int MAXN = 1000100,logn = 20; namespace SA{ int s[MAXN],sa[MAXN],rk[MAXN],x[MAXN],y[MAXN],ht[MAXN]; int cnt[MAXN]; void get_SA(int n,int m){ for(int i = 0;i\u0026lt;m;i++) cnt[i] = 0; for(int i = 0;i\u0026lt;n;i++) cnt[s[i]]++; for(int i = 1;i\u0026lt;m;i++) cnt[i] += cnt[i-1]; for(int i = n-1;~i;--i) sa[--cnt[s[i]]] = i; m = rk[sa[0]] = 0; for(int i = 1;i\u0026lt;n;i++) rk[sa[i]] = (s[sa[i]]!=s[sa[i-1]])?++m:m; for(int j = 1;;j\u0026lt;\u0026lt;=1){ if(++m == n) break; for(int i = 0;i\u0026lt;j;i++) y[i] = n-j+i; for(int i = 0,k = j;i\u0026lt;n;i++) if(sa[i]\u0026gt;=j) y[k++] = sa[i]-j; for(int i = 0;i\u0026lt;n;i++) x[i] = rk[y[i]]; for(int i = 0;i\u0026lt;m;i++) cnt[i] = 0; for(int i = 0;i\u0026lt;n;i++) cnt[x[i]]++; for(int i = 1;i\u0026lt;m;i++) cnt[i] += cnt[i-1]; for(int i = n-1;~i;--i) sa[--cnt[x[i]]] = y[i],y[i] = rk[i]; m = rk[sa[0]] = 0; for(int i = 1;i\u0026lt;n;i++) rk[sa[i]] = (y[sa[i]]!=y[sa[i-1]] || y[sa[i]+j]!=y[sa[i-1]+j])?++m:m; } } void getheight(int n){ for(int i = 0, h = ht[0] = 0;i\u0026lt;n;i++){ int j = sa[rk[i]-1]; while(i+h\u0026lt;n\u0026amp;\u0026amp;j+h\u0026lt;n\u0026amp;\u0026amp;s[i+h]==s[j+h]) h++; if(ht[rk[i]] = h) --h; } } void build(int n){ ++n; get_SA(n,4); getheight(n); } } int _log[MAXN]; namespace ST{ int minn[MAXN][logn]; void build(int n,int *num){ for(int i = 1;i\u0026lt;=n;i++) _log[i] = _log[i-1] + ((i==(1\u0026lt;\u0026lt;(_log[i-1]+1)))?1:0); int l = _log[n]; for(int i = 0;i\u0026lt;=n;i++) minn[i][0] = num[i]; for(int j = 1;j\u0026lt;=l;j++){ for(int i = 0;i+(1\u0026lt;\u0026lt;(j-1))\u0026lt;=n;i++){ minn[i][j] = min(minn[i][j-1],minn[i+(1\u0026lt;\u0026lt;(j-1))][j-1]); } } } int query(int l,int r){ int t = _log[r-l+1]; return min(minn[l][t],minn[r-(1\u0026lt;\u0026lt;t)+1][t]); } } int lcp(int x,int y){ if(x == y) return n-x+1; x = SA::rk[x],y = SA::rk[y]; if(x \u0026gt; y) swap(x,y); return ST::query(x+1,y); } char s[MAXN]; void init(){ scanf(\u0026#34;%d\\n\u0026#34;,\u0026amp;m); fread(s,MAXN,1,stdin); for(int i = 0;i\u0026lt;m;i++) SA::s[n++] = s[i] - (\u0026#39;0\u0026#39;-1); reverse(s,s+n); SA::s[n++] = 3; for(int i = 0;i\u0026lt;m;i++) SA::s[n++] = (s[i]^1) - (\u0026#39;0\u0026#39;-1); SA::s[n] = 0; SA::build(n); ST::build(n+1,SA::ht); } void solve(){ long long ans = 0; for(int i = 0;i\u0026lt;m;i++){ ans += lcp(i+1,n-i-1); } printf(\u0026#34;%lld\\n\u0026#34;,ans); } int main(){ init(); solve(); return 0; }   ","description":"","id":135,"section":"posts","tags":["å­—ç¬¦ä¸²","åç¼€æ•°ç»„"],"title":"ã€ŒPOI2010ã€Antisymmetry-åç¼€æ•°ç»„","uri":"https://blog.chenqiqian.com/posts/poi2010-antisymmetry/"},{"content":"å¯è¯»ç‰ˆé¢˜æ„ï¼š\nç»™å®š $n$ ä¸ªå­—ç¬¦ä¸²ï¼Œç¬¬ $i$ ä¸ªå­—ç¬¦ä¸²çš„é•¿åº¦ä¸º $M_i$ ï¼Œæ±‚æ¯ä¸ªå­—ç¬¦ä¸²åœ¨æ‰€æœ‰å­—ç¬¦ä¸²ä¸­å‡ºç°çš„æ¬¡æ•°ã€‚\næ•°æ®èŒƒå›´ï¼š$n \\leq 100,\\ M = \\sum M_i \\leq 10^6$.\nåŸé¢˜é¢ï¼š\nå°å¼ æœ€è¿‘åœ¨å¿™æ¯•è®¾,æ‰€ä»¥ä¸€ç›´åœ¨è¯»è®ºæ–‡ã€‚ä¸€ç¯‡è®ºæ–‡æ˜¯ç”±è®¸å¤šå•è¯ç»„æˆä½†å°å¼ å‘ç°ä¸€ä¸ªå•è¯ä¼šåœ¨è®ºæ–‡ä¸­å‡ºç°å¾ˆå¤šæ¬¡,ä»–æƒ³çŸ¥é“æ¯ä¸ªå•è¯åˆ†åˆ«åœ¨è®ºæ–‡ä¸­å‡ºç°äº†å¤šå°‘æ¬¡ã€‚\né“¾æ¥ Luogu P3966\né¢˜è§£ é¦–å…ˆæˆ‘ä»¬åŠ ä¸åŒçš„åˆ†éš”ç¬¦ï¼Œå°†æ‰€æœ‰å­—ç¬¦ä¸²æ‹¼æˆä¸€ä¸ªæ•´ä¸²ã€‚\næ³¨æ„åˆ°è¿™ä¸ªé—®é¢˜ï¼Œå…¶å®å¯ä»¥è½¬åŒ–ä¸º\u0008\u0008è‹¥å¹²ä¸ªå­ä¸²åœ¨æ¯ä¸²ä¸­çš„å‡ºç°æ¬¡æ•°ã€‚\n\u0008å¥—è·¯é¢˜å§\u0026hellip;æ‰¾åˆ°è¿™ä¸ªå­ä¸²å‡ºç°ä½ç½®çš„åç¼€åœ¨ $ht$ æ•°ç»„é‡Œé¢çš„ä½ç½®ï¼Œå¾€ä¸¤ä¾§å»¶ä¼¸ï¼ˆè¿™ä¸ªåœ°æ–¹äºŒåˆ†ç­”æ¡ˆï¼‰ï¼Œçœ‹æœ€å¤šçš„ $ht \\geq len$ çš„èŒƒå›´ï¼Œè¿™ä¸ªåŒºé—´é‡Œé¢çš„æ‰€æœ‰ä¸²éƒ½æ˜¯å‡ºç°çš„ä½ç½®ã€‚ç„¶åè®¡ç®—ä¸€ä¸‹é•¿åº¦\u0008å°±å¯ä»¥å¾—åˆ°ç­”æ¡ˆã€‚\næ—¶é—´å¤æ‚åº¦ $O(M \\log {M} + n \\log{M})$ ã€‚\n\u0008å¼€å§‹å†™äº†ä¸€ä¸ª $O(NM)$ çš„æš´åŠ›\u0008æ­»æ´»è¿‡ä¸å»ï¼Œè¿˜ä»¥ä¸ºè‡ªå·±å¸¸æ•°\u0008å¤§\u0026hellip;233\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;algorithm\u0026gt;#include \u0026lt;cstring\u0026gt;#include \u0026lt;unistd.h\u0026gt;#include \u0026lt;cctype\u0026gt;#include \u0026lt;cmath\u0026gt;using namespace std; const int MAXN = 1001000,logn = 21,MAXM = 300; namespace SA{ int s[MAXN],sa[MAXN],rk[MAXN],x[MAXN],y[MAXN],ht[MAXN]; int cnt[MAXN]; void get_SA(int n,int m){ for(int i = 0;i\u0026lt;m;i++) cnt[i] = 0; for(int i = 0;i\u0026lt;n;i++) cnt[s[i]]++; for(int i = 1;i\u0026lt;m;i++) cnt[i] += cnt[i-1]; for(int i = n-1;~i;--i) sa[--cnt[s[i]]] = i; m = rk[sa[0]] = 0; for(int i = 1;i\u0026lt;n;i++) rk[sa[i]] = s[sa[i]] != s[sa[i-1]]?++m:m; for(int j = 1;;j\u0026lt;\u0026lt;=1){ if(++m == n) break; for(int i = 0;i\u0026lt;j;i++) y[i] = n-j+i; for(int i = 0,k = j;i\u0026lt;n;i++) if(sa[i] \u0026gt;= j) y[k++] = sa[i]-j; for(int i = 0;i\u0026lt;n;i++) x[i] = rk[y[i]]; for(int i = 0;i\u0026lt;m;i++) cnt[i] = 0; for(int i = 0;i\u0026lt;n;i++) cnt[x[i]]++; for(int i = 1;i\u0026lt;m;i++) cnt[i] += cnt[i-1]; for(int i = n-1;~i;--i) sa[--cnt[x[i]]] = y[i],y[i] = rk[i]; m = rk[sa[0]] = 0; for(int i = 1;i\u0026lt;n;i++) rk[sa[i]] = (y[sa[i]]!=y[sa[i-1]] || y[sa[i]+j]!=y[sa[i-1]+j])?++m:m; } } void getheight(int n){ for(int i = 0,h = ht[0] = 0;i\u0026lt;n;i++){ int j = sa[rk[i]-1]; while(i+h\u0026lt;n\u0026amp;\u0026amp;j+h\u0026lt;n\u0026amp;\u0026amp;s[i+h]==s[j+h]) ++h; if(ht[rk[i]] = h) --h; } } template \u0026lt;typename T\u0026gt; void build(int n,const T *str){ int m = 128+200;++n; for(int i = 0;i\u0026lt;n;i++) s[i] = str[i]; get_SA(n,m); getheight(n); } } namespace ST{ int minn[MAXN][logn]; void build(int n,int *num){ int l = log2(n); for(int i = 0;i\u0026lt;=n;i++) minn[i][0] = num[i]; for(int j = 1;j\u0026lt;=l;j++){ for(int i = 0;i+(1\u0026lt;\u0026lt;(j-1))\u0026lt;=n;i++){ minn[i][j] = min(minn[i+(1\u0026lt;\u0026lt;(j-1))][j-1],minn[i][j-1]); } } } int query(int l,int r){ int t = log2(r-l+1); return min(minn[l][t],minn[r-(1\u0026lt;\u0026lt;t)+1][t]); } } int n,m; int query(int p,int len){ p = SA::rk[p]; int l,r,b = 0,e = p; while(b!=e){ int mid = (b+e)\u0026gt;\u0026gt;1; if(ST::query(mid+1,p)\u0026lt;len) b = mid+1; else e = mid; } l = b; b = p+1,e = n; while(b!=e){ int mid = (b+e)\u0026gt;\u0026gt;1; if(ST::query(p+1,mid)\u0026gt;=len) b = mid+1; else e = mid; } r = b; return r-l; } int ans[MAXM]; int b[MAXM],len[MAXM]; int s[MAXN];char t[MAXN]; void init(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;m); for(int i = 1;i\u0026lt;=m;i++){ scanf(\u0026#34;%s\u0026#34;,t); len[i] = strlen(t),b[i] = n; for(int j = 0;j\u0026lt;len[i];j++) s[n++] = t[j]; s[n++] = 127+i; } s[n] = \u0026#39;a\u0026#39; - 1; SA::build(n,s); ST::build(n+1,SA::ht); } void solve(){ for(int i = 1;i\u0026lt;=m;i++){ printf(\u0026#34;%d\\n\u0026#34;,query(b[i],len[i])); } } int main(){ init(); solve(); return 0; }   ","description":"","id":136,"section":"posts","tags":["å­—ç¬¦ä¸²","åç¼€æ•°ç»„"],"title":"ã€ŒTJOI2013ã€å•è¯-åç¼€æ•°ç»„+äºŒåˆ†","uri":"https://blog.chenqiqian.com/posts/tjoi2013-word/"},{"content":"é˜¿ç”³å‡†å¤‡æŠ¥åå‚åŠ  $GT$ è€ƒè¯•ï¼Œå‡†è€ƒè¯å·ä¸º $n$ ä½æ•° $X_1X_2\\cdots X_n(0\\le X_i\\le 9)$ï¼Œä»–ä¸å¸Œæœ›å‡†è€ƒè¯å·ä¸Šå‡ºç°ä¸å‰åˆ©çš„æ•°å­—ã€‚\nä»–çš„ä¸å‰åˆ©æ•°å­— $A_1A_2\\cdots A_m(0\\le A_i\\le 9)$ æœ‰ $m$ ä½ï¼Œä¸å‡ºç°æ˜¯æŒ‡ $X_1X_2\\cdots X_n$ ä¸­æ²¡æœ‰æ°å¥½ä¸€æ®µç­‰äº $A_1A_2\\cdots A_m$ï¼Œ$A_1$â€‹ å’Œ $X_1$ å¯ä»¥ä¸º $0$ã€‚\né˜¿ç”³æƒ³çŸ¥é“ä¸å‡ºç°ä¸å‰åˆ©æ•°å­—çš„å·ç æœ‰å¤šå°‘ç§ï¼Œè¾“å‡ºæ¨¡ $K$ å–ä½™çš„ç»“æœã€‚\né“¾æ¥ Luogu P3193\né¢˜è§£ æ˜¾ç„¶dp\u0026hellip;\nä»¤ $dp[i][j]$ ä¸ºå‡†è€ƒè¯å·²ç»åŒ¹é…äº† $i$ ä½ï¼Œä¸å‰åˆ©æ•°å­—ï¼ˆæ¨¡ç‰ˆï¼‰æœ€é•¿å¯ä»¥åŒ¹é…äº† $j$ ä½çš„æ–¹æ¡ˆæ•°ã€‚\nä¸‹ä¸€ä½æœ‰ $10$ ç§æƒ…å†µï¼Œåœ¨ $nex$ æ•°ç»„ä¸Šåˆ†åˆ«è½¬ç§»å³å¯ã€‚\næ³¨æ„åˆ° $n$ çš„å¤§å°æ¯”è¾ƒå¤§ï¼Œ $m$ çš„å¤§å°æ¯”è¾ƒå°ï¼Œå¯ä»¥ç”¨çŸ©é˜µå¿«é€Ÿå¹‚åŒ–æ‰ç¬¬ä¸€ç»´ã€‚\næ—¶é—´å¤æ‚åº¦: $O(m^3 \\times \\log{n})$\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cstring\u0026gt;using namespace std; const int MAXM = 30; int n,m,k; char s[MAXM]; int nex[MAXM]; struct Matrix{ int a[MAXM][MAXM]; Matrix(){memset(a,0,sizeof(a));} }; Matrix mul(Matrix \u0026amp;_a,Matrix \u0026amp;_b){ Matrix ans; for(int i = 0;i\u0026lt;=m;i++){ for(int j = 0;j\u0026lt;=m;j++){ for(int k = 0;k\u0026lt;=m;k++){ ans.a[i][j] += _a.a[i][k] * _b.a[k][j]; } if(ans.a[i][j] \u0026gt;= k) ans.a[i][j] %= k; } } return ans; } Matrix pow(Matrix x,int k){ Matrix ans; for(int i = 0;i\u0026lt;=m;i++) ans.a[i][i] = 1; for(int i = k;i;i\u0026gt;\u0026gt;=1,x = mul(x,x)) if(i \u0026amp; 1) ans = mul(ans,x); return ans; } void init(){ scanf(\u0026#34;%d %d %d\u0026#34;,\u0026amp;n,\u0026amp;m,\u0026amp;k); scanf(\u0026#34;%s\u0026#34;,s); } //dp[i][j]è¡¨ç¤ºå·²ç»åŒ¹é…äº†iä½ï¼Œæ¨¡ç‰ˆå·²ç»åŒ¹é…äº†jä½  void get_next(){ nex[0] = 0; int j = 0; for(int i = 1;i\u0026lt;m;i++){ while(j \u0026gt; 0 \u0026amp;\u0026amp; s[i] != s[j]) j = nex[j-1]; if(s[i] == s[j]) j++; nex[i] = j; } } void solve(){ get_next(); Matrix tmp; for(int i = 0;i\u0026lt;m;i++){ int t = i; for(int w = \u0026#39;0\u0026#39;;w\u0026lt;=\u0026#39;9\u0026#39;;w++){ t = i; while(t \u0026gt; 0 \u0026amp;\u0026amp; s[t] != w) t = nex[t-1]; if(s[t] == w) t++; tmp.a[t][i]++; } } tmp = pow(tmp,n); int ans = 0; for(int i = 0;i\u0026lt;m;i++){ ans += tmp.a[i][0]; } ans %= k; printf(\u0026#34;%d\\n\u0026#34;,ans); } int main(){ init(); solve(); return 0; }   ","description":"","id":137,"section":"posts","tags":["åŠ¨æ€è§„åˆ’","KMP","çŸ©é˜µå¿«é€Ÿå¹‚"],"title":"ã€ŒHNOI2008ã€GTè€ƒè¯•-KMP+dp+çŸ©é˜µå¿«é€Ÿå¹‚","uri":"https://blog.chenqiqian.com/posts/hnoi2008-gtexams/"},{"content":"äºŒè¿›åˆ¶ç—…æ¯’å®¡æŸ¥å§”å‘˜ä¼šæœ€è¿‘å‘ç°äº†å¦‚ä¸‹çš„è§„å¾‹ï¼šæŸäº›ç¡®å®šçš„äºŒè¿›åˆ¶ä¸²æ˜¯ç—…æ¯’çš„ä»£ç ã€‚å¦‚æœæŸæ®µä»£ç ä¸­ä¸å­˜åœ¨ä»»ä½•ä¸€æ®µç—…æ¯’ä»£ç ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ç§°è¿™æ®µä»£ç æ˜¯å®‰å…¨çš„ã€‚ç°åœ¨å§”å‘˜ä¼šå·²ç»æ‰¾å‡ºäº†æ‰€æœ‰çš„ç—…æ¯’ä»£ç æ®µï¼Œè¯•é—®ï¼Œæ˜¯å¦å­˜åœ¨ä¸€ä¸ªæ— é™é•¿çš„å®‰å…¨çš„äºŒè¿›åˆ¶ä»£ç ã€‚\né“¾æ¥ Luogu P2444\né¢˜è§£ å¯¹æ‰€æœ‰çš„æ¨¡ç‰ˆä¸²å»ºç«‹ AC è‡ªåŠ¨æœºï¼Œè¡¥å…¨ Trie å›¾ï¼Œåœ¨ Trie å›¾ä¸Šæ‰¾ç¯ã€‚\næ³¨æ„è¿™é‡Œä¸èƒ½åˆ°è¾¾å•è¯ç»“æŸçš„èŠ‚ç‚¹ï¼Œä¹Ÿä¸èƒ½åˆ°è¾¾æ‰€æœ‰ fail èŠ‚ç‚¹æ˜¯å•è¯ç»“æŸçš„ç‚¹ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cstring\u0026gt;#include \u0026lt;queue\u0026gt;using namespace std; const int MAXN = 1001000; template \u0026lt;int sigma_size\u0026gt; struct AC_automaton{ bool vis[MAXN],flag; bool instack[MAXN]; int f[MAXN],c[MAXN][sigma_size],end[MAXN]; int root,cnt; AC_automaton(){root=cnt=0;} void clear(){} //qwq  void insert(char *str){ int n = strlen(str),nown = root; for(int i = 0;i\u0026lt;n;i++){ if(!c[nown][str[i]-\u0026#39;0\u0026#39;]) c[nown][str[i]-\u0026#39;0\u0026#39;] = ++cnt; nown = c[nown][str[i]-\u0026#39;0\u0026#39;]; } end[nown] |= 1; } void get_fail(){ queue\u0026lt;int\u0026gt; q; while(!q.empty()) q.pop(); for(int i = 0;i\u0026lt;sigma_size;i++){ if(c[root][i]){ f[c[root][i]] = root; q.push(c[root][i]); } } while(!q.empty()){ int nown = q.front();q.pop(); for(int i = 0;i\u0026lt;sigma_size;i++){ if(c[nown][i]){ f[c[nown][i]] = c[f[nown]][i]; end[c[nown][i]] |= end[f[c[nown][i]]]; q.push(c[nown][i]); } else c[nown][i] = c[f[nown]][i]; } } } bool judge(){ memset(vis,0,sizeof(vis)); memset(instack,0,sizeof(instack)); flag = 0; for(int i = 0;i\u0026lt;=cnt;i++){ if(!vis[i] \u0026amp;\u0026amp; !end[i]) flag |= dfs(i); if(flag) return true; } return false; } bool dfs(int x){ instack[x] = vis[x] = 1; for(int i = 0;i\u0026lt;sigma_size;i++){ int v = c[x][i]; if(end[v]) continue; if(instack[v] || (!vis[v] \u0026amp;\u0026amp; dfs(v))) return true; } instack[x] = 0; return false; } }; AC_automaton\u0026lt;2\u0026gt; AC; int n; char s[MAXN]; void init(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n); for(int i = 1;i\u0026lt;=n;i++){ scanf(\u0026#34;%s\u0026#34;,s); AC.insert(s); } } void solve(){ AC.get_fail(); if(AC.judge()){ printf(\u0026#34;TAK\\n\u0026#34;); } else{ printf(\u0026#34;NIE\\n\u0026#34;); } } int main(){ init(); solve(); return 0; }   ","description":"","id":138,"section":"posts","tags":["ACè‡ªåŠ¨æœº","å­—ç¬¦ä¸²","å›¾è®º"],"title":"ã€ŒPOI2000ã€ç—…æ¯’-ACè‡ªåŠ¨æœº","uri":"https://blog.chenqiqian.com/posts/poi2000-virus/"},{"content":"HH æ˜¯ä¸ªå–œæ¬¢å˜åŒ–çš„äººï¼Œæ‰€ä»¥ä»–ä¸ä¼šç«‹åˆ»æ²¿ç€åˆšåˆšèµ°æ¥çš„è·¯èµ°å›ã€‚ åˆå› ä¸º HH æ˜¯ä¸ªå–œæ¬¢å˜åŒ–çš„äººï¼Œæ‰€ä»¥ä»–æ¯å¤©èµ°è¿‡çš„è·¯å¾„éƒ½ä¸å®Œå…¨ä¸€æ ·ï¼Œä»–æƒ³çŸ¥é“ä»–ç©¶ç«Ÿæœ‰å¤šå°‘ç§æ•£æ­¥çš„æ–¹æ³•ã€‚\nç°åœ¨ç»™ä½ å­¦æ ¡çš„åœ°å›¾ï¼ˆå‡è®¾æ¯æ¡è·¯çš„é•¿åº¦éƒ½æ˜¯ä¸€æ ·çš„éƒ½æ˜¯ $1$ ï¼‰ï¼Œé—®é•¿åº¦ä¸º $t$ ï¼Œä»ç»™å®šåœ°ç‚¹ $A$ èµ°åˆ°ç»™å®šåœ°ç‚¹ $B$ å…±æœ‰å¤šå°‘æ¡ç¬¦åˆä¸Šè¿°æ¡ä»¶çš„è·¯å¾„ã€‚\né“¾æ¥ Luogu P2151\né¢˜è§£ å¯ä»¥å‘ç°è¿™æ˜¯ä¸€é“dpã€‚\nå¦‚æœä»¤çŠ¶æ€ä¸º $dp[i][t]$ ï¼Œåœ¨ç¬¬ $i$ ä¸ªç‚¹ï¼Œå†èµ° $t$ æ­¥åˆ°è¾¾ $B$ ç‚¹çš„æ–¹æ¡ˆæ•°ã€‚ä½†æ˜¯æˆ‘ä»¬æ³¨æ„åˆ°è¿™ä¸ªå°±å¾ˆéš¾æ»¡è¶³ï¼š\n ä»–ä¸ä¼šç«‹åˆ»æ²¿ç€åˆšåˆšèµ°æ¥çš„è·¯èµ°å›\n çš„é™åˆ¶æ¡ä»¶ã€‚\næ‰€ä»¥æˆ‘ä»¬ä¸ºäº†ä½“ç°å‡ºåˆšèµ°è¿‡çš„è¾¹ï¼ŒåŒæ—¶è¿˜èƒ½ä½“ç°å‡ºåˆšèµ°è¿‡çš„ç‚¹ï¼Œå°±é‡æ–°è®¾è®¡ä¸€ä¸‹çŠ¶æ€ï¼š\nä»¤ $dp[e][t]$ ä¸ºåˆšåˆšèµ°è¿‡ç¬¬ $e$ æ¡è¾¹ï¼Œå†èµ° $t$ æ­¥åˆ°è¾¾ $B$ ç‚¹çš„æ–¹æ¡ˆæ•°ã€‚\nå…·ä½“å®ç°çš„æ—¶å€™è¦å»ºä¸¤æ¡å•å‘è¾¹ï¼Œç„¶åçŠ¶æ€è½¬ç§»æ–¹ç¨‹å¤§æ¦‚æ˜¯ï¼š\n$$\ndp[e][t] = \\sum dp[e'][t-1]\n$$\nå…¶ä¸­ $e'$ ä¸ºæ‰€æœ‰ä» $e.to$ å‡ºå‘çš„è¾¹ï¼Œé™¤äº† $e$ çš„åå‘è¾¹ã€‚\næ³¨æ„åˆ°è¿™é‡Œ $t$ çš„èŒƒå›´æ¯”è¾ƒå¤§ï¼Œå¯¹äºä»»æ„æ—¶å€™çš„ $t$ å’ŒæŸä¸ª $e$ ï¼Œè½¬ç§»çš„è·¯å¾„ï¼Œä¹Ÿå°±æ˜¯ $e'$ éƒ½ä¸ä¼šå˜ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨çŸ©é˜µå¿«é€Ÿå¹‚ä¼˜åŒ–è¿™ä¸€è¿‡ç¨‹ã€‚\nè¿™é‡Œçš„æ¨¡æ•°è¦ç”¨ define æ ·å¼çš„æ¯”è¾ƒå¥½ï¼Œå¯¹äºå¸¸æ•°æ¯”è¾ƒæœ‰åˆ©ã€‚\næ—¶é—´å¤æ‚åº¦ï¼š$O((2m)^3 \\times \\log{t})$\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cstring\u0026gt;#include \u0026lt;vector\u0026gt;using namespace std; const int MAXN = 200; typedef long long ll; #define mod 45989  int n,m,t,A,B; struct Edge{ int to,nex; }edge[MAXN]; int fir[MAXN],ecnt = 2; inline void addedge(int u,int v){ edge[ecnt] = (Edge){v,fir[u]}; fir[u] = ecnt++; } struct Matrix{ ll a[MAXN][MAXN]; Matrix(){ memset(a,0,sizeof(a)); } }; inline Matrix mul(const Matrix \u0026amp;_a,const Matrix \u0026amp;_b){ Matrix tmp; for(int i = 1;i\u0026lt;=2*m;i++){ for(int j = 1;j\u0026lt;=2*m;j++){ for(int k = 1;k\u0026lt;=2*m;k++){ tmp.a[i][j] += _a.a[i][k] * _b.a[k][j]; } if(tmp.a[i][j] \u0026gt;= mod) tmp.a[i][j] %= mod; } } return tmp; } inline Matrix pow(Matrix x,int k){ Matrix ans; for(int i = 1;i\u0026lt;=2*m;i++) ans.a[i][i] = 1; for(int i = k;i;i\u0026gt;\u0026gt;=1,x = mul(x,x)){ if(i\u0026amp;1) ans = mul(ans,x); } return ans; } inline void init(){ scanf(\u0026#34;%d %d %d %d %d\u0026#34;,\u0026amp;n,\u0026amp;m,\u0026amp;t,\u0026amp;A,\u0026amp;B); A++,B++; int u,v; for(int i = 1;i\u0026lt;=m;i++){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;u,\u0026amp;v); u++,v++; addedge(u,v); addedge(v,u); } m++; edge[2*m] = (Edge){A,fir[0]}; fir[0] = 1; } void solve(){ Matrix M,I; for(int e = 2;e\u0026lt;=2*m;e++){ int x = edge[e].to; if(x == B) I.a[e][1] = 1; for(int nowe = fir[x];nowe;nowe = edge[nowe].nex){ if((e^1)==nowe) continue; M.a[e][nowe] = 1; } } M = pow(M,t); static ll ans[MAXN]; for(int i = 1;i\u0026lt;=2*m;i++){ for(int j = 1;j\u0026lt;=2*m;j++){ ans[i] += M.a[i][j] * I.a[j][1]; } } printf(\u0026#34;%lld\\n\u0026#34;,ans[2*m] % mod); } int main(){ init(); solve(); return 0; }   ","description":"","id":139,"section":"posts","tags":["çŸ©é˜µå¿«é€Ÿå¹‚","åŠ¨æ€è§„åˆ’","å›¾è®º"],"title":"ã€ŒSDOI2009ã€HHå»æ•£æ­¥-çŸ©é˜µå¿«é€Ÿå¹‚+dp","uri":"https://blog.chenqiqian.com/posts/sdoi2009-walk/"},{"content":"æœ‰ä¸€ä¸ªæ— å‘å›¾ $G$ ï¼Œæ¯ä¸ªç‚¹æœ‰ä¸ªæƒå€¼ï¼Œæ¯æ¡è¾¹æœ‰ä¸€ä¸ªé¢œè‰²ã€‚è¿™ä¸ªæ— å‘å›¾æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶ï¼š\n å¯¹äºä»»æ„èŠ‚ç‚¹è¿å‡ºå»çš„è¾¹ä¸­ï¼Œç›¸åŒé¢œè‰²çš„è¾¹ä¸è¶…è¿‡ä¸¤æ¡ã€‚ å›¾ä¸­ä¸å­˜åœ¨åŒè‰²çš„ç¯ï¼ŒåŒè‰²çš„ç¯æŒ‡ç›¸åŒé¢œè‰²çš„è¾¹æ„æˆçš„ç¯ã€‚  åœ¨è¿™ä¸ªå›¾ä¸Šï¼Œä½ è¦æ”¯æŒä»¥ä¸‹ä¸‰ç§æ“ä½œï¼š\n ä¿®æ”¹ä¸€ä¸ªèŠ‚ç‚¹çš„æƒå€¼ã€‚ ä¿®æ”¹ä¸€æ¡è¾¹çš„é¢œè‰²ã€‚ æŸ¥è¯¢ç”±é¢œè‰² $c$ çš„è¾¹æ„æˆçš„å›¾ä¸­ï¼Œ $u$ åˆ°èŠ‚ç‚¹ $v$ ä¹‹é—´çš„ç®€å•è·¯å¾„ä¸Šçš„èŠ‚ç‚¹çš„æƒå€¼çš„æœ€å¤§å€¼ã€‚  å¯¹äº 100% çš„æ•°æ®ï¼Œä¿è¯é¢œè‰²ä¸å¤šäº $10$ ç§ã€‚\né“¾æ¥ Luogu P2173\né¢˜è§£ å¯¹äºæ¯ä¸€ç§é¢œè‰²ç»´æŠ¤ä¸€é¢—ç»´æŠ¤æœ€å¤§å€¼çš„LCTï¼Œç‚¹æƒå¯¹äºæ‰€æœ‰çš„æ ‘éƒ½è¦æ”¹ï¼Œæ”¹è¾¹çš„é¢œè‰²çš„è¯ç›¸å½“äºåˆ è¾¹å†åŠ è¾¹ï¼Œæœ€å¤§å€¼æŸ¥è¯¢å°±å¥½ã€‚\né”™è¯¯åˆ¤æ–­çš„è¯å°±æ˜¯LCTçš„æ­£å¸¸æ“ä½œï¼Œå†ç»´æŠ¤ä¸€ä¸ªåº¦æ•°å°±å¯ä»¥äº†ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;algorithm\u0026gt;#include \u0026lt;cctype\u0026gt;using namespace std; inline char read(){ const int SIZE = 1024*1024; static char *s,*t,ibuf[SIZE]; if(s == t) t = (s = ibuf) + fread(ibuf,1,SIZE,stdin); return s == t ? -1: (*s++); } inline void read(int \u0026amp;x){ static bool iosig = 0;char ch; for(ch = read(),iosig = 0;!isdigit(ch);ch= read()){ if(ch == \u0026#39;-\u0026#39;) iosig = 1; if(ch == -1) return; } for(x = 0;isdigit(ch);ch = read()) x = (((x\u0026lt;\u0026lt;2)+x)\u0026lt;\u0026lt;1) + (ch^48); if(iosig) x = -x; } const int MAXN = 13000; struct Link_Cat_Tree{ int v[MAXN],maxn[MAXN]; int f[MAXN],c[MAXN][2]; bool rev[MAXN]; void push_up(int x){ maxn[x] = max(max(maxn[c[x][0]],maxn[c[x][1]]),v[x]); } void reverse(int x){ swap(c[x][0],c[x][1]); rev[x] ^= 1; } void push_down(int x){ if(rev[x]){ reverse(c[x][0]),reverse(c[x][1]); rev[x] = 0; } } bool noroot(int x){ return c[f[x]][0] == x || c[f[x]][1] == x; } void push_all(int x){ if(noroot(x)) push_all(f[x]); push_down(x); } void rotate(int x){ int y = f[x],z = f[y],t = (c[y][1] == x),w = c[x][1-t]; if(noroot(y)) c[z][c[z][1]==y] = x; c[y][t] = w,c[x][1-t] = y; if(w) f[w] = y; f[x] = z,f[y] = x; push_up(y),push_up(x); } void splay(int x){ push_all(x); while(noroot(x)){ int y = f[x],z = f[y]; if(noroot(y)){ if((c[y][1]==x)^(c[z][1]==y)) rotate(x); else rotate(y); }rotate(x); } } void access(int x){ for(int y = 0;x;x = f[y = x]){ splay(x);c[x][1] = y; push_up(x); } } void makeroot(int x){ access(x),splay(x),reverse(x); } void split(int x,int y){//splitåyä½äºæ ‘æ ¹ï¼ˆä»£è¡¨æ•´æ¡é“¾  makeroot(x),access(y),splay(y); } int find(int x){ access(x),splay(x); push_down(x); while(c[x][0]){ x = c[x][0],push_down(x); } return x; } bool link(int x,int y){ makeroot(x); if(find(y) != x){ f[x] = y; return 1; }else return 0; } bool judge(int x,int y){ makeroot(x); return find(y) == x \u0026amp;\u0026amp; f[x] == y \u0026amp;\u0026amp; !c[x][1]; } bool cat(int x,int y){ makeroot(x);//find ä¹‹å y ä½äº æ ‘æ ¹  if(find(y) == x \u0026amp;\u0026amp; f[x] == y \u0026amp;\u0026amp; !c[x][1]){ f[x] = c[y][0] = 0;push_up(y); return 1; }else return 0; } void update(int x,int val){ makeroot(x); v[x] = val,push_up(x); } int query(int x,int y){ makeroot(x); if(find(y)!=x) return -1; else{ access(y),splay(y); return maxn[y]; } } }T[10];// Tree 0 -\u0026gt; 9 int d[MAXN][10];// degree  int n,m,c,k; void update(int x,int v){ for(int i = 0;i\u0026lt;c;i++) T[i].update(x,v); } int change(int u,int v,int w){ if(T[w].judge(u,v)) return 0; for(int i = 0;i\u0026lt;c;i++){ if(T[i].judge(u,v)){ if(d[u][w] \u0026gt;= 2 || d[v][w] \u0026gt;= 2) return 1; else{ if(!T[w].link(u,v)) return 2; else{ d[u][i]--,d[v][i]--; T[i].cat(u,v); d[u][w]++,d[v][w]++; return 0; } } } } return -1; } void init(){ read(n),read(m),read(c),read(k); int u,v,w; for(int i = 1;i\u0026lt;=n;i++){ read(v); update(i,v); } for(int i = 1;i\u0026lt;=m;i++){ read(u),read(v),read(w); T[w].link(u,v); d[u][w]++,d[v][w]++; } } int query(int u,int v,int w){ return T[w].query(u,v); } void solve(){ int op,u,v,w; for(int i = 1;i\u0026lt;=k;i++){ read(op); if(op == 0){ read(u),read(v); update(u,v); } else if(op == 1){ read(u),read(v),read(w); int t = change(u,v,w); if(t\u0026gt;0) printf(\u0026#34;Error %d.\\n\u0026#34;,t); else if(t==-1) printf(\u0026#34;No such edge.\\n\u0026#34;); else printf(\u0026#34;Success.\\n\u0026#34;); } else if(op == 2){ read(w),read(u),read(v); printf(\u0026#34;%d\\n\u0026#34;,query(u,v,w)); } } } int main(){ init(); solve(); return 0; }   ","description":"","id":140,"section":"posts","tags":["æ•°æ®ç»“æ„","æ ‘å½¢ç»“æ„","LCT"],"title":"ã€ŒZJOI2012ã€ç½‘ç»œ-LCT","uri":"https://blog.chenqiqian.com/posts/zjoi2012-network/"},{"content":"ç®€å•ç‰ˆé¢˜æ„ï¼š\nç»™å®šä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„å­—ç¬¦ä¸²ï¼Œå’Œä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„æ•°åˆ— ${a_n}$ ï¼Œæ±‚å¯¹äº $r$ ä» $0$ åˆ° $n-1$ ï¼Œæ‰€æœ‰æ»¡è¶³ $1 \\leq p \u0026lt; q \\leq n$ ä¸” $lcp(p,q) \\geq r$ çš„æ•°å¯¹ä¸ªæ•°ä»¥åŠæ»¡è¶³ä¸Šè¿°æ¡ä»¶çš„æ•°å¯¹ä¸­ $a_p \\times a_q$ çš„æœ€å¤§å€¼ã€‚ï¼ˆ $a_i$ å¯ä»¥ä¸ºè´Ÿæ•°ï¼‰\nå®Œæ•´ç‰ˆé¢˜æ„ï¼š\nä¸€å¹´ä¸€åº¦çš„â€œå¹»å½±é˜å¤æ—¥å“é…’å¤§ä¼šâ€éš†é‡å¼€å¹•äº†ã€‚å¤§ä¼šåŒ…å«å“å°å’Œè¶£å‘³æŒ‘æˆ˜ ä¸¤ä¸ªç¯èŠ‚ï¼Œåˆ†åˆ«å‘ä¼˜èƒœè€…é¢å‘â€œé¦–å¸­å“é…’å®¶â€å’Œâ€œé¦–å¸­çŒæ‰‹â€ä¸¤ä¸ªå¥–é¡¹ï¼Œå¸å¼•äº†ä¼—å¤šå“é…’å¸ˆå‚åŠ ã€‚\nåœ¨å¤§ä¼šçš„æ™šé¤ä¸Šï¼Œè°ƒé…’å¸ˆ $Rainbow$ è°ƒåˆ¶äº† $n$ æ¯é¸¡å°¾é…’ã€‚è¿™ $n$ æ¯é¸¡å°¾é…’æ’æˆä¸€è¡Œï¼Œå…¶ä¸­ç¬¬ $n$ æ¯é…’ $(1 \\leq i \\leq n)$ è¢«è´´ä¸Šäº†ä¸€ä¸ªæ ‡ç­¾$s_i$ï¼Œæ¯ä¸ªæ ‡ç­¾éƒ½æ˜¯ $26$ ä¸ªå°å†™ è‹±æ–‡å­—æ¯ä¹‹ä¸€ã€‚è®¾ $str(l, r)$è¡¨ç¤ºç¬¬ $l$ æ¯é…’åˆ°ç¬¬ $r$ æ¯é…’çš„ $r - l + 1$ä¸ªæ ‡ç­¾é¡ºæ¬¡è¿æ¥æ„æˆçš„å­—ç¬¦ä¸²ã€‚è‹¥ $str(p, po) = str(q, qo)$ï¼Œå…¶ä¸­ $1 \\leq p \\leq po \\leq n$, $1 \\leq q \\leq qo \\leq n$, $p â‰  q$, $po - p + 1 = qo - q + 1 = r$ ï¼Œåˆ™ç§°ç¬¬ $p$ æ¯é…’ä¸ç¬¬ $q$ æ¯é…’æ˜¯â€œ $r$ ç›¸ä¼¼â€ çš„ã€‚å½“ç„¶ä¸¤æ¯â€œ $r$ ç›¸ä¼¼â€$(r \u0026gt; 1)$çš„é…’åŒæ—¶ä¹Ÿæ˜¯â€œ $1$ ç›¸ä¼¼â€ã€â€œ $2$ ç›¸ä¼¼â€ã€â€¦â€¦ã€â€œ $(r - 1)$ ç›¸ä¼¼â€çš„ã€‚ç‰¹åˆ«åœ°ï¼Œå¯¹äºä»»æ„çš„ $1 â‰¤ p$ , $q â‰¤ n$ ï¼Œ $p â‰  q$ ï¼Œç¬¬ $p$ æ¯é…’å’Œç¬¬ $q$ æ¯é…’éƒ½ æ˜¯â€œ $0$ ç›¸ä¼¼â€çš„ã€‚\nåœ¨å“å°ç¯èŠ‚ä¸Šï¼Œå“é…’å¸ˆ $Freda$ è½»æ¾åœ°è¯„å®šäº†æ¯ä¸€æ¯é…’çš„ç¾å‘³åº¦ï¼Œå‡­å€Ÿå…¶ä¸“ä¸šçš„æ°´å‡†å’Œç»éªŒæˆåŠŸå¤ºå–äº†â€œé¦–å¸­å“é…’å®¶â€çš„ç§°å·ï¼Œå…¶ä¸­ç¬¬ $i$ æ¯é…’ ($1 â‰¤ i â‰¤ n$) çš„ ç¾å‘³åº¦ä¸º $a_i$ ã€‚ç°åœ¨ $Rainbow$ å…¬å¸ƒäº†æŒ‘æˆ˜ç¯èŠ‚çš„é—®é¢˜ï¼šæœ¬æ¬¡å¤§ä¼šè°ƒåˆ¶çš„é¸¡å°¾é…’æœ‰ä¸€ä¸ªç‰¹ç‚¹ï¼Œå¦‚æœæŠŠç¬¬ $p$ æ¯é…’ä¸ç¬¬ $q$ æ¯é…’è°ƒå…‘åœ¨ä¸€èµ·ï¼Œå°†å¾—åˆ°ä¸€æ¯ç¾å‘³åº¦ä¸º $a_p \\times a_q$ çš„é…’ã€‚ç°åœ¨è¯·å„ä½å“é…’å¸ˆåˆ†åˆ«å¯¹äº $r = 0,1,2, â‹¯ , n - 1$ ï¼Œç»Ÿè®¡å‡ºæœ‰å¤šå°‘ç§æ–¹æ³•å¯ä»¥ é€‰å‡º $2$ æ¯â€œ $r$ ç›¸ä¼¼â€çš„é…’ï¼Œå¹¶å›ç­”é€‰æ‹© $2$ æ¯â€œ $r$ ç›¸ä¼¼â€çš„é…’è°ƒå…‘å¯ä»¥å¾—åˆ°çš„ç¾å‘³åº¦çš„æœ€å¤§å€¼ã€‚\né“¾æ¥ Luogu P2178\né¢˜è§£ æ³¨æ„åˆ°è¿™ä¸ªä¸œè¥¿æœ‰ LCP ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¸Šåç¼€æ•°ç»„ä¹±æ€¼ã€‚\n$O(n^2)$ çš„åšæ³•æ˜¯æ˜¾è€Œæ˜“è§çš„ï¼Œåªéœ€è¦æšä¸¾ $p,q$ ï¼Œæ›´æ–°LCPä½ç½®çš„å€¼ï¼Œä»å¤§å¾€å°å†æ‰«ä¸€éå°±å¯ä»¥äº†ã€‚\näº‹å®ä¸Šé—®é¢˜æ‰€æ±‚çš„ä¸œè¥¿å¯ä»¥è½¬åŒ–æˆï¼šæ°å¥½ä¸º $r$ çš„æœ€å¤§å€¼ï¼Œæ°å¥½ä¸º $r$ çš„æ•°ç›®ã€‚\næ„é€ å‡º height æ•°ç»„ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œæ‰€æœ‰ lcp æ°å¥½ä¸º $r$ çš„æ•°å¯¹ï¼Œå¿…ç„¶ç»è¿‡è‡³å°‘ä¸€ä¸ª height ä¸º $r$ çš„ä½ç½®ï¼Œè€Œä¸”å®ƒä»¬ç»è¿‡çš„åŒºåŸŸçš„ height åº”è¯¥å…¨éƒ½å¤§äºç­‰äº $r$ ï¼Œéšç€ $r$ çš„å‡å°è¿™ä¸ªåŒºåŸŸæ˜¯åœ¨ä¸æ–­æ‰©å¤§çš„ï¼Œäº‹å®ä¸Šå°±æ˜¯å¤§äº $r$ çš„è”é€šå—åœ¨ä¸æ–­å‡å°‘ã€‚\nç”¨ä¸€ä¸ªå¹¶æŸ¥é›†ç»´æŠ¤ä¸€ä¸‹å°±å¥½ã€‚æ¯æ¬¡è¿æ¥ä¸¤ä¸ªé›†åˆ $x,y$ ï¼Œéƒ½ä¼šäº§ç”Ÿ $siz[x] \\times siz[y]$ å¯¹è¿™æ ·çš„æ•°å¯¹ã€‚\nå› ä¸ºæœ‰è´Ÿæ•°ï¼Œæ‰€ä»¥ä¸ºäº†è·å¾—æœ€å¤§å€¼ï¼Œè¿™é‡Œæˆ‘ä»¬è¦åŒæ—¶ç»´æŠ¤æœ€å¤§ã€æœ€å°å€¼ã€‚\nè¿™é“é¢˜ç»†èŠ‚æŒºå¤šçš„ï¼Œæœ‰ä¸€ä¸ªåœ°æ–¹ä¸èƒ½åˆå¹¶ï¼Œè¦ç‰¹æ®Šå¤„ç† $0$ ç›¸ä¼¼ï¼Œä»¤äººçª’æ¯ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cctype\u0026gt;#include \u0026lt;algorithm\u0026gt;using namespace std; #define inf 0x3f3f3f3f #define ll long long  const int MAXN = 310000; namespace fast_io{ //... }using namespace fast_io; namespace SA{ int s[MAXN],sa[MAXN],ht[MAXN],rk[MAXN],x[MAXN],y[MAXN],cnt[MAXN]; void get_sa(int n,int m){ for(int i = 0;i\u0026lt;m;i++) cnt[i] = 0; for(int i = 0;i\u0026lt;n;i++) cnt[s[i]]++; for(int i = 1;i\u0026lt;m;i++) cnt[i] += cnt[i-1]; for(int i = n-1;~i;--i) sa[--cnt[s[i]]] = i; m = rk[sa[0]] = 0; for(int i = 1;i\u0026lt;n;i++) rk[sa[i]] = s[sa[i]] != s[sa[i-1]]?++m:m; for(int j = 1;;j\u0026lt;\u0026lt;=1){ if(++m == n) break; for(int i = 0;i\u0026lt;j;i++) y[i] = n-j+i; for(int i = 0,k=j;i\u0026lt;n;i++) if(sa[i] \u0026gt;= j) y[k++] = sa[i]-j; for(int i = 0;i\u0026lt;n;i++) x[i] = rk[y[i]]; for(int i = 0;i\u0026lt;m;i++) cnt[i] = 0; for(int i = 0;i\u0026lt;n;i++) cnt[x[i]]++; for(int i = 1;i\u0026lt;m;i++) cnt[i] += cnt[i-1]; for(int i = n-1;~i;--i) sa[--cnt[x[i]]] = y[i],y[i] = rk[i]; m = rk[sa[0]] = 0; for(int i = 1;i\u0026lt;n;i++) rk[sa[i]] =(y[sa[i]]!=y[sa[i-1]]||y[sa[i]+j]!=y[sa[i-1]+j])?++m:m; } } template\u0026lt;typename T\u0026gt; int mapCharToInt(int n,const T *str){ int m = *max_element(str,str+n); for(int i = 0;i\u0026lt;=m;i++) rk[i] = 0; for(int i = 0;i\u0026lt;n;i++) rk[(int)(str[i])] = 1; for(int i = 1;i\u0026lt;=m;i++) rk[i] += rk[i-1]; for(int i = 0;i\u0026lt;n;i++) s[i] = rk[(int)(str[i])]-1; return rk[m]; } void getheight(int n){ for(int i = 0,h = ht[0] = 0;i\u0026lt;n;i++){ int j = sa[rk[i]-1]; while(i+h\u0026lt;n\u0026amp;\u0026amp;j+h\u0026lt;n\u0026amp;\u0026amp;s[i+h]==s[j+h]) h++; if(ht[rk[i]] = h) h--; } } void build(int n,char *str){ int m = mapCharToInt(++n,str); get_sa(n,m); getheight(n); } } namespace BCJ{ int f[MAXN],siz[MAXN]; ll maxn[MAXN],minn[MAXN]; void init(int n,ll * val){ for(int i = 0;i\u0026lt;=n;i++){ f[i] = i,siz[i] = 1; maxn[i] = minn[i] = val[i]; } } int find(int x){ return f[x] == x?x:f[x] = find(f[x]); } bool same(int x,int y){ return find(x) == find(y); } ll unite(int x,int y,ll \u0026amp;ans){ int fx = find(x),fy = find(y); if(fx == fy) return 0; ans = max(ans,maxn[fx]*maxn[fy]); ans = max(ans,minn[fx]*minn[fy]); f[fy] = fx; minn[fx] = min(minn[fx],minn[fy]); maxn[fx] = max(maxn[fx],maxn[fy]); ll res = 1LL*siz[fx] * siz[fy]; siz[fx] += siz[fy]; return res; } } bool cmp(int a,int b){ return SA::ht[a] \u0026gt; SA::ht[b]; } char str[MAXN]; int n,m; ll a[MAXN],ans[MAXN],cnt[MAXN]; void init(){ static ll min1 = inf,min2 = inf,max1 = -inf,max2 = -inf; read(n); read(str); str[n] = \u0026#39;a\u0026#39;-1; for(int i = 1;i\u0026lt;=n;i++){ read(a[i]); if(a[i] \u0026lt; min1) min1=a[i]; else if(a[i] \u0026lt; min2) min2=a[i]; if(a[i] \u0026gt; max1) max1=a[i]; else if(a[i] \u0026gt; max2) max2=a[i]; ans[i] = -1LL*inf*inf; } ans[0] = max(max1*max2,min1*min2); } void solve(){ static int h[MAXN]; SA::build(n,str); BCJ::init(n,a); for(int i = 1;i\u0026lt;=n;i++) h[i] = i; sort(h+1,h+n+1,cmp); for(int i = 1;i\u0026lt;=n;i++){ int x = h[i],ht = SA::ht[x]; if(x!=1) cnt[ht] += BCJ::unite(SA::sa[x]+1,SA::sa[x-1]+1,ans[ht]); } for(int i = n-2;i\u0026gt;=0;i--){ cnt[i] += cnt[i+1]; ans[i] = max(ans[i],ans[i+1]); } cnt[0] = 1LL*n*(n-1)/2; for(int i = 0;i\u0026lt;n;i++){ if(!cnt[i]) ans[i] = 0; print(cnt[i]),print(\u0026#39; \u0026#39;),print(ans[i]),print(\u0026#39;\\n\u0026#39;); } } signed main(){ init(); solve(); flush(); return 0; }   ","description":"","id":141,"section":"posts","tags":["å­—ç¬¦ä¸²","åç¼€æ•°ç»„","å¹¶æŸ¥é›†"],"title":"ã€ŒNOI2015ã€å“é…’å¤§ä¼š-åç¼€æ•°ç»„","uri":"https://blog.chenqiqian.com/posts/noi2015-savour/"},{"content":"ç³»ç»Ÿå°†ä¾æ¬¡éšæœºæŠ›å‡º $k$ æ¬¡å®ç‰©ï¼Œæ¯æ¬¡ä½ éƒ½å¯ä»¥é€‰æ‹©åƒæˆ–è€…ä¸åƒã€‚å®ç‰©ä¸€å…±æœ‰ $n$ ç§ï¼Œç³»ç»Ÿæ¯æ¬¡æŠ›å‡ºè¿™ $n$ ç§å®ç‰©çš„æ¦‚ç‡éƒ½ç›¸åŒä¸”ç›¸äº’ç‹¬ç«‹ã€‚\nåƒä¸€æ¬¡ç¬¬ $i$ ç§å®ç‰©å°†å¾—åˆ° $P_i$ åˆ†ï¼Œä½†å¹¶ä¸æ˜¯æ¯ç§å®ç‰©éƒ½æ˜¯å¯ä»¥éšæ„è·å–çš„ã€‚ç¬¬ $i$ ç§å®ç‰©æœ‰ä¸€ä¸ªå‰æå®ç‰©é›†åˆ $S_i$ ã€‚åªæœ‰å½“ $S_i$ ä¸­æ‰€æœ‰å®ç‰©éƒ½è‡³å°‘åƒè¿‡ä¸€æ¬¡ï¼Œæ‰èƒ½åƒç¬¬ $i$ ç§å®ç‰©ã€‚æ³¨æ„ï¼Œ$P_i$ å¯ä»¥æ˜¯è´Ÿæ•°ã€‚\nå‡è®¾ä½ é‡‡å–æœ€ä¼˜ç­–ç•¥ï¼Œå¹³å‡æƒ…å†µä½ ä¸€å…±èƒ½åœ¨å¥–åŠ±å…³å¾—åˆ°å¤šå°‘åˆ†å€¼ï¼Ÿ\né“¾æ¥ Luogu P2473\né¢˜è§£ ä¸ºäº†æ–¹ä¾¿æœ€åç­”æ¡ˆçš„è®¡ç®—ï¼Œæˆ‘ä»¬è®¾ $dp[i][S]$ ä¸ºå½“å‰å·²ç»åƒäº† $i$ æ¬¡ï¼Œå¹¶ä¸”å·²ç»åƒåˆ°çš„å®ç‰©çš„é›†åˆä¸º $S$ ï¼Œåˆ°æœ€åï¼ˆåƒå®Œ $k$ æ¬¡ï¼‰èƒ½å¤Ÿè·å¾—ã€‚\nç„¶åçŠ¶æ€è½¬ç§»ï¼ˆ $W_i$ ä¸ºå•ç‹¬å– $i$ çš„é›†åˆï¼‰ï¼š\n$$\ndp[i][S] = \\frac{1}{n}\\sum_{i = 1}^{n}\n\\begin{cases}\nmin(dp[i+1][S],dp[i+1][S \\cup W_i] + P_i),S_i \\subset S\\\ndp[i+1][S],S_i \\not\\subset S\n\\end{cases}\n$$\nçŠ¶å‹ï¼Œè½¬ç§»å³å¯ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;algorithm\u0026gt;using namespace std; const int MAXN = 110; int k,n; int q[MAXN],p[MAXN],t; double dp[MAXN][1\u0026lt;\u0026lt;16];//1\u0026lt;\u0026lt;typeä»£è¡¨ç¬¬iç§  void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;k,\u0026amp;n); for(int i = 1;i\u0026lt;=n;i++){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;p[i],\u0026amp;t); while(t!=0) q[i] |= (1\u0026lt;\u0026lt;(t-1)),scanf(\u0026#34;%d\u0026#34;,\u0026amp;t); } } void solve(){ for(int i = k-1;i\u0026gt;=0;i--){ for(int j = 0;j\u0026lt;=(1\u0026lt;\u0026lt;n)-1;j++){ for(int w = 1;w\u0026lt;=n;w++) dp[i][j] += max(dp[i+1][j],(q[w]\u0026amp;j)==q[w]?dp[i+1][j|(1\u0026lt;\u0026lt;w-1)]+p[w]:-1e9); dp[i][j]/=n; } } printf(\u0026#34;%.6lf\\n\u0026#34;,dp[0][0]); } int main(){ init(); solve(); return 0; }   ","description":"","id":142,"section":"posts","tags":["åŠ¨æ€è§„åˆ’","æœŸæœ›dp"],"title":"ã€ŒSCOI2008ã€å¥–åŠ±å…³-æœŸæœ›dp","uri":"https://blog.chenqiqian.com/posts/scoi2008-award/"},{"content":"ç°åœ¨æœ‰ä¸€æ£µäºŒå‰æ ‘ï¼Œæ‰€æœ‰éå¶å­èŠ‚ç‚¹éƒ½æœ‰ä¸¤ä¸ªå­©å­ã€‚åœ¨æ¯ä¸ªå¶å­èŠ‚ç‚¹ä¸Šæœ‰ä¸€ä¸ªæƒå€¼(æœ‰ $n$ ä¸ªå¶å­èŠ‚ç‚¹ï¼Œæ»¡è¶³è¿™äº›æƒå€¼ä¸º $1\u0026hellip;n$ çš„ä¸€ä¸ªæ’åˆ—)ã€‚å¯ä»¥ä»»æ„äº¤æ¢æ¯ä¸ªéå¶å­èŠ‚ç‚¹çš„å·¦å³å­©å­ã€‚\nè¦æ±‚è¿›è¡Œä¸€ç³»åˆ—äº¤æ¢ï¼Œä½¿å¾—æœ€ç»ˆæ‰€æœ‰å¶å­èŠ‚ç‚¹çš„æƒå€¼æŒ‰ç…§å‰åºéå†åºå†™å‡ºæ¥ï¼Œé€†åºå¯¹ä¸ªæ•°æœ€å°‘ã€‚\nè¾“å…¥æ–¹å¼ï¼š\nç¬¬ä¸€è¡Œä¸€ä¸ªæ•´æ•°nï¼›\nä¸‹é¢æ¯è¡Œï¼Œä¸€ä¸ªæ•°xï¼›\n å¦‚æœ $x==0$ ï¼Œè¡¨ç¤ºè¿™ä¸ªèŠ‚ç‚¹éå¶å­èŠ‚ç‚¹ï¼Œé€’å½’åœ°å‘ä¸‹è¯»å…¥å…¶å·¦å­©å­å’Œå³å­©å­çš„ä¿¡æ¯ï¼› å¦‚æœ $x!=0$ ï¼Œè¡¨ç¤ºè¿™ä¸ªèŠ‚ç‚¹æ˜¯å¶å­èŠ‚ç‚¹ï¼Œæƒå€¼ä¸º$x$ã€‚  é“¾æ¥ Luogu P3521// æ•°æ®å¤ªå¼±\nLOJ 2163 // å•ç‚¹æ—¶é™0.2s ååˆ†é€‚åˆå¡å¸¸\né¢˜è§£ çº¿æ®µæ ‘åˆå¹¶ è¿™é‡Œçš„çº¿æ®µæ ‘åˆå¹¶è®¨è®ºçš„éƒ½æ˜¯åŠ¨æ€å¼€ç‚¹çš„çº¿æ®µæ ‘çš„åˆå¹¶ã€‚\næˆ‘ä»¬æ³¨æ„åˆ°ï¼Œå¦‚æœç»™å®šå…ƒç´ ä¸ªæ•°ï¼ˆå€¼åŸŸåŒºé—´ï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªçº¿æ®µæ ‘çš„æ¯ä¸ªèŠ‚ç‚¹å¯¹åº”çš„åŒºé—´æ˜¯å”¯ä¸€ç¡®å®šçš„ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬å¯ä»¥åœ¨ä¸€ä¸ªè¾ƒä½çš„å¤æ‚åº¦é‡Œé¢å°†è‹¥å¹²æ£µåŠ¨æ€å¼€ç‚¹çš„çº¿æ®µæ ‘åˆåˆ°ä¸€èµ·å»çš„ä¸€ä¸ªåŸºç¡€ã€‚\næˆ‘ä»¬åœ¨è¿™é‡Œå‡è®¾æˆ‘ä»¬å¯ä»¥åœ¨ $O(1)$ çš„æ—¶é—´é‡Œé¢åˆå¹¶ä¸¤ä¸ªæ ‘çš„å¶å­çš„ä¿¡æ¯ï¼Œå¹¶ä»çº¿æ®µæ ‘çš„ä¸¤ä¸ªå­æ ‘ $O(1)$ çš„å¾—åˆ°æ›´å¤§çš„åŒºé—´çš„ä¿¡æ¯ï¼ˆåŒºé—´åˆå¹¶ï¼‰ï¼Œå…¶å®è¿™ä¹Ÿæ˜¯çº¿æ®µæ ‘çš„åŸºç¡€ã€‚\næˆ‘ä»¬å…¶å®å¯ä»¥æš´åŠ›çš„å†™å‡ºåˆå¹¶çš„ä¼ªä»£ç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13  node merge(node u,node v): if u,v ä¸­å­˜åœ¨ä¸€ä¸ªèŠ‚ç‚¹ä¸ºç©ºèŠ‚ç‚¹: return å¦ä¸€ä¸ªèŠ‚ç‚¹ // O(1)  if u,v å‡ä¸ºå¶èŠ‚ç‚¹: return åˆå¹¶u,v ä¸¤ä¸ªå¶èŠ‚ç‚¹ // O(1)  u.leftchild = merge(u.leftchild,v.leftchild) u.rightchild = merge(u.rightchild,v.rightchild) åˆå¹¶ u.leftchild å’Œ u.rightchild çš„ä¿¡æ¯ä¸º u // O(1)  return u   çº¿æ®µæ ‘åˆå¹¶çš„è¿‡ç¨‹ä¹Ÿå¯ä»¥å¾ˆå®¹æ˜“çš„å¯æŒä¹…åŒ–ï¼Œåªéœ€è¦æŠŠä¸Šé¢çš„ä»£ç ä¸­åé¢çš„å‡ ä¸ª $u$ ä¿®æ”¹æˆä¸€ä¸ªæ–°åˆ›å»ºçš„ $w$ å³å¯ã€‚\nå…³äºå¤æ‚åº¦ï¼Œå¯ä»¥æ˜¾è€Œæ˜“è§çš„æ³¨æ„åˆ°ï¼Œ merge ä¸¤ä¸ªåŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘çš„æ—¶å€™ï¼Œå…¶å¤æ‚åº¦ä¸å…¬å…±èŠ‚ç‚¹çš„æ•°é‡æˆæ­£æ¯”ï¼Œä¹Ÿå°±æ˜¯å‡å°‘çš„èŠ‚ç‚¹æ•°ç›®ã€‚\nåŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘æ¯æ¬¡æ’å…¥ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå…¶ç©ºé—´ä¼šå¢åŠ  $\\log n$ ã€‚è¿™æ ·å¦‚æœæˆ‘ä»¬æœ‰äº† $n$ é¢—åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹çš„åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘ï¼Œæ€»å…±çš„ç‚¹æœ‰ $O(n \\log n)$ ä¸ªã€‚\nå¦‚æœå°†è¿™æ · $n$ ä¸ªåŠ¨æ€å¼€ç‚¹çš„çº¿æ®µæ ‘åˆå¹¶åˆ°ä¸€æ£µçº¿æ®µæ ‘ï¼Œæœ€åå‰©ä¸‹çš„èŠ‚ç‚¹æ•°æ˜¯åœ¨ $O(n)$ é‡çº§çš„ï¼Œå‡å°‘çš„èŠ‚ç‚¹æ•°ç›®æ˜¯åœ¨ $O(n \\log n)$ é‡çº§çš„ï¼Œæ‰€ä»¥è¿™æ ·åˆå¹¶çš„æ—¶é—´å¤æ‚åº¦æ˜¯ $O(n \\log n)$ ã€‚\né¢˜ç›®è§£æ³• è¿™é“é¢˜ä¸»è¦å°±æ˜¯æƒå€¼çº¿æ®µæ ‘åˆå¹¶çš„ä¸€ä¸ªè¿‡ç¨‹ã€‚æˆ‘ä»¬å¯¹æ¯ä¸ªå¶å­ç»“ç‚¹å¼€ä¸€ä¸ªæƒå€¼çº¿æ®µæ ‘ï¼Œç„¶åé€æ­¥åˆå¹¶ã€‚\nè€ƒè™‘åˆ°ä¸€ä»¶äº‹æƒ…ï¼šå¦‚æœåœ¨åŸæ ‘æœ‰ä¸€ä¸ªæ ¹èŠ‚ç‚¹xï¼Œå’Œå…¶å·¦å„¿å­ $ls$ ï¼Œå³å„¿å­ $rs$ ã€‚æˆ‘ä»¬è¦åˆå¹¶çš„æ˜¯ $ls$ çš„æƒå€¼çº¿æ®µæ ‘å’Œ $rs$ çš„æƒå€¼çº¿æ®µæ ‘ã€‚\nå‘ç°äº¤æ¢ $ls$ å’Œ $rs$ å¹¶ä¸ä¼šå¯¹æ›´ä¸Šå±‚ä¹‹é—´çš„é€†åºå¯¹äº§ç”Ÿå½±å“ï¼Œäºæ˜¯æˆ‘ä»¬åªéœ€è¦æ¯æ¬¡åˆå¹¶éƒ½è®©é€†åºå¯¹æœ€å°‘ã€‚\näºæ˜¯æˆ‘ä»¬çš„é—®é¢˜è½¬åŒ–ä¸ºäº†ç»™å®šä¸¤ä¸ªæƒå€¼çº¿æ®µæ ‘ï¼Œé—®æŠŠå®ƒä»¬å“ªä¸ªæ”¾åœ¨å·¦è¾¹å¯ä»¥ä½¿é€†åºå¯¹ä¸ªæ•°æœ€å°ï¼Œä¸ºå¤šå°‘ã€‚\nè€ƒè™‘æˆ‘ä»¬åˆå¹¶åˆ°ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå…¶æƒå€¼èŒƒå›´ä¸º $[l,r]$ ï¼Œä¸­ç‚¹ä¸º $mid$ ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬æœ‰ä¸¤æ£µæ ‘ï¼Œæˆ‘ä»¬è¦åˆ†åˆ«è®¡ç®—å‡ºæŸæ£µæ ‘åœ¨å·¦è¾¹çš„æ—¶å€™å’ŒæŸæ£µæ ‘åœ¨å³è¾¹çš„æ—¶å€™çš„é€†åºå¯¹ä¸ªæ•°ã€‚äº‹å®ä¸Šæˆ‘ä»¬åªéœ€è¦å¤„ç†æƒå€¼è·¨è¿‡ä¸­ç‚¹ $mid$ çš„é€†åºå¯¹ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„é€†åºå¯¹éƒ½ä¼šåœ¨é€’å½’è¿‡ç¨‹ä¸­è¢«å¤„ç†ä»…ä¸€æ¬¡ï¼ˆç±»ä¼¼ä¸€ä¸ªåˆ†æ²»çš„è¿‡ç¨‹ï¼‰ã€‚è€Œæˆ‘ä»¬è¿™ä¸ªæ—¶å€™å¯ä»¥è½»æ˜“çš„ç®—å‡ºä¸¤ç§æƒ…å†µçš„é€†åºå¯¹ä¸ªæ•°ï¼Œä¸äº¤æ¢çš„è¯æ˜¯å·¦è¾¹é‚£æ£µæ ‘çš„å³åŠè¾¹ä¹˜ä¸Šå·¦è¾¹é‚£æ£µæ ‘çš„çš„å³åŠè¾¹çš„å¤§å°ï¼›äº¤æ¢çš„è¯åˆ™æ˜¯å·¦è¾¹é‚£æ£µæ ‘çš„å·¦åŠè¾¹ä¹˜ä¸Šå·¦è¾¹é‚£æ£µæ ‘çš„çš„å·¦åŠè¾¹çš„å¤§å°ã€‚\nç„¶åæ¯æ¬¡åˆå¹¶ç”±äºéƒ½å¯ä»¥äº¤æ¢å·¦å³å­æ ‘ï¼Œæˆ‘ä»¬å°±æŠŠè¿™æ¬¡åˆå¹¶ä¸­äº¤æ¢å’Œä¸äº¤æ¢çš„æƒ…å†µè®¡ç®—ä¸€ä¸‹ï¼Œå–æœ€å°å€¼ç´¯ç§¯å°±å¯ä»¥äº†ã€‚\nç©ºé—´å¤æ‚åº¦ï¼š$O(n \\log n)$ ï¼Œæ—¶é—´å¤æ‚åº¦ $O(n \\log n)$ ã€‚\nå¦ï¼Œæ´›è°·ä¸Šè¿™é¢˜æ•°æ®æå¼±ï¼ŒLOJä¸Šçš„æ•°æ®å°±å¾ˆå¼ºï¼Œçº¿æ®µæ ‘åˆå¹¶å¡è¿‡å»ç•¥å¾®è´¹åŠ²ï¼Œå¯ä»¥ä½“éªŒä¸€ä¸‹ä¸æ–­ $TLE$ çš„æ„Ÿè§‰qwqã€‚\nå¦å¦ï¼Œè¿™é“é¢˜çš„è¯»å…¥å¾ˆè¿·ï¼Œé™„ä¸Šä¸€ç‚¹äººè¯ï¼š\n ç¬¬ä¸€è¡Œä¸€ä¸ªæ•° $n$ ï¼Œè¡¨ç¤ºè¯¥äºŒå‰æ ‘çš„å¶èŠ‚ç‚¹çš„ä¸ªæ•°ï¼›\nä¸‹é¢è‹¥å¹²è¡Œï¼Œæ¯è¡Œä¸€ä¸ªæ•° $x$ ï¼š\nå¦‚æœ $x = 0$ ï¼Œè¡¨ç¤ºè¿™ä¸ªèŠ‚ç‚¹ä¸æ˜¯å¶èŠ‚ç‚¹ï¼Œé€’å½’åœ°å‘ä¸‹è¯»å…¥å…¶å·¦å­©å­å’Œå³å­©å­çš„ä¿¡æ¯ï¼›\nå¦‚æœ $x \\neq 0$ ï¼Œè¡¨ç¤ºè¿™ä¸ªèŠ‚ç‚¹æ˜¯å¶èŠ‚ç‚¹ï¼Œæƒå€¼ä¸º $x$ ã€‚\n ä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cctype\u0026gt;using namespace std; #define mid ((l+r)\u0026gt;\u0026gt;1) typedef long long ll; inline char read(){ static const int SIZE = 1024*1024; static char *s,*t,ibuf[SIZE]; if(s == t) t = (s=ibuf) + fread(ibuf,1,SIZE,stdin); return s == t ? -1:(*s++); } template\u0026lt;typename T\u0026gt; inline void read(T \u0026amp;x){ static bool iosig = 0;static char ch; for(ch = read(),iosig = 0;!isdigit(ch);ch = read()){ if(ch == -1) return; if(ch ==\u0026#39;-\u0026#39;) iosig = 1; } for(x = 0;isdigit(ch);ch =read()) x = (((x\u0026lt;\u0026lt;2)+x)\u0026lt;\u0026lt;1) + (ch^48); if(iosig) x = -x; } inline ll min(ll a,ll b){ return a \u0026gt; b?b : a; } const int MAXN = 210000; ll ANS = 0,ans1 = 0,ans2 = 0; int n,pos; struct node{ int sumn,ls,rs; }aa[MAXN*30]; int cnt = 0; void update(int \u0026amp;nown,int l,int r){ if(!nown) nown = ++cnt; aa[nown].sumn++; if(l == r) return; if(pos \u0026lt;= mid) update(aa[nown].ls,l,mid); else update(aa[nown].rs,mid+1,r); } void merge(int \u0026amp;lx,int rx){ if(!lx || !rx){lx=lx+rx;return;} aa[lx].sumn += aa[rx].sumn; ans1 += (ll)aa[aa[lx].rs].sumn*aa[aa[rx].ls].sumn; ans2 += (ll)aa[aa[lx].ls].sumn*aa[aa[rx].rs].sumn; merge(aa[lx].ls,aa[rx].ls); merge(aa[lx].rs,aa[rx].rs); } void solve(int \u0026amp;x){ int t,ls,rs;x = 0; read(t); if(!t){ solve(ls),solve(rs); ans1 = ans2 = 0; x = ls;merge(x,rs); ANS += min(ans1,ans2); } else pos = t,update(x,1,n); } signed main(){ read(n); int t = 0; solve(t); printf(\u0026#34;%lld\\n\u0026#34;,ANS); return 0; }   ","description":"","id":143,"section":"posts","tags":["æ•°æ®ç»“æ„","çº¿æ®µæ ‘","æ ‘å½¢ç»“æ„","çº¿æ®µæ ‘åˆå¹¶"],"title":"ã€ŒPOI2011ã€Tree Rotations-çº¿æ®µæ ‘åˆå¹¶","uri":"https://blog.chenqiqian.com/posts/poi2011-tree-rotations/"},{"content":"æœ‰ $m$ ä¸ªéª‘å£«æ”»å  $n$ ä¸ªåŸæ± ã€‚é™¤ $1$ å·åŸæ± å¤–ï¼ŒåŸæ±  $i$ ä¼šå—åˆ°å¦ä¸€åº§åŸæ±  $f_i$ çš„ç®¡è¾–ï¼Œå…¶ä¸­ $f_i \u0026lt; i$ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ‰€æœ‰åŸæ± æ„æˆäº†ä¸€æ£µæœ‰æ ¹æ ‘ã€‚ç¬¬ $i$ ä¸ªéª‘å£«çš„åˆå§‹æˆ˜æ–—åŠ›ä¸º $s_i$ï¼Œç¬¬ä¸€ä¸ªæ”»å‡»çš„åŸæ± ä¸º $c_i$ã€‚\næ¯ä¸ªåŸæ± æœ‰ä¸€ä¸ªé˜²å¾¡å€¼ $h_i$ï¼Œå¦‚æœä¸€ä¸ªéª‘å£«çš„æˆ˜æ–—åŠ›å¤§äºç­‰äºåŸæ± çš„ç”Ÿå‘½å€¼ï¼Œé‚£ä¹ˆéª‘å£«å°±å¯ä»¥å é¢†è¿™åº§åŸæ± ï¼›å¦åˆ™å é¢†å¤±è´¥ï¼Œéª‘å£«å°†åœ¨è¿™åº§åŸæ± ç‰ºç‰²ã€‚å é¢†ä¸€ä¸ªåŸæ± ä»¥åï¼Œéª‘å£«çš„æˆ˜æ–—åŠ›å°†å‘ç”Ÿå˜åŒ–ï¼Œç„¶åç»§ç»­æ”»å‡»ç®¡è¾–è¿™åº§åŸæ± çš„åŸæ± ï¼Œç›´åˆ°å é¢† $1$ å·åŸæ± ï¼Œæˆ–ç‰ºç‰²ä¸ºæ­¢ã€‚\né™¤ $1$ å·åŸæ± å¤–ï¼Œæ¯ä¸ªåŸæ±  $i$ ä¼šç»™å‡ºä¸€ä¸ªæˆ˜æ–—åŠ›å˜åŒ–å‚æ•° $a_i$;$v_i$ã€‚è‹¥ $a_i = 0$ï¼Œæ”»å åŸæ±  $i$ ä»¥åéª‘å£«æˆ˜æ–—åŠ›ä¼šå¢åŠ  $v_i$ï¼›è‹¥ $a_i = 1$ï¼Œæ”»å åŸæ±  $i$ ä»¥åï¼Œæˆ˜æ–—åŠ›ä¼šä¹˜ä»¥ $v_i$ã€‚æ³¨æ„æ¯ä¸ªéª‘å£«æ˜¯å•ç‹¬è®¡ç®—çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªéª‘å£«æ”»å‡»ä¸€åº§åŸæ± ï¼Œä¸ç®¡ç»“æœå¦‚ä½•ï¼Œå‡ä¸ä¼šå½±å“å…¶ä»–éª‘å£«æ”»å‡»è¿™åº§åŸæ± çš„ç»“æœã€‚\nå¯¹äºæ¯ä¸ªåŸæ± ï¼Œè¾“å‡ºæœ‰å¤šå°‘ä¸ªéª‘å£«åœ¨è¿™é‡Œç‰ºç‰²ï¼›å¯¹äºæ¯ä¸ªéª‘å£«ï¼Œè¾“å‡ºä»–æ”»å çš„åŸæ± æ•°é‡ã€‚\né“¾æ¥ Luogu P3261\né¢˜è§£ è¿™ä¸ªé—®é¢˜æ˜¯å¯ä»¥ç¦»çº¿çš„ï¼Œæˆ‘ä»¬ä¸éœ€è¦åœ¨çº¿çš„å›ç­”æ¯ä¸€ä¸ªéª‘å£«çš„é—®é¢˜ã€‚\næ‰€ä»¥æˆ‘ä»¬æ€è€ƒå¦‚ä½•å¯¹äºè¿™ä¸ªé—®é¢˜è¿›è¡Œå¤„ç†ã€‚\nè€ƒè™‘æ‰€æœ‰åˆ°è¾¾æŸä¸ªèŠ‚ç‚¹çš„äººã€‚åœ¨è¿™äº›äººä¸­ï¼Œéƒ½ä¼šæœ‰ä¸€äº›æ”»å‡»åŠ›æœ€å°çš„äººåœ¨è¿™ä¸ªèŠ‚ç‚¹æ­»æ‰ã€‚è¿™ä¸ªæ—¶å€™å‰©ä¸‹çš„äººçš„æ”»å‡»åŠ›çš„å¤§å°å…³ç³»å¹¶ä¸ä¼šæ”¹å˜ã€‚\næ‰€ä»¥æˆ‘ä»¬æœ‰ä¸¤ä¸ªé€‰æ‹©ï¼šå¹³è¡¡æ ‘ã€å †ã€‚\nè¿™ä¸ªæ—¶å€™æˆ‘ä»¬æ€è€ƒä¸€ä¸‹å¯¹äºæ‰€æœ‰ä¸‹é¢æ´»ç€çš„äººå¦‚ä½•å†æ”»å‡»ä¸Šé¢çš„åŸæ± ã€‚è¿™ä¸ªæ—¶å€™å…¶å®å°±æ˜¯æ‰€æœ‰æŸä¸ªèŠ‚ç‚¹æ‰€æœ‰çš„å­èŠ‚ç‚¹çš„æ´»ç€çš„äººåˆå¹¶åˆ°ä¸€èµ·ã€‚ç”¨å¯å‘å¼åˆå¹¶çš„è¯ï¼Œå¤æ‚åº¦æ˜¯$O(n \\log^2 n)$ï¼Œå¦‚æœç”¨å·¦åæ ‘çš„è¯ï¼Œå¤æ‚åº¦å°±æ˜¯$O(n \\log n)$ã€‚\nåœ¨æœ€ä¸Šé¢æ·»åŠ ä¸€ä¸ªè™šæ‹Ÿçš„èŠ‚ç‚¹æŠŠæ‰€æœ‰äººéƒ½ç‰ºç‰²äº†å°±å¥½ã€‚\nè¿™é‡Œçš„åŠ æ³•å’Œä¹˜æ³•ç±»ä¼¼çº¿æ®µæ ‘ï¼Œç»´æŠ¤lazyæ ‡è®°ä¸‹ä¼ å³å¯ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cctype\u0026gt;#include \u0026lt;algorithm\u0026gt;#include \u0026lt;cstring\u0026gt;#include \u0026lt;vector\u0026gt;typedef long long ll; using namespace std; namespace fast_io{ //... }using namespace fast_io; const int MAXN = 310000; namespace MH{ int l[MAXN],r[MAXN],d[MAXN]; ll v[MAXN],addn[MAXN],muln[MAXN]; inline void add(int x,ll val){ if(!x) return; v[x]+=val,addn[x]+=val; } inline void mul(int x,ll val){ if(!x) return; v[x]*=val,addn[x]*=val,muln[x] *= val; } inline void push_down(int x){ if(!x) return; if(muln[x]!=1){ mul(l[x],muln[x]),mul(r[x],muln[x]); muln[x] = 1; } if(addn[x]){ add(l[x],addn[x]),add(r[x],addn[x]); addn[x] = 0; } } inline int merge(int x,int y){ if(x == y) return x; if(!x || !y) return x+y; if(v[x] \u0026gt; v[y]) swap(x,y); push_down(x); r[x] = merge(r[x],y); if(d[l[x]] \u0026lt; d[r[x]]) swap(l[x],r[x]); d[x] = d[r[x]] + 1; return x; } inline ll top(int x){ return v[x]; } inline int del(int x){ push_down(x); int t = merge(l[x],r[x]); l[x] = r[x] = d[x] = 0; return t; } inline void init(int n,ll *num){ for(int i = 1;i\u0026lt;=n;i++) v[i] = num[i],l[i] = r[i] = d[i] = addn[i] = 0,muln[i] = 1; } } int n,m,root; ll h[MAXN]; int f[MAXN],a[MAXN];ll v[MAXN]; ll s[MAXN];int c[MAXN],dep[MAXN]; int ans1[MAXN],ans2[MAXN]; vector\u0026lt;int\u0026gt; edge[MAXN]; vector\u0026lt;int\u0026gt; st[MAXN]; void init(){ read(n),read(m); for(int i = 1;i\u0026lt;=n;i++) read(h[i]); for(int i = 2;i\u0026lt;=n;i++){ read(f[i]),read(a[i]),read(v[i]); edge[f[i]].push_back(i); } for(int i = 1;i\u0026lt;=m;i++){ read(s[i]),read(c[i]); st[c[i]].push_back(i); } root = m+1; edge[root].push_back(1); h[root] = (long long)(1e18); MH::init(m,s); } int dfs(int nown){ int ans = 0,tmp = 0; for(int i = 0;i \u0026lt; edge[nown].size();i++){ int v = edge[nown][i]; dep[v] = dep[nown] + 1; tmp = dfs(v); ans = MH::merge(ans,tmp); } for(int i = 0;i\u0026lt;st[nown].size();i++) ans = MH::merge(st[nown][i],ans); while(MH::top(ans) \u0026lt; h[nown] \u0026amp;\u0026amp; ans!=0){ ans1[nown]++; tmp = ans; ans2[tmp] = dep[c[tmp]] - dep[nown]; ans = MH::del(ans); } if(a[nown] == 0) MH::add(ans,v[nown]); else if(a[nown] == 1) MH::mul(ans,v[nown]); return ans; } void output(){ for(int i = 1;i\u0026lt;=n;i++) print(ans1[i]),print(\u0026#39;\\n\u0026#39;); for(int i = 1;i\u0026lt;=m;i++) print(ans2[i]),print(\u0026#39;\\n\u0026#39;); } signed main(){ init(); dfs(root); output(); flush(); return 0; }   ","description":"","id":144,"section":"posts","tags":["å·¦åæ ‘","æ•°æ®ç»“æ„"],"title":"ã€ŒJLOI2015ã€åŸæ± æ”»å -å·¦åæ ‘","uri":"https://blog.chenqiqian.com/posts/jloi2015-fail/"},{"content":"ç»™å®šä¸€æ£µæœ‰æ ¹æ ‘ï¼Œæ¯ä¸ªç‚¹æœ‰ä¸€ä¸ªä»£ä»· $C_i$ ï¼Œæƒå€¼ $L_i$ ï¼Œè¦æ±‚ä»è¿™ä¸ªæ ‘æŸä¸ªèŠ‚ç‚¹ $k$ çš„å­æ ‘ï¼ˆåŒ…å«è¯¥èŠ‚ç‚¹ï¼‰é€‰å–è‹¥å¹²ä¸ªèŠ‚ç‚¹ï¼Œä½¿å¾—é€‰å–èŠ‚ç‚¹çš„ä¸ªæ•°ä¹˜ä¸ŠèŠ‚ç‚¹ $k$ çš„æƒå€¼æœ€å¤§ï¼Œä¸”è¿™è‹¥å¹²ä¸ªèŠ‚ç‚¹çš„ä»£ä»·å’Œä¸è¶…è¿‡ç»™å®šçš„é™åˆ¶ $M$ ã€‚\né“¾æ¥ Luogu P1552\né¢˜è§£ å¯ä»¥ç”¨ä¸€å®šçš„è´ªå¿ƒçš„æ€æƒ³ã€‚\nå¦‚æœç¡®å®šäº†ä¸€ä¸ªæ ¹ç»“ç‚¹ $k$ ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„é—®é¢˜å°±è½¬åŒ–æˆåœ¨ $M$ çš„é™åˆ¶å†…ï¼Œå–æœ€å¤šçš„èŠ‚ç‚¹ã€‚\nå¯¹äºæ¯ä¸ªèŠ‚ç‚¹ï¼Œå¦‚æœæˆ‘ä»¬çŸ¥é“å®ƒçš„å­èŠ‚ç‚¹çš„æœ€ä¼˜çš„æ»¡è¶³ $M$ çš„é™åˆ¶çš„è‹¥å¹²èŠ‚ç‚¹ï¼Œé‚£ä¹ˆå¯ä»¥è¯æ˜åˆå¹¶ä¹‹åçš„æ‰€æœ‰æœ€ä¼˜èŠ‚ç‚¹è‚¯å®šéƒ½åªä¼šæ¥è‡ªäºå­èŠ‚ç‚¹çš„æœ€ä¼˜èŠ‚ç‚¹ã€‚è¿™æ˜¯éå¸¸æ˜¾ç„¶çš„ã€‚\næ‰€ä»¥æˆ‘ä»¬ç”¨å·¦åæ ‘ï¼ˆå¤§æ ¹å †ï¼‰åˆå¹¶ï¼Œå¯¹äºæ¯ä¸ªèŠ‚ç‚¹ pop æ‰æœ€å¤§çš„è‹¥å¹²ä¸ªèŠ‚ç‚¹ä½¿å…¶ç¬¦åˆé™åˆ¶ï¼Œç„¶åå°è¯•æ›´æ–°ç­”æ¡ˆã€‚\nç„¶åå­æ ‘åˆå¹¶å¾—åˆ°æ ¹ç»“ç‚¹çš„æƒ…å†µï¼Œdfså¤„ç†å³å¯ã€‚\næœ€åæ—¶é—´å¤æ‚åº¦å¤§æ¦‚æ˜¯ $O(n \\log n)$ ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;algorithm\u0026gt;#include \u0026lt;cstring\u0026gt;#include \u0026lt;vector\u0026gt;using namespace std; typedef long long ll; const int MAXN = 200000; namespace MH{ ll v[MAXN],sum[MAXN],siz[MAXN]; int l[MAXN],r[MAXN],d[MAXN]; void push_up(int x){ if(!x) return; sum[x] = sum[l[x]] + v[x] + sum[r[x]]; siz[x] = siz[l[x]] + 1 + siz[r[x]]; } int merge(int x,int y){ if(x == y) return x; if(!x || !y) return x+y; if(v[x] \u0026lt; v[y]) swap(x,y); r[x] = merge(r[x],y); if(d[l[x]] \u0026lt; d[r[x]]) swap(l[x],r[x]); d[x] = d[r[x]] + 1; push_up(x); return x; } int del(int x){ int t = merge(l[x],r[x]); sum[x] = v[x],l[x] = r[x] = d[x] = 0; return t; } ll top(int x){ return v[x]; } void init(int n,ll *num){ for(int i = 1;i\u0026lt;=n;i++){ v[i] = sum[i] = num[i],siz[i] = 1,l[i] = r[i] = d[i] = 0; } } void print(int n){ printf(\u0026#34;----------------------\\n\u0026#34;); for(int i = 1;i\u0026lt;=n;i++){ printf(\u0026#34;%d: v:%lld sum:%lld siz:%lld son:%d %d d:%d\\n\u0026#34;,i,v[i],sum[i],siz[i],l[i],r[i],d[i]); } printf(\u0026#34;----------------------\\n\u0026#34;); } } int n,m,root; ll fans; vector\u0026lt;int\u0026gt; edge[MAXN]; int f[MAXN];ll s[MAXN], l[MAXN]; void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m); root = n + 1; for(int i = 1;i\u0026lt;=n;i++){ scanf(\u0026#34;%d %lld %lld\u0026#34;,\u0026amp;f[i],\u0026amp;s[i],\u0026amp;l[i]); if(f[i] == 0) f[i] = root; } for(int i = 1;i\u0026lt;=n;i++) edge[f[i]].push_back(i); fans = -1; MH::init(n,s); } int dfs(int x){ int ans = x,tmp; for(int i = 0;i\u0026lt;edge[x].size();i++){ int v = edge[x][i]; tmp = dfs(v); ans = MH::merge(ans,tmp); } while(MH::sum[ans] \u0026gt; m \u0026amp;\u0026amp; ans!=0) ans = MH::del(ans); fans = max(fans,l[x] * MH::siz[ans]); return ans; } int main(){ init(); dfs(root); printf(\u0026#34;%lld\\n\u0026#34;,fans); return 0; }   ","description":"","id":145,"section":"posts","tags":["å·¦åæ ‘","æ•°æ®ç»“æ„"],"title":"ã€ŒAPIO2012ã€æ´¾é£-å·¦åæ ‘","uri":"https://blog.chenqiqian.com/posts/apio2012-dispatching/"},{"content":"å·¦åæ ‘æ˜¯ä¸€ç§ä»¥äºŒå‰æ ‘ä¸ºåŸºç¡€çš„æ•°æ®ç»“æ„ï¼Œå¯ä»¥ç”¨æ¥å®ç°å¯ä»¥åœ¨$O(\\log n)$æ—¶é—´å†…åˆå¹¶çš„å †ã€‚\nå®šä¹‰ å·¦åæ ‘æ˜¯ä¸€é¢—äºŒå‰æ ‘, æ¯ä¸ªèŠ‚ç‚¹å…·æœ‰å››ä¸ªå±æ€§: å·¦å„¿å­ ($lc$), å³å„¿å­($rc$), é”®å€¼ ($key$), è·ç¦» ($dis$)ã€‚\nå·¦åæ ‘è¦æ±‚æ»¡è¶³å·¦å³å„¿å­çš„é”®å€¼ä¸å°äºè¯¥èŠ‚ç‚¹çš„é”®å€¼ (å°æ ¹å †æ—¶)ã€‚ èŠ‚ç‚¹ $i$ çš„è·ç¦»æŒ‡çš„æ˜¯ä»èŠ‚ç‚¹ $i$ å¾€ä¸‹èµ°, æœ€çŸ­çš„èƒ½èµ°åˆ°å¤–èŠ‚ç‚¹çš„è·¯å¾„é•¿åº¦ã€‚\nè¿™é‡Œçš„å¤–èŠ‚ç‚¹æŒ‡çš„æ˜¯ä¸¤ä¸ªå„¿å­ä¸æ˜¯å‡å­˜åœ¨çš„èŠ‚ç‚¹ã€‚\næ€§è´¨ æ€§è´¨1 å¯ä»¥å‘ç°ä¸€ä¸ªèŠ‚ç‚¹ $i$ çš„è·ç¦»ç­‰äºä»¥èŠ‚ç‚¹ $i$ ä¸ºæ ¹çš„å­æ ‘çš„æœ€å³è·¯å¾„çš„\né•¿åº¦ã€‚\nè¯æ˜ï¼šé€’å½’è¯æ˜å³å¯ã€‚\næ€§è´¨2 å¦‚æœä¸€é¢—å·¦åæ ‘æœ‰ $n$ ä¸ªèŠ‚ç‚¹, åˆ™è¯¥å·¦åæ ‘çš„è·ç¦»ä¸ä¼šè¶…è¿‡\n$âŒŠlog(n + 1)âŒ‹ âˆ’ 1$ã€‚\nè¯æ˜ï¼šå› ä¸ºä¸Šé¢çš„$dis$å±‚éƒ½éœ€è¦å¡«æ»¡ï¼Œæ‰€ä»¥è·ç¦»å¿…é¡»è¦å°äº$\\log n$ã€‚\nå®ç° åˆå¹¶ è¿™ä¸ªæ“ä½œæ˜¯å·¦åæ ‘çš„æ ¸å¿ƒã€‚\næˆ‘ä»¬ç”¨$u$å’Œ$v$ä»£è¡¨æˆ‘ä»¬éœ€è¦åˆå¹¶çš„ä¸¤é¢—å·¦åæ ‘çš„æ ¹èŠ‚ç‚¹ã€‚\nä»¤$u.key \u0026lt; v.key$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å…ˆåˆå¹¶$u.rc$å’Œ$v$ï¼Œå°†å…¶ä½œä¸º$u$çš„å³èŠ‚ç‚¹ï¼Œç„¶åæ£€æŸ¥$u.lc.dis$å’Œ$u.rc.dis$çš„å¤§å°å…³ç³»å¹¶æ£€æŸ¥æ˜¯å¦æ»¡è¶³å·¦åæ ‘æ€§è´¨ï¼Œç„¶åå†æ›´æ–°æ ¹ç»“ç‚¹çš„$u.dis = u.rc.dis + 1$ã€‚\nå¤æ‚åº¦çš„è¯ï¼Œæ¯æ¬¡åˆå¹¶çš„æ—¶å€™è‡³å°‘æœ‰ä¸€æ£µå­æ ‘çš„$dis$æ¶ˆå‡$1$ï¼Œæ€»å…±çš„$dis$æ˜¯åœ¨$\\log n$çº§åˆ«çš„ï¼Œæ‰€ä»¥å¤æ‚åº¦ä¹Ÿå°±æ˜¯$O(\\log n)$ã€‚\næ’å…¥ åˆå¹¶ä¸€ä¸ªèŠ‚ç‚¹å’Œä¸€é¢—å·¦åæ ‘å³å¯ã€‚\næœ€å€¼ ç›´æ¥å–æ ¹èŠ‚ç‚¹çš„å€¼å³å¯ã€‚\nåˆ é™¤æœ€å€¼ åˆå¹¶æ ¹èŠ‚ç‚¹çš„å·¦å³å­æ ‘å³å¯ã€‚\nå¤æ‚åº¦ ä¸€äº›å¤æ‚åº¦ï¼š\n å»ºå †ï¼š$O(n)$ æ’å…¥ä¸€ä¸ªèŠ‚ç‚¹ï¼š$O(\\log n)$ æŸ¥è¯¢æœ€å€¼ï¼š$O(1)$ åˆ é™¤æœ€å€¼ï¼š$O(\\log n)$ åˆ é™¤ä»»æ„èŠ‚ç‚¹ï¼šæœ€å$O(n)$ï¼Œä¸€èˆ¬$O(\\log n)$(å­˜ç–‘) åˆå¹¶ä¸¤ä¸ªå †ï¼š$O(\\log n)$  ä¸€äº›äº‹æƒ…ï¼š\nå·¦åæ ‘çš„æ·±åº¦æ˜¯å¯ä»¥åˆ°$O(n)$çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æŸ¥è¯¢ä¸€ä¸ªç‚¹æ‰€å±çš„å †åº”è¯¥è¦å†ç”¨ä¸€ä¸ªå¹¶æŸ¥é›†ç»´æŠ¤æ¯ä¸ªèŠ‚ç‚¹å¯¹åº”çš„æœ€å€¼ç‚¹ï¼ˆæ ¹èŠ‚ç‚¹ï¼‰ï¼Œå¤æ‚åº¦æ‰æ˜¯æ­£ç¡®çš„ã€‚ï¼ˆä¸‹é¢çš„è¿˜æ²¡æœ‰æ”¹ï¼‰\nä»£ç  ä»¥Luogu P3377ã€æ¨¡æ¿ã€‘å·¦åæ ‘ï¼ˆå¯å¹¶å †ï¼‰ä¸ºä¾‹ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80  // luogu-judger-enable-o2 #include \u0026lt;cstdio\u0026gt;#include \u0026lt;algorithm\u0026gt;#include \u0026lt;cctype\u0026gt;using namespace std; namespace fast_io { // ... }using namespace fast_io; const int MAXN = 500000; namespace Merge_Heap{ int v[MAXN],l[MAXN],r[MAXN],d[MAXN],f[MAXN]; bool vis[MAXN]; int __merge(int x,int y){ if(x == y) return x; if(!x || !y) return x+y; if(v[x] \u0026gt; v[y] || (v[x] == v[y] \u0026amp;\u0026amp; x \u0026gt; y)) swap(x,y); r[x] = __merge(r[x],y); f[r[x]] = x;// ç»´æŠ¤çˆ¶äº²  if(d[l[x]] \u0026lt; d[r[x]]) swap(l[x],r[x]); d[x] = d[r[x]] + 1; return x; } int __pop(int x){ f[l[x]] = f[r[x]] = 0; int t = __merge(l[x],r[x]); l[x] = r[x] = 0; return t; } int __find(int x){ while(f[x]) x = f[x]; return x; } void init(int n,int *num){ for(int i = 1;i\u0026lt;=n;i++) v[i] = num[i]; } void merge(int x,int y){ if(vis[x]||vis[y]) return; __merge(__find(x),__find(y)); } int pop(int x){ if(vis[x]) return -1; int w = __find(x); vis[w] = 1; __pop(w); return v[w]; } } int n,m,num[MAXN]; void init(){ read(n),read(m); for(int i = 1;i\u0026lt;=n;i++) read(num[i]); Merge_Heap::init(n,num); } void solve(){ int op,x,y; for(int i = 1;i\u0026lt;=m;i++){ read(op),read(x); if(op == 1) read(y),Merge_Heap::merge(x,y); else if(op == 2) print(Merge_Heap::pop(x)),print(\u0026#39;\\n\u0026#39;); } } int main(){ init(); solve(); flush(); return 0; }   åº”ç”¨ ä¸»è¦å°±æ˜¯å¯å¹¶å †å˜›ã€‚\nã€ŒJLOI2015ã€åŸæ± æ”»å -å·¦åæ ‘\nã€ŒAPIO2012ã€æ´¾é£-å·¦åæ ‘\n","description":"","id":146,"section":"posts","tags":["å·¦åæ ‘","æ•°æ®ç»“æ„","æ¨¡æ¿"],"title":"å·¦åæ ‘å­¦ä¹ ç¬”è®°","uri":"https://blog.chenqiqian.com/posts/notes-leftist-tree/"},{"content":"ä¸€ä¸ªæ— å‘è¿é€šå›¾ï¼Œé¡¶ç‚¹ä» $1$ ç¼–å·åˆ° $N$ ï¼Œè¾¹ä» $1$ ç¼–å·åˆ° $M$ ã€‚ å° Z åœ¨è¯¥å›¾ä¸Šè¿›è¡Œéšæœºæ¸¸èµ°ï¼Œåˆå§‹æ—¶å° Z åœ¨ $1$ å·é¡¶ç‚¹ï¼Œæ¯ä¸€æ­¥å° Z ä»¥ç›¸ç­‰çš„æ¦‚ç‡éšæœºé€‰ æ‹©å½“å‰é¡¶ç‚¹çš„æŸæ¡è¾¹ï¼Œæ²¿ç€è¿™æ¡è¾¹èµ°åˆ°ä¸‹ä¸€ä¸ªé¡¶ç‚¹ï¼Œè·å¾—ç­‰äºè¿™æ¡è¾¹çš„ç¼–å·çš„åˆ†æ•°ã€‚å½“å° Z åˆ°è¾¾ N å·é¡¶ç‚¹æ—¶æ¸¸èµ°ç»“æŸï¼Œæ€»åˆ†ä¸ºæ‰€æœ‰è·å¾—çš„åˆ†æ•°ä¹‹å’Œã€‚ ç°åœ¨ï¼Œè¯·ä½ å¯¹è¿™ $M$ æ¡è¾¹è¿›è¡Œç¼–å·ï¼Œä½¿å¾—å° Z è·å¾—çš„æ€»åˆ†çš„æœŸæœ›å€¼æœ€å°ã€‚\né“¾æ¥ Luogu P3232\né¢˜è§£ æ³¨æ„åˆ°å› ä¸ºå›¾æ˜¯ç»™å®šçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡ç®—å‡ºæ¯ä¸ªç‚¹æœŸæœ›ç»è¿‡çš„æ¬¡æ•°å†æ¨å‡ºæ¯ä¸ªè¾¹ç»è¿‡çš„æœŸæœ›æ¬¡æ•°ã€‚\nå› ä¸ºåœ¨æ¯ä¸ªç‚¹é€‰å®šæ¯æ¡è¾¹çš„æ¦‚ç‡æ˜¯ç›¸åŒçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ‰ä»¥ä¸‹æœŸæœ›æ–¹ç¨‹ï¼Œè®¾ç¬¬ $i$ ä¸ªç‚¹æœŸæœ›ç»è¿‡æ¬¡æ•°ä¸º $e1_i$ ï¼Œåº¦æ•°ä¸º $d_i$ ï¼Œç¬¬ $i$ æ¡è¾¹æœŸæœ›ç»è¿‡æ¬¡æ•°ä¸º $e2_i$ ï¼š\n$$\ne1_i = \\sum_{j} \\frac{e1_j}{d_j},\\text{(i,j) has a edge}\n$$\né‚£ä¹ˆç¬¬ $i$ æ¡è¾¹ $(u,v)$ çš„ç»è¿‡æ¬¡æ•°çš„æœŸæœ›å°±æ˜¯ï¼š\n$$\ne2_i = \\frac{e1_u}{d_u} + \\frac{e1_v}{d_v}\n$$\nå…¶ä¸­æœ‰ä¸€äº›ç‰¹æ®Šå¤„ç†ï¼Œå› ä¸ºå¼€å§‹ä¸€å®šä¼šç»è¿‡ä¸€æ¬¡ 1 èŠ‚ç‚¹ï¼Œå¯ä»¥ç†è§£æˆèµ·ç‚¹åˆ° 1 å·èŠ‚ç‚¹åªæœ‰ä¸€æ¡è¾¹ï¼Œæ‰€ä»¥ï¼š\n$$\ne1_1 = 1+\\sum_{j} \\frac{e1_j}{d_j},\\text{(1,j) has a edge}\n$$\nè€Œä¸”è¿™ä¸ªäººèµ°åˆ° $n$ èŠ‚ç‚¹åä¸ä¼šå†èµ°å›æ¥ï¼Œæ‰€ä»¥ï¼š$e1_n = 0$ã€‚\né«˜æ–¯æ¶ˆå…ƒå³å¯ã€‚\nç„¶åæ’åºè´ªå¿ƒå°±å¯ä»¥äº†ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cmath\u0026gt;#include \u0026lt;vector\u0026gt;#include \u0026lt;algorithm\u0026gt;using namespace std; const int MAXN = 600; const double eps = 1e-8; int n,m,in[MAXN]; vector\u0026lt;int\u0026gt; edge[MAXN]; struct Edge{ int from,to; double c; bool operator \u0026lt; (const Edge \u0026amp;a)const{ return c \u0026gt; a.c; } }edgea[MAXN*MAXN]; bool gauss(double a[MAXN][MAXN],int n){ for(int i = 1;i\u0026lt;=n;i++){ int r = i; for(int j = i+1;j\u0026lt;=n;j++) if(fabs(a[j][i]) \u0026gt; fabs(a[r][i])) r = j; if(r!=i) for(int j = 1;j\u0026lt;=n+1;j++) swap(a[r][j],a[i][j]); if(fabs(a[i][i]) \u0026lt; eps) return false; for(int j = 1;j\u0026lt;=n;j++)if(j!=i){ double t = a[j][i]/a[i][i]; for(int k = 1;k\u0026lt;=n+1;k++) a[j][k] -= a[i][k] * t; } } for(int i = 1;i\u0026lt;=n;i++) a[i][n+1]/=a[i][i]; return true; } void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m); int a,b; for(int i = 1;i\u0026lt;=m;i++){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;a,\u0026amp;b);\tedge[a].push_back(b); edge[b].push_back(a); in[a]++,in[b]++; edgea[i] = (Edge){a,b,double(0)}; } } void solve(){ //a_u -\u0026gt; ç‚¹uæœŸæœ›æ¬¡æ•°  static double a[MAXN][MAXN]; for(int u = 1;u\u0026lt;n;u++){ a[u][u] = 1; for(int i = 0;i\u0026lt;edge[u].size();i++){ int v = edge[u][i]; if(v == n) continue; a[u][v] = -1 / double(in[v]); } } a[1][n] = 1;//å¾ˆé‡è¦ï¼å¯¹1çš„ç‰¹æ®Šå¤„ç†  static double c[MAXN]; gauss(a,n-1); for(int i = 1;i\u0026lt;=n-1;i++) c[i] = a[i][n]; for(int i = 1;i\u0026lt;=m;i++){ int u = edgea[i].from,v = edgea[i].to; edgea[i].c = c[u]/in[u]+c[v]/in[v]; }//è®¡ç®—è¾¹çš„æœŸæœ›ç»è¿‡æ¬¡æ•°  sort(edgea+1,edgea+m+1); double ans = 0; for(int i = 1;i\u0026lt;=m;i++) ans += edgea[i].c * i; printf(\u0026#34;%.3lf\\n\u0026#34;,ans); } int main(){ init(); solve(); return 0; }   ","description":"","id":147,"section":"posts","tags":["æ•°å­¦","æœŸæœ›","é«˜æ–¯æ¶ˆå…ƒ"],"title":"ã€ŒHNOI2013ã€æ¸¸èµ°-æœŸæœ›æ–¹ç¨‹","uri":"https://blog.chenqiqian.com/posts/hnoi2013-walk/"},{"content":" é¢˜é¢ä»¥å›¾ç‰‡æ˜¾ç¤ºï¼Œè¯·ç‚¹å‡»â€œé˜…è¯»å…¨æ–‡â€æŸ¥çœ‹ã€‚\n é“¾æ¥ Luogu P3830\né¢˜è§£ è¿™é¢˜æœ‰ä¸¤é—®ã€‚\nç¬¬ä¸€é—® å¦‚æœä»¤ $dp[x]$ ä¸ºæœ‰ $x$ ä¸ªå¶èŠ‚ç‚¹çš„æ—¶å€™å¶èŠ‚ç‚¹çš„å¹³å‡æ·±åº¦ï¼Œé‚£ä¹ˆæœ‰å¦‚ä¸‹æ–¹ç¨‹ï¼š\n$$\n\\begin{aligned}{}\ndp[x] \u0026amp;= \\frac{(x-1)dp[x-1] - dp[x-1] + 2 \\times (dp[x-1]+1)}{x}\\\n\u0026amp;=dp[x-1] + \\frac{2}{x}\n\\end{aligned}\n$$\nåˆå§‹ $dp[1] = 0$ ï¼Œ $O(n)$ é€’æ¨æˆ–è€…æä¸€æé€šé¡¹å³å¯qwqã€‚\nç¬¬äºŒé—® æ ‘çš„æ·±åº¦ä¸å¤ªå¥½æã€‚\nå®šç†ï¼š\n$$\nE(x) = \\sum_{i=1}^{+\\infty} P(i \\leq x)\n$$\næ„Ÿæ€§ç†è§£ï¼šå¤§å°ä¸º $x$ çš„å¯èƒ½æ€§å°±ä¼šè¢«ä» $i = 1$ åˆ° $i = x$ ä¸€ç›´ç´¯ç§¯ï¼Œç´¯ç§¯æ­£å¥½å°±æ˜¯ $x$ æ¬¡ï¼Œå°±æ˜¯è¿™ç§å¯èƒ½æ€§çš„å€¼ï¼Œæ‰€ä»¥è¿™ä¸ªå¼å­çš„å€¼å°±æ˜¯æœŸæœ›ã€‚\næ‰€ä»¥æˆ‘ä»¬åªè¦æ±‚å‡ºåœ¨æ ‘çš„å¶èŠ‚ç‚¹æœ‰ $x$ ä¸ªçš„æ—¶å€™ï¼Œæ±‚å‡ºæ ‘çš„æ·±åº¦ $i$ å¤§äº $1$ ï¼Œå¤§äº $2$ ï¼Œ\u0026hellip;ï¼Œä¸€ç›´åˆ°å¤§äº $n-1$ çš„æ¦‚ç‡ï¼Œç„¶åæ±‚å’Œä¹‹åå°±æ˜¯æ ‘çš„æœŸæœ›æ·±åº¦äº†ã€‚\nä»¤ $dp[x][j]$ ä¸ºæœ‰ $x$ ä¸ªå¶èŠ‚ç‚¹æ—¶æ ‘çš„æ·±åº¦å¤§äº $j$ çš„æ¦‚ç‡ï¼Œå› ä¸ºå±•å¼€åœ¨ä¸¤ä¾§æ—¶å®Œå…¨ç­‰æ¦‚ç‡çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ‰å¦‚ä¸‹æ–¹ç¨‹ï¼š\n$$\ndp[x][j] = \\frac{1}{x-1}(\\sum_{i=1}^{x-1} dp[i][j-1] + dp[x-i][j-1] - dp[i][j-1] \\times dp[x-i][j-1])\n$$\nå¾ˆç®€å•çš„å®¹æ–¥ã€‚è½¬ç§»å³å¯ã€‚æ³¨æ„ä¸€ä¸‹è¾¹ç•Œï¼Œå’Œæ ¹ç»“ç‚¹æ·±åº¦ä¸º0å³å¯ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32  #include \u0026lt;cstdio\u0026gt;using namespace std; const int MAXN = 200; double cal(int n,int op){ double ans = 0; if(op == 1) for(int i = 2;i\u0026lt;=n;i++) ans += (2/double(i)); else { static double d[MAXN][MAXN]; for(int i = 1;i\u0026lt;=n;i++) d[i][0] = 1; for(int i = 2;i\u0026lt;=n;i++){ for(int j = 1;j\u0026lt;i;j++){ for(int k = 1;k\u0026lt;=i-1;k++) d[i][j] += d[k][j-1] + d[i-k][j-1]- d[k][j-1] * d[i-k][j-1]; d[i][j] /= (i-1); } } for(int i = 1;i\u0026lt;=n-1;i++)//ä»1å¼€å§‹æšä¸¾  ans += d[n][i]; } return ans; } int main(){ int q,n; scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;q,\u0026amp;n); printf(\u0026#34;%lf\\n\u0026#34;,cal(n,q)); return 0; }   ","description":"","id":148,"section":"posts","tags":["æ•°å­¦","æœŸæœ›","æ ‘å½¢ç»“æ„"],"title":"ã€ŒSHOI2012ã€éšæœºæ ‘-æœŸæœ›dp","uri":"https://blog.chenqiqian.com/posts/shoi2012-tree/"},{"content":"Y901 é«˜é€Ÿå…¬è·¯æ˜¯ä¸€æ¡ç”± $N-1$ æ®µè·¯ä»¥åŠ $N$ ä¸ªæ”¶è´¹ç«™ç»„æˆçš„ä¸œè¥¿å‘çš„é“¾ï¼Œæˆ‘ä»¬æŒ‰ç…§ç”±è¥¿å‘ä¸œçš„é¡ºåºå°†æ”¶è´¹ç«™ä¾æ¬¡ç¼–å·ä¸º $1 \\sim N$ ï¼Œä»æ”¶è´¹ç«™ $i$ è¡Œé©¶åˆ° $i+1$ (æˆ–ä» $i+1$ è¡Œé©¶åˆ° $i$ )éœ€è¦æ”¶å– $V_i$ çš„è´¹ç”¨ã€‚é«˜é€Ÿè·¯åˆšå»ºæˆæ—¶æ‰€æœ‰çš„è·¯æ®µéƒ½æ˜¯å…è´¹çš„ã€‚\næ”¿åºœéƒ¨é—¨æ ¹æ®å®é™…æƒ…å†µï¼Œä¼šä¸å®šæœŸåœ°å¯¹è¿ç»­è·¯æ®µçš„æ”¶è´¹æ ‡å‡†è¿›è¡Œè°ƒæ•´ï¼Œæ ¹æ®æ”¿ç­–æ¶¨ä»·æˆ–é™ä»·ã€‚\næ±‚å¯¹äºç»™å®šçš„ $l,r(l \u0026lt; r)$ ï¼Œåœ¨ç¬¬ $l$ ä¸ªåˆ°ç¬¬ $r$ ä¸ªæ”¶è´¹ç«™é‡Œç­‰æ¦‚ç‡éšæœºå–å‡ºä¸¤ä¸ªä¸åŒçš„æ”¶è´¹ç«™ $a$ å’Œ $b$ ï¼Œé‚£ä¹ˆä» $a$ è¡Œé©¶åˆ° $b$ å°†æœŸæœ›èŠ±è´¹å¤šå°‘è´¹ç”¨å‘¢?\né“¾æ¥ Luogu P2221\né¢˜è§£ ä½äºæŸä¸ªä½ç½®çš„è¾¹åªä¼šè¢«ä¸¤ä¸ªç«¯ç‚¹åˆ†å±…ä¸¤è¾¹çš„è·¯å¾„ç»è¿‡ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥æš´åŠ›æ¨å¼å­qwqï¼š\n$$\n\\begin{aligned}{}\nE(l,r) \u0026amp;= \\frac{1}{(r-l-1)(r-l)}\\sum_{i = l}^{r-1}(i-l+1)(r-i)V_i\\\n\u0026amp;= \\frac{1}{(r-l-1)(r-l)}\\sum_{i = l}^{r-1}[-i^2 V_i-(l+r-1)i V_i - r(l-1)V_i]\n\\end{aligned}\n$$\næ‰€ä»¥éœ€è¦è®°å½•çš„åªæœ‰ä¸‰ä¸ªä¸œè¥¿ï¼š$\\sum V_i , \\sum i V_i , \\sum i^2 V_i$ã€‚\nè¿™ä¸‰ä¸ªä¸œè¥¿éƒ½æ˜¯å¯ä»¥ç”¨çº¿æ®µæ ‘ç»´æŠ¤çš„ï¼ˆå°±æ˜¯ O(1) å®Œæˆæ‰“æ ‡è®°å’Œæ ‡è®°ä¸‹æ”¾ï¼‰ã€‚\nå…·ä½“æ–¹æ³•çœ‹ä»£ç å§ã€‚\n æŠ«ç€æœŸæœ›å¤–è¡£çš„çº¿æ®µæ ‘é¢˜ã€‚\n ä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102  #include \u0026lt;bits/stdc++.h\u0026gt;#define gcd __gcd #define ll long long using namespace std; const int MAXN = 110000; namespace SegTree{ //0-\u0026gt;sigma(V_i),1-\u0026gt;sigma(i*V_i),2-\u0026gt;sigma(i^2*V_i)  struct node{ ll sum[3]; node(ll _a = 0,ll _b = 0,ll _c = 0){ sum[0] = _a,sum[1] = _b,sum[2] = _c; } node operator + (const node \u0026amp;a)const{ node newnode; newnode.sum[0] = sum[0] + a.sum[0]; newnode.sum[1] = sum[1] + a.sum[1]; newnode.sum[2] = sum[2] + a.sum[2]; return newnode; } }sumn[MAXN\u0026lt;\u0026lt;2]; ll tag[MAXN\u0026lt;\u0026lt;2]; #define lson (nown\u0026lt;\u0026lt;1)  #define rson (nown\u0026lt;\u0026lt;1|1)  #define mid ((l+r)\u0026gt;\u0026gt;1)  inline ll cal(int n){ return 1LL*n*(n+1)*(2*n+1)/6; } inline void addtag(int nown,int l,int r,ll v){ tag[nown] += v; static node tmp; tmp = node(v*(r-l+1),v*(l+r)*(r-l+1)/2,v*(cal(r)-cal(l-1))); sumn[nown] = sumn[nown] + tmp; } inline void push_down(int nown,int l,int r){ if(tag[nown]){ addtag(lson,l,mid,tag[nown]),addtag(rson,mid+1,r,tag[nown]); tag[nown] = 0; } } inline void push_up(int nown){ sumn[nown] = sumn[lson] + sumn[rson]; } inline void update(int nown,int l,int r,int ql,int qr,int v){ if(ql \u0026lt;= l \u0026amp;\u0026amp; r \u0026lt;= qr) addtag(nown,l,r,v); else{ push_down(nown,l,r); if(ql \u0026lt;= mid) update(lson,l,mid,ql,qr,v); if(qr \u0026gt;= mid+1) update(rson,mid+1,r,ql,qr,v); push_up(nown); } } inline node query(int nown,int l,int r,int ql,int qr){ if(ql \u0026lt;= l \u0026amp;\u0026amp; r \u0026lt;= qr) return sumn[nown]; else{ push_down(nown,l,r); node ans; if(ql \u0026lt;= mid) ans = ans + query(lson,l,mid,ql,qr); if(qr \u0026gt;= mid+1) ans = ans + query(rson,mid+1,r,ql,qr); return ans; } } } int n,m; void update(int l,int r,int v){ SegTree::update(1,1,n,l,r-1,v); } void query(int l,int r,ll \u0026amp;x,ll \u0026amp;y){ SegTree::node tmp = SegTree::query(1,1,n,l,r-1); x = -1LL*r*(l-1)*tmp.sum[0] + 1LL * (r+l-1)*(tmp.sum[1]) - tmp.sum[2]; y = 1LL*(r-l+1)*(r-l)/2; ll d = gcd(x,y); x/=d,y/=d; } void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m); } void solve(){ ll x, y; for(int i = 1;i\u0026lt;=m;i++){ char op[10];int l,r,c; scanf(\u0026#34;%s %d %d\u0026#34;,op,\u0026amp;l,\u0026amp;r); if(op[0] == \u0026#39;C\u0026#39;) scanf(\u0026#34;%d\u0026#34;,\u0026amp;c),update(l,r,c); else query(l,r,x,y),printf(\u0026#34;%lld/%lld\\n\u0026#34;,x,y); } } int main(){ init(); solve(); return 0; }   ","description":"","id":149,"section":"posts","tags":["çº¿æ®µæ ‘","æ•°å­¦","æœŸæœ›"],"title":"ã€ŒHAOI2012ã€é«˜é€Ÿå…¬è·¯-æœŸæœ›+çº¿æ®µæ ‘","uri":"https://blog.chenqiqian.com/posts/haoi2012-highway/"},{"content":"ç»™å‡º $n$ ä¸ªæ•° $q_i$ ï¼Œç»™å‡º $F_j$ å®šä¹‰ä¸ºï¼š\n$$\nF_j = \\sum_{i \u0026lt; j}\\frac{q_i q_j}{(i-j)^2} - \\sum_{i \u0026gt; j}\\frac{q_i q_j}{(i-j)^2}\n$$\nä»¤ $E_i = \\frac{F_i}{q_i}$ ï¼Œæ±‚ $E_i$ çš„å€¼ã€‚\né“¾æ¥ Luogu P3338\né¢˜è§£ å…ˆåŒ–ç®€ï¼š\n$$\nE_j = \\sum_{i \u0026lt; j}\\frac{q_i}{(i-j)^2} - \\sum_{i \u0026gt; j}\\frac{q_i}{(i-j)^2}\n$$\næ³¨æ„åˆ°æˆ‘ä»¬åªéœ€è¦æ±‚ï¼š\n$$\nE_j' = \\sum_{i = 1}^{j-1}\\frac{q_i}{(i-j)^2}\n$$\næ³¨æ„åˆ°å·ç§¯çš„å½¢å¼ï¼š\n$$\n(f * g)[i] = \\sum_{j = 0}^{i} f[j],g[i-j]\n$$\nåœ¨ä¸Šå¼ä¸­ï¼Œä»¤ $f[i] = q_i,g[i] = i^{-2}$ ï¼Œç”±å·ç§¯çš„å®šä¹‰å¯ä»¥å‘ç°ï¼š\n$$\nE_i' = (f * g)[i]\n$$\nè¿™ä¸ªè¿‡ç¨‹å¯ä»¥ç”¨å¿«é€Ÿå‚…ç«‹å¶å˜æ¢ä¼˜åŒ–ï¼Œè¾¾åˆ° $O(n \\log n)$ çš„å¤æ‚åº¦ã€‚\nç„¶åæŠŠåºåˆ—åè½¬ï¼Œå†åšä¸€éï¼Œç»„åˆä¸€ä¸‹å°±æ˜¯æœ€åçš„ç­”æ¡ˆã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71  #include \u0026lt;bits/stdc++.h\u0026gt;using namespace std; const int MAXN = 500000; typedef complex\u0026lt;double\u0026gt; complex_t; namespace FFT{ const double PI = acos(-1.0); // n = 2^k void fft(complex_t *P,int n,int op){ static int r[MAXN]; int len = log2(n); for(int i = 0;i\u0026lt;n;i++) r[i] = (r[i\u0026gt;\u0026gt;1]\u0026gt;\u0026gt;1)|((i\u0026amp;1)\u0026lt;\u0026lt;(len-1)); for(int i = 0;i\u0026lt;n;i++) if(i \u0026lt; r[i]) swap(P[i],P[r[i]]); for(int i = 1;i\u0026lt;n;i\u0026lt;\u0026lt;=1){ complex_t x(cos(PI/i),sin(PI/i)*op); for(int j = 0;j\u0026lt;n;j+=(i\u0026lt;\u0026lt;1)){ complex_t y(1,0); for(int k = 0;k\u0026lt;i;k++,y*=x){ complex_t p = P[j+k],q = y*P[i+j+k]; P[j+k] = p+q,P[i+j+k] = p-q; } } } } void mul(double *a,double *b,double *res,int n){ static complex_t c[MAXN],d[MAXN]; for(int i = 0;i\u0026lt;n;i++) c[i] = d[i] = 0; for(int i = 0;i\u0026lt;n;i++) c[i] = a[i],d[i] = b[i]; fft(c,n,1),fft(d,n,1); for(int i = 0;i\u0026lt;n;i++) c[i] *= d[i]; fft(c,n,-1); for(int i = 0;i\u0026lt;n;i++) res[i] = double(c[i].real())/double(n); } } int n; double q[MAXN]; void init(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n); for(int i = 1;i\u0026lt;=n;i++) scanf(\u0026#34;%lf\u0026#34;,\u0026amp;q[i]); } void solve(){ static double ans[MAXN],tmp[MAXN],a[MAXN],b[MAXN]; int m = 1; for(;m\u0026lt;=2*n;m\u0026lt;\u0026lt;=1); // æ³¨æ„è¿™é‡Œçš„b[i]ä¸€å®šåªèƒ½åˆ°nï¼  for(int i = 1;i\u0026lt;=n;i++) a[i] = q[i],b[i] = (1.0/double(i))/double(i);// è¿™é‡Œå¯èƒ½ä¼šçˆ†ä¸€ç‚¹ä»€ä¹ˆä¸œè¥¿  FFT::mul(a,b,tmp,m); for(int i = 1;i\u0026lt;=n;i++) ans[i] += tmp[i]; reverse(a+1,a+n+1); FFT::mul(a,b,tmp,m); for(int i = 1;i\u0026lt;=n;i++) ans[i] -= tmp[n-i+1]; for(int i = 1;i\u0026lt;=n;i++) printf(\u0026#34;%lf\\n\u0026#34;, ans[i]); } int main(){ init(); solve(); return 0; }   ","description":"","id":150,"section":"posts","tags":["å¿«é€Ÿå‚…ç«‹å¶å˜æ¢","æ•°å­¦"],"title":"ã€ŒZJOI2014ã€åŠ›-å¿«é€Ÿå‚…ç«‹å¶å˜æ¢","uri":"https://blog.chenqiqian.com/posts/zjoi2014-force/"},{"content":"ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º $n$ ä¸”åˆå§‹å€¼å…¨ä¸º $0$ çš„åºåˆ—ã€‚ä½ éœ€è¦æ”¯æŒä»¥ä¸‹ä¸¤ç§æ“ä½œï¼š\n $Add, L, R, h$ ï¼šå°†åºåˆ— $[L, R]$ å†…æ‰€æœ‰å€¼å°äº $h$ çš„å…ƒç´ éƒ½èµ‹ä¸º $h$ï¼Œæ­¤æ—¶ä¸æ”¹å˜é«˜åº¦å¤§äº $h$ çš„å…ƒç´ å€¼ $Remove, L, R, h$ï¼šå°†åºåˆ— $[L, R]$ å†…æ‰€æœ‰å€¼å¤§äº $h$ çš„å…ƒç´ éƒ½èµ‹ä¸º $h$ ï¼Œæ­¤æ—¶ä¸æ”¹å˜é«˜åº¦å°äº $h$ çš„å…ƒç´ å€¼  ä½ éœ€è¦è¾“å‡ºè¿›è¡Œ $k$ æ¬¡ä¸Šè¿°æ“ä½œä¹‹åçš„åºåˆ—ã€‚\né“¾æ¥ Luogu P4560\né¢˜è§£ ç»´æŠ¤ä¸¤ä¸ªæ ‡è®°ï¼Œè¿‘ä¹äºçº¿æ®µæ ‘è£¸é¢˜ã€‚ä¸è¿‡è¿™ç§å†™æ³•å¾ˆæœ‰è¶£ï¼Œå¯ä»¥ç§¯ç´¯ä¸€ä¸‹ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;algorithm\u0026gt;#include \u0026lt;cctype\u0026gt;using namespace std; namespace fast_io { //... }using namespace fast_io; const int MAXN = 2100000,INF = 0x3f3f3f3f; namespace SegTree{ #define ls (o\u0026lt;\u0026lt;1) #define rs (o\u0026lt;\u0026lt;1|1) #define mid ((l+r)\u0026gt;\u0026gt;1) int high[MAXN\u0026lt;\u0026lt;2],low[MAXN\u0026lt;\u0026lt;2]; // op == 1 ä¿®æ”¹å‘ä¸Š op == 2 ä¿®æ”¹å‘ä¸‹ void turn(int o,int v,int op){ if(op == 1){ low[o] = max(low[o],v); high[o] = max(high[o],v); } if(op == 2){ low[o] = min(low[o],v); high[o] = min(high[o],v); } } void push_down(int o){ if(high[o]!=INF){turn(ls,high[o],2),turn(rs,high[o],2),high[o]=INF;} if(low[o]!=0){turn(ls,low[o],1),turn(rs,low[o],1),low[o]=0;} } void update(int o,int l,int r,int ql,int qr,int v,int op){ if(ql \u0026lt;= l \u0026amp;\u0026amp; r \u0026lt;= qr) turn(o,v,op); else{ push_down(o); if(ql \u0026lt;= mid) update(ls,l,mid,ql,qr,v,op); if(qr \u0026gt;= mid+1) update(rs,mid+1,r,ql,qr,v,op); } } void output(int o,int l,int r,int *num){ if(l == r) num[l] = high[o]; else{ push_down(o); output(ls,l,mid,num); output(rs,mid+1,r,num); } } } int n,m; void init(){ read(n),read(m); } void solve(){ int op,l,r,c; for(int i = 1;i\u0026lt;=m;i++){ read(op),read(l),read(r),read(c); SegTree::update(1,1,n,l+1,r+1,c,op); } static int ans[MAXN]; SegTree::output(1,1,n,ans); for(int i = 1;i\u0026lt;=n;i++){ print(ans[i]),print(\u0026#39;\\n\u0026#39;); } } int main(){ init(); solve(); flush(); return 0; }   ","description":"","id":151,"section":"posts","tags":["æ•°æ®ç»“æ„","çº¿æ®µæ ‘"],"title":"ã€ŒIOI2014ã€Wall-çº¿æ®µæ ‘","uri":"https://blog.chenqiqian.com/posts/ioi2014-wall/"},{"content":"ç»™å®šä¸€ä¸ª $n$ ä¸ªèŠ‚ç‚¹çš„æ ‘ï¼Œæ¯ä¸ªç‚¹æœ‰ä¸€ä¸ªæ­£æ•´æ•°æƒå€¼ $a_i$ ã€‚æˆ‘ä»¬å®šä¹‰ $g(x,y)$ ä¸º $x,y$ ä¹‹é—´ç®€å•è·¯å¾„ä¸Šæ‰€æœ‰ç‚¹ï¼ˆåŒ…æ‹¬ç«¯ç‚¹ï¼‰çš„æƒå€¼çš„æœ€å¤§å…¬çº¦æ•°ã€‚\nç°åœ¨è¯·æ±‚å‡ºå¯¹äºæ‰€æœ‰çš„ $i \\in [1,2Ã—10^5]$ ï¼Œæ»¡è¶³ $1 \\le x \\le y \\le n$ ä¸” $g(x,y) = i$ çš„ç‚¹å¯¹ $(x,y)$ çš„æ•°ç›®ã€‚\né“¾æ¥ Codeforces 990G\né¢˜è§£ ä¸€ä¸ªç»“è®ºï¼šä¸€ä¸ªæ•°çš„çº¦æ•°ä¸ªæ•°ä¸ä¼šå¾ˆå¤šã€‚\nåœ¨ $100000000$ ä¹‹å†…ï¼Œçº¦æ•°æœ€å¤šçš„æ•°æ˜¯ $73513440$ ï¼Œæœ‰ $768$ ä¸ªå› å­ã€‚è¿™å¤§çº¦ä¸æ˜¯ $log$ çº§åˆ«çš„ï¼Ÿä»¤å®ƒæ˜¯ä¸€ä¸ª $O(d(n))$ çº§åˆ«çš„å§ã€‚\nSolution A: å®¹æ–¥åŸç†ï¼š\næ‰€æœ‰ä»¥ $q$ ä¸ºæœ€å¤§å…¬çº¦æ•°çš„ç‚¹å¯¹çš„æ•°ç›®ç­‰äºæ‰€æœ‰ä»¥ $q$ ä¸ºå…¬çº¦æ•°çš„ç‚¹å¯¹æ•°ç›®å‡å»ä»¥ $2q,3q,\u0026hellip;,kq$ ä¸ºæœ€å¤§å…¬çº¦æ•°çš„ç‚¹å¯¹æ•°ç›®ã€‚\næ‰€ä»¥æˆ‘ä»¬é‡‡ç”¨é€†åºè®¡ç®—ä»¥ $q$ ä¸ºå…¬çº¦æ•°çš„ç‚¹å¯¹æ•°ç›®ï¼Œå°±å¯ä»¥æ¨å‡ºä»¥ $q$ ä¸ºæœ€å¤§å…¬çº¦æ•°çš„ç‚¹å¯¹æ•°ç›®ã€‚\nè€ƒè™‘æ€ä¹ˆè®¡ç®—è¿™ä¸ªé—®é¢˜ã€‚å¦‚æœä¸¤ä¸ªç‚¹å¯¹çš„å…¬çº¦æ•°æ˜¯ $q$ ï¼Œé‚£ä¹ˆä»–ä»¬è·¯å¾„ä¸Šçš„æ‰€æœ‰è¾¹ä¸¤ç«¯è¿çš„ç‚¹çš„ $gcd$ éƒ½æ˜¯ $q$ æˆ–è€… $q$ çš„å€æ•°ï¼Œç»è¿‡çš„ç‚¹çš„æƒå€¼ä¹Ÿä¸€å®šæ˜¯ $q$ æˆ–è€… $q$ çš„å€æ•°ã€‚å› ä¸ºæƒå€¼ä¸å¤§ï¼Œæˆ‘ä»¬ç”¨æƒå€¼è®°å½•ç‚¹ï¼Œç”¨ $gcd$ è®°å½•è¾¹ã€‚è€ƒè™‘åˆ°å¦‚æœæŠŠæ‰€æœ‰çš„ $gcd$ ä¸º $q$ æˆ–è€… $q$ çš„å€æ•°çš„è¾¹å…¨éƒ½è¿èµ·æ¥ï¼Œè¿™æ ·å›¾é‡Œæ‰€æœ‰è”é€šçš„ç‚¹éƒ½æ˜¯æ»¡è¶³æ¡ä»¶çš„ã€‚æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦è¿è¾¹ï¼Œç„¶åç»´æŠ¤ç‚¹å¯¹æ•°ç›®ã€‚\næˆ‘ä»¬ç»´æŠ¤ä¸€ä¸ªå¹¶æŸ¥é›†ã€‚è®°å½•é›†åˆå¤§å°ã€‚æ¯æ¬¡å…ˆå°†ä¸Šè¿°çš„ç‚¹åˆå§‹åŒ–ï¼Œç„¶åæŠŠè¾¹è¿ä¸Šã€‚ç”¨ä¸€ä¸ªcntç»´æŠ¤æ‰€æœ‰è”é€šç‚¹å¯¹æ•°ç›®ï¼Œæ³¨æ„ä¸€ä¸ªç‚¹ä¹Ÿç®—ç‚¹å¯¹ã€‚ç„¶åè”é€šé›†åˆçš„æ—¶å€™åŠ ä¸Šä»è¿™ç«¯åˆ°é‚£ç«¯çš„æ‰€æœ‰ç‚¹å¯¹å°±å¯ä»¥äº†ã€‚\næ¥åˆ†æä¸€ä¸‹å¤æ‚åº¦ã€‚è¿™é‡Œçš„å¤æ‚åº¦ä¸»è¦é›†ä¸­åœ¨ï¼šå¹¶æŸ¥é›†çš„åˆå§‹åŒ–ï¼ˆæ»¡è¶³æ¡ä»¶çš„ç‚¹ï¼‰å’Œå¹¶æŸ¥é›†çš„åˆå¹¶ï¼ˆæ»¡è¶³æ¡ä»¶çš„è¾¹ï¼‰ï¼Œæ¯ä¸ªæ“ä½œéƒ½æ˜¯ $O(1)$ çš„ï¼Œæˆ‘ä»¬è€ƒè™‘ä¸€ä¸‹å®ƒä¼šè¢«æ‰§è¡Œå¤šå°‘æ¬¡ã€‚å‘ç°æ¯ä¸ªç‚¹éƒ½ä¼šè¢«æƒå€¼çš„å› æ•°åˆå§‹åŒ–ä¸€æ¬¡ï¼Œæ‰€ä»¥è¿™ä¸ªæ˜¯ $O(nd(n))$ çš„ã€‚å¯¹äºè¾¹çš„è¯ä¹Ÿæ˜¯ä¸€æ ·ï¼Œæ‰€ä»¥å¤æ‚åº¦å¤§çº¦æ˜¯ $O(n d(n))$ çš„ã€‚\nå¦‚æœ $d(n)$ ä¸æ˜¯å¾ˆå¤§ï¼Œé‚£ä¹ˆè¿™ä¸ªä¸œè¥¿è¿‡æ‰é—®é¢˜ä¸å¤§ã€‚\nSolution B: æ ‘ä¸Šç‚¹å¯¹çš„é—®é¢˜è®©æˆ‘ä»¬æƒ³åˆ°äº†ç‚¹åˆ†æ²»ã€‚\nè€ƒè™‘ç‚¹åˆ†æ²»çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬è¦è®¡ç®—è¿‡å½“å‰æ ¹ç‚¹çš„æ‰€æœ‰ç‚¹å¯¹çš„gcdåŠå…¶æ•°é‡ã€‚æ ¹èŠ‚ç‚¹çš„çº¦æ•°ä¸ªæ•°æ˜¯O(d)çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ‰€æœ‰æ•°ä¸æ ¹èŠ‚ç‚¹çš„ $gcd$ æœ€å¤šä¹Ÿåªèƒ½æ˜¯ $O(d)$ ç§ã€‚\nå…ˆæšä¸¾æ ¹èŠ‚ç‚¹çš„æ‰€æœ‰çº¦æ•°ï¼Œå¤æ‚åº¦æ˜¯ $O(d)$ ã€‚\nå¯¹äºæ¯ä¸ªå­æ ‘æˆ‘ä»¬å¯ä»¥ç”¨ $O(n)$ çš„æ—¶é—´å®Œæˆdfsã€å»é‡ã€‚ç„¶åæˆ‘ä»¬æœ‰ $O(d^2)$ çš„æ—¶é—´å®Œæˆå¯¹æ‰€æœ‰å‰é¢çš„å’Œç°åœ¨è¿™ä¸ªå­æ ‘çš„ $gcd$ çš„ä¸€ä¸€æšä¸¾ï¼Œç„¶ååœ¨å°†è¿™ä¸ªå­æ ‘æ·»åŠ åˆ°å‰é¢å»ã€‚\nç„¶åè¿™ä¸ªç‚¹åˆ†æ²»çš„è¿‡ç¨‹åº”è¯¥æ˜¯ $O(d n log n)$ çš„?å¤æ‚åº¦æ¯”è¾ƒè¿·ã€‚\nä¸è¿‡èƒ½è¿‡ï¼Œè·‘çš„å¾ˆå¿«ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75  #include \u0026lt;bits/stdc++.h\u0026gt;using namespace std; typedef long long ll; const int MAXN = 300000; int gcd(int x,int y){ return y == 0?x:gcd(y,x%y); } namespace BCJ{ int f[MAXN],siz[MAXN]; int find(int x){ return f[x] == x?x:f[x] = find(f[x]); } void un(int x,int y,ll \u0026amp;cur){ int fx = find(x),fy = find(y); if(fx == fy) return; cur -= 1LL*siz[fx]*(siz[fx]+1)/2; cur -= 1LL*siz[fy]*(siz[fy]+1)/2; f[fy] = fx,siz[fx] += siz[fy]; cur += 1LL*siz[fx]*(siz[fx]+1)/2; } } struct Edge{ int u,v; }edge[MAXN]; vector\u0026lt;int\u0026gt; V[MAXN]; vector\u0026lt;int\u0026gt; E[MAXN]; int n,a[MAXN]; void init(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n); for(int i = 1;i\u0026lt;=n;i++){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;a[i]); V[a[i]].push_back(i); } for(int i = 1;i\u0026lt;=n-1;i++){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;edge[i].u,\u0026amp;edge[i].v); E[gcd(a[edge[i].u],a[edge[i].v])].push_back(i); } } void solve(){ int maxn = 200000; static ll res[MAXN],cur = 0; for(int i = maxn;i\u0026gt;=1;--i){ cur = 0; for(int j = i;j\u0026lt;=maxn;j+=i){ for(int k = 0;k\u0026lt;V[j].size();k++){ int t = V[j][k]; BCJ::siz[t] = 1,BCJ::f[t] = t; cur++; } if(j \u0026gt; i) res[i] -= res[j]; } for(int j = i;j\u0026lt;=maxn;j+=i) for(int k = 0;k\u0026lt;E[j].size();k++) BCJ::un(edge[E[j][k]].u,edge[E[j][k]].v,cur); res[i] += cur; } for(int i = 1;i\u0026lt;=maxn;i++){ if(res[i]) printf(\u0026#34;%d %lld\\n\u0026#34;,i,res[i]); } } int main(){ init(); solve(); return 0; }   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36  // éæœ¬äººåˆ›ä½œ #include\u0026lt;bits/stdc++.h\u0026gt;#define gcd(a,b) __gcd(a,b) using namespace std;const int N=2e5+7;typedef long long ll; struct data{int to,next;}e[N\u0026lt;\u0026lt;1];int n,m,i,j,cnt,a[N],d[N],vis[N],head[N],f[N],q[N],qq[N],u,v,root,sum,num[N],Tnum[N],size[N],fr[N],T,tt,tot;ll ans[N]; void ins(int u,int v){e[++cnt].to=v;e[cnt].next=head[u];head[u]=cnt;} void insert(int u,int v){ins(u,v);ins(v,u);} void getroot(int x,int fa){ size[x]=1;f[x]=0; for(int i=head[x];i;i=e[i].next)if(e[i].to!=fa\u0026amp;\u0026amp;!vis[e[i].to]) getroot(e[i].to,x),size[x]+=size[e[i].to],f[x]=max(f[x],size[e[i].to]); f[x]=max(f[x],sum-size[x]); if(f[x]\u0026lt;f[root])root=x; } void getdis(int x,int fa){ q[++tt]=d[x]; for(int i=head[x];i;i=e[i].next)if(!vis[e[i].to]\u0026amp;\u0026amp;e[i].to!=fa)d[e[i].to]=gcd(d[x],a[e[i].to]),getdis(e[i].to,x); } void work(int x){ vis[x]=1;T=0; for(int i=head[x],j,k;i;i=e[i].next)if(!vis[e[i].to]){ tot=tt=0;d[e[i].to]=gcd(a[x],a[e[i].to]);getdis(e[i].to,0); for(sort(q+1,q+tt+1),j=1;j\u0026lt;=tt;++j)if(q[j]==q[j-1])num[tot]++;else q[++tot]=q[j],num[tot]=1; for(j=1;j\u0026lt;=tot;++j)for(k=1;k\u0026lt;=T;++k)ans[gcd(q[j],qq[k])]+=1ll*num[j]*Tnum[k]; for(j=1;j\u0026lt;=tot;++j)ans[q[j]]+=num[j]; for(j=1;j\u0026lt;=tot;++j)if(!fr[q[j]])qq[++T]=q[j],Tnum[T]=num[j],fr[q[j]]=T; else Tnum[fr[q[j]]]+=num[j]; }ans[a[x]]++;for(int i=1;i\u0026lt;=T;++i)fr[qq[i]]=0; for(int i=head[x];i;i=e[i].next)if(!vis[e[i].to]) root=0,sum=size[e[i].to],getroot(e[i].to,x),work(root); } int main(){ for(scanf(\u0026#34;%d\u0026#34;,\u0026amp;n),i=1;i\u0026lt;=n;++i)scanf(\u0026#34;%d\u0026#34;,a+i);for(i=1;i\u0026lt;n;++i)scanf(\u0026#34;%d%d\u0026#34;,\u0026amp;u,\u0026amp;v),insert(u,v); f[0]=N;sum=n;root=0;getroot(1,0);work(root); for(i=1;i\u0026lt;N;++i)if(ans[i])printf(\u0026#34;%d %lld\\n\u0026#34;,i,ans[i]); }   ","description":"","id":152,"section":"posts","tags":["å¹¶æŸ¥é›†","ç‚¹åˆ†æ²»"],"title":"ã€ŒCF990Gã€GCD Counting-å¹¶æŸ¥é›†/ç‚¹åˆ†æ²»","uri":"https://blog.chenqiqian.com/posts/cf990g/"},{"content":" ä½ ä»¥ä¸ºä½ è§è¯äº†æ•´ä¸ªæ•…äº‹ï¼Œå…¶å®ä½ åªçŸ¥é“ä»–ä»¬çš„åå­—ï¼Œç”šè‡³ä½ è¿ä»–ä»¬çš„åå­—éƒ½ä¸ä¸€å®šçŸ¥é“ã€‚\n é”™è¿‡ è€äººååœ¨åºŠä¸Šï¼Œç¿»ç€å¤§ç®±å­é‡Œé‚£äº›çè—çš„å¾€äº‹ã€‚\nè€äººæ›¾ç»æ˜¯ä¸€åå†›äººï¼Œè€Œè¿™ä¹Ÿè®©ä»–å±‹å­é‡Œé¢çš„ä¸œè¥¿æ•´æ´çš„å°±åƒæ— äººå±…ä½ä¼¼çš„ã€‚è€Œä»–çš„è¿™ä¸ªç®±å­ï¼Œè‡ªç„¶ä¹Ÿå°±æ•´æ•´é½é½çš„æ”¾ç½®ç€å¯¹ä»–æœ€ä¸ºé‡è¦çš„é‚£äº›ä¸œè¥¿ã€‚\nä»–è½»è½»æ‹¿å¸ƒæ“¦æ‰ç®±å­ä¸Šé¢è¦†ç›–çš„ç°å°˜ï¼Œç”¨æ‰‹æŠšäº†ä¸‹çº¢ç»¿è‰²çš„å†›å¾½ã€‚ç®±å­æ…¢æ…¢å±å±å‘€å‘€çš„æ‰“å¼€äº†ã€‚\næœ€ä¸Šé¢çš„æ˜¯ä¸€å¼ å¾ˆè€çš„ç…§ç‰‡ã€‚ä»–çœ‹ç€ç…§ç‰‡ä¸Šçš„çˆ¶å­ï¼Œç»†ç»†å›æƒ³äº†åŠå¤©ã€‚é‚£æ˜¯ä»–14å²çš„æ—¶å€™ã€‚å­¦æ ¡ç»„ç»‡ä»–ä»¬åˆ°é™„è¿‘çš„å†›ç”¨æœºåœºå‚è§‚ï¼Œè€Œè¿™å¼ ç…§ç‰‡ï¼Œå°±æ˜¯ä»¥é‚£ä¸€æ¶ä»–æ°¸è¿œé“­è®°çš„é£æœºä¸ºèƒŒæ™¯æ‹æˆçš„ã€‚ä»–æ˜¯é‚£ä¹ˆå…´å¥‹ï¼Œçœ‹ç€é£æœºçš„èµ·é™ï¼Œé£è¡Œå‘˜çš„å¸…æ°”ï¼Œè®©ä»–å°å°çš„å†…å¿ƒå……æ»¡äº†æ†§æ†¬ï¼Œä»–ç”šè‡³è¿˜å·å·çš„æ‘¸äº†ä¸€ä¸‹é‚£æ¶é‡‘å±çš„é£æœºï¼Œè€Œè‡³ä»Šä»–ä»ç„¶è®°å¾—é‡‘å±é“†é’‰çªå‡ºçš„è´¨æ„Ÿå’Œä»–å¿ƒé‡Œçš„æ¿€åŠ¨ã€‚é‚£ä¸ªæ—¶å€™ï¼Œä»–ç»å¸¸å–œæ¬¢åˆ°æœºåœºè¾¹çš„åœ°æ–¹å»çœ‹ç€ï¼Œåªæ˜¯çœ‹ç€ï¼Œå¦‚æœèƒ½æœ‰é£æœºçš„èµ·é™ï¼Œè¿™èƒ½è®©ä»–æ¿€åŠ¨æ•´æ•´ä¸€å¤©ã€‚ä»–åœ¨å¿ƒé‡Œå°±æƒ³ç€ï¼šæˆ‘æœ‰ä¸€å¤©ï¼Œä¹Ÿè¦å»å¼€é£æœºï¼ç”šè‡³ï¼Œé£åˆ°æ¯”é£æœºæ›´é«˜çš„åœ°æ–¹ï¼\nå¨æˆ¿é‡Œè€ä¼´åšé¥­çš„å£°éŸ³æŠŠä»–ä¸€ä¸‹å­æ‹‰å›ç°å®ã€‚ä»–ç¬‘ç¬‘ã€‚ä»–å·²ç»ä¸æ˜¯å°‘å¹´äº†ï¼Œé‚£ä¸ªæ—¶å€™çš„å¹´å°‘è½»ç‹‚ææ€•ä¹Ÿæ—©å°±ä¸¢æ‰äº†å§ã€‚\nä»–æŠŠé‚£å¼ ç…§ç‰‡å°å¿ƒç¿¼ç¿¼åœ°æ”¾åˆ°åºŠä¸Šï¼Œå†çœ‹å‘ç®±å­é‡Œé¢çš„ä¸‹ä¸€æ ·ä¸œè¥¿ã€‚è¿™æ˜¯ä¸€å¼ è¯ä¹¦ï¼Œä»–è™½ç„¶å·²ç»è®¤ä¸å…¨ä¸Šé¢çš„ä¿„æ–‡ï¼Œä½†æ˜¯è®°å¿†ä»ç„¶ååˆ†é²œæ´»ã€‚é‚£æ˜¯ä»–30å²çš„æ—¶å€™ã€‚ä»–é«˜ä¸­æ¯•ä¸šä¹‹åï¼Œå»äº†èˆªæ ¡ï¼Œæˆä¸ºäº†é£è¡Œå‘˜ã€‚ä»–å–œæ¬¢å¼€ç€é£æœºï¼Œçœ‹ç€ä¸‹é¢çš„å¤§åœ°å’Œæ— æ¯”æ¸ºå°çš„å†œç”°ã€åŸé•‡ã€‚ä»–æœ‰çš„æ—¶å€™ä¹Ÿä¼šå‘è¿œæ–¹æœ›ï¼Œçœ‹ç€é‚£å¤©åœ°ç›¸æ¥å¤„æ·±é‚ƒçš„è“è‰²ï¼Œæƒ³è¦çœ‹åˆ°å¤©ç©ºä¸Šé¢ï¼Œç„¶è€Œä»–å°±ç®—æå°½ç›®åŠ›ï¼Œä¹Ÿå¾ˆéš¾å†çœ‹å‡ºäº›ä»€ä¹ˆã€‚å½“ä»–å¬è¯´è¦æ‹›èˆªå¤©å‘˜çš„æ—¶å€™ï¼Œä»–æ¯«ä¸çŠ¹è±«çš„ç­”åº”äº†ã€‚è¿™æ˜¯ä»–ä¸€ç›´ä»¥æ¥çš„æ¢¦æƒ³å•Šã€‚\nä¸€å¹´ä»¥åï¼Œä»–æ¥åˆ°äº†ä¿„ç½—æ–¯çš„åŠ åŠ æ—å¤ªç©ºä¸­å¿ƒã€‚è´«å¼±çš„ä¸­å›½æ²¡æœ‰åŠæ³•è‡ªå·±åŸ¹å…»èˆªå¤©å‘˜ï¼Œåªèƒ½å°†èˆªå¤©å‘˜é€åˆ°å·²ç»æœ‰ä¸‰åå¤šå¹´èˆªå¤©ç»éªŒçš„ä¿„ç½—æ–¯å»æ¥å—åŸ¹è®­ã€‚åŸ¹è®­æ˜¯è‰°è‹¦çš„ï¼Œä»–ä»¬ä¸ä»…è¦ä¸æ—¶é—´ä½œæˆ˜ï¼Œæ›´è¦ä¸æ–­æŒ‘æˆ˜è‡ªå·±çš„èº«ä½“å’Œç²¾ç¥çš„æé™ã€‚ä»–åˆ°ç°åœ¨éƒ½å¿˜ä¸äº†åœ¨é›¶ä¸‹äº”ååº¦çš„å†°å¤©é›ªåœ°é‡Œçš„é‡å¤–æ±‚ç”Ÿè®­ç»ƒï¼Œä¹Ÿæ°¸è¿œå¿˜ä¸äº†åœ¨æ¥è¿‘ä¸€ç™¾åº¦é«˜æ¸©ä¸‹å¯¹ç”Ÿç†çš„æŠ˜ç£¨ã€‚æœ€ä»¤äººç»æœ›çš„æ˜¯ä»€ä¹ˆæ¥ç€ï¼Ÿä»–çš±äº†çš±çœ‰ï¼Œé‚£ä¸ªæ—¶ä»£çš„è®°å¿†ä¸æ–­æ¶Œå…¥å¿ƒé‡Œã€‚é‚£ä¸ªå°å±‹å­ï¼Œè‡³ä»Šä»–è¿˜èƒ½æ¸…æ¥šçš„è®°å¾—é‡Œé¢çš„æ¯ä¸€ä¸ªé™ˆè®¾ï¼Œå…¶å®ä¹Ÿä¸éš¾ï¼Œå› ä¸ºé‡Œé¢å°±åƒä¸€ä¸ªåŸå¢“ä¼¼çš„ç®€æ´ã€‚è€Œä»–å°±åœ¨é‚£ä¸ªåŸå¢“é‡Œï¼Œä¸çœ ä¸ä¼‘çš„å‘†äº†ä¸‰å¤©ä¸‰å¤œï¼ŒäºŒåå››å°æ—¶ä¸é—´æ–­åœ°å®ŒæˆæŒ‡ä»¤çš„æ“ä½œã€‚ä»–è‡³ä»Šä¹Ÿä¸èƒ½å¿˜å´é‚£ä¸ªå±‹å­çš„å“ªæ€•ä¸€ä¸ªçº¹ç†ã€‚\næœ€ç»ˆï¼Œä»–æ‹¿åˆ°äº†è”ç›Ÿå·é£èˆ¹çš„æŒ‡ä»¤é•¿è¯ä¹¦ã€‚ä»–åˆä¸€æ¬¡æ¿€åŠ¨çš„åƒä¸ªå­©å­ï¼Œå°±åƒä»–14å²çš„æ—¶å€™ï¼Œç¬¬ä¸€æ¬¡è§åˆ°é£æœºä¼¼çš„é‚£ç§æ¿€åŠ¨ã€‚ä»–è¿˜æ¸…æ¥šçš„è®°å¾—ï¼Œä»–æ‹¿åˆ°è¿™ä¸ªè¯ä¹¦ä¹‹åè¯´çš„ç¬¬ä¸€å¥è¯å°±æ˜¯å¯¹åŠ åŠ æ—åŸºåœ°çš„è®­ç»ƒé•¿å®˜è¯´çš„ï¼šâ€œæˆ‘ç°åœ¨æ‹¿çš„æ˜¯â€˜è”ç›Ÿâ€™å·é£èˆ¹æŒ‡ä»¤é•¿çš„è¯ä¹¦ï¼Œå›å»ä»¥åå†æ‹¿ä¸­å›½è‡ªå·±çš„è¯ä¹¦ï¼Œç„¶åé©¾é©¶ç€æˆ‘ä»¬ä¸­å›½çš„å®‡å®™é£èˆ¹é£å‘å¤ªç©ºï¼Œä¸ä½ ä»¬çš„å’Œå¹³å·ç©ºé—´ç«™å¯¹æ¥ï¼Œè¡Œå—ï¼Ÿâ€\néƒ½è¿‡å»äº†å•Šã€‚é‚£ä»½è¯ä¹¦ä¸Šçš„é‡‘å…‰ç¿ç¿çš„å­—æ¯å¦‚ä»Šå·²ç»ä¸å†é‚£ä¹ˆå…‰é²œäº®ä¸½ï¼ŒçŸ¥é“è¿™ä»½è¯ä¹¦çš„äººä¹Ÿè¶Šæ¥è¶Šå°‘äº†ã€‚ä»–æŠŠè¯ä¹¦è½»è½»çš„å¡å›é‚£é•¶åµŒç€é‡‘ä¸çš„ç²¾è‡´çš„å¸ƒè¢‹é‡Œã€‚\nåˆæ˜¯ä¸€å¼ ç…§ç‰‡ã€‚è¿™å¼ ç…§ç‰‡å¤§çº¦æ˜¯å¾ˆè¿‘çš„æ—¶å€™äº†ã€‚å¯¹ï¼Œç¥èˆŸäº”å·ã€‚ä»–å°±åœ¨è¿™å¹…ç…§ç‰‡çš„å·¦ä¾§ï¼Œè€Œç…§ç‰‡ä¸­å¤®å°±æ˜¯ä¸­å›½ç¬¬ä¸€ä¸ªè¿›å…¥å¤ªç©ºçš„äººâ€”â€”æ¨åˆ©ä¼Ÿã€‚é‚£æ˜¯ä»–35å²çš„æ—¶å€™ã€‚ä»–å›å›½äº†ï¼Œå¸¦ç€ä¸€å¼ é‡‘å…‰ç¿ç¿çš„è¯ä¹¦ï¼Œå’Œæ»¡æ»¡çš„é‡è´Ÿã€‚ä¸­å›½çš„è½½äººèˆªå¤©æ¡ä»¶æ­£åœ¨å¿«é€Ÿå…·å¤‡ï¼Œè€Œèˆªå¤©å‘˜çš„åŸ¹å…»åˆ™æ˜¯é‡ä¸­ä¹‹é‡ã€‚ä¸ºäº†å›½å®¶ï¼Œä»–å¿…é¡»æŠ•å…¥æ‰€æœ‰çš„ç²¾åŠ›ï¼Œå»è®­ç»ƒæ–°çš„èˆªå¤©å‘˜ã€‚\n â€œå›¢ç»“ï¼Œè‡ªå¾‹ï¼Œå‹¤å¥‹ï¼Œå¥‰çŒ®ã€‚â€\n ç°ç™½çš„å¢™ä¸Šç –çº¢è‰²çš„å…«ä¸ªå¤§å­—ï¼Œä¸€ç›´æé†’ç€ä»–ä»–çš„èŒè´£æ‰€åœ¨ã€‚ä»–ç°åœ¨æ˜¯ä¸€åèˆªå¤©å‘˜è®­ç»ƒå¸ˆï¼Œå…¼é¢„å¤‡èˆªå¤©å‘˜ã€‚è€Œä»–ç°åœ¨çš„ä»»åŠ¡ï¼Œå°±æ˜¯ä¸ºå›½å®¶è®­ç»ƒå‡ºå°½é‡å¤šçš„åˆæ ¼çš„èˆªå¤©å‘˜ï¼Œè®©ä»–ä»¬æ¯ä¸€ä¸ªéƒ½èƒ½å¤Ÿä¸Šå¤©ã€‚ä¸€å¤©å¤©çš„æ—¥å­è¿‡å»äº†ã€‚ç¥èˆŸé£èˆ¹ä¸€è‰˜ä¸€è‰˜çš„ä¸Šå¤©ï¼Œè€Œé‚£æœ€åè¿›å…¥å¤ªç©ºçš„æ—¥å­ä¹Ÿè¶Šæ¥è¶Šè¿‘äº†ã€‚èˆªå¤©å‘˜ä»é€‰æ‹”åˆ°æœ€åä¸Šå¤©æ·˜æ±°çš„æ•°é‡å¤§çº¦æ˜¯50%ã€‚ç„¶è€Œåœ¨ä¸­å›½ï¼Œè¿™ä¸€æ•°å­—æ˜¯0%ã€‚\nè¿™æ„å‘³ç€è¿™åäºŒåèˆªå¤©å‘˜ï¼ŒåŠ ä¸Šä¸¤ä½æ•™å‘˜ï¼Œæ¯ä¸ªäººéƒ½èƒ½å¤Ÿè¿›å…¥å¤ªç©ºã€‚ä½†ï¼Œå¹¶ä¸æ˜¯æ¯ä¸ªäººéƒ½æœ‰æœºä¼šè¿›å…¥å¤ªç©ºçš„ã€‚\nç¥èˆŸäº”å·ï¼Œä»–è½é€‰äº†ã€‚ä»–å®‰æ…°è‡ªå·±ï¼šè¿˜æœ‰å¾ˆå¤šé£èˆ¹ï¼Œè‡ªå·±è¿˜ä¸ç®—è€ï¼Œè¿˜æœ‰æœºä¼šçš„ã€‚ç¥èˆŸäº”å·è¿”å›çš„æ—¶å€™ï¼Œä»–ä½œä¸ºæ•™å‘˜ï¼Œåœ¨ç°åœºç›®ç¹ç€é£èˆ¹çš„ç€é™†ã€‚ä»–æ˜¯ä¸ºæ•°ä¸å¤šç¬¬ä¸€ä¸ªçœ‹åˆ°é‚£åä¹‹åè¢«èª‰ä¸ºâ€œæ°‘æ—è‹±é›„â€çš„èˆªå¤©å‘˜å‡ºèˆ±çš„äººã€‚ä»–ä½œä¸ºæ•™å‘˜ï¼Œå½“ç„¶æ˜¯é¦–å…ˆä¸èˆªå¤©å‘˜åˆå½±çš„ä¸€å‘˜ã€‚ä»–æ‹ç€è‚©è†€å¯¹æ¨åˆ©ä¼Ÿè¯´ï¼šâ€œå¥½æ ·çš„ã€‚â€ä»–å’Œæ¨åˆ©ä¼Ÿï¼Œå³æ˜¯å¸ˆç”Ÿï¼Œåˆæ˜¯æœ‹å‹ï¼Œè¿˜æ˜¯é‚»å±…ï¼Œç”šè‡³è¿˜æ˜¯ç«äº‰å¯¹æ‰‹ã€‚é‚£æ˜¯ä¸€ä¸ªè¶³ä»¥æ ‡æ¦œå²å†Œçš„æ—¶å€™ã€‚ä¸­å›½è¿™ä¸ªå›½å®¶ï¼Œç¬¬ä¸€æ¬¡æ‹¥æœ‰äº†è½½äººè¿›å…¥å¤ªç©ºçš„èƒ½åŠ›ï¼Œç”šè‡³è¿æ€»ç†éƒ½äº²è‡ªåˆ°åœºè¿æ¥èˆªå¤©å‘˜çš„å½’æ¥ã€‚\nå…¨éƒ¨åå››åç¬¬ä¸€æ‰¹èˆªå¤©å‘˜\nè½¬çœ¼å‡ å¹´åˆè¿‡å»äº†åˆæ˜¯ç¥èˆŸä¸ƒå·å‘å°„ï¼Œä»–ä»ç„¶åœ¨åªèƒ½åœ¨åŒ—äº¬çš„èˆªå¤©åŸï¼Œçœ‹ç€é£èˆ¹æˆåŠŸå‘å°„ï¼Œçœ‹ç€å‡ºèˆ±è¡Œèµ°ï¼Œçœ‹ç€ä¸­å›½å›½æ——çš„æŒ¥åŠ¨ï¼Œçœ‹ç€å‘å°„å¤§å…é‡Œé¢äººä»¬çš„æ¬¢å‘¼ã€‚ä»–å·²ç»äº”åå²äº†ã€‚åœ¨è¿™å‡ å¹´ï¼Œä»–è½é€‰äº†ç¥èˆŸå…­å·ï¼Œåªæˆä¸ºäº†å¤‡ä»½èˆªå¤©å‘˜ï¼Œä»–åŸ¹å…»çš„å­¦ç”Ÿè½½ç€ç«ç®­å‡ç©ºï¼Œè€Œä»–åªèƒ½åœ¨é…’æ³‰ï¼Œç¬¬ä¸€æ¬¡å¦‚æ­¤è¿‘çš„è§‚çœ‹ç«ç®­çš„å‘å°„ã€‚å½“é•¿å¾äºŒå·Fç«ç®­ç¼“ç¼“å‡ç©ºæ—¶ï¼Œä»–æ„Ÿè§‰è‡ªå·±çš„å¿ƒä¼¼ä¹ä¹Ÿæœ‰ä¸€éƒ¨åˆ†ï¼Œå˜ç©ºäº†ä¸€ç‚¹ç‚¹ã€‚\n ã€Œé¥çœ‹ç¥å…­å·¡å¤©èµ°ï¼Œæ¢¦æƒ³ç¥ä¸ƒä¼´æˆ‘è¡Œã€\n ç¥èˆŸå…­å·ä»»åŠ¡å‡ºå¾ä»ªå¼ï¼Œåæ’å·¦äºŒ\nå‘å°„å®Œæˆä¹‹åï¼Œæ—¶é—´å·²è¿‘åˆå¤œã€‚ä»–æ‹–èµ·ç–²æƒ«çš„èº«èº¯ï¼Œä¸€æ­¥ä¸€æ­¥çš„èµ°å›ä»–çš„å®¶ã€‚è¿™æ„å‘³ä¸€ä¸ªèˆªå¤©å‘˜å¾ˆéš¾å†æœ‰å¸Œæœ›è¿›å…¥å¤ªç©ºäº†ã€‚ä»–å¬ç€é£å¹è¿‡ä»–çš„è€³ç•”ï¼Œç¼“ç¼“å‰è¡Œã€‚å¹´è½»æ—¶å€™æ‰€æœ‰çš„è®°å¿†ï¼Œå£®å¿—ã€æƒŠå–œã€å…´å¥‹ã€ç—›è‹¦ã€å¤±è½ï¼Œæ‰€æœ‰è¿™äº›éƒ½ä¸€è‚¡è„‘çš„åœ¨ä»–çš„è„‘æµ·é—´ç›˜æ¡“ã€‚ä»–æŠ¬å¤´æœ›å‘æ˜Ÿç©ºã€‚æ˜Ÿç©ºä»ç„¶æ˜¯é‚£ä¹ˆçš„æ— å ï¼Œé‚£ä¹ˆçš„å¾®èŒ«ã€‚é‚£é‡Œæ˜¯ä»–çš„æ¢¦å•Šï¼Œæ˜¯ä»–å”¯ä¸€çš„æ¢¦å•Šã€‚ä»–å†ä¹Ÿå¿ä¸ä½çœ¼çœ¶ä¸­çš„æ³ªæ°´ï¼Œåªèƒ½è¹²åœ¨è·¯è¾¹ï¼Œå‡è§†æ˜Ÿç©ºç’€ç’¨ï¼Œä¹…ä¹…æ— è¨€ã€‚\nç¥å…«ï¼Œç¥ä¹ï¼Œç¥åï¼Œç¥åä¸€ã€‚é£èˆ¹ä¸€è‰˜è‰˜çš„ä¸Šå¤©ï¼Œè€Œä»–ï¼Œå†ä¹Ÿæ‰¾ä¸åˆ°ä¸Šå¤©çš„æœºä¼šäº†ã€‚\n 2016å¹´ï¼Œä»–ä»èˆªå¤©å‘˜å¤§é˜Ÿé€€ä¼‘ã€‚æˆªè‡³2018å¹´ï¼Œç¬¬ä¸€æ‰¹èˆªå¤©å‘˜ä¸­14äººå…±æœ‰8äººå·²è¿›å…¥å¤ªç©ºï¼›ç¬¬äºŒæ‰¹èˆªå¤©å‘˜ä¸­7äººå…±3äººå·²è¿›å…¥å¤ªç©ºã€‚ä»–ä»¬å¤§éƒ¨åˆ†éƒ½å—åˆ°è¿‡ä»–çš„æŒ‡å¯¼ã€‚\n é¥­é¦™ä»éš”å£ä¼ äº†è¿‡æ¥ã€‚é¥­èœå·²ç»ç«¯ä¸Šäº†æ¡Œã€‚ä»–ä»å›å¿†é‡Œé¢æŠ½å‡ºæ€ç»ªï¼Œæ…¢æ…¢åœ°å°†æ‰‹é‡Œçš„ç…§ç‰‡ã€ä¹¦ä¿¡ã€è¯ä¹¦å†æ¬¡æŒ‰ç…§æ—¶é—´é¡ºåºæ•´é½çš„æ”¾å›é‚£ä¸ªå†›ç»¿è‰²çš„ç®±å­ã€‚ä»–èµ°å‡ºæˆ¿é—´ï¼Œå’Œå„¿å­ä¸€èµ·åƒé¥­ï¼Œå’Œè€ä¼´ä¾ƒä¾ƒæœ€è¿‘çš„å¤§äº‹ã€‚\nè™½ç„¶åˆ«äººéƒ½è¯´è€äººé”™è¿‡äº†ä¸å°‘æœºä¼šï¼Œä½†åœ¨è€äººå¿ƒé‡Œï¼Œä»–ä»æ¥å°±æ²¡æœ‰é”™è¿‡è¿‡ä»€ä¹ˆã€‚\nFrom:Wikimedia\næ ¹æ®çœŸå®æ•…äº‹æ”¹ç¼–ã€‚è¯¥é¢˜ç›®ä¸ºé„™æ ¡æœŸæœ«è¯­æ–‡ä½œæ–‡é¢˜ç›®ä¹‹ä¸€ã€‚\n","description":"","id":153,"section":"posts","tags":null,"title":"ã€Œé”™è¿‡ã€","uri":"https://blog.chenqiqian.com/posts/essay-miss/"},{"content":"lxhgwwé¢„æµ‹åˆ°äº†æœªæ¥ $T$ å¤©å†…æŸåªè‚¡ç¥¨çš„èµ°åŠ¿ï¼Œç¬¬ $i$ å¤©çš„è‚¡ç¥¨ä¹°å…¥ä»·ä¸ºæ¯è‚¡ $AP_i$ ï¼Œç¬¬ $i$ å¤©çš„è‚¡ç¥¨å–å‡ºä»·ä¸ºæ¯è‚¡ $BP_i$ ï¼ˆæ•°æ®ä¿è¯å¯¹äºæ¯ä¸ª $i$ ï¼Œéƒ½æœ‰$AP_i \\ge BP_i$ ï¼‰ï¼Œç¬¬$i$ å¤©çš„ä¸€æ¬¡ä¹°å…¥è‡³å¤šåªèƒ½è´­ä¹° $AS_i$ è‚¡ï¼Œä¸€æ¬¡å–å‡ºè‡³å¤šåªèƒ½å–å‡º $BS_i$ è‚¡ã€‚ä¸¤æ¬¡äº¤æ˜“ï¼ˆæŸä¸€å¤©çš„ä¹°å…¥æˆ–è€…å–å‡ºå‡ç®—æ˜¯ä¸€æ¬¡äº¤æ˜“ï¼‰ä¹‹é—´ï¼Œè‡³å°‘è¦é—´éš” $W$ å¤©ï¼›åœ¨ä»»ä½•æ—¶é—´ä¸€ä¸ªäººçš„æ‰‹é‡Œçš„è‚¡ç¥¨æ•°ä¸èƒ½è¶…è¿‡ $MaxP$ ã€‚\nåœ¨ç¬¬ $1$ å¤©ä¹‹å‰ï¼Œlxhgwwæ‰‹é‡Œæœ‰æ•°ç›®æ— é™çš„é’±ï¼Œä½†æ˜¯æ²¡æœ‰ä»»ä½•è‚¡ç¥¨ï¼Œåœ¨ $T$ å¤©ä»¥åï¼Œ lxhgww èƒ½èµšåˆ°çš„é’±æœ€å¤šæ˜¯å¤šå°‘ï¼Ÿ\né“¾æ¥ Luogu P2569\né¢˜è§£ æ˜¾ç„¶è¦ dp å˜›ï¼Œè¦ä¸ç„¶å®ƒæ”¾åœ¨ dp æ¨¡å—é‡Œæç¬‘ä¹ˆã€‚\nå¦‚æœç”¨ $dp[i][j]$ è¡¨ç¤ºåœ¨ç¬¬ $i$ å¤©çš„æ—¶å€™æ‹¥æœ‰ $j$ è‚¡è‚¡ç¥¨çš„æ—¶å€™çš„æœ€å¤§æ”¶ç›Šã€‚\né‚£ä¹ˆçŠ¶æ€è½¬ç§»ï¼š\n$$\ndp[i][j] = max\n\\begin{cases}{}\ndp[i-1][j]\\\n-ap[i]\\times j,; \u0026amp;j\\leq as[i]\\\ndp[i-w][j+t] + t \\times bp[i],;\u0026amp;0 \u0026lt; t \u0026lt; bs[i],j+t \\leq maxp\\\ndp[i-w][j-t] - t \\times ap[i],;\u0026amp;0 \u0026lt; t \u0026lt; as[i],j-t \u0026gt; 0\n\\end{cases}\n$$\næ³¨æ„åˆ°å‰ä¸¤ä¸ªè½¬ç§»æ˜¯ $O(1)$ çš„ ï¼Œåä¸¤ä¸ªæ˜¯å¦‚æœç›´æ¥åšæ˜¯ $O(n)$ çš„ï¼Œç„¶è€Œè¿™ä¸ªä¸œè¥¿å°±æ˜¯åœ¨ä¸€ä¸ªåŒºé—´é‡Œé¢æ‰¾æœ€å¤§å€¼ï¼Œåé¢åŠ å‡çš„ $t$ éšä½ç½®åŒæ­¥æ”¹å˜ï¼Œä¸ä¼šæ”¹å˜çŠ¶æ€çš„ç›¸å¯¹å¤§å°ï¼Œæ‰€ä»¥ç”¨å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–åé¢ä¸¤ä¸ªè½¬ç§»å³å¯ã€‚\næœ€åæ‰«ä¸€ä¸‹æ‰€æœ‰çš„ $dp[n][i]$ æœ€å¤§å€¼å³ä¸ºç­”æ¡ˆã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60  #include \u0026lt;bits/stdc++.h\u0026gt;using namespace std; const int MAXN = 2100; int n,m,w; int ap[MAXN],bp[MAXN],as[MAXN],bs[MAXN]; int dp[MAXN][MAXN]; void init(){ scanf(\u0026#34;%d %d %d\u0026#34;,\u0026amp;n,\u0026amp;m,\u0026amp;w); w++; for(int i = 1;i\u0026lt;=n;i++) scanf(\u0026#34;%d %d %d %d\u0026#34;,\u0026amp;ap[i],\u0026amp;bp[i],\u0026amp;as[i],\u0026amp;bs[i]); } deque\u0026lt;int\u0026gt; q; void solve(){ for(int i = 0;i\u0026lt;=n;i++) for(int j = 0;j\u0026lt;=m;j++) dp[i][j] = -0x3f3f3f3f; dp[0][0] = 0; for(int i = 1;i\u0026lt;=n;i++){ for(int j = 0;j\u0026lt;=as[i];j++) dp[i][j]=-ap[i]*j; for(int j = 0;j\u0026lt;=m;j++) dp[i][j] = max(dp[i][j],dp[i-1][j]); if(i-w \u0026lt; 0) continue;//!!!  while(!q.empty()) q.pop_back(); for(int j = 0;j\u0026lt;=m;j++){ while(!q.empty() \u0026amp;\u0026amp; q.front() \u0026lt; j-as[i]) q.pop_front(); while(!q.empty() \u0026amp;\u0026amp; dp[i-w][q.back()]-(j-q.back())*ap[i] \u0026lt;= dp[i-w][j]) q.pop_back(); q.push_back(j); dp[i][j] = max(dp[i][j],dp[i-w][q.front()]-(j-q.front())*ap[i]); } while(!q.empty()) q.pop_back(); for(int j = m;j\u0026gt;=0;--j){ while(!q.empty() \u0026amp;\u0026amp; q.front() \u0026gt; j+bs[i]) q.pop_front(); while(!q.empty() \u0026amp;\u0026amp; dp[i-w][q.back()]+(q.back()-j)*bp[i] \u0026lt;= dp[i-w][j]) q.pop_back(); q.push_back(j); dp[i][j] = max(dp[i][j],dp[i-w][q.front()] + (q.front() - j)*bp[i]); } } int ans = 0; for(int i = 0;i\u0026lt;=m;i++) ans = max(ans,dp[n][i]); printf(\u0026#34;%d\\n\u0026#34;,ans); } int main(){ init(); solve(); return 0; }   åœ¨å†™ä¸‹è¿™ä¸ªé¢˜è§£çš„æ—¶å€™ï¼Œè¿™çš„ç¡®æ˜¯ç¬¬100ç¯‡åšæ–‡äº†ã€‚ç¥è´ºä¸€ä¸‹è‡ªå·±ã€‚\n","description":"","id":154,"section":"posts","tags":["åŠ¨æ€è§„åˆ’","å•è°ƒé˜Ÿåˆ—"],"title":"ã€ŒSCOI2010ã€è‚¡ç¥¨äº¤æ˜“-dp+å•è°ƒé˜Ÿåˆ—","uri":"https://blog.chenqiqian.com/posts/scoi2010-stock/"},{"content":"ç»™å®šä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œæ±‚å‡ºåœ¨ä¸¤ä¸ªå­—ç¬¦ä¸²ä¸­å„å–å‡ºä¸€ä¸ªå­ä¸²ä½¿å¾—è¿™ä¸¤ä¸ªå­ä¸²ç›¸åŒçš„æ–¹æ¡ˆæ•°ã€‚å½“è¿™ä¸¤ä¸ªå­ä¸²ä¸­åªè¦æœ‰ä¸€ä¸ªå–å¾—ä½ç½®ä¸åŒæ—¶ï¼Œä¸¤ä¸ªæ–¹æ¡ˆä¸åŒã€‚\né“¾æ¥ Luogu P3181\né¢˜è§£ è§£æ³•ä¸€ï¼š$O(n^4)$ æš´åŠ›æšä¸¾ä¸¤ä¸ªèµ·å§‹ä½ç½®ï¼Œç„¶åæšä¸¾æ¯ä¸ªèµ·å§‹é•¿åº¦ï¼Œ $O(n)$ çš„åˆ¤æ–­å­ä¸²æ˜¯å¦ç›¸åŒï¼Œè¿™ä¸ªç®—æ³•æ˜¯ $O(n^4)$ çš„ã€‚\nè§£æ³•äºŒï¼š$O(n^3)$ æš´åŠ›æšä¸¾ä¸¤ä¸ªèµ·å§‹ä½ç½®ï¼Œç„¶åä» $1$ åˆ° $n$ ï¼Œæ¯æ¬¡åˆ¤æ–­æ–°å¢çš„ä¸€ä¸ªå­—ç¬¦æ˜¯å¦ç›¸åŒï¼Œä»è€Œåˆ¤æ–­å­ä¸²æ˜¯å¦ç›¸åŒã€‚è¿™æ ·å¯¹äºæ¯ä¸€ä¸ªèµ·å§‹ä½ç½®çš„åˆ¤æ–­å°±æ˜¯ $O(n)$ ï¼Œæœ€åçš„å¤æ‚åº¦å°±æ˜¯ $O(n^3)$ ã€‚\nè§£æ³•ä¸‰ï¼š$O(n^2)$ æˆ‘ä»¬å­¦ä¼šäº†åç¼€æ•°ç»„ï¼Œæˆ‘ä»¬çŸ¥é“äº†æˆ‘ä»¬äº‹å®ä¸Šå¯ä»¥åœ¨ $O(n\\log n)$ é¢„å¤„ç†çš„æƒ…å†µä¸‹ $O(1)$ çš„å¾—åˆ°è§£æ³•äºŒçš„ $O(n)$ çš„è¿‡ç¨‹ï¼Œä¹Ÿå°±æ˜¯æ±‚ä¸€ä¸‹ $LCP$ ã€‚è¿™æ ·çš„è¯ï¼Œå¤æ‚åº¦æ˜¯ $O(n^2)$ ã€‚\nè§£æ³•å››ï¼š$O(n \\log n)$ æˆ‘ä»¬å…ˆè½¬åŒ–ä¸€ä¸‹é—®é¢˜ã€‚è¿™é“é¢˜è¦æ±‚çš„æ˜¯ä¸¤ä¸ªä¸²çš„æ¯ä¸€ä¸ªä½ç½®ä¸¤ä¸¤ä¹‹é—´çš„ $LCP$ çš„å’Œã€‚ä½†æ˜¯å¦‚æœæˆ‘ä»¬æšä¸¾çš„è¯ï¼Œæ—¶é—´å¤æ‚åº¦è‡³å°‘æ˜¯ $O(n^2)$ ã€‚é‚£ä¹ˆæˆ‘ä»¬è‚¯å®šè¦ç”¨ä¸€äº›æ•°æ®ç»“æ„ä¹‹ç±»æ¥æ‰¹é‡æ±‚å’Œï¼Œæœ€åæ‰èƒ½å¤Ÿé™ä½å¤æ‚åº¦ã€‚\nå…¶æ¬¡ï¼Œæˆ‘ä»¬å‘ç°è¿™ä¸ªé—®é¢˜å¯ä»¥æ‹†è§£ã€‚æˆ‘ä»¬åªéœ€è¦æ‰¾å‡ºä¸€ä¸ªè§£æ³•ï¼Œè§£å¾—åœ¨ä¸€ä¸ªå­—ç¬¦ä¸²é‡Œé¢ä»»å–ä¸¤ä¸ªä½ç½®ä¸åŒçš„å­ä¸²ï¼Œå–å¾—å­ä¸²ç›¸åŒçš„æ–¹æ¡ˆæ•°ã€‚\nä»¤ s_3 = s_1 + \u0026quot;?\u0026quot; + s_2 ï¼Œé‚£ä¹ˆç­”æ¡ˆå°±æ˜¯ cal(s3)-cal(s1)-cal(s2) ï¼Œå…¶ä¸­ ? æ˜¯ä¸€ä¸ªæ²¡æœ‰åœ¨å­—ç¬¦ä¸²é‡Œé¢å‡ºç°çš„å­—ç¬¦ã€‚\né‚£ä¹ˆæˆ‘ä»¬å‘ç°ï¼Œå¯¹äºæ¯ä¸€ä¸ªä½ç½®æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶è§†ä½œä»¥è¿™ä¸ªä½ç½®å¼€å§‹çš„åç¼€ï¼Œé‚£ä¹ˆå…¶é¡ºåºå¯¹äºæ¯ä¸€ä¸ªä½ç½®ä¸¤ä¸¤ä¹‹é—´ LCP çš„å’Œæ˜¯æ— å…³ç´§è¦çš„ã€‚\næ‰€ä»¥æˆ‘ä»¬æŒ‰ $sa[i]$ ï¼Œä¹Ÿå°±æ˜¯åç¼€å­—å…¸åºçš„é¡ºåºæ¥éå†ã€‚æ¯æ¬¡æˆ‘ä»¬éƒ½è¦æ±‚è¿™ä¸ªä½ç½®å’Œå‰é¢æ‰€æœ‰ä½ç½®çš„ LCP çš„å’Œã€‚é‚£ä¹ˆè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠå‰é¢çš„æ‰€æœ‰åç¼€åˆ°æŒ‰å­—å…¸åºå‰ä¸€ä¸ªåç¼€çš„LCPé•¿åº¦æ‰”åˆ°ä¸€ä¸ª Splay æˆ–è€…ä»€ä¹ˆæƒå€¼çº¿æ®µæ ‘é‡Œé¢å»ã€‚\nç„¶åè¿™ä¸ªæ—¶å€™æˆ‘ä»¬æ–°åŠ å…¥äº†ä¸€ä¸ªåç¼€ï¼Œéœ€è¦æ›´æ–°è¿™ä¸ªæ•°æ®ç»“æ„ã€‚æˆ‘ä»¬éœ€è¦æŠŠè¿™ä¸ªæ•°æ®ç»“æ„é‡Œé¢æ‰€æœ‰çš„å¤§äº $ht[i]$ çš„æ•°éƒ½æ‹å‡ºæ¥ï¼Œæ”¹æˆ $ht[i]$ ï¼Œç„¶åå†å¡å›å»å°±å¯ä»¥äº†ã€‚ç„¶åæ¯æ¬¡ç»™ $ans$ åŠ ä¸Šè¿™ä¸ªæ•°æ®ç»“æ„é‡Œé¢æ‰€æœ‰æ•°çš„æ€»å’Œå°±å¯ä»¥äº†ã€‚\nè¿™ä¸ªç®—æ³•çš„æ—¶é—´å¤æ‚åº¦åº”å½“æ˜¯ $O(n \\log n)$ ã€‚\nè§£æ³•äº”ï¼š$O(n)$ ä»€ä¹ˆï¼Ÿï¼Ÿï¼Ÿè¿™ç§ä¸œè¥¿è¿˜èƒ½ $O(n)$ ï¼Ÿï¼Ÿï¼Ÿ\nåæ­£æˆ‘å¾ˆéœ‡æƒŠã€‚\näºæ˜¯æˆ‘å°±åœ¨åˆæ ¼è€ƒçš„è€ƒåœºä¸Šè‹¦æ€å†¥æƒ³ï¼Œæœ€åè‡ªå·±è„‘è¡¥å‡ºäº†ä¸€ä¸ªæ•°æ®ç»“æ„ã€‚ç”¨æ‘Šè¿˜è¯äº†ä¸‹å¤æ‚åº¦ï¼Œç«Ÿç„¶å‘ç°æ˜¯ $O(n)$ çš„\u0026hellip;ä»”ç»†ä¸€æƒ³ï¼Œè¿™ä¸ªä¸œè¥¿å«å•è°ƒæ ˆ2333\u0026hellip;\u0026hellip;\nå…¶ä»–éƒ½åŒä¸Šï¼Œæˆ‘ä»¬ç°åœ¨è§£å†³çš„æ˜¯è¿™é‡Œï¼š\næˆ‘ä»¬éœ€è¦æŠŠè¿™ä¸ªæ•°æ®ç»“æ„é‡Œé¢æ‰€æœ‰çš„å¤§äº $ht[i]$ çš„æ•°éƒ½æ‹å‡ºæ¥ï¼Œæ”¹æˆ $ht[i]$ ï¼Œç„¶åå†å¡å›å»å°±å¯ä»¥äº†ã€‚ç„¶åæ¯æ¬¡ç»™ $ans$ åŠ ä¸Šè¿™ä¸ªæ•°æ®ç»“æ„é‡Œé¢æ‰€æœ‰æ•°çš„æ€»å’Œå°±å¯ä»¥äº†ã€‚\næ€ä¹ˆåŠå‘¢ï¼Ÿæˆ‘ä»¬æƒ³èƒ½ä¸èƒ½æš´åŠ›è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æ³¨æ„åˆ°æˆ‘ä»¬æ¯æ¬¡ç”¨ $ht[i]$ æ›´æ–°ä¹‹åï¼Œæ‰€æœ‰çš„è¿™äº›æ•°æˆ‘ä»¬éƒ½å¯ä»¥åªç”¨ä¸€ä¸ªæ•°(æ•°å¯¹)æ¥è¡¨ç¤ºï¼Œä¹Ÿå°±æ˜¯ $(ht[i],cnt)$ ã€‚æˆ‘ä»¬ç»´æŠ¤ä¸€ä¸ªæœ‰åºè¡¨ã€‚ç„¶åæ¯æ¬¡ä»å¤§ç«¯æŠŠæ‰€æœ‰å¤§äºç­‰äº $ht[i]$ çš„æ•°ç»™æ‹¿å‡ºæ¥ï¼Œæ›´æ–° $cnt$ ï¼Œæœ€ååœ¨æ’å›å»ä¸€ä¸ªæ–°çš„èŠ‚ç‚¹ã€‚\nç„¶åæ•°æ®ç»“æ„é‡Œé¢çš„æ•°çš„å’Œçš„æ›´æ–°å°±æ¯”è¾ƒç®€å•äº†\u0026hellip;è®°ä¸€ä¸‹å‡ºæ¥çš„æ•°çš„å’Œï¼Œå†è®°ä¸€ä¸‹è¿›å»çš„æ•°çš„å’Œï¼Œç„¶ååŠ ä¸€ä¸‹å‡ä¸€ä¸‹å³å¯ã€‚\nå¯ä»¥ç”¨æ‘Šè¿˜è¯æ˜ï¼Œè¿™ä¸ªä¸œè¥¿æ˜¯ $O(n)$ çš„ã€‚\næˆ‘ç”¨çš„åç¼€æ•°ç»„æ˜¯ $SA-IS$ ç®—æ³•ï¼Œä¹Ÿæ˜¯ $O(n)$ çš„ã€‚\nè¯­è¨€å¾ˆæ··ä¹±ï¼Œå“ªçœ‹ä¸æ‡‚å¯ä»¥é—®æˆ‘23333\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111  #include \u0026lt;bits/stdc++.h\u0026gt;#define ll long long #define pp pair\u0026lt;int,int\u0026gt; using namespace std; const int MAXN = 233333; template\u0026lt;size_t siz\u0026gt; struct SA{ int s[siz\u0026lt;\u0026lt;1],p[siz],t[siz\u0026lt;\u0026lt;1]; int sa[siz],rk[siz],ht[siz]; int b[siz],cur[siz]; #define pushL(x) sa[cur[s[x]]++] = x #define pushS(x) sa[cur[s[x]]--] = x #define inducedSort(v)\\ fill_n(b,m,0),fill_n(sa,n,-1);\\ for(int i = 0;i\u0026lt;n;i++) b[s[i]]++;\\ for(int i = 1;i\u0026lt;m;i++) b[i] += b[i-1];\\ for(int i = 0;i\u0026lt;m;i++) cur[i] = b[i]-1;\\ for(int i=n1-1;~i;--i) pushS(v[i]);\\ for(int i = 1;i\u0026lt;m;i++) cur[i] = b[i-1];\\ for(int i = 0;i\u0026lt;n;i++) if(sa[i]\u0026gt;0\u0026amp;\u0026amp;t[sa[i]-1]) pushL(sa[i]-1);\\ for(int i = 0;i\u0026lt;m;i++) cur[i] = b[i]-1;\\ for(int i =n-1;~i;--i) if(sa[i]\u0026gt;0\u0026amp;\u0026amp;!t[sa[i]-1]) pushS(sa[i]-1); void sais(int n,int m,int *s,int *t,int *p){ int ch = rk[0] = -1,n1 = t[n-1] = 0,*s1 = s+n; for(int i = n-2;~i;--i) t[i] = s[i]==s[i+1]?t[i+1]:s[i]\u0026gt;s[i+1]; for(int i = 1;i\u0026lt;n;i++) rk[i] = (!t[i]\u0026amp;\u0026amp;t[i-1])?(p[n1]=i,n1++):-1; inducedSort(p); for(int i = 0,x,y;i\u0026lt;n;i++)if(~(x=rk[sa[i]])){ if(ch\u0026lt;1||p[x+1]-p[x] != p[y+1]-p[y]) ch++; else for(int j=p[x],k=p[y];j\u0026lt;=p[x+1];j++,k++) if((s[j]\u0026lt;\u0026lt;1|t[j])!=(s[k]\u0026lt;\u0026lt;1|t[k])){ch++;break;} s1[y=x] = ch; } if(ch+1 \u0026lt; n1) sais(n1,ch+1,s1,t+n,p+n1); else for(int i = 0;i\u0026lt;n1;i++) sa[s1[i]] = i; for(int i = 0;i\u0026lt;n1;i++) s1[i] = p[sa[i]]; inducedSort(s1); } template\u0026lt;typename T\u0026gt; int mapp(const T *str,int n){ int m = *max_element(str,str+n); fill_n(rk,m+1,0); for(int i = 0;i\u0026lt;n;i++) rk[str[i]] = 1; for(int i = 0;i\u0026lt;m;i++) rk[i+1] += rk[i]; for(int i = 0;i\u0026lt;n;i++) s[i] = rk[str[i]]-1; return rk[m]; } // è¿™ä¸ªæ—¶å€™ä¼ æ­£ç¡®çš„å­—ç¬¦ä¸²å¤§å°ï¼Œ++nå¯¹str[n]åšå¤„ç† template\u0026lt;typename T\u0026gt; void SuffixArray(const T *str,int n){ int m = mapp(str,++n); sais(n,m,s,t,p); } void getheight(int n){ for(int i = 0;i\u0026lt;=n;i++) rk[sa[i]] = i; for(int i = 0,h=ht[0]=0;i\u0026lt;=n;i++){ int j = sa[rk[i]-1]; while(i+h\u0026lt;n\u0026amp;\u0026amp;j+h\u0026lt;n\u0026amp;\u0026amp;s[i+h]==s[j+h]) ++h; if(ht[rk[i]] = h) --h; } } template\u0026lt;typename T\u0026gt; void build(const T *str,int n){ SuffixArray(str,n); getheight(n); } }; char s1[MAXN],s2[MAXN],s3[MAXN\u0026lt;\u0026lt;1]; void init(){ scanf(\u0026#34;%s\u0026#34;,s1); scanf(\u0026#34;%s\u0026#34;,s2); } ll cal(char *a){ int n = strlen(a); a[n] = \u0026#39;A\u0026#39;-1; static SA\u0026lt;401000\u0026gt; T; T.build(a,n); ll ans = 0,tmp = 0; stack\u0026lt;pp\u0026gt; S; for(int i = 1;i\u0026lt;=n;i++){ ll cnt = 1,tot = 0; while(!S.empty() \u0026amp;\u0026amp; S.top().first \u0026gt;= T.ht[i]){ cnt += S.top().second; tot += 1LL * S.top().first * S.top().second; S.pop(); } S.push(make_pair(T.ht[i],int(cnt))); tmp += T.ht[i]*cnt - tot; ans += tmp; } return ans; } void solve(){ int n = strlen(s1),m = strlen(s2); memcpy(s3,s1,n),memcpy(s3+n+1,s2,m);s3[n] = \u0026#39;A\u0026#39;; printf(\u0026#34;%lld\\n\u0026#34;,cal(s3)-cal(s1)-cal(s2)); } signed main(){ init(); solve(); return 0; }   ","description":"","id":155,"section":"posts","tags":["å­—ç¬¦ä¸²","å•è°ƒæ ˆ","åç¼€æ•°ç»„"],"title":"ã€ŒHAOI2016ã€æ‰¾ç›¸åŒå­—ç¬¦-åç¼€æ•°ç»„+å•è°ƒæ ˆ","uri":"https://blog.chenqiqian.com/posts/haoi2016-same/"},{"content":"å¦‚æœä¸€ä¸ªå­—ç¬¦ä¸²å¯ä»¥è¢«æ‹†åˆ†ä¸º $AABB$ çš„å½¢å¼ï¼Œå…¶ä¸­ $A$ å’Œ $B$ æ˜¯ä»»æ„éç©ºå­—ç¬¦ä¸²ï¼Œåˆ™æˆ‘ä»¬ç§°è¯¥å­—ç¬¦ä¸²çš„è¿™ç§æ‹†åˆ†æ˜¯ä¼˜ç§€çš„ã€‚ä¸€ä¸ªå­—ç¬¦ä¸²å¯èƒ½æ²¡æœ‰ä¼˜ç§€çš„æ‹†åˆ†ï¼Œä¹Ÿå¯èƒ½å­˜åœ¨ä¸æ­¢ä¸€ç§ä¼˜ç§€çš„æ‹†åˆ†ã€‚\nç°åœ¨ç»™å‡ºä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„å­—ç¬¦ä¸² $S$ ï¼Œæˆ‘ä»¬éœ€è¦æ±‚å‡ºï¼Œåœ¨å®ƒæ‰€æœ‰å­ä¸²çš„æ‰€æœ‰æ‹†åˆ†æ–¹å¼ä¸­ï¼Œä¼˜ç§€æ‹†åˆ†çš„æ€»ä¸ªæ•°ã€‚è¿™é‡Œçš„å­ä¸²æ˜¯æŒ‡å­—ç¬¦ä¸²ä¸­è¿ç»­çš„ä¸€æ®µã€‚\nä»¥ä¸‹äº‹é¡¹éœ€è¦æ³¨æ„ï¼š\n å‡ºç°åœ¨ä¸åŒä½ç½®çš„ç›¸åŒå­ä¸²ï¼Œæˆ‘ä»¬è®¤ä¸ºæ˜¯ä¸åŒçš„å­ä¸²ï¼Œå®ƒä»¬çš„ä¼˜ç§€æ‹†åˆ†å‡ä¼šè¢«è®°å…¥ç­”æ¡ˆã€‚ åœ¨ä¸€ä¸ªæ‹†åˆ†ä¸­ï¼Œå…è®¸å‡ºç° $A = B$ã€‚ä¾‹å¦‚ $cccc$ å­˜åœ¨æ‹†åˆ† $A = B = c$ã€‚ å­—ç¬¦ä¸²æœ¬èº«ä¹Ÿæ˜¯å®ƒçš„ä¸€ä¸ªå­ä¸²ã€‚  é“¾æ¥ Luogu P1117\nBZOJ 4650\né¢˜è§£ ä¸‹æ–‡å­—ç¬¦ä¸²ä¸‹æ ‡å‡ä¸º $[0,n)$ ã€‚\næˆ‘ä»¬å¦‚æœä»¤ $l[i]$ ä¸ºåœ¨ $i$ å¤„å¼€å§‹çš„ AA ä¸²çš„ä¸ªæ•°ï¼Œ$r[i]$ ä¸ºåœ¨ $i$ å¤„ç»“æŸçš„ AA ä¸²çš„ä¸ªæ•°ï¼Œé‚£ä¹ˆ\n$$\nans = \\sum_{i = 1}^{n-1} r[i-1] \\times l[i]\n$$\nè¿™ä¸ªè¿‡ç¨‹æ˜¯ $O(n)$ çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ€è€ƒæ€ä¹ˆæ±‚å‡º $l[i]$ å’Œ $r[i]$ ã€‚\næˆ‘ä»¬å¯¹æ¯ä¸€ä¸ª AA å­ä¸²çš„å¾ªç¯èŠ‚é•¿åº¦ $L$ ä» $1$ åˆ° $\\frac{n}{2}$ è¿›è¡Œæšä¸¾è€ƒè™‘ã€‚å¦‚æœåœ¨ $0,L,2L,\u0026hellip;,nL$ çš„åœ°æ–¹è®¾ä¸ºå…³é”®ç‚¹ï¼Œé‚£ä¹ˆ AA çš„å·¦åŠè¾¹çš„å¾ªç¯èŠ‚å› ä¸ºé•¿åº¦ä¸º $L$ ï¼Œä¸€å®šè¿‡ä¸”ä»…è¿‡ä¸€ä¸ªå…³é”®ç‚¹ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬ä¸‹é¢è€ƒè™‘çš„åŸºç¡€ã€‚\næˆ‘ä»¬æ­£åºã€é€†åºå»ºç«‹ä¸¤ä¸ªåç¼€æ•°ç»„ï¼Œæ¥æ±‚å¾—åŸå­—ç¬¦ä¸²æŸä¸¤ä¸ªåç¼€çš„LCPï¼ˆæœ€é•¿å…¬å…±å‰ç¼€ï¼‰æˆ–è€…æŸä¸¤ä¸ªå‰ç¼€çš„ LCS ï¼ˆæœ€é•¿å…¬å…±åç¼€ï¼‰ã€‚\nå¦‚æœè¿™ä¸ª AA å­ä¸²çš„å·¦åŠè¾¹è¿‡ $kL$ è¿™ä¸ªå…³é”®ç‚¹ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™çš„ AA å­ä¸²åœ¨ $kL$ å’Œ $(k+1)L$ çš„ä½ç½®å¿…é¡»ç›¸åŒï¼Œè€Œä¸”ä»–ä»¬çš„$LCP+LCS$çš„é•¿åº¦å¿…é¡»èƒ½å¤Ÿæ¥ä¸Šè¿™æ ·ä¸€ä¸ª $L$ çš„é—´éš”ï¼Œæˆ‘ä»¬æ‰èƒ½æ‰¾åˆ°ä¸€æ®µ $2L$ çš„åŒºé—´ï¼Œæ»¡è¶³ AA ä¸²çš„æ¡ä»¶ã€‚\nè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬ç”¨å·®åˆ†çš„æ–¹æ³•æ ‡è®°ä¿®æ”¹ $l$ å’Œ $r$ å³å¯ã€‚\næ³¨æ„è¦ä¿è¯ AA ä¸²(ä¹Ÿå°±æ˜¯æˆ‘ä»¬æšä¸¾çš„ä¸²)å·¦è¾¹çš„ä¸²çš„å·¦ç«¯ç‚¹ã€å³ç«¯ç‚¹éƒ½ä¸è§¦ç¢°åˆ°å…¶ä»–çš„å…³é”®ç‚¹ï¼Œä¸ç„¶ä¼šé‡å¤è®¡æ•°ã€‚\nå…·ä½“çœ‹ä»£ç å§ã€‚solve å‡½æ•°å°±æ˜¯æœ€ç»ˆçš„è¿™ä¸€è¿‡ç¨‹ã€‚\næ—¶é—´å¤æ‚åº¦ $O(n \\log{n})$ ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139  #include \u0026lt;bits/stdc++.h\u0026gt;using namespace std; const int MAXN = 210000; struct SA{ int sa[MAXN],rk[MAXN],ht[MAXN],s[MAXN\u0026lt;\u0026lt;1],t[MAXN\u0026lt;\u0026lt;1]; int b[MAXN],cur[MAXN],p[MAXN]; #define pushS(x) sa[cur[s[x]]--] = x #define pushL(x) sa[cur[s[x]]++] = x #define inducedSort(v) \\ fill_n(b,m,0),fill_n(sa,n,-1);\\ for(int i = 0;i\u0026lt;n;i++) b[s[i]]++;\\ for(int j = 1;j\u0026lt;m;j++) b[j]+=b[j-1];\\ for(int j = 0;j\u0026lt;m;j++) cur[j] = b[j]-1;\\ for(int i=n1-1;~i;--i) pushS(v[i]);\\ for(int j = 1;j\u0026lt;m;j++) cur[j] = b[j-1];\\ for(int i = 0;i\u0026lt;n;i++) if(sa[i]\u0026gt;0 \u0026amp;\u0026amp; t[sa[i]-1]) pushL(sa[i]-1);\\ for(int j = 0;j\u0026lt;m;j++) cur[j] = b[j]-1;\\ for(int i=n-1;~i;--i) if(sa[i]\u0026gt;0 \u0026amp;\u0026amp; !t[sa[i]-1]) pushS(sa[i]-1); void sais(int n,int m,int *s,int *t,int *p){ int n1 = t[n-1] = 0,ch = rk[0] = -1,*s1 = s+n; for(int i = n-2;~i;--i) t[i] = (s[i]!=s[i+1])?s[i]\u0026gt;s[i+1]:t[i+1]; for(int i = 1;i\u0026lt;n;i++) rk[i] = (!t[i]\u0026amp;\u0026amp;t[i-1])?(p[n1]=i,n1++):-1; inducedSort(p); for(int i=0,x,y;i\u0026lt;n;i++)if(~(x=rk[sa[i]])){ if(ch \u0026lt; 1 || p[x+1]-p[x]!=p[y+1]-p[y]) ch++; else for(int j=p[x],k=p[y];j\u0026lt;=p[x+1];j++,k++) if((s[j]\u0026lt;\u0026lt;1|t[j])!=(s[k]\u0026lt;\u0026lt;1|t[k])){ch++;break;} s1[y=x]=ch; } if(ch+1 \u0026lt; n1) sais(n1,ch+1,s1,t+n,p+n1); else for(int i = 0;i\u0026lt;n1;i++) sa[s1[i]] = i; for(int i = 0;i\u0026lt;n1;i++) s1[i] = p[sa[i]]; inducedSort(s1); } template\u0026lt;typename T\u0026gt; int mapp(const T *str,int n){ int m = *max_element(str,str+n); fill_n(rk,m+1,0); for(int i = 0;i\u0026lt;n;i++) rk[str[i]] = 1; for(int j = 0;j\u0026lt;m;j++) rk[j+1] += rk[j]; for(int i = 0;i\u0026lt;n;i++) s[i] = rk[str[i]] - 1; return rk[m]; } template\u0026lt;typename T\u0026gt; void SuffixArray(const T *str,int n){ int m = mapp(str,++n); sais(n,m,s,t,p); } void getheight(int n){ for(int i = 0;i\u0026lt;=n;i++) rk[sa[i]] = i; for(int i = 0,h = ht[0] = 0;i\u0026lt;=n;i++){ int j = sa[rk[i]-1]; while(i+h\u0026lt;n\u0026amp;\u0026amp;j+h\u0026lt;n\u0026amp;\u0026amp;s[i+h]==s[j+h]) h++; if(ht[rk[i]] = h) --h; } } struct ST{ int maxn[20][MAXN]; void build(int *num,int n){ for(int i = 1;i\u0026lt;=n;i++) maxn[0][i] = num[i]; for(int j = 1,t=2;t\u0026lt;=n;j++,t\u0026lt;\u0026lt;=1)// stè¡¨å–minï¼  for(int i = 1;i+(t\u0026gt;\u0026gt;1)\u0026lt;=n;i++) maxn[j][i] = min(maxn[j-1][i],maxn[j-1][i+(t\u0026gt;\u0026gt;1)]); } int query(int l,int r){ if(l \u0026gt; r) return -1; int t = log2(r-l+1); return min(maxn[t][l],maxn[t][r-(1\u0026lt;\u0026lt;t)+1]);// å–minï¼ï¼ï¼ï¼  } }S; int lcp(int x,int y,int n){ x = rk[x],y = rk[y]; if(x \u0026gt; y) swap(x,y); if(x == y) return n-x+1; return S.query(x+1,y); } template\u0026lt;typename T\u0026gt; void solve(const T *str,int n){ SuffixArray(str,n); getheight(n); S.build(ht,n); } }A,B; int n; char s[MAXN],tmp[MAXN]; void init(){ scanf(\u0026#34;%s\u0026#34;,s); n = strlen(s); s[n] = \u0026#39;a\u0026#39;-1; A.solve(s,n); for(int i = 0;i\u0026lt;n;i++) tmp[i] = s[n-i-1]; tmp[n] = \u0026#39;a\u0026#39;-1; B.solve(tmp,n); } // Longest Common Prefix int lcp(int x,int y){ return A.lcp(x,y,n); } // Longest Common Suffix int lcs(int x,int y){ return B.lcp(n-x-1,n-y-1,n); } long long solve(){ static long long l[MAXN],r[MAXN]; long long ans = 0; memset(l,0,sizeof(l)),memset(r,0,sizeof(r)); for(int L = 1;L\u0026lt;=n/2;L++){ for(int j = 0;j+L\u0026lt;n;j+=L){ int ll = j,rr = j+L; if(s[ll] != s[rr]) continue; int x = ll-lcs(ll,rr)+1,y = ll + lcp(ll,rr) - 1; x = max(max(x,0),ll-L+1),y = min(ll+L-1,min(n-L-1,y)); if(y-x+1 \u0026gt;= L){ int cnt = (y-x+1)-L+1; l[x]++,l[x+cnt]--; r[x+2*L-1]++,r[x+2*L+cnt-1]--; } } } for(int i = 1;i\u0026lt;n;i++) l[i] += l[i-1],r[i] += r[i-1]; for(int i = 0;i\u0026lt;n-1;i++) ans += r[i]*l[i+1]; return ans; } int main(){ int T; scanf(\u0026#34;%d\u0026#34;,\u0026amp;T); for(int i = 1;i\u0026lt;=T;i++){ init(); printf(\u0026#34;%lld\\n\u0026#34;,solve()); } return 0; }   ","description":"","id":156,"section":"posts","tags":["å­—ç¬¦ä¸²","åç¼€æ•°ç»„"],"title":"ã€ŒNOI2016ã€ä¼˜ç§€çš„æ‹†åˆ†-åç¼€æ•°ç»„","uri":"https://blog.chenqiqian.com/posts/noi2016-split/"},{"content":"ç»™å®š $n$ ä¸ªç‚¹çš„é«˜åº¦ï¼Œè§„å®šä» $1$ ç‚¹å‡ºå‘ï¼Œè·³åˆ°æ¯”é«˜åº¦å°äºå½“å‰ç‚¹çš„ç‚¹ä¸æ¶ˆè€—ä½“åŠ›ï¼Œå¦åˆ™æ¶ˆè€—ä¸€ç‚¹ä½“åŠ›ï¼Œæœ€ååˆ°è¾¾ $n$ ç‚¹ã€‚\n$q$ æ¬¡è¯¢é—®ï¼Œæ¯æ¬¡è¯¢é—®æœ‰ä¸€ä¸ªæ­¥ä¼é™åˆ¶ $k$ ï¼Œæ±‚æœ€å°‘è€—è´¹çš„ä½“åŠ›ã€‚\né“¾æ¥ Luogu P3752\né¢˜è§£ å¾ˆæ˜æ˜¾çš„ä¸€ä¸ªdpã€‚\nçŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š\n$$\n\\begin{equation}\ndp[i] = \\min_{j \\geq i-k}\n\\begin{cases}\ndp[j] + 1 \u0026amp; ht[i] \\geq ht[j]\\\ndp[j], \u0026amp; ht[i] \u0026lt; ht[j]\n\\end{cases}\n\\end{equation}\n$$\næ³¨æ„åˆ°$j$éš$i$çš„å˜åŒ–è€Œå•è°ƒé€’å¢ï¼Œæ‰€ä»¥è¿™ä¸ªä¸œè¥¿å¯ä»¥ç”¨å•è°ƒé˜Ÿåˆ—æ¥å®Œæˆ$O(n)$çš„å¤æ‚åº¦ã€‚\nä¸è¿‡æœ‰ä¸€ç‚¹å°é—®é¢˜ï¼Œåœ¨äºè¿™ä¸ªåŠ ä¸€çš„é—®é¢˜ã€‚æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œå¦‚æœæˆ‘ä»¬æŠŠdpçš„å€¼å½“ä½œç¬¬ä¸€å…³é”®å­—ï¼Œé«˜åº¦å½“ä½œç¬¬äºŒå…³é”®å­—ï¼Œå¦‚æœæœ€ä¼˜è§£çš„é«˜åº¦è¾ƒçŸ®ï¼ŒåŠ ä¸€ä¹‹åä¹Ÿä¸ä¼šæ¯”æ¬¡ä¼˜è§£è¦å·®ï¼ˆå•è°ƒé˜Ÿåˆ—é‡Œçš„æœ€ä¼˜å’Œæ¬¡ä¼˜è‡³å°‘å·®$1$ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¦‚æ­¤ä¼˜åŒ–ã€‚\næ—¶é—´å¤æ‚åº¦$O(nq)$ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49  #include \u0026lt;bits/stdc++.h\u0026gt;using namespace std; const int MAXN = 1100000; int n,m; int num[MAXN], dp[MAXN]; deque\u0026lt;int\u0026gt; q;// å…¶ä¸­çš„intä¸ºpos  void init(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n); num[0] = 0x3f3f3f3f; for(int i = 1;i\u0026lt;=n;i++) scanf(\u0026#34;%d\u0026#34;,\u0026amp;num[i]); } bool cmp(int x,int y){ // 1 -\u0026gt; x çš„ä¼˜å…ˆçº§å¤§äºy;0 -\u0026gt; yçš„ä¼˜å…ˆçº§å¤§äºx  if(dp[x]!=dp[y]) return dp[x] \u0026lt; dp[y]; return num[x] \u0026gt; num[y]; } int getans(int k){ dp[1] = 0; while(!q.empty()) q.pop_back(); q.push_back(1); for(int i = 2;i\u0026lt;=n;i++){ while(!q.empty() \u0026amp;\u0026amp; q.front() \u0026lt; i-k) q.pop_front(); dp[i] = dp[q.front()] + ((num[q.front()] \u0026gt; num[i])? 0: 1); while(!q.empty() \u0026amp;\u0026amp; cmp(i,q.back())) q.pop_back(); q.push_back(i); } return dp[n]; } void solve(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;m); int t; for(int i = 1;i\u0026lt;=m;i++){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;t); printf(\u0026#34;%d\\n\u0026#34;,getans(t)); } } int main(){ init(); solve(); return 0; }   ","description":"","id":157,"section":"posts","tags":["åŠ¨æ€è§„åˆ’","å•è°ƒé˜Ÿåˆ—"],"title":"ã€ŒPOI2014ã€PTA-å•è°ƒé˜Ÿåˆ—","uri":"https://blog.chenqiqian.com/posts/poi2014-pta/"},{"content":"é«˜æ–¯æ¶ˆå…ƒæ³•æ˜¯çº¿æ€§ä»£æ•°ä¸­çš„ä¸€ä¸ªç®—æ³•ï¼Œå¯ç”¨æ¥ä¸ºçº¿æ€§æ–¹ç¨‹ç»„æ±‚è§£ï¼Œæ±‚å‡ºçŸ©é˜µçš„ç§©ï¼Œä»¥åŠæ±‚å‡ºå¯é€†æ–¹é˜µçš„é€†çŸ©é˜µã€‚å½“ç”¨äºä¸€ä¸ªçŸ©é˜µæ—¶ï¼Œé«˜æ–¯æ¶ˆå…ƒæ³•ä¼šäº§ç”Ÿå‡ºä¸€ä¸ªè¡Œæ¢¯é˜µå¼ã€‚\næ€ä¹ˆæ¶ˆï¼Ÿ ä¸€ä¸ªå°å°çš„ä¾‹å­ å›æƒ³ä¸€ä¸‹ä½ çš„å°å­¦ç”Ÿæ´»å§ã€‚\nè€å¸ˆç»™äº†ä½ ä¸€ä¸ªæ–¹ç¨‹ç»„ã€‚\n$$\n\\left\\{\n\\begin{array}{rc}\n2x+3y = 7 \\\\\n4x-5y = 3\n\\end{array}\n\\right.\n$$\nèªæ…§å¦‚ä½ å½“ç„¶èƒ½ä¸€çœ¼çœ‹å‡ºæ¥è¿™ä¸ªä¸œè¥¿çš„ç­”æ¡ˆæ˜¯ï¼š$x = 2,y = 1$ï¼Œå¯æ˜¯ä½ æ˜¯æ€ä¹ˆçœ‹å‡ºæ¥çš„å‘¢ï¼Ÿè€å¸ˆå‘Šè¯‰è¿‡ä½ è§£äºŒå…ƒä¸€æ¬¡æ–¹ç¨‹ç»„çš„æ ‡å‡†åšæ³•ï¼šåŠ å‡æ¶ˆå…ƒæ³•ã€‚\nå…·ä½“æ¥è¯´ï¼Œå°±æ˜¯ç”¨ä¸€å¼ä¹˜ä»¥æŸæ¯”ä¾‹ä¹‹åå»å‡äºŒå¼ï¼ŒæŠŠæ–¹ç¨‹ç»„å˜æˆå¦‚ä¸‹çš„æ ·å­ï¼š\n$$\n\\left\\{\n\\begin{array}{rc}\n2x+3y = 7 \\\\\n0x-11y = -11\n\\end{array}\n\\right.\n$$\nç„¶åå†æŠŠ $y$ å¸¦å›ä¸€å¼å°±å¯ä»¥å¾—åˆ° $x$ ï¼š\n$$\n\\left\\{\n\\begin{array}{rc}\n2x+0y = 4 \\\\\n0x-11y = -11\n\\end{array}\n\\right.\n$$\nä»è€Œä½ çŸ¥é“ï¼Œ$x = 2,y = 1$ã€‚\næ­å–œä½ ï¼Œä½ å·²ç»å®Œæˆäº†é«˜æ–¯æ¶ˆå…ƒã€‚\nå†çœ‹ä¸Šé¢çš„ä¾‹å­ å¦‚æœæˆ‘ä»¬æŠŠä¸Šé¢æ–¹ç¨‹ç»„çš„ç³»æ•°æŠ½å‡ºæ¥å˜æˆä¸€ä¸ªè¡Œåˆ—å¼ï¼Œå°±ä¼šå¦‚ä¸‹æ‰€ç¤º:\n$$\n\\begin{array}{}\n\\left|\\begin{array}{cccc}\n2 \u0026amp; 3 \\\\\n5 \u0026amp; -4\n\\end{array}\\right|\n\\quad\n\\left|\\begin{array}{cccc}\n7 \\\\\n3\n\\end{array}\\right|\n\\end{array}\n$$\né‚£ä¹ˆæˆ‘ä»¬æ¶ˆå…ƒçš„è¿‡ç¨‹å°±ä¼šå¦‚ä¸‹æ‰€ç¤ºï¼š\n$$\n\\begin{array}{}\n\\left|\\begin{array}{cccc}\n2 \u0026amp; 3 \\\\\n0 \u0026amp; -11\n\\end{array}\\right|\n\\quad\n\\left|\\begin{array}{cccc}\n7 \\\\\n-11\n\\end{array}\\right|\n\\end{array}\n$$\nç„¶åæ˜¯\n$$\n\\begin{array}{}\n\\left|\\begin{array}{cccc}\n2 \u0026amp; 0 \\\\\n0 \u0026amp; -11\n\\end{array}\\right|\n\\quad\n\\left|\\begin{array}{cccc}\n4 \\\\\n-11\n\\end{array}\\right|\n\\end{array}\n$$\næ³¨æ„åˆ°ï¼Œæœ€åæˆ‘ä»¬è¾¾æˆäº†ä¸€ä¸ªç›®æ ‡ï¼š**ä½¿æ•´ä¸ªè¡Œåˆ—å¼åªæœ‰å¯¹è§’çº¿ä¸Šçš„éƒ¨åˆ†ä¸ä¸º $0$ ï¼Œå…¶ä»–éƒ¨åˆ†å‡ä¸º $0$ ã€‚**è¿™ä¸ªæ¡ä»¶çš„è¾¾æˆï¼Œè®©æˆ‘ä»¬å¯ä»¥æ–¹ä¾¿çš„è®¡ç®—å‡ºæ¥è¿™ä¸ªæ–¹ç¨‹ç»„çš„è§£ã€‚\nè¿™ä¹Ÿæ˜¯æˆ‘ä»¬åœ¨æ¥ä¸‹æ¥è®¾è®¡çš„ç®—æ³•ä¸­éœ€è¦è¾¾åˆ°çš„ã€‚\né«˜æ–¯-çº¦æ—¦æ¶ˆå…ƒæ³• è¿ç”¨ä¸Šé¢æåˆ°çš„æ€æƒ³å»è§£å¤šå…ƒä¸€æ¬¡æ–¹ç¨‹ç»„çš„ç®—æ³•ï¼Œå«åšé«˜æ–¯-çº¦æ—¦æ¶ˆå…ƒæ³•ï¼ˆGauss-Jordan Eliminationï¼‰ã€‚\nå®ƒæœ‰ç€ä»¥ä¸‹çš„ä¼˜ç‚¹ï¼š\n æ–¹ä¾¿ç†è§£ ä¸ç”¨å›ä»£ ç²¾åº¦è¾ƒé«˜  å®ƒæœ‰ç€ä»¥ä¸‹çš„ç¼ºç‚¹ï¼š\n è¿è¡Œè¾ƒæ…¢  å®ç° ç®€å•æ¥è¯´ï¼Œå®ƒçš„è¿è¡Œè¿‡ç¨‹æ˜¯è¿™ä¸ªæ ·å­çš„ï¼šæ¯æ¬¡å¯¹äºç¬¬ $i$ è¡Œï¼Œè®©ç¬¬ $i$ åˆ—é™¤äº†ç¬¬ $i$ è¡Œä¹‹å¤–å‡æˆä¸º $0$ ï¼Œä¸”ä¸ç ´åå‰ $i-1$ åˆ—çš„è¯¥æ€§è´¨ã€‚\nå…·ä½“æ¥è¯´ï¼Œæ¯æ¬¡åœ¨å¤„ç†ç¬¬ $i$ è¡Œæ—¶ï¼Œå°†ç¬¬ $i$ è¡Œæ•´è¡Œï¼Œä¹˜ä»¥æ°å½“æ¯”ä¾‹åä¸é™¤äº†ç¬¬ $i$ è¡Œä¹‹å¤–çš„å…± $n-1$ è¡Œç›¸å‡ï¼Œä½¿å¾—é™¤äº†ç¬¬ $i$ è¡Œä¹‹å¤–çš„ $n-1$ è¡Œçš„ç¬¬ $i$ åˆ—å‡ä¸º$0$ã€‚\nï¼ˆå¦‚æœä½ å¯¹äºç¬¬ $i$ è¡Œç¬¬ $i$ åˆ—çš„æ•°ä¸‡ä¸€æ˜¯ $0$ çš„æƒ…å†µæ„Ÿåˆ°å›°æƒ‘ï¼Œè¯·ä½ å…ˆå¾€ä¸‹çœ‹ï¼Œå¹¶å‡è®¾è¿™ä¸ªä½ç½®ä¸Šæ°¸è¿œä¸ä¼šæ˜¯ $0$ ï¼‰\næ­£ç¡®æ€§çš„è¯´æ˜ï¼š\næˆ‘ä»¬éœ€è¦è¯æ˜çš„ï¼Œå°±æ˜¯æˆ‘ä»¬åœ¨å¾ªç¯ä¸­å¤„ç†å®Œç¬¬ $i$ è¡Œæ—¶ï¼Œä¸ä¼šç ´åå‰ $i-1$ è¡Œçš„è¯¥æ€§è´¨ã€‚æ³¨æ„åˆ°æˆ‘ä»¬å‰ $i-1$ æ¬¡æ“ä½œå·²ç»ä½¿å¾—ç¬¬ $i$ è¡Œä»¥åçš„å‰ $i-1$ åˆ—å‡æˆä¸ºäº† $0$ ï¼Œå³ä¸ºå¦‚ä¸‹æ‰€ç¤ºï¼š(å°†è¦å¤„ç†ç¬¬4è¡Œ)\n$$\n\\begin{array}{}\n\\left|\\begin{array}{cccc}\na \u0026amp; 0 \u0026amp; 0 \u0026amp; 3 \u0026amp; 2 \u0026amp; 3 \u0026amp; 2 \u0026amp; 3\\\\\n0 \u0026amp; b \u0026amp; 0 \u0026amp; 5 \u0026amp; 2 \u0026amp; 3 \u0026amp; 2 \u0026amp; 3\\\\\n0 \u0026amp; 0 \u0026amp; c \u0026amp; 3 \u0026amp; 2 \u0026amp; 3 \u0026amp; 2 \u0026amp; 3\\\\\n0 \u0026amp; 0 \u0026amp; 0 \u0026amp; d \u0026amp; 2 \u0026amp; 3 \u0026amp; 2 \u0026amp; 3\\\\\n0 \u0026amp; 0 \u0026amp; 0 \u0026amp; 7 \u0026amp; 2 \u0026amp; 3 \u0026amp; 2 \u0026amp; 3\\\\\n0 \u0026amp; 0 \u0026amp; 0 \u0026amp; 5 \u0026amp; 2 \u0026amp; 3 \u0026amp; 2 \u0026amp; 3\\\\\n0 \u0026amp; 0 \u0026amp; 0 \u0026amp; 3 \u0026amp; 2 \u0026amp; 3 \u0026amp; 2 \u0026amp; 3\\\\\n0 \u0026amp; 0 \u0026amp; 0 \u0026amp; 8 \u0026amp; 2 \u0026amp; 3 \u0026amp; 2 \u0026amp; 3\\\\ \\end{array}\\right|\n\\end{array}\n$$\nè¿™ä¸ªæ—¶å€™æˆ‘ä»¬æ‹¿ç¬¬ $i$ è¡Œæ— è®ºå¦‚ä½•ä¸å…¶ä»– $n-1$ è¡Œç›¸å‡ï¼Œéƒ½ä¸ä¼šä½¿å‰ $i-1$ åˆ—çš„æ•°å‘ç”Ÿä»»ä½•æ”¹å˜ã€‚è¿™æ˜¯å› ä¸ºç¬¬ $i$ è¡Œçš„å‰ $i-1$ åˆ—éƒ½æ˜¯ $0$ ã€‚\nå¾®å°çš„ä¼˜åŒ– è¿™ä¸ªç®—æ³•ä¸»è¦æœ‰ä¸¤ä¸ªå¾®å°çš„ä¼˜åŒ–ï¼šä¸€ä¸ªæ˜¯ç²¾åº¦ä¸Šçš„ä¼˜åŒ–ï¼Œä¸€ä¸ªæ˜¯æ—¶é—´ä¸Šçš„ä¼˜åŒ–ã€‚\nç²¾åº¦ä¼˜åŒ– æ³¨æ„åˆ°æˆ‘ä»¬åœ¨å¤„ç†ç¬¬ $i$ è¡Œçš„æ—¶å€™ï¼Œåœ¨ç¬¬ $i+1 \\rightarrow n$ è¡Œä¹‹é—´çš„è¿™äº›è¡Œä¸ç¬¬ $i$ è¡Œå®Œå…¨æ˜¯å¯ä»¥äº’æ¢çš„ã€‚è€Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬ç”¨ç¬¬ $i$ è¡Œä¸å…¶ä»–è¡Œç›¸å‡çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸ºäº†èƒ½è·å¾—æ›´ä¼˜ç§€çš„ç²¾åº¦ï¼Œå¾€å¾€ä¼šé€‰æ‹©åœ¨ç¬¬ $i$ è¡Œåˆ°ç¬¬ $n$ è¡Œä¸­ï¼Œç¬¬ $i$ åˆ—çš„æ•°çš„ç»å¯¹å€¼æœ€å¤§çš„é‚£ä¸€è¡Œï¼Œä¸ç¬¬ $i$ è¡Œäº¤æ¢ï¼Œç„¶åå†è¿›è¡Œåé¢çš„æ“ä½œã€‚\nå¤§å®¶éƒ½çŸ¥é“ï¼Œæµ®ç‚¹æ•°å‚¨å­˜æ—¶æœ‰ä¸å¯é¿å…çš„è¯¯å·®ï¼Œæ¯”å¦‚ $2.0000001$ ä¹‹ç±»ã€‚è¿™ä¸ªæ—¶å€™å¦‚æœæˆ‘ä»¬éœ€è¦å¯¹è¿™è¡Œä¹˜å¾ˆå¤šå€ï¼Œå°±ä¼šå¯¼è‡´è¯¯å·®çš„æ”¾å¤§ï¼Œè€Œé™¤æ³•åˆ™ä¸ä¼šã€‚\næ—¶é—´ä¼˜åŒ– æ³¨æ„åˆ°äº‹å®ä¸Šæˆ‘ä»¬å†å¤„ç†ç¬¬ $i$ è¡Œçš„æ—¶å€™åªéœ€è¦å¤„ç†ç¬¬ $i+1$ åˆ—ä¹‹åçš„åˆ—ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨è¡Œä¹‹é—´ç›¸å‡çš„æ—¶å€™ï¼Œè¿ç”¨è¿™ä¸ªæŠ€å·§å¤§çº¦å¯ä»¥å‡å°‘ä¸€åŠçš„å¤æ‚åº¦ã€‚\næ— è§£çš„åˆ¤å®š å¦‚æœæˆ‘ä»¬å‘ç°åœ¨å¤„ç†ç¬¬ $i$ è¡Œçš„æ•°çš„æ—¶å€™ï¼Œæ‰€æœ‰èƒ½é€‰çš„ç¬¬ $i$ åˆ—çš„æ•°éƒ½æ˜¯ $0$ ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™ï¼Œè¿™ä¸ªæ–¹ç¨‹å°±æ˜¯æ— è§£æˆ–è€…æ²¡æœ‰å”¯ä¸€è§£çš„ã€‚\nä»£ç  ä»¥Luogu P3389 ã€æ¨¡æ¿ã€‘é«˜æ–¯æ¶ˆå…ƒæ³•ä¸ºä¾‹å­\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;algorithm\u0026gt;#include \u0026lt;cmath\u0026gt;using namespace std; const int MAXN = 110; const double eps = 1e-7; bool gauss(double a[MAXN][MAXN],int n){ for(int i = 1;i\u0026lt;=n;i++){ int r = i; for(int j = i+1;j\u0026lt;=n;j++) if(fabs(a[r][i]) \u0026lt; fabs(a[j][i])) r = j; // å¯»æ‰¾a[r][i]ä½¿å…¶ç»å¯¹å€¼æœ€å¤§  if(r!=i) for(int j = 1;j\u0026lt;=n+1;j++) swap(a[r][j],a[i][j]); // äº¤æ¢ä¸¤åˆ—  if(fabs(a[i][i]) \u0026lt; eps) return false; // å¦‚æœå…¨éƒ¨éƒ½æ˜¯0ï¼Œåˆ™æ— è§£  for(int j = 1;j\u0026lt;=n;j++)if(j!=i){ double t = a[j][i]/a[i][i]; for(int k = i+1;k\u0026lt;=n+1;k++) a[j][k] -= a[i][k] * t; } //ä½¿ç¬¬iä¸ªä½ç½®çš„æ‰€æœ‰å…¶ä»–æ•°éƒ½ä¸º0  } for(int i = 1;i\u0026lt;=n;i++) a[i][n+1]/=a[i][i]; return true; } int n; double num[MAXN][MAXN]; void init(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n); for(int i = 1;i\u0026lt;=n;i++){ for(int j = 1;j\u0026lt;=n+1;j++){ scanf(\u0026#34;%lf\u0026#34;,\u0026amp;num[i][j]); } } } void solve(){ if(gauss(num,n)) for(int i = 1;i\u0026lt;=n;i++) printf(\u0026#34;%.2lf\\n\u0026#34;,num[i][n+1]); else printf(\u0026#34;No Solution\\n\u0026#34;); } int main(){ init(); solve(); return 0; }   ","description":"","id":158,"section":"posts","tags":["æ•°å­¦","é«˜æ–¯æ¶ˆå…ƒ","æ¨¡æ¿"],"title":"é«˜æ–¯æ¶ˆå…ƒæ³•å­¦ä¹ ç¬”è®°","uri":"https://blog.chenqiqian.com/posts/notes-gaussian-elimination/"},{"content":"åŠ é‡Œæ•¦å¤§å­¦çš„ç”Ÿç‰©ç ”ç©¶æ‰€å‘ç°äº†å†³å®šäººå–œä¸å–œæ¬¢åƒè—•çš„åŸºå› åºåˆ— $S$ ,æœ‰è¿™ä¸ªåºåˆ—çš„ç¢±åŸºåºåˆ—å°±ä¼šè¡¨ç°å‡ºå–œæ¬¢åƒè—•çš„æ€§çŠ¶ï¼Œä½†æ˜¯ç ”ç©¶äººå‘˜å‘ç°å¯¹ç¢±åŸºåºåˆ— $S$ ,ä»»æ„ä¿®æ”¹å…¶ä¸­ä¸è¶…è¿‡ $3$ ä¸ªç¢±åŸºï¼Œä¾ç„¶èƒ½å¤Ÿè¡¨ç°å‡ºåƒè—•çš„æ€§çŠ¶ã€‚ç°åœ¨ç ”ç©¶äººå‘˜æƒ³çŸ¥é“è¿™ä¸ªåŸºå› åœ¨ DNA é“¾ $S0$ ä¸Šçš„ä½ç½®ã€‚æ‰€ä»¥ä½ éœ€è¦ç»Ÿè®¡åœ¨ä¸€ä¸ªè¡¨ç°å‡ºåƒè—•æ€§çŠ¶çš„äººçš„ DNA åºåˆ— $S0$ ä¸Šï¼Œæœ‰å¤šå°‘ä¸ªè¿ç»­å­ä¸²å¯èƒ½æ˜¯è¯¥åŸºå› ï¼Œå³æœ‰å¤šå°‘ä¸ª $S0$ çš„è¿ç»­å­ä¸²ä¿®æ”¹å°äºç­‰äºä¸‰ä¸ªå­—æ¯èƒ½å¤Ÿå˜æˆ $S$ ã€‚\né“¾æ¥ Luogu P3763\né¢˜è§£ å…ˆæŠŠä¸¤ä¸ªä¸²æ‹¼åˆ°ä¸€èµ·ï¼Œç„¶åå¤„ç†å‡ºåç¼€æ•°ç»„ï¼Œå»ºç«‹å‡ºRMQçš„STè¡¨ã€‚ç„¶åå¯¹äºæ¯ä¸€ä½éƒ½åˆ¤æ–­æ˜¯å¦æ»¡è¶³æ¡ä»¶å³å¯ï¼Œå³å¾€åå–ä¸‰ä¸ªLCPï¼Œç„¶ååˆ¤æ–­é•¿åº¦å…³ç³»å³å¯ã€‚\næ—¶é—´å¤æ‚åº¦ $O(n)$ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;algorithm\u0026gt;#include \u0026lt;cstring\u0026gt;#include \u0026lt;cmath\u0026gt;using namespace std; const int MAXN = 210000; namespace SA{ int sa[MAXN],rk[MAXN],ht[MAXN],s[MAXN\u0026lt;\u0026lt;1],t[MAXN\u0026lt;\u0026lt;1]; int p[MAXN],b[MAXN],cur[MAXN]; #define pushS(x) sa[cur[s[x]]--] = x #define pushL(x) sa[cur[s[x]]++] = x #define inducedSort(v)\\ fill_n(b,m,0),fill_n(sa,n,-1);\\ for(int i=0;i\u0026lt;n;i++) b[s[i]]++;\\ for(int j=1;j\u0026lt;m;j++) b[j]+=b[j-1];\\ for(int j=0;j\u0026lt;m;j++) cur[j] = b[j]-1;\\ for(int i=n1-1;~i;--i) pushS(v[i]);\\ for(int j=1;j\u0026lt;m;j++) cur[j] = b[j-1];\\ for(int i=0;i\u0026lt;n;i++) if(sa[i]\u0026gt;0 \u0026amp;\u0026amp; t[sa[i]-1]) pushL(sa[i]-1);\\ for(int j=0;j\u0026lt;m;j++) cur[j] = b[j]-1;\\ for(int i=n-1;~i;--i) if(sa[i]\u0026gt;0 \u0026amp;\u0026amp; !t[sa[i]-1]) pushS(sa[i]-1); void sais(int n,int m,int *s,int *t,int *p){ int n1 = t[n-1] = 0,ch = rk[0] = -1,*s1 = s+n; for(int i=n-2;~i;--i) t[i] = s[i]==s[i+1]?t[i+1]:s[i]\u0026gt;s[i+1]; for(int i=1;i\u0026lt;n;i++) rk[i] = (t[i-1]\u0026amp;\u0026amp;!t[i])?(p[n1] = i,n1++):-1; inducedSort(p); for(int i=0,x,y;i\u0026lt;n;i++)if(~(x=rk[sa[i]])){ if(ch\u0026lt;1||p[x+1]-p[x]!=p[y+1]-p[y]) ch++; else for(int j=p[x],k=p[y];j\u0026lt;=p[x+1];j++,k++) if((s[j]\u0026lt;\u0026lt;1|t[j]) != (s[k]\u0026lt;\u0026lt;1|t[k])){ch++;break;} s1[y=x] = ch; } if(ch+1 \u0026lt; n1) sais(n1,ch+1,s1,t+n,p+n1); else for(int i = 0;i\u0026lt;n1;i++) sa[s1[i]] = i; for(int i = 0;i\u0026lt;n1;i++) s1[i] = p[sa[i]]; inducedSort(s1); } template \u0026lt;typename T\u0026gt; int mapChartoInt(int n,const T *str){ int m = *max_element(str,str+n); fill_n(rk,m+1,0);//+1!!!  for(int i = 0;i\u0026lt;n;i++) rk[str[i]] = 1;//=1!  for(int j = 0;j\u0026lt;m;j++) rk[j+1] += rk[j]; for(int i = 0;i\u0026lt;n;i++) s[i] = rk[str[i]]-1; return rk[m]; } // str[n] yange zidianxu zuixiao template \u0026lt;typename T\u0026gt; void suffixArray(int n,const T *str){ int m = mapChartoInt(++n,str); sais(n,m,s,t,p); } void getHeight(int n){ // è¿™é‡Œçš„å¾ªç¯ä¸€å®šè¦åˆ°aï¼  for(int i = 0;i\u0026lt;=n;i++) rk[sa[i]] = i; for(int i = 0,h = ht[0] = 0;i\u0026lt;=n;i++){ int j = sa[rk[i]-1]; while(i+h\u0026lt;n \u0026amp;\u0026amp; j+h\u0026lt;n \u0026amp;\u0026amp; s[i+h] == s[j+h]) h++; if(ht[rk[i]] = h) --h; } } } int n,x,y; char s[MAXN]; namespace ST{ int st[20][MAXN]; void build(int n,int *num){ for(int i = 1;i\u0026lt;=n;i++) st[0][i] = num[i]; for(int j = 1,t = 2;t\u0026lt;=n;j++,t\u0026lt;\u0026lt;=1) for(int i = 1;i+(t\u0026gt;\u0026gt;1)\u0026lt;=n;i++) st[j][i] = min(st[j-1][i],st[j-1][i+(t\u0026gt;\u0026gt;1)]); } int query(int l,int r){ int t = log2(r-l+1); return min(st[t][l],st[t][r-(1\u0026lt;\u0026lt;t)+1]); } } void init(){ scanf(\u0026#34;%s\u0026#34;,s); x = strlen(s); scanf(\u0026#34;%s\u0026#34;,s+x); n = strlen(s); y = n-x; s[n] = \u0026#39;A\u0026#39;-1; SA::suffixArray(n,s); SA::getHeight(n); ST::build(n,SA::ht); } int lcp(int a,int b){ if(a == b) return n - a + 1; a = SA::rk[a],b = SA::rk[b]; if(a \u0026gt; b) swap(a,b); return ST::query(a+1,b); } bool judge(int p){ int cnt = 0,len = 0; while(len \u0026lt; y){ len += lcp(p+len,x+len); if(cnt \u0026gt;= 3 \u0026amp;\u0026amp; len \u0026lt; y) return false; len++,cnt++; } return true; } void solve(){ int ans = 0; for(int i = 0;i\u0026lt;=x-y;i++) if(judge(i)) ans++; printf(\u0026#34;%d\\n\u0026#34;,ans); } int main(){ int T;scanf(\u0026#34;%d\u0026#34;,\u0026amp;T); for(int i = 1;i\u0026lt;=T;i++) init(),solve(); return 0; }   ","description":"","id":159,"section":"posts","tags":["å­—ç¬¦ä¸²","åç¼€æ•°ç»„"],"title":"ã€ŒTJOI2017ã€DNA-åç¼€æ•°ç»„","uri":"https://blog.chenqiqian.com/posts/tjoi2017-dna/"},{"content":"æ‰‹æœºå·ç æ˜¯ä¸€ä¸ªæœ‰ $11$ ä½ä¸”ä¸å«å‰å¯¼ $0$ çš„æ•°ã€‚æ»¡è¶³æ¡ä»¶æ‰‹æœºå·ç çš„å¿…é¡»åŒæ—¶æ»¡è¶³ï¼šå·ç ä¸­å‡ºç°è‡³å°‘ $3$ ä¸ªç›¸é‚»çš„ç›¸åŒæ•°å­—ï¼›å·ç ä¸­ä¸èƒ½åŒæ—¶å‡ºç° $8$ å’Œ $4$ ã€‚\nç»™å®šä¸¤ä¸ªæ•° $L$ å’Œ $R$ ï¼Œç»Ÿè®¡å‡º $[L,R]$åŒºé—´å†…æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„æ‰‹æœºå·ç çš„ä¸ªæ•°ã€‚ $L$ å’Œ $R$ éƒ½æ˜¯ç¬¦åˆå®šä¹‰çš„æ‰‹æœºå·ç ã€‚\né“¾æ¥ Luogu P4124\né¢˜è§£ è¿™ä¸ªé¢˜ç”¨æ•°ä½dpå…¶å®ä¹Ÿå¯ä»¥é€’æ¨ã€‚\nå®šä¹‰ä¸€ä¸ªçŠ¶æ€ $dp[i][j][num][is8][is4]$ ï¼Œå…¶ä¸­ $i$ ä»£è¡¨éœ€è¦è€ƒè™‘çš„æ˜¯å $i$ ä½ï¼› $j$ è¡¨ç¤ºå€’æ•°ç¬¬ $i+1$ ä½æ˜¯æ•°ç  $j$ï¼› $num$ è¡¨ç¤ºç›®å‰çš„è¿å·æ˜¯å‡ ä¸ªï¼ˆ $num = 1,2$ ï¼‰ï¼Œè‹¥è¿™ä¸ªä¸º $3$ åˆ™ä»£è¡¨å·²ç»å‡ºç°äº†è¿ç€ä¸‰ä½ç›¸åŒçš„æ•°å­—ï¼›æœ€åä¸¤ç»´åˆ†åˆ«è¡¨ç¤ºæœ‰æ²¡æœ‰å‡ºç°$8$å’Œæœ‰æ²¡æœ‰å‡ºç° $4$ ã€‚çŠ¶æ€å‚¨å­˜çš„å€¼å°±æ˜¯ç¬¦åˆæ¡ä»¶çš„æ•°çš„ä¸ªæ•°ã€‚\nè¾¹ç•Œæƒ…å†µå°±æ˜¯åœ¨ $i == 0$ çš„æ—¶å€™ã€‚åªæœ‰ num == 3 ä¸” is8 \u0026amp;\u0026amp; is4 == 0 æ—¶ï¼Œè¾¹ç•Œæ‰èƒ½å¾— $1$ ï¼›å¦åˆ™å°±å¾— $0$ ã€‚\nå…¶æ¬¡è½¬ç§»å°±å¥½äº†ã€‚æšä¸¾ä¸‹ä¸€ä¸ªæ•°ä½ä» $0$ åˆ° $9$ ï¼Œç„¶åæ ¹æ®æ–°çš„æ•°ä½è®¡ç®—å‡º $num$ ï¼Œ $is8$ ï¼Œ $is4$ ç­‰ä¿¡æ¯ï¼Œè½¬ç§»å°±å¯ä»¥äº†ã€‚è¿™é‡Œçš„ $num$ å¦‚æœå·²ç»ä¸º $3$ ï¼Œå°±ç®—ä¸ä¸Šä¸€ä½ç›¸åŒï¼Œæˆ‘ä»¬ä¹Ÿä¸å†å¾€ä¸ŠåŠ äº†ï¼›å¦‚æœä¸æ˜¯3çš„è¯æ‰å¾€ä¸ŠåŠ ã€‚\næ³¨æ„åœ¨è®¡ç®—çŠ¶æ€çš„æ—¶å€™ï¼Œè¦æŠŠæ‰€æœ‰ is8 \u0026amp;\u0026amp; is4 == 1 çš„æƒ…å†µå…¨éƒ½ç½®ä½œ $0$ ã€‚\nè®¡ç®—ç­”æ¡ˆçš„è¯ï¼Œå°±æŒ‰ç…§æ™®é€šæ•°ä½ dp çš„ç»Ÿè®¡æ–¹å¼å»ç»Ÿè®¡å°±å¯ä»¥äº†ï¼šæŠŠæ¯ä¸€ä½éƒ½æ‹†ä¸‹æ¥ï¼Œåœ¨æ¯ä¸€ä½éƒ½å–åˆ°æ‰€æœ‰æ¯”è¿™ä¸€ä½å°çš„æ•°ï¼Œæœ€åå†åŠ ä¸Šæœ€åä¸€ä¸ªæ•°çš„æƒ…å†µã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62  #include \u0026lt;cstdio\u0026gt;using namespace std; #define ll long long  const int MAXN = 12; ll x,y; ll dp[MAXN][MAXN][4][2][2]; //dp[i][j][num][is8][is4]; //åiä½ï¼Œä¸Šä¸€ä¸ªæ•°å­—æ˜¯jï¼Œè¿ç»­å‡ºç°äº†numä¸ªæ•°ï¼Œæœ‰æ²¡æœ‰å‡ºç°8ï¼Œæœ‰æ²¡æœ‰å‡ºç°4  void init(){ scanf(\u0026#34;%lld %lld\u0026#34;,\u0026amp;x,\u0026amp;y); } void solve(){ for(int i = 0;i\u0026lt;=11;i++) for(int j = 0;j\u0026lt;=9;j++) for(int num = 1;num\u0026lt;=3;num++) for(int is8 = 0;is8\u0026lt;=1;is8++) for(int is4 = 0;is4\u0026lt;=1;is4++){ ll \u0026amp;t = dp[i][j][num][is8][is4]; if(i == 0) t = (num==3?1:0);// è¾¹ç•Œçš„åˆ¤å®š  else for(int w = 0;w\u0026lt;=9;w++){ t += dp[i-1][w][num==3?3:w==j?num+1:1][is8||(w==8)][is4||(w==4)]; if(is8 \u0026amp;\u0026amp; is4) t = 0; } } } ll cal(ll x){ if (x \u0026lt; 1e10) return 0; int d[20],cnt = 0; while(t) d[++cnt] = x%10,x/=10; d[cnt+1] = 0; ll ans = 0;int num = 0,is8 = 0,is4 = 0; for(int i = cnt;i\u0026gt;=1;--i){ for(int j = 0;j\u0026lt;d[i];j++) ans += dp[i-1][j][num==3?3:d[i+1]==j?num+1:1][(j==8)||is8][(j==4)||is4]; // è¯¥ä½å°äºé™å®šæ•° \tnum = (num == 3?3:d[i]==d[i+1]?num+1:1); is8 |= d[i] == 8; is4 |= d[i] == 4; } ans -= dp[10][0][1][0][0];//å‡å»å­˜åœ¨å‰ç¼€0çš„æƒ…å†µ  ans += dp[0][d[1]][num][is8][is4]; return ans; } void getans(){ ll ans = cal(y)-cal(x-1); printf(\u0026#34;%lld\\n\u0026#34;,ans); } int main(){ init(); solve(); getans(); return 0; }   ","description":"","id":160,"section":"posts","tags":["æ•°ä½dp","åŠ¨æ€è§„åˆ’"],"title":"ã€ŒCQOI2016ã€æ‰‹æœºå·ç -æ•°ä½dp","uri":"https://blog.chenqiqian.com/posts/cqoi2016-phone/"},{"content":"ç»™å®šä¸¤ä¸ªæ­£æ•´æ•° $a$ å’Œ $b$ ï¼Œæ±‚åœ¨ $[a,b]$ ä¸­çš„æ‰€æœ‰æ•´æ•°ä¸­ï¼Œæ¯ä¸ªæ•°ç (digit)å„å‡ºç°äº†å¤šå°‘æ¬¡ã€‚\né“¾æ¥ Luogu P2602\né¢˜è§£ æ¯”è¾ƒå…¥é—¨çš„æ•°ä½dp\u0026hellip;å¾ˆé€‚åˆæˆ‘è¿™ç§è’Ÿè’»ã€‚\nä»¤ $dp[i][j]$ ä¸ºå½“å€’æ•°ç¬¬ $i$ ä½ä¸º $j$ æ—¶ï¼Œå $i$ ä½çš„æ•°ç æ€»è®¡ï¼ˆä¸€ä¸ªå‚¨å­˜ç€åä¸ªæ•´æ•°çš„ç»“æ„ä½“ï¼ŒåŠ å‡å³ä¸ºå¯¹ä½åŠ å‡ï¼‰ã€‚è‹¥ $j=10$ ï¼Œåˆ™ä»£è¡¨è¿™ä½æ˜¯å‰å¯¼ $0$ ã€‚(æ„Ÿè§‰è¿™ä¸ªææ³•æœ‰ç‚¹ç¬¨æ‹™\u0026hellip;å·¨ä½¬èƒ½ä¸èƒ½æ•™æ•™æˆ‘\u0026hellip;)\nä»¤ $sum(i,j)$ ä¸ºæœ‰ $i$ æ•°ç æœ‰ $j$ ä¸ªï¼Œå…¶ä»–å‡ä¸º $0$ çš„çŠ¶æ€ã€‚\nåˆ™çŠ¶æ€è½¬ç§»æ–¹ç¨‹ä¸ºï¼š\n$$dp[1][j] = sum(j,1)$$\n$$dp[i][j] = sum(j,10^{i-1}) + \\sum_{w = 0}^{9} dp[i-1][w]; ,0\\leq j \\leq 9$$\n$$dp[i][10] = \\sum_{w = 1}^{10} dp[i-1][w]$$\nè®¡ç®—ç­”æ¡ˆæ—¶ï¼Œè¿™ä¸ªå®åœ¨ä¸å¤ªå¥½è¯´\u0026hellip;çœ‹ä»£ç çš„æ³¨é‡Šä¼šæ›´å¥½ç†è§£\u0026hellip;\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96  #include \u0026lt;cstdio\u0026gt;using namespace std; #define ll long long  ll a,b; const int MAXN = 20; struct sum{ ll num[10]; sum(int pos = -1,ll d = 1){ for(int i = 0;i\u0026lt;10;i++) num[i] = 0; if(~pos) num[pos] = d; } sum operator +(const sum a)const{ sum ans = sum(); for(int i = 0;i\u0026lt;=9;i++) ans.num[i] = this-\u0026gt;num[i] + a.num[i]; return ans; } sum operator *(const int a)const{ sum ans = sum(); for(int i = 0;i\u0026lt;=9;i++) ans.num[i] = this-\u0026gt;num[i] * a; return ans; } sum operator -(const sum a)const{ sum ans = sum(); for(int i = 0;i\u0026lt;=9;i++) ans.num[i] = this-\u0026gt;num[i] - a.num[i]; return ans; } }; sum dp[MAXN][MAXN]; ll t[MAXN]; //dp[i][j] -\u0026gt; åiä½ï¼Œå€’æ•°ç¬¬iä½ä¸ºj,j == 10 ä»£è¡¨ä¸ºå…ˆå¯¼0  void init(){ scanf(\u0026#34;%lld %lld\u0026#34;,\u0026amp;a,\u0026amp;b); t[0] = 1; for(int i = 1;i\u0026lt;=15;i++) t[i] = 10*t[i-1]; } void build(){ for(int j = 0;j\u0026lt;=9;j++) dp[1][j] = sum(j,1); for(int i = 2;i\u0026lt;=15;i++){ for(int j = 0;j\u0026lt;=9;j++){ dp[i][j] = sum(j,t[i-1]); for(int w = 0;w\u0026lt;=9;w++) dp[i][j] = dp[i][j] + dp[i-1][w]; } dp[i][10] = sum(); for(int w = 1;w\u0026lt;=10;w++) dp[i][10] = dp[i][10] + dp[i-1][w]; } } sum getnum(ll a){ ll tmp = a; sum ans = sum(0,1); if(a == 0) return sum(0,1); int num[15],cnt = 0; while(a){ num[++cnt] = a % 10; a/=10; } ans = ans + dp[cnt][10] - dp[cnt][0]; //åŠ ä¸Šåœ¨è¿™ä¸€ä½æœ‰å‰å¯¼0ï¼Œå†é™¤å»åœ¨è¿™ä¸€ä½æ˜¯0çš„  for(int i = cnt;i\u0026gt;=1;--i){ for(int j = 0;j\u0026lt;num[i];++j) ans = ans + dp[i][j]; //åŠ ä¸Šæ‰€æœ‰æ¯”å½“å‰ä½ç½®å°çš„æ•°çš„æ•°ç   ans = ans + sum(num[i],tmp%t[i-1]+1); //è¡¥ä¸Šåé¢çš„æ•°ä¸­ä¸å†è®¡ç®—çš„è¿™ä¸€ä½çš„æ•°ç   } return ans; } void solve(){ sum ans = getnum(b)-getnum(a-1); for(int i = 0;i\u0026lt;=9;i++){ printf(\u0026#34;%lld \u0026#34;,ans.num[i]); } printf(\u0026#34;\\n\u0026#34;); } int main(){ init(); build(); solve(); return 0; }   ","description":"","id":161,"section":"posts","tags":["æ•°ä½dp","åŠ¨æ€è§„åˆ’"],"title":"ã€ŒZJOI2010ã€æ•°å­—è®¡æ•°-æ•°ä½dp","uri":"https://blog.chenqiqian.com/posts/zjoi2010-count/"},{"content":"JSOI ä¿¡æ¯å­¦ä»£è¡¨é˜Ÿä¸€å…±æœ‰ $N$ åå€™é€‰äººï¼Œè¿™äº›å€™é€‰äººä» $1$ åˆ° $N$ ç¼–å·ã€‚æ–¹ä¾¿èµ·è§ï¼ŒJYY çš„ç¼–å·æ˜¯ $0$ å·ã€‚æ¯ä¸ªå€™é€‰äººéƒ½ç”±ä¸€ä½ç¼–å·æ¯”ä»–å°çš„å€™é€‰äºº$R_i$æ¨èã€‚å¦‚æœ $R_i = 0$ ï¼Œåˆ™è¯´æ˜è¿™ä¸ªå€™é€‰äººæ˜¯ JYY è‡ªå·±çœ‹ä¸Šçš„ã€‚\nä¸ºäº†ä¿è¯å›¢é˜Ÿçš„å’Œè°ï¼ŒJYY éœ€è¦ä¿è¯ï¼Œå¦‚æœæ‹›å‹Ÿäº†å€™é€‰äºº $i$ï¼Œé‚£ä¹ˆå€™é€‰äºº $R_i$ ä¹Ÿä¸€å®šéœ€è¦åœ¨å›¢é˜Ÿä¸­ã€‚å½“ç„¶äº†ï¼ŒJYY è‡ªå·±æ€»æ˜¯åœ¨å›¢é˜Ÿé‡Œçš„ã€‚æ¯ä¸€ä¸ªå€™é€‰äººéƒ½æœ‰ä¸€ä¸ªæˆ˜æ–—å€¼ $P_i$ ï¼Œä¹Ÿæœ‰ä¸€ä¸ªæ‹›å‹Ÿè´¹ç”¨ $S_i$ã€‚JYY å¸Œæœ›æ‹›å‹Ÿ $K$ ä¸ªå€™é€‰äººï¼ˆJYY è‡ªå·±ä¸ç®—ï¼‰ï¼Œç»„æˆä¸€ä¸ªæ€§ä»·æ¯”æœ€é«˜çš„å›¢é˜Ÿã€‚ä¹Ÿå°±æ˜¯ï¼Œè¿™ $K$ ä¸ªè¢« JYY é€‰æ‹©çš„å€™é€‰äººçš„æ€»æˆ˜æ–—å€¼ä¸æ€»æ‹›å‹Ÿè´¹ç”¨çš„æ¯”å€¼æœ€å¤§ã€‚\né“¾æ¥ Luogu P4322\nä»£ç  è¿™é¢˜çœ‹ç€å¾ˆé«˜ç«¯\u0026hellip;äº‹å®ä¸Šå°±æ˜¯ä¸€ä¸ª0/1åˆ†æ•°è§„åˆ’+æ ‘å½¢dp\u0026hellip;\n0/1åˆ†æ•°è§„åˆ’çš„è¿‡ç¨‹ï¼Œå°±æ˜¯äºŒåˆ†é€‰æ‹©ä¸€ä¸ªç­”æ¡ˆ $ans$ ï¼Œç„¶åå»éªŒè¯èƒ½ä¸èƒ½å–åˆ°è‹¥å¹²ä¸ª $P_i - ans \\times S_i$ å¤§äº0ã€‚\nèƒ½ä¸èƒ½å–åˆ°è¿™ä¸ªå¤§äº $0$ çš„ä¸œè¥¿ï¼Œç”¨ $O(n^2)$ çš„æ ‘å½¢dpéªŒè¯ä¸€ä¸‹å°±å¥½äº†ã€‚\næˆ‘è¿™ä¸ªä»£ç å¥½åƒæœ‰ç‚¹é”…ï¼Œä¸å¼€O2å°±RE\u0026hellip;æ‡’å¾—æ‰¾äº†\u0026hellip;å°±è¿™æ ·å§\u0026hellip;\nè¿™é‡Œçš„åˆå§‹åŒ–ä¹Ÿè¦æ³¨æ„ä¸€ä¸‹ï¼Œè¿˜æœ‰å°±æ˜¯å¾ªç¯çš„è¾¹ç•Œï¼Œå› ä¸ºè¿™é‡Œçˆ¶èŠ‚ç‚¹å¿…é¡»å–ï¼Œç¬¬ä¸€å±‚å¾ªç¯å°±ä¸èƒ½åˆ° $0$ \u0026hellip;\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;vector\u0026gt;#include \u0026lt;cstring\u0026gt;using namespace std; const int MAXN = 3000; const double eps = 1e-4; int n,m; double s[MAXN],p[MAXN]; int siz[MAXN]; double dp[MAXN][MAXN]; vector\u0026lt;int\u0026gt; edge[MAXN]; double k; double tmp[MAXN]; void dfs(int x){ for(int j = 0;j \u0026lt; MAXN;j++) dp[x][j] = -1e9; siz[x] = 1;dp[x][0] = 0;dp[x][1] = p[x] - k*s[x]; for(int i = 0;i\u0026lt;edge[x].size();i++){ int v = edge[x][i]; dfs(v); for(int j = 0;j\u0026lt;=siz[x] + siz[v];j++) tmp[j] = -1e9; for(int j = 0;j\u0026lt;=siz[x];j++) tmp[j] = dp[x][j]; for(int j = siz[x];j \u0026gt;= 1;--j) for(int w = siz[v];w \u0026gt;= 0;--w) if(j+w \u0026lt;= m) tmp[j+w] = max(tmp[j+w],dp[x][j] + dp[v][w]); memcpy(dp[x],tmp,sizeof(double)*(siz[x] + siz[v]+1)); siz[x] += siz[v]; } } bool check(double num){ k = num; dfs(0); return dp[0][m] \u0026gt; -eps; } int main(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;m,\u0026amp;n);m++; int f; for(int i = 1;i\u0026lt;=n;i++){ scanf(\u0026#34;%lf %lf %d\u0026#34;,\u0026amp;s[i],\u0026amp;p[i],\u0026amp;f); edge[f].push_back(i); } double l = 0,r = 10000; while(r - l \u0026gt; eps){ double mid = (l+r)/2; if(check(mid)) l = mid; else r = mid; } printf(\u0026#34;%.3lf\\n\u0026#34;,l); return 0; }   ","description":"","id":162,"section":"posts","tags":["0/1åˆ†æ•°è§„åˆ’","æ ‘å½¢ç»“æ„","æ ‘å½¢dp"],"title":"ã€ŒJSOI2016ã€æœ€ä½³å›¢ä½“-æ ‘ä¸ŠèƒŒåŒ…+0/1åˆ†æ•°è§„åˆ’","uri":"https://blog.chenqiqian.com/posts/jsoi2016-team/"},{"content":"ç»™å®šä¸¤ä¸ªæ•´æ•° $n,m$ ï¼Œå¯¹äºå¹³é¢ä¸Šçš„æ•´ç‚¹ ${(x,y)|x \\in [1,n],y \\in [1,m],x,y \\in \\mathbb Z}$ ã€‚è‹¥ $(x,y)$ ä¸ $(0,0)$ çš„è¿çº¿ä¸Šæœ‰ $k$ ä¸ªæ•´ç‚¹ï¼ˆä¸åŒ…æ‹¬ $(0,0),(n,m)$ ï¼‰ï¼Œåˆ™äº§ç”Ÿçš„è´¡çŒ®ä¸º $2k+1$ ã€‚æ±‚æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„ç‚¹çš„è´¡çŒ®æ€»å’Œã€‚\né“¾æ¥ Luogu P1447\né¢˜è§£ ç»™å‡ºä¸€ä¸ªç»“è®ºï¼šä» $(0,0)$ åˆ° $(n,m)$ çš„\u0008çº¿æ®µä¸Šï¼Œæœ‰ $gcd(n,m)-1$ ä¸ªæ•´ç‚¹(ä¸åŒ…æ‹¬ç«¯ç‚¹)ã€‚æƒ³ä¸€æƒ³å¾ˆå¥½æ˜ç™½ï¼šä»¤ $t$ æ˜¯ $n,m$ çš„å…¬å› æ•°ï¼Œ $(\\frac {n}{t},\\frac {m}{t})$ å°±ç›¸å½“äºæ­¥é•¿ï¼Œ $m,n$ ä¸€å®šæ—¶ $t$ è¶Šå¤§ï¼Œæ­¥é•¿è¶Šå°ï¼Œæ•´ç‚¹å°±è¶Šå¤šã€‚ $gcd(n,m)$ æ˜¯ $n,m$ çš„æœ€å¤§å…¬å› æ•°ï¼Œæ‰€ä»¥å°±æ˜¯æœ€å¤šæ•´ç‚¹çš„ä¸ªæ•°äº†ã€‚\næ‰€ä»¥é—®é¢˜è½¬åŒ–ä¸ºï¼š\næ±‚\n$$\\sum_{i = 1}^{n} \\sum_{j = 1}^{m}2\\times gcd(n,m)-1$$\nçš„å€¼ã€‚\næ˜¾ç„¶é«˜ç«¯çš„æ•°å­¦æ–¹æ³•æˆ‘è‚¯å®šæ˜¯ä¸ä¼šçš„ã€‚é‚£æ€ä¹ˆåŠå‘¢ã€‚\næ•°æ®èŒƒå›´ä¸å…è®¸æˆ‘ä»¬æ±‚å‡ºå¯¹äºæ¯ä¸€ä¸ª $n,m$ çš„ $gcd$ ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥æƒ³åŠæ³•æ±‚å‡ºå¯¹äºæ¯ä¸€ä¸ª $w$ ï¼Œ $gcd(i,j) = w$ çš„ $(i,j)$ å¯¹æ•°ï¼Œç„¶åå°±å¯ä»¥ $O(n)$ çš„åŠ å‡ºç»“æœäº†ã€‚\nè¿™ä¸ªä¸œè¥¿çš„è¯ä¹Ÿä¸å¤ªå¥½æ±‚\u0026hellip;ä½†æ˜¯æˆ‘ä»¬å¯ä»¥æ±‚å‡ºä»¥ $w$ ä¸ºçº¦æ•°çš„æ ‘çš„ä¸ªæ•°ï¼å¯¹äºä¸€ä¸ª $w$ ï¼Œå‡ä»¥ $w$ ä¸ºçº¦æ•°çš„ $(i,j)$ çš„ä¸ªæ•°å°±æ˜¯ $\\lfloor \\frac{n}{w} \\rfloor \\times \\lfloor \\frac{m}{w} \\rfloor$ ã€‚\nè¿˜æœ‰ä¸€ä»¶äº‹æƒ…ï¼Œå°±æ˜¯ä»¥ $w$ ä¸ºæœ€å¤§å…¬å› æ•°çš„æ•°çš„ä¸ªæ•°å°±æ˜¯ä»¥ $w$ ä¸ºçº¦æ•°çš„æ•°çš„ä¸ªæ•°å‡å»ä»¥ $kw(k = 2,3,4\u0026hellip;)$ ä¸ºæœ€å¤§å…¬å› æ•°çš„ä¸ªæ•°ã€‚\nç„¶åæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹ä»ä¸Šå¾€ä¸‹çš„é€’æ¨äº†ï¼Œè®¡ç®—çš„æ—¶å€™æ¯æ¬¡å¾€ä¸Šè·³ $w$ ï¼Œç›´åˆ°è¶…ç•Œï¼Œç„¶åéƒ½å‡å»å°±å¯ä»¥äº†ã€‚\næ ¹æ®ä¸€äº›è°ƒå’Œçº§æ•°çš„ä¸œè¥¿ï¼Œ $1+\\frac{1}{2}+\\frac{1}{3}\u0026hellip;+\\frac{1}{n} \\approx \\ln n$ ï¼Œæ‰€ä»¥æœ€åçš„å¤æ‚åº¦å¤§çº¦æ˜¯ $O(n \\ln n)$ ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;algorithm\u0026gt;#define int long long using namespace std; const int MAXN = 110000; int n,m,w,f[MAXN]; void init(){ scanf(\u0026#34;%lld %lld\u0026#34;,\u0026amp;n,\u0026amp;m); w = min(n,m); } void solve(){ int ans = 0; for(int i = w;i\u0026gt;=1;--i){ f[i] = (n/i) * (m/i); for(int j = 2*i;j\u0026lt;=w;j+=i) f[i] -= f[j]; ans += f[i]*(2*i-1); } printf(\u0026#34;%lld\\n\u0026#34;,ans); } signed main(){ init(); solve(); return 0; }   ","description":"","id":163,"section":"posts","tags":["æ•°å­¦","æœ€å¤§å…¬çº¦æ•°"],"title":"ã€ŒNOI2010ã€èƒ½é‡é‡‡é›†-ç®€å•æ•°å­¦","uri":"https://blog.chenqiqian.com/posts/noi2010-energy/"},{"content":"ç»™å®šä¸€ä¸ª $n$ ä¸ªç‚¹ $m$ æ¡è¾¹çš„æ— å‘å›¾ï¼Œæ¯æ¡è¾¹æœ‰ä¸¤ä¸ªæƒå€¼ $a_i,b_i$ ã€‚è¯·ä½ æ‰¾åˆ°ä¸€æ¡ä» $1 \\rightarrow n$ çš„é“è·¯ï¼Œä»¤é“è·¯ä¸Šæ‰€æœ‰è¾¹çš„é›†åˆä¸º $S$ ï¼Œä½¿ $ans = \\max(a_i)+\\max(b_j),i,j \\in S$ æœ€å°ï¼Œæ±‚å‡ºè¿™ä¸ªæœ€å°å€¼ $ans$ ã€‚\né“¾æ¥ Luogu P2387\nBZOJ 3669\né¢˜è§£ è¿™é¢˜å‘Šè¯‰æˆ‘ä»¬äº†ä¸€ä¸ª LCT (è¿çŒ«æ ‘)çš„æ–°ç”¨æ³•ï¼šåŠ¨æ€ç»´æŠ¤æœ€å°ç”Ÿæˆæ ‘ã€‚\næ€è€ƒä¸€ä¸‹ï¼šå¦‚æœæˆ‘ä»¬æœ‰ä¸€é¢—ç”Ÿæˆæ ‘ï¼Œç°åœ¨å†æ·»åŠ è¿›ä¸€æ¡è¾¹ï¼Œå›¾é‡Œå¿…ç„¶ä¼šå‡ºç°ä¸€ä¸ªç¯ã€‚è€Œæ–°çš„æœ€å°ç”Ÿæˆæ ‘å°±æ˜¯åœ¨è¿™ä¸ªç¯é‡Œé¢ç æ‰æœ€å¤§çš„é‚£ä¸€æ¡è¾¹è€Œå¾—åˆ°çš„ã€‚\nè¿™æ˜¯éå¸¸æ˜¾ç„¶çš„ã€‚\nå¯ä»¥å‘ç°ä¸€ä¸ªç»“è®ºï¼Œå°±æ˜¯ç»™å®šä¸€ä¸ªæ— å‘å›¾ï¼Œé‚£ä¹ˆ $1 \\rightarrow n$ è·¯å¾„ä¸Šè¾¹æƒæœ€å¤§å€¼æœ€å°çš„è¿™äº›è¾¹ä¸€å®šåœ¨å…¶æœ€å°ç”Ÿæˆæ ‘é‡Œé¢ã€‚è¿™ä¸ªåªè¦è€ƒè™‘ä¸€ä¸‹ $Kruskal$ ç®—æ³•çš„è¿‡ç¨‹å°±å¾ˆå®¹æ˜“æ˜ç™½ã€‚\né‚£ä¹ˆå†å›æ¥çœ‹è¿™ä¸ªé—®é¢˜ã€‚å¦‚æœè¿™ä¸ªåœ°æ–¹åªæœ‰ä¸€ç»´çš„é™åˆ¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç”¨å¹¶æŸ¥é›†åšã€‚è¿™æ˜¯ä¸€ä¸ªç¦»çº¿çš„åšæ³•ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æŠŠæ‰€æœ‰è¾¹ä¸€è‚¡è„‘çš„æ‰”è¿›å»ï¼Œæ‹¿åˆ°ä¸€ä¸ªæœ€å°ç”Ÿæˆæ ‘ï¼Œç„¶åç­”æ¡ˆå°±æ˜¯è¿™ä¸¤ç‚¹ä¹‹é—´çš„è¾¹æƒæœ€å¤§å€¼ã€‚ï¼ˆå…¶å®æ˜¯å¹¶æŸ¥é›†ç›´åˆ°ä¸¤ä¸ªä¸œè¥¿è”é€šä¸ºæ­¢ï¼‰\nä½†æ˜¯ç°åœ¨æœ‰äº† $a$ è¿™ä¸€ç»´çš„é™åˆ¶ï¼Œè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿè€ƒè™‘ä¸€ä¸‹è´ªå¿ƒçš„åšæ³•ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ LCT åŠ¨æ€ç»´æŠ¤æœ€å°ç”Ÿæˆæ ‘çš„ç‰¹ç‚¹ã€‚\nè€ƒè™‘å¯¹äº $a$ æ’åºä¹‹åï¼Œå°±å¯ä»¥æ’é™¤æ‰ $a$ å¯¹è¿™ä¸ªä¸œè¥¿çš„å¹²æ‰°ã€‚ç„¶åæˆ‘ä»¬æŒ‰ç…§ $a$ ä»å°åˆ°å¤§å¾€æ ‘é‡Œé¢åŠ è¾¹ï¼Œæ¯æ¬¡ç»´æŠ¤æœ€å°ç”Ÿæˆæ ‘ï¼Œç­”æ¡ˆå°±å¯ä»¥ç”¨ $a_{now} + b_{max}$ æ¥æ±‚å¾—ï¼ŒåŠ¨æ€æ›´æ–°å³å¯ã€‚\nä¸ºä»€ä¹ˆè¿™ä¸ªä¸œè¥¿æ˜¯æ­£ç¡®çš„å‘¢ï¼Ÿå¦‚æœè·¯å¾„ä¸Šçš„ $a_{max} \u0026lt; a_{now}$ ï¼Œä¼šä¸ä¼šå¯¹ç­”æ¡ˆé€ æˆå½±å“ï¼Ÿ\nä¸ä¼šã€‚å› ä¸ºå¦‚æœ $a_{max} \u0026lt; a_{now}$ ï¼Œé‚£ä¹ˆåœ¨æˆ‘ä»¬åŠ åˆ° $a_{max}$ è¿™æ¡è¾¹çš„æ—¶å€™ï¼Œå…¶æ‰€æœ‰è·¯å¾„ä¸Šçš„è¾¹åº”è¯¥å·²ç»å‡ºç°ï¼Œå°±å¯ä»¥å›Šæ‹¬ $a_{max} + b_{max}$ è¿™ç§æƒ…å†µäº†ã€‚è€Œå¦‚æœåé¢æ¢ç”¨äº†å…¶ä»– $b$ æ›´å°çš„è¾¹ï¼Œæ˜¾ç„¶ $a_{max}$ ä¼šæ‰©å¤§ä¸º $a_{now}$ ï¼Œç®—æ³•çš„æ­£ç¡®æ€§å°±å¯ä»¥ä¿è¯äº†ã€‚\nLCT åªèƒ½ç»´æŠ¤ç‚¹æƒï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠè¾¹æ¢æˆç‚¹ï¼Œæ¯æ¬¡ $link$ æˆ–è€… $cat$ çš„æ—¶å€™è¿æˆ–è€…çŒ«ä¸¤ä¸‹å°±å¯ä»¥äº†ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;algorithm\u0026gt;#include \u0026lt;cctype\u0026gt;using namespace std; namespace fast_io { //... }using namespace fast_io; const int MAXN = 151000; struct Link_Cat_Tree{ int val[MAXN],maxn[MAXN]; int c[MAXN][2],f[MAXN]; bool rev[MAXN]; int getmax(int u,int x,int y){ if(val[u] \u0026gt;= val[maxn[x]] \u0026amp;\u0026amp; val[u] \u0026gt;= val[maxn[y]]) return u; else if(val[maxn[x]] \u0026gt;= val[maxn[y]]) return maxn[x]; else return maxn[y]; } bool noroot(int x){ return (c[f[x]][1] == x) || (c[f[x]][0] == x); } void push_up(int x){ if(!x) return; maxn[x] = getmax(x,c[x][0],c[x][1]); } void reverse(int x){ if(!x) return; swap(c[x][0],c[x][1]); rev[x]^=1; } void push_down(int x){ if(!x) return; if(rev[x]){ reverse(c[x][0]),reverse(c[x][1]); rev[x] = 0; } } void push_all(int x){ if(!x) return; if(noroot(x)) push_all(f[x]); push_down(x); } void rotate(int x){ int y = f[x],z = f[y],t = (c[y][1] == x),w = c[x][1-t]; if(noroot(y)) c[z][c[z][1]==y] = x; c[x][1-t] = y;c[y][t] = w; if(w) f[w] = y; f[y] = x;f[x] = z; push_up(y),push_up(x); } void splay(int x){ push_all(x); while(noroot(x)){ int y = f[x],z = f[y]; if(noroot(y)) (c[z][1] == y) ^ (c[y][1] == x) ? rotate(x):rotate(y); rotate(x); } } void access(int x){ for(int y = 0;x;x=f[y=x]){ splay(x); c[x][1] = y,push_up(x); } } void makeroot(int x){ access(x);splay(x);reverse(x); } int findroot(int x){ access(x);splay(x); push_down(x); while(c[x][0]) x = c[x][0],push_down(x); return x; } void link(int x,int y){ makeroot(x); if(findroot(y) != x) f[x] = y; } void cat(int x,int y){ makeroot(x); if(findroot(y) == x \u0026amp;\u0026amp; f[x] == y \u0026amp;\u0026amp; !c[x][1]) f[x] = c[y][0] = 0,push_up(y); } void split(int x,int y){ makeroot(x),access(y),splay(y); } int querymax(int x,int y){ return split(x,y),maxn[y]; } }T; //ç‚¹1-\u0026gt;n è¾¹n+1-\u0026gt;n+m int n,m; struct Edge{ int from,to,a,b; }edge[MAXN]; bool cmp(Edge x,Edge y){ return x.a \u0026lt; y.a; } void init(){ read(n),read(m); int a,b,f,t; for(int i = 1;i\u0026lt;=m;i++){ read(f),read(t),read(a),read(b); edge[i] = (Edge){f,t,a,b}; } } void solve(){ int ans = 0x3f3f3f3f; sort(edge + 1,edge+m+1,cmp); for(int i = 1;i\u0026lt;=m;i++) T.val[n+i] = edge[i].b; for(int i = 1;i\u0026lt;=n+m;i++) T.maxn[i] = i; int x = 0,y = 0,a = 0,b = 0; for(int i = 1;i\u0026lt;=m;i++){ x = edge[i].from,y = edge[i].to; a = edge[i].a,b = edge[i].b; if(x == y) continue; if(T.findroot(x)!=T.findroot(y)) T.link(n+i,x),T.link(n+i,y); else{ int t = T.querymax(x,y) - n; if(edge[t].b \u0026lt; b) continue; T.cat(n+t,edge[t].from),T.cat(n+t,edge[t].to); T.link(n+i,x),T.link(n+i,y); } if(T.findroot(1) == T.findroot(n)) ans = min(ans,a+edge[T.querymax(1,n)-n].b); } if(ans \u0026gt; 1000000000) print(-1); else print(ans); print(\u0026#39;\\n\u0026#39;); } int main(){ init(); solve(); flush(); return 0; }   ","description":"","id":164,"section":"posts","tags":["æ•°æ®ç»“æ„","LCT"],"title":"ã€ŒNOI2014ã€é­”æ³•æ£®æ—-LCT","uri":"https://blog.chenqiqian.com/posts/noi2014-forest/"},{"content":"ä»€ä¹ˆæ˜¯æ¢¦æƒ³å‘¢\u0026hellip;\nåº æœ‰çš„æ—¶å€™ï¼Œæ€»ä¼šæœ‰äººé—®æˆ‘ï¼šâ€œä½ æœ‰æ¢¦æƒ³å—ï¼Ÿâ€æˆ‘å‘æ¥æ˜¯æœ€çƒ¦è¿™ç§é—®é¢˜çš„ï¼Œæ‰€ä»¥å¾€å¾€æªå¡ä¸€å¥å›å»ï¼šâ€œæ²¡æœ‰ã€‚æˆ‘å°±æ˜¯æ¡æ²¡æœ‰æ¢¦æƒ³çš„å’¸é±¼ã€‚â€\næœ€è¿‘å†™å®Œä½œæ–‡ï¼Œå†å»ç»†ç»†å›æƒ³ï¼Œæˆ–è®¸æˆ‘ä¹Ÿæ›¾æœ‰è¿‡æ¢¦ï¼Œåªä¸è¿‡å¤§çº¦æ˜¯å¿˜è®°äº†å§ã€‚\næ¢¦Â·æƒ³ ä¸€ æˆ‘ä¸æ€ä¹ˆåšæ¢¦ã€‚æˆ‘è‡ªè®¤ä¸ºæˆ‘æ˜¯ä¸€ä¸ªéå¸¸ç°å®çš„äººï¼Œç°å®åˆ°ä¸ä¼šå¹»æƒ³ï¼Œç°å®åˆ°æ€»ä¼šå¦å®šè‡ªå·±ï¼Œç°å®åˆ°ä¸ä¼šåšæ¢¦ã€‚\næŸäººå°±ä¸ä¸€æ ·ã€‚å¦‚æœè¯´æˆ‘æ˜¯ä¸ªç°å®ä¸»ä¹‰çš„äººï¼Œé‚£ä¹ˆæˆ‘è§‰å¾—è¿™ä½çš„ç”Ÿæ´»é‡Œï¼Œæ›´å¤šçš„æ˜¯äº›è®¸æµªæ¼«ä¸»ä¹‰çš„æƒ…æ€€å’Œæ´’è„±ã€‚æŸäººçš„æ¢¦ï¼Œå°±æ¯”æˆ‘çš„æœ‰è¶£çš„å¤šäº†ã€‚\nä½†æˆ‘ä¹Ÿæœ‰å¹³è¡¡ç°å®ä¸»ä¹‰çš„ç‰¹ç‚¹ã€‚å¯¹äºæˆ‘æ¥è¯´ï¼Œåªè¦ä¸æ˜¯ç‰¹åˆ«å¤§çš„äº‹æƒ…ï¼Œæ‰€æœ‰çš„ä¸Šä¸€å¤©çš„ä¸å¿«åœ¨ç¡ä¸€è§‰ä¹‹åï¼Œå¤§å¤šéƒ½æ˜¯ä¼šå¿˜æ‰çš„ï¼Œé•¿æ­¤ä»¥å¾€ï¼Œæ˜¾å¾—æˆ‘çš„æ€§æ ¼ä¹Ÿå°±æ¯”è¾ƒéšå’Œï¼Œä¸æ˜“ç”Ÿæ°”äº†å§ã€‚\nä½†æˆ‘å¿˜æ‰çš„ææ€•ä¹ŸåŒ…æ‹¬æ¢¦å§ã€‚\näºŒ æ„Ÿè§‰ä¸è®ºä»€ä¹ˆæ—¶å€™ï¼Œå¦‚æœä½ é—®æˆ‘ï¼šâ€œä½ ä»¥åæƒ³å¹²ä»€ä¹ˆå•Šï¼Ÿâ€æˆ‘ææ€•éƒ½ä¼šç¨ç¨æ€è€ƒä¸€ä¼šï¼Œç„¶åé—æ†¾çš„è¯´é“ï¼šâ€œæˆ‘ä¸çŸ¥é“å•Šã€‚â€\nçš„ç¡®ï¼Œæˆ‘ä»æ¥éƒ½ä¸çŸ¥é“æˆ‘æƒ³è¦å»åšä»€ä¹ˆï¼Œæˆ‘äººç”Ÿçš„æ„ä¹‰æ˜¯ä»€ä¹ˆã€‚æˆ–è®¸æˆ‘åœ¨å°æ—¶å€™å°å°çš„é«˜åºŠä¸Šä¹Ÿæ›¾ç»æ€è€ƒè¿‡ï¼Œä½†ä¸€åˆ‡éƒ½å¥½åƒå·²ç»è¿œå»äº†ã€‚\næœ€è¿‘æˆ‘ä¼¼ä¹åˆæ€è€ƒå‡ºäº†ä¸€ä¸ªå† å†•å ‚çš‡çš„å€Ÿå£ï¼Œæ¥æŠµå¾¡è¿™äº›è¯¢é—®ï¼šâ€œç”Ÿè€Œä¸ºç”Ÿã€‚â€è¿™ä¸ªå€Ÿå£ä¸€å‡ºï¼Œç»ˆäºæ‘†è„±äº†æ— å°½çš„è¯¢é—®ï¼šæ‡‚å¾—çš„äººçŸ¥é“è¿™æ˜¯ä¸€ä¸ªæ— å…³ç´§è¦çš„å€Ÿå£ï¼Œä¸æ‡‚å¾—äººè§‰å¾—è¿™æ˜¯ä¸€ä¸ªæ— å…³ç´§è¦çš„ç©ç¬‘ã€‚\näºæ˜¯ï¼Œæ‰€æœ‰äººä¼¼ä¹éƒ½è§‰å¾—è¿™ä»¶äº‹æƒ…æ— å…³ç´§è¦äº†ã€‚\nä¸‰ æ¸æ¸çš„ï¼Œä¹Ÿæ²¡æœ‰æ—¶é—´è®©æˆ‘å»æ€è€ƒäº†ã€‚\nç”Ÿæ´»è¶Šæ¥è¶Šçƒ¦èºäº†ã€‚è¶Šæ¥è¶Šå¤šçš„äº‹æƒ…ï¼Œè®©æˆ‘ç®€ç›´è…¾ä¸å‡ºæ‰‹æ¥ã€‚æ˜å¤©è¦è€ƒè¯•äº†ï¼Œä»Šå¤©å¾—èµ¶å¿«å¤ä¹ ï¼›æ˜å¤©è¦ä¸Šè¯¾äº†ï¼Œä»Šå¤©è¦ç¨å¾®é¢„ä¹ ä¸€ä¸‹ï¼›æ˜å¤©è¦è®²æ–°ç®—æ³•äº†ï¼Œç°åœ¨è¿˜ä¸ä¼šã€‚\næ€»æœ‰é‚£ä¹ˆå¤šçš„äº‹ï¼Œåœ¨æ¯ä¸€ä¸ªæ–¹é¢å µä½ä½ çš„ä¸ä¸ç¼•ç¼•çš„æ¢¦ï¼Œè®©ä½ ä¸å¾—ä¸å›åˆ°æ²‰é‡çš„æ¡Œå‰ã€‚æ— æ—¶æ— åˆ»ï¼Œèº«è¾¹è¦ç»•ç€çš„éƒ½æ˜¯å˜ˆæ‚ä¸çƒ¦ä¹±çš„å£°éŸ³ï¼Œç£ä¿ƒç€ä½ ä¸Šè¿›ï¼Œç£ä¿ƒç€ä½ åœ¨ä¸€æ¡æ— å°½çš„ç‹¬æœ¨æ¡¥ä¸Šè¶Šèµ°ï¼Œè¶Šèµ°ï¼Œè¶Šè¿œã€‚\næœ‰ä»€ä¹ˆå¯ä»¥å»æƒ³çš„å‘¢\u0026hellip;åªä¸è¿‡å‹‰å¼ºèƒ½è®©è‡ªå·±ä¸åœ¨è¿™æœ¨æ¡¥ä¸Šæ‘”ä¸‹å»ï¼Œæ‘”å¾—éä½“é³ä¼¤ï¼Œæ‘”å¾—æ— å¤„å¯å½’ã€‚\nä½ é—®æˆ‘ä»€ä¹ˆæ˜¯ã€Œæ¢¦ã€ï¼Œä»€ä¹ˆæ˜¯ã€Œæƒ³ã€ï¼Ÿ\næˆ‘ä¸çŸ¥é“ã€‚\nå›› å°æ—¶å€™çš„æ¢¦æƒ³æ€»æ˜¯æ˜“ç¢çš„ã€‚æˆ‘æ¢¦æƒ³ç€è€ƒå¹´çº§ç¬¬ä¸€ï¼Œäº«å—æ— è¾¹çš„å¤¸è€€ï¼›æˆ‘æ¢¦æƒ³ç€ä»€ä¹ˆä¸œè¥¿ä¸€å­¦å°±ä¼šï¼Œå´æ— æ•°æ¬¡å€é­æ‰“å‡»ï¼›æˆ‘æ¢¦æƒ³ç€æœ‰ä¸€å¤©èƒ½å¤Ÿä¹°ä¸‹å®¶é—¨å£çš„ä¸€å¤§ç‰‡ç©ºåœ°ï¼Œå¯åå¤šå¹´è¿‡å»ï¼Œè¦†ç›–å…¶ä¸Šçš„ä»ç„¶æ˜¯ä¸€ç‰‡è’èŠœã€‚\næˆ‘ä¹Ÿä¸æ–­çš„é—®è‡ªå·±ï¼šä»€ä¹ˆæ‰æ˜¯æˆ‘çœŸæ­£æƒ³è¦çš„æ¢¦æƒ³ï¼Ÿæˆ‘ç©¶ç«Ÿèƒ½åšåˆ°ä»€ä¹ˆï¼Ÿ\næˆ–è®¸ï¼Œæˆ‘ä»¬å¤§éƒ¨åˆ†äººï¼Œéƒ½æ˜¯è¿™è‹èŒ«ä¸–ç•Œä¸­çš„ä¸€ç²’è‰èŠ¥å§ã€‚ä¸–ç•Œä¸ä¼šä»¥ä½ çš„æ„å¿—ä¸ºè½¬ç§»ï¼Œä½ ä¹Ÿå¾ˆéš¾å»æ”¹å˜æˆ–è€…ä¸–ç•Œï¼Œç”šè‡³æ˜¯ä½ å®¶é—¨å£çš„ä¸€ç‰‡ç©ºåœ°ã€‚æˆ‘ä»¬æ‰€èƒ½åšçš„ï¼Œææ€•ä¹Ÿåªæ˜¯æ´»å¥½è‡ªå·±ï¼Œè®©è‡ªå·±æ´»å¥½ï¼Œè®©ä½ æ‰€æœ‰å¸Œæœ›èƒ½å¤Ÿå¥½å¥½æ´»ç€çš„äººæ´»å¥½ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬ï¼Œä¸è¿‡æ˜¯æ¼«å¤©å¤§é›ªä¸­è¢«é£æ— åŠ›è£¹æŒŸç€çš„ä¸€ç‰‡é›ªèŠ±ï¼Œåªèƒ½æ‰“ç€è½¬ï¼Œè¢«é£å¹ç€ï¼Œåˆ°ä¸€ä¸ªä¸çŸ¥é“ä»€ä¹ˆçš„åœ°æ–¹å§ã€‚\nç„¶è€Œæ´»ç€ï¼Œè¿™ææ€•ä¹Ÿä¸å®¹æ˜“å‘¢ã€‚\næ‰€ä»¥å•Šï¼Œæˆ‘å°±åœ¨æƒ³æˆ‘åº”è¯¥ä¸ºä»€ä¹ˆè€Œæ´»ç€ã€‚ä½†æˆ–è®¸æˆ‘å¿ƒé‡Œæ—©å·²æœ‰äº†ç­”æ¡ˆå§ã€‚æˆ‘ä¸çŸ¥é“æˆ‘ä»å“ªé‡Œå¾—æ¥çš„è¿™ä¸ªç»“è®ºï¼Œä¹Ÿä¸çŸ¥é“ä»»ä½•æœ‰å…³çš„è¿‡ç¨‹ã€‚\nè¶ç°åœ¨èƒ½å¼€å¿ƒçš„æ´»ç€ï¼Œåšäººå¤šå¤©çœŸä¸€ç‚¹ï¼Œå»è¿½å¯»è‡ªå·±å†…å¿ƒæƒ³è¦çš„å§ã€‚\nå·²ç»é€å»çš„æ¢¦ï¼Œå°±è®©å®ƒæˆä¸ºç¾å¥½çš„å›å¿†ï¼›è¿˜åœ¨æ‰‹å¿ƒçš„æ¢¦ï¼Œå°±å°†å®ƒæ§å¥½ï¼Œç¥ˆæ„¿å®ƒæ°¸ä¸ç¦»å»ã€‚\nä¸€ç‚¹æ›´å¤šçš„è¯ æœ€è¿‘æˆ‘ç»ˆäºæ˜ç™½ï¼Œå“ªæœ‰é‚£ä¹ˆå¤šæ¢¦æƒ³ã€‚\nä½ çš„é˜¶çº§ï¼Œä½ çš„èº«ä»½ï¼Œä½ çš„äººç”Ÿåœ¨æ­¤åˆ»ä¹‹å‰çš„æ¯ä¸€ç§’ï¼Œéƒ½è®©ä½ çš„æŸäº›æ¢¦æƒ³ï¼Œæˆ–å¤§æˆ–å°ï¼Œæ— å£°çš„å åœ°ã€‚\næœ‰çš„äººï¼Œä»–ä»¬æˆ–å‡ºèº«æ˜¾èµ«ï¼Œæˆ–ä¸€ä¸–è±ªé—¨ã€‚ä»–ä»¬ç”Ÿæ¥ï¼Œå°±å·²ç»è·¨è¿‡äº†æ¸©é¥±ã€å°åº·ï¼Œè¿™ç§åœ¨ä¸­å›½ç¤¾ä¼šé‡Œè¿˜æ²¡æœ‰å®Œå…¨æ™®åŠçš„ç”Ÿæ´»ã€‚ä»–ä»¬å¯ä»¥æœ‰æ¢¦æƒ³ã€‚ä»–ä»¬å¦‚æœä»Šå¤©æƒ³è¦å¹²äº›ä»€ä¹ˆï¼Œè‡ªä¼šæœ‰äººåœ¨æ˜å¤©ï¼ŒæŠŠæ‰€æœ‰ä»–æƒ³è¦çš„ï¼Œæ¬ä¸Šæ¡Œå»ã€‚\nä½†å…¶å®ï¼Œäººä»¬ä¸­çš„å¤§éƒ¨åˆ†ï¼Œå’Œä»–ä»¬ï¼Œè¿½æ±‚çš„æ‰€è°“ã€Œæ¢¦æƒ³ã€ï¼Œææ€•éƒ½ä¸æ˜¯ä¸€æ ·çš„ä¸œè¥¿ï¼Œç”šè‡³ä¸åœ¨ä¸€ä¸ªå±‚æ¬¡ä¸Šã€‚ä»–ä»¬ä¸­æœ‰çš„äººå¯ä»¥æƒ³ç€å»æ”¹å˜ä¸–ç•Œï¼Œå› ä¸ºå°±ç®—æ”¹å˜ä¸äº†è¿™ä¸ªä¸–ç•Œï¼Œä»–ä¹Ÿèƒ½ä¸€è¾ˆå­æ´»åœ¨çˆ¶è¾ˆçš„è«æŠ¤ä¹‹ä¸‹ã€‚è€Œå¯¹äºå¤§å¤šæ•°äººï¼Œå¦‚æœä¸–ç•Œæ²¡æœ‰è¢«ä½ æ”¹å˜ï¼Œé‚£ä¹ˆï¼Œä½ å°±ä¼šè¢«è¿™ä¸ªä¸–ç•Œæ¯ç­ã€‚\nä½ åº”è¯¥å»å¸‚äº•é€›é€›ã€‚çœ‹çœ‹é‚£äº›åœ¨å»ºç­‘å·¥åœ°ä¸Šçš„å·¥äººï¼Œçœ‹çœ‹ä»–ä»¬é»é»‘çš„è‚Œè‚¤ï¼Œçœ‹çœ‹é‚£äº›ä½åœ¨ä¸åˆ°åå¹³ç±³çš„åœ°ä¸‹å®¤é‡Œé¢çš„äººã€‚ä»–ä»¬çš„å¥‹æ–—ï¼Œå¾ˆå¤šææ€•ä¹Ÿéƒ½æ˜¯ä¸ºäº†æ™šä¸Šçš„ä¸€é¡¿é¥­ï¼Œä¸ºäº†èƒ½å¤Ÿåœ¨è¿™ä¸ªä¸–ç•Œä¸Šæ‹¥æœ‰ä¸€äº›æœ€åŸºæœ¬çš„æƒåˆ©å§ã€‚\n æ™‚é–“æ°¸æ˜¯æµé§›ï¼Œè¡—å¸‚ä¾èˆŠå¤ªå¹³ã€‚\n ç™¾å¹´å‰çš„å·¥äººå°±åœ¨ç¤¾ä¼šçš„åº•å±‚ï¼Œè€Œå¦‚ä»Šï¼Œä»ç„¶å¦‚æ­¤ã€‚é‚£æ˜¯ä»€ä¹ˆäººä»£æ›¿äº†åœŸè±ªã€åœ°ä¸»ã€èµ„æœ¬å®¶å’Œå®˜åƒšé˜¶çº§å‘¢ï¼Ÿ\nä¸ç®¡æ˜¯è°ï¼Œæˆ‘ç›¸ä¿¡ï¼Œä»–ä»¬è‚¯å®šæ˜¯æœ‰æ¢¦æƒ³çš„ã€‚\næœ€å æˆ‘è¿˜å¾ˆå¤©çœŸï¼Œè¿™æ˜¯æ¯«æ— ç–‘é—®çš„ã€‚å°±åƒæˆ‘ç°åœ¨çœ‹ä¸‰å¹´å‰çš„ä½œæ–‡ä¸€æ ·ï¼Œä¸‰å¹´åå†æ¥çœ‹è¿™é‡Œï¼Œææ€•ä¹Ÿä¼šè®¤ä¸ºè¿™ä¸è¿‡æ˜¯æ— ç—…çš„ç‰¢éªšï¼Œä»¤äººæ¶å¿ƒã€‚\nä½†ä¸è®ºå¦‚ä½•å§ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ç‚¹ç‚¹å¾®å°çš„æ€æƒ³ã€‚è™½ç„¶è‚¯å®šååˆ†çš„å¹¼ç¨šï¼Œä½†æˆ‘æƒ³ï¼Œä»¥åå†çœ‹åˆ°çš„æ—¶å€™ï¼Œå¤šå°‘ä¹Ÿä¼šæœ‰é‚£ä¹ˆä¸€ç‚¹ç‚¹çš„å¯ç¤ºå§ã€‚\n Stay simple. Stay naÃ¯ve.\n åº”æŸäººè¦æ±‚ï¼Œå†™æˆè¿™æ ·ä¸€ç¯‡å°æ–‡ï¼Œä»¥èŠå¯„å¾®æƒ…ã€‚\nä½ çš„ã€Œæ¢¦æƒ³ã€ï¼Ÿ  æŸäººçš„ä¸€ç¯‡ã€Œæ¢¦æƒ³ã€\n æˆ‘ä»æœªæƒ³è¿‡åœ¨è¿™é‡Œé‡åˆ°å¥¹ã€‚å¥¹èº«ä¸Šçš„æ–‡å­—ï¼Œæ˜¯åº”è¯¥è®©äººç»å†äº†é£æ²™çš„æ´—ç¤¼ï¼Œæ€€ç€æœåœ£çš„å¿ƒåŒåŒç€ç¿»è¿‡æ²™ä¸˜æ‰èƒ½ç»†ç»†æ‹œè¯»ï¼Œç»ä¸æ˜¯åœ¨è¿™å†°å†·çš„ç»ç’ƒæŸœé‡Œï¼Œä¸è€¶ç¨£çš„ç”»åƒå’Œæ³•è€çš„æœ¨ä¹ƒä¼Šä¸ºé‚»ï¼Œèµ¤è£¸ç€æš´éœ²åœ¨æ¸¸äººè¿·èŒ«çš„çœ¼ç›ä¸‹ï¼Œä¼ç›¼ç€æ•…äººåŒ†åŒ†èµ°è¿‡æ—¶çš„ä¸€ç¥ã€‚æˆ‘å¿ƒé‡Œæ¶Œèµ·ä¸€é˜µä¸å¹³ï¼Œä¸€ä¸ªå¼ºçƒˆçš„æ„¿æœ›å¦‚çƒ­é£ä¸€æ ·å¸­å·è€Œæ¥ï¼ŒæŠŠæˆ‘å¸¦å›ä¸€ç™¾å¹´å‰çš„ä¸­å›½ã€‚\næ²™ä¸˜ä¸Šæµ®å‡ºä¸‰ä¸ªäººå½±ï¼Œä¸€ä¸ªéª‘åœ¨é©¬ä¸Šï¼Œå¦ä¸¤ä¸ªä¸€å‰ä¸€ååœ°è·Ÿç€ã€‚èµ°åœ¨å‰çš„ç‰µç€é©¬ï¼Œèº«æç˜¦é«˜ã€‚åé¢çš„å‚ç€æ‰‹å°æ­¥è·Ÿç€ï¼Œæ‰®æˆé“å£«æ¨¡æ ·ã€‚æ­£æ˜¯ä»–ä»¬äº†ã€‚\né©¬èƒŒä¸Šçš„å¤–å›½äººé¦–å…ˆçœ‹åˆ°äº†æˆ‘ï¼Œä»–çš„é¢éœ²æˆ’å¤‡ï¼Œç¨ç¨æ‹‰ç´§äº†ç¼°ç»³ã€‚â€œæ–¯å¦å› ï¼â€ä¸‰äººåº”å£°è€Œåœï¼Œç‰µé©¬çš„ä¹°åŠå‘æˆ‘å¾®å¾®æ¬ è…°ï¼Œçœ¼ç¥é‡Œå´æ»¡æ˜¯åŒæ¶ã€‚â€œä½ æˆ‘åœ¨è¿™ä¸æ¯›ä¹‹åœ°ç›¸è§å®šæ˜¯æœ‰ç¼˜äº†ã€‚æ‚¨æ—¢çŸ¥é“æˆ‘ä»¬è€æ¿æ–¯å¦å› å…ˆç”Ÿçš„å¤§åï¼Œç›¸å¿…å¯¹æˆ‘ä»¬è€æ¿æ­¤è¡Œçš„é«˜å°šç›®çš„ä¹Ÿæœ‰æ‰€è€³é—»ã€‚è¿™é©¬ä¸Šæ‰€è½½çš†æ˜¯è´µé‡ä¹‹ç‰©ï¼Œæˆ‘ç­‰å½’äº¬å¿ƒåˆ‡ä¸ä¾¿è€½æï¼Œè§è°…ã€‚â€â€œç­‰ç­‰ã€‚â€æˆ‘ä¸Šå‰ä¸€æ­¥ã€‚â€œè’‹å­ç¬ï¼Œæ–¯å¦å› ä¸æ‡‚ä¸­æ–‡ä½ å¤§å¯ä¸å¿…å¯¹æˆ‘è¯´è¿™å† å†•å ‚çš‡ä¹‹è¯ã€‚â€ä»–çš„è„¸çªç„¶æ‹‰ä¸‹æ¥ï¼šâ€œä¸çŸ¥æ‚¨æœ‰ä½•è´µå¹²ã€‚â€â€œä½ æˆ‘äºŒäººï¼Œè¿˜æœ‰ç‹é“å£«ã€‚â€æˆ‘çœ‹å‘ä»–æ—¶ä»–æ€•å¾—åªä¸æ–­ä½œæ–å¿µç€â€œæ— é‡è§‚â€â€œæˆ‘ä»¬ä¸‰ä¸ªéƒ½æ˜¯ä¸­å›½äººï¼Œè¿™é©¬ä¸Šè½½çš„éƒ½æ˜¯ä¸­å›½çš„å®ç‰©ã€‚ä½ åªå‘Šè¯‰æ–¯å¦å› æˆ‘æ˜¯åœ¨æ­¤ç­‰ä»–æ¥ä¿ä»–è¿‡æ²™æ¼ çš„å‘å¯¼ï¼Œæœºä¼šä¸€åˆ°æˆ‘ä»¬å°±æŠŠæ–¯å¦å› èº«ä¸Šçš„æªæ‹¿è¿‡æ¥ï¼Œé€¼ä»–å’Œæˆ‘ä»¬å›å»ï¼ŒæŠŠè¿™äº›ç»ä¹¦å…¨æ”¾å›è—ç»æ´ã€‚ä»–å­¤èº«åœ¨å¤–ä¸å¾—ä¸ä¿¡ä»»ä½ ï¼Œè¿™äº‹ä¸€å®šèƒ½æˆã€‚â€â€œæ‚¨è¿™æ˜¯è¦ç½®æˆ‘äºä¸ä¹‰ä¹‹åœ°å•Šã€‚â€â€œä¸ä¹‰ï¼Ÿæˆ‘æ˜¯è®©æ‚¨å…åšå†å²çš„ç½ªäººï¼Œè¢«å­å­™ä¸‡ä¸–å”¾å¼ƒï¼â€â€œæˆ‘åªåŒºåŒºä¸€ä¸ªå¹³æ°‘ï¼Œæµä¼ åƒå¤å€’æ˜¯æˆ‘çš„è¿æ°”å‘¢ã€‚åªæ˜¯æ‹¿äº†äººçš„é’±å°±å¾—å¸®äººåšäº‹ï¼Œä¹°å–å®šäº†å°±å†æ— åæ‚”çš„ä½™åœ°ã€‚â€\nâ€œä»–ç»™äº†ä½ å¤šå°‘é’±ã€‚â€æˆ‘è½¬å‘ç‹é“å£«ã€‚â€œå¤§äººå¿µä½›å¿ƒè™”ï¼Œç»™äº†å°é“30è‹±é•‘ã€‚â€30è‹±é•‘\u0026hellip;åƒç™¾å¹´æ¥å¤§å¸ˆä»¬çš„æ™ºæ…§ç»“æ™¶åªå€¼30è‹±é•‘ï¼â€œä½ ä¸ºä»€ä¹ˆä¸æŠŠè¿™å‘ç°å‘Šè¯‰æœå»·ï¼Œå¤§æ¸…çš„å›½åº“é‡Œç»ä¸æ­¢æœ‰30è‹±ç£…å•Šï¼â€â€œå“¼â€è’‹å­ç¬å†·ç¬‘ä¸€å£°â€œæœå»·çš„é’±éƒ½å»ç»™è€ä½›çˆ·åŠå¯¿äº†ã€‚ä¸Šäº¤äº†æœå»·ï¼Œæ²¿é€”æŠ¼éŸµçš„å®˜å‘˜è°ä¸ä»ä¸­æŠ½åˆ©ï¼Ÿå…ˆå°±æŠŠå¥½ä¸œè¥¿æŒ‘å…‰äº†ã€‚å†µä¸”è¿™æœå»·ä¹Ÿä¸ç¨³å›ºäº†ï¼Œä¸€è·¯ä¸Šåˆ°å¤„éƒ½æ˜¯å†›é˜€ã€‚è¿™ä¹¦è¦æ˜¯è½åˆ°ä»–ä»¬æ‰‹é‡Œï¼Œå“¼ï¼Œè‚¯å®šæ˜¯æ’•äº†æ“¦å±è‚¡\u0026hellip;è¦æˆ‘è¯´ï¼Œåªæœ‰æ´‹äººé çš„ä½â€¦â€\nä»–çš„å£°éŸ³æ¸æ¸è¿œäº†ï¼ŒçƒŸéœ­ä¸‹åªå‰©è½å¯çš„æˆ‘ã€‚ç¥æ¸¸å½’æ¥ï¼Œæ¢¦æƒ³ç ´ç­ï¼Œé¢å¯¹ç€è¿™ä¸€å±‹å­çš„å±•å“ï¼Œæˆ‘çªç„¶æ„Ÿåˆ°å¾ˆè‡ªå‘ã€‚å†å²çš„åšé‡å‹çš„æˆ‘å–˜ä¸è¿‡æ°”ã€‚æˆ‘ä¸çŸ¥é“ä¸€ä¸ªäººçš„é”™è¯¯ï¼Œéœ€è¦å¤šå°‘åäººæ¥å¼¥è¡¥ã€‚æˆ–è€…æ˜¯å¦å› ä¸ºå²ä¹¦ä¸Šåªç•™ä¸‹è¿™ä¸€ä¸¤ä¸ªçŠ¯é”™çš„äººçš„åå­—ï¼Œæˆ‘ä»¬å°±è®©ä»–ä»¬æ¥é¡¶æ›¿ä¸€ä¸ªæ°‘æ—çš„ç½ªè¿‡ã€‚ä¸æ„¿å†æƒ³äº†ï¼Œåªå¸Œæœ›ä»¥åçš„äººä»¬ä¸å†åœ¨å¼‚å›½çš„åšç‰©é¦†é‡Œç»å—è¿™æ¢¦æƒ³ç ´ç­çš„æ‚²å“€ã€‚\n å¤ªå¼ºå•¦ï¼\n","description":"","id":165,"section":"posts","tags":null,"title":"ã€Œæ¢¦æƒ³ã€","uri":"https://blog.chenqiqian.com/posts/essay-dream/"},{"content":"å°å‡¸å’Œå°æ–¹ç›¸çº¦ç©å¯†å®¤é€ƒè„±ï¼Œè¿™ä¸ªå¯†å®¤æ˜¯ä¸€æ£µæœ‰ $n$ ä¸ªèŠ‚ç‚¹çš„å®Œå…¨äºŒå‰æ ‘ï¼Œæ¯ä¸ªèŠ‚ç‚¹æœ‰ä¸€ä¸ªç¯æ³¡ã€‚ç‚¹äº®æ‰€æœ‰ç¯æ³¡å³å¯é€ƒå‡ºå¯†å®¤ã€‚\næ¯ä¸ªç¯æ³¡æœ‰ä¸ªæƒå€¼ $a_i$ ï¼Œæ¯æ¡è¾¹ä¹Ÿæœ‰ä¸ªæƒå€¼ $b_i$ ã€‚ç‚¹äº®ç¬¬ $1$ ä¸ªç¯æ³¡ä¸éœ€è¦èŠ±è´¹ï¼Œä¹‹åæ¯ç‚¹äº® $1$ ä¸ªæ–°çš„ç¯æ³¡ $v$ çš„èŠ±è´¹ï¼Œç­‰äºä¸Šä¸€ä¸ªè¢«ç‚¹äº®çš„ç¯æ³¡ $u$ åˆ°è¿™ä¸ªç‚¹ $v$ çš„è·ç¦» $D_{u,v}$ ï¼Œä¹˜ä»¥è¿™ä¸ªç‚¹çš„æƒå€¼ $a_v$ ã€‚åœ¨ç‚¹ç¯çš„è¿‡ç¨‹ä¸­ï¼Œè¦ä¿è¯ä»»æ„æ—¶åˆ»æ‰€æœ‰è¢«ç‚¹äº®çš„ç¯æ³¡**å¿…é¡»è¿é€š**ï¼Œåœ¨ç‚¹äº®ä¸€ä¸ªç¯æ³¡å**å¿…é¡»å…ˆç‚¹äº®å…¶å­æ ‘æ‰€æœ‰ç¯æ³¡æ‰èƒ½ç‚¹äº®å…¶ä»–ç¯æ³¡**ã€‚\nè¯·å‘Šè¯‰ä»–ä»¬ï¼Œé€ƒå‡ºå¯†å®¤çš„æœ€å°‘èŠ±è´¹æ˜¯å¤šå°‘ã€‚\né“¾æ¥ BZOJ 4446\nLuogu 4253\né¢˜è§£ è¿™ä¸ªæ ‘å½¢dpçœŸæ˜¯å¯ä»¥è¯´ç¥äº†orz\u0026hellip;æœ€è¿‘åšåˆ°çš„ç¥é¢˜çœŸå¤š\u0026hellip;ï¼ˆèŒèŒå“’ï¼ŒLCAï¼Œå†åŠ ä¸Šè¿™ä¸ª\u0026hellip;\næ€è€ƒä¸€ä¸‹æ€ä¹ˆè¡¨ç¤ºçŠ¶æ€ã€‚å¦‚æœæˆ‘ä»¬å·²ç»ç¬¬ä¸€ä¸ªç‚¹äº®äº†ä¸€ä¸ªç‚¹ï¼ˆå‡è®¾å…¶ä»–ç‚¹éƒ½æœªè¢«ç‚¹äº®ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¿…é¡»å…ˆç‚¹äº®è¿™ä¸¤ä¸ªå­æ ‘ã€‚ç”±äºå¿…é¡»è”é€šè€Œä¸”å¿…é¡»åªèƒ½ç‚¹å­æ ‘ï¼Œä¸‹ä¸€æ­¥åªèƒ½ç‚¹äº®ä¸¤ä¸ªå„¿å­ä¹‹ä¸€ã€‚è€Œç‚¹äº®çš„é‚£ä¸ªå„¿å­çš„å­æ ‘è‚¯å®šè¦å…ˆè¢«å…¨éƒ¨ç‚¹äº®ï¼Œç„¶åæ‰èƒ½ç‚¹äº®å¦ä¸€ä¸ªä¸€ä¸ªå­æ ‘ã€‚\nå¦‚æœæˆ‘ä»¬å¿½ç•¥ä¸Šä¸€ä¸ªç‚¹ç‚¹åœ¨å“ªé‡Œçš„è¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬äº‹å®ä¸Šå‘ç°ä¸Šè¿°çš„è¿‡ç¨‹æ˜¯ä¸€ä¸ªæ— åæ•ˆæ€§çš„å­ç»“æ„ï¼Œè¿™ä¸ªä¸œè¥¿å°±å¯ä»¥è®¾ç½®æˆçŠ¶æ€äº†ã€‚ä½†è¿™ä¸ªäº‹æƒ…çš„æœ€å…³é”®çš„é—®é¢˜åœ¨äºæˆ‘ä»¬å¿½ç•¥äº†ä¸Šä¸€ä¸ªç‚¹ç‚¹åœ¨å“ªé‡Œï¼Œé‚£æˆ‘ä»¬æ€æ ·å»è¡¨ç¤ºè¿™ä¸ª $D_{u,v} \\times a_v$ çš„è¿‡ç¨‹å‘¢ï¼Ÿ\nè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å‘ç°æˆ‘ä»¬ä¸çŸ¥é“ä¸Šä¸€ä¸ªç‚¹ç‚¹åœ¨å“ªé‡Œï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥çŸ¥é“ä¸‹ä¸€ä¸ªç‚¹ç‚¹åœ¨å“ªé‡Œã€‚å¦‚æœæˆ‘ä»¬å‘ç°æˆ‘ä»¬ç‚¹å®Œäº†ä¸€ä¸ªå­æ ‘ï¼Œæˆ‘ä»¬ç°åœ¨åªæœ‰ä¸¤ç§æƒ…å†µï¼š\n  æˆ‘ä»¬æ‰€æœ‰ç›®å‰ç‚¹å®Œçš„ç‚¹æ„æˆäº†ä¸€é¢—æ›´å¤§çš„å®Œæ•´çš„å­æ ‘ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±åªèƒ½å»ç‚¹è¿™ä¸ªæ›´å¤§çš„å®Œæ•´çš„å­æ ‘çš„\næ ¹èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ã€‚\n  æˆ‘ä»¬ç°åœ¨æ‰€æœ‰ç‚¹å®Œçš„ç‚¹ä¸èƒ½æ„æˆä¸€æ£µæ›´å¤§çš„å®Œæ•´çš„å­æ ‘ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¿…é¡»ç‚¹å®Œæœ€è¿‘çš„æ²¡æœ‰ç‚¹çš„ä¸€ä¸ªå­æ ‘ã€‚\n  äº‹å®ä¸Šåªæœ‰ä¸¤ç§æƒ…å†µï¼Œä¹Ÿå°±æ˜¯åˆ°æŸä¸ªç¥–å…ˆï¼Œæˆ–è€…æŸä¸ªç¥–å…ˆçš„å…„å¼Ÿã€‚\næ‰€ä»¥æˆ‘ä»¬ç”¨ $dp[i][j][0]$ è¡¨ç¤ºç‚¹å®Œä»¥ç¬¬ $i$ ä¸ªç‚¹ä¸ºæ ¹èŠ‚ç‚¹çš„å­æ ‘ä¹‹åï¼Œå†å»ç‚¹å…¶ç¬¬ $j$ ä¸ªç¥–å…ˆçš„è¿‡ç¨‹éœ€è¦çš„æœ€å°èŠ±è´¹ï¼Œ $dp[i][j][1]$ è¡¨ç¤ºç‚¹å®Œä»¥ç¬¬ $i$ ä¸ªç‚¹ä¸ºæ ¹èŠ‚ç‚¹çš„å­æ ‘ä¹‹åï¼Œå†å»ç‚¹å…¶ç¬¬ $j$ ä¸ªç¥–å…ˆçš„å¦ä¸€ä¸ªå„¿å­çš„è¿‡ç¨‹éœ€è¦çš„æœ€å°èŠ±è´¹ã€‚æ³¨æ„åˆ°è¿™æ˜¯ä¸€ä¸ªå®Œå…¨äºŒå‰æ ‘ï¼Œæ‰€ä»¥ä¿è¯äº†æˆ‘ä»¬çš„çŠ¶æ€çš„æ•°ç›®æ˜¯ $O(n \\log{n})$ çš„ã€‚\nè½¬ç§»æ–¹ç¨‹å¤ªé•¿ï¼Œä¸å†™äº†ï¼Œç®€å•è¯´ä¸€è¯´å¦‚ä½•è½¬ç§»ã€‚\nç®€å•æ¥è¯´ï¼Œéœ€è¦åˆ†æˆä¸‰ç±»è®¨è®ºï¼šæ²¡æœ‰å„¿å­ï¼›åªæœ‰ä¸€ä¸ªå„¿å­ï¼›æœ‰ä¸¤ä¸ªå„¿å­ã€‚\næ²¡æœ‰å„¿å­çš„æ²¡å•¥å¥½è¯´çš„ã€‚æœ‰ä¸€ä¸ªå„¿å­çš„å°±ç›¸å½“äºä¸å˜ç»“æŸèŠ‚ç‚¹è¿›å…¥è¿™ä¸ªå­æ ‘ã€‚æœ‰ä¸¤ä¸ªå„¿å­çš„å°±æœ‰ä¸¤ç§æƒ…å†µï¼šå…ˆè¿›å·¦å­æ ‘å’Œå…ˆè¿›å³å­æ ‘ï¼Œåˆ†å¼€è®¨è®ºå³å¯ã€‚çŠ¶æ€è½¬ç§»æ˜¯ $O(1)$ çš„ã€‚\nå…·ä½“æ¥è¯´çš„è¯çœ‹ä»£ç æ³¨é‡Šã€‚\nä»¥ä¸Šåªæ˜¯æˆ‘ä»¬è®¡ç®—ç­”æ¡ˆçš„ä¸€ä¸ªè¾…åŠ©ã€‚\næˆ‘ä»¬å‘ç°ï¼Œå¦‚æœé€‰å®šä¸€ä¸ªç‚¹ä½œä¸ºå›ºå®šçš„èµ·ç‚¹ï¼Œé‚£ä¹ˆè¿™ä¸ªä¸œè¥¿å®ƒç‚¹çš„é¡ºåºå°±æ˜¯ç¡®å®šçš„ã€‚æ‰€ä»¥æˆ‘ä»¬æŒ‰ç…§ç‚¹ç¯è§„åˆ™ç¡®å®šå­æ ‘çš„é¡ºåºï¼Œå†åŠ ä¸Šå­æ ‘ä¹‹é—´è½¬ç§»çš„ä»£ä»·ï¼Œå°±å¯ä»¥æ¨å‡ºç­”æ¡ˆã€‚è¿™é‡Œéœ€è¦å¯¹æœ‰æ²¡æœ‰å…„å¼ŸèŠ‚ç‚¹è¿›è¡Œåˆ†ç±»è®¨è®ºã€‚ç”±äºæ ‘çš„é«˜åº¦æ˜¯ä¸¥æ ¼ $O(\\log n)$ çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„æ¯ä¸ªç‚¹çš„é€’æ¨ä¹Ÿæ˜¯ $O(\\log n)$ çš„ã€‚\næ—¶é—´å¤æ‚åº¦ä¸ç©ºé—´å¤æ‚åº¦éƒ½æ˜¯ $O(n \\log n)$ ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102  #include \u0026lt;cstring\u0026gt;#include \u0026lt;cstdio\u0026gt;#include \u0026lt;algorithm\u0026gt;#include \u0026lt;cctype\u0026gt;using namespace std; #define ll long long  const int SIZE = 1024*1024;char ibuf[SIZE],*s,*t; inline char read(){ if(s==t) t=(s=ibuf)+fread(ibuf,1,SIZE,stdin); return s==t?-1:*s++; } template \u0026lt;typename T\u0026gt; inline void read(T \u0026amp;x){ static char c;bool iosig; for(c=read(),iosig=0;!isdigit(c);c=read()){ if(c==-1) return; iosig |= (c==\u0026#39;-\u0026#39;); } for(x=0;isdigit(c);c=read()) x = (((x\u0026lt;\u0026lt;2)+x)\u0026lt;\u0026lt;1) + (c^48); if(iosig) x = -x; } const int MAXN = 210000,logn = 20; int n; ll num[MAXN]; ll dp[MAXN][logn][2]; //ç‚¹äº®äº†iè¿™ä¸ªèŠ‚ç‚¹å’Œå­æ ‘çš„æ‰€æœ‰èŠ‚ç‚¹ï¼Œä¸‹ä¸€ä¸ªç‚¹äº®åˆ°ï¼Ÿçº§ç¥–å…ˆçš„ï¼Ÿå„¿å­çš„æœ€å°ä»£ä»· ll dis[MAXN][logn]; //ä»ièŠ‚ç‚¹å‘ä¸Šjä¸ªèŠ‚ç‚¹çš„é•¿åº¦  #define p(i,j) (((1\u0026lt;\u0026lt;(j-1))\u0026lt;=i)?(i\u0026gt;\u0026gt;j):-1) //içš„jç¥–å…ˆï¼Œä¸Šè®¾è™šæ‹Ÿ0èŠ‚ç‚¹ï¼Œå…¶ä»–å‡ä¸º-1 //num[0] = 0,dis[1][1] = 0 #define b(i,j) ((i\u0026gt;\u0026gt;(j-1))^1) //içš„jç¥–å…ˆçš„å¦ä¸€ä¸ªå„¿å­ #define lson (i\u0026lt;\u0026lt;1) #define rson ((i\u0026lt;\u0026lt;1)|1)  void init(){ read(n); for(int i = 1;i\u0026lt;=n;i++) read(num[i]); dis[1][1] = 0; for(int i = 2;i\u0026lt;=n;i++){ read(dis[i][1]); for(int j = 2;~p(i,j);j++) dis[i][j] = dis[p(i,1)][j-1] + dis[i][1]; } } void solve(){ //0 ç¥–å…ˆ 1 å…„å¼Ÿ  for(int i = n;i \u0026gt;= 1;--i){ for(int j = 1;~p(i,j);j++){ dp[i][j][0] = dp[i][j][1] = 0x3f3f3f3f3f3f3f3f; if((i\u0026lt;\u0026lt;1) \u0026gt; n){//ä¸€ä¸ªå„¿å­éƒ½æ²¡æœ‰  dp[i][j][0] = dis[i][j] * num[p(i,j)]; dp[i][j][1] = (dis[i][j] + dis[b(i,j)][1]) * num[b(i,j)]; } else if(((i\u0026lt;\u0026lt;1)|1) \u0026gt; n){//åªæœ‰å·¦å„¿å­  //æ³¨æ„è¦åŠ ä¸Šä»æ ¹èŠ‚ç‚¹åˆ°å„¿å­çš„ä»£ä»·  dp[i][j][0] = dp[lson][j+1][0] + dis[lson][1] * num[lson]; dp[i][j][1] = dp[lson][j+1][1] + dis[lson][1] * num[lson]; } else{//æœ‰ä¸¤ä¸ªå„¿å­  //ä¸¤ç§è½¬ç§»æ–¹å¼ï¼Œå·¦-\u0026gt;å³ or å³-\u0026gt;å·¦ ï¼Œæ³¨æ„è¦åŠ ä¸Šä»æ ¹èŠ‚ç‚¹åˆ°å„¿å­çš„ä»£ä»·  dp[i][j][0] = min(dp[i][j][0],dp[lson][1][1]+dp[rson][j+1][0] + dis[lson][1] * num[lson]); dp[i][j][0] = min(dp[i][j][0],dp[rson][1][1]+dp[lson][j+1][0] + dis[rson][1] * num[rson]); dp[i][j][1] = min(dp[i][j][1],dp[lson][1][1]+dp[rson][j+1][1] + dis[lson][1] * num[lson]); dp[i][j][1] = min(dp[i][j][1],dp[rson][1][1]+dp[lson][j+1][1] + dis[rson][1] * num[rson]); } } } //è®¡ç®—ç­”æ¡ˆ  ll ans = 0x3f3f3f3f3f3f3f3f; for(int s = 1;s\u0026lt;=n;s++){ //ä»sç‚¹å¼€å§‹ï¼Œå…ˆç‚¹äº®æ‰€æœ‰så­æ ‘çš„èŠ‚ç‚¹å’Œsçš„çˆ¶äº²  ll tmp = dp[s][1][0]; for(int i = p(s,1),last = s;~i;i = p(i,1),last = p(last,1)){ //lastèŠ‚ç‚¹çš„å­æ ‘å³ièŠ‚ç‚¹å·²ç»è¢«ç‚¹äº®ï¼Œç°åœ¨è¦ç‚¹äº®içš„çˆ¶äº²èŠ‚ç‚¹  //æœ‰å…„å¼Ÿï¼Œå°±éœ€è¦å»å…ˆç‚¹äº®å…„å¼Ÿï¼Œå†ç‚¹äº®içš„çˆ¶äº²ï¼ˆlastå…„å¼Ÿçš„ç¥–çˆ¶ï¼‰èŠ‚ç‚¹  if(b(last,1) \u0026lt;= n) tmp += dis[b(last,1)][1] * num[b(last,1)] + dp[b(last,1)][2][0]; else tmp += dis[i][1] * num[p(i,1)]; //åŠ ä¸Šä»iåˆ°içš„çˆ¶äº²èŠ‚ç‚¹çš„ä»£ä»·  } ans = min(ans,tmp); } printf(\u0026#34;%lld\\n\u0026#34;,ans); } int main(){ init(); solve(); return 0; }   ","description":"","id":166,"section":"posts","tags":["åŠ¨æ€è§„åˆ’","æ ‘å½¢ç»“æ„"],"title":"ã€ŒSCOI2015ã€å°å‡¸ç©å¯†å®¤-æ ‘å½¢dp","uri":"https://blog.chenqiqian.com/posts/scoi2015-room/"},{"content":"å¯¹äºåºåˆ— $A$ ï¼Œå®ƒçš„é€†åºå¯¹æ•°å®šä¹‰ä¸ºæ»¡è¶³ $i\u0026lt;j$ ï¼Œä¸” $A_i\u0026gt;A_j$ çš„æ•°å¯¹ $(i,j)$ çš„ä¸ªæ•°ã€‚\nç»™å‡ºä¸€ä¸ª $1$ åˆ° $n$ çš„æ’åˆ—ï¼ŒæŒ‰ç…§æŸç§é¡ºåºä¾æ¬¡åˆ é™¤ $m$ ä¸ªå…ƒç´ ï¼Œä½ çš„ä»»åŠ¡æ˜¯åœ¨æ¯æ¬¡åˆ é™¤ä¸€ä¸ªå…ƒç´ ä¹‹å‰ç»Ÿè®¡æ•´ä¸ªåºåˆ—çš„é€†åºå¯¹æ•°ã€‚\né“¾æ¥ Luogu P3157\né¢˜è§£ CDQåˆ†æ²»å¼ºå•Šã€‚\nè¿™é“é¢˜å¯ä»¥ç”¨æ ‘çŠ¶æ•°ç»„\u0026amp;ä¸»å¸­æ ‘åšï¼Œä¸è¿‡å¾ˆéš¾å†™ã€‚\nCDQåˆ†æ²»çš„è¯ï¼Œå®ç°éš¾åº¦ä¸Šæ¯”è¾ƒä½ä¸€äº›å§ã€‚\né¦–å…ˆï¼Œæˆ‘ä»¬è½¬åŒ–é—®é¢˜ä¸ºæ¯æ¬¡åœ¨æŸä¸ªä½ç½®æ·»åŠ ä¸€ä¸ªæ•°ï¼Œå¹¶æŸ¥è¯¢èƒ½è´¡çŒ®å‡ºæ¥çš„é€†åºå¯¹ä¸ªæ•°ã€‚è¿™ä¸ªé—®é¢˜å’Œé¢˜ç›®æ˜¯ç­‰ä»·çš„ã€‚\nç„¶åæˆ‘ä»¬ä»¤è¿™ä¸ªåˆ é™¤çš„åç€çš„é¡ºåºä¸º $id$ ï¼Œå…¶æ’å…¥çš„ä½ç½®ä¸º $b$ ï¼Œæ’å…¥çš„å€¼ä¸º $c$ ï¼Œæˆ‘ä»¬è¦æ±‚çš„å°±æ˜¯åœ¨ $id \\in [1,id - 1]$ çš„æ•°ä¸­ï¼Œæ»¡è¶³ $b_j \u0026lt; b_i,c_j \u0026gt; c_i$ æˆ–è€… $b_j \u0026gt; b_i,c_j \u0026lt; c_i$ çš„ $j$ æœ‰å¤šå°‘ä¸ªã€‚\nè¿™ä¸ªé—®é¢˜æˆ‘ä»¬ç”¨ CDQ å½’å¹¶è§£å†³ã€‚å…ˆæŒ‰ç…§ $id$ æ’åºï¼Œç„¶åå¯¹ $b$ è¿›è¡Œå½’å¹¶ï¼Œå®Œæˆåæ­£åºå’Œå€’åºå„æ‰«ä¸€éï¼Œç»Ÿè®¡è´¡çŒ®ï¼Œæœ€åä½œå‰ç¼€å’Œå³å¯ã€‚\nå®ç°æœ‰ä¸€ç‚¹ç‚¹ä¸å¥½å†™ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cstring\u0026gt;#include \u0026lt;algorithm\u0026gt;#include \u0026lt;cctype\u0026gt;#define ll long long using namespace std; const int MAXN = 110000; namespace fast_io{ //... }using namespace fast_io; struct Q{ bool w; int id,b,c; // id -\u0026gt; åŠ å…¥æ—¶é—´ b -\u0026gt; åŠ å…¥çš„ä½ç½® c -\u0026gt; è¿™ä¸ªæ•°çš„å¤§å°  Q(int x,int y,int z):id(x),b(y),c(z){} Q(){} bool operator \u0026lt; (Q w)const{//ç”¨äºæ’åº  if(id!=w.id) return id \u0026lt; w.id; if(b!=w.b) return b \u0026lt; w.b; return c \u0026lt; w.c; } }q[MAXN]; int n,m; int num[MAXN],pos[MAXN],del[MAXN]; ll ans[MAXN]; // num -\u0026gt; åŸæ•°ç»„ // pos -\u0026gt; å€¼å¯¹åº”çš„ä½ç½® // del -\u0026gt; åˆ é™¤ç¬¬ pos ä¸ªæ•°çš„åºé¡º  namespace BIT{ ll sumn[MAXN]; int lowbit(int x){ return x \u0026amp; (-x); } void add(int x,int d){ while(x \u0026lt;= n) sumn[x] += d,x += lowbit(x); } ll query(int x){ ll ans = 0; while(x \u0026gt;= 1) ans += sumn[x],x -= lowbit(x); return ans; } } void init(){ read(n),read(m); for(int i = 1;i\u0026lt;=n;i++){ read(num[i]); pos[num[i]] = i; } int tmp; for(int i = 1;i\u0026lt;=m;i++){ read(tmp); del[pos[tmp]] = i; } } int l,r,tot,tmp[MAXN]; inline bool judge(int x,int y){ //åˆ¤æ–­å½’å¹¶é¡ºåºå‡½æ•° è¿™é‡Œå› ä¸ºä¸é‡å¤ï¼Œå¯ä»¥ä¸å†™å…¶ä»–ç»´åˆ¤å®š  return q[x].b \u0026lt; q[y].b; } void CDQ(int *t,int num){ if(num == 1) return; int mid = num/2; CDQ(t,mid),CDQ(t+mid,num-mid);//åˆ†æ²»è§£å†³é—®é¢˜  //è¿›è¡Œå½’å¹¶  for(l=0,r=mid,tot=0;tot \u0026lt; num;tot++){ if((r==num)||(l\u0026lt;mid \u0026amp;\u0026amp; judge(t[l],t[r])))//è¿™ä¸€è¡Œçš„æ¡ä»¶æ˜“é”™  q[t[l]].w = 0,tmp[tot] = t[l++]; else q[t[r]].w = 1,tmp[tot] = t[r++]; } for(int i = 0;i\u0026lt;num;i++) t[i] = tmp[i]; //ç»Ÿè®¡id(time)æ¯”å…¶å° b(pos)æ¯”å…¶å° c(val)æ¯”å…¶å¤§çš„æ•°çš„ä¸ªæ•°  for(int i = 0;i\u0026lt;num;i++) if(!q[t[i]].w) BIT::add(q[t[i]].c,1); else ans[q[t[i]].id] += BIT::query(n)-BIT::query(q[t[i]].c); for(int i = 0;i\u0026lt;num;i++) if(!q[t[i]].w) BIT::add(q[t[i]].c,-1); //ç»Ÿè®¡id(time)æ¯”å…¶å° b(pos)æ¯”å…¶å¤§ c(val)æ¯”å…¶å°çš„æ•°çš„ä¸ªæ•°  for(int i = num-1;i\u0026gt;=0;--i) if(!q[t[i]].w) BIT::add(q[t[i]].c,1); else ans[q[t[i]].id] += BIT::query(q[t[i]].c-1); for(int i = num-1;i\u0026gt;=0;--i) if(!q[t[i]].w) BIT::add(q[t[i]].c,-1); } void solve(){ int nowcnt = 0; static int tt[MAXN]; for(int i = 1;i\u0026lt;=n;i++){ //éå†æ¯ä¸ªpos  if(del[i] == 0) q[i] = Q(1,i,num[i]); else q[i] = Q(m-del[i]+2,i,num[i]); } sort(q+1,q+1+n); for(int i = 1;i\u0026lt;=n;i++) tt[i] = i; CDQ(tt+1,n); // å‰ç¼€å’Œç»Ÿè®¡ç­”æ¡ˆ  for(int i = 1;i\u0026lt;=m+1;i++) ans[i] += ans[i-1]; for(int i = m+1;i\u0026gt;1;--i) print(ans[i]),print(\u0026#39;\\n\u0026#39;); } int main(){ init(); solve(); flush(); return 0; }   ","description":"","id":167,"section":"posts","tags":["CDQåˆ†æ²»","æ•°æ®ç»“æ„"],"title":"ã€ŒCQOI2011ã€åŠ¨æ€é€†åºå¯¹-CDQåˆ†æ²»","uri":"https://blog.chenqiqian.com/posts/cqoi2011-inverse/"},{"content":"æœ‰ $N$ ä¸ªä½ç½®ï¼Œ $M$ ä¸ªæ“ä½œã€‚\næ“ä½œæœ‰ä¸¤ç§ï¼š\n å¦‚æœæ˜¯ 1 a b c çš„å½¢å¼è¡¨ç¤ºåœ¨ç¬¬ $a$ ä¸ªä½ç½®åˆ°ç¬¬ $b$ ä¸ªä½ç½®ï¼Œæ¯ä¸ªä½ç½®åŠ å…¥ä¸€ä¸ªæ•° $c$ ï¼› å¦‚æœæ˜¯ 2 a b c å½¢å¼ï¼Œè¡¨ç¤ºè¯¢é—®ä»ç¬¬ $a$ ä¸ªä½ç½®åˆ°ç¬¬ $b$ ä¸ªä½ç½®ï¼Œç¬¬ $c$ å¤§çš„æ•°æ˜¯å¤šå°‘ã€‚  é“¾æ¥ Luogu P3332\né¢˜è§£ å¯ä»¥æ ‘å¥—æ ‘ã€‚ç„¶ååŸºæœ¬ä¸Šå°±ä¼šæ­»åœ¨æ ‘ä¸Šã€‚\næ­£è§£æ•´ä½“äºŒåˆ†ã€‚\næ¯”è¾ƒæ¨¡æ¿ï¼Œå°±ä¸è®²æ€è·¯äº†ï¼Œä¸»è¦è¯´ä¸€è¯´å®ç°ã€‚è¿™ä¸ªåœ°æ–¹çš„åŒºé—´åŠ æ•°å…¶å®å’Œå•ç‚¹åŠ æ•°æ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡æŠŠåŸæ¥å•ç‚¹ä¿®æ”¹çš„æ ‘çŠ¶æ•°ç»„æ”¹æˆåŒºé—´ä¿®æ”¹çš„çº¿æ®µæ ‘ã€‚\næ³¨æ„ï¼Œæ•´ä½“äºŒåˆ†æ˜¯æŒ‰ç­”æ¡ˆäºŒåˆ†ï¼Œæ¯æ¬¡äºŒåˆ†æˆ‘ä»¬çš„åœ¨åŸåŒºé—´ä¸Šå¤„ç†èŒƒå›´ä»ç„¶æ˜¯æ•´ä¸ªåŒºé—´ï¼Œä¸è¦æé”™æˆå•¥çš„\u0026hellip;\nè¿˜æœ‰æ³¨æ„ï¼Œè¿™é‡Œæ¯ä¸€å±‚é€’å½’çš„å¤æ‚åº¦ä¸€å®šåªèƒ½ä¸ä½ çš„æ­£åœ¨å¤„ç†çš„è¯¢é—®çš„ä¸ªæ•°æœ‰å…³ï¼ä¸èƒ½å¸¦æœ‰å…¶ä»–é¡¹ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œå½’é›¶çº¿æ®µæ ‘çš„æ—¶å€™æ˜¯ä¸€ä¸ªä¸ªå‡å›å»ï¼Œå¤æ‚åº¦å°±æ˜¯ $O(n \\log {n})$ ã€‚\né€’å½’çš„æ¯å±‚éƒ½è¦å¤„ç† $n$ ä¸ªæ“ä½œï¼Œä¸€å…±æœ‰ $\\log n$ å±‚ï¼Œå¤„ç†æ¯ä¸ªè¯¢é—®çš„æ—¶é—´æ˜¯ $O(\\log n)$ ï¼Œæœ€åçš„å¤æ‚åº¦å°±æ˜¯ $O(n \\log ^{2} {n})$ ã€‚\nè«åè·‘çš„å°±ç‰¹åˆ«æ…¢\u0026hellip;æ˜æ˜æˆ‘å†™äº†zkwçº¿æ®µæ ‘å•Š\u0026hellip;BZOJè«åRE\u0026hellip;æ˜æ˜æˆ‘luoguå’Œcodevsä¸Šå…¨ACäº†å•Š\u0026hellip;\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cstring\u0026gt;#include \u0026lt;cctype\u0026gt;using namespace std; #define ll long long #define mid ((l+r)\u0026gt;\u0026gt;1) const int MAXN = 51000; namespace fast_io{ //... }using namespace fast_io; struct ZKW{ //åŒºé—´ä¿®æ”¹ã€æ±‚å’Œzkwçº¿æ®µæ ‘  ll sumn[MAXN\u0026lt;\u0026lt;2],addn[MAXN\u0026lt;\u0026lt;2]; int M; void init(int n){ for(M = 1;M\u0026lt;=n+2;M\u0026lt;\u0026lt;=1); } void update(int l,int r,ll d){ int i=1,L=0,R=0; for(l=l+M-1,r=r+M+1;l^r^1;l\u0026gt;\u0026gt;=1,r\u0026gt;\u0026gt;=1,i\u0026lt;\u0026lt;=1){ sumn[l]+=L*d,sumn[r]+=R*d; if(~l\u0026amp;1) addn[l^1]+=d,sumn[l^1]+=d*i,L+=i; if(r\u0026amp;1) addn[r^1]+=d,sumn[r^1]+=d*i,R+=i; } sumn[l]+=L*d,sumn[r]+=R*d; while(l\u0026gt;\u0026gt;=1) sumn[l]+=(L+R)*d; } ll query(int l,int r){ ll ans = 0;int i=1,L=0,R=0; for(l=l+M-1,r=r+M+1;l^r^1;l\u0026gt;\u0026gt;=1,r\u0026gt;\u0026gt;=1,i\u0026lt;\u0026lt;=1){ ans+=addn[l]*L,ans+=addn[r]*R; if(~l\u0026amp;1) ans+=sumn[l^1],L+=i; if(r\u0026amp;1) ans+=sumn[r^1],R+=i; } ans+=addn[l]*L,ans+=addn[r]*R; while(l\u0026gt;\u0026gt;=1) ans+=addn[l]*(L+R); return ans; } }tree; struct Q{ int o,ql,qr; ll k; // o == 0 -\u0026gt; update l r val; o == 1 -\u0026gt; query l r k  Q(){} Q(int a,int b,int c,ll d):o(a),ql(b),qr(c),k(d){} }query[MAXN]; int tl[MAXN],tr[MAXN],ans[MAXN]; void solve(int *a,int n,int l,int r){ //è¡¨ç¤ºè¦å¤„ç†çš„è¯¢é—®åœ¨q[0]-\u0026gt;q[n-1]ï¼ŒäºŒåˆ†ç­”æ¡ˆèŒƒå›´ä¸º[l,r]  if(n == 0) return;//ä¸€ä¸ªå¾®å°çš„å‰ªæ  if(l == r){ //é€’å½’è¾¹ç•Œ  for(int i = 0;i\u0026lt;n;i++) ans[a[i]] = l; return; } int n1 = 0,n2 = 0;ll sum; for(int i = 0;i\u0026lt;n;i++){ Q \u0026amp;q = query[a[i]]; if(q.o == 1){ //ä¿®æ”¹å¦‚æœå€¼å¤§äºmidï¼Œå°±åº”ç”¨ä¿®æ”¹ï¼›å¦åˆ™ä¸ç®¡  if(q.k \u0026gt; mid) tree.update(q.ql,q.qr,1),tr[n2++] = a[i]; else tl[n1++] = a[i]; } else if(q.o == 2){ //æŸ¥è¯¢çš„ç»“æœsumå¤§äºkï¼ŒäºŒåˆ†åˆ°å³è¾¹ï¼›å¦åˆ™å·¦è¾¹  sum = tree.query(q.ql,q.qr); if(q.k \u0026lt;= sum) tr[n2++] = a[i]; else q.k -= sum,tl[n1++] = a[i]; } } //åŸæ ·å‡å›å»  for(int i = 0;i\u0026lt;n;i++){ Q \u0026amp;q = query[a[i]]; if(q.o == 1 \u0026amp;\u0026amp; q.k \u0026gt; mid) tree.update(q.ql,q.qr,-1); } memcpy(a,tl,sizeof(int) * n1),memcpy(a+n1,tr,sizeof(int) * n2); //é€’å½’äºŒåˆ†  solve(a,n1,l,mid),solve(a+n1,n2,mid+1,r); } int n,m,t[MAXN]; void init(){ read(n),read(m); tree.init(n); int op,l,r;ll c; for(int i = 0;i\u0026lt;m;i++){ read(op),read(l),read(r),read(c); query[i] = Q(op,l,r,c); t[i] = i; } } void solve(){ solve(t,m,-n,n); for(int i = 0;i\u0026lt;m;i++){ if(query[i].o == 2) print(ans[i]),print(\u0026#39;\\n\u0026#39;); } } int main(){ init(); solve(); flush(); return 0; }   ","description":"","id":168,"section":"posts","tags":["æ•´ä½“äºŒåˆ†","æ•°æ®ç»“æ„"],"title":"ã€ŒZJOI2013ã€Kå¤§æ•°æŸ¥è¯¢-æ•´ä½“äºŒåˆ†","uri":"https://blog.chenqiqian.com/posts/zjoi2013-kth/"},{"content":"æœ‰ $n$ æœµèŠ±,æ¯æœµèŠ±æœ‰ä¸‰ä¸ªå±æ€§ï¼šèŠ±å½¢( $s$ )ã€é¢œè‰²( $c$ )ã€æ°”å‘³( $m$ )ï¼Œç”¨ä¸‰ä¸ªæ•´æ•°è¡¨ç¤ºã€‚æ˜¾ç„¶ï¼Œä¸¤æœµèŠ±å¯èƒ½æœ‰åŒæ ·çš„å±æ€§ã€‚\nå®šä¹‰ä¸€æœµèŠ± $A$ æ¯”å¦ä¸€æœµèŠ± $B$ è¦ç¾ä¸½ï¼Œå½“ä¸”ä»…å½“ $S_a\\geq S_b$ , $C_a\\geq C_b$ , $M_a \\geq M_b$ ã€‚å®šä¹‰ä¸€æœµèŠ±çš„ç­‰çº§æ˜¯å®ƒæ‹¥æœ‰çš„ç¾ä¸½èƒ½è¶…è¿‡çš„èŠ±çš„æ•°é‡ã€‚\næ±‚å‡ºæ¯ä¸ªç­‰çº§çš„èŠ±çš„æ•°é‡ã€‚\n é™Œä¸ŠèŠ±å¼€ï¼Œå¯ç¼“ç¼“å½’çŸ£ã€‚\n é“¾æ¥ Luogu P3810\né¢˜è§£ è¿™é“é¢˜è¿˜æœ‰ä¸€ä¸ªåå­—å«ã€Œä¸‰ç»´ååºã€ï¼Œé¢˜é¢å¦‚ä¸‹ï¼š\n æœ‰ $n$ ä¸ªå…ƒç´ ï¼Œç¬¬ $i$ ä¸ªå…ƒç´ æœ‰ $a_i$ ã€$b_i$ ã€$c_i$ ä¸‰ä¸ªå±æ€§ï¼Œè®¾ $f(i)$ è¡¨ç¤ºæ»¡è¶³ $a_j \\leq a_i$ ä¸” $b_j \\leq b_i$ ä¸” $c_j \\leq c_i$ çš„ $j$ çš„æ•°é‡ã€‚\nå¯¹äº$d \\in [0, n)$ï¼Œæ±‚$f(i) = d$çš„æ•°é‡\n æˆ‘åœ¨è¿™é‡Œä½¿ç”¨ä¸Šé¢çš„é¢˜é¢ã€‚ï¼ˆè™½ç„¶æ˜¯ä¸€æ ·çš„ã€‚\nè¿™æ˜¯ä¸€é“ä¸‰ç»´ååºçš„æ¨¡ç‰ˆé¢˜ã€‚å¾ˆå¤šä¸€äº›äºŒç»´çš„é—®é¢˜ç»è¿‡è½¬åŒ–ä¹Ÿå¯ä»¥å˜æˆä¸‰ç»´ååºçš„ç±»ä¼¼é—®é¢˜ï¼Œå¥—ç”¨æ’åº+CDQåˆ†æ²»+BITæ¥è§£å†³ã€‚\nå‡è®¾æ‰€æœ‰çš„ $(a,b,c)$ äº’ä¸ç›¸åŒã€‚\nç¬¬ä¸€ç»´ï¼šæ’åº\næŒ‰ç…§ $a$ çš„å¤§å°æ’åºä»æ–°ç¼–å· $1 -\u0026gt; n$ ï¼Œæ’åºå®Œæˆåå°±å¯ä»¥å‘ç°å¯¹äºç¬¬ $i$ ä¸ªå…ƒç´ ï¼Œæ»¡è¶³æ¡ä»¶çš„å…ƒç´ åªå­˜åœ¨äº $[1,i-1]$ ä¸­ã€‚é—®é¢˜è½¬åŒ–ä¸ºï¼šåœ¨ $[1,i-1]$ ä¸­æœ‰å¤šå°‘ä¸ªæ»¡è¶³ $b_i \\geq b_j$ ä¸” $c_i \\geq c_j$ çš„å…ƒç´ ã€‚\nè¿™ä¸ªé—®é¢˜å…¶å®å°±æ˜¯äºŒç»´æ•°ç‚¹ã€‚å› ä¸º $b$ ä¹±åºæ·»åŠ ï¼Œæ‰€ä»¥ä¸èƒ½ç¦»çº¿è§£å†³ï¼Œå¯ä»¥ç”¨æ ‘å¥—æ ‘åœ¨çº¿è§£å†³ã€‚\nä½†æ˜¯å‘¢ï¼Œæˆ‘ä»¬ç”¨ $CDQ$ åˆ†æ²»ï¼Œå°±å¯ä»¥åŒ–åŠ¨æ€ä¸ºé™æ€ã€‚\nç¬¬äºŒç»´ï¼š$CDQ$ åˆ†æ²»\nä»€ä¹ˆæ˜¯ $CDQ$ åˆ†æ²»å‘¢ï¼Ÿåœ¨è¿™é‡Œå°±æ˜¯ä¸€ä¸ªç±»ä¼¼å½’å¹¶æ’åºçš„ä¸œè¥¿ï¼Œå› ä¸ºæˆ‘ä»¬è¦ç»Ÿè®¡çš„æ˜¯å°äºä¸€ä¸ªæ•°çš„ä¸ªæ•°ã€‚\näº‹å®ä¸Šåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯¹äºæ¯ä¸€ä¸ªå…ƒç´  $i$ ï¼Œéƒ½å°†å…¶çœ‹æˆåŒæ ·å†…å®¹çš„ä¸€æ¬¡è¯¢é—®å’Œä¸€æ¬¡ä¿®æ”¹ã€‚\næˆ‘ä»¬åœ¨è§£å†³ä¸€ä¸ªè¯¢é—®çš„åŒºé—´ $[L,R]$ æ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦ç´¯è®¡è¿™ä¸ªåŒºé—´é‡Œå·¦åŠéƒ¨åˆ†çš„ä¿®æ”¹å¯¹å³åŠéƒ¨åˆ†çš„æŸ¥è¯¢çš„è´¡çŒ®å°±å¯ä»¥äº†ã€‚æ­£ç¡®æ€§ä¸å¤ªæ˜¾ç„¶ï¼Œè·Ÿæ ‘çŠ¶æ•°ç»„ç±»ä¼¼ï¼ŒæŸ¥è¯¢æ—¶èƒ½å¤Ÿæ¶µç›– $[1,i-1]$åŒºé—´ã€‚\nç¬¬ä¸‰ç»´ä¹Ÿå¯ä»¥æ¥ç€ç”¨ $CDQ$ åˆ†æ²»ï¼Œé‚£å°±çœŸçš„æ˜¯å½’å¹¶æ’åºäº†ã€‚å°±åƒå½’å¹¶ç»Ÿè®¡é€†åºå¯¹ä¼¼çš„ï¼Œæˆ‘ä»¬åœ¨ç¬¬ä¸‰ç»´æŒ‰ $c$ è¿›è¡Œå½’å¹¶æ’åºã€‚åªéœ€è¦å¤šç»´æŠ¤ä¸€ä¸ªæ ‡è®°ï¼Œæ ‡è®°åœ¨ä¸Šä¸€ç»´é‡Œé¢å…¶å±äºå·¦åŒºé—´è¿˜æ˜¯å³åŒºé—´ï¼Œæ¥å†³å®šåœ¨å½’å¹¶æ—¶æ˜¯å¦ç´¯åŠç­”æ¡ˆã€‚\nç¬¬ä¸‰ç»´ï¼šæ ‘çŠ¶æ•°ç»„\nç¬¬ä¸‰ç»´æœ‰æ›´æ–¹ä¾¿çš„åšæ³•ï¼Œä¹Ÿå°±æ˜¯ç”¨æ ‘çŠ¶æ•°ç»„ã€‚\nç¬¬äºŒç»´ä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦å°†å·¦ä¾§çš„ $c$ æŒ‰ç…§ $b$ åœ¨å½’å¹¶ä¸­çš„é¡ºåºåŠ å…¥æ ‘çŠ¶æ•°ç»„ï¼Œç„¶åå½’å¹¶åŠ å…¥å³ä¾§å…ƒç´ çš„æ—¶å€™æŸ¥è¯¢æ¯” $c$ å°çš„æ•°ç´¯ç§¯ç­”æ¡ˆï¼Œæœ€åå¾—åˆ°çš„å°±æ˜¯åœ¨å·¦åŠåŒºé—´æ‰€æœ‰ $b$ æ¯”å®ƒå°ï¼Œè€Œä¸” $c$ ä¹Ÿæ¯”å®ƒå°çš„æ•°çš„ä¸ªæ•°ã€‚\nç›¸åŒå…ƒç´ æ€ä¹ˆå¤„ç†ï¼Ÿ\nåœ¨æ”¹ä¹‹å‰å¼ºè¡Œç´¯ç§¯ä¸€ä¸‹å°±å¯ä»¥äº†ï¼ŒæŠŠåé¢çš„æ•°å¯¹äºå‰é¢çš„è´¡çŒ®ç»™é¢„å…ˆåŠ ä¸Šå»å°±å¯ä»¥äº†ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110  #include \u0026lt;bits/stdc++.h\u0026gt;using namespace std; int n,k; const int MAXN = 210000; namespace fast_io{ //... }using namespace fast_io; namespace BIT{ int sumn[MAXN]; int lowbit(int x){return x \u0026amp; (-x);} void add(int x,int d){ for(;x \u0026lt;= k;x += lowbit(x)) sumn[x] += d; } int query(int x){ int ans = 0; for(;x \u0026gt;= 1;x -= lowbit(x)) ans += sumn[x]; return ans; } } struct Q{ int a,b,c; Q(){} Q(int x,int y,int z):a(x),b(y),c(z){} bool operator \u0026lt; (Q w)const{ if(a != w.a) return a \u0026lt; w.a; if(b != w.b) return b \u0026lt; w.b; else return c \u0026lt; w.c; } bool operator == (Q w)const{ return a == w.a \u0026amp;\u0026amp; b == w.b \u0026amp;\u0026amp; c == w.c; } }q[MAXN]; bool judge(int x,int y){ // ç”¨äºç¬¬äºŒç»´çš„å½’å¹¶åˆ¤æ–­  if(q[x].b!=q[y].b) return q[x].b \u0026lt; q[y].b;//æ¯”è¾ƒä¸¤æ•°çš„c  if(q[x].c!=q[y].c) return q[x].c \u0026lt; q[y].c;//æ¯”è¾ƒä¸¤æ•°çš„c  else return x \u0026lt; y;//æœ€åæ¯”è¾ƒä¸¤æ•°çš„id } int d[MAXN],ans[MAXN],tt[MAXN]; int tmp[MAXN]; int tot,l,r; void CDQ(int *t,int num,int depth = 0){ //t[0] -\u0026gt; t[num-1] (numä¸ªå…ƒç´ ï¼‰  if(num == 1) return; int mid = num/2; CDQ(t,mid,depth+1),CDQ(t+mid,num-mid,depth+1); // é€’å½’åˆ†æ²»é—®é¢˜  for(tot = 0,l = 0,r = mid;l \u0026lt; mid \u0026amp;\u0026amp; r \u0026lt; num;tot++){ //å½’å¹¶è¿‡ç¨‹ï¼Œç»Ÿè®¡å·¦åŠåŒºé—´å¯¹å³åŠåŒºé—´çš„è´¡çŒ®  //å¦‚æœåœ¨å·¦åŒºé—´ï¼Œå°±æŠŠå…¶å½“ä½œä¿®æ”¹ï¼Œæ›´æ–°æ ‘çŠ¶æ•°ç»„  //å¦‚æœåœ¨å³åŒºé—´ï¼Œå°±æŠŠå…¶å½“ä½œæŸ¥è¯¢ï¼ŒæŸ¥è¯¢æ ‘çŠ¶æ•°ç»„ï¼Œæ›´æ–°ç­”æ¡ˆ  if(judge(t[l],t[r])) BIT::add(q[t[l]].c,1),tmp[tot] = t[l++]; else ans[t[r]] += BIT::query(q[t[r]].c),tmp[tot] = t[r++]; } //å‰©ä½™çš„å½’å¹¶  while(l \u0026lt; mid) BIT::add(q[t[l]].c,1),tmp[tot++] = t[l++]; while(r \u0026lt; num) ans[t[r]] += BIT::query(q[t[r]].c),tmp[tot++] = t[r++]; for(int i = 0;i\u0026lt;mid;i++) BIT::add(q[t[i]].c,-1);//æ¸…ç©ºæ ‘çŠ¶æ•°ç»„  memcpy(t,tmp,sizeof(int) * num);//æ‹·è´æ•°ç»„ } void init(){ read(n),read(k); int a,b,c; for(int i = 1;i\u0026lt;=n;i++){ read(a),read(b),read(c); q[i] = Q(a,b,c); } } void solve(){ sort(q+1,q+n+1); for(int i = n;i\u0026gt;=1;--i){ // ç´¯è®¡ç›¸åŒå…ƒç´ çš„è´¡çŒ®  if(q[i] == q[i+1]) ans[i] = ans[i+1] + 1; tt[i] = i; } CDQ(tt+1,n); for(int i = 1;i\u0026lt;=n;i++) ++d[ans[i]]; for(int i = 0;i\u0026lt;n;i++) print(d[i]),print(\u0026#39;\\n\u0026#39;); } int main(){ init(); solve(); flush(); return 0; }   ","description":"","id":169,"section":"posts","tags":["CDQåˆ†æ²»","æ ‘çŠ¶æ•°ç»„","æ¨¡æ¿"],"title":"ã€Œæ¨¡æ¿ã€é™Œä¸ŠèŠ±å¼€-CDQåˆ†æ²»+æ ‘çŠ¶æ•°ç»„","uri":"https://blog.chenqiqian.com/posts/luogu-3810/"},{"content":"å¯¹äºä¸€æ£µæ ‘ï¼Œæˆ‘ä»¬å¯ä»¥å°†æŸæ¡é“¾å’Œä¸è¯¥é“¾ç›¸è¿çš„è¾¹æŠ½å‡ºæ¥ï¼Œç§°å…¶ä¸ºä¸€ä¸ªâ€œæ¯›æ¯›è™«â€ã€‚æ±‚åœ¨è¿™ä¸ªæ ‘ä¸­ç‚¹æ•°æœ€å¤šçš„æ¯›æ¯›è™«çš„ç‚¹æ•°ã€‚\n$n \u0026lt; 300000$\né“¾æ¥ Luogu P3174\né¢˜è§£ å¾ˆç®€å•çš„ä¸€é“ $dp$ é¢˜ï¼ˆæ„Ÿè§‰è¿™ä¸ªä¸œè¥¿åƒä¸€ä¸ª $faKe$ çš„ $dp$ ï¼‰\u0026hellip;\néšä¾¿æ‰¾ä¸€ä¸ªæ ¹ï¼Œè®°å½• $in[x]$ ä¸º $x$ èŠ‚ç‚¹çš„åº¦ï¼Œä»¤ $d[x]$ ä¸ºä» $x$ èŠ‚ç‚¹å‘ä¸‹æœ€é•¿çš„æ¯›æ¯›è™«çš„è¾¹æ•°ï¼ˆå« $x$ è¿å‘å…¶ä»–å„¿å­åŠå…¶è¿å‘çˆ¶èŠ‚ç‚¹çš„è¾¹ï¼‰ã€‚\nçŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š\n$d[x] = \\max(d[v]) + in[x]$\nç»Ÿè®¡ç­”æ¡ˆçš„æ—¶å€™ï¼Œåœ¨ $dfs$ è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬è®°å½•å…¶å­æ ‘é‡Œé¢çš„æœ€å¤§çš„ä¸¤ä¸ª $d$ ï¼Œæœ€åæ›´æ–° $ans = max(ans,d + d' + in[x])$ ã€‚\næœ€åç»™ ans +1 ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;vector\u0026gt;#include \u0026lt;cctype\u0026gt;using namespace std; namespace fast_io{ //... }using namespace fast_io; const int MAXN = 310000; vector\u0026lt;int\u0026gt; edge[MAXN]; int n,m,d[MAXN],in[MAXN],ans = 0; void dfs(int nown,int fa){ //d[nown] -\u0026gt; ä»nownå¾€ä¸‹èµ°çš„æœ€å¤§æ¯›æ¯›è™«  int maxa = 0,maxb = -0x3f3f3f3f; for(int i = 0;i\u0026lt;edge[nown].size();i++){ int v = edge[nown][i]; if(v == fa) continue; dfs(v,nown); d[nown] = max(d[nown],d[v]); if(d[v] \u0026gt;= maxa) maxb = maxa,maxa = d[v]; else if(d[v] \u0026gt;= maxb) maxb = d[v]; } ans = max(ans,maxa+maxb+in[nown]); d[nown] += in[nown]-1; } void init(){ read(n),read(m); int a,b; for(int i = 1;i\u0026lt;=m;i++){ read(a),read(b); edge[a].push_back(b); edge[b].push_back(a); in[a]++;in[b]++; } } void solve(){ dfs(1,0); printf(\u0026#34;%d\\n\u0026#34;,ans+1); } int main(){ init(); solve(); return 0; }   ","description":"","id":170,"section":"posts","tags":["æ ‘å½¢dp","åŠ¨æ€è§„åˆ’"],"title":"ã€ŒHAOI2009ã€æ¯›æ¯›è™«-æ ‘å½¢dp","uri":"https://blog.chenqiqian.com/posts/haoi2009-worm/"},{"content":"é’æ˜¥çœŸçš„æ˜¯ä¸€ä¸ªéå¸¸ç©ºæ³›è€Œåˆä»¤äººè¿·èŒ«çš„è¯æ±‡ã€‚\né’æ˜¥è®¾è®¡å¸ˆ  æ–‡ç« æ¥è‡ªæˆ‘æ ¡å¹´çº§èŒƒæ–‡ã€‚\n æˆ‘æ˜¯ä¸€åæ–°æ™‹çš„é’æ˜¥è®¾è®¡å¸ˆï¼Œä¸ºäººä»¬è®¾è®¡å¹³è¡Œå®‡å®™ä¸­å¦ä¸€ä¸ªè‡ªå·±çš„é’æ˜¥ã€‚ç­‰ä»–ä»¬åˆ°äº†é‚£é‡Œï¼Œå°±èƒ½è¿‡ä¸Šè‡ªå·±æƒ³è¦çš„ç”Ÿæ´»ã€‚\nç½‘ç«™æç¤ºéŸ³ä¸€å“ã€‚ç¬¬ä¸€å•ï¼æˆ‘æ¿€åŠ¨çš„æ‰“å¼€ä¿¡æ¯å•ï¼šè¦æ±‚æ åªå†™ç€ä¸¤ä¸ªå­—ï¼šå®Œç¾ã€‚\nå®Œç¾çš„é’æ˜¥æ˜¯ä»€ä¹ˆæ ·å­ï¼Ÿæˆ‘å¼€å§‹æ„æƒ³ã€‚\nä»–è¦ç”Ÿæ´»åœ¨æ¸©é¦¨çš„å®¶åº­ï¼Œçˆ¶äº²è¦ä¸¥æ ¼è€Œä¸å¤±å¹½é»˜ï¼Œä¸ºä»–æ ‘ç«‹ç”Ÿæ´»ä¸­çš„æƒå¨å’Œæ¡æ¡†ã€‚æ¯äº²è¦æ…ˆå–„è´¤æƒ ï¼Œè®©ä»–æ„Ÿåˆ°ä¸–ç•Œçš„æ¸©åº¦ä¸å’Œå–„ã€‚ä»–è¦å’Œçˆ¶æ¯ä¿æŒè‰¯å¥½çš„å…³ç³»ã€‚ä»–è¦åœ¨äº²å­çš„å¯¹è¯ä¸­äº†è§£è¿™ä¸ªä¸–ç•ŒçœŸå®çš„æ ·å­ï¼Œå¹¶å­¦ä¼šä¸ºäººå¤„äº‹çš„æ–¹æ³•ï¼Œä»è€Œå½¢æˆå¥å…¨çš„å¿ƒç†å’Œç‹¬ç«‹çš„äººæ ¼\u0026hellip;\u0026hellip;å½“æˆ‘çœ‹ç€è‡ªå·±çš„è®¾å®šååˆ†æ»¡æ„æ—¶ï¼Œå¿ƒä¸­å´å‡ºç°äº†åˆ«çš„å£°éŸ³ï¼šç”¨è‡ªå·±çš„è¡€è‚‰è§¦ç¢°ä¸–ç•Œçš„æ¡æ¡†ï¼Œç”¨è‡ªå·±çš„æ–¹å¼ç†è§£ä¸–ç•Œï¼Œä¸æ­£æ˜¯é’æ˜¥çš„æ„ä¹‰å—ï¼Ÿæˆ‘é™·å…¥äº†è¿·èŒ«ï¼Œç‚¹å‡»äº†â€œæš‚å­˜â€ã€‚\nä»–è¦æ“…é•¿ä¸€é¡¹ä½“è‚²è¿åŠ¨ï¼Œå¹¶ä»ä¸­ç»“äº¤ä¸€ç¾¤æœ‹å‹ï¼Œéƒ½è¯´â€œæ— è¿åŠ¨ï¼Œä¸é’æ˜¥â€ï¼Œçƒåœºä¸ŠçŸ«å¥çš„èº«å½±æ‰æ˜¯é’æ˜¥è¯¥æœ‰çš„æ ·å­ã€‚è¿™æ˜¯ä»–åœ¨é’æ˜¥å²æœˆé‡Œç«­å°½å…¨åŠ›çš„æ–¹å¼ã€‚ä»–ä¸ºäº†ç›®æ ‡â€”â€”è¿›çƒå¾—åˆ†ï¼ŒæŒ¥æ±—å¦‚é›¨ï¼Œæ‹¼å°½å…¨åŠ›ã€‚ç»“æŸçš„å“¨å£°å³å°†å“èµ·ï¼Œä»–ç¬¬ä¸€æ¬¡ä½“ä¼šä½•è°“æ”¾æ‰‹ä¸€æã€‚è‚Œè‚‰çš„åŠ›é‡ï¼Œæ„å¿—çš„åšå®šï¼Œå†åŠ ä¸Šä¸€ç‚¹è¿æ°”ï¼Œçƒè¿›ï¼åœºå¤–å¥³å­©å­çš„å°–å«åˆ’ç ´å¤©ç©ºï¼Œå¦‚èµæ­Œèˆ¬å……æ–¥ç€ä»–çš„åŒè€³ã€‚ä»–åŒçœ¼æ¨¡ç³Šï¼Œå€’åœ¨å…„å¼Ÿçš„æ‰‹è‡‚ä¸Šã€‚é‚£æ˜¯ä»–ç¬¬ä¸€æ¬¡ç«™ä¸Šä¸–ç•Œä¹‹å·…ã€‚ä»–å°åˆ°äº†è‡ªä¿¡å’ŒæˆåŠŸçš„å‘³é“\u0026hellip;æˆ‘ä¸€ééä¸ºè¿™ç¾å¦™çš„ä½“éªŒé¼“æŒï¼Œè€Œå¤šç–‘çš„ç¥ç»åˆå æ®äº†è„‘æµ·ï¼šåœ¨é’æ˜¥å¹´åï¼Œæˆ‘ä»¬ä¹Ÿä¼šç»å¸¸çŠ¯é”™å•Šï¼ä½†æ­£æ˜¯åœ¨é’æ˜¥æ—¶æœŸçš„ä¸æ–­è·Œå€’å’Œå†æ¬¡çˆ¬èµ·ï¼Œé“¸å°±äº†æˆ‘ä»¬å¿ƒæ™ºçš„æˆç†Ÿå’Œæœªæ¥æˆåŠŸçš„åŸºçŸ³ã€‚è°¬èµçš„æµªæ½®ä½¿äººè†¨èƒ€ï¼Œè€Œè†¨èƒ€å’Œè‡ªè´Ÿæ°æ˜¯æˆç†Ÿçš„æ€æ‰‹ã€‚ä»–çš„é’æ˜¥è¯¥å¦‚ä½•æç»˜ï¼Ÿæ¥è¿ä¸æ–­çš„æˆåŠŸï¼Œè¿˜æ˜¯ä»¤äººæ²®ä¸§çš„å¤±è´¥ï¼Ÿæˆ‘å†æ¬¡æŒ‰ä¸‹â€œæš‚å­˜â€ã€‚\nä»–è¦åœ¨é’æ˜¥å¹´ååˆå°çˆ±æƒ…çš„ç”œèœœã€‚ä»è§åˆ°é‚£ä¸ªå¥³å­©çš„ç¬¬ä¸€é¢èµ·ï¼Œä»–çš„ç›®å…‰å°±å†æ²¡ç¦»å¼€è¿‡å¥¹ã€‚ä»–å¯¹å¥¹å¹¶æ— åŠç‚¹æ‚å¿µï¼Œå•çº¯çš„æ³¨è§†å°±å·²ç»èƒ½è®©ä»–æ„Ÿåˆ°å¹¸ç¦ã€‚å¥¹çš„ä¸€é¢¦ä¸€ç¬‘ï¼Œä¸€ä¸¾ä¸€åŠ¨æ˜¯é‚£ä¹ˆçº¯çœŸï¼Œæ¾„æ¾ˆã€‚å¥¹å°±æ˜¯å¤©ä½¿ã€‚é‚£ä¸ªç‚çƒ­çš„ä¸‹åˆï¼Œä»–ç”¨äº†ä¸€èŠ‚è¯¾çš„æ—¶é—´ï¼Œç»ˆäºåœ¨æ¡Œå­ä¸‹é¢ç‰µåˆ°äº†å¥¹çš„æ‰‹ã€‚ä»–å‘†å‘†åœ°ç›¯ç€æ¡Œä¸Šæ ‘å¶äº¤é”™æ–‘é©³çš„å½±å­ï¼ŒåŠä¸ªèº«å­éƒ½æ¶Œä¸Šçƒ­æµã€‚ä¹‹åçš„æ—¥å­é‡Œï¼Œä»–ä»¬çš„ç”œèœœä¸€å¦‚åˆè§ã€‚äºŒäººå¿ƒæœ‰çµçŠ€ï¼Œç´ç‘Ÿå’Œé¸£ï¼Œæ— ä¸ç¾¡ç…æ—äººã€‚\næˆ‘å®¡è§†è¿™çº¯ç²¹è€Œå®Œç¾çš„çˆ±æƒ…ï¼Œææƒšé—´åƒçœ‹åˆ°ä¸€åœºé’æ˜¥çš„å¤§æ¢¦ã€‚æ¿€çƒˆçš„äº‰åµå’Œå†…å¿ƒçš„å¤§é›¨æ»‚æ²±ä½•ä¸æ˜¯é’æ˜¥èŠ±å›­çš„ä¸€éƒ¨åˆ†ï¼Ÿäº‰ç«¯å’Œè¯¯è§£æ­£æ˜¯å¯è’™ï¼Œå¸¦æˆ‘ä»¬èµ°è¿›å¼‚æ€§çš„ä¸–ç•Œã€‚åœ¨äººç”Ÿçš„é›¨å­£ï¼Œæˆ‘ä»¬ä¿®ç‚¼çˆ±æƒ…ï¼Œä¸æ–­æˆé•¿ï¼Œä¸æ­£æ˜¯é’æ˜¥çš„å¹¸ç¦å—ï¼Ÿä¸¤ä¸ªé’æ˜¥çš„çˆ±æƒ…æ€æ ·æ‰ç®—æ˜¯å®Œç¾ï¼Œæˆ‘æœ‰äº›èŒ«ç„¶ã€‚\nå‘†ååœ¨ç”µè„‘å‰ï¼Œæµè§ˆç€åˆšåˆšå†™ä¸‹çš„æ–‡å­—ï¼Œæ— è®ºæ€ä¹ˆä¿®æ”¹ï¼Œæˆ‘æ€»è§‰å¾—è·ç¦»â€œå®Œç¾â€è¿˜å·®äº†ä¸€ç‚¹ã€‚æˆ‘ç›¯ç€è¦æ±‚æ é‡Œçš„â€œå®Œç¾â€ä¸¤å­—ï¼Œä»åˆåç›¯åˆ°é»„æ˜ï¼Œç”šè‡³æ‹¿å‡ºæ”¾å¤§é•œï¼Œæƒ³é€šè¿‡é€é•œçœ‹å‡ºä»€ä¹ˆæ¥ã€‚è‰¯ä¹…ï¼Œæˆ‘ç»ˆäºçœ‹å‡ºäº†ä¸¤ä¸ªå­—ï¼š\n â€œé—æ†¾â€ã€‚\n æˆ‘æ˜ç™½äº†ã€‚\næˆé•¿å³ç ´ç¢ï¼Œé’æ˜¥ç»ˆæœ‰é—æ†¾ã€‚\næˆ‘å¿«é€Ÿçš„æ‰¾åˆ°â€œä¸ªäººå±¥å†â€ä¸€æ ï¼Œå¤åˆ¶ï¼Œç²˜è´´ï¼Œå‘é€ã€‚\nä¹‹åï¼Œæˆ‘å…³æ‰äº†ç½‘ç«™ï¼Œå†ä¸è®¾è®¡é’æ˜¥ã€‚\n æ–‡ç« æ¥è‡ªæˆ‘æ ¡å¹´çº§èŒƒæ–‡ã€‚å¦‚æœä½œè€…åŒå­¦å¯¹äºæˆ‘æ“…è‡ªçš„å‘è¡¨æœ‰ä»»ä½•æ„è§ï¼Œæˆ‘ä¼šå°†æ–‡ç« ç«‹åˆ»æ’¤ä¸‹ã€‚\n é’æ˜¥  ä»¥ä¸‹æ˜¯æˆ‘éšä¾¿ä¹±å†™çš„\n æˆ–è®¸é’æ˜¥æ°¸è¿œéƒ½ä¸å­˜åœ¨æ‰€è°“â€œå®Œç¾â€ã€‚\næˆ‘æ›¾ç»æ€è€ƒè¿‡æˆ‘çš„è¿‡å»ã€ç°åœ¨å’Œæœªæ¥ã€‚\næˆ‘çš„è¿‡å»ï¼Œä½•æ—¶å›å¿†èµ·æ¥ä¹Ÿä¸å…æ¬¢æ¬£ã€‚\næˆ‘çš„å®¶é•¿ï¼Œå¯¹äºæˆ‘çš„ç®¡æ•™åº”è¯¥è¯´è¿˜ç®—æ˜¯æ¯”è¾ƒä¸¥æ ¼ï¼Œå°å­¦æ¯å¤©å…«ç‚¹åŠéƒ½è¦ä¸ŠåºŠç¡è§‰ï¼Œå³ä½¿åˆ°äº†ä¸­è€ƒå‰å¤•ï¼Œä¹ç‚¹åŠç‚¹ä¹‹å‰ä¹Ÿå¿…é¡»è¦åœ¨åºŠä¸Šèººç€ã€‚è¿™çš„ç¡®å¯¹æˆ‘æœ‰æå¤§çš„å¸®åŠ©ã€‚å¦‚æœè¯´åˆ°å­¦æ ¡ï¼Œå…¶å®æˆ‘å¯¹äºå°å­¦çš„è®°å¿†å·²ç»æ¸æ¸æ¨¡ç³Šäº†ï¼Œç”šè‡³è¿åœ¨å“ªé‡Œä¸Šçš„è¯¾éƒ½ä¸å¤ªè®°å¾—ã€‚ä½†æˆ‘ææ€•ä¸€è¾ˆå­ä¹Ÿä¸èƒ½å¿˜è®°ï¼Œåœ¨é‚£é‡Œæ‡µæ‡µæ‡‚æ‡‚çš„æˆé•¿çš„æ—¶å…‰ã€‚åœ¨é‚£ä¸ªæœ€çº¯çœŸçš„æ—¶å€™ï¼Œæˆ‘æ”¶è·çš„ä¸æ­¢å‡ æ®µæœ€ä¸ºç¾ä¸½çš„å‹æƒ…ï¼Œæ›´æœ‰è®¸å¤šçš„æˆé•¿ã€‚å°çš„æ—¶å€™æ¯å¤©éƒ½åç­è½¦ï¼Œè™½ç„¶æ²¡æœ‰ä»€ä¹ˆäººæ„¿æ„è·Ÿæˆ‘è¯´è¯ï¼Œä½†æˆ‘ä¹Ÿå› æ­¤åœ¨è½¦ä¸Šè¯»äº†è®¸å¤šè®¸å¤šçš„ä¹¦ã€‚æˆ–è®¸æˆ‘ç°åœ¨å¯¹äººç”Ÿçš„è®¸å¤šçœ‹æ³•ï¼Œä¹Ÿæ˜¯åœ¨é‚£å‡ å¹´çš„ç­è½¦ä¸Šè·å¾—çš„ã€‚åˆä¸­ï¼Œåœ¨æˆ‘å½“æ—¶çœ‹æ¥ï¼Œå¯ä»¥è¯´æ˜¯ä¾¥å¹¸æ··åˆ°äº†æœ¬åŒºæœ€å¥½çš„åˆä¸­å§ã€‚åŒå­¦éƒ½æ˜¯å¾ˆæ£’çš„ä¸€äº›äººã€‚æœ‰çš„äººæ“…é•¿å­¦ä¹ ï¼Œåœ¨å­¦ä¹ ä¸Šç»™äº†æˆ‘è®¸å¤šçš„å¸®åŠ©ï¼›æœ‰çš„äººæ€æƒ³æ·±é‚ƒï¼Œæ•™ä¼šæˆ‘å»å¦‚ä½•æ›´å¥½çš„ç†è§£è¿™ä¸ªä¸–ç•Œã€‚ç›¸å¯¹äºå°å­¦ï¼Œæˆ‘å€’æ˜¯æ›´è®¤ä¸ºåˆä¸­çš„è€å¸ˆè®©æˆ‘æˆé•¿æ›´å¤šã€‚æ— è®ºå¦‚ä½•ï¼Œæˆ‘çš„åˆä¸­ç”Ÿæ´»å¾ˆå¿«ä¹Ÿå°±ç»“æŸäº†ã€‚ä¸€ä¸ªæ‡µæ‡‚çš„å­©ç«¥ç»ˆäºé•¿æˆä¸€ä¸ªå°‘å¹´ï¼Œå½“ç„¶è¦å½’åŠŸäºæˆ‘äº²çˆ±çš„è€å¸ˆå’ŒåŒå­¦ä»¬ï¼Œè¿˜æœ‰æˆ‘çš„å®¶é•¿ã€‚\næˆ‘çš„ç°åœ¨ï¼Œæ˜¯ä¸€ä¸ªè¿‘ä¹å®Œç¾çš„ç°åœ¨ã€‚\nä¸è´Ÿä¼—æœ›çš„ï¼Œæˆ‘è€ƒè¿›äº†æœ¬æ ¡çš„é«˜ä¸­ã€‚ä¸€ä¸ªä¸‰å¹´ï¼Œæ¥ä¸‹æ¥çš„åˆæ˜¯ä¸€ä¸ªä¸‰å¹´ã€‚å°å­¦çš„å…­å¹´ï¼Œå¹¶æ²¡æœ‰ç»™æˆ‘ç•™ä¸‹ä»€ä¹ˆå°è±¡ï¼›è€Œä¸­å­¦çš„å…­å¹´ï¼Œåˆ™ä¼šæ˜¯äººç”Ÿä¸­ä¸å¯ç£¨ç­çš„ä¸€éƒ¨åˆ†ã€‚åŒå­¦è‡ªç„¶ååˆ†ä¼˜ç§€ï¼Œè€å¸ˆä¹Ÿæ˜¯éå¸¸æœ‰æ‰åï¼Œæˆ‘ç°åœ¨æ‰€æ‹¥æœ‰çš„ä¸€åˆ‡ææ€•æ˜¯ä»¥å‰è¿æ¢¦éƒ½ä¸æ•¢æ¢¦çš„æ‰€æœ‰ã€‚ä¸€åˆ‡ä¸€åˆ‡ï¼Œéƒ½è®©æˆ‘ä¸€ç›´è®¤ä¸ºï¼Œæˆ‘çš„ç°åœ¨ï¼Œå·²ç»æ˜¯æœ€å¥½çš„ç°åœ¨äº†ã€‚\næˆ‘çš„æœªæ¥ï¼Œå¤§çº¦ä¹Ÿä¼šæ˜¯ä»¤äººå‘å¾€çš„è¿œæ–¹ã€‚\næˆ‘æ‰€æ‹¥æœ‰çš„ä¸€åˆ‡ï¼Œéƒ½åœ¨æ¿€åŠ±ç€æˆ‘ç»§ç»­å‰è¡Œã€‚æˆ‘æœ‰è´Ÿè´£çš„å®¶äººï¼Œç»™æˆ‘çš„å¥‹æ–—æœ€å¤§çš„æ”¯æŒï¼›æˆ‘æœ‰çƒ­çˆ±çš„äº‹ä¸šï¼Œå¹¶ä¸”æˆ‘åœ¨è¿™ä¸Šé¢ä¹Ÿè·å¾—äº†æ— å¯æ¯”æ‹Ÿçš„æˆå°±æ„Ÿï¼›æˆ‘æœ‰æ·±æ·±çˆ±ç€çš„äººï¼Œæ— è®ºä½•æ—¶éƒ½ä¼šç»™æˆ‘æˆ‘å®‰æ…°ä¸é¼“åŠ±ï¼›æˆ‘æœ‰è´Ÿè´£ä»»çš„è€å¸ˆï¼Œä¼šç»™æˆ‘åœ¨å­¦ä¸šä¸Šä¸€åˆ‡å¯èƒ½çš„å¸®åŠ©ï¼›æˆ‘æœ‰ä¸€ç¾¤å¯çˆ±çš„åŒå­¦ï¼Œå§‹ç»ˆè®©æˆ‘åœ¨æ¯å¤©æ”¾å­¦éƒ½èƒ½å¸¦ç€å¾®ç¬‘å›å®¶ï¼Œä¸è®ºç”Ÿæ´»çš„ç¹å¿™ä¸å¦ï¼›è€Œæˆ‘ç°åœ¨æ‰€å–å¾—çš„ä¸€åˆ‡ï¼Œä¹Ÿå‘Šè¯‰æˆ‘ï¼šæœªæ¥å……æ»¡ç€å¸Œæœ›ã€‚äººç”Ÿä¸­æœ€ç¾å¥½çš„äº‹æƒ…æˆ–è®¸ä¹Ÿå°±è«è¿‡äºï¼Œæ¯ä¸€å¤©éƒ½æ˜¯æ€€æ£ç€å¸Œæœ›è€Œå‰è¡Œå§ã€‚\nå½“æ—¶çœ‹åˆ°è¿™ç¯‡èŒƒæ–‡ï¼Œçªç„¶å°±æƒ³åˆ°äº†è‡ªå·±ã€‚æ„Ÿè°¢æˆ‘ç”Ÿå‘½é‡Œé‡åˆ°çš„æ‰€æœ‰äººï¼Œä¸è®ºæ˜¯åˆ°ç°åœ¨å·²ç»ç›¸å¿˜ï¼Œè¿˜æ˜¯ä¾æ—§ç›¸éšè€Œè¡Œï¼›ä¸è®ºæˆ‘ä»¬ä¹‹é—´æ˜¯è‡³ä»Šä¸æ¸çš„å‹æƒ…ï¼Œè¿˜æ˜¯æ— æ³•å¼¥è¡¥çš„ä¼¤ç—•ï¼Œæ„Ÿè°¢ä½ ä»¬è®©æˆ‘å®Œå…¨åœ°æˆé•¿ï¼Œè®©æˆ‘æ‹¥æœ‰è¿™ä¹ˆä¸€ä¸ªå®Œç¾çš„é’æ˜¥ã€‚\né²è¿…ä¹Ÿè¯´è¿‡ï¼šâ€œä½¿ç²¾ç¥çš„ä¸ç¼•è¿˜ç‰µç€å·²é€çš„å¯‚å¯çš„æ—¶å…‰ï¼Œåˆæœ‰ä»€ä¹ˆæ„ä¹‰å‘¢ã€‚â€\nè™½è¯´é’æ˜¥ç»ˆæœ‰é—æ†¾ï¼Œä½†å¦‚æœè¿™ä¸€åˆ‡éƒ½æ˜¯ä½ çˆ±çš„äººå’Œçˆ±ä½ çš„äººä¸€èµ·ä¸ºä½ å†™å°±ï¼Œé‚£ä¹ˆæ˜¯å¦é—æ†¾ï¼Œæˆ–è®¸ä¹Ÿä¸é‚£ä¹ˆé‡è¦ã€‚\nè¿™ç¯‡æ–‡ç« å†™çš„åŒ†å¿™ï¼Œæ¥ä¸åŠç»†ç»†æ‰“ç£¨ï¼Œå¦‚æœæœ‰æ–‡æ„ç–æ¼ä¹‹å¤„ï¼Œåœ¨æ‰€éš¾å…ï¼Œè¯·è§‚è€…åŸè°…ã€‚\n","description":"","id":171,"section":"posts","tags":null,"title":"ã€Œæ‘˜å½•ã€é’æ˜¥è®¾è®¡å¸ˆ-å¹´çº§èŒƒæ–‡","uri":"https://blog.chenqiqian.com/posts/essay-youth-designer/"},{"content":"ç»™å‡ºä¸€ä¸ª $n$ ä¸ªèŠ‚ç‚¹çš„æœ‰æ ¹æ ‘ã€‚æœ‰ $q$ æ¬¡è¯¢é—®ï¼Œæ¯æ¬¡è¯¢é—®ç»™å‡º $l,r,z$ ï¼Œæ±‚ $\\sum_{l \\leq i \\leq r}dep[LCA(i,z)]$ ã€‚\né“¾æ¥ Luogu P4211\né¢˜è§£ ç¥ä»™é¢˜\u0026hellip;çœŸæ˜¯ä¸çŸ¥é“è€ƒåœºä¸Šæœ‰æ²¡æœ‰äººèƒ½å¤Ÿæƒ³åˆ°ã€‚\nç»™å‡ºè¿™æ ·ä¸€ä¸ªç»“è®ºï¼š\n èŠ‚ç‚¹ $x$ å’Œ $y$ çš„ $lca$ åˆ°æ ¹èŠ‚ç‚¹çš„è·ç¦»ç­‰äºåœ¨ $x$ åˆ°æ ¹èŠ‚ç‚¹çš„è·¯å¾„ä¸Šä¸” $y$ åˆ°æ ¹èŠ‚ç‚¹çš„è·¯å¾„ä¸Šçš„èŠ‚ç‚¹ä¸ªæ•°ã€‚\n æ‰€ä»¥å¦‚æœæˆ‘ä»¬å°† $[l,r]$ ä¸­çš„ç‚¹åˆ°æ ¹èŠ‚ç‚¹çš„è·¯å¾„ä¸Šæ‰€æœ‰çš„èŠ‚ç‚¹çš„å€¼åˆ†åˆ«åŠ  $1$ ï¼Œè¿™ä¸ªæ—¶å€™ $z$ åˆ°æ ¹èŠ‚ç‚¹çš„è·¯å¾„ä¸Šçš„æƒå€¼å’Œå°±æ˜¯æŸ¥è¯¢ $(l,r,z)$ çš„ç­”æ¡ˆã€‚\nè€Œä¸”æˆ‘ä»¬æ³¨æ„åˆ°è¿™ä¸ªé—®é¢˜æ»¡è¶³åŒºé—´å¯å‡æ€§ï¼š\nå³è®¾ $sum(l,r) = \\sum_{l\\leq i\\leq r}{dep[LCA(i,z)]}$ ï¼Œæœ‰ $sum(l,r) = sum(1,r)-sum(1,l-1)$ ã€‚\nå› æ­¤ï¼Œæˆ‘ä»¬å°†è¯¢é—® $(l,r,z)$ åˆ†ç¦»æˆ $(l-1,z)$ å’Œ $(r,z)$ ã€‚\næˆ‘ä»¬ç”¨ $(t_i,pos_i)$ ä»£è¡¨è¯¢é—®ã€‚æŒ‰ç…§ $t_i$ ä¸ºç¬¬ä¸€å…³é”®å­—è¿›è¡Œæ’åºç¦»çº¿ä¹‹åæŸ¥è¯¢ã€‚æ¯æ¬¡æŸ¥è¯¢çš„æ—¶å€™ï¼Œä½¿å¾— $1~t_i$ çš„æ‰€æœ‰èŠ‚ç‚¹éƒ½å·²ç»æŠŠå¾€æ ¹èŠ‚ç‚¹çš„è·¯å¾„ä¸Šéƒ½åšäº†ä¿®æ”¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦æŸ¥è¯¢ä¸€ä¸ª $(1,pos_i)$ çš„è·¯å¾„ä¸Šçš„èŠ‚ç‚¹çš„æƒå€¼å’Œå³å¯ã€‚\nè¿™ä¸ªä¸œè¥¿å¦‚æœç”¨æ ‘é“¾å‰–åˆ†+çº¿æ®µæ ‘ï¼Œå¤æ‚åº¦æ˜¯ $O(n \\log^{2}{n})$ ï¼Œå¦‚æœç”¨ LCTï¼Œå¤æ‚åº¦æ˜¯ $O(n\\log n)$ ã€‚\nå…¶å®æˆ‘æ„Ÿè§‰è¿™é“é¢˜å®Œå…¨å¯ä»¥å‡ºåˆ° $200000$ ï¼Œç„¶åç»™ $O(n \\log^{2}{n})$ äº”å…­ååˆ†éƒ¨åˆ†åˆ†ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;vector\u0026gt;#include \u0026lt;algorithm\u0026gt;#include \u0026lt;cctype\u0026gt;using namespace std; namespace fast_io { //... }using namespace fast_io; const int MAXN = 210000,mod = 201314; int n,m; vector\u0026lt;int\u0026gt; edge[MAXN]; int dep[MAXN],son[MAXN],top[MAXN],siz[MAXN],fa[MAXN],id[MAXN],cnt = 0; void dfs1(int nown,int f,int depth){ siz[nown] = 1;dep[nown] = depth; fa[nown] = f; for(int i = 0;i\u0026lt;edge[nown].size();i++){ int v = edge[nown][i]; if(v == f) continue; dfs1(v,nown,depth+1); siz[nown] += siz[v]; if(siz[v] \u0026gt; siz[son[nown]]) son[nown] = v; } } void dfs2(int nown,int topf){ top[nown] = topf; id[nown] = ++cnt; if(!son[nown]) return; dfs2(son[nown],topf); for(int i = 0;i\u0026lt;edge[nown].size();i++){ int v = edge[nown][i]; if(v == fa[nown] || v == son[nown]) continue; dfs2(v,v); } } namespace SegTree{ int sumn[MAXN],addn[MAXN]; #define lson (nown\u0026lt;\u0026lt;1)  #define rson ((nown\u0026lt;\u0026lt;1)|1)  #define mid ((l+r)\u0026gt;\u0026gt;1)  void push_up(int nown){ sumn[nown] = sumn[lson] + sumn[rson]; sumn[nown] %= mod; } void add(int nown,int l,int r,int d){ sumn[nown] += d*(r-l+1); addn[nown] += d; sumn[nown] %= mod,addn[nown] %= mod; } void push_down(int nown,int l,int r){ if(addn[nown]){ add(lson,l,mid,addn[nown]); add(rson,mid+1,r,addn[nown]); addn[nown] = 0; } } void add(int nown,int l,int r,int ql,int qr,int d){ if(ql \u0026lt;= l \u0026amp;\u0026amp; r \u0026lt;= qr){ add(nown,l,r,d); } else{ push_down(nown,l,r); if(ql \u0026lt;= mid) add(lson,l,mid,ql,qr,d); if(mid+1 \u0026lt;= qr) add(rson,mid+1,r,ql,qr,d); push_up(nown); } } int query(int nown,int l,int r,int ql,int qr){ if(ql \u0026lt;= l \u0026amp;\u0026amp; r \u0026lt;= qr) return sumn[nown]; else{ push_down(nown,l,r); int ans = 0; if(ql \u0026lt;= mid) ans += query(lson,l,mid,ql,qr); if(mid + 1 \u0026lt;= qr) ans += query(rson,mid+1,r,ql,qr); ans %= mod; return ans; } } void build(int nown,int l,int r){ ; } } struct Q{ int ti,pos,id; Q(int t,int p,int i):ti(t),pos(p),id(i){;} bool operator\u0026lt;(Q a) const{ return ti \u0026lt; a.ti; } }; vector\u0026lt;Q\u0026gt; q; int ans[MAXN\u0026lt;\u0026lt;2],qa[MAXN][2]; void init(){ read(n),read(m); int a,b,c; for(int i = 2;i\u0026lt;=n;i++){ read(a); edge[i].push_back(a+1); edge[a+1].push_back(i); } int tot; for(int i = 1;i\u0026lt;=m;i++){ read(a),read(b),read(c); q.push_back(Q(a,c+1,++tot)); qa[i][0] = tot; q.push_back(Q(b+1,c+1,++tot)); qa[i][1] = tot; } } void w_add(int u,int v,int d = 1){ while(top[u]!=top[v]){ if(dep[top[u]] \u0026lt; dep[top[v]]) swap(u,v); SegTree::add(1,1,n,id[top[u]],id[u],d); u = fa[top[u]]; } if(dep[u] \u0026gt; dep[v]) swap(u,v); SegTree::add(1,1,n,id[u],id[v],d); } int w_query(int u,int v){ int ans = 0; while(top[u] != top[v]){ if(dep[top[u]] \u0026lt; dep[top[v]]) swap(u,v); ans += SegTree::query(1,1,n,id[top[u]],id[u]); u = fa[top[u]]; ans %= mod; } if(dep[u] \u0026gt; dep[v]) swap(u,v); ans += SegTree::query(1,1,n,id[u],id[v]); ans %= mod; return ans; } void solve(){ sort(q.begin(),q.end()); dfs1(1,0,1); dfs2(1,1); int nowt = 0; for(int i = 0;i \u0026lt; q.size();i++){ while(q[i].ti \u0026gt; nowt) w_add(1,++nowt); ans[q[i].id] = w_query(1,q[i].pos); } for(int i = 1;i\u0026lt;=m;i++) print((ans[qa[i][1]]-ans[qa[i][0]]+mod+mod+mod)%mod),print(\u0026#39;\\n\u0026#39;); } int main(){ init(); solve(); flush(); return 0; }   ","description":"","id":172,"section":"posts","tags":["æ•°æ®ç»“æ„","æ ‘é“¾å‰–åˆ†","å·®åˆ†"],"title":"ã€ŒLNOI2014ã€LCA-æ ‘é“¾å‰–åˆ†-å·®åˆ†","uri":"https://blog.chenqiqian.com/posts/lnoi2014-lca/"},{"content":"ç»´æŠ¤ä¸€ä¸ªåŠ¨æ€çš„å…³äº $x$çš„æ— ç©·å¤šé¡¹å¼ ï¼Œè¿™ä¸ªå¤šé¡¹å¼åˆå§‹æ—¶å¯¹äºæ‰€æœ‰ $i$ æœ‰ $a_i = 0$\n$$\nf(x)=a_0x^0+a_1x^1+a_2x^2\u0026hellip;\n$$\næ“ä½œè€…å¯ä»¥è¿›è¡Œå››ç§æ“ä½œï¼š\n  mul L R V è¡¨ç¤ºå°† $x^L$ åˆ° $x^R$ è¿™äº›é¡¹çš„ç³»æ•°ä¹˜ä¸ŠæŸä¸ªå®šå€¼ $v$ ï¼›\n  add L R V è¡¨ç¤ºå°† $x^L$ åˆ° $x^R$ è¿™äº›é¡¹çš„ç³»æ•°åŠ ä¸ŠæŸä¸ªå®šå€¼ $v$ ï¼›\n  mulx L R è¡¨ç¤ºå°† $x^L$ åˆ° $x^R$ è¿™äº›é¡¹ä¹˜ä¸Šxå˜é‡ï¼›\n  query V æ±‚ $f(v)$ çš„å€¼ã€‚\n  æ“ä½œé›†ä¸­åœ¨å‰ä¸‰ç§ï¼Œç¬¬å››ç§æ“ä½œä¸ä¼šå‡ºç°è¶…è¿‡ $10$ æ¬¡ã€‚\né“¾æ¥ Luogu P3278\né¢˜è§£ Splayå¤§æ¯’ç˜¤é¢˜ã€‚\nå‰ä¸¤ä¸ªæ“ä½œè®©æˆ‘ä»¬æƒ³åˆ°çº¿æ®µæ ‘çš„æ¨¡æ¿ï¼Œç¬¬ä¸‰ä¸ªæ“ä½œå¦‚æœä»åºåˆ—çš„è§’åº¦æ¥çœ‹å°±åƒæ˜¯æŠŠä¸€ä¸ªåºåˆ—å‘å³ç§»åŠ¨ï¼Œåœ¨æŠŠè¢«å†²æ‰çš„é‚£ä¸€ä¸ªä½ç½®åŠ åˆ°åŸæ¥çš„ä½æ•°ä¸Šå»ã€‚\næ˜¾ç„¶å•Šï¼åŒå¿—ä»¬ï¼Œè¿™æ˜¯é€åˆ†é¢˜å•Šï¼Splayå¥—å¥—å¥—\u0026hellip;\n  addæ“ä½œï¼šæå–åŒºé—´ï¼Œæ‰“æ ‡è®°ï¼Œç»´æŠ¤ä¿¡æ¯ã€‚\n  mulæ“ä½œï¼šæå–åŒºé—´ï¼Œæ‰“æ ‡è®°ï¼Œç»´æŠ¤ä¿¡æ¯ã€‚\n  mulxæ“ä½œï¼šå‘ƒ\u0026hellip;å…ˆæ‰¾åˆ°rankä¸ºl-1,l,r,r+1,r+2çš„èŠ‚ç‚¹ã€‚åˆ é™¤æ‰r+1å·èŠ‚ç‚¹ï¼ŒæŠŠå…¶å€¼åŠ åˆ°rä¸Šå»ï¼Œç„¶ååœ¨l-1å’Œlä¹‹é—´æ’å…¥ä¸€ä¸ªå€¼ä¸º0çš„èŠ‚ç‚¹ï¼Œç»´æŠ¤ä¿¡æ¯ã€‚\n  æ³¨æ„ï¼špush_downæ“ä½œå…ˆä¼ mulnï¼Œå†ä¼ addnã€‚\næ‰“æ ‡è®°å‡ ä¹åŒçº¿æ®µæ ‘æ¨¡æ¿ï¼Œå°±ä¸è¯´äº†ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;unistd.h\u0026gt;#include \u0026lt;cctype\u0026gt;#define ll long long using namespace std; const int MAXN = 210000; const ll p = 20130426LL; namespace fast_io { //... }using namespace fast_io; inline void mod(ll \u0026amp;x){x %= p;} struct Splay{ ll val[MAXN],addn[MAXN],muln[MAXN]; int f[MAXN],c[MAXN][2],siz[MAXN],tot,root; int newnode(int v = 0){ val[++tot] = v; siz[tot] = 1; addn[tot] = 0,muln[tot] = 1; return tot; } void add(int x,int num){ if(!x) return; addn[x] += num,val[x] += num; mod(val[x]),mod(addn[x]); } void mul(int x,int num){ if(!x) return; muln[x] *= num,addn[x] *= num,val[x] *= num; mod(addn[x]),mod(muln[x]),mod(val[x]); } void push_down(int x){ if(!x) return; if(muln[x]!=1){ mul(c[x][0],muln[x]); mul(c[x][1],muln[x]); muln[x] = 1; } if(addn[x] != 0){ add(c[x][0],addn[x]); add(c[x][1],addn[x]); addn[x] = 0; } } void push_up(int x){ if(!x) return; siz[x] = siz[c[x][0]] + siz[c[x][1]] + 1; } void rotate(int x){ int y = f[x],z = f[y],t = (c[y][1]==x),w = c[x][1-t]; push_down(y),push_down(x); f[x] = z;f[y] = x; if(w) f[w] = y; c[x][1-t] = y,c[y][t] = w; if(z) c[z][c[z][1]==y] = x; push_up(y),push_up(x); if(!f[x]) root = x; } void splay(int x,int target = 0){ while(f[x]!=target){ int y = f[x],z = f[y]; if(z!=target) (c[z][1]==y) ^ (c[y][1]==x)?rotate(x):rotate(y); rotate(x); } } int qrank(int r){ int x = root; while(2333){ if(r \u0026lt;= siz[c[x][0]]) x = c[x][0]; else if(r == siz[c[x][0]] + 1) break; else r -= siz[c[x][0]] + 1,x = c[x][1]; } return x; } int __build(int l,int r,int fa){ if(l \u0026gt; r) return 0; int mid = (l+r)\u0026gt;\u0026gt;1; int x = newnode(); f[x] = fa; c[x][0] = __build(l,mid-1,x); c[x][1] = __build(mid+1,r,x); push_up(x); return x; } void build(int num){ root = __build(1,num,0); } void __output(int x,ll *a){ if(!x) return; push_down(x); __output(c[x][0],a); a += siz[c[x][0]],*a = val[x]; __output(c[x][1],a+1); } void output(ll *a){ __output(root,a); } void add(int l,int r,int num){ int lb = qrank(l),rb = qrank(r+2); splay(lb),splay(rb,lb); add(c[rb][0],num); push_up(rb),push_up(lb); } void mul(int l,int r,int num){ int lb = qrank(l),rb = qrank(r+2); splay(lb),splay(rb,lb); mul(c[rb][0],num); push_up(rb),push_up(lb); } void mulx(int l,int r){ int x = qrank(l),y = qrank(l+1),z = qrank(r+1),a = qrank(r+2),b = qrank(r+3); splay(z),splay(b,z); c[b][0] = 0;push_up(b),push_up(z); val[z] += val[a]; splay(x),splay(y,x); c[y][0] = newnode(),f[c[y][0]] = y; push_up(y),push_up(x); } }T; int n,m = 110000; ll query(ll v){ static ll o[MAXN]; T.output(o); ll ans = 0; for(int i = m;i\u0026gt;=1;i--){ ans = ans * v + o[i]; mod(ans); } return ans; } void init(){ read(n); T.build(m+3); } void solve(){ char op[10];int l,r,v; for(int i = 1;i\u0026lt;=n;i++){ read(op); if(op[0] == \u0026#39;q\u0026#39;){ read(v); print(int(query(v))),print(\u0026#39;\\n\u0026#39;); } else{ read(l),read(r); if(op[3] == \u0026#39;x\u0026#39;) T.mulx(l+1,r+1); else{ read(v); if(op[0] == \u0026#39;m\u0026#39;) T.mul(l+1,r+1,v); else if(op[0] == \u0026#39;a\u0026#39;) T.add(l+1,r+1,v); } } } } int main(){ init(); solve(); flush(); return 0; }   ","description":"","id":173,"section":"posts","tags":["Splay","æ•°æ®ç»“æ„","å¹³è¡¡æ ‘"],"title":"ã€ŒSCOI2013ã€å¤šé¡¹å¼çš„è¿ç®—-Splay","uri":"https://blog.chenqiqian.com/posts/scoi2013-function/"},{"content":"ç»™å®šä¸€æ£µ $n$ ä¸ªèŠ‚ç‚¹çš„æ ‘ï¼Œå¯¹äºæ¯ä¸ªç‚¹éƒ½æœ‰ä¸¤ä¸ªæƒå€¼ $w_i,c_i$ ã€‚\nå­˜åœ¨ $m$ ä¸ªæ“ä½œï¼Œåˆ†ä¸º4ç±»ã€‚\n  â€œCC x câ€ï¼šå°† $c_x$ æ›´æ”¹ä¸º $c$ ï¼›\n  â€œCW x wâ€ï¼šå°† $w_x$ æ›´æ”¹ä¸º $w$ ï¼›\n  â€œQS x yâ€ï¼šå¯¹æ‰€æœ‰æ»¡è¶³åœ¨ $x$ åˆ° $y$ è·¯å¾„ä¸Šä¸” $c_i = c_x = c_y$ çš„èŠ‚ç‚¹ $i$ï¼Œæ±‚ $\\sum w_i$ ï¼›\n  â€œQM x yâ€ï¼šå¯¹æ‰€æœ‰æ»¡è¶³åœ¨ $x$ åˆ° $y$ è·¯å¾„ä¸Šä¸” $c_i = c_x = c_y$ çš„èŠ‚ç‚¹ $i$ ï¼Œæ±‚ $\\max(w_i)$ ï¼›\n  å¯¹äºåä¸¤ä¸ªæ“ä½œï¼Œä¿è¯ $c_x = c_y$ ã€‚\nå¯¹äºæ‰€æœ‰æ•°æ®ï¼Œ $n,m \\leq 10^5$ ï¼Œåœ¨ä»»æ„æ—¶åˆ»å‡æ»¡è¶³ $w_i \\leq 10^4,c_i \\leq 10^5,; w_i,c_i \\in \\mathbb{N}^+$ ã€‚\né“¾æ¥ Luogu P3313\né¢˜è§£ æ²¡ä»€ä¹ˆå¤ªå¤šå¥½è¯´çš„ã€‚å‡ ä¹æ˜¯è£¸é¢˜äº†ã€‚\nå¯¹äºæ¯ä¸€ç§ $c$ ï¼Œå»ºç«‹ä¸€é¢—åŠ¨æ€å¼€ç‚¹çš„çº¿æ®µæ ‘ï¼Œæ¯ä¸ªèŠ‚ç‚¹ç»´æŠ¤å½“å‰åŒºé—´çš„æœ€å¤§å€¼å’ŒåŒºé—´å’Œã€‚\nå¯¹äºæ ‘è¿›è¡Œæ ‘é“¾å‰–åˆ†ï¼ŒæŸ¥è¯¢çš„æ—¶å€™ç›´æ¥æŒ‰ç…§æ ‘é“¾å‰–åˆ†æŸ¥è¯¢å°±å¥½äº†ã€‚\næ—¶é—´å¤æ‚åº¦ $O(m \\log^{2}{n})$ ï¼Œç©ºé—´å¤æ‚åº¦ $O(m \\log n)$ ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;vector\u0026gt;#include \u0026lt;algorithm\u0026gt;#include \u0026lt;cctype\u0026gt;using namespace std; namespace fast_io { //... }using namespace fast_io; const int MAXN = 110000,logn = 30; int n,m,cnt; int son[MAXN],dep[MAXN],fa[MAXN],siz[MAXN],top[MAXN],id[MAXN]; vector\u0026lt;int\u0026gt; edge[MAXN]; void dfs1(int nown,int f,int depth){ siz[nown] = 1,fa[nown] = f; dep[nown] = depth,son[nown] = 0; for(int i = 0;i\u0026lt;edge[nown].size();i++){ int v = edge[nown][i]; if(v == f) continue; dfs1(v,nown,depth+1); siz[nown] += siz[v]; if(siz[v] \u0026gt; siz[son[nown]]) son[nown] = v; } } void dfs2(int nown,int topf){ top[nown] = topf;id[nown] = ++cnt; if(!son[nown]) return; dfs2(son[nown],topf); for(int i = 0;i \u0026lt; edge[nown].size();i++){ int v = edge[nown][i]; if(v == fa[nown] || v == son[nown]) continue; dfs2(v,v); } } namespace SegTree{ int sumn[MAXN*logn],maxn[MAXN*logn],ls[MAXN*logn],rs[MAXN*logn],cnt = 0; #define mid ((l+r)\u0026gt;\u0026gt;1)  void maintain(int nown){ maxn[nown] = max(maxn[ls[nown]],maxn[rs[nown]]); sumn[nown] = sumn[ls[nown]] + sumn[rs[nown]]; } int query_sum(int nown,int l,int r,int ql,int qr){ if(nown == 0 || (ql \u0026lt;= l \u0026amp;\u0026amp; r \u0026lt;= qr) ) return sumn[nown]; else{ int ans = 0; if(ql \u0026lt;= mid) ans += query_sum(ls[nown],l,mid,ql,qr); if(mid+1 \u0026lt;= qr) ans += query_sum(rs[nown],mid+1,r,ql,qr); return ans; } } int query_max(int nown,int l,int r,int ql,int qr){ if(nown == 0 || (ql \u0026lt;= l \u0026amp;\u0026amp; r \u0026lt;= qr)) return maxn[nown]; else{ int ans = 0; if(ql \u0026lt;= mid) ans = max(ans,query_max(ls[nown],l,mid,ql,qr)); if(mid+1 \u0026lt;= qr) ans = max(ans,query_max(rs[nown],mid+1,r,ql,qr)); return ans; } } void update(int \u0026amp;nown,int l,int r,int pos,int d){ if(!nown) nown = ++cnt,ls[nown] = 0,rs[nown] = 0; if(l == r) sumn[nown] = maxn[nown] = d; else{ if(pos \u0026lt;= mid) update(ls[nown],l,mid,pos,d); if(mid+1 \u0026lt;= pos) update(rs[nown],mid+1,r,pos,d); maintain(nown); } } } int rt[MAXN],r[MAXN],b[MAXN]; int query_max(int u,int v,int k){ int ans = 0; while(top[u]!=top[v]){ if(dep[top[u]] \u0026lt; dep[top[v]]) swap(u,v); ans = max(ans,SegTree::query_max(rt[k],1,n,id[top[u]],id[u])); u = fa[top[u]]; } if(dep[u] \u0026gt; dep[v]) swap(u,v); ans = max(ans,SegTree::query_max(rt[k],1,n,id[u],id[v])); return ans; } int query_sum(int u,int v,int k){ int ans = 0; while(top[u]!=top[v]){ if(dep[top[u]] \u0026lt; dep[top[v]]) swap(u,v); ans += SegTree::query_sum(rt[k],1,n,id[top[u]],id[u]); u = fa[top[u]]; } if(dep[u] \u0026gt; dep[v]) swap(u,v); ans += SegTree::query_sum(rt[k],1,n,id[u],id[v]); return ans; } void init(){ read(n),read(m); for(int i = 1;i\u0026lt;=n;i++) read(r[i]),read(b[i]); int a,b; for(int i = 1;i\u0026lt;=n-1;i++){ read(a),read(b); edge[a].push_back(b); edge[b].push_back(a); } } void build(){ dfs1(1,0,1),dfs2(1,1); for(int i = 1;i\u0026lt;=n;i++) SegTree::update(rt[b[i]],1,n,id[i],r[i]); } void solve(){ char op[10];int x,y; for(int i = 1;i\u0026lt;=m;i++){ read(op),read(x),read(y); if(op[0] == \u0026#39;C\u0026#39;){ if(op[1] == \u0026#39;W\u0026#39;){ SegTree::update(rt[b[x]],1,n,id[x],y); r[x] = y; } else if(op[1] == \u0026#39;C\u0026#39;){ SegTree::update(rt[b[x]],1,n,id[x],0); SegTree::update(rt[y],1,n,id[x],r[x]); b[x] = y; } } else if(op[0] == \u0026#39;Q\u0026#39;){ if(op[1] == \u0026#39;S\u0026#39;) print(query_sum(x,y,b[x])),print(\u0026#39;\\n\u0026#39;); else if(op[1] == \u0026#39;M\u0026#39;) print(query_max(x,y,b[x])),print(\u0026#39;\\n\u0026#39;); } } } int main(){ init(); build(); solve(); flush(); return 0; }   ","description":"","id":174,"section":"posts","tags":["æ•°æ®ç»“æ„","çº¿æ®µæ ‘","æ ‘é“¾å‰–åˆ†"],"title":"ã€ŒSDOI2014ã€æ—…è¡Œ-æ ‘é“¾å‰–åˆ†+åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘","uri":"https://blog.chenqiqian.com/posts/sdoi2014-journey/"},{"content":"å¯æŒä¹…åŒ–çº¿æ®µæ ‘ï¼Œæ˜¯ä¸€ç§å¯ä»¥è¿›è¡Œå¯æŒä¹…åŒ–æ“ä½œçš„çº¿æ®µæ ‘ï¼Œå…·æœ‰ä¼˜è¶Šçš„æ—¶é—´å¤æ‚åº¦ã€‚\nçº¿æ®µæ ‘ ç›¸ä¿¡çœ‹è¿™ç¯‡æ–‡ç« çš„äººå¾ˆç†Ÿæ‚‰ä»€ä¹ˆæ˜¯çº¿æ®µæ ‘äº†ï¼Œå°±ä¸åœ¨è¿™é‡Œèƒ¡æ‰¯äº†ã€‚\nå¦‚ä¸Šå°±æ˜¯çº¿æ®µæ ‘çš„åŸºæœ¬ç»“æ„ã€‚\nå¯æŒä¹…åŒ–ï¼Ÿ ç®€å•æ¥è¯´ï¼Œå¯æŒä¹…åŒ–å°±æ˜¯èƒ½å¤Ÿåœ¨ä¿®æ”¹çš„æ—¶å€™ï¼Œä¿ç•™ä¸‹åŸæ¥çš„æ•°æ®ç»“æ„çš„æ ·å­çš„ä¸€ç§æ•°æ®ç»“æ„ã€‚æ¯”å¦‚è¯´ï¼Œå¯¹äºä¸Šå›¾ï¼Œå¦‚æœçº¿æ®µæ ‘ç»´æŠ¤çš„æ˜¯åŒºé—´å’Œï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬è¦ä¿®æ”¹æŸä¸ªæ•°çš„å¤§å°ï¼Œå°±ä¼šä½¿ä¸€æ¡é“¾ä¸Šçš„ä¿¡æ¯å…¨éƒ¨æ”¹å˜ï¼Œå¹¶ä¸”æˆ‘ä»¬å¤±å»äº†è¿™æ¬¡ä¿®æ”¹ä¹‹å‰çš„çº¿æ®µæ ‘çš„ä¿¡æ¯ã€‚\né‚£ä¹ˆå¯¹äºçº¿æ®µæ ‘æ¥è¯´ï¼Œæ€ä¹ˆæ ·æ‰èƒ½åšåˆ°å¯æŒä¹…åŒ–å‘¢ï¼Ÿ\nå¯æŒä¹…åŒ–çš„æ€è·¯ å‡è®¾è¿™ä¸ªçº¿æ®µæ ‘ç»´æŠ¤çš„æ˜¯åŒºé—´å’Œã€‚\nä¸€ç§éå¸¸ç®€å•çš„æ€è·¯ï¼šä¸ºäº†ç»´æŠ¤ä¿®æ”¹ä¹‹å‰çš„ä¿¡æ¯ï¼Œæ¯æ¬¡ä¿®æ”¹æˆ‘é‡æ–°å»ºä¸€æ£µçº¿æ®µæ ‘ä¸å°±å¥½äº†ï¼Ÿï¼Ÿï¼Ÿä½†æ˜¯å¦‚æœä»”ç»†æƒ³ä¸€æƒ³ï¼Œå»ºä¸€æ£µçº¿æ®µæ ‘çš„æ—¶é—´å¤æ‚åº¦æ˜¯O(n)ï¼Œç©ºé—´å¤æ‚åº¦O(n)ï¼Œå¦‚æœæœ‰næ¬¡ä¿®æ”¹ï¼Œæœ€åçš„æ—¶é—´å¤æ‚åº¦O(n^2)ï¼Œç©ºé—´å¤æ‚åº¦ä¹Ÿæ˜¯O(n^2)ï¼ŒGGã€‚\nè§‚å¯Ÿä¸Šå›¾ï¼Œæ˜¾ç„¶å¯ä»¥å‘ç°å•ç‚¹ä¿®æ”¹ä¼šæ”¹å˜çš„åªä¼šæœ‰è¿™ä¸€æ¡é“¾ä¸Šçš„èŠ‚ç‚¹çš„å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±ä¼šè‡ªç„¶æƒ³åˆ°ï¼Œèƒ½ä¸èƒ½åªç»´æŠ¤è¿™ä¸€æ¡é“¾å‘¢ï¼Ÿ\nä½†æ˜¯å•ç‹¬ç»´æŠ¤ä¸€æ¡é“¾å¾ˆå‚»ï¼Œè€Œä¸”å¾ˆå¤šçº¿æ®µæ ‘ä¸Šçš„æ“ä½œè¿›è¡Œèµ·æ¥ä¹Ÿå¾ˆå¤æ‚ã€‚æ‰€ä»¥å¯ä»¥æŠŠè¿™æ¡é“¾åµŒåˆ°çº¿æ®µæ ‘ä¸Šï¼Œæ¯”å¦‚æˆ‘ä»¬ä¿®æ”¹ä½ç½®4ï¼Œé‚£ä¹ˆä¿®æ”¹å‡ºæ¥çš„é“¾å°±æ˜¯çº¢è‰²èŠ‚ç‚¹ï¼Œè€Œæˆ‘ä»¬ä¹Ÿéœ€è¦æŠŠå®ƒå…¶ä»–çš„åœ°æ–¹è¿åˆ°åŸæ¥çš„çº¿æ®µæ ‘ä¸Šã€‚\nè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±å‘ç°åªè¦æˆ‘ä»¬æŒæ¡ç€æ ¹ç»“ç‚¹ï¼Œæˆ‘ä»¬å°±å¯ä»¥å½“æ‰€æœ‰å…¶ä»–çº¿æ®µæ ‘éƒ½æ˜¯ä¸å­˜åœ¨çš„ä¸€æ ·ï¼Œåšæ™®é€šçº¿æ®µæ ‘çš„æŸ¥è¯¢æ“ä½œã€‚\nä¸»è¦çš„å¯æŒä¹…åŒ–æ“ä½œçš„æ€æƒ³å¤§æ¦‚å¦‚ä¸Šã€‚æ€»ç»“æ¥è¯´çš„è¯ï¼Œå°±æ˜¯åªæ›´æ”¹éœ€è¦æ›´æ”¹çš„éƒ¨åˆ†ï¼Œå…¶ä»–çš„ä¸ç®¡å®ƒï¼Œä¿æŒæ ‘å½¢ç»“æ„å®Œæ•´æ€§å°±å¯ä»¥äº†ã€‚å…¶ä»–çš„å¯æŒä¹…åŒ–æ•°æ®ç»“æ„å¦‚å¯æŒä¹…åŒ–Trieæ ‘å’Œå¹³è¡¡æ ‘ï¼Œæ€æƒ³éƒ½æ˜¯ç±»ä¼¼çš„ã€‚\nåˆ†æä¸€ä¸‹çš„è¯ï¼Œä¸Šä¾‹å­é‡Œæ€»å…±æœ‰mæ¬¡ä¿®æ”¹çš„è¯ï¼Œæ¯æ¬¡ä¿®æ”¹åˆ›å»ºå‡ºçš„æ–°èŠ‚ç‚¹éƒ½æ˜¯ä¸€æ¡å®Œæ•´çš„é•¿åº¦ä¸ºO(\\log n)çš„é“¾ï¼Œæ¯æ¬¡ä¿®æ”¹æˆ–è€…æŸ¥è¯¢ï¼Œæ—¶é—´å¤æ‚åº¦éƒ½æ˜¯O(\\log{n})ã€‚æœ€åç©ºé—´å¤æ‚åº¦æ˜¯O(n \\log{n})ï¼Œæ—¶é—´å¤æ‚åº¦ä¹Ÿæ˜¯O(n \\log{n})ã€‚\nå…·ä½“å®ç° å…·ä½“æ¥è¯´ï¼Œå¯æŒä¹…åŒ–æ•°æ®ç»“æ„ä¸€èˆ¬æ¨èç”¨æ•°ç»„æ¨¡æ‹ŸæŒ‡é’ˆæ¥å®ç°ã€‚é¦–å…ˆæ˜¯å› ä¸ºæ•°ç»„çš„ä»£ç å†™èµ·æ¥å¾ˆçŸ­å¾ˆå¿«ï¼Œå…¶æ¬¡è¿˜æœ‰å°±æ˜¯æŒ‡é’ˆçš„å¤§å°ç›®å‰ä¸€èˆ¬æ˜¯8å­—èŠ‚ï¼Œæ¯”ä¸€ä¸ªæ•´æ•°å¤§äº†ä¸€å€ï¼Œåœ¨ä¸€äº›é¢˜ç›®ä¸­å¯èƒ½è¢«å¡å†…å­˜ã€‚\nå¯¹äºå¯æŒä¹…åŒ–çº¿æ®µæ ‘æ¥è¯´ï¼Œå®ç°è·Ÿæ™®é€šçº¿æ®µæ ‘æœ‰å¾®å°çš„ä¸€ç‚¹ä¸åŒã€‚ï¼ˆåºŸè¯\né¦–å…ˆï¼Œåœ¨èŠ‚ç‚¹çš„æ•°ç›®ä¸Šï¼Œæˆ‘ä»¬éœ€è¦å¼€n\\log næ•°ç›®çš„èŠ‚ç‚¹ï¼Œè¿™ä¸ªå¾ˆå®¹æ˜“å¿˜è®°ã€‚æˆ‘ä»¬è¿˜éœ€è¦æ˜¾æ€§çš„è®°å½•æ¯ä¸ªèŠ‚ç‚¹çš„å·¦å„¿å­å’Œå³å„¿å­ï¼Œå’Œä¸€äº›å…¶ä»–ä½ è¦ç»´æŠ¤çš„ä¿¡æ¯ã€‚\nåœ¨ä¿®æ”¹æ“ä½œä¸Šï¼Œæœ‰ä¸€äº›ä¸åŒã€‚\nå…·ä½“æ¥è¯´å¦‚ä¸‹ï¼š\n å¤åˆ¶åŸæ¥èŠ‚ç‚¹ï¼Œæˆä¸ºä¸€ä¸ªæ–°çš„å½“å‰èŠ‚ç‚¹ å¾€éœ€è¦æ›´æ”¹çš„ä½ç½®ï¼ˆå·¦ï¼å³å„¿å­ï¼‰æ›´æ–°  è¿™é‡Œçš„ä¿®æ”¹ä¸­çš„åŸæ¥èŠ‚ç‚¹å°±æ˜¯åŸæ¥åŒä¸€ä¸ªä½ç½®çš„èŠ‚ç‚¹ï¼Œè€Œéœ€è¦æ–°å»ºä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ‰€ä»¥è¿™ä¸ªåœ°æ–¹å½“å‰èŠ‚ç‚¹éœ€è¦ä¼ ä¸€ä¸ªå¼•ç”¨ï¼Œå…·ä½“åˆ°åé¢å¯ä»¥çœ‹ä¸€çœ‹ä»£ç ï¼Œç†è§£çš„ä¼šæ›´å¥½ã€‚\næŸ¥è¯¢æ“ä½œå°±ä¸€æ¨¡ä¸€æ ·å•¦ã€‚\nåº”ç”¨ éå¸¸å¼ºå¤§ã€‚\nå¯æŒä¹…åŒ–æ•°ç»„ã€å¹¶æŸ¥é›† å¯æŒä¹…åŒ–æ•°ç»„å¯ä»¥è¯´æ˜¯æœ€ç®€å•çš„åº”ç”¨äº†ã€‚å°±æ˜¯ä¸€ä¸ªæ¨¡æ¿ï¼Œå¥—ä¸Šå°±å¥½ã€‚\nä¸»å¸­æ ‘ é™æ€ç¬¬kå¤§é—®é¢˜ åŠ¨æ€ç¬¬kå¤§é—®é¢˜ æ ‘ä¸Šç¬¬kå¤§ã€ç»´æŠ¤å€¼åŸŸ å…¶ä»–å¥‡æ€ªåº”ç”¨ ä¾‹é¢˜ TBDã€‚\n","description":"","id":175,"section":"posts","tags":["å¯æŒä¹…åŒ–çº¿æ®µæ ‘","ä¸»å¸­æ ‘","æ•°æ®ç»“æ„","æ¨¡æ¿"],"title":"å¯æŒä¹…åŒ–çº¿æ®µæ ‘å­¦ä¹ ç¬”è®°","uri":"https://blog.chenqiqian.com/posts/notes-prsegtree/"},{"content":"æŸä¸ªå›½å®¶æœ‰ $n$ ä¸ªåŸå¸‚ï¼Œè¿™ $n$ ä¸ªç‚¹ä¹‹é—´çš„è¾¹æ„æˆä¸€æ£µæ ‘ã€‚\nç°æ±‚ä¸€æ¡è¾¹é•¿åº¦å’Œä¸è¶…è¿‡ $S$ çš„è·¯å¾„ï¼ˆä¸¤ç«¯éƒ½æ˜¯åŸå¸‚ï¼Œå¯ä»¥åªä¸ºä¸€ä¸ªåŸå¸‚ï¼‰ï¼Œä½¿å¾—æ‰€æœ‰åŸå¸‚åˆ°è¿™æ¡è·¯å¾„çš„è·ç¦»çš„æœ€å¤§å€¼æœ€å°ï¼Œå¹¶è¾“å‡ºè¿™ä¸ªæœ€å°å€¼ã€‚\né“¾æ¥ Luogu P2491\né¢˜è§£ å¾ˆæœ‰è¶£çš„é¢˜ã€‚\nå¾ˆæ˜æ˜¾ï¼Œè¿™æ¡è·¯å¾„å¿…é¡»å…¨éƒ¨ä½äºç›´å¾„ä¸Šã€‚å…·ä½“è¯æ˜ä¸ä¼šï¼Œå¤§æ¦‚å¯ä»¥æ„Ÿæ€§ç†è§£ä¸€ä¸‹ã€‚\né‚£ä¹ˆæˆ‘ä»¬å°±è¦è€ƒè™‘ï¼Œåœ¨ç›´å¾„ä¸Šé€‰å‡ºä¸€æ®µé•¿åº¦ä¸å¤§äº $S$ çš„è·¯å¾„ï¼Œå¦‚ä½•ç»´æŠ¤è¿™é¢—æ ‘ä¸Šçš„æ‰€æœ‰ç‚¹åˆ°è¿™æ¡è·¯å¾„çš„é•¿åº¦çš„æœ€å¤§å€¼ã€‚\nè€ƒè™‘åˆ°åªæœ‰ä¸¤ç§æƒ…å†µï¼š\n åœ¨æ ‘çš„ç›´å¾„ä¸Šå‰å‡ºæ¥çš„ä¸€æ”¯ è·¯å¾„ä¸Šçš„ä¸¤ä¸ªç«¯ç‚¹åˆ°åŒä¾§ç›´å¾„ç«¯ç‚¹çš„è·ç¦»  ç¬¬ä¸€ä¸ªå…ˆ $O(n)$ é¢„å¤„ç†å‡ºæ¥ï¼Œç¬¬äºŒä¸ªè®°å½•ç›´å¾„çš„ä¸€ä¸ªç«¯ç‚¹åˆ°ç›´å¾„ä¸Šæ‰€æœ‰ç‚¹çš„è·ç¦»ï¼Œç„¶åå¯ä»¥ $O(1)$ çš„è®¡ç®—ã€‚\næˆ‘ä»¬æšä¸¾è·¯å¾„çš„å³ç«¯ç‚¹ $r$ ï¼Œç„¶åæŠŠå·¦ç«¯ç‚¹ $l$ æ¨åˆ°æœ€å·¦ä¾§å¯ä»¥æ»¡è¶³ $d \\leq S$ çš„ç‚¹ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯ $O(n)$ çš„ï¼Œæ³¨æ„åˆ° $l,r$ éƒ½æ˜¯å•è°ƒé€’å¢çš„ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªå•è°ƒé˜Ÿåˆ—ç»´æŠ¤ $[l,r]$ çš„æœ€å¤§å€¼ï¼Œç„¶åå†ä¸ç¬¬äºŒä¸ªæƒ…å†µå–ä¸€ä¸ª $max$ ã€‚ç„¶åæœ€å°å€¼å°±æ˜¯æˆ‘ä»¬çš„ $ans$ ã€‚\næ€»æ—¶é—´å¤æ‚åº¦ $O(n)$ ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;vector\u0026gt;#include \u0026lt;algorithm\u0026gt;#include \u0026lt;queue\u0026gt;#include \u0026lt;cctype\u0026gt;#define pp pair\u0026lt;int,int\u0026gt; using namespace std; namespace fast_io { //... }using namespace fast_io; const int MAXN = 310000; struct Edge{ int from,to; int len; }; int n,k; vector\u0026lt;Edge\u0026gt; edge[MAXN]; void init(){ read(n),read(k); int a,b,c; for(int i = 1;i\u0026lt;=n-1;i++){ read(a),read(b),read(c); edge[a].push_back((Edge){a,b,c}); edge[b].push_back((Edge){b,a,c}); } } int dis[MAXN],f[MAXN]; void dfs(int nown,int fa){ f[nown] = fa; for(int i = 0;i\u0026lt;edge[nown].size();i++){ int v = edge[nown][i].to,l = edge[nown][i].len; if(v == f[nown]) continue; dis[v] = dis[nown] + l; dfs(v,nown); } } int getmax(int nown){ int ans = dis[nown]; for(int i = 0;i\u0026lt;edge[nown].size();i++){ int v = edge[nown][i].to; if(v == f[nown]) continue; ans = max(ans,getmax(v)); } return ans; } int num[MAXN],d[MAXN],maxn[MAXN],tot = 0; void build(){ int u = 0,v = 0; dis[1] = 0; dfs(1,0); for(int i = 1;i\u0026lt;=n;i++) if(dis[u] \u0026lt; dis[i]) u = i; dis[u] = 0; dfs(u,0); for(int i = 1;i\u0026lt;=n;i++) if(dis[v] \u0026lt; dis[i]) v = i; for(int i = v;i;i = f[i]) num[++tot] = i; reverse(num+1,num+tot+1); for(int i = 1;i\u0026lt;=tot;i++) d[i] = dis[num[i]]; for(int i = 1;i\u0026lt;=tot;i++){ int nown = num[i]; for(int j = 0;j\u0026lt;edge[nown].size();j++){ int v = edge[nown][j].to; if(v == num[i+1] || v == num[i-1]) continue; maxn[i] = max(maxn[i],getmax(v)); } if(maxn[i]) maxn[i] -= d[i]; } } void solve(){ deque\u0026lt;pp\u0026gt; q; int l = 1,ans = 0x3f3f3f3f; for(int i = 1;i\u0026lt;=tot;i++){ while(!q.empty() \u0026amp;\u0026amp; q.back().second \u0026lt; maxn[i]) q.pop_back(); q.push_back(make_pair(i,maxn[i])); while(d[i] - d[l] \u0026gt; k) l++; while(!q.empty() \u0026amp;\u0026amp; q.front().first \u0026lt; l) q.pop_front(); ans = min(ans,max(max(d[l],d[tot] - d[i]),q.front().second)); } printf(\u0026#34;%d\\n\u0026#34;,ans); } int main(){ init(); build(); solve(); flush(); return 0; }   ","description":"","id":176,"section":"posts","tags":["å•è°ƒé˜Ÿåˆ—","æ ‘çš„ç›´å¾„","æ ‘å½¢ç»“æ„"],"title":"ã€ŒSDOI2011ã€æ¶ˆé˜²-æ ‘çš„ç›´å¾„+å•è°ƒé˜Ÿåˆ—","uri":"https://blog.chenqiqian.com/posts/sdoi2011-fireman/"},{"content":"å°Zæœ‰ä¸€ç‰‡æ£®æ—ï¼Œå«æœ‰ $N$ ä¸ªèŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¸Šéƒ½æœ‰ä¸€ä¸ªéè´Ÿæ•´æ•°ä½œä¸ºæƒå€¼ã€‚åˆå§‹çš„æ—¶å€™ï¼Œæ£®æ—ä¸­æœ‰ $M$ æ¡è¾¹ã€‚\nå°Zå¸Œæœ›æ‰§è¡Œ $T$ ä¸ªæ“ä½œï¼Œæ“ä½œæœ‰ä¸¤ç±»ï¼š\n  Q x y k æŸ¥è¯¢ç‚¹ $x$ åˆ°ç‚¹ $y$ è·¯å¾„ä¸Šæ‰€æœ‰çš„æƒå€¼ä¸­ï¼Œç¬¬ $k$ å°çš„æƒå€¼æ˜¯å¤šå°‘ã€‚æ­¤æ“ä½œä¿è¯ç‚¹ $x$ å’Œç‚¹ $y$ è¿é€šï¼ŒåŒæ—¶è¿™ä¸¤ä¸ªèŠ‚ç‚¹çš„è·¯å¾„ä¸Šè‡³å°‘æœ‰ $k$ ä¸ªç‚¹ã€‚\n  L x y åœ¨ç‚¹ $x$ å’Œç‚¹ $y$ ä¹‹é—´è¿æ¥ä¸€æ¡è¾¹ã€‚ä¿è¯å®Œæˆæ­¤æ“ä½œåï¼Œä»ç„¶æ˜¯ä¸€ç‰‡æ£®æ—ã€‚\n  å¼ºåˆ¶åœ¨çº¿ã€‚\nå¯¹äºæ‰€æœ‰çš„æ•°æ® $n,m,T \\leq 8 \\times 10^4$ ã€‚\né“¾æ¥ Luogu P3302\né¢˜è§£ æ¶å¿ƒçš„å¤§æ•°æ®ç»“æ„ã€‚\nå¯¹äºåˆå¹¶æ“ä½œï¼Œæˆ‘ä»¬ä¼šæƒ³åˆ° LCT ï¼Œè€Œå¯¹äºæŸ¥è¯¢è·¯å¾„ä¸Šçš„ç¬¬ $k$ å¤§ï¼Œåˆè®©æˆ‘ä»¬æƒ³åˆ°ä¸»å¸­æ ‘ã€‚\nåªèƒ½ç‰ºç‰²ä¸€ç§æ“ä½œã€‚æ³¨æ„åˆ°è¿™é‡Œæ²¡æœ‰ cut ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡å¯å‘å¼åˆå¹¶çš„æ–¹å¼ï¼Œå‡å°‘ä¸€ä¸ª $\\log$ ã€‚\nç”¨å¹¶æŸ¥é›†ç»´æŠ¤æ£®æ—çš„å¤§å°ï¼Œæ¯æ¬¡åˆå¹¶çš„æ—¶å€™å¼ºåŠ¿æš´åŠ›dfsä¿®æ”¹æ ‘ä¸Šè·¯å¾„ä¸»å¸­æ ‘ï¼Œä»¥åŠæ±‚ lcaçš„å€å¢æ•°ç»„å³å¯ã€‚\nç„¶åå°±æ˜¯å¸¸è§„æ“ä½œäº†ã€‚\néœ€è¦ç”¨ç¦»æ•£åŒ–ï¼Œè¿™é‡Œç”¨äº† mapã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;map\u0026gt;#include \u0026lt;cctype\u0026gt;#include \u0026lt;algorithm\u0026gt;using namespace std; namespace fast_io { //... }using namespace fast_io; const int MAXN = 81000,maxb = 20,logn = 500; namespace prSegTree{ int sumn[MAXN*logn],ls[MAXN*logn],rs[MAXN*logn],cnt = 1; #define mid ((l+r)\u0026gt;\u0026gt;1)  void insert(int \u0026amp;nown,int pre,int l,int r,int pos,int d){ nown = ++cnt;ls[nown] = ls[pre],rs[nown] = rs[pre]; sumn[nown] = sumn[pre] + d; if(l == r) return; else{ if(pos \u0026lt;= mid) insert(ls[nown],ls[pre],l,mid,pos,d); if(mid+1 \u0026lt;= pos) insert(rs[nown],rs[pre],mid+1,r,pos,d); } } int query(int x1,int x2,int y1,int y2,int l,int r,int k){ if(l == r) return l; else{ int sum = sumn[ls[x1]] + sumn[ls[x2]] - sumn[ls[y1]] - sumn[ls[y2]]; if(k \u0026lt;= sum) return query(ls[x1],ls[x2],ls[y1],ls[y2],l,mid,k); if(sum+1 \u0026lt;= k) return query(rs[x1],rs[x2],rs[y1],rs[y2],mid+1,r,k-sum); } } void build(int \u0026amp;nown,int l,int r){ nown = ++cnt; if(l == r) return; else{ build(ls[nown],l,mid); build(rs[nown],mid+1,r); } } } int fir[MAXN]; int to[MAXN*2],nex[MAXN*2],ecnt = 1; int n,m,q,num[MAXN],last[MAXN],tot = 0; int rt[MAXN]; int f[MAXN][maxb],dep[MAXN]; map\u0026lt;int,int\u0026gt; S; void addedge(int u,int v){ to[ecnt] = v,nex[ecnt] = fir[u],fir[u] = ecnt++; to[ecnt] = u,nex[ecnt] = fir[v],fir[v] = ecnt++; } namespace BCJ{ int f[MAXN],siz[MAXN]; int find(int x){ return f[x]==x?x:find(f[x]); } int query(int x){ return siz[find(x)]; } void un(int x,int y){ //y-\u0026gt;x  int xx = find(x),yy = find(y); f[yy] = xx;siz[xx] += siz[yy]; } void init(){ for(int i = 1;i\u0026lt;=n;i++) f[i] = i,siz[i] = 1; } } void pre_dfs(int nown,int fa,int depth){ prSegTree::insert(rt[nown],rt[fa],1,tot,S[num[nown]],1); dep[nown] = depth; f[nown][0] = fa; for(int j = 1;j\u0026lt;maxb;j++) f[nown][j] = f[ f[nown][j-1] ][j-1]; for(int i = fir[nown];i;i=nex[i]){ int v = to[i]; if(v == fa) continue; pre_dfs(v,nown,depth+1); } } int lca(int u,int v){ if(dep[u] \u0026lt; dep[v]) swap(u,v); for(int j = maxb-1;j\u0026gt;=0;j--) if(dep[f[u][j]] \u0026gt;= dep[v]) u = f[u][j]; if(u == v) return u; for(int j = maxb-1;j\u0026gt;=0;j--) if(f[u][j] != f[v][j]) u = f[u][j],v = f[v][j]; return f[u][0]; } void init(){ int T; read(T); read(n),read(m),read(q); BCJ::init(); for(int i = 1;i\u0026lt;=n;i++){ read(num[i]); S[num[i]] = 0; } for(map\u0026lt;int,int\u0026gt;::iterator it = S.begin();it!=S.end();it++){ it-\u0026gt;second = ++tot;last[tot] = it-\u0026gt;first; } int a,b; for(int i = 1;i\u0026lt;=m;i++){ read(a),read(b); addedge(a,b); BCJ::un(a,b); } } void build(){ for(int i = 1;i\u0026lt;=n;i++){ if(BCJ::find(i)==i) pre_dfs(i,0,1); } } void link(int u,int v){ addedge(u,v); if(BCJ::query(u) \u0026lt; BCJ::query(v)) swap(u,v); pre_dfs(v,u,dep[u]+1); BCJ::un(u,v); } int query(int u,int v,int k){ int l = lca(u,v),fl = f[l][0]; int ans = prSegTree::query(rt[u],rt[v],rt[l],rt[fl],1,tot,k); //printf(\u0026#34;query: u:%d v:%d l:%d fl:%d k:%d ANS:%d\\n\u0026#34;,u,v,l,fl,k,ans);  return last[ans]; } void solve(){ char op[10];int a,b,k,last = 0; for(int i = 1;i\u0026lt;=q;i++){ read(op);read(a),read(b); a^=last,b^=last; if(op[0] == \u0026#39;L\u0026#39;) link(a,b); else if(op[0] == \u0026#39;Q\u0026#39;) read(k),k^=last,print(last = query(a,b,k)),print(\u0026#39;\\n\u0026#39;); } } int main(){ init(); build(); solve(); flush(); return 0; }   ","description":"","id":177,"section":"posts","tags":["å¯æŒä¹…åŒ–çº¿æ®µæ ‘","æœ€è¿‘å…¬å…±ç¥–å…ˆ","å¯å‘å¼åˆå¹¶"],"title":"ã€ŒSDOI2013ã€æ£®æ—-ä¸»å¸­æ ‘+LCA+å¯å‘å¼åˆå¹¶","uri":"https://blog.chenqiqian.com/posts/sdoi2013-forest/"},{"content":"$n$ ä¸ªå¸ƒä¸æ‘†æˆä¸€è¡Œï¼Œæ¯ä¸ªå¸ƒä¸æœ€å¼€å§‹éƒ½æœ‰ä¸€ä¸ªé¢œè‰² $c_i$ ï¼Œè¿›è¡Œ $m$ æ¬¡æ“ä½œã€‚\næ“ä½œæ ¼å¼ï¼š\n  1 c d ï¼šå°†æ‰€æœ‰çš„ $c$ é¢œè‰²æ›¿æ¢ä¸º$d$\n  2 ï¼šæŸ¥è¯¢å½“å‰å¸ƒä¸åºåˆ—ä¸€å…±æœ‰å¤šå°‘æ®µé¢œè‰²ã€‚ä¾‹å¦‚é¢œè‰²åˆ†åˆ«ä¸º $1,2,2,1$ çš„å››ä¸ªå¸ƒä¸ä¸€å…±æœ‰3æ®µé¢œè‰²ã€‚\n  é“¾æ¥ Luogu P3201\né¢˜è§£ è¿™é¢˜éå¸¸æœ‰è¶£ã€‚å¼€å§‹æƒ³å€’æ˜¯åƒä»¥å‰åšè¿‡çš„ [SDOI2011]æŸ“è‰² ï¼Œä¸è¿‡ä»”ç»†æƒ³æƒ³è¿™ä¸ªä¸œè¥¿å¾ˆéš¾ç”¨çº¿æ®µæ ‘è¿›è¡Œç»´æŠ¤ã€‚\nç”±äºè¿™é“é¢˜æ”¾åœ¨å¹³è¡¡æ ‘çš„ä¸“é¢˜é‡Œï¼Œæˆ‘ä»¬æ€è€ƒä¸€ä¸‹è¿™ä¸ªä¸œè¥¿èƒ½ä¸èƒ½ç”¨å¹³è¡¡æ ‘ç»´æŠ¤ã€‚\né‡ç‚¹éœ€è¦è§£å†³çš„é—®é¢˜æ˜¯å¦‚ä½•åˆå¹¶ä¸¤ç§é¢œè‰²ï¼ˆå› ä¸ºé¢œè‰²æ®µè‚¯å®šæ˜¯å•è°ƒé€’å‡çš„ï¼‰ã€‚æˆ‘ä»¬å¯ä»¥æƒ³åˆ°ä½¿ç”¨å¹³è¡¡æ ‘çš„å¯å‘å¼åˆå¹¶ã€‚åˆå¹¶çš„æ—¶å€™æ›´æ–°ç­”æ¡ˆçš„æƒ…å†µåªæœ‰å½“å‰è¿™ä¸ªä½ç½®çš„ $pos-1$ æˆ–è€… $pos+1$ çš„ä½ç½®æœ‰ç›¸åŒé¢œè‰²çš„ä½ç½®çš„æ—¶å€™ï¼Œæˆ‘ä»¬éƒ½éœ€è¦å¯¹ç­”æ¡ˆå‡å» 1 ã€‚\nå¯å‘å¼åˆå¹¶å¯ä»¥è®©å¤æ‚åº¦é™ä½ä¸€ä¸ª $log$ ï¼Œæœ€åæ—¶é—´å¤æ‚åº¦å°±æ˜¯ $O(n \\log^2{n})$ ã€‚æœ€åæƒ…å†µå°±æ˜¯æ¯æ¬¡åˆå¹¶çš„åŒºé—´å¤§å°éƒ½ç›¸ç­‰çš„æƒ…å†µï¼Œåˆå¹¶èµ·æ¥çš„æ¬¡æ•° $O(n \\log {n})$ ã€‚\næœ‰ $O(n \\log{n})$ çš„å¥‡æ€ªåšæ³•ï¼Œå…·ä½“æˆ‘ä¹Ÿå°±ä¸ä¼šäº†ã€‚\nå…·ä½“å®ç°ä¸Šï¼Œå¯ä»¥ç»´æŠ¤ä¸€ä¸ªæ•°ç»„è®°å½•å½“å‰æŸä¸ªæ•°å¯¹åº”çš„ set ä½ç½®ï¼Œå°±å¯ä»¥å‡å»ä¸€äº›ä¸å¿…è¦æ¶ˆè€—ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;algorithm\u0026gt;#include \u0026lt;set\u0026gt;#include \u0026lt;cctype\u0026gt;using namespace std; const int MAXN = 1100000; namespace fast_io { //... }using namespace fast_io; int n,m,ans = 0; int num[MAXN],re[MAXN]; set\u0026lt;int\u0026gt; S[MAXN]; void update(int last,int now){ for(set\u0026lt;int\u0026gt;::iterator it = S[last].begin();it!=S[last].end();it++){ if(num[(*it)-1] == (now)) ans--; if(num[(*it)+1] == (now)) ans--; S[now].insert(*it); } for(set\u0026lt;int\u0026gt;::iterator it = S[last].begin();it!=S[last].end();it++) num[*it] = now; S[last].clear(); } void init(){ read(n),read(m); for(int i = 1;i\u0026lt;=n;i++){ read(num[i]); if(num[i]!=num[i-1]) ans++; S[num[i]].insert(i); re[num[i]] = num[i]; } } void solve(){ int op,a,b; for(int i = 1;i\u0026lt;=m;i++){ read(op); if(op == 1){ read(a),read(b); if(a == b) continue;//å¾ˆé‡è¦ï¼  if(S[re[a]].size() \u0026gt; S[re[b]].size()) swap(re[a],re[b]); update(re[a],re[b]); } else if(op == 2){ print(ans),print(\u0026#39;\\n\u0026#39;); } } } int main(){ init(); solve(); flush(); return 0; }   ","description":"","id":178,"section":"posts","tags":["å¯å‘å¼åˆå¹¶","set","å¹³è¡¡æ ‘"],"title":"ã€ŒHNOI2009ã€æ¢¦å¹»å¸ƒä¸-set-å¯å‘å¼åˆå¹¶","uri":"https://blog.chenqiqian.com/posts/hnoi2009-pudding/"},{"content":"æ¸¸æˆä¸€å¼€å§‹ï¼ŒLostmonkey åœ¨åœ°ä¸Šæ²¿ç€ä¸€æ¡ç›´çº¿æ‘†ä¸Š $n$ ä¸ªè£…ç½®ï¼Œæ¯ä¸ªè£…ç½®è®¾å®šåˆå§‹å¼¹åŠ›ç³»æ•° $K_i$ ï¼Œå½“ç»µç¾Šè¾¾åˆ°ç¬¬ $i$ ä¸ªè£…ç½®æ—¶ï¼Œå®ƒä¼šå¾€åå¼¹ $K_i$ æ­¥ï¼Œè¾¾åˆ°ç¬¬ $i+K_i$ ä¸ªè£…ç½®ï¼Œè‹¥ä¸å­˜åœ¨ç¬¬ $i+K_i$ ä¸ªè£…ç½®ï¼Œåˆ™ç»µç¾Šè¢«å¼¹é£ã€‚\nå­˜åœ¨ä¸¤ç§æ“ä½œï¼š\n  æŸ¥è¯¢åœ¨ç¬¬ $i$ ä¸ªè£…ç½®èµ·æ­¥æ—¶ï¼Œå†ç»å¤šå°‘æ¬¡ä¼šè¢«å¼¹é£ã€‚\n  ä¿®æ”¹ç¬¬ $i$ ä¸ªè£…ç½®çš„å¼¹åŠ›ç³»æ•°ä¸º $K'$ ã€‚\n  ä¿è¯ä»»ä½•æ—¶å€™ï¼Œä»»ä½•è£…ç½®å¼¹åŠ›ç³»æ•°å‡ä¸ºæ­£æ•´æ•°ã€‚\né“¾æ¥ Luogu P3203\nBZOJ 2002\né¢˜è§£ Link_Cut_Treeæ¯”è¾ƒå¥½æƒ³çš„ä¸€é“é¢˜ã€‚\næˆ‘ä»¬æ³¨æ„åˆ°ï¼Œè¿™ $n$ ä¸ªè£…ç½®çš„å¼¹åŠ›ç³»æ•°å¯ä»¥æŠ½è±¡æˆä¸€é¢—æ ‘ï¼Œå³è¿æ¥ç¬¬$i$å’Œç¬¬ $i+K_i$ ä¸ªèŠ‚ç‚¹çš„è¾¹ï¼Œå¹¶ä¸”å¼¹åŠ›ç³»æ•°çš„æ­£æ•´æ•°çš„æ€§è´¨ä½¿å…¶ä¸å­˜åœ¨ç¯ã€‚\nå¯¹äºå¼¹å‡ºå»çš„è£…ç½®ï¼Œæˆ‘ä»¬éƒ½ç”¨ä¸€ä¸ª $n+1$ å·ç‚¹æ¥ä»£æ›¿ã€‚æ¯æ¬¡åœ¨Link_Cut_Treeä¸ŠæŸ¥è¯¢ $i$ åˆ° $i+K_i$ çš„è·ç¦»ï¼Œå³ä¸ºç­”æ¡ˆã€‚ä¿®æ”¹çš„æ—¶å€™ï¼Œæˆ‘ä»¬å…ˆæ–­æ‰ä¸åŸæ¥çš„ $i+K_i$ çš„è¾¹ï¼Œå†è¿ä¸Šåˆ° $i+K'$ çš„è¾¹ï¼Œæ›´æ–°å¼¹åŠ›ç³»æ•°æ•°ç»„å³å¯ã€‚\næ³¨æ„è¿™é‡Œçš„è£…ç½®ç¼–å·æ˜¯ $0\\to n-1$ çš„ï¼Œæ‰€ä»¥å¯ä»¥ç»Ÿä¸€è¿›è¡Œ $+1$ å¤„ç†ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;algorithm\u0026gt;#include \u0026lt;cctype\u0026gt;using namespace std; const int MAXN = 510000; namespace fast_io { //... }using namespace fast_io; struct Link_Cat_Tree{ int sum[MAXN]; int f[MAXN],c[MAXN][2]; bool rev[MAXN]; void push_up(int x){ sum[x] = sum[c[x][0]] + sum[c[x][1]] + 1; } void reverse(int x){ if(!x) return; swap(c[x][0],c[x][1]); rev[x] ^= 1; } void push_down(int x){ if(!x) return; if(rev[x]){ reverse(c[x][0]); reverse(c[x][1]); rev[x] = 0; } } bool noroot(int x){ return (c[f[x]][0] == x) || (c[f[x]][1] == x); } void push_all(int x){ if(!x) return; if(noroot(x)) push_all(f[x]); push_down(x); } void rotate(int x){ int y = f[x],z = f[y],t = (c[y][1] == x),w = c[x][1-t]; if(noroot(y)) c[z][c[z][1]==y] = x; c[x][1-t] = y,c[y][t] = w; if(w) f[w] = y; f[y] = x;f[x] = z; push_up(y),push_up(x); } void splay(int x){ push_all(x); while(noroot(x)){ int y = f[x],z = f[y]; if(noroot(y)){ if((c[y][1]==x)^(c[z][1]==y)) rotate(x); else rotate(y); }rotate(x); } } void access(int x){ for(int y = 0;x;x = f[y=x]){ splay(x);c[x][1] = y; push_up(x); } } void makeroot(int x){ access(x),splay(x),reverse(x); } int find(int x){ access(x),splay(x); push_down(x); while(c[x][0]) x = c[x][0],push_down(x); return x; } void link(int x,int y){ makeroot(x); if(find(y)!=x) f[x] = y; } void cat(int x,int y){ makeroot(x);//find == splay  if(find(y) == x \u0026amp;\u0026amp; f[x] == y \u0026amp;\u0026amp; !c[x][1]) f[x] = c[y][0] = 0,push_up(y); } int query(int u,int v){ makeroot(v); //if(find(v)!=find(u)) return -1;  access(u);splay(u); return sum[u]; } void print(int n){ for(int i = 1;i\u0026lt;=n;i++){ printf(\u0026#34;%d: sum:%d f:%d c:%d %d r:%d\\n\u0026#34;,i,sum[i],f[i],c[i][0],c[i][1],int(rev[i])); } } }; int n,m,num[MAXN]; Link_Cat_Tree T; void init(){ read(n); for(int i = 1;i\u0026lt;=n;i++) read(num[i]); for(int i = 1;i\u0026lt;=n;i++) T.link(i,min(i+num[i],n+1)); } void solve(){ read(m); int op,a,b; for(int i = 1;i\u0026lt;=m;i++){ read(op);read(a);++a; if(op == 1) print(T.query(a,n+1)-1),print(\u0026#39;\\n\u0026#39;); else if(op == 2){ read(b); T.cat(a,min(a+num[a],n+1)); T.link(a,min(a+b,n+1)); num[a] = b; } } } int main(){ init(); solve(); flush(); return 0; }   ","description":"","id":179,"section":"posts","tags":["LCT","æ•°æ®ç»“æ„","æ ‘å½¢ç»“æ„"],"title":"ã€ŒHNOI2010ã€å¼¹é£ç»µç¾Š-åŠ¨æ€æ ‘","uri":"https://blog.chenqiqian.com/posts/hnoi2010-bounce/"},{"content":"æœ‰ä¸€ä¸ª $a \\times b$ çš„æ•´æ•°ç»„æˆçš„çŸ©é˜µï¼Œç°è¯·ä½ ä»ä¸­æ‰¾å‡ºä¸€ä¸ª $n\\times n$ çš„æ­£æ–¹å½¢åŒºåŸŸï¼Œä½¿å¾—è¯¥åŒºåŸŸæ‰€æœ‰æ•°ä¸­çš„æœ€å¤§å€¼å’Œæœ€å°å€¼çš„å·®æœ€å°ï¼Œè¾“å‡ºè¿™ä¸ªæœ€å°çš„å·®å€¼ã€‚\né“¾æ¥ Luogu P2216\né¢˜è§£ å•è°ƒé˜Ÿåˆ—çš„ä¸€é“æœ‰è¶£çš„é¢˜ã€‚\näº‹å®ä¸Šæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œéœ€è¦æ‰¾å‡ºçš„åŒºåŸŸæ˜¯æ­£æ–¹å½¢ï¼Œè€Œä¸”å¤§å°å›ºå®šï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æƒ³åˆ°ç”¨å•è°ƒé˜Ÿåˆ—æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚\nä½†è¿™ä¸ªé—®é¢˜æ˜¯äºŒç»´çš„ï¼Œæ€ä¹ˆæŠŠå•è°ƒé˜Ÿåˆ—è½¬åŒ–æˆäºŒç»´çš„å‘¢ï¼Ÿ\nå¯ä»¥è¿™ä¹ˆè€ƒè™‘ã€‚ç”¨ $a$ ä¸ªå•è°ƒé˜Ÿåˆ—ç»´æŠ¤ æ¯ä¸€è¡Œåœ¨ $[j-n+1,j]$ çš„ä½ç½®ä¸­çš„æœ€å¤§å€¼å’Œæœ€å°å€¼ã€‚\næ¯æ¬¡æˆ‘ä»¬è®¡ç®—æ­£æ–¹å½¢çš„æœ€å¤§å€¼æˆ–æœ€å°å€¼çš„æ—¶å€™ï¼Œå¯¹äºè¿™ $a$ ä¸ªå•è°ƒé˜Ÿåˆ—ä¸­çš„æœ€å¤§å€¼æˆ–è€…æœ€å°å€¼ï¼Œæˆ‘ä»¬æ–°å¼€ä¸€ä¸ªå•è°ƒé˜Ÿåˆ—ï¼Œå…¶ä¸­ç»´æŠ¤åœ¨ $a$ ä¸ªå•è°ƒé˜Ÿåˆ—ä¸­ $[i-n+1,i]$ è¿™ä¸ªèŒƒå›´é‡Œçš„æœ€å¤§å€¼æˆ–è€…æœ€å°å€¼ã€‚ç„¶åå°±å¯ä»¥ç”¨æœ€å¤§å€¼å‡å»æœ€å°å€¼ï¼Œå¹¶å°è¯•æ›´æ–°ç­”æ¡ˆã€‚\nå¯ä»¥è¯æ˜ï¼Œå¤æ‚åº¦æ˜¯ $O(n^2)$ çš„ã€‚\nå®åœ¨å·æ‡’ï¼Œå•è°ƒé˜Ÿåˆ—ç”¨äº† $deque$ ï¼Œä¸å¼€O2ææ…¢ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;queue\u0026gt;#include \u0026lt;cctype\u0026gt;#include \u0026lt;algorithm\u0026gt;#define pp pair\u0026lt;int,int\u0026gt; using namespace std; const int MAXN = 1100; namespace fast_io { //... }using namespace fast_io; int n,m,k; int num[MAXN][MAXN]; deque\u0026lt;pp\u0026gt; max1[MAXN],min1[MAXN]; deque\u0026lt;pp\u0026gt; max2,min2; void init(){ read(n),read(m),read(k); for(int i = 1;i\u0026lt;=n;i++) for(int j = 1;j\u0026lt;=m;j++) read(num[i][j]); } void solve(){ int ans = 0x3f3f3f3f; static int minn[MAXN],maxn[MAXN]; int tmin,tmax; for(int i = 1;i\u0026lt;=n;i++){ //printf(\u0026#34;i %d:\\n\u0026#34;,i);  for(int j = 1;j\u0026lt;=m;j++){ //max  while(!max1[j].empty()\u0026amp;\u0026amp;max1[j].begin()-\u0026gt;second \u0026lt; num[i][j]) max1[j].pop_front(); max1[j].emplace_front(i,num[i][j]); while(!max1[j].empty()\u0026amp;\u0026amp;max1[j].rbegin()-\u0026gt;first \u0026lt;= i-k) max1[j].pop_back(); tmax = max1[j].rbegin()-\u0026gt;second; maxn[j] = tmax; //min  while(!min1[j].empty()\u0026amp;\u0026amp;min1[j].begin()-\u0026gt;second \u0026gt; num[i][j]) min1[j].pop_front(); min1[j].emplace_front(i,num[i][j]); while(!min1[j].empty()\u0026amp;\u0026amp;min1[j].rbegin()-\u0026gt;first \u0026lt;= i-k) min1[j].pop_back(); tmin = min1[j].rbegin()-\u0026gt;second; minn[j] = tmin; } max2.clear(),min2.clear(); for(int j = 1;j\u0026lt;=m;j++){ //max  while(!max2.empty()\u0026amp;\u0026amp;max2.begin()-\u0026gt;second \u0026lt; maxn[j]) max2.pop_front(); max2.emplace_front(j,maxn[j]); while(!max2.empty()\u0026amp;\u0026amp;max2.rbegin()-\u0026gt;first \u0026lt;= j-k) max2.pop_back(); tmax = max2.rbegin()-\u0026gt;second; //min  while(!min2.empty()\u0026amp;\u0026amp;min2.begin()-\u0026gt;second \u0026gt; minn[j]) min2.pop_front(); min2.emplace_front(j,minn[j]); while(!min2.empty()\u0026amp;\u0026amp;min2.rbegin()-\u0026gt;first \u0026lt;= j-k) min2.pop_back(); tmin = min2.rbegin()-\u0026gt;second; if(i\u0026gt;=k \u0026amp;\u0026amp; j\u0026gt;=k)//ä¿è¯è§£åˆæ³•  ans = min(tmax-tmin,ans); } } printf(\u0026#34;%d\\n\u0026#34;,ans); } int main(){ init(); solve(); return 0; }   ","description":"","id":180,"section":"posts","tags":["å•è°ƒé˜Ÿåˆ—","æ•°æ®ç»“æ„"],"title":"ã€ŒHAOI2007ã€ç†æƒ³çš„æ­£æ–¹å½¢-å•è°ƒé˜Ÿåˆ—","uri":"https://blog.chenqiqian.com/posts/haoi2007-square/"},{"content":"è¶…çº§è®¡ç®—æœºä¸­çš„ä»»åŠ¡ç”¨ä¸‰å…ƒç»„ $(S_i,E_i,P_i)$ æè¿°ï¼Œ $(S_i,E_i,P_i)$ è¡¨ç¤ºä»»åŠ¡è¿è¡ŒåŒºé—´ä¸º $[S_i,E_i]$ ,å…¶ä¼˜å…ˆçº§ä¸º $P_i$ ã€‚\nç»™å‡º $n$ ä¸ªä»»åŠ¡ã€‚éšåç»™å‡º $m$ ä¸ªè¯¢é—®ï¼Œç¬¬ $X_i$ ç§’æ­£åœ¨è¿è¡Œçš„ä»»åŠ¡ä¸­ï¼Œä¼˜å…ˆçº§æœ€å°çš„ $K_i$ ä¸ªä»»åŠ¡çš„ä¼˜å…ˆçº§ä¹‹å’Œæ˜¯å¤šå°‘ã€‚ç‰¹åˆ«çš„ï¼Œå¦‚æœ $K_i$ å¤§äºç¬¬ $X_i$ ç§’æ­£åœ¨è¿è¡Œçš„ä»»åŠ¡æ€»æ•°ï¼Œåˆ™ç›´æ¥å›ç­”ç¬¬ $X_i$ ç§’æ­£åœ¨è¿è¡Œçš„ä»»åŠ¡ä¼˜å…ˆçº§ä¹‹å’Œã€‚\nå¼ºåˆ¶åœ¨çº¿ã€‚\né“¾æ¥ Luogu P3128\né¢˜è§£ æ³¨æ„åˆ°è¿™ä¸ªé—®é¢˜ä¸»è¦å°±æ˜¯åŒºé—´çš„æƒå€¼ä¿®æ”¹ï¼Œä»¥åŠå•ç‚¹çš„æ±‚å’Œï¼ˆæ±‚å€¼ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨å·®åˆ†çš„åŠæ³•ã€‚\n\u0008é¦–å…ˆå¯¹ä»»åŠ¡ç¦»çº¿ååˆ†æˆ $(S_i,P_i,1)$ ï¼Œ $(E_i+1,P_i,-1)$ ä¸¤ä¸ªä¿®æ”¹ï¼Œæ’åºå\u0008æ‰«ä¸€éè¿›è¡Œä¿®æ”¹ã€‚\næŸ¥è¯¢ç¬¬ $X_i$ ç§’çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°æˆ‘ä»¬\u0008æ¯ä¸ªæ—¶é—´æ‰€å¯¹åº”çš„çº¿æ®µæ ‘\u0008å…¶å®å°±æ˜¯\u0008å·®åˆ†çš„å‰ç¼€å’Œï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥åœ¨ç¬¬ $X_i$ ä¸ªçº¿æ®µæ ‘ä¸Šæ±‚å‰ $K_i$ ä¸ªæ•°çš„å’Œå°±å¥½äº†ã€‚æ³¨æ„åœ¨å¶å­ç»“ç‚¹éœ€è¦åˆ†ç±»è®¨è®ºï¼Œçœ‹\u0008å¶å­ç»“ç‚¹æœ‰æ²¡æœ‰å–å…¨ã€‚\næ•°æ®èŒƒå›´å¾ˆå¤§ï¼ˆï¼Ÿï¼‰ï¼Œéœ€è¦ç¦»æ•£åŒ–ï¼Œè¿™é‡Œç”¨äº†mapã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;algorithm\u0026gt;#include \u0026lt;map\u0026gt;#include \u0026lt;cctype\u0026gt;#include \u0026lt;vector\u0026gt;#define ll long long using namespace std; namespace fast_io { //... }using namespace fast_io; const int MAXN = 200000; map\u0026lt;int,int\u0026gt; S;int last[MAXN]; namespace prSegTree{ int val[MAXN*50],ls[MAXN*50],rs[MAXN*50]; ll sum[MAXN*50];int cnt = 0; #define mid ((l+r)\u0026gt;\u0026gt;1)  void maintain(int nown,int l,int r){ val[nown] = val[ls[nown]] + val[rs[nown]]; sum[nown] = sum[ls[nown]] + sum[rs[nown]]; } void insert(int \u0026amp;nown,int pre,int l,int r,int pos,int d){ nown = ++cnt;ls[nown] = ls[pre],rs[nown] = rs[pre]; val[nown]=val[pre]+d,sum[nown]=sum[pre]+1ll * d * last[pos]; if(l == r) return; else{ if(pos \u0026lt;= mid) insert(ls[nown],ls[pre],l,mid,pos,d); if(mid+1 \u0026lt;= pos) insert(rs[nown],rs[pre],mid+1,r,pos,d); } } ll query(int nown,int l,int r,int k){ if(l == r){ if(k\u0026gt;=val[nown]) return sum[nown]; else return k * last[l]; } else{ int sumn = val[ls[nown]]; if(k \u0026lt;= sumn) return query(ls[nown],l,mid,k); else if(sumn + 1 \u0026lt;= k) return sum[ls[nown]] + query(rs[nown],mid+1,r,k-sumn); } } } int n,m,totn,maxt,rt[MAXN]; vector\u0026lt;int\u0026gt; qq[MAXN]; void init(){ read(n),read(m); int a,b,c; maxt = n; for(int i = 1;i\u0026lt;=n;i++){ read(a),read(b),read(c); qq[a].push_back(c); qq[b+1].push_back(-c); maxt = max(maxt,b+1); S[c] = 0; } for(auto it = S.begin();it!=S.end();it++){ it-\u0026gt;second = ++totn; last[totn] = it-\u0026gt;first; } for(int i = 1;i\u0026lt;=maxt;i++){ rt[i] = rt[i-1]; for(int j = 0;j\u0026lt;qq[i].size();j++){ prSegTree::insert(rt[i],rt[i],1,totn,(S[abs(qq[i][j])]),qq[i][j] \u0026gt; 0? 1 : -1); } } } void solve(){ ll last = 1,ans; int x,k,a,b,c; for(int i = 1;i\u0026lt;=m;i++){ read(x),read(a),read(b),read(c); k = 1+(a*last+b)%c; ans = prSegTree::query(rt[x],1,totn,k); printf(\u0026#34;%lld\\n\u0026#34;,ans); last = ans; } } int main(){ init(); solve(); return 0; }   ","description":"","id":181,"section":"posts","tags":["å¯æŒä¹…åŒ–çº¿æ®µæ ‘","å·®åˆ†","æ•°æ®ç»“æ„"],"title":"ã€ŒCQOI2015ã€ä»»åŠ¡æŸ¥è¯¢ç³»ç»Ÿ-å¯æŒä¹…åŒ–çº¿æ®µæ ‘","uri":"https://blog.chenqiqian.com/posts/cqoi2015-mission/"},{"content":"è¾‰è¾‰çƒ­è¡·äºæ´ç©´å‹˜æµ‹ã€‚\nè¾‰è¾‰æœ‰ä¸€å°ç›‘æµ‹ä»ªå™¨å¯ä»¥å®æ—¶å°†é€šé“çš„æ¯ä¸€æ¬¡æ”¹å˜çŠ¶å†µï¼Œå¹¶åœ¨è¾‰è¾‰æ‰‹è¾¹çš„ç»ˆç«¯æœºä¸Šæ˜¾ç¤ºï¼š\nConnect u vä»£è¡¨ç›‘æµ‹åˆ°æ´ç©´uå’Œæ´ç©´vä¹‹é—´å‡ºç°äº†ä¸€æ¡é€šé“ï¼ŒDestroy u vä»£è¡¨ç›‘æµ‹åˆ°æ´ç©´uå’Œæ´ç©´vä¹‹é—´çš„é€šé“è¢«æ¯ã€‚Query u vï¼Œä»£è¡¨å‘ç›‘æµ‹ä»ªè¯¢é—®æ­¤æ—¶æ´ç©´uå’Œæ´ç©´væ˜¯å¦è¿é€šã€‚\nä¿è¯æ— è®ºé€šé“æ€ä¹ˆæ”¹å˜ï¼Œä»»æ„æ—¶åˆ»ä»»æ„ä¸¤ä¸ªæ´ç©´ä¹‹é—´è‡³å¤šåªæœ‰ä¸€æ¡è·¯å¾„ã€‚\nå·²çŸ¥åœ¨ç¬¬ä¸€æ¡æŒ‡ä»¤æ˜¾ç¤ºä¹‹å‰ï¼Œæ´ç©´ç¾¤ä¸­æ²¡æœ‰ä»»ä½•é€šé“å­˜åœ¨ã€‚\né“¾æ¥ Luogu P2147\nBZOJ2049\né¢˜è§£ åˆ©ç”¨åŠ¨æ€æ ‘ç»´æŠ¤æ£®æ—çš„è¿é€šæ€§ã€‚\næ¯æ¬¡å¯»æ‰¾åœ¨å¯¹åº”åŸæ ‘ä¸­çš„æ ¹ï¼Œä¸€æ ·å°±è”é€šï¼Œå¦åˆ™ä¸è¿é€šã€‚ä¸åŠ æ›´å¤šè§£é‡Šã€‚\næ³¨æ„åˆ¤æ–­ä¸€ä¸‹åŠ è¾¹å’Œåˆ‡è¾¹çš„åˆæ³•æ€§åˆ¤æ–­ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;algorithm\u0026gt;#include \u0026lt;cctype\u0026gt;using namespace std; namespace fast_io { //... }using namespace fast_io; const int MAXN = 20000; struct Link_Cat_Tree{ int f[MAXN],c[MAXN][2]; bool rev[MAXN]; inline bool noroot(int x){ return (c[f[x]][0] == x) || (c[f[x]][1] == x); } inline void reverse(int x){ if(!x) return; swap(c[x][0],c[x][1]); rev[x] ^= 1; } inline void push_down(int x){ if(!x) return; if(rev[x]){ reverse(c[x][0]),reverse(c[x][1]); rev[x] = 0; } } void push_all(int x){ if(!x) return; if(noroot(x)) push_all(f[x]); push_down(x); } inline void rotate(int x){ int y = f[x],z = f[y],t = (c[y][1] == x),w = c[x][1-t]; if(noroot(y)) c[z][c[z][1] == y] = x; c[y][t] = w,c[x][1-t] = y; if(w) f[w] = y; f[y] = x,f[x] = z; } inline void splay(int x){ push_all(x); while(noroot(x)){ int y = f[x],z = f[y]; if(noroot(y)){ if((c[z][1] == y) ^ (c[y][1] == x)) rotate(x); else rotate(y); }rotate(x); } } inline void access(int x){ for(int y = 0;x;x = f[y=x]) splay(x),c[x][1] = y; } inline void makeroot(int x){ access(x);splay(x);reverse(x); } inline int find(int x){ access(x),splay(x); push_down(x); while(c[x][0]) x = c[x][0],push_down(x); return x; } inline void link(int x,int y){ makeroot(x); if(find(y)!=x) f[x] = y; } inline void cat(int x,int y){ makeroot(x); if(find(y) == x \u0026amp;\u0026amp; f[x] == y \u0026amp;\u0026amp; !c[x][1]) f[x] = c[y][0] = 0; } inline int query(int x,int y){ return int(find(x) == find(y)); } }; Link_Cat_Tree S; int n,m; char yes[6] = \u0026#34;Yes\\n\u0026#34;,no[5] = \u0026#34;No\\n\u0026#34;; void solve(){ read(n),read(m); char op[20];int a,b; for(int i = 1;i\u0026lt;=m;i++){ read(op);read(a),read(b); if(op[0] == \u0026#39;C\u0026#39;) S.link(a,b); if(op[0] == \u0026#39;D\u0026#39;) S.cat(a,b); else if(op[0] == \u0026#39;Q\u0026#39;) print(S.query(a,b) ? yes:no); } } int main(){ solve(); flush(); return 0; }   ","description":"","id":182,"section":"posts","tags":["æ•°æ®ç»“æ„","LCT"],"title":"ã€ŒSDOI2008ã€æ´ç©´å‹˜æµ‹-LCT","uri":"https://blog.chenqiqian.com/posts/sdoi2008-cave/"},{"content":"ç»™å®šä¸€ä¸ªå«æœ‰ $n$ ä¸ªæ•°çš„åºåˆ— ${a_n}$ ï¼Œå›ç­”è¯¢é—®æˆ–æ‰§è¡Œæ“ä½œï¼š\n  Q i j k ï¼ˆ$1\\leq i\\leq j\\leq n, 1\\leq k\\leq j-i+1$ï¼‰è¡¨ç¤ºè¯¢é—®$a[i],a[i+1]\u0026hellip;\u0026hellip;a[j]$ä¸­ç¬¬ $k$ å°çš„æ•°ã€‚\n  C i t ($1 \\leq i \\leq n,0\\leq t \\leq 10^{9}$)è¡¨ç¤ºæŠŠ $a[i]$ æ”¹å˜æˆä¸º $t$ ã€‚\n  é“¾æ¥ Luogu P2617\nå…ˆåœ¨è¿™é‡Œç²—ç•¥çš„è®²ä¸€è®²ã€‚\nä¸æ™®é€šä¸»å¸­æ ‘ä¸åŒï¼Œä»¤ç¬¬ $i$ ä¸ªä½ç½®çš„çº¿æ®µæ ‘ç»´æŠ¤ $(i-lowbit(i),; i,]$ è¿™ä¸ªåŒºé—´çš„æƒå€¼çº¿æ®µæ ‘ï¼Œè€Œä¸æ˜¯ $[1,;i,]$ ã€‚\nè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°ï¼Œå¯¹äºæ¯ä¸€ä¸ªä¿®æ”¹ï¼Œåªä¼šå½±å“åˆ° $O(\\log{n})$ ä¸ªçº¿æ®µæ ‘ã€‚æˆ‘ä»¬ç›´æ¥æŒ‰æ ‘çŠ¶æ•°ç»„çš„è§„åˆ™å»ä¿®æ”¹ï¼Œç›´æ¥åœ¨åŸèŠ‚ç‚¹ä¸Šå»ºç«‹ä¸€é¢—æ–°æ ‘è¿›è¡Œæ›´æ”¹å³å¯ã€‚\nè€Œæ¯æ¬¡æŸ¥è¯¢ï¼Œä¹Ÿåªä¼šéœ€è¦åˆ° $O(\\log{n})$ ä¸ªçº¿æ®µæ ‘ï¼Œä¹Ÿå°±æ˜¯ä¸¤ä¸ªæ ‘çŠ¶æ•°ç»„å‰ç¼€å’Œç›¸å‡ï¼Œå°±å¯ä»¥å¾—åˆ°æŒ‡å®šåŒºé—´çš„æƒå€¼çº¿æ®µæ ‘ã€‚æˆ‘ä»¬å¯ä»¥æŒ‰ç…§æ ‘çŠ¶æ•°ç»„çš„æ–¹å¼å…ˆå°†æƒå€¼çº¿æ®µæ ‘ä¸­è¦åŠ ä¸Šçš„èŠ‚ç‚¹å’Œè¦å‡å»çš„èŠ‚ç‚¹å…¨éƒ¨å­˜åˆ°ä¸€ä¸ªæ•°ç»„é‡Œï¼Œç„¶åå°±å¯ä»¥æŒ‰ç…§ä¸å¸¦ä¿®æ”¹åŒºé—´ $k$ å¤§å·®ä¸å¤šçš„æ ·å­å»æŸ¥è¯¢äº†ã€‚\nè¿™é‡Œæ—¶ç©ºå¤æ‚åº¦åº”è¯¥éƒ½æ˜¯ $O(n \\log^{2}{n})$ ã€‚\néœ€è¦ç¦»æ•£åŒ–ã€‚è¿™é‡Œç”¨äº† map ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªåœ°æ–¹æ˜“é”™ã€‚ç¦»æ•£åŒ–å‡ºæ¥çš„æ•°å¯èƒ½æ¯” $n$ è¦å¤§ï¼Œæ‰€ä»¥éœ€è¦å¦è®°ä¸€ä¸ª totn åœ¨æ ‘çŠ¶æ•°ç»„æŸ¥è¯¢ä¿®æ”¹å’Œå„ç§åœ°æ–¹ä½œä¸ºå€¼åŸŸä½¿ç”¨ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;algorithm\u0026gt;#include \u0026lt;map\u0026gt;using namespace std; namespace fast_io { //... }using namespace fast_io; const int MAXN = 50000; int n,m,totn = 0; int rt[MAXN],num[MAXN]; int lowbit(int x){return x \u0026amp; (-x);} namespace prSegTree{ int val[MAXN*50],ls[MAXN*50],rs[MAXN*50]; int cnt = 0;int ll[MAXN],rr[MAXN],totx,toty; #define mid ((l+r) \u0026gt;\u0026gt; 1)  void insert(int \u0026amp;nown,int pre,int l,int r,int pos,int d){ nown = ++cnt;val[nown] = val[pre] + d; ls[nown] = ls[pre],rs[nown] = rs[pre]; if(l == r) return; else{ if(pos \u0026lt;= mid) insert(ls[nown],ls[pre],l,mid,pos,d); else if(pos \u0026gt;= mid+1) insert(rs[nown],rs[pre],mid+1,r,pos,d); } } void update(int pos,int v,int d){ for(int i = pos;i\u0026lt;=totn;i += lowbit(i)) insert(rt[i],rt[i],1,totn,v,d); } void add(int l,int r){ totx = toty = 0; for(int i = l-1;i;i-=lowbit(i)) ll[++totx] = rt[i]; for(int i = r;i;i-=lowbit(i)) rr[++toty] = rt[i]; } int find_kth(int l,int r,int k){ int sum = 0; if(l == r){ return l; } else{ for(int i = 1;i\u0026lt;=totx;i++) sum -= val[ls[ll[i]]]; for(int i = 1;i\u0026lt;=toty;i++) sum += val[ls[rr[i]]]; if(k \u0026lt;= sum){ for(int i = 1;i\u0026lt;=totx;i++) ll[i] = ls[ll[i]]; for(int i = 1;i\u0026lt;=toty;i++) rr[i] = ls[rr[i]]; return find_kth(l,mid,k); } else{ for(int i = 1;i\u0026lt;=totx;i++) ll[i] = rs[ll[i]]; for(int i = 1;i\u0026lt;=toty;i++) rr[i] = rs[rr[i]]; return find_kth(mid+1,r,k-sum); } } } int query(int l,int r,int k){ add(l,r); return find_kth(1,totn,k); } } map\u0026lt;int,int\u0026gt; S;int last[MAXN]; int op[MAXN],ql[MAXN],qr[MAXN],v[MAXN]; void init(){ read(n),read(m); for(int i = 1;i\u0026lt;=n;i++) read(num[i]),S[num[i]] = 0; char t[23]; for(int i = 1;i\u0026lt;=m;i++){ read(t);read(ql[i]),read(qr[i]); if(t[0] == \u0026#39;Q\u0026#39;) op[i] = 1,read(v[i]); else S[qr[i]] = 0; } for(auto it = S.begin();it != S.end();it++) it-\u0026gt;second = ++totn,last[totn] = it-\u0026gt;first; for(int i = 1;i\u0026lt;=n;i++) prSegTree::update(i,S[num[i]],1); } void solve(){ for(int i = 1;i\u0026lt;=m;i++){ if(op[i] == 0) prSegTree::update(ql[i],S[num[ql[i]]],-1), prSegTree::update(ql[i],S[qr[i]],1),num[ql[i]] = qr[i]; else print(last[prSegTree::query(ql[i],qr[i],v[i])]),print(\u0026#39;\\n\u0026#39;); } } int main(){ init(); solve(); flush(); return 0; }   ","description":"","id":183,"section":"posts","tags":["æ•°æ®ç»“æ„","å¯æŒä¹…åŒ–çº¿æ®µæ ‘"],"title":"ã€ŒLuogu2617ã€Dynamic Rankings-æ ‘çŠ¶æ•°ç»„-å¯æŒä¹…åŒ–çº¿æ®µæ ‘","uri":"https://blog.chenqiqian.com/posts/luogu-2617/"},{"content":"å®šä¹‰ä¸€æ£µæ ‘ä¸Šæœ€é•¿çš„è·¯å¾„ä¸ºæ ‘çš„ç›´å¾„ã€‚æ ‘çš„ç›´å¾„å¯èƒ½ä¸å”¯ä¸€ã€‚\nç»™å®šçš„ä¸€æ£µ $n$ ä¸ªç»“ç‚¹çš„æ ‘ï¼Œæ±‚å…¶ç›´å¾„çš„é•¿åº¦ï¼Œä»¥åŠæœ‰å¤šå°‘æ¡è¾¹æ»¡è¶³æ‰€æœ‰çš„ç›´å¾„éƒ½ç»è¿‡è¯¥è¾¹ã€‚\né“¾æ¥ Luogu P3304\nBZOJ 3124\né¢˜è§£ å¾ˆæœ‰è¶£çš„ä¸€é“é¢˜\né¦–å…ˆæ‰¾ç›´å¾„ã€‚å…ˆä»ä»»å–ç‚¹ $t$ å‡ºå‘ï¼Œåˆ°è¾¾æœ€è¿œçš„ä¸€ä¸ªç‚¹ $u$ ã€‚å†ä» $u$ å‡ºå‘ï¼Œåˆ°è¾¾æœ€è¿œçš„ç‚¹$v$ï¼Œ$u$ï¼Œ$v$ä¹‹é—´çš„è·¯å¾„å³ä¸ºæ ‘çš„ç›´å¾„ã€‚\nè¿™æ¯”è¾ƒæ˜¾ç„¶ã€‚\nä»¤ $\\delta (u,v)$ ä¸º $u,v$ ä¸¤ç‚¹é—´è·¯å¾„ï¼Œå…¶æ•°å€¼å³ä¸ºè·¯å¾„é•¿åº¦ã€‚\nå¼•ç†ï¼šåœ¨ä¸€æ£µæ ‘ä¸­ï¼Œ $x$ ã€ $y$ å’Œ $z$ æ˜¯ä¸‰ä¸ªä¸åŒçš„ç»“ç‚¹ã€‚å½“ $x$ åˆ° $y$ çš„æœ€çŸ­è·¯ä¸ $y$ åˆ° $z$ çš„æœ€çŸ­è·¯ä¸é‡åˆæ—¶ï¼Œ$x$ åˆ° $z$ çš„æœ€çŸ­è·¯å°±æ˜¯è¿™ä¸¤æ¡æœ€çŸ­è·¯çš„æ‹¼æ¥ã€‚\nå®šç†1ï¼šåœ¨ä¸€æ£µæ ‘ä¸­ï¼Œä»¥ä»»æ„ç»“ç‚¹å‡ºå‘æ‰€èƒ½åˆ°è¾¾çš„æœ€è¿œç»“ç‚¹ï¼Œä¸€å®šæ˜¯è¯¥æ ‘ç›´å¾„çš„ç«¯ç‚¹ä¹‹ä¸€ã€‚\nè¯æ˜ï¼šå‡è®¾è¿™æ¡ç›´å¾„æ˜¯ $\\delta (u,v)$ ã€‚åˆ†ä¸¤ç§æƒ…å†µï¼š\nå½“å‡ºå‘ç»“ç‚¹ $y$ åœ¨ $\\delta(u,v)$ ä¸Šæ—¶ï¼Œå‡è®¾åˆ°è¾¾çš„æœ€è¿œç»“ç‚¹ $z$ ä¸æ˜¯ $u,v$ ä¸­çš„ä»»ä¸€ä¸ªã€‚è¿™æ—¶å°† $\\delta(y,z)$ ä¸ä¸ä¸ä¹‹é‡åˆçš„ $\\delta(y,u)$ æ‹¼æ¥ï¼ˆä¹Ÿå¯ä»¥å‡è®¾ä¸ä¸ä¹‹é‡åˆçš„æ˜¯ç›´å¾„çš„å¦ä¸€ä¸ªæ–¹å‘ï¼‰ï¼Œå¯ä»¥å¾—åˆ°ä¸€æ¡æ›´é•¿çš„è·¯å¾„ï¼ŒçŸ›ç›¾ã€‚\nå½“å‡ºå‘ç»“ç‚¹ $y$ ä¸åœ¨ $\\delta(u,v)$ ä¸Šæ—¶ï¼Œåˆ†ä¸¤ç§æƒ…å†µï¼š\n  å½“ $y$ åˆ°è¾¾çš„æœ€è¿œç»“ç‚¹ $z$ æ¨ªç©¿ $\\delta(u,v)$ æ—¶ï¼Œè®°ä¸ä¹‹ç›¸äº¤çš„ç»“ç‚¹ä¸º $x$ã€‚æ­¤æ—¶æœ‰ $\\delta(y,z)=\\delta(y,x)+\\delta(x,z)$ ã€‚è€Œæ­¤æ—¶ $\\delta(y,z)\u0026gt;\\delta(y,v)$ ï¼Œæ•…å¯å¾— $\\delta(x,z)\u0026gt;\\delta(x,v)$ ã€‚ç”± $1$ çš„ç»“è®ºå¯çŸ¥è¯¥å‡è®¾ä¸æˆç«‹ã€‚\n  å½“ $y$ åˆ°è¾¾çš„æœ€è¿œç»“ç‚¹ $z$ ä¸$\\delta(u,v)$ä¸ç›¸äº¤æ—¶ï¼Œè®° $y$ åˆ° $v$ çš„æœ€çŸ­è·¯é¦–å…ˆä¸ $\\delta(u,v)$ ç›¸äº¤çš„ç»“ç‚¹æ˜¯ $x$ã€‚ç”±å‡è®¾ $\\delta(y,z)\u0026gt;\\delta(y,x)+\\delta(x,v)$ ã€‚è€Œ $\\delta(y,z)+\\delta(y,x)+\\delta(x,u)$ åˆå¯ä»¥å½¢æˆ $\\delta(z,u)$ ï¼Œè€Œ $\\delta(z,u)\u0026gt;\\delta(x,u)+\\delta(x,v)+2\\delta(y,x)=\\delta(u,v)+2\\delta(y,x)$ çŸ›ç›¾ã€‚\n  å…ˆæ±‚å‡ºäº†ç›´å¾„ï¼Œæˆ‘ä»¬å°±å‘ç°ä¸€ä»¶å¥½ç©çš„äº‹æƒ…ã€‚\nå®šç†2ï¼šå¯¹äºä¸€ä¸ªè¾¹æƒä¸ºæ­£æ•°çš„æ ‘ï¼Œå…¶æ‰€æœ‰çš„ç›´å¾„å¿…ç„¶ä¸¤ä¸¤æœ‰äº¤ç‚¹ã€‚\nè¯æ˜ï¼šè®¾æ ‘çš„ä¸€æ¡ç›´å¾„ä¸º $\\delta (u,v)$ ï¼Œä»»å–å¦ä¸€ç›´å¾„ä¸º $\\delta (u',v')$ ã€‚å…¶é•¿åº¦è®¾ä¸º $d$ ã€‚\nè‹¥ä¸¤ç›´å¾„æœ‰å…¬å…±éƒ¨åˆ†ï¼Œæ˜¾ç„¶æœ‰å…¬å…±ç‚¹ã€‚\nè‹¥æ²¡æœ‰å…¬å…±éƒ¨åˆ†ï¼Œåˆ™å¿…æœ‰ä¸€æ¡è·¯å¾„ $\\delta (x,y)$ è¿æ¥ä¸¤æ¡ç›´å¾„ï¼Œ $x$ åœ¨ $\\delta (u,v)$ ä¸Šï¼Œ $y$ åœ¨ $\\delta (u',v')$ ä¸Šã€‚\nåœ¨ $\\delta(u,x)$ å’Œ $\\delta(x,v)$ ä¸­ï¼Œä¸å¦¨è®¾ $\\delta(u,x) \\geq \\frac{1}{2} \\times d$ ã€‚åŒç†è®¾ $\\delta(u',y) \\geq \\frac{1}{2} \\times d$ ï¼Œåˆå› ä¸º $\\delta (x,y) \u0026gt; 0$ ï¼Œæ‰€ä»¥ $\\delta (u,u') = \\delta(u,x) + \\delta(x,y) + \\delta(y,u') \u0026gt; d = \\delta(u,v)$ ï¼ŒçŸ›ç›¾ã€‚\næˆ‘ä»¬è¦æ±‚çš„æ˜¯æœ‰å¤šå°‘ä¸ªè¾¹åœ¨åœ¨æ‰€æœ‰çš„ç›´å¾„ä¸Šã€‚æˆ‘ä»¬å·²ç»æ±‚å¾—äº†ä¸€æ¡ç›´å¾„ $\\delta(u,v)$ ã€‚\nä»¤ $x$ ä¸ºåœ¨ $\\delta(u,v)$ ä¸Šç¦» $u$ ç‚¹æœ€è¿œçš„ç‚¹ï¼Œæ»¡è¶³å­˜åœ¨ç‚¹ $u'$ ï¼Œä½¿å¾— $\\delta(x,u') = \\delta(x,u)$ ï¼Œä¸” $u \\neq u'$ ï¼Œåˆ™å¯å¾— $\\delta(u',v)$ ä¹Ÿæ˜¯ä¸€æ¡ç›´å¾„ã€‚\nåŒç† $y$ ä¸ºåœ¨ $\\delta(u,v)$ ä¸Šç¦» $v$ ç‚¹æœ€è¿œçš„ç‚¹ï¼Œæ»¡è¶³å­˜åœ¨ç‚¹ $v'$ ï¼Œä½¿å¾— $\\delta(x,v') = \\delta(x,v)$ ï¼Œä¸” $v \\neq v'$ ï¼Œåˆ™å¯å¾— $\\delta(u,v')$ ä¹Ÿæ˜¯ä¸€æ¡ç›´å¾„ã€‚\nè¿™ä¸¤ä¸ªä¸œè¥¿éƒ½å¯ä»¥åœ¨æ‰¾å‡ºç›´å¾„ä¹‹åä¸€è¾¹æ‰«ç›´å¾„ä¸€è¾¹ dfså‡ºæ¥ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œ $x$ åº”å½“åœ¨ $y$ å·¦ä¾§ï¼Œä¸” $x$ åœ¨ç›´å¾„å·¦åŠéƒ¨ï¼Œ $y$ åœ¨ç›´å¾„å³åŠéƒ¨ï¼Œæ’åˆ—é¡ºåºå¤§æ¦‚æ˜¯è¿™ä¸ªæ ·å­ $u\\leftrightarrow x \\leftrightarrow y \\leftrightarrow v$ ã€‚å¾ˆå®¹æ˜“çœ‹å‡ºï¼Œ $x$ ä¸ $y$ ä¹‹é—´çš„éƒ¨åˆ†ï¼Œå°±æ˜¯æ‰€æœ‰ç›´å¾„çš„å…¬å…±è¾¹ã€‚ç­”æ¡ˆå³ä¸º $\\delta(x,y)$ ã€‚\næ—¶é—´å¤æ‚åº¦å¤§çº¦æ˜¯ä¸€ä¸ªå¸¸æ•°æ¯”è¾ƒå¤§çš„ $O(n)$ ã€‚\nä»£ç  æ‡’å¾—å†™ bfs ï¼Œäºæ˜¯å°±æ¯”è¾ƒçš„æ…¢\u0026hellip;\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cstring\u0026gt;#include \u0026lt;vector\u0026gt;#include \u0026lt;cctype\u0026gt;#include \u0026lt;algorithm\u0026gt;#define ll long long using namespace std; namespace fast_io {//å¿«é€Ÿè¾“å…¥æ¨¡æ¿  inline char read(){ static const int IN_LEN=1000000;static char buf[IN_LEN],*s,*t; return s==t?(((t=(s=buf)+fread(buf,1,IN_LEN,stdin))==s)?-1:*s++) : *s++; } inline void read(int \u0026amp;x){ static bool iosig;static char c; for (iosig=false,c=read();!isdigit(c);c=read()){ if(c==\u0026#39;-\u0026#39;)iosig=true;if(c==-1)return; } for(x=0;isdigit(c);c=read()) x=((x+(x\u0026lt;\u0026lt;2))\u0026lt;\u0026lt;1)+(c^\u0026#39;0\u0026#39;); if(iosig)x=-x; } }using namespace fast_io; const int MAXN = 300000; struct Edge{ int from,to,len; }; int n,u=0,v=0,fa[MAXN]; ll dis[MAXN],ans1,ans2; vector\u0026lt;Edge\u0026gt; edge[MAXN]; void addedge(int a,int b,int c){ edge[a].push_back((Edge){a,b,c}); edge[b].push_back((Edge){b,a,c}); } void init(){ read(n); int a,b,c; for(int i = 1;i\u0026lt;=n-1;i++){ read(a),read(b),read(c); addedge(a,b,c); } } void dfs(int nown,int f){//å¯»æ‰¾ä»nownèŠ‚ç‚¹å‡ºå‘çš„æœ€é•¿è·¯  fa[nown] = f; for(int i = 0;i\u0026lt;edge[nown].size();i++){ Edge e = edge[nown][i]; if(e.to == f) continue; dis[e.to] = dis[nown] + e.len; dfs(e.to,nown); } } void find(){ memset(dis,0,sizeof(dis)); dfs(1,0); for(int i = 1;i\u0026lt;=n;i++)//ç¬¬ä¸€æ¬¡æœåˆ°çš„èŠ‚ç‚¹è®°ä½œç›´å¾„çš„ä¸€ä¸ªç«¯ç‚¹u  if(dis[i] \u0026gt; dis[u]) u = i; memset(dis,0,sizeof(dis)); dfs(u,0); for(int i = 1;i\u0026lt;=n;i++)//ç¬¬äºŒæ¬¡æœåˆ°çš„èŠ‚ç‚¹è®°ä½œç›´å¾„çš„å¦ä¸€ä¸ªç«¯ç‚¹v  if(dis[i] \u0026gt; dis[v]) v = i; } bool dfs2(int nown,ll len){//dfså¯»æ‰¾æ˜¯å¦ä»æŸä¸ªèŠ‚ç‚¹å­˜åœ¨é•¿åº¦ä¸ºlençš„è·¯å¾„  if(len == 0) return true; for(int i = 0;i \u0026lt; edge[nown].size();i++){ Edge e = edge[nown][i]; if(e.to == fa[nown]) continue; if(dfs2(e.to,len - e.len)) return true; } return false; } void solve(){ static int nex[MAXN]; int t = v,tmp = 0;//tmpä¸ºç›´å¾„é•¿åº¦  while(t!=u){//è®°å½•ä»uåˆ°vçš„è·¯å¾„  nex[fa[t]] = t; t = fa[t]; tmp++; } //lä»£è¡¨åˆ°å³èŠ‚ç‚¹æœ€è¿‘çš„æ»¡è¶³ä¸Šæ–‡æ€§è´¨çš„ç‚¹ï¼Œrä»£è¡¨åˆ°å·¦èŠ‚ç‚¹æœ€è¿‘çš„æ»¡è¶³ä¸Šæ–‡æ€§è´¨çš„ç‚¹  int l = 0,r = tmp,nowt = 0; //å¾ªç¯ä¸­dis[t] = d(u,t)  for(t = u;t!=v;t = nex[t]){ for(int i = 0;i\u0026lt;edge[t].size();i++){ Edge e = edge[t][i]; if(e.to == fa[t] || e.to == nex[t]) continue; if(dfs2(e.to,dis[t] - e.len)) l = max(nowt,l);//å¯»æ‰¾ç¦»uæœ€è¿œçš„t,æ»¡è¶³d(u\u0026#39;,t) = d(u,t),å¾—åˆ°å³ä¸ºx,åå­—å«åšl  else if(dfs2(e.to,(dis[v] - dis[t])- e.len)) r = min(r,nowt);//å¯»æ‰¾ç¦»væœ€è¿œçš„t,æ»¡è¶³d(t,v\u0026#39;) = d(t,v),å¾—åˆ°å³ä¸ºy,åå­—å«åšr  } nowt++; } ans1 = dis[v];//ç›´å¾„é•¿åº¦  ans2 = r - l;//åœ¨è¿™é‡Œäº‹å®ä¸Šæ˜¯æ±‚äº†rå’Œlçš„ä½ç½®å¹¶æ±‚å‡ºans2 } int main(){ init(); find(); solve(); printf(\u0026#34;%lld\\n%lld\\n\u0026#34;,ans1,ans2); return 0; }   ","description":"","id":184,"section":"posts","tags":["å›¾è®º","æ ‘å½¢ç»“æ„","æ ‘çš„ç›´å¾„"],"title":"ã€ŒSDOI2013ã€ç›´å¾„-æ ‘çš„ç›´å¾„","uri":"https://blog.chenqiqian.com/posts/sdoi2013-diameter/"},{"content":"ç»™ä¸€ä¸ªæ•°åˆ— ${a_n}$ ï¼Œæ¯æ¬¡è¯¢é—®åŒºé—´ $[l,r]$ å†…æœ‰æ²¡æœ‰ä¸€ä¸ªæ•°å‡ºç°æ¬¡æ•°è¶…è¿‡ä¸€åŠã€‚å¦‚æœæœ‰ï¼Œè¾“å‡ºè¿™ä¸ªæ•°ï¼Œå¦‚æœæ²¡æœ‰ï¼Œè¾“å‡º $0$ ã€‚\né“¾æ¥ Luogu P3567\né¢˜è§£ ä¸»å¸­æ ‘çš„æ¨¡ç‰ˆ\u0026hellip;ç„¶è€Œè’Ÿè’»å¦‚æˆ‘å±…ç„¶å¹¶çœ‹ä¸å‡ºæ¥æ€ä¹ˆåš\u0026hellip;ä¸è¿‡ç°åœ¨å¯¹æƒå€¼çº¿æ®µæ ‘ä¹Ÿæ›´äº†è§£äº†å‘¢ã€‚\næ™®é€šçš„å»ºç«‹ä¸€é¢—ä¸»å¸­æ ‘ã€‚æ¯ä¸ªèŠ‚ç‚¹ç»´æŠ¤è¯¥åŒºé—´å†…æƒå€¼æ€»å’Œã€‚\nåœ¨æŸ¥è¯¢çš„æ—¶å€™ï¼Œè¿˜æ˜¯ä¸¤ä¸ªå‰ç¼€ç›¸å‡ï¼Œå¾€å¤§äº $\\lceil \\frac{r-l+1}{2} \\rceil$ ï¼ˆåŸå§‹çš„ $[l,r]$ ï¼‰çš„æ–¹å‘å»èµ°ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå°±è¿”å›0ï¼Œè¾¹ç•Œå°±æ˜¯ $l == r$ çš„æ—¶å€™è¿”å›ã€‚\nå…¶å®å°±æ˜¯æ€»ç»Ÿé€‰ä¸¾é‚£é“é¢˜çš„å¼±åŒ–ç‰ˆã€‚\nå¾ˆç®€å•ã€‚ç„¶è€Œæˆ‘æ›´èœã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cctype\u0026gt;#define mid ((l+r)\u0026gt;\u0026gt;1) #define pp pair\u0026lt;int,int\u0026gt; using namespace std; namespace fast_io { //... }using namespace fast_io; const int MAXN = 600000; namespace prSegTree{ int val[MAXN*20];int ls[MAXN*20],rs[MAXN*20]; int cnt = 1; void build(int \u0026amp;nown,int l,int r){ nown = cnt++; if(l == r) val[nown] = 0; else{ build(ls[nown],l,mid); build(rs[nown],mid+1,r); } } void update(int \u0026amp;nown,int pre,int l,int r,int pos,int d){ nown = cnt++;val[nown] = val[pre]+d; ls[nown] = ls[pre];rs[nown] = rs[pre]; if(l == r) return; else{ if(pos \u0026lt;= mid) update(ls[nown],ls[pre],l,mid,pos,d); if(mid+1 \u0026lt;= pos) update(rs[nown],rs[pre],mid+1,r,pos,d); } } int query(int nowl,int nowr,int l,int r,int limit){ if(l == r) return l; else{ if(val[ls[nowr]] - val[ls[nowl]]\u0026gt;=limit) return query(ls[nowl],ls[nowr],l,mid,limit); if(val[rs[nowr]] - val[rs[nowl]]\u0026gt;=limit) return query(rs[nowl],rs[nowr],mid+1,r,limit); return 0; } } } int n,m; int root[MAXN]; void init(){ read(n),read(m); prSegTree::build(root[0],1,n); int tmp; for(int i = 1;i\u0026lt;=n;i++){ read(tmp); root[i] = root[i-1]; prSegTree::update(root[i],root[i-1],1,n,tmp,1); } } void solve(){ int l,r; for(int i = 1;i\u0026lt;=m;i++){ read(l),read(r); print(prSegTree::query(root[l-1],root[r],1,n,(r-l+1)/2+1)),print(\u0026#39;\\n\u0026#39;); } } int main(){ init(); solve(); flush(); return 0; }   ","description":"","id":185,"section":"posts","tags":["æ•°æ®ç»“æ„","ä¸»å¸­æ ‘","çº¿æ®µæ ‘","å¯æŒä¹…åŒ–çº¿æ®µæ ‘"],"title":"ã€ŒPOI2014ã€KUR-Couriers-ä¸»å¸­æ ‘","uri":"https://blog.chenqiqian.com/posts/poi2014-kur/"},{"content":"ç¾é£ŸèŠ‚å…±æœ‰ $n$ ç§ä¸åŒçš„èœå“ï¼Œæ¯ä¸ªåŒå­¦éƒ½ç‚¹äº†ä¸€ä»½åœ¨è¿™ $n$ ä¸ªèœå“ä¸­çš„èœã€‚æ€»å…±æœ‰ $m$ ä¸ªå¨å¸ˆæ¥åˆ¶ä½œè¿™äº›èœå“ã€‚å¨å¸ˆä»¬ä¼šæŒ‰ç…§è¦æ±‚çš„é¡ºåºè¿›è¡Œåˆ¶ä½œï¼Œå¹¶ä¸”æ¯æ¬¡åªèƒ½åˆ¶ä½œä¸€äººä»½ã€‚ç¬¬ $j$ ä¸ªå¨å¸ˆåˆ¶ä½œç¬¬ $i$ ç§èœå“çš„æ—¶é—´è®°ä¸º $t_{i,j}$ ã€‚æ¯ä¸ªåŒå­¦çš„ç­‰å¾…æ—¶é—´ä¸ºæ‰€æœ‰å¨å¸ˆå¼€å§‹åšèœèµ·ï¼Œåˆ°è‡ªå·±é‚£ä»½èœå“å®Œæˆä¸ºæ­¢çš„æ—¶é—´æ€»é•¿åº¦ã€‚æ€»ç­‰å¾…æ—¶é—´ä¸ºæ‰€æœ‰åŒå­¦çš„ç­‰å¾…æ—¶é—´ä¹‹å’Œã€‚\nå·²çŸ¥å…±æœ‰ $n$ ç§èœå“ï¼Œç¬¬ $i$ ç§èœå“éœ€è¦åš $p_i$ ä»½ï¼Œå…±æœ‰ $m$ ä¸ªå¨å¸ˆã€‚è¯·è®¡ç®—å‡ºæœ€å°çš„æ€»ç­‰å¾…æ—¶é—´æ˜¯å¤šå°‘ã€‚\né“¾æ¥ Luogu P2050\né¢˜è§£ \u0008å¾ˆæœ‰è¶£çš„é¢˜ã€‚\u0008\nçœ‹èµ·æ¥è·Ÿã€ŒSCOI2007ã€ä¿®è½¦ å¾ˆåƒï¼Œç„¶è€Œè¿™é“é¢˜çš„æ•°æ®å¤§å¤§åŠ å¼ºäº†ã€‚\nè¿™é“é¢˜ä¸»è¦çš„æ–¹æ³•å¦‚ä¸‹ï¼š\nå¯¹äºæ¯ä¸€ä¸ªå¨å¸ˆï¼Œæ„å»º $\\sum p$ ä¸ªç‚¹ï¼Œåˆ†åˆ«ä»£è¡¨å…¶å€’æ•°ç¬¬ä¸€ä¸ªï¼Œ\u0026hellip;\u0008ï¼Œå€’æ•°ç¬¬ $p$ \u0008ä¸ªåˆ¶ä½œçš„\u0008èœå“ã€‚å¯¹äºç¬¬ $i$ ä¸ªèœå“ï¼Œç”±èœå“èŠ‚ç‚¹å‘ç¬¬ $j$ ä¸ªå¨å¸ˆå€’æ•°ç¬¬ $k$ ä¸ªåšçš„èœï¼Œè¿ä¸€æ¡\u0008å®¹é‡ä¸º $1$ ï¼Œ\u0008è´¹ç”¨ä¸º $t_{i,j} \\times k$ çš„è¾¹ã€‚å¯ä»¥å‘ç°ï¼Œè¿™æ¡è¾¹å°±ä»£è¡¨äº†\u0008æ‰€æœ‰åœ¨å€’æ•°ç¬¬ $k$ ä¸ªåé¢ä»¥åŠå€’æ•°ç¬¬ $k$ \u0008ä¸ª\u0008åˆ¶ä½œèœå“ä¸­ç”±å€’æ•°ç¬¬kä¸ªèœå“çš„åˆ¶ä½œè€Œäº§ç”Ÿçš„ç­‰å¾…æ—¶é—´ã€‚\u0008\nå…¶ä»–è¿˜æœ‰ä»å„ä¸ª\u0008èŠ‚ç‚¹è¿å‘æ±‡ç‚¹ï¼Œä»¥åŠæºç‚¹\u0008è¿å‘å„èœå“èŠ‚ç‚¹ï¼Œ\u0008\u0008å®¹é‡ä¸º $p_i$ çš„è¾¹ã€‚\nä½†æ˜¯ï¼Œè¿™ä¸ªè¿‡ä¸äº†ã€‚ç»è¿‡è®¡ç®—ï¼Œæˆ‘ä»¬å‘ç°æœ€å¤šçš„æ—¶å€™ä¼šæœ‰è¿‘ $6000000$ æ¡è¾¹ï¼Œ\u0008æ˜¾ç„¶å¾ˆæƒ¨ã€‚å¹²å†™è¿™ä¸ªç®—æ³•å¤§æ¦‚æ˜¯50-60åˆ†çš„æ ·å­å§ã€‚\næ‰€ä»¥æˆ‘ä»¬éœ€è¦ä½œå‡ºä¸€äº›\u0008æ”¹è¿›ï¼Œæ¥è®©è¿™ä¸ªç®—æ³•å˜æˆ O(èƒ½è¿‡) ã€‚è€ƒè™‘åˆ°æœ€ä¸»è¦çš„é—®é¢˜æ˜¯è¾¹æ•°å¤ªå¤šï¼Œ\u0008æ‰€ä»¥æˆ‘ä»¬åº”è¯¥æƒ³åŠæ³•å‡å°‘è¾¹çš„æ•°ç›®ã€‚\n\u0008è¿™ä¸ªæ—¶å€™å°±å¯ä»¥ç„å­¦æ“ä½œäº†ã€‚\nè€ƒè™‘åˆ°ä»¥ä¸‹çš„ä¸€ä»¶äº‹ï¼šå¦‚æœä¸€ä¸ªå¨å¸ˆå€’æ•°ç¬¬ $k$ ä¸ªéœ€è¦åšçš„èœè¿˜æ²¡æœ‰åšï¼Œé‚£ä¹ˆä¸å¯èƒ½å…ˆåšå€’æ•°ç¬¬ $k+1$ ä¸ªèœï¼Œå› ä¸ºæ— è®ºåšä»€ä¹ˆèœï¼Œå€’æ•°ç¬¬ $k$ ä¸ªåšçš„èœä»·æ ¼æ€»æ˜¯æ›´ä½ã€‚\næ‰€ä»¥æˆ‘ä»¬å…ˆæŠŠæ¯ä¸ªå¨å¸ˆæœ€åä¸€ä¸ªåˆ¶ä½œçš„èœå“åŠ å…¥å›¾ä¸­ï¼Œç„¶åè¿›è¡Œä¸€æ¬¡ spfa çš„å¢å¹¿ã€‚ç„¶åæ¯æ¬¡å¢å¹¿å‡ºæ¥çš„èœå’Œå¨å¸ˆï¼Œæˆ‘ä»¬å°±åŠ ä¸€æ¡åŒä¸€ä¸ªå¨å¸ˆåé¢ä¸€ä¸ªéœ€è¦åšçš„èœï¼Œè¿™æ ·æ—¢èƒ½ä¿è¯å¤æ‚åº¦æ¯”è¾ƒä½ï¼Œä¹Ÿå¯ä»¥æ­£ç¡®å¢å¹¿ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;algorithm\u0026gt;#include \u0026lt;cstring\u0026gt;#include \u0026lt;queue\u0026gt;#include \u0026lt;cctype\u0026gt;using namespace std; namespace fast_io { //... }using namespace fast_io; const int MAXN = 100000,MAXM = 2000000; struct Edge{ int from,to; int cap,flow; int cost,nex; }edge[MAXM]; int n,m,s,t,sum = 0; int ff = 0,cc = 0,p[MAXN],ti[1000][1000]; int fir[MAXN],ecnt = 2; void addedge(int a,int b,int c,int d){ edge[ecnt] = (Edge){a,b,c,0,d,fir[a]}; fir[a] = ecnt++; edge[ecnt] = (Edge){b,a,0,0,-d,fir[b]}; fir[b] = ecnt++; } int dis[MAXN],instack[MAXN],pree[MAXN]; queue\u0026lt;int\u0026gt; q; bool spfa(){ while(!q.empty()) q.pop(); memset(dis,0x3f,sizeof(dis)); memset(instack,0,sizeof(instack)); q.push(s);dis[s] = 0; while(!q.empty()){ int nown = q.front();q.pop(); instack[nown] = 0; for(int nowe = fir[nown];nowe;nowe = edge[nowe].nex){ Edge e = edge[nowe]; if(dis[e.to] \u0026gt; dis[nown] + e.cost \u0026amp;\u0026amp; e.cap \u0026gt; e.flow){ dis[e.to] = dis[nown] + e.cost; pree[e.to] = nowe; if(instack[e.to] == 0){ q.push(e.to); instack[e.to] = 1; } } } } return dis[t] \u0026lt; 0x3f3f3f3f; } void argument(){ int nown = t,nowe = 0,limit = 0x3f3f3f3f; while(nown != s){ nowe = pree[nown]; limit = min(limit,edge[nowe].cap - edge[nowe].flow); nown = edge[nowe].from; } nown = t; while(nown != s){ nowe = pree[nown]; edge[nowe].flow += limit; edge[nowe^1].flow -= limit; nown = edge[nowe].from; } ff += limit,cc += limit * dis[t]; } void init(){ read(n),read(m); for(int i = 1;i\u0026lt;=n;i++){ read(p[i]); sum += p[i]; } for(int i = 1;i\u0026lt;=n;i++){ for(int j = 1;j\u0026lt;=m;j++){ read(ti[i][j]); } } } void solve(){ s = m*sum + n + 1,t = m*sum + n + 2; for(int i = 1;i\u0026lt;=n;i++) addedge(s,m*sum + i,p[i],0); for(int j = 1;j\u0026lt;=m;j++){ addedge(j,t,1,0); for(int i = 1;i\u0026lt;=n;i++){\taddedge(m*sum + i,j,1,ti[i][j]); } } while(spfa()){ argument(); int x = edge[pree[t]].from; addedge(x+m,t,1,0); for(int i = 1;i\u0026lt;=n;i++){ addedge(m*sum + i,x+m,1,ti[i][(x-1)%m+1]*((x+m-1)/m+1)); } } print(cc),print(\u0026#39;\\n\u0026#39;); } int main(){ init(); solve(); flush(); return 0; }   ","description":"","id":186,"section":"posts","tags":["è´¹ç”¨æµ","å›¾è®º"],"title":"ã€ŒNOI2012ã€ç¾é£ŸèŠ‚-è´¹ç”¨æµ","uri":"https://blog.chenqiqian.com/posts/noi2012-festival/"},{"content":" è¡¡æ°´å¸‚ï¼Œ2017å¹´å¸¸ä½äººå£446.0ä¸‡äººï¼ŒGDP1550.1äº¿å…ƒï¼Œäººå‡GDP3.47ä¸‡å…ƒï¼Œè¡¡æ°´å¸‚æ•™è‚²å±€é¢„ç®—æ”¯å‡º68644.4ä¸‡å…ƒã€‚\n  åŒ—äº¬å¸‚æµ·æ·€åŒºï¼Œ2017å¹´å¸¸ä½äººå£348.0ä¸‡äººï¼ŒGDP5915.3äº¿å…ƒï¼Œäººå‡GDP17.00ä¸‡å…ƒï¼Œæµ·æ·€åŒºæ•™è‚²å§”å‘˜ä¼šé¢„ç®—æ”¯å‡º1038648.0ä¸‡å…ƒã€‚\n Xå¤§é™„ä¸­ï¼Œé«˜ä¸­åœ¨æ ¡ç”Ÿçº¦3000äººï¼Œä¸€æœ¬ç‡è¿‘100%ï¼Œæ¸…åŒ—å½•å–äººæ•°119äººã€‚\næ²³åŒ—è¡¡æ°´ä¸­å­¦ï¼Œåœ¨æ ¡ç”Ÿçº¦10000äººï¼Œä¸€æœ¬ç‡è¶…è¿‡85%ï¼Œæ¸…åŒ—å½•å–äººæ•°175äººã€‚\nå†™åœ¨å‰é¢ \u0008\u0008\u00082018å¹´4æœˆ29æ—¥ï¼Œæˆ‘å»è¡¡æ°´å‚è§‚äº†è¡¡æ°´ä¸­å­¦çš„å¼€æ”¾æ—¥ã€‚å‚è§‚çš„æ—¶é—´å’Œå†…å®¹éƒ½ä¸æ˜¯å¾ˆå……åˆ†ï¼Œ\u0008æˆ‘ä½œä¸ºä¸€ä¸ªçŸ¥åâ€œç´ è´¨æ•™è‚²â€å­¦æ ¡çš„å­¦ç”Ÿï¼Œ\u0008æŸäº›äº‹æƒ…ä¸Šçš„è§‚ç‚¹æœ‰å¯èƒ½å¹¶ä¸å‡†ç¡®å’Œæ­£ç¡®ã€‚å¦‚æœ‰è¿™äº›æƒ…å†µï¼Œå¯ä»¥ç•™è¨€å‘ŠçŸ¥ï¼Œæˆ‘ä¼šé…Œæƒ…åˆ æ”¹ã€‚\nå¼•å­ 2018å¹´4æœˆ29æ—¥ï¼Œæ²³åŒ—çœè¡¡æ°´å¸‚ã€‚æ™´ï¼Œ18-31æ‘„æ°åº¦ã€‚\né©±è½¦äº”ä¸ªå°æ—¶ï¼Œç»ˆäºä»åŒ—äº¬åˆ°è¾¾äº†è¡¡æ°´ã€‚\næ€»æ˜¯è¯´è¦å‡ºåŒ—äº¬å»è§è§ä¸–é¢ï¼Œå»è§‚å¯Ÿé‚£äº›ä¸æ˜¯é‚£ä¹ˆç†Ÿæ‚‰çš„åœ°æ–¹ï¼Œæ‰€ä»¥ä¸€çœ‹åˆ°è¡¡ä¸­å¼€æ”¾æ—¥ï¼Œå°±æš—æš—ä¸‹å®šå†³å¿ƒï¼Œè¦å»è¿™æ‰€åªåœ¨æ–°é—»é‡Œå¬é—»è¿‡çš„å­¦æ ¡ã€‚ä»¥è‡³äºåé¢å‡ å¤©å¬è¯´æ¸…åçš„æ ¡åº†å¯ä»¥å»è§‚ç¤¼ï¼Œä¹Ÿä»ç„¶å»äº†è¡¡æ°´ã€‚ç”šè‡³å°±åœ¨å»ä¹‹å‰çš„ä¸€å¤©ï¼Œè¿˜è·ŸåŒå­¦å¼€ç©ç¬‘è¯´ï¼šâ€œæ‚¨å»æ¸…åç­¾çº¦ï¼Œæˆ‘åªèƒ½å»è¡¡æ°´å¤è¯»äº†ã€‚â€\næ—©ä¸Šçš„è·¯ç¨‹è¯´ä¸ä¸Šé¡ºåˆ©ã€‚å…­ç‚¹é’Ÿå°±ä»åŒ—äº¬å‡ºå‘ï¼Œä¸€è·¯ç›®ç¹äº†è®¸å¤šè¿½å°¾è½¦ç¥¸ï¼Œæœ€åç«Ÿ11ç‚¹æ‰åˆ°äº†è¡¡ä¸­é—¨å£ã€‚\nä¸‹äº†è½¦ï¼Œå°±æ‹¿å¥½ä¸œè¥¿ï¼Œå‘è¡¡ä¸­çš„å¤§é—¨ç¼“ç¼“èµ°å»ã€‚é‚£æ—¶æ­£æ˜¯ä¸­åˆï¼Œå¤©æ°”å¾ˆçƒ­ï¼Œå¤©ç©ºä¸Šä¹Ÿæ²¡æœ‰ä¸€ç‚¹çš„æµ®äº‘ï¼Œç©¿ä¸ŠçŸ­è¢–ä¹Ÿæ„Ÿåˆ°å°‘è®¸é—·çƒ­ã€‚çªç„¶é—´ï¼Œè¡¡ä¸­çš„å¤§é—¨å°±å‡ºç°äº†åœ¨çœ¼å‰ã€‚\nè¡¡æ°´ä¸­å­¦æ­£æ ¡é—¨ï¼šé…·ä¼¼é¦–éƒ½å¸ˆèŒƒå¤§å­¦\nä»åœè½¦å¤„èµ°åˆ°æ ¡é—¨çš„è·¯ä¸Šï¼Œä¸€è·¯çš„æ™¯è±¡ä¹Ÿè®©æˆ‘ä¸ç¦å”å˜˜ã€‚ä¸€æ¡ç¬”ç›´çš„å¤§é“ï¼Œè·¯æ—çš„åº—é“ºåˆ™å¤§å¤šä¸æ•™è‚²æœ‰å…³ï¼Œç”šè‡³è¿˜æœ‰åœ¨åœ°ä¸Šæ‘†äº†ä¸€åœ°é«˜ä¸­æ•™æå’Œäº”ä¸‰çš„å°è´©ã€‚è„šä¸‹çš„é“è·¯è™½ç„¶å·²ç»ç¡¬åŒ–ï¼Œä½†æ˜¯ä»ç„¶ä¸ç”šå¹³æ•´ã€‚åœ¨å¤§é—¨å£ï¼Œåœæ»¡äº†å„ç§å„æ ·çš„ç”µåŠ¨è½¦å’Œä¸‰è½®è½¦ï¼Œè½¦ä¸Šæ’‘ç€é®é˜³ä¼çš„å°æ‘Šè´©ä¹Ÿä¸¾ç›®å¯è§ã€‚å¦‚æœä½ ä¸è¯´è¿™é‡Œæ˜¯è¡¡æ°´ä¸­å­¦ï¼Œé‚£ä¹ˆæˆ‘ä¸€å®šä¼šæŠŠè¿™ä¸ªä¸€ä¸ªçœæœ€å¼ºï¼Œä¹ƒè‡³å…¨å›½æœ€å¼ºçš„ä¸­å­¦ä¹‹ä¸€çš„å­¦æ ¡å½“ä½œä¸€ä¸ªæ™®é€šåå…«çº¿å°å¿åŸçš„ä¸€æ‰€æ™®é€šçš„é«˜ä¸­ã€‚\nç„¶è€Œè¿™æ˜¯è¡¡æ°´ä¸­å­¦ã€‚\n\u0008å›¾ï¼šè¯æ˜ç¡®å®å»è¿‡\næ ¡å›­ \u0008è¡¡ä¸­çš„æ ¡å›­ï¼Œå…¶å®å¹¶ä¸å’ŒXå¤§é™„ä¸­çš„\u0008æ ¡å›­\u0008\u0008çš„æ ¼å±€æœ‰ä»€ä¹ˆå¤šå¤§çš„åŒºåˆ«ã€‚ä½†ç›¸æ¯”äº\u0008Xå¤§é™„ä¸­ï¼Œè¡¡ä¸­çš„æ ¡å›­æ˜¾å¾—æ›´å¤§ä¸€äº›ã€‚\n0x01 è¿›é—¨çš„å·¦æ‰‹è¾¹å°±æ˜¯ä¸€é—¨å¤§ç‚®å’Œä¸€ä¸ªå°æ¹–ã€‚\n\u0008å›¾ï¼šç¥å¥‡çš„åŠ å†œç‚®\nä¸æ­¢å·¦æ‰‹è¾¹æ˜¯ä¸€é—¨å¤§ç‚®ï¼Œå³æ‰‹è¾¹å°±æ˜¯ä¸€å°62å¦å…‹ã€‚æœç„¶æ˜¯åˆçº¢åˆä¸“å•Šï¼åˆ°å¤„éƒ½æ˜¯å…³äºåä¹å¤§å’Œ\u0008ä»Šå¹´çš„äººå¤§æ¢å±Šçš„å±•æ¿\u0008ï¼Œæ”¿æ²»è§‰æ‚Ÿå®åœ¨æ˜¯é«˜ï¼\nå›¾ï¼š62å¼å¦å…‹ åˆæ•™6\u0008æ•™ç»ƒæœº\nä¸€ç›´ç¾¡æ…•æ ¡å›­é‡Œæœ‰æ°´çš„å­¦æ ¡ï¼Œæ¯”å¦‚101ã€‚å¦‚æœä¸€ä¸ªå­¦æ ¡\u0008é‡Œé¢æœ‰æ´»æ°´ï¼Œé‚£ä¹ˆè¿™æ‰€å­¦æ ¡çš„æ°”æ°›ï¼Œå°±ä¸€å®šä¸ä¼šæ­»æ°”æ²‰æ²‰ï¼Œåœ¨å…¶ä¸­\u0008å­¦ä¹ ä¸€å®šä¼šæ˜¯å……æ»¡æ„‰å¿«çš„ã€‚é‡åˆ°ä»€ä¹ˆå›°éš¾ï¼Œå»çœ‹çœ‹\u0008\u0008æ¾„æ¾ˆçš„æ°´é¢ï¼Œæ€»æ˜¯ä¼šè®©äººè§‰å¾—äººç”Ÿæ˜¯å……æ»¡å¸Œæœ›çš„ã€‚ä½†æˆ‘æƒ³äººå¤§çš„ä¸€å‹ºä¹‹æ± å¤§çº¦æ˜¯ä¸ç®—åœ¨å…¶ä¸­çš„ã€‚\nå›¾ï¼šè¡¡ä¸­æ¹–\n0x02 \u0008\u0008èµ°åˆ°æœ€é‡Œé¢ï¼Œå°±æ˜¯\u0008è¡¡ä¸­çš„æ“åœºäº†ã€‚\nå›¾ï¼šæ“åœºåŠæ ‡è¯­\nå…¨ä¸–ç•Œçš„æ“åœºéƒ½æ˜¯å·®ä¸å¤šçš„\u0008æ ·å­ã€‚ä¸è¿‡æˆ‘è¿˜æ˜¯è¦è¯´\u0026hellip;ä½ Xå¤§é™„ä¸­æ¯å¹´å‡ ä¸ªäº¿çš„ç»è´¹èƒ½ä¸èƒ½ä¿®ä¸ªè‰çš®ï¼Ÿï¼Ÿï¼Ÿ\u0008å…¨ä¸–ç•Œçš„è‰çš®éƒ½ä¸çŸ¥é“æ¯”ç ´æ ¡å¥½åˆ°å“ªé‡Œå»äº†ã€‚\næœ‰ç‚¹ç‰¹è‰²çš„å°±æ˜¯æ ‡è¯­ã€‚å¼€å§‹è¿˜æ²¡ä»€ä¹ˆã€‚ç«™åœ¨æ“åœºçš„ä¸­å¤®ï¼Œè¶Šè¯»è¶Šè§‰å¾—æœ‰è¶£ã€‚æ²¡æœ‰çœ‹åˆ°è·‘æ“çš„ç¤ºèŒƒï¼Œä¹Ÿä¸å¥½å†è¯´äº›\u0008ä»€ä¹ˆï¼Œè¿™ä¸ªç« èŠ‚å°±ç®€çŸ­ä¸€äº›äº†ã€‚\n\u0008å›¾ï¼šè¡¡æ°´ä¸­å­¦çš„å­¦ç”Ÿæ­£åœ¨æ‰“ç¯®çƒ\nè¿™å¼ å›¾ä¹Ÿè®©æˆ‘å°è±¡å¾ˆæ·±åˆ»ã€‚è¡¡ä¸­çš„\u0008å­¦ç”Ÿï¼Œå†æ€ä¹ˆæ ·ï¼Œä¹Ÿè¿˜å¯ä»¥æ˜¯å­¦ç”Ÿçš„å˜›ã€‚\n0x03 å¾€å¤–èµ°çš„è·¯ä¸Šï¼Œåœ¨æ ‘æ¢¢çš„æå¤´çŸè§\u0008é«˜ä¸‰\u0008(oré«˜äºŒï¼Ÿ)çš„æ•™å­¦æ¥¼ä¸Šæœ‰ç€ä¸€é¢å‡ ä¹åˆ†æ¯«ä¸å·®çš„å¤§é’Ÿã€‚\nå›¾ï¼šæ•™å­¦æ¥¼ä¸Šçš„é’Ÿ\næˆ–è®¸è¿™ä¹Ÿæ˜¯è¡¡ä¸­çš„å‡ ä¹å˜æ€çš„æ—¶é—´è§„åˆ’çš„ä½“ç°å§ã€‚åˆšçœ‹åˆ°è§‰å¾—æœ‰äº›æ„å¤–ï¼Œä½†æ¸æ¸åœ°ä¹Ÿè§‰å¾—\u0008è¿™äº›ä¸œè¥¿ï¼Œä¹Ÿä¸æ˜¯ä»€ä¹ˆåçš„ä¸œè¥¿å•Šã€‚\nè¶ç€\u0008å®¶é•¿ä¼šå·å·æºœè¿›äº†é«˜ä¸€çš„æ•™å®¤ã€‚æ¥ä¸‹æ¥è¿™ä¸€æ®µå¤§æ¦‚æ˜¯å…¨æ–‡æˆ‘æ„Ÿè§‰æœ€æœ‰æ„æ€çš„\u0008åœ°æ–¹äº†ã€‚\n\u0008æˆ‘ç°åœ¨ä¹Ÿæ­£æ˜¯é«˜ä¸€ï¼Œæ‰€ä»¥å¤§çº¦å¯¹ä¸‹é«˜ä¸€çš„å­¦ä¹ \u0008è¿›åº¦å¤§çº¦æ˜¯ä»¶éå¸¸æœ‰è¶£çš„äº‹æƒ…ã€‚\nå›¾ï¼šå…¬å¼€è´´åœ¨æ¥¼é“çš„\u0008å‘¨æµ‹\u0008ï¼ˆæˆ–è€…æœŸä¸­è€ƒè¯•ï¼‰æ’å\næ¯‹åº¸ç½®ç–‘ï¼Œè¡¡ä¸­ï¼Œå°¤å…¶å…¶å®éªŒç­çš„ç¡®æ˜¯ä¸€ä¸ªå­¦ä¹ \u0008æ°›å›´éå¸¸æµ“åšçš„åœ°æ–¹ã€‚ä¹Ÿè®¸å¹¶ä¸æ˜¯æ‰€æœ‰äººéƒ½æƒ³å»å­¦ä¹ ï¼Œ\u0008ä¸åœçš„å­¦ä¹ ï¼Œä½†è¿™æ ·å­¦ä¹ çš„ç¯å¢ƒçš„ç¡®æ˜¯å¾ˆéš¾åœ¨å¿åŸé«˜ä¸­é‡Œè·å¾—çš„ã€‚\nå°±ç®—åœ¨æˆ‘çš„åŒå­¦é‡Œé¢ï¼Œ\u0008\u0008\u0008\u0008æˆ‘ææ€•ä¹Ÿæ˜¯å°‘æ•°å‡ ä¸ªè¿˜å¯¹åˆä¸‰\u0008çš„æœˆè€ƒæŠ±æœ‰å¥½æ„Ÿçš„äººã€‚è¿™ç§å­¦ä¹ çš„æ°›å›´ï¼Œå¯¹è‡ªå·±å­¦ä¹ æ–¹é¢å®åŠ›çš„æå‡ï¼Œæˆ‘è¿˜æ˜¯å¾ˆå–œæ¬¢çš„ã€‚\nè¿˜æœ‰å°±æ˜¯æ•™å®¤ã€‚å®ƒçš„æ•™å®¤è¾ƒæˆ‘ä»¬ç°åœ¨ä½¿ç”¨çš„æ¥¼æ¥çœ‹ï¼Œè¿˜æ˜¯ç¨å¤§ä¸€äº›ã€‚ä½†æ˜¯ï¼Œå°±æ˜¯è¿™äº›ç¨å¤§ä¸€äº›çš„\u0008æ•™å®¤ï¼Œç«Ÿç„¶\u0008ç››ä¸‹äº†å‡ ä¹ä¸¤å€äº\u0008æˆ‘ä»¬ä¸€ä¸ª\u0008\u0008æ•™å®¤çš„äººã€‚\nå›¾ï¼šé«˜ä¸€çš„æ•™å®¤ï¼Œå¯ä»¥\u0008çœ‹åˆ°\u0008ä¸‰ä¸ªï¼Œä¹ƒè‡³å››ä¸ªäººåŒæ¡Œ\u0008æƒ…å†µ\nä¸æ•¢æƒ³è±¡å•Šã€‚æˆ‘ä»¬çš„æ•™å®¤ï¼Œ\u0008åä¸‹40\u0008ä¸ªäººå°±å·²ç»å¾ˆæ‹¥æŒ¤ã€‚70ä¸ªäººçœŸçš„æ˜¯éš¾ä»¥ä»¤äººæƒ³è±¡ã€‚\u0008æ¯ä¸ªäººçš„åº§ä½ä¸‹ï¼Œéƒ½æœ‰ä¸€ä¸ªç®±å­ï¼Œç››ç€æˆ–è®¸æ˜¯ä¹¦ï¼Œæˆ–è®¸æ˜¯å·å­ã€‚\nè¿™å°±æ˜¯\u0008ä¸­å›½æœ€å‰å®³çš„é«˜ä¸­çš„æ•™å®¤ã€‚\nå›¾ï¼šæ¯ä¸ªç­é—¨å£éƒ½é…æœ‰çš„\u0008ç”µå­è§¦æ‘¸å±å¹•\nå³ä½¿æ•™å®¤æ¯”è¾ƒç ´æ—§ï¼Œå¯æ˜¯\u0008ç”µæ•™ä»€ä¹ˆçš„å´ä¸å·®ä»€ä¹ˆã€‚åƒè¿™æ ·çš„\u0008\u0008å±å¹•ï¼Œæ¯ä¸ªç­éƒ½æœ‰ä¸€å—ã€‚åœ¨æ¥¼é“é‡Œè¿˜æœ‰è‡ªåŠ¨å”®è´§æœºï¼ŒçœŸæ˜¯ä¸çŸ¥é“æ¯”æˆ‘ä»¬é«˜åˆ°å“ªé‡Œå»äº†ã€‚\u0008\n\u0008åœ¨æ•™å­¦æ¥¼é‡Œï¼Œäººæ¥äººå¾€ï¼Œå­¦ç”Ÿæ‹¿ç€è‡ªå·±çš„ä¸œè¥¿ï¼Œå®¶é•¿å’Œå­¦ç”Ÿä¸€èµ·ã€‚æˆ‘å»çš„ä»…ä»…æ˜¯é«˜ä¸€çš„æ•™å®¤ã€‚è¿™é‡Œçš„é«˜ä¸€\u0008ï¼Œæ„Ÿè§‰\u0008æ¯”æˆ‘æ ¡çš„é«˜ä¸‰è¿˜è¦ç´¯ä¸Šè®¸å¤šã€‚\nçœ‹çœ‹æˆ‘æ‹¥æœ‰çš„æ¡ä»¶ï¼Œå¾ˆæƒ­æ„§ï¼Œä½†æˆ‘ä¹Ÿ\u0008æ— èƒ½ä¸ºåŠ›ã€‚\u0008æˆ‘å¦„æƒ³ç€ä»¥ç¬”ä¸ºåˆƒï¼Œç„¶è€Œ\u0008æˆ‘ç¡®å®ä¹Ÿåªæ˜¯ä¸€ä¸ªæ™®é€šçš„é«˜ä¸­ç”Ÿã€‚æˆ‘æ¯”ä»–ä»¬æ‰€æ‹¥æœ‰çš„ä¸€åˆ‡å¥½çš„å¤š\u0008ï¼Œä¸æ˜¯é æˆ‘ï¼Œè€Œæ˜¯é æˆ‘çš„\u0008çˆ¶æ¯ã€‚è¿™ä¸åº”æ˜¯ä»–ä»¬å¯æ‚²ä¹‹å¤„ï¼Œæ˜¯å›½å®¶ä¹‹å¯æ‚²å•Šã€‚\u0008\n0x04 ä»æ•™å®¤é‡Œé¢èµ°å‡ºæ¥ï¼Œå®¶é•¿ä¼šå·²è¿‘ç»“æŸï¼Œä¸Šåˆè¿˜åœ¨å­¦æ ¡çš„å­¦ç”Ÿä»¬ä¹Ÿè¦å›å®¶åº¦è¿‡ä¸¤å¤©åŠï¼ˆæˆ–è€…ä¸€å¤©åŠï¼Ÿï¼‰çš„äº”ä¸€å‡æœŸäº†ã€‚\nå¼€æ”¾æ—¥ç»“æŸï¼Œæˆ‘ä¹Ÿåªå¥½èµ°å‡ºæ ¡é—¨ã€‚çªç„¶å°±çœ‹åˆ°\u0008å³æ‰‹è¾¹ï¼Œæœ‰ä¸€ä¸ªå­¦ç”Ÿï¼Œ\u0008ååœ¨é‚£ç§æ‹‰è´§çš„ä¸‰è½®è½¦ä¸Šï¼Œ\u0008æ•´ä¸ªä¸‰è½®è½¦çš„å…¶ä»–ä½ç½®å…¨éƒ½è¢«è¡Œæå æ»¡ã€‚è¿™ä¸€åˆ‡çªç„¶æ’å…¥\u0008çœ¼å¸˜ï¼Œä¸ç»æ„é—´ä¹Ÿæ’å…¥å¿ƒåã€‚\n\u0008å•†é‡å¥½å»å“ªé‡Œåƒä¸­åˆé¥­ï¼Œä¸€å®¶äººå°±å¼€ç€è½¦å‰å¾€ç›®çš„åœ°ã€‚\u0008å¤©æ°”å¾ˆçƒ­ï¼Œè½¦çš„\u0008åº§æ¤…ç»è¿‡åŠä¸ª\u0008ä¸Šåˆçš„ç‚™çƒ¤éƒ½æœ‰ç‚¹å‘çƒ«ã€‚è¿›è½¦å…³é—¨ï¼Œ\u0008ç©ºè°ƒçš„å£°éŸ³ä¸€æ—¶\u0008å–§é—¹èµ·æ¥ã€‚æˆ‘ååœ¨åæ’ï¼Œç™¾æ— èŠèµ–çš„çœ‹ç€\u0008\u0008çª—å¤–\u0008æœ‰äº›æ¯é»„çš„å¤©ç©ºã€‚\n\u0008è¡—ä¸Š\u0008æ»¡éƒ½æ˜¯åˆšæ”¾å­¦çš„è¡¡ä¸­çš„å­¦ç”Ÿï¼Œä»¥åŠéª‘ç€å„ç§\u0008ç”µåŠ¨è½¦\u0008æ¥ä»–ä»¬å›å»çš„å®¶é•¿ä»¬ã€‚è½¦å†…çš„æ¸©åº¦æ¸æ¸é™ä¸‹æ¥äº†ã€‚çœ‹ç€çª—å¤–ï¼Œæƒ³ç€ä¸Šåˆ\u0008æ‰€è§çš„ä¸€åˆ‡ï¼Œåˆšè¦æœ‰äº›æ„Ÿæ…¨ï¼Œ\u0008çªç„¶å°±çœ‹åˆ°\u0008é‚£ä¸ªååœ¨ç”µåŠ¨è½¦ä¸Šçš„å¥³ç”Ÿå†æ¬¡å‡ºç°åœ¨äº†æˆ‘çš„è§†é‡é‡Œã€‚æˆ‘ååœ¨å‡‰çˆ½çš„\u0008ç§å®¶è½¦çš„è½¦åº§åº§ä¸Šï¼Œè€Œå¥¹å´åªèƒ½ååœ¨ä¸‰è½®è½¦é‚£æˆ–è®¸æ»šçƒ«çš„é‡‘å±æ¿å­ä¸Šã€‚\u0008\u0008\u0008\u0008\u0008æˆ‘å¯ä»¥å»é¤é¦†\u0008å¹ç€ç©ºè°ƒèˆ’èˆ’æœæœ\u0008çš„åƒä¸Šä¸€é¡¿ç„¶åå†™ä¸€ç¯‡æ¸¸è®°ï¼Œ\u0008å¥¹æˆ–è®¸åªèƒ½åƒå®Œç®€æœ´çš„é¥­é£Ÿæ¥ç€å»å†™ä½œä¸šã€‚\nå½“è¿™äº›å·®è·çœŸçœŸçš„æ‘†åœ¨é¢å‰â€”â€”ç”¨è¯­æ–‡çš„è¯è¯´â€œå½¢æˆé²œæ˜å¯¹æ¯”â€ï¼Œæˆ–è®¸æ‰æ˜¯çœŸæ­£èƒ½ä½“ä¼šåˆ°ç™¾å‘³è¾›é…¸çš„æ—¶å€™ã€‚\næ„Ÿæ…¨ä¸‡åƒã€‚æˆ‘çœ‹ç€é‚£ä½åŒå­¦èƒŒåçš„å››ä¸ªå­— â€œè¿½æ±‚å“è¶Šâ€ ï¼Œ\u0008ä¸€æ—¶å‡ç¥ï¼Œä¸çŸ¥é“è¯¥è¯´äº›ä»€ä¹ˆå¥½ã€‚\nè¯šç„¶ï¼Œä»¥\u0008\u0008è¡¡æ°´ä¸­å­¦ä¸ºä»£è¡¨çš„ä¸€ç³»åˆ—è¶…çº§ä¸­å­¦çš„è·‘æ“ã€è¿‘ä¹\u0008å†›è®­çš„æ—¥å¸¸æ—¶é—´è¡¨ï¼Œè¿˜æœ‰ä¸¥è‹›çš„\u0008å„ç§çºªå¾‹ï¼Œçš„ç¡®æ˜¯\u0008ä¸€ç§å¯¹äºäººçš„ç‰¹æ€§çš„ç£¨ç­ã€‚\nä½†è¯·ä½ æ”¾ä¸‹èº«ä½ï¼ŒçœŸçš„æ”¾ä¸‹ä½ æ‰€æ‹¥æœ‰çš„ä¸€åˆ‡å»æ€è€ƒï¼š\n ä½ æ˜¯ä¸€ä¸ªå››çº¿åŸå¸‚çš„\u0008\u0008æ™®é€šäººå®¶çš„å­©å­ã€‚ä½ çš„çˆ¸å¦ˆå¹¶ä¸å…·æœ‰å¾ˆé«˜çš„æ–‡åŒ–ç´ å…»ï¼Œå®¶åº­çš„ç‰©è´¨æ¡ä»¶ä¹Ÿä¸ç®—å¯Œè£•ã€‚ä½ æ¸´æœ›æ›´å¤§çš„ä¸–ç•Œï¼Œæ¸´æœ›èµ°å‡ºå°å°çš„\u0008å¿åŸã€‚ä½ èƒ½æ€ä¹ˆåšå‘¢ï¼Ÿ\n è¡¡æ°´ä¸­å­¦ä¸å¯èƒ½åƒXå¤§é™„ä¸­ä¸€æ ·ã€‚ \u0008æ•´ä¸ªè¡¡æ°´å¸‚ï¼Œç»™\u0008æ€»å…±åå‡ æ‰€çš„å°å­¦ï¼Œ\u0008ä¸­å­¦ï¼Œ\u0008\u0008ä¸“ç§‘å­¦æ ¡çš„æ•™è‚²èµ„é‡‘åªæœ‰6ä¸ªäº¿ã€‚è€Œå…‰Xå¤§é™„ä¸­ä¸€æ‰€å­¦æ ¡ï¼Œæ¯å¹´ä»Xå¤§èƒ½æ‹¿åˆ°çš„èµ„é‡‘å°±æœ‰3ä¸ªå¤šäº¿ã€‚æ€ä¹ˆæ¯”ï¼ŸXå¤§é™„ä¸­çš„å­¦ç”Ÿï¼Œ\u0008ç»å¤§å¤šæ•°çš„çˆ¶æ¯éƒ½æ˜¯\u0008é«˜çº§çŸ¥è¯†åˆ†å­ï¼Œ\u0008å®¶å¢ƒæ€ä¹ˆç€ä¹Ÿèƒ½ç®—å¾—ä¸Šæ®·å®ã€‚æ€ä¹ˆæ¯”ï¼Ÿ\nè¡¡ä¸­æ‰€èƒ½\u0008åšçš„ï¼Œæ˜¯ç»™é‚£äº›æƒ³èµ°å‡ºå»çš„å­¦ç”Ÿï¼Œä¸€ä¸ªå…¬å¹³çš„èˆå°ï¼Œ\u0008ä¸€ä¸ª\u0008å®Œæ•´çš„æœºä¼šã€‚ä¸€ä¸ªæ™®é€šçš„å­¦ç”Ÿï¼Œå¦‚æœä»–æœ¬èº«æœ‰å¼ºçƒˆçš„æ„¿æœ›æƒ³è¦å­¦ä¹ ï¼Œ\u0008æƒ³è¦æå‡è‡ªå·±ï¼Œæƒ³è¦\u0008åˆ°è¾¾æ›´é«˜çš„\u0008\u0008å¹³å°ï¼›é‚£ä¹ˆé™¤äº†è¡¡ä¸­ï¼Œ\u0008åœ¨ä¸€ä¸ªå°å°çš„åœ°çº§å¸‚ï¼Œè¿˜æœ‰ä»€ä¹ˆå­¦æ ¡èƒ½æä¾›ç»™ä»–æƒ³è¦çš„å¹³å°å’Œæœºé‡ï¼Ÿæ—¢ç„¶å¦‚æ­¤ï¼Œé‚£\u0008å¤–äººæ‰€è¯‹æ¯çš„è¡¡ä¸­çš„ä¸€åˆ‡ï¼Œ\u0008å¯¹äº\u0008ä»–ï¼Œåˆç®—å¾—äº†ä»€ä¹ˆå‘¢ï¼Ÿ\nå…¶å®è¡¡æ°´ä¸­å­¦æ›´åƒæ˜¯ä¸€ä¸ª\u0008ä¸­å›½\u0008æ•™è‚²çš„çŸ›ç›¾çš„é›†ä¸­ä½“ã€‚äººäººéƒ½çŸ¥é“ç´ è´¨æ•™è‚²å¥½ï¼Œäººäººéƒ½åœ¨åª’ä½“ä¸ŠæŠ¨å‡»åº”è¯•æ•™è‚²ã€‚å¯æ˜¯å°±ç®—ä»¥ç´ è´¨æ•™è‚²é—»åçš„Xå¤§é™„ä¸­ï¼Œä¸€ä½è€å¸ˆä¹Ÿè¿™ä¹ˆè¯´ï¼šâ€œè¿™èŠ‚è¯¾æˆ‘æ•™ä½ çš„ä¸æ˜¯\u0008ç´ è´¨æ•™è‚²ã€‚æˆ‘ä»¬è¯¥åº”è¯•çš„\u0008æ—¶å€™\u0008å°±å¾—åº”è¯•ã€‚â€åªè¦ä½ è¿˜å¤„åœ¨å¹³æ°‘çš„å±‚æ¬¡ï¼Œåº”è¯•ä»ç„¶æ˜¯é˜¶çº§å¯èƒ½çš„ä¸Šå‡é€”å¾„ä¸­ä¸èƒ½é¿å¼€çš„ä¸€ä»¶äº‹ã€‚\u0008å›½æƒ…åœ¨æ­¤ï¼Œå¦‚æœè¿è¡¡æ°´ä¸­å­¦è¿™æ ·ï¼Œèƒ½ç»™è´«è‹¦å­©å­æä¾›ä¸Šå‡æœºä¼šçš„å¹³å°éƒ½è¦å»æ¨ç¿»ï¼Œé‚£\u0008è¿™äº›äººçš„\u0008å˜´è„¸ç®€ç›´æ˜¯å‘é„™ã€‚\nè™½ç„¶è¡¡æ°´ä¸­å­¦è¿™æ ·çš„æ¨¡å¼çš„ç¡®æ˜¯ä¸€ç§å½“å‰å›½æƒ…ä¸‹çš„æœ€ä¼˜è§£ï¼Œä½†æ˜¯\u0008ä¸èƒ½å¦è®¤ï¼Œè¡¡æ°´ä¸­å­¦è¿˜æ˜¯éœ€è¦å»æ‰¹åˆ¤çš„ã€‚è¯¸å¦‚è¡¡æ°´ä¸­å­¦ã€æ¯›å¦å‚ä¸­å­¦çš„å‡ºç°ï¼Œæ ¹æœ¬è¿˜æ˜¯å› ä¸ºæ•™è‚²èµ„æºçš„æä¸ºä¸å‡ï¼Œè¿™ç»ˆç©¶ä¸æ˜¯æˆ‘ä»¬æƒ³çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬è¿™ä¸€ä»£äºº\u0008ä¹Ÿéœ€è¦å»æ‹¼æå¥‹æ–—çš„\u0008å»æ”¹å˜ã€‚\nè¿˜æœ‰æœ€åä¸€ç‚¹ã€‚é‚£ä½åŒå­¦ï¼Œæˆ‘è¡·å¿ƒçš„ç¥ä½ å¥½è¿ã€‚\u0008æ„¿ä½ èƒ½å¤Ÿè€ƒä¸Š\u0008å¿ƒä»ªçš„å¤§å­¦ï¼Œè¿‡ä¸Šæ»¡æ„çš„ç”Ÿæ´»ã€‚æ„¿é˜¶çº§ä¸å†èƒ½æˆä¸ºä½ çš„æ·é”ï¼Œä½ çš„\u0008äººç”Ÿèƒ½æ‘†è„±\u0008è¿™å±‚\u0008è¿‘ä¹æ— è§£çš„\u0008æ¡æ¢ã€‚\næ„¿ä½ \u0008å®‰å¥½ã€‚\næ¥æºï¼šDear Earth\nå†™åœ¨æœ€å å¦‚æœæˆ‘æœ‰æœºä¼šï¼Œå…¶å®æˆ‘æ„¿æ„åœ¨è¿™æ‰€å­¦æ ¡é‡Œç”Ÿæ´»ä¸Šä¸€ä¸ªæœˆï¼Œä½“éªŒä¸€ä¸‹åŒ—äº¬ä»¥å¤–çš„ç”Ÿæ´»ã€‚è€æ˜¯å‘†åœ¨\u0008åŒ—äº¬ï¼Œææ€•æ€»ä¼šæŠŠäººç”Ÿçœ‹çš„\u0008è¿‡äºç®€å•ã€‚\u0008åœ¨é‚£é‡Œï¼Œææ€•æ‰æ˜¯ä¸­å›½æ„ä¹‰ä¸Šæ¯”è¾ƒæ™®éçš„äººç”Ÿçš„æ ·å­ã€‚\nä½†ææ€•å¹¶æˆ‘ä¸ä¼šå»\u0008è¡¡ä¸­ï¼Œæœ‰æœºä¼šèƒ½å»çš„\u0008æ—¶å€™ä¹Ÿå¹¶ä¸æƒ³å»\u0008å¦‚æ­¤å»ä¸ºè‡ªå·±æ‹¼æäº†ã€‚\nå†™äº2018å¹´4æœˆ30æ—¥ã€‚\n","description":"","id":187,"section":"posts","tags":null,"title":"è¡¡æ°´ä¸­å­¦æ¸¸è®°","uri":"https://blog.chenqiqian.com/posts/trip-hs-middle-school/"},{"content":"ç»™å®š $n$ ä¸ªç»“ç‚¹çš„æ•°æ®å€¼ $V_i$ ï¼Œæƒå€¼ $P_i$ ï¼Œè®¿é—®é¢‘åº¦ $T_i(T_i \\geq 0)$ ã€‚å¯¹äº $\\forall i,j \\in V$ ä¸” $i \\neq j$ ï¼Œæœ‰ $V_i \\neq V_j, P_i \\neq P_j$ ã€‚\nç°ä»¤è¿™ $n$ ä¸ªç‚¹ç»„æˆä¸€é¢—äºŒå‰æ ‘ï¼Œä¸”æ»¡è¶³ $\\forall , i \\in V$ ï¼Œè‹¥ $p$ ä¸º $i$ çš„å·¦å­èŠ‚ç‚¹ï¼Œ $q$ ä¸º $i$ çš„å³å­èŠ‚ç‚¹ï¼Œåˆ™ $V_p \u0026lt; V_i \u0026lt; V_q$ ä¸” $P_i \u0026lt; P_p,; P_i \u0026lt; P_q$ ã€‚å¯ä»¥è¯æ˜ï¼Œè¿™æ ·çš„äºŒå‰æ ‘æ˜¯å”¯ä¸€çš„ã€‚ç‚¹\u001c$i$ åœ¨æ ‘ä¸­çš„æ·±åº¦ $D_i$ å®šä¹‰ä¸ºå®ƒåˆ°æ ¹çš„è·ç¦»åŠ  $1$ ã€‚å®šä¹‰ç»“ç‚¹ $i$ çš„è®¿é—®ä»£ä»· $E_i = T_i \\times D_i$ ã€‚å¯ä»¥ä¿®æ”¹æ¯ä¸ªç‚¹çš„æƒå€¼ä¸ºä»»æ„å®æ•°ï¼Œå…¶ä»£ä»·å‡ä¸ºç»™å®šçš„æ­£æ•´æ•° $K$ ï¼Œä½†éœ€ä¿è¯ä»»ä¸¤ç‚¹æƒå€¼ä»äº’ä¸ç›¸åŒã€‚\nç°æ±‚ä¸Šæ–‡æ‰€è¿°äºŒå‰æ ‘ä¸­ï¼Œå…¶ $\\sum^n _{i = 1}{E_i} + \\sum K$ çš„æœ€å°å€¼ã€‚\nåŸæ–‡æè¿°ï¼š\nå·²çŸ¥ä¸€æ£µç‰¹æ®Šçš„äºŒå‰æŸ¥æ‰¾æ ‘ã€‚æ ¹æ®å®šä¹‰ï¼Œè¯¥äºŒå‰æŸ¥æ‰¾æ ‘ä¸­æ¯ä¸ªç»“ç‚¹çš„æ•°æ®å€¼éƒ½æ¯”å®ƒå·¦å„¿å­ç»“ç‚¹çš„æ•°æ®å€¼å¤§ï¼Œè€Œæ¯”å®ƒå³å„¿å­ç»“ç‚¹çš„æ•°æ®å€¼å°ã€‚\nå¦ä¸€æ–¹é¢ï¼Œè¿™æ£µæŸ¥æ‰¾æ ‘ä¸­æ¯ä¸ªç»“ç‚¹éƒ½æœ‰ä¸€ä¸ªæƒå€¼ï¼Œæ¯ä¸ªç»“ç‚¹çš„æƒå€¼éƒ½æ¯”å®ƒçš„å„¿å­ç»“ç‚¹çš„æƒå€¼è¦å°ã€‚\nå·²çŸ¥æ ‘ä¸­æ‰€æœ‰ç»“ç‚¹çš„æ•°æ®å€¼å„ä¸ç›¸åŒï¼›æ‰€æœ‰ç»“ç‚¹çš„æƒå€¼ä¹Ÿå„ä¸ç›¸åŒã€‚è¿™æ—¶å¯å¾—å‡ºè¿™æ ·ä¸€ä¸ªæœ‰è¶£çš„ç»“è®ºï¼šå¦‚æœèƒ½å¤Ÿç¡®å®šæ ‘ä¸­æ¯ä¸ªç»“ç‚¹çš„æ•°æ®å€¼å’Œæƒå€¼ï¼Œé‚£ä¹ˆæ ‘çš„å½¢æ€ä¾¿å¯ä»¥å”¯ä¸€ç¡®å®šã€‚å› ä¸ºè¿™æ ·çš„ä¸€æ£µæ ‘å¯ä»¥çœ‹æˆæ˜¯æŒ‰ç…§æƒå€¼ä»å°åˆ°å¤§é¡ºåºæ’å…¥ç»“ç‚¹æ‰€å¾—åˆ°çš„ã€æŒ‰ç…§æ•°æ®å€¼æ’åºçš„äºŒå‰æŸ¥æ‰¾æ ‘ã€‚\nä¸€ä¸ªç»“ç‚¹åœ¨æ ‘ä¸­çš„æ·±åº¦å®šä¹‰ä¸ºå®ƒåˆ°æ ‘æ ¹çš„è·ç¦»åŠ 1ã€‚å› æ­¤æ ‘çš„æ ¹ç»“ç‚¹çš„æ·±åº¦ä¸º1ã€‚\næ¯ä¸ªç»“ç‚¹é™¤äº†æ•°æ®å€¼å’Œæƒå€¼ä»¥å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªè®¿é—®é¢‘åº¦ã€‚æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªç»“ç‚¹åœ¨æ ‘ä¸­çš„è®¿é—®ä»£ä»·ä¸ºå®ƒçš„è®¿é—®é¢‘åº¦ä¹˜ä»¥å®ƒåœ¨æ ‘ä¸­çš„æ·±åº¦ã€‚æ•´æ£µæ ‘çš„è®¿é—®ä»£ä»·å®šä¹‰ä¸ºæ‰€æœ‰ç»“ç‚¹åœ¨æ ‘ä¸­çš„è®¿é—®ä»£ä»·ä¹‹å’Œã€‚\nç°åœ¨ç»™å®šæ¯ä¸ªç»“ç‚¹çš„æ•°æ®å€¼ã€æƒå€¼å’Œè®¿é—®é¢‘åº¦ï¼Œä½ å¯ä»¥æ ¹æ®éœ€è¦ä¿®æ”¹æŸäº›ç»“ç‚¹çš„æƒå€¼ï¼Œä½†æ¯æ¬¡ä¿®æ”¹ä½ ä¼šä»˜å‡ºKçš„é¢å¤–ä¿®æ”¹ä»£ä»·ã€‚ä½ å¯ä»¥æŠŠç»“ç‚¹çš„æƒå€¼æ”¹ä¸ºä»»ä½•å®æ•°ï¼Œä½†æ˜¯ä¿®æ”¹åæ‰€æœ‰ç»“ç‚¹çš„æƒå€¼å¿…é¡»ä»ä¿æŒäº’ä¸ç›¸åŒã€‚ç°åœ¨ä½ è¦è§£å†³çš„é—®é¢˜æ˜¯ï¼Œæ•´æ£µæ ‘çš„è®¿é—®ä»£ä»·ä¸é¢å¤–ä¿®æ”¹ä»£ä»·çš„å’Œæœ€å°æ˜¯å¤šå°‘ï¼Ÿ\né“¾æ¥ Luogu P1864\né¢˜è§£ æ¯”è¾ƒç®€å•çš„åŒºé—´dpã€‚\né¦–å…ˆå¯¹ç‚¹çš„æƒå€¼ç¦»æ•£åŒ–ï¼Œç„¶åæŒ‰ç…§ç‚¹çš„æ•°æ®å€¼æ’åºã€‚æ³¨æ„åˆ°ç‚¹çš„é¡ºåºæ˜¯ç¡®å®šçš„ï¼Œæ‰€ä»¥å¦‚æœç»™å®šåŒºé—´ $[l,r]$ ä»¥åŠå…¶æ ¹èŠ‚ç‚¹èƒ½å–åˆ°çš„æœ€å¤§çš„æƒå€¼ $p$ ï¼Œå°±å¯ä»¥ç¡®å®šè¿™ä¸ªæœ€å°å€¼ã€‚è¿™ä¸ªé—®é¢˜è¿˜æ»¡è¶³å±€éƒ¨æœ€ä¼˜è§£ï¼Œæ‰€ä»¥æä¸€æ $dp$ å°±å¯ä»¥äº†ã€‚å®šä¹‰ $w(i,j)= \\sum_{k = i}^j {T_i}$ ã€‚è½¬ç§»æ–¹ç¨‹å¦‚ä¸‹ï¼š\n$$\nm(l,r,p) = 0; (l \\geq r),\n$$\n$$\n\\min_{k = l}^r{(, m(l,k-1,p)+m(k+1,r,p)+ K), ;\nm(l,k-1,P_k)+m(k+1,r,P_k))+w(i,j) ; ;(l \u0026lt; r)}\n$$\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;algorithm\u0026gt;#define pp node using namespace std; const int MAXN = 80; int n,K; int sum[MAXN],num[MAXN]; int dp[MAXN][MAXN][MAXN]; struct node{ int fr,sc,tr; bool operator \u0026lt; (const node a)const{ return fr \u0026lt; a.fr; } }; void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;K); pp tmp[MAXN];int t[MAXN]; for(int i = 1;i\u0026lt;=n;i++) scanf(\u0026#34;%d\u0026#34;,\u0026amp;tmp[i].fr); for(int i = 1;i\u0026lt;=n;i++){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;tmp[i].sc); t[i] = tmp[i].sc; } for(int i = 1;i\u0026lt;=n;i++) scanf(\u0026#34;%d\u0026#34;,\u0026amp;tmp[i].tr); sort(tmp+1,tmp+n+1),sort(t+1,t+n+1); for(int i = 1;i\u0026lt;=n;i++){ num[i] = lower_bound(t+1,t+n+1,tmp[i].sc)-t; sum[i] = sum[i-1]+tmp[i].tr; } } void solve(){ int tmp; for(int w = 1;w\u0026lt;=n;w++){ for(int l = 1,r = w;r\u0026lt;=n;l++,r++){ for(int p = 0;p\u0026lt;=n;p++){ dp[l][r][p] = 0x3f3f3f3f; for(int k = l;k\u0026lt;=r;k++){ tmp = min(dp[l][k-1][p] + dp[k+1][r][p] + K, num[k] \u0026gt; p? dp[l][k-1][num[k]] + dp[k+1][r][num[k]]: 0x3f3f3f3f); dp[l][r][p] = min(dp[l][r][p],tmp); } dp[l][r][p] += sum[r] - sum[l-1]; } } } printf(\u0026#34;%d\\n\u0026#34;,dp[1][n][0]); } int main(){ init(); solve(); return 0; }   ","description":"","id":188,"section":"posts","tags":["åŠ¨æ€è§„åˆ’","å¹³è¡¡æ ‘"],"title":"ã€ŒNOI2009ã€äºŒå‰æŸ¥æ‰¾æ ‘-åŒºé—´dp","uri":"https://blog.chenqiqian.com/posts/noi2009-binary/"},{"content":"lxhgww æœ€è¿‘è¿·ä¸Šäº†ä¸€æ¬¾æ¸¸æˆï¼Œåœ¨æ¸¸æˆé‡Œï¼Œä»–æ‹¥æœ‰ $n$ ä¸ªè£…å¤‡ï¼ˆ $n \\le 1000000$ ï¼‰ï¼Œæ¯ç§è£…å¤‡éƒ½æœ‰ $2$ ä¸ªå±æ€§ï¼Œè¿™äº›å±æ€§çš„å€¼ç”¨ $[1,10000]$ ä¹‹é—´çš„æ•°è¡¨ç¤ºã€‚å½“ä»–ä½¿ç”¨æŸç§è£…å¤‡æ—¶ï¼Œä»–åªèƒ½ä½¿ç”¨è¯¥è£…å¤‡çš„æŸä¸€ä¸ªå±æ€§ã€‚å¹¶ä¸”æ¯ç§è£…å¤‡æœ€å¤šåªèƒ½ä½¿ç”¨ä¸€æ¬¡ã€‚\næ¸¸æˆè¿›è¡Œåˆ°æœ€åï¼Œ lxhgww é‡åˆ°äº†ç»ˆæ boss ï¼Œè¿™ä¸ªç»ˆæ boss å¾ˆå¥‡æ€ªï¼Œæ”»å‡»ä»–çš„è£…å¤‡æ‰€ä½¿ç”¨çš„å±æ€§å€¼å¿…é¡»ä» $1$ å¼€å§‹è¿ç»­é€’å¢åœ°æ”»å‡»ï¼Œæ‰èƒ½å¯¹ boss äº§ç”Ÿä¼¤å®³ã€‚ç°åœ¨lxhgwwæƒ³çŸ¥é“ä»–æœ€å¤šèƒ½è¿ç»­æ”»å‡» boss å¤šå°‘æ¬¡ï¼Ÿ\né“¾æ¥ Luogu P1640\né¢˜è§£ upd on 2019.4.5 è¿™æ˜¯ä¸ªå‡åšæ³•ã€‚\nå¯ä»¥çœ‹å‡ºï¼Œè¿™ä¸ªä¸œè¥¿å¯ä»¥è½¬æ¢æˆäºŒåˆ†å›¾çš„æ¨¡ç‰ˆã€‚å·¦è¾¹çš„ $10000$ ä¸ªç‚¹ä»£è¡¨å±æ€§å€¼ï¼Œå³è¾¹çš„ $n$ ä¸ªç‚¹ä»£è¡¨è£…å¤‡ã€‚\nä»å±æ€§å€¼ $1$ å¼€å§‹è·‘åŒˆç‰™åˆ©çš„ $dfs$ ï¼Œå¦‚æœèƒ½å¢å¹¿ï¼Œå°±æ¥ç€å¾€ä¸‹ã€‚ä¸èƒ½çš„è¯ï¼Œè¾“å‡ºç­”æ¡ˆè¿”å›ã€‚å¤æ‚åº¦ä¸å¤ªä¼šç®—\u0026hellip;ä¸è¿‡å¯ä»¥è¿‡çš„ã€‚\nå€¼å¾—ä¸€æçš„æ˜¯ï¼Œç½‘ç»œæµè™½ç„¶æˆ‘æ¯æ¬¡ç›´æ¥åœ¨æ®‹é‡ç½‘ç»œä¸Šå¢å¹¿\u0026hellip;ä½†ä»ç„¶æ…¢çš„è¦æ­»\u0026hellip;$40$åˆ†TLEå†ä¹Ÿä¼˜åŒ–ä¸äº†äº†\u0026hellip;\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cstring\u0026gt;#include \u0026lt;cctype\u0026gt;using namespace std; const int MAXN = 2000000,MAXM = 5000000; namespace fast_io { //... }using namespace fast_io; struct Edge{ int from,to; int nex; }edge[MAXM]; int fir[MAXN],ecnt = 1; void addedge(int a,int b){ edge[ecnt] = (Edge){a,b,fir[a]}; fir[a] = ecnt++; } int n,a,b; int pre[1100000],vis[11000]; void init(){ read(n); for(int i = 1;i\u0026lt;=n;i++){ read(a),read(b); addedge(a,100000+i),addedge(b,100000+i);\t} } bool dfs(int nown){ if(vis[nown]) return 0; vis[nown] = 1; for(int nowe = fir[nown];nowe;nowe = edge[nowe].nex){ int v = edge[nowe].to; if(!pre[v] || dfs(pre[v])){ pre[v] = nown; return 1; } } return 0; } void solve(){ int ans = 0; for(int i = 1;i\u0026lt;=10000;i++){ memset(vis,0,sizeof(vis)); if(dfs(i)) ans++; else break; } print(ans); } int main(){ init(); solve(); flush(); return 0; }   ","description":"","id":189,"section":"posts","tags":["å›¾è®º","äºŒåˆ†å›¾åŒ¹é…"],"title":"ã€ŒSCOI2010ã€è¿ç»­æ”»å‡»æ¸¸æˆ-äºŒåˆ†å›¾åŒ¹é…","uri":"https://blog.chenqiqian.com/posts/scoi2010-game/"},{"content":"ç§‹ä¹‹å›½å…±æœ‰ $n$ ä¸ªäººï¼Œåˆ†åˆ«ç¼–å·ä¸º $1,2,\u0026hellip;,n$ ï¼Œä¸€å¼€å§‹æ¯ä¸ªäººéƒ½æŠ•äº†ä¸€ç¥¨ï¼ŒèŒƒå›´ $[1,n]$ ï¼Œè¡¨ç¤ºæ”¯æŒå¯¹åº”ç¼–å·çš„äººå½“æ€»ç»Ÿã€‚å…±æœ‰ $m$ æ¬¡é¢„é€‰ï¼Œæ¯æ¬¡é€‰å–ç¼–å· $[l_i,r_i]$ å†…çš„é€‰æ°‘å±•å¼€å°è§„æ¨¡é¢„é€‰ï¼Œåœ¨è¯¥åŒºé—´å†…è·å¾—è¶…è¿‡åŒºé—´å¤§å°ä¸€åŠçš„ç¥¨çš„äººè·èƒœï¼Œå¦‚æœæ²¡æœ‰äººè·èƒœï¼Œåˆ™ç”±å° C é’¦å®šä¸€ä½å€™é€‰è€…è·å¾—æ­¤æ¬¡é¢„é€‰çš„èƒœåˆ©ï¼ˆè·èƒœè€…å¯ä»¥ä¸åœ¨è¯¥åŒºé—´å†…ï¼‰ï¼Œæ¯æ¬¡é¢„é€‰çš„ç»“æœéœ€è¦å…¬å¸ƒå‡ºæ¥ï¼Œå¹¶ä¸”æ¯æ¬¡ä¼šæœ‰ $k_i$ ä¸ªäººå†³å®šå°†ç¥¨æ”¹æŠ•å‘è¯¥æ¬¡é¢„é€‰çš„è·èƒœè€…ã€‚å…¨éƒ¨é¢„é€‰ç»“æŸåï¼Œå…¬å¸ƒæœ€åæˆä¸ºæ€»ç»Ÿçš„å€™é€‰äººï¼Œæ²¡æœ‰å€™é€‰äººçš„è¯è¾“å‡º $-1$ ã€‚\né“¾æ¥ Luogu P3765\né¢˜è§£ éå¸¸æœ‰è¶£çš„ä¸€é“é¢˜ã€‚\nBZOJçš„2456å¯ä»¥å¯å‘åˆ°è¿™é“é¢˜ã€‚\né‚£é“é¢˜æ˜¯ï¼š\n ç»™ä½ ä¸€ä¸ª $n$ ä¸ªæ•°çš„æ•°åˆ—ï¼Œå…¶ä¸­æŸä¸ªæ•°å‡ºç°äº†è¶…è¿‡ $\\frac {n}{2}$ æ¬¡å³ä¸ºç»å¯¹ä¼—æ•°ï¼Œè¯·ä½ æ‰¾å‡ºé‚£ä¸ªæ•°ã€‚\n åšæ³•åˆ™æ˜¯:\n å¦‚æœä¼—æ•°å‡ºç°äº†è¶…è¿‡ $\\frac {n}{2}$ æ¬¡ï¼Œé‚£ä¹ˆä»»æ„åˆ é™¤åºåˆ—ä¸­çš„ä¸¤ä¸ªä¸åŒçš„æ•°ï¼Œä¼—æ•°çš„å‡ºç°æ¬¡æ•°ä»ç„¶è¶…è¿‡ä¸€åŠã€‚ä¸åœåœ°è¿›è¡Œä¸‹å»ï¼Œæœ€ç»ˆå‰©ä¸‹çš„ä¸€ä¸ªæ•°å³ä¸ºä¼—æ•°ã€‚(æ‘˜è‡ªMenci\u0026rsquo;s Blog)\n è¿™ä»¶äº‹æ˜¯å¯ä»¥ç”¨çº¿æ®µæ ‘ç»´æŠ¤çš„ã€‚\næ‰€ä»¥å¯ä»¥ç”¨çº¿æ®µæ ‘ç»´æŠ¤è¿™ä¸ªä¿¡æ¯ï¼Œå°±å¯ä»¥åœ¨ $O(\\log {n})$ çš„æ—¶é—´é‡ŒæŸ¥è¯¢åˆ°æŸä¸ªåŒºé—´å¯èƒ½çš„åŒºé—´ç»å¯¹ä¼—æ•°ã€‚å¯ä»¥è¯æ˜ï¼Œå¦‚æœåŒºé—´æœ‰ç»å¯¹ä¼—æ•°ï¼Œé‚£ä¹ˆè¿™ä¸ªæ•°ä¸€å®šå°±æ˜¯ã€‚ä½†æ˜¯ä¹Ÿå¯ä»¥å‘ç°ï¼Œè¿™ä¸ªæ•°ä¸ä¸€å®šå°±æ˜¯ç»å¯¹ä¼—æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ£€éªŒã€‚\nè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å»ºç«‹ $n$ æ£µå¹³è¡¡æ ‘ï¼Œå…±ç”¨ä¸€ä¸ª $pool$ ã€‚æˆ‘ä»¬å¯ä»¥ç›´æ¥ç”¨æ•°ç»„ä¸­çš„èŠ‚ç‚¹ç¼–å·æ¥ä»£è¡¨å®ƒçš„ $val$ ã€‚æ£€éªŒçš„æ—¶å€™ï¼Œæ‰¾åˆ°å¾…æŸ¥è¯¢æ•°å­—çš„æ ¹èŠ‚ç‚¹ï¼Œç„¶åæŸ¥è¯¢åœ¨ $[l,r]$ åŒºé—´å†…æœ‰å¤šå°‘ä¸ªæ•°ï¼Œä¹Ÿå°±æ˜¯ $getrank(r+1) - getrank(l)$ ã€‚ç„¶åå°±å¯ä»¥æ£€éªŒå‡ºç»™å®šçš„æ•°æ˜¯ä¸æ˜¯ç»™å®šçš„åŒºé—´çš„ç»å¯¹ä¼—æ•°äº†ã€‚\nä¿®æ”¹æŠ•ç¥¨ä¹Ÿå¾ˆç®€å•ï¼Œçº¿æ®µæ ‘ç›´æ¥ä¿®æ”¹ç„¶åä¸€è·¯ç»´æŠ¤å°±å¥½ï¼Œå¹³è¡¡æ ‘çš„è¯å°±åœ¨æ—§æ ‘é‡Œåˆ æ‰ï¼Œæ–°æ ‘é‡ŒåŠ ä¸Šå°±å¯ä»¥äº†ã€‚\næ—¶é—´å¤æ‚åº¦å¤§æ¦‚æ˜¯\n$$O((n+\\sum_{i = 1}^{n} {k_i}) \\log {n})$$\nå¯ä»¥è¿‡æ‰æœ¬é¢˜ã€‚\n å¦™å•Šï¼\n ä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cctype\u0026gt;#include \u0026lt;cstdlib\u0026gt;#include \u0026lt;algorithm\u0026gt;using namespace std; namespace fast_io { //... }using namespace fast_io; const int MAXN = 550000; int n,m,num[MAXN]; //å¹³è¡¡æ ‘ namespace Treap{ int nowcnt = 0; int p[MAXN],son[MAXN][2]; int siz[MAXN]; int root[MAXN]; void update(int x){ siz[x] = siz[son[x][0]] + siz[son[x][1]] + 1; } void rotate(int \u0026amp;x,int t){ int y = son[x][t]; son[x][t] = son[y][1-t]; son[y][1-t] = x; update(x),update(y); x = y; } void insert(int \u0026amp;x,int v){ if(!x){ x = v,p[x] = rand(); } else{ int t = v \u0026gt; x; insert(son[x][t],v); if(p[son[x][t]] \u0026lt; p[x]) rotate(x,t); } update(x); } void erase(int \u0026amp;x,int v){ if(x == v){ if(!son[x][0] \u0026amp;\u0026amp; !son[x][1]){ x = 0;return; } int t = p[son[x][0]] \u0026gt; p[son[x][1]]; rotate(x,t); erase(x,v); } else{ erase(son[x][v \u0026gt; x],v); } update(x); } int grank(int r,int v){ int x = r,ans = 0; while(x){ if(v \u0026lt; x) x = son[x][0]; else if(v == x) ans += siz[son[x][0]],x = 0; else ans += siz[son[x][0]]+1,x = son[x][1]; } return ans; } void __print(int x,int dep){ if(dep == 0) printf(\u0026#34;%d:-------------------\\n\u0026#34;,x); if(x == 0) return; __print(son[x][0],dep+1); for(int i = 0;i\u0026lt;dep;i++) putchar(\u0026#39; \u0026#39;); printf(\u0026#34;v:%d p:%d siz:%d son:%d %d\\n\u0026#34;,x,p[x],siz[x],son[x][0],son[x][1]); __print(son[x][1],dep+1); if(dep == 0) printf(\u0026#34;---------------------\\n\u0026#34;); } bool check(int num,int l,int r){ return 2*(grank(root[num],r+1)-grank(root[num],l)) \u0026gt; r-l+1; } void update(int pos,int last,int now){ erase(root[last],pos); insert(root[now],pos); } void init(int *a){ p[0] = 2147483647; for(int i = 1;i\u0026lt;=n;i++) insert(root[a[i]],i); } } //çº¿æ®µæ ‘ namespace seg_tree{ #define lson (nown\u0026lt;\u0026lt;1) #define rson ((nown\u0026lt;\u0026lt;1)|1) #define mid ((l+r)\u0026gt;\u0026gt;1) #define pp pair\u0026lt;int,int\u0026gt; #define fr first #define sc second pp tree[MAXN\u0026lt;\u0026lt;2]; pp merge(pp a,pp b){ pp ans; if(a.fr == b.fr) ans.fr = a.fr,ans.sc = a.sc + b.sc; else{ ans.fr = a.sc \u0026gt; b.sc?a.fr:b.fr; ans.sc = a.sc - b.sc; if(ans.sc \u0026lt; 0) ans.sc *= -1; } return ans; } void update(int nown){ tree[nown] = merge(tree[lson],tree[rson]); } void build(int nown,int l,int r,int *a){ if(l == r){ tree[nown] = make_pair(a[l],1); return; } build(lson,l,mid,a); build(rson,mid+1,r,a); update(nown); } pp query(int nown,int l,int r,int ql,int qr){ if(ql \u0026lt;= l \u0026amp;\u0026amp; r \u0026lt;= qr) return tree[nown]; else{ pp ans; if(ql \u0026lt;= mid \u0026amp;\u0026amp; mid+1 \u0026lt;= qr) ans = merge(query(lson,l,mid,ql,qr),query(rson,mid+1,r,ql,qr)); else if(ql \u0026lt;= mid) ans = query(lson,l,mid,ql,qr); else if(mid+1 \u0026lt;= qr) ans = query(rson,mid+1,r,ql,qr); return ans; } } void update(int nown,int l,int r,int pos,int val){ if(l == r) tree[nown] = make_pair(val,1); else{ if(pos\u0026lt;=mid) update(lson,l,mid,pos,val); if(pos\u0026gt;=mid+1) update(rson,mid+1,r,pos,val); update(nown); } } } void init(){ read(n),read(m); for(int i = 1;i\u0026lt;=n;i++) read(num[i]); seg_tree::build(1,1,n,num); Treap::init(num); } void solve(){ int l,r,s,k,t,win; for(int i = 1;i\u0026lt;=m;i++){ read(l),read(r),read(s),read(k); win = seg_tree::query(1,1,n,l,r).first; win = Treap::check(win,l,r)? win:s; for(int i = 1;i\u0026lt;=k;i++){ read(t); Treap::update(t,num[t],win); seg_tree::update(1,1,n,t,win); num[t] = win; } print(win),print(\u0026#39;\\n\u0026#39;); } win = seg_tree::query(1,1,n,1,n).first; win = Treap::check(win,1,n)?win:-1; print(win),print(\u0026#39;\\n\u0026#39;); } int main(){ init(); solve(); flush(); return 0; }   ","description":"","id":190,"section":"posts","tags":["æ•°æ®ç»“æ„","å¹³è¡¡æ ‘","çº¿æ®µæ ‘"],"title":"ã€ŒLuogu3765ã€æ€»ç»Ÿé€‰ä¸¾-å¹³è¡¡æ ‘-çº¿æ®µæ ‘","uri":"https://blog.chenqiqian.com/posts/luogu-3765/"},{"content":"æœ‰ä¸€ä¸ª $n$ è¡Œ $m$ åˆ—çš„é»‘ç™½æ£‹ç›˜ï¼Œä½ æ¯æ¬¡å¯ä»¥äº¤æ¢ä¸¤ä¸ªç›¸é‚»æ ¼å­ï¼ˆç›¸é‚»æ˜¯æŒ‡æœ‰å…¬å…±è¾¹æˆ–å…¬å…±é¡¶ç‚¹ï¼‰ä¸­çš„æ£‹å­ï¼Œæœ€ç»ˆè¾¾åˆ°ç›®æ ‡çŠ¶æ€ã€‚è¦æ±‚ç¬¬ $i$ è¡Œç¬¬ $j$ åˆ—çš„æ ¼å­åªèƒ½å‚ä¸ $m_{i,j}$ æ¬¡äº¤æ¢ã€‚\nè¾“å‡ºä»…ä¸€è¡Œï¼Œä¸ºæœ€å°äº¤æ¢æ€»æ¬¡æ•°ã€‚å¦‚æœæ— è§£ï¼Œè¾“å‡º $-1$ ã€‚\né“¾æ¥ Luogu P3159\né¢˜è§£ æ¯”è¾ƒéš¾ä»¥å®ç°çš„æ˜¯å¯¹äº¤æ¢æ¬¡æ•°çš„é™åˆ¶ã€‚æ³¨æ„åˆ°å¦‚æœä¸€ä¸ªç‚¹æ˜¯èµ·ç‚¹æˆ–è€…ç»ˆç‚¹ï¼Œé‚£ä¹ˆå®ƒçš„äº¤æ¢æ¬¡æ•°åº”å½“æ˜¯å¥‡æ•°ï¼Œå…¶ä½™çš„éƒ½æ˜¯å¶æ•°ï¼Œè€Œä¸”æ˜¯ç»è¿‡è¿™ä¸ªç‚¹çš„æ£‹å­æ•°ç›®çš„ä¸¤å€ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŒ‰ç…§å¦‚ä¸‹æ–¹æ³•å»ºå›¾ï¼š\nå¯¹äºæ£‹ç›˜ä¸Šçš„æ¯ä¸ªç‚¹ï¼Œæˆ‘ä»¬æŠŠå®ƒæ‹†æˆä¸‰ä¸ªç‚¹ï¼š$A_{i,j},B_{i,j},C_{i,j}$ ã€‚\nå¯¹äºä¸€ä¸ªæ—¢æ˜¯èµ·ç‚¹ä¹Ÿæ˜¯ç»ˆç‚¹çš„ç‚¹æˆ–è€…æ—¢ä¸æ˜¯èµ·ç‚¹ä¹Ÿä¸æ˜¯ç»ˆç‚¹çš„ç‚¹ï¼Œæˆ‘ä»¬ä» $A_{i,j}$ å‘ $C_{i,j}$ å’Œ $C_{i,j}$ å‘ $B_{i,j}$ è¿ä¸€æ¡å®¹é‡æ˜¯ $\\lfloor \\frac {m_{i,j}}{2} \\rfloor$ ï¼Œè´¹ç”¨ä¸º $0$ çš„è¾¹ã€‚\nå¯¹äºä¸€ä¸ªåªæ˜¯èµ·ç‚¹çš„ç‚¹ï¼Œæˆ‘ä»¬ä»èµ·ç‚¹ $S$ å‘ $C_{i,j}$ è¿ä¸€æ¡å®¹é‡ä¸º $1$ ï¼Œè´¹ç”¨ä¸º $0$ çš„è¾¹ã€‚ä» $A_{i,j}$ å‘ $C_{i,j}$ è¿ä¸€æ¡å®¹é‡æ˜¯ $\\lfloor \\frac {m_{i,j} , -1}{2} \\rfloor$ ï¼Œè´¹ç”¨ä¸º $0$ çš„è¾¹ã€‚ä» $C_{i,j}$ å‘ $B_{i,j}$ è¿ä¸€æ¡å®¹é‡æ˜¯ $\\lfloor \\frac {m_{i,j} , -1}{2} +1 \\rfloor$ ï¼Œè´¹ç”¨ä¸º $0$ çš„è¾¹ã€‚\nå¯¹äºä¸€ä¸ªåªæ˜¯ç»ˆç‚¹çš„ç‚¹ï¼Œæˆ‘ä»¬åè¿‡æ¥å°±å¯ä»¥äº†ã€‚\nè¿˜éœ€è¦ä» $C_{i,j}$ å‘ $B_{i,j-1},B_{i-1,j+1}\u0026hellip;$ ï¼Œä¹Ÿå°±æ˜¯å‘¨å›´çš„å…«ä¸ªç‚¹è¿ä¸€æ¡å®¹é‡æ˜¯ $+\\infty$ ,è´¹ç”¨æ˜¯ $1$ çš„è¾¹ã€‚\næ˜¾ç„¶è¿™æ ·å¯ä»¥ä¿è¯ä¸ªç‚¹çš„äº¤æ¢æ¬¡æ•°ä¸è¶…è¿‡ $m_{i,j}$ ã€‚ç„¶åæˆ‘ä»¬æ±‚å‡ºèµ·ç‚¹ $S$ åˆ°ç»ˆç‚¹ $T$ æœ€å°è´¹ç”¨æœ€å¤§æµï¼Œå¦‚æœæ»¡æµæœ‰è§£ï¼Œä¸æ»¡æµå°±æ— è§£ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;queue\u0026gt;#include \u0026lt;cstring\u0026gt;#include \u0026lt;algorithm\u0026gt;using namespace std; const int MAXN = 5000,MAXM = 500000; struct Edge{ int from,to; int cap,flow; int cost,nex; }edge[MAXM]; int n,m,s,t; int fir[MAXN],ecnt = 2,maxf = 0; int dis[MAXN],instack[MAXN],pree[MAXN]; int b[25][25],e[25][25],num[25][25]; queue\u0026lt;int\u0026gt; q; int tr(int a,int b){ if(a == 0 || b == 0 || a\u0026gt;n||b\u0026gt;m) return -1; return (a-1)*m+b; } void addedge(int a,int b,int c,int d){ if(a \u0026lt;= 0 || b \u0026lt;= 0 || c == 0) return; edge[ecnt] = (Edge){a,b,c,0,d,fir[a]}; fir[a] = ecnt++; edge[ecnt] = (Edge){b,a,0,0,-d,fir[b]}; fir[b] = ecnt++; } bool spfa(){ memset(dis,0x3f,sizeof(dis)); memset(instack,0,sizeof(instack)); while(!q.empty()) q.pop(); dis[s] = 0;q.push(s); while(!q.empty()){ int nown = q.front();q.pop(); instack[nown] = 0; for(int nowe = fir[nown];nowe;nowe = edge[nowe].nex){ Edge e = edge[nowe]; if(dis[e.to] \u0026gt; dis[nown] + e.cost \u0026amp;\u0026amp; e.cap \u0026gt; e.flow){ dis[e.to] = dis[nown] + e.cost; pree[e.to] = nowe; if(instack[e.to] == 0){ q.push(e.to); instack[e.to] = 1; } } } } return dis[t] \u0026lt; 0x3f3f3f3f; } void argument(int \u0026amp;sumf,int \u0026amp;sumc){ int nown = t,limit = 0x3f3f3f3f,nowe; while(nown!=s){ nowe = pree[nown]; limit = min(limit,edge[nowe].cap - edge[nowe].flow); nown = edge[nowe].from; } nown = t; while(nown!=s){ nowe = pree[nown]; edge[nowe].flow += limit,edge[nowe^1].flow -= limit; nown = edge[nowe].from; } sumf += limit,sumc += limit * dis[t]; } void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m);s = 1,t = 2; char tmp[50]; for(int i = 1;i\u0026lt;=n;i++){ scanf(\u0026#34;%s\u0026#34;,tmp); for(int j = 1;j\u0026lt;=m;j++) b[i][j] = tmp[j-1]^48; } for(int i = 1;i\u0026lt;=n;i++){ scanf(\u0026#34;%s\u0026#34;,tmp); for(int j = 1;j\u0026lt;=m;j++) e[i][j] = tmp[j-1]^48; } for(int i = 1;i\u0026lt;=n;i++){ scanf(\u0026#34;%s\u0026#34;,tmp); for(int j = 1;j\u0026lt;=m;j++) num[i][j] = tmp[j-1]^48; } } void build(){ int bb = 0,ee = 0; for(int i = 1;i\u0026lt;=n;i++){ for(int j = 1;j\u0026lt;=m;j++){ int tmp = tr(i,j); if(b[i][j] \u0026amp;\u0026amp; !e[i][j]){ num[i][j]-=1; addedge(3*tmp+1,3*tmp+3,num[i][j]/2,0); addedge(3*tmp+3,3*tmp+2,num[i][j]/2+1,0); addedge(s,3*tmp+3,1,0); maxf = max(maxf,++bb); } else if(e[i][j] \u0026amp;\u0026amp; !b[i][j]){ num[i][j]-=1; addedge(3*tmp+1,3*tmp+3,num[i][j]/2+1,0); addedge(3*tmp+3,3*tmp+2,num[i][j]/2,0); addedge(3*tmp+3,t,1,0); maxf = max(maxf,++ee); } else{ addedge(3*tmp+1,3*tmp+3,num[i][j]/2,0); addedge(3*tmp+3,3*tmp+2,num[i][j]/2,0); } addedge(3*tmp+2,3*tr(i-1,j-1)+1,100000,1); addedge(3*tmp+2,3*tr(i+1,j+1)+1,100000,1); addedge(3*tmp+2,3*tr(i+1,j-1)+1,100000,1); addedge(3*tmp+2,3*tr(i-1,j+1)+1,100000,1); addedge(3*tmp+2,3*tr(i,j-1)+1,100000,1); addedge(3*tmp+2,3*tr(i,j+1)+1,100000,1); addedge(3*tmp+2,3*tr(i+1,j)+1,100000,1); addedge(3*tmp+2,3*tr(i-1,j)+1,100000,1); } } } void solve(){ int f = 0,c = 0; while(spfa()) argument(f,c); if(f!=maxf) printf(\u0026#34;-1\u0026#34;); else printf(\u0026#34;%d\\n\u0026#34;,c); } int main(){ init(); build(); solve(); return 0; }   ","description":"","id":191,"section":"posts","tags":["å›¾è®º","è´¹ç”¨æµ"],"title":"ã€ŒCQOI2012ã€äº¤æ¢æ£‹å­-è´¹ç”¨æµ","uri":"https://blog.chenqiqian.com/posts/cqoi2012-chess/"},{"content":"æœ‰ä¸€é¢— $n$ï¼ˆ$n\u0026lt;20000$ï¼‰ä¸ªèŠ‚ç‚¹çš„æ ‘ï¼Œæ¯æ¡è¾¹éƒ½æœ‰è¾¹æƒã€‚æ¥ä¸‹æ¥ç”±èªèªå’Œå¯å¯åˆ†åˆ«éšå³é€‰ä¸€ä¸ªç‚¹ï¼Œå¦‚æœä¸¤ç‚¹ä¹‹é—´ç®€å•è·¯å¾„ä¸Šçš„è¾¹æƒå’Œæ˜¯ $3$ çš„å€æ•°ï¼Œåˆ™åˆ¤èªèªèµ¢ï¼Œå¦åˆ™å¯å¯èµ¢ã€‚\nèªèªéå¸¸çˆ±æ€è€ƒé—®é¢˜ï¼Œå¸Œæœ›çŸ¥é“å¯¹äºè¿™å¼ å›¾è‡ªå·±çš„è·èƒœæ¦‚ç‡æ˜¯å¤šå°‘ã€‚\né“¾æ¥ Luogu P2634\né¢˜è§£ ç‚¹åˆ†æ²»æ¯”è¾ƒæ¨¡ç‰ˆçš„ä¸€é“é¢˜å§ã€‚\næ ‘ä¸Šçš„è·¯å¾„é—®é¢˜ï¼Œä¹Ÿå¯ä»¥æç¤ºæˆ‘ä»¬ç‚¹åˆ†æ²»ã€‚\næ‰€ä»¥é—®é¢˜è½¬åŒ–ä¸ºï¼šæ€ä¹ˆåœ¨ $O(n)$ æˆ–è€… $O(n \\log{n})$ çš„æ—¶é—´å†…æ±‚å‡ºè¿‡ä¸€ä¸ªç‚¹çš„æ‰€æœ‰ï¼Œèµ·ç‚¹ç»ˆç‚¹ä¸åœ¨åŒä¸€å­æ ‘ä¸­ï¼Œè¾¹æƒå’Œä¸º$3$çš„å€æ•°çš„è·¯å¾„ä¸ªæ•°ã€‚\näº‹å®ä¸Šï¼Œæˆ‘ä»¬å‘ç°ï¼Œè¿™ä¸ªé—®é¢˜ä¸éš¾è§£å†³ã€‚å¦‚æœåªæœ‰ç»è¿‡ä¸€ä¸ªç‚¹è¿™ä¸ªæ¡ä»¶ï¼Œé‚£ä¹ˆå°±å¾ˆç®€å•ï¼š dfs ä¸€éæ±‚å‡ºè¿™ä¸ªç‚¹åˆ°æ‰€æœ‰ç‚¹çš„è·ç¦»é™¤ $3$ ä½™æ•°ï¼Œç„¶å $num[0] \\times num[0] + num[1] \\times num[2] + num[2] \\times num[1]$ å³ä¸ºæ‰€æ±‚ã€‚\næ¯”è¾ƒéš¾æçš„æ˜¯ç¬¬äºŒä¸ªæ¡ä»¶ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¦æ±‚è¿™ä¸ªè·¯å¾„çš„èµ·ç‚¹å’Œç»ˆç‚¹ä¸åœ¨ä¸€ä¸ªå­æ ‘å†…ã€‚æˆ‘ä»¬å¯ä»¥è€ƒè™‘é‡‡ç”¨å®¹æ–¥åŸç†ã€‚å³å¯¹æ¯ä¸€é¢—å­æ ‘åˆ†åˆ« dfs æ±‚å‡º $3$ ä¸ª $num'$ ï¼Œç„¶åå‡å»è¿™ä¸ªå­æ ‘å†…è¿‡ä¸Šé¢æ ¹èŠ‚ç‚¹çš„è·¯å¾„ä¸ªæ•°ã€‚è¿™ä¸ªä¸ªæ•°æˆ‘ä»¬ä¸Šé¢å¥½åƒå·²ç»æ±‚è¿‡äº†ï¼Œäº‹å®ä¸Šå°±æ˜¯ $num'[0] \\times num'[0] + num'[1] \\times num'[2] + num'[2] \\times num'[1]$ ã€‚\næ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥ $O(n)$ çš„æ—¶é—´å¤„ç†å®Œè¿™ä»¶äº‹æƒ…äº†ã€‚å†åŠ ä¸Šç‚¹åˆ†æ²»ï¼Œæˆ‘ä»¬æœ€ç»ˆçš„å¤æ‚åº¦å°±æ˜¯ $O(n \\log {n})$ ã€‚\næœ‰ä¸€äº›æ¯”è¾ƒå®¹æ˜“é”™çš„åœ°æ–¹ï¼Œæ¯”å¦‚è¦æ³¨æ„å¼€å§‹çš„æ—¶å€™ $num[0]$ è¦ç½®åš $1$ ï¼Œè€Œ $num'[0]$å°±ä¸ç”¨ã€‚è¿™æ˜¯æ¯”è¾ƒæ˜¾ç„¶çš„ï¼Œç„¶è€Œæˆ‘è¿˜æ˜¯é”™äº†å¥½ä¹…\u0026hellip;è¿˜æœ‰å°±æ˜¯åœ¨åŠ è¾¹çš„æ—¶å€™å¯ä»¥å¯¹ $3$ å–æ¨¡\u0026hellip;åé¢ä¹Ÿè¦ä¸æ–­å¯¹ $3$ å–æ¨¡\u0026hellip;è¦ä¸ç„¶ä¼šç‚¸ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;algorithm\u0026gt;#define ll long long using namespace std; ll gcd(ll a,ll b){// a \u0026lt; b;  return a == 0?b:gcd(b%a,a); } const int MAXN = 110000; struct Edge{ int from,to; int len,nex; }edge[MAXN];int ecnt = 2; int fir[MAXN]; void addedge(int a,int b,int l){ edge[ecnt] = (Edge){a,b,l,fir[a]}; fir[a] = ecnt++; edge[ecnt] = (Edge){b,a,l,fir[b]}; fir[b] = ecnt++; } //----  int n,m; int f[MAXN],siz[MAXN],vis[MAXN]; int rt,sz; int num[3],tmp[3]; ll ans = 0; void getroot(int nown,int fa){ siz[nown] = 1,f[nown] = 0; for(int nowe = fir[nown];nowe;nowe = edge[nowe].nex){ int v = edge[nowe].to; if(vis[v] || v == fa) continue; getroot(v,nown); siz[nown] += siz[v]; f[nown] = max(f[nown],siz[v]); } f[nown] = max(f[nown],sz - siz[nown]); if(f[nown] \u0026lt; f[rt]) rt = nown; } void getdeep(int nown,int fa,int d){ num[d]++; for(int nowe = fir[nown];nowe;nowe = edge[nowe].nex){ int v = edge[nowe].to,l = edge[nowe].len; if(vis[v] || v == fa) continue; getdeep(v,nown,(d+l)%3); } } void work(int nown){ tmp[0] = 1;tmp[1] = tmp[2] = 0; for(int nowe = fir[nown];nowe;nowe = edge[nowe].nex){ int v = edge[nowe].to,l = edge[nowe].len; if(vis[v]) continue; num[0] = num[1] = num[2] = 0; getdeep(v,nown,l); ans -= num[0]*num[0] + 2*num[1]*num[2]; tmp[0] += num[0],tmp[1]+=num[1],tmp[2]+=num[2]; } ans += tmp[0] * tmp[0] + 2*tmp[1] * tmp[2]; } void solve(int nown){ vis[nown] = 1; work(nown); for(int nowe = fir[nown];nowe;nowe = edge[nowe].nex){ int v = edge[nowe].to; if(vis[v]) continue; f[rt = 0] = sz = siz[v]; getroot(v,rt); solve(rt); } } void init(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n); int a,b,c; for(int i = 1;i\u0026lt;=n-1;i++){ scanf(\u0026#34;%d %d %d\u0026#34;,\u0026amp;a,\u0026amp;b,\u0026amp;c); addedge(a,b,c%3); } } void solve(){ f[rt = 0] = sz = n; getroot(1,rt); solve(rt); ll ans2 = n*n; printf(\u0026#34;%lld/%lld\\n\u0026#34;,ans/gcd(ans,ans2),ans2/gcd(ans,ans2)); } int main(){ init(); solve(); return 0; }   ","description":"","id":192,"section":"posts","tags":["ç‚¹åˆ†æ²»","æ•°æ®ç»“æ„","æ ‘å½¢ç»“æ„"],"title":"ã€Œå›½å®¶é›†è®­é˜Ÿã€èªèªå¯å¯-ç‚¹åˆ†æ²»","uri":"https://blog.chenqiqian.com/posts/luogu-2634/"},{"content":"ç‚¹åˆ†æ²»æ˜¯ä¸€ç§ä¸»è¦åœ¨æ ‘ä¸Šçš„åˆ†æ²»ï¼Œå¯ä»¥åœ¨è§£å†³ä¸€äº›æ ‘ä¸Šç‰¹å®šæ¡ä»¶çš„è·¯å¾„çš„é—®é¢˜ã€‚å…¶å¤æ‚åº¦ä¸å¤§éƒ¨åˆ†åˆ†æ²»ç±»ä¼¼ï¼Œå¤§æ¦‚æ˜¯ $O(K ; \\log{n})$ï¼ˆ $K$ ä¸ºé™¤åˆ†æ²»æ­¥éª¤ä¹‹å¤–çš„æ—¶é—´å¤æ‚åº¦çš„å¤šé¡¹å¼ï¼‰ã€‚\nç®€ä»‹ ç‚¹åˆ†æ²»æ„Ÿæ€§çš„æ¥è¯´ï¼Œå…¶å®å°±éœ€è¦è€ƒè™‘ä¸€ä»¶äº‹æƒ…ï¼šå¦‚ä½•æŠŠæ ‘ä¸Šè·¯å¾„é—®é¢˜è½¬æ¢æˆè¿‡æ ¹ç»“ç‚¹çš„è·¯å¾„é—®é¢˜ã€‚\nå®šç†:æ ‘ä¸Šæ‰€æœ‰çš„è·¯å¾„å¯ä»¥åˆ†ä¸ºè¿‡æ ¹ç»“ç‚¹çš„è·¯å¾„å’Œä¸è¿‡æ ¹ç»“ç‚¹çš„è·¯å¾„ã€‚\nå¯¹äºæ ¹ç»“ç‚¹æ¥è¯´ï¼Œæˆ‘ä»¬å¤„ç†å®Œè¿‡æ ¹ç»“ç‚¹çš„è·¯å¾„ï¼Œå‰©ä¸‹æ‰€æœ‰çš„è·¯å¾„éƒ½ä¸ä¼šè¿‡æ ¹ç»“ç‚¹äº†ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŠŠæ ¹èŠ‚ç‚¹å’Œä¸æ ¹ç»“ç‚¹ç›¸è¿çš„è¾¹å‡åˆ æ‰ï¼Œç„¶åå¯¹äºæ–°äº§ç”Ÿçš„å­æ ‘ï¼Œå‰©ä¸‹çš„è·¯å¾„åº”è¯¥éƒ½åœ¨å…¶ä¸­ï¼Œå°±å¯ä»¥å¯¹å­æ ‘è¿›è¡Œåˆ†æ²»å¤„ç†ã€‚\nå®ç° ä¸»è¦æ˜¯ä¸‰ä¸ªå‡½æ•°ï¼šsolveï¼Œworkï¼Œgetrootã€‚\nsolve solveå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯ä¸»è¦å‡½æ•°ï¼Œæ˜¯ä¸€ä¸ªé€’å½’è§£å†³é—®é¢˜çš„è¿‡ç¨‹ã€‚\næ¯ä¸€æ¬¡éƒ½å…ˆæŠŠè¿™ä¸ªç‚¹æ ‡è®°æˆå·²ç»è®¿é—®è¿‡ï¼Œç„¶åå¯¹äºè¿™ä¸ªç‚¹å»å¯»æ‰¾\nä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11  void solve(int nown){ work(nown); vis[nown] = 1; for(int nowe = fir[nown];nowe;nowe = edge[nowe].nex){ int v = edge[nowe].to; if(vis[v]) continue; f[rt = 0] = sz = siz[v];//åˆå§‹åŒ–rt  getroot(v,rt);//æ‰¾åˆ°è¯¥å­æ ‘çš„é‡å¿ƒ  solve(rt);//é€’å½’è§£å†³é—®é¢˜  } }   work workå‡½æ•°å°±æ˜¯å®Œæˆå¯¹äºå½“å‰çš„å­æ ‘ä¸­æ‰€æœ‰è¿‡æ ¹çš„èŠ‚ç‚¹çš„å¤„ç†ã€‚è¿™ä¸ªå‡½æ•°æ²¡æœ‰å…·ä½“çš„æ ·å­ï¼Œå› é¢˜è€Œå¼‚ã€‚\nç…§æˆ‘ç›®å‰çš„ç†è§£ï¼Œä¸»è¦çš„æ€è·¯å°±æ˜¯ï¼šdfsï¼Œæƒ³åŠæ³•æ‹¼èµ·æ¥ä¸¤æ¡åŒæ—¶è¿‡æ ¹èŠ‚ç‚¹è€Œä¸”ç«¯ç‚¹ä¸åœ¨ä¸€ä¸ªå­æ ‘é‡Œé¢çš„èŠ‚ç‚¹ã€‚\ngetroot é¦–å…ˆï¼Œä¸ºäº†ä¿è¯æˆ‘ä»¬åˆ†å‡ºå»çš„å­æ ‘çš„è§„æ¨¡å°½é‡çš„ä¸€è‡´ï¼Œæˆ‘ä»¬æ¯æ¬¡éƒ½éœ€è¦æŠŠå½“å‰çš„æ ‘çš„é‡å¿ƒä½œä¸ºæ ¹èŠ‚ç‚¹ï¼Œç„¶åå®Œæˆä¸Šæ®µæ‰€è¿°çš„äº‹æƒ…ã€‚\nåœ¨è¿™é‡Œï¼Œå¯»æ‰¾é‡å¿ƒå…¶å®å°±æ˜¯æ‰¾å“ªä¸ªç‚¹ä½œæ ¹çš„æ—¶å€™å‰©ä¸‹çš„æœ€å¤§å­æ ‘çš„å¤§å°æœ€å°\u0026hellip;ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  //vis==1 ä»£è¡¨å·²ç»å¤„ç†è¿‡ï¼ˆä¸åœ¨å½“å‰å­æ ‘ä¸­ï¼‰ //f[nown] å‚¨å­˜è¿™ä¸ªç‚¹ä½œæ ¹æ—¶å‰©ä¸‹çš„æœ€å¤§å­æ ‘çš„å¤§å° void getroot(int nown,int fa){ siz[nown] = 1,f[nown] = 0; for(int nowe = fir[nown];nowe;nowe = edge[nowe].nex){ int v = edge[nowe].to; if(vis[v] || v == fa) continue; getroot(v,nown); siz[nown] += siz[v]; f[nown] = max(f[nown],siz[v]); } f[nown] = max(f[nown],sz - siz[nown]); if(f[nown] \u0026lt; f[rt]) rt = nown; }   ä¸æ˜¯å¾ˆéš¾ã€‚\nä»£ç  ä»¥Luogu P3806 ä¸ºä¾‹ã€‚\nï¼ˆå…¶å®è¿™ä¸ªé¢˜\u0026hellip;æ¯”æ¨¡ç‰ˆè¿˜æ˜¯è¦å¤šä¸€äº›çš„\u0026hellip;å¤æ‚åº¦æ˜¯ $O(n \\log{n} \\log{n})$\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;algorithm\u0026gt;#include \u0026lt;cctype\u0026gt;using namespace std; const int MAXN = 110000; namespace fast_io { //... }using namespace fast_io; struct Edge{ int from,to; int len,nex; }edge[MAXN]; int ecnt = 1;int fir[MAXN]; void addedge(int a,int b,int l){ edge[ecnt] = (Edge){a,b,l,fir[a]}; fir[a] = ecnt++; edge[ecnt] = (Edge){b,a,l,fir[b]}; fir[b] = ecnt++; } //----- int n,m,q[MAXN],ans[MAXN]; //----- int f[MAXN],vis[MAXN],siz[MAXN]; int rt,sz; struct node{ int d,f; bool operator \u0026lt; (node a)const{ return d \u0026lt; a.d; } }dep[MAXN]; int num; int search(int d){ int b = 1,e = num; while(e!=b){ int mid = (b+e)\u0026gt;\u0026gt;1; if(dep[mid].d \u0026gt;= d) e = mid; else b = mid + 1; } return b; } //----- void getroot(int nown,int fa){ siz[nown] = 1,f[nown] = 0; for(int nowe = fir[nown];nowe;nowe = edge[nowe].nex){ int v = edge[nowe].to; if(vis[v] || v == fa) continue; getroot(v,nown); siz[nown] += siz[v]; f[nown] = max(f[nown],siz[v]); } f[nown] = max(f[nown],sz - siz[nown]); if(f[nown] \u0026lt; f[rt]) rt = nown; } void dfs(int nown,int fa,int wh,int d){ dep[++num] = (node){d,wh}; for(int nowe = fir[nown];nowe;nowe = edge[nowe].nex){ int v = edge[nowe].to,l = edge[nowe].len; if(vis[v] || v == fa) continue; dfs(v,nown,wh,d+l); } } void work(int nown){ num = 0; for(int nowe = fir[nown];nowe;nowe = edge[nowe].nex){ int v = edge[nowe].to,l = edge[nowe].len; if(vis[v]) continue; dfs(v,nown,v,l); } dep[++num] = (node){0,0}; sort(dep+1,dep+num+1); //äºŒåˆ†æŸ¥æ‰¾ å¹¶åˆ¤æ–­å¯¹äºæ¯ä¸ªansæ˜¯å¦æœ‰ç¬¦åˆçš„ç­”æ¡ˆ  for(int i = 1;i\u0026lt;=m;i++){ if(ans[i]) continue; int l = 1; while(l \u0026lt; num \u0026amp;\u0026amp; dep[l].d + dep[num].d \u0026lt; q[i]) l++; while(l \u0026lt; num \u0026amp;\u0026amp; 2*dep[l].d \u0026lt; q[i]){ if(ans[i]) break; int t = q[i]-dep[l].d,r = search(t); while(r \u0026lt;= num \u0026amp;\u0026amp; dep[r].d == t \u0026amp;\u0026amp; dep[l].f == dep[r].f) r++; ans[i] |= (dep[r].d == t); l++; } } } void solve(int nown){ vis[nown] = 1; work(nown); for(int nowe = fir[nown];nowe;nowe = edge[nowe].nex){ int v = edge[nowe].to; if(vis[v]) continue; f[rt = 0] = sz = siz[v]; getroot(v,rt); solve(rt); } } void init(){ read(n),read(m); int a,b,c; for(int i = 1;i\u0026lt;=n-1;i++){ read(a),read(b),read(c); addedge(a,b,c); } for(int i = 1;i\u0026lt;=m;i++) read(q[i]); } void solve(){ f[rt = 0] = sz = n; getroot(1,rt); solve(rt); for(int i = 1;i\u0026lt;=m;i++){ if(ans[i]) print(\u0026#39;A\u0026#39;),print(\u0026#39;Y\u0026#39;),print(\u0026#39;E\u0026#39;); else print(\u0026#39;N\u0026#39;),print(\u0026#39;A\u0026#39;),print(\u0026#39;Y\u0026#39;); print(\u0026#39;\\n\u0026#39;); } } int main(){ init(); solve(); flush(); return 0; }   ä¾‹é¢˜ ã€ŒNOI2005ã€ç»´æŠ¤æ•°åˆ—-éæ—‹Treap\n[Luogu P2664]æ ‘ä¸Šæ¸¸æˆ\n","description":"","id":193,"section":"posts","tags":["ç¬”è®°","ç‚¹åˆ†æ²»","æ ‘å½¢ç»“æ„","æ¨¡æ¿"],"title":"ç‚¹åˆ†æ²»å­¦ä¹ ç¬”è®°","uri":"https://blog.chenqiqian.com/posts/notes-point-dc/"},{"content":"çˆ†é›¶æ»šç²—ã€‚\né›†è®­ åœ¨è€ƒè¯•ä¹‹å‰å…ˆæœ‰ä¸¤ä¸ªå‘¨æœ«çš„é›†è®­ã€‚\nç¬¬ä¸€ä¸ªå‘¨æœ«æ˜¯è®©æˆ‘å°è±¡æœ€ä¸ºæ·±åˆ»çš„ã€‚å¼€å§‹æ²¡ä»”ç»†çœ‹è¯´æ˜ï¼Œç»“æœä¸€ä¸å°å¿ƒå°±è·‘åˆ°äº†åŒ—å¸ˆå¤§é™„å±å®éªŒã€‚æ€¥å¿™æ‰“è½¦ï¼Œè·‘å›åˆ°é¦–å¸ˆå¤§é™„ä¸­ï¼Œè¿˜å¥½æ²¡æœ‰è¿Ÿåˆ°ã€‚\nç¬¬ä¸€å¤©ä¸Šåˆçš„é¢˜éå¸¸æœ‰è¶£ã€‚T1æ¯”è¾ƒç®€å•ï¼Œä¹Ÿæˆä¸ºäº†æˆ‘å››æ¬¡è€ƒè¯•ä»¥æ¥å”¯ä¸€Aæ‰çš„ä¸€é“é¢˜ã€‚T2 sumsumå¥½åƒæ˜¯å¥‡æ€ªçš„ç‚¹åˆ†æ²»ï¼Œè¿˜æ²¡æœ‰å­¦è¿‡ï¼Œæ‰€ä»¥è‡ªç„¶ä¹Ÿå°±ä¸ä¼šåšï¼Œç”šè‡³æœ€åè¿æš´åŠ›éƒ½æ‡’å¾—æ‰“ã€‚ä¸è¿‡å¥½åƒååˆ†å¼±æ™ºçš„æš´åŠ›ä¹Ÿèƒ½è¿‡åˆ°60åˆ†ï¼Ÿï¼Ÿä¹Ÿæ²¡æœ‰æƒ³åˆ°ã€‚T3æ˜¯æç­”é¢˜ï¼Œç¬¬ä¸€æ¬¡åšåˆ°ï¼Œéå¸¸æœ‰è¶£ã€‚è¿™ä¸ªæç­”è¿˜æ˜¯æ¯”è¾ƒå‹å–„çš„ï¼Œæ‰‹ç©ç«Ÿç„¶èƒ½æœ‰å››åå¤šåˆ†ï¼Œå¯ä»¥è¯´æ˜¯å¾ˆå‹å–„äº†ã€‚ç¬¬ä¸€å¤©å°±è¿™ä¹ˆè¿‡å»äº†ï¼Œæ’äº†ä¸€ä¸ªä¸‰å››ååçš„åæ¬¡ã€‚\nç¬¬äºŒå¤©å°±æ¯”è¾ƒéš¾äº†ï¼Œç«Ÿç„¶æ˜¯ä¸‰é“æ•°å­¦é¢˜\u0026hellip;äºæ˜¯æˆ‘ä¸€é“éƒ½ä¸ä¼šåš\u0026hellip;åšæ˜¯ä¸ä¼šåšçš„ï¼Œè¿˜æŠŠç½‘ç»™æ–­äº†ï¼Œäºæ˜¯å°±å¾ˆç»æœ›çš„å»çæã€‚T1å¥½åƒæ˜¯ä¸ªæ‰¾è§„å¾‹+æ„é€ ï¼ŒT2ä¸è®°å¾—äº†\u0026hellip;T3æ­£è§£è²Œä¼¼ä¹Ÿæ˜¯æ„é€ \u0026hellip;ç„¶è€Œæˆ‘åœ¨å¤§ä½¬çš„æŒ‡ç‚¹ä¸‹å†™äº†ä¸ªéšæœºåŒ–ï¼Œç«Ÿç„¶æåˆ°äº†ä¸‰åå¤šåˆ†ï¼Œä»¤äººæƒŠè®¶ã€‚\nä¸¤å¤©çš„é›†è®­å°±è¿™ä¹ˆç»“æŸäº†ã€‚ä¹Ÿæ²¡æœ‰å¬æ‡‚ä»€ä¹ˆï¼Œå‘¨æœ«å¥½å‡ æ¬¡é™©äº›å†™ä¸å®Œä½œä¸š\u0026hellip;\nDay1 Day1ä¸å¤ªæƒ³è¯´ä»€ä¹ˆã€‚\nT1å¥½åƒæ˜¯ä¸ªçº¿æ®µæ ‘ï¼Œä¸è¿‡æ­£è§£æ˜¯ä¸‰ä¸ªsetï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆå†™çš„æš´åŠ›ç¨€é‡Œç³Šæ¶‚çš„å°±çˆ†0äº†ã€‚\nT2æ˜¯ä¸€é“æ‰¾è§„å¾‹çš„é¢˜ç›®ã€‚ç„¶è€Œè’Ÿè’»å¦‚æˆ‘åƒè¿™ç§ä¸œè¥¿è‚¯å®šæ˜¯åˆ†æä¸å‡ºæ¥çš„\u0026hellip;éšä¾¿æ¨äº†ä¸ªè§„å¾‹\u0026hellip;ç„¶è€Œå‘ç°ä¸€å¤§å †åä¾‹ï¼Œä»¤äººå‘æŒ‡\u0026hellip;\nT3è²Œä¼¼æœ€ç®€å•ã€‚å°±æ˜¯ä¸€ä¸ªç®€å•çš„LCA+å‰ç¼€å’ŒæŸ¥è¯¢ï¼Œç„¶è€Œ\u0026hellip;æ²¡æƒ³åˆ°ç«Ÿç„¶æŒ‚åœ¨äº†å–æ¨¡ä¸Š\u0026hellip;è¿™ä¹Ÿä¸€æ–¹é¢ä½“ç°å‡ºäº†æˆ‘çš„å¯¹æ‹äººçœ¼æ‰§è¡Œdiffå‘½ä»¤çš„ä¸å¯é ï¼Œä¸€æ–¹é¢ä¹Ÿæ¶¨äº†çŸ¥è¯†ï¼šå–æ¨¡æ„ä¹‰ä¸‹çš„å‰ç¼€å’Œä¸€å®šè¦åŠ è¶³å¤Ÿçš„$p$ï¼ï¼ï¼è¦ä¸ç„¶å°±WA*näº†\u0026hellip;å‡ºé¢˜äººçéšæœºçš„æ•°æ®å‡ºäº†ç‚¹é”…ï¼Œæš´åŠ›$O(n^2)$çš„ç®—æ³•å±…ç„¶åœ¨å¹³è¡¡çš„æ ‘ä¸Šè·‘åˆ°äº†$O(n \\log{n})$ï¼Œç„¶å\u0026hellip;å°±è¿‡äº†ï¼Ÿï¼Ÿï¼Ÿå•Šå•Šå•Šæˆ‘è¦å­¦.batå¯¹æ‹ï¼ï¼ï¼\nç¬¬ä¸€å¤©æœŸæœ›å¾—åˆ†140ï¼Œå®é™…å¾—åˆ†10ã€‚\nDay2 æ­£å¼è€ƒè¯•çš„ç¬¬äºŒå¤©ã€‚ç¬¬ä¸€å¤©å°±åªæœ‰10åˆ†ï¼Œæ‰€ä»¥è€ƒè¯•ä¹‹å‰æœ‰ç‚¹æ…Œï¼Œæ˜¨å¤©è®²çš„æœ‰ä¸Šä¸‹ç•Œçš„ç½‘ç»œæµè¿˜ä¸æ€ä¹ˆä¼šï¼Œè€Œå»å¹´ä¸€é“ç½‘ç»œæµéƒ½æ²¡æœ‰è€ƒè¿‡ï¼Œè€ƒè¯•å‰åŒ†åŒ†èŒ«èŒ«çš„çœ‹äº†çœ‹ï¼Œå¸Œæœ›èƒ½ç”¨åˆ°ã€‚\nç„¶è€Œï¼Œç„¶è€Œå–œå‡ºæœ›å¤–çš„æ˜¯ï¼Œæˆ‘æœ€è¿‘ä¸€ä¸ªå¤šæœˆå­¦çš„ä¸œè¥¿ï¼Œå…¨éƒ¨éƒ½æ²¡æœ‰è€ƒåˆ°ã€‚åè€Œæ˜¯è€ƒäº†ä¸€äº›å¥‡å¥‡æ€ªæ€ªçš„ä¸œè¥¿ã€‚\nT1æ˜¯ä¸ªæäº¤ç­”æ¡ˆé¢˜ï¼Œç¢ç£¨ä¸€ç•ªæ ·ä¾‹ä¹‹åå‘ç°è‡ªå·±è¿æ ·ä¾‹éƒ½æ¨ä¸å‡ºæ¥ï¼Œçç©äº†10åˆ†å°±çœ‹ç¬¬äºŒé¢˜ã€‚\nT2è·Ÿé›†è®­ç¬¬ä¸€å‘¨çš„é¢˜å¾ˆåƒï¼Œå¥½åƒæ˜¯å¾æ˜å®½å·¨ä½¬åœ¨è€ƒåœºä¸Šæƒ³å‡ºäº†æŸç§ç‰¹æ®Šæƒ…å†µçš„è§£æ³•\u0026hellip;ç„¶åå°±å‡ºæˆäº†é¢˜ã€‚è²Œä¼¼40åˆ†çš„$O(n^2)$æš´åŠ›å¾ˆå¥½æƒ³ï¼Œç„¶è€Œæˆ‘åªå†™äº†ä¸ª$O(n^3)$çš„äºŒååˆ†æš´åŠ›ã€‚æœ€åè¿˜è¢«å‡ºé¢˜äººå‘äº†ä¸€åˆ†éƒ½æ²¡æœ‰\u0026hellip;ä¼¤å¿ƒ\u0026hellip;\nT3çœ‹äº†ä¸€çœ¼\u0026hellip;æ¦‚ç‡æ˜¯å•¥ï¼Ÿï¼Ÿï¼Ÿå’‹å¯¹åˆ†æ•°å–æ¨¡æ¥ç€\u0026hellip;æœŸæœ›æ€ä¹ˆç®—å•Š\u0026hellip;ä¸ä¼šå•Š\u0026hellip;äºæ˜¯æ”¾å¼ƒã€‚\näºæ˜¯å°±é™·å…¥äº†é¢“åºŸçš„çŠ¶æ€ã€‚æ„Ÿè§‰ä¸­é—´ä¸‰ä¸ªå°æ—¶è¿‡çš„ç‰¹åˆ«çš„å¿«ï¼Œå‰åä¸€ä¸ªå°æ—¶å°±éå¸¸çš„æ¼«é•¿\u0026hellip;æ¼«é•¿åˆ°å¿ƒæ€çˆ†ç‚¸ã€‚\nç¬¬äºŒå¤©æœŸæœ›å¾—åˆ†30ï¼Œæœ€åå¾—åˆ†8åˆ†ã€‚\nè®²å®Œé¢˜ç­‰æˆç»©çš„æ—¶å€™ï¼Œå‡ºç°äº†çœé˜Ÿå·¨ä½¬è¿è¿ç©æ‰«é›·ï¼Œå¤§å®¶çº·çº·å›´è§‚ï¼Œä»¥åŠå·¨ä½¬ç©æˆ‘ä¸çŸ¥é“åå­—çš„Windowsæ¸¸æˆçš„å£®è§‚æ™¯è±¡ã€‚\næœ€åæˆ‘æ ¡æœ‰äº†å››ä¸ªçœé˜Ÿï¼Œæ‰€æœ‰å»çš„é«˜äºŒ + dmyå…¨éƒ½è¿›äº†çœé˜Ÿã€‚\nDay2 dmyç«Ÿç„¶AKäº†ï¼ç¬¬äºŒå140åˆ†ï¼æ€»è¯„dmyæ¯”ç¬¬äºŒåé«˜äº†80åˆ†ï¼å®³æ€•\u0026hellip;\næœ€å ä»Šå¹´åˆä¸‰æœ‰ä¸‰ä¸ªçœé˜Ÿï¼Œé«˜ä¸€ä¸‰ä¸ªçœé˜Ÿï¼Œå‰©ä¸‹çš„å…¨éƒ½æ˜¯é«˜äºŒã€‚\nä»»åŠ¡ååˆ†çš„è‰°å·¨å•Šã€‚å¦‚æœæƒ³è¦è¿›åˆ°çœé˜Ÿï¼Œä¸ä»…è¦æ‰“è´¥é«˜ä¸€ï¼Œè¿˜è¦æ‰“è´¥æ›´ä¸ºææ€–çš„åˆä¸‰ã€‚æœ‰çš„æ—¶å€™ä¹Ÿåœ¨è¿½é—®ï¼Œæˆ‘çœŸçš„æœ‰å¤©èµ‹å—ï¼ŸçœŸçš„èƒ½ä»˜å¾—èµ·è¿™æ ·çš„æ—¶é—´ã€ç²¾åŠ›çš„æ”¯å‡ºå—ï¼Ÿå¦‚æœä»Šå¹´çš„è”èµ›å’Œæ˜å¹´çš„çœé€‰å­£è¦åœè¯¾çš„è¯ï¼Œèƒ½æ¥å—å¤±è´¥çš„æ‰“å‡»å—ï¼Ÿ\nå¦‚æœå…¶ä¸­ä»»ä½•ä¸€ä¸ªçš„ç­”æ¡ˆæ˜¯å¦ï¼Œæˆ‘æƒ³è¿™é—¨ç«èµ›æˆ–è®¸ä¹Ÿå°±æ²¡æœ‰å¿…è¦å»ç»§ç»­äº†å§ã€‚\næ‰€å¹¸ï¼Œç°åœ¨ï¼Œæˆ‘è¿˜è®¤ä¸ºè¿™ä¸‰ä¸ªç­”æ¡ˆå…¨éƒ½æ˜¯Trueã€‚\nå¦‚æœæ˜å¹´çš„NOIPåœ¨å‘æŒ¥æ­£å¸¸çš„æƒ…å†µä¸‹æ²¡æœ‰æ‹¿åˆ°450+ï¼Œæˆ‘æƒ³æˆ‘å°±åº”è¯¥é€€å½¹äº†ã€‚ä¹Ÿä¸å¿…å†å»è€—å®ƒæ›´å¤šçš„åŠå¹´ï¼Œå¾’è´¹æ—¶é—´ï¼Œå¾’è´¹ç¥æ€ã€‚\nè¿™æ¬¡çš„è€ƒè¯•ä¹ŸæŠ˜å°„å‡ºä¸€å®šçš„é—®é¢˜ã€‚è™½ç„¶æˆ‘æ¯”è¾ƒé•¿äºä»£ç å®ç°ï¼Œä½†æ˜¯åœ¨æ€ç»´ä¸Šæ˜æ˜¾è¿˜æ˜¯å’Œå·¨ä½¬æœ‰ä¸€å®šçš„å·®è·ã€‚å·¨ä½¬åœ¨ç°åœºæ²¡å‡†å¯ä»¥ç°æ¨ç»“è®ºï¼Œè€Œæˆ‘è®°ä½ç»“è®ºçš„æƒ…å†µä¸‹è¿˜æ˜¯è¿æš´åŠ›éƒ½æ²¡æœ‰æ•²å‡ºæœ€ä¼˜å¤æ‚åº¦ï¼Œä»¤äººçª’æ¯ã€‚è€Œä¸”æ€ç»´ä¸Šä¹Ÿå¾ˆæ€ æƒ°ï¼Œæ˜æ˜10åˆ†å°±æ˜¯2.5ä¸ªç§¯ç‚¹å´ä¸æƒ³å»å†™\u0026hellip;ä¸‹æ¬¡åƒä¸‡ä¸èƒ½æœ‰è¿™æ ·çš„æƒ…å†µ\u0026hellip;è€Œä¸”å°±æ˜¯æœ‰çš„æ—¶å€™æš´åŠ›ä»£ç å†™èµ·æ¥ç”šè‡³éƒ½éœ€è¦åŠä¸ªå°æ—¶ï¼Œè¿˜æ˜¯æœ‰ç‚¹é•¿äº†ã€‚\nä¸ç®¡å¦‚ä½•ï¼Œè¿™å‰©ä¸‹çš„200å¤©ä¹Ÿè¦åŠªåŠ›å§ï¼Œä¸èƒ½è®©ä¸€å¹´çš„åŠªåŠ›ç™½è´¹å•Šã€‚è¿‘ä¸€æ®µæ—¶é—´æ‰“ç®—å­¦ä¸€ä¸‹ç‚¹åˆ†æ²»ã€åŠ¨æ€æ ‘ã€åç¼€æ•°ç»„ã€ACè‡ªåŠ¨æœºå•¥çš„ç®—æ³•ï¼Œä»¥åŠåˆ·ä¸€åˆ·ç½‘ç»œæµäºŒåå››é¢˜å’Œä¸€äº›æ›´å¤šçš„æ•°æ®ç»“æ„é¢˜å§ã€‚è¿œæœŸç›®æ ‡è¿˜æœ‰å°±æ˜¯ä¸€äº›åŸºæœ¬çš„æ•°å­¦\u0026hellip;æ¯”å¦‚é«˜æ–¯æ¶ˆå…ƒï¼ŒFFTï¼ŒçŸ©é˜µï¼ŒæœŸæœ›å•¥çš„ã€‚\næ˜å¹´å†æˆ˜ã€‚å¸Œæœ›æ˜å¹´çš„æ˜å¤©æˆ–è€…åå¤©ï¼Œæˆ‘èƒ½å¤Ÿè¦ä¹ˆå¦ç„¶çš„é¢å¯¹ï¼Œè¦ä¹ˆæ˜‚èµ·å¤´ï¼Œç»§ç»­å‰è¿›ã€‚\n","description":"","id":194,"section":"posts","tags":null,"title":"BJOI2018æ¸¸è®°","uri":"https://blog.chenqiqian.com/posts/trip-bjoi2018/"},{"content":"ä½ å†³å®šè®¾è®¡ä½ è‡ªå·±çš„è½¯ä»¶åŒ…ç®¡ç†å™¨ã€‚å¦‚æœè½¯ä»¶åŒ… A ä¾èµ–è½¯ä»¶åŒ… B ï¼Œé‚£ä¹ˆå®‰è£…è½¯ä»¶åŒ… A ä»¥å‰ï¼Œå¿…é¡»å…ˆå®‰è£…è½¯ä»¶åŒ… B ã€‚åŒæ—¶ï¼Œå¦‚æœæƒ³è¦å¸è½½è½¯ä»¶åŒ… B ï¼Œåˆ™å¿…é¡»å¸è½½è½¯ä»¶åŒ… A ã€‚ç°åœ¨ä½ å·²ç»è·å¾—äº†æ‰€æœ‰çš„è½¯ä»¶åŒ…ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚é™¤ $0$ å·è½¯ä»¶åŒ…ä»¥å¤–ï¼Œæ‰€æœ‰è½¯ä»¶åŒ…éƒ½ä¼šä¾èµ–ä¸€ä¸ªä¸”ä»…ä¸€ä¸ªè½¯ä»¶åŒ…ï¼Œè€Œ $0$ å·è½¯ä»¶åŒ…ä¸ä¾èµ–ä»»ä½•ä¸€ä¸ªè½¯ä»¶åŒ…ã€‚ä¾èµ–å…³ç³»ä¸å­˜åœ¨ç¯ã€‚\nç°åœ¨æœ‰ä¸€äº›å®‰è£…æˆ–å¸è½½è½¯ä»¶åŒ…çš„æ“ä½œï¼Œéœ€è¦æ±‚å‡ºè¿™ä¸ªæ“ä½œå®é™…ä¸Šä¼šæ”¹å˜å¤šå°‘ä¸ªè½¯ä»¶åŒ…çš„å®‰è£…çŠ¶æ€ï¼ˆå³å®‰è£…æ“ä½œä¼šå®‰è£…å¤šå°‘ä¸ªæœªå®‰è£…çš„è½¯ä»¶åŒ…ï¼Œæˆ–å¸è½½æ“ä½œä¼šå¸è½½å¤šå°‘ä¸ªå·²å®‰è£…çš„è½¯ä»¶åŒ…ï¼‰ã€‚\né“¾æ¥ Luogu P2146\né¢˜è§£ å¯ä»¥è¯´åº”è¯¥è¿˜æ˜¯ä¸€é“æ¯”è¾ƒè£¸çš„æ ‘é“¾å‰–åˆ†äº†ã€‚\nå…ˆæ ‘é“¾å‰–åˆ†ï¼Œç„¶åæ ¹æ®ç¼–å·æ„å»ºä¸€é¢—çº¿æ®µæ ‘ã€‚çº¿æ®µæ ‘æ¯ä¸ªèŠ‚ç‚¹ç»´æŠ¤å½“å‰åŒºé—´å·²ç»å®‰è£…çš„è½¯ä»¶åŒ…çš„ä¸ªæ•°ã€‚éœ€è¦ä¸€ä¸ª lazy æ ‡è®°ï¼Œä¸º $1$ æ„å‘³ç€è¿™ä¸ªåŒºé—´è¢«å…¨éƒ¨å¸è½½ï¼Œä¸º $2$ æ„å‘³ç€è¿™ä¸ªåŒºé—´è¢«å…¨éƒ¨å®‰è£…ã€‚\nå¯¹äº install æ“ä½œï¼Œæ˜æ˜¾å¯ä»¥çœ‹å‡ºæˆ‘ä»¬çš„éœ€æ±‚åŒ…æ˜¯ä» $0$ å·èŠ‚ç‚¹åˆ° $x$ å·èŠ‚ç‚¹çš„é“¾ä¸Šçš„æ‰€æœ‰èŠ‚ç‚¹ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆæ±‚å‡ºåœ¨è¿™æ¡è·¯å¾„ä¸Šçš„å®‰è£…çš„è½¯ä»¶åŒ…çš„ä¸ªæ•°ï¼Œç„¶åå†æ±‚å‡ºè¿™ä¸ªè·¯å¾„çš„èŠ‚ç‚¹ä¸ªæ•°ï¼Œå¹¶å¯¹æ•´ä¸ªè·¯å¾„è¿›è¡Œä¿®æ”¹ï¼Œæœ€åç›¸å‡å¾—åˆ°ç­”æ¡ˆã€‚\nå¯¹äº uninstall æ“ä½œï¼Œå¾ˆæ˜æ˜¾å¯ä»¥çœ‹å‡ºåªè¦æŠŠä»¥ $x$ ä¸ºæ ¹èŠ‚ç‚¹çš„å­æ ‘çš„èŠ‚ç‚¹å…¨éƒ½ç»™å¸è½½å°±å¯ä»¥äº†ã€‚\næ‰€æœ‰æˆ‘ä»¬æ±‚å‡ºåœ¨è¿™ä¸ªå­æ ‘ä¸­çš„å®‰è£…ä¸ªæ•°ï¼ˆæ³¨æ„åˆ°ä¸€é¢—å­æ ‘çš„ $id$ åº”å½“æ˜¯è¿ç»­çš„ï¼‰ï¼Œè¿™ä¸ªå°±æ˜¯æŸ¥è¯¢çš„ç­”æ¡ˆï¼Œç„¶åæˆ‘ä»¬å°†è¿™ä¸ªå­æ ‘ç»™å¸è½½æ‰å°±å¯ä»¥äº†ã€‚\nå¤æ‚åº¦å¤§çº¦æ˜¯ $O(n ; log^2{n})$ æˆ–è€…ç¨å°ä¸€äº›å§ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cstring\u0026gt;#include \u0026lt;cctype\u0026gt;#include \u0026lt;vector\u0026gt;#include \u0026lt;algorithm\u0026gt;using namespace std; namespace fast_io { ... }using namespace fast_io; struct seg_tree{ #define lson (nown\u0026lt;\u0026lt;1)  #define rson ((nown\u0026lt;\u0026lt;1)|1)  #define mid ((l+r)\u0026gt;\u0026gt;1)  static const int MAXN = 110000; int sumn[MAXN\u0026lt;\u0026lt;2],lazy[MAXN\u0026lt;\u0026lt;2]; seg_tree(){ memset(sumn,0,sizeof(sumn)); memset(lazy,0,sizeof(lazy)); } //æ·»åŠ æ ‡è®°  inline void add_tag(int nown,int l,int r,int t){ if(t == 1) sumn[nown] = 0,lazy[nown] = 1; if(t == 2) sumn[nown] = r-l+1,lazy[nown] = 2; } //ä¸‹ä¼ åŒºé—´æ ‡è®°  inline void push_down(int nown,int l,int r){ if(l == r) return; if(lazy[nown]){ add_tag(lson,l,mid,lazy[nown]); add_tag(rson,mid+1,r,lazy[nown]); lazy[nown] = 0; } } //ç»´æŠ¤åŒºé—´å’Œ  inline void maintain(int nown){ sumn[nown] = sumn[lson] + sumn[rson]; } //åŒºé—´æ›´æ–°ä¸ºå®‰è£…ï¼ˆtag == 2ï¼‰æˆ–æœªå®‰è£…ï¼ˆtag == 2ï¼‰  inline void update(int nown,int l,int r,int ql,int qr,int tag){ if(ql \u0026lt;= l \u0026amp;\u0026amp; r\u0026lt;=qr) add_tag(nown,l,r,tag); else{ push_down(nown,l,r); if(ql \u0026lt;= mid) update(lson,l,mid,ql,qr,tag); if(qr \u0026gt;= mid+1) update(rson,mid+1,r,ql,qr,tag); maintain(nown); } } //åŒºé—´æŸ¥è¯¢å®‰è£…çš„ä¸ªæ•°  inline int query(int nown,int l,int r,int ql,int qr){ if(ql \u0026lt;= l \u0026amp;\u0026amp; r \u0026lt;= qr) return sumn[nown]; else{ push_down(nown,l,r); int ans = 0; if(ql\u0026lt;=mid) ans+=query(lson,l,mid,ql,qr); if(qr \u0026gt;= mid+1) ans+=query(rson,mid+1,r,ql,qr); return ans; } } }tree; //çº¿æ®µæ ‘  const int MAXN = 110000; int n,m; int cnt = 0; int dep[MAXN],id[MAXN],son[MAXN],fa[MAXN],top[MAXN],siz[MAXN]; vector\u0026lt;int\u0026gt; edge[MAXN]; //æ ‘é“¾å‰–åˆ† void dfs1(int nown,int f,int depth){ siz[nown] = 1,fa[nown] = f; dep[nown] = depth; int maxsum = -1; for(int i = 0;i\u0026lt;edge[nown].size();i++){ int to = edge[nown][i]; if(to == fa[nown]) continue; dfs1(to,nown,depth+1); siz[nown]+=siz[to]; if(siz[to] \u0026gt; maxsum) son[nown] = to,maxsum = siz[to]; } } void dfs2(int nown,int topf){ id[nown] = ++cnt,top[nown] = topf; if(!son[nown]) return; dfs2(son[nown],topf); for(int i = 0;i\u0026lt;edge[nown].size();i++){ int to = edge[nown][i]; if(to == fa[nown] || to == son[nown]) continue; dfs2(to,to); } } //æŸ¥è¯¢xåˆ°yçš„è·¯å¾„ä¸Šçš„å®‰è£…çš„ä¸ªæ•° inline int query(int x,int y){ int ans = 0; while(top[x]!=top[y]){ if(dep[top[x]] \u0026lt; dep[top[y]]) swap(x,y); ans+=tree.query(1,1,n,id[top[x]],id[x]); x = fa[top[x]]; } if(dep[x] \u0026gt; dep[y]) swap(x,y); ans+=tree.query(1,1,n,id[x],id[y]); return ans; } //å°†xåˆ°yè·¯å¾„ä¸Šçš„ç‚¹æ ‡è®°ä¸ºå®‰è£…æˆ–è€…å¸è½½ inline int update(int x,int y,int t){ int ans = 0; while(top[x]!=top[y]){ if(dep[top[x]] \u0026lt; dep[top[y]]) swap(x,y); ans+=id[x]-id[top[x]]+1; tree.update(1,1,n,id[top[x]],id[x],t); x = fa[top[x]]; } if(dep[x] \u0026gt; dep[y]) swap(x,y); ans+=id[y]-id[x]+1;tree.update(1,1,n,id[x],id[y],t); return ans; } //å®‰è£… inline int install(int x){ int b = query(1,x); int e = update(1,x,2); return e-b; } //å¸è½½ inline int uninstall(int x){ int b = tree.query(1,1,n,id[x],id[x]+siz[x]-1); tree.update(1,1,n,id[x],id[x]+siz[x]-1,1); return b; } inline void init(){ read(n); int tmp; for(int i = 2;i\u0026lt;=n;i++){ read(tmp); edge[i].push_back(tmp+1); edge[tmp+1].push_back(i); } dfs1(1,0,1); dfs2(1,1); } inline void solve(){ read(m); char op[20];int x; for(int i = 1;i\u0026lt;=m;i++){ read(op),read(x); if(op[0] == \u0026#39;u\u0026#39;) print(uninstall(x+1)),print(\u0026#39;\\n\u0026#39;); else if(op[0] == \u0026#39;i\u0026#39;) print(install(x+1)),print(\u0026#39;\\n\u0026#39;); } } int main(){ init(); solve(); flush(); return 0; }   ","description":"","id":195,"section":"posts","tags":["æ•°æ®ç»“æ„","æ ‘é“¾å‰–åˆ†","çº¿æ®µæ ‘"],"title":"ã€ŒNOI2015ã€è½¯ä»¶åŒ…ç®¡ç†å™¨-æ ‘é“¾å‰–åˆ†","uri":"https://blog.chenqiqian.com/posts/noi2015-manager/"},{"content":"ä½ çš„å…¬å¸éœ€è¦æä¾› $n$ ç±»äº§å“ï¼Œå…¶ä¸­ç¬¬ $i$ ç±»äº§å“å…±éœ€è¦ $C_{i}$ ä»¶ã€‚å…¬å¸å…±æœ‰ $m$ åå‘˜å·¥ã€‚å‘˜å·¥èƒ½å¤Ÿåˆ¶é€ çš„äº§å“ç§ç±»æœ‰æ‰€åŒºåˆ«ï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ªç”± $0$ å’Œ $1$ ç»„æˆçš„ $m\\times n$ çš„çŸ©é˜µ $\\mathbb {A}$ æ¥æè¿°æ¯åå‘˜å·¥èƒ½å¤Ÿåˆ¶é€ å“ªäº›äº§å“ã€‚\nå¯¹äºå‘˜å·¥ $i$ ï¼Œç»™å‡º $S_i$ ã€‚å®šä¹‰ä»–çš„æ„¤æ€’å€¼ä¸ä»–åˆ¶ä½œçš„äº§å“æ•°é‡ä¹‹é—´çš„å‡½æ•°æ˜¯ä¸€ä¸ª $S_i+1$ æ®µçš„åˆ†æ®µå‡½æ•°ã€‚è®¾ $T_{i,0}=0$,$T_{i,S_{i+1}}=+\\infty$ ï¼Œé‚£ä¹ˆå½“ä»–åˆ¶é€ ç¬¬ $[T_{i,j-1}+1,T_{i,j}]$ ä»¶äº§å“æ—¶ï¼Œæ¯ä»¶äº§å“ä¼šä½¿ä»–çš„æ„¤æ€’å€¼å¢åŠ  $W_{i,j}$ ï¼Œ $1\\leq j\\leq S_{i+1}$ ã€‚ä¿è¯ $0\u0026lt;W_{i,j} \u0026lt; W_{i,j+1}, ; 0 \u0026lt; T_{i,j} \u0026lt; T_{i,j+1}$ ã€‚\nä½ çš„ä»»åŠ¡æ˜¯åˆ¶å®šå‡ºä¸€ä¸ªäº§å“çš„åˆ†é…æ–¹æ¡ˆï¼Œä½¿å¾—è®¢å•æ¡ä»¶è¢«æ»¡è¶³ï¼Œå¹¶ä¸”æ‰€æœ‰å‘˜å·¥çš„æ„¤æ€’å€¼ä¹‹å’Œæœ€å°ã€‚\né“¾æ¥ Luogu P2488\nBZOJ 2245\né¢˜è§£ ä¸€é“è´¹ç”¨æµçš„é¢˜ç›®ã€‚\næ¯ä¸ªäº§å“çš„æ•°é‡å¯ä»¥ç”¨ä¸€æ¡è¾¹æ¥é™åˆ¶ï¼Œä¸»è¦éœ€è¦æ»¡è¶³çš„å°±æ˜¯æ„¤æ€’å€¼åˆ†æ®µå‡½æ•°å¼çš„ç»“æ„ã€‚\næ³¨æ„åˆ°æ¯ä¸ªäººçš„æ„¤æ€’å€¼çš„åˆ†æ®µå‡½æ•°ä¸åšäº†å…·ä½“å“ªç±»äº§å“æ— å…³ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨äººè¿™è¾¹çš„è¾¹ä¸ŠåŠ¨ç‚¹æ‰‹è„šã€‚æˆ‘ä»¬å¯ä»¥æ‹†è¾¹ï¼ŒæŒ‰æ®µæ¥æ‹†è¾¹ï¼Œæ¯æ®µç»™ä¸€æ¡è¾¹ï¼Œé€šè¿‡å®¹é‡æ¥æ»¡è¶³åˆ†æ®µçš„è¦æ±‚ã€‚\nå…·ä½“å»ºå›¾ï¼š\nä»¤ $1$ è‡³ $m$ ä¸º $m$ ä¸ªå‘˜å·¥æ‰€ä»£è¡¨çš„ç‚¹ï¼Œ $m+1$ è‡³ $m+n$ ä¸º $n$ ç±»äº§å“ä»£è¡¨çš„ç‚¹ï¼Œ $s$ ä¸ºæºç‚¹ï¼Œ $t$ ä¸ºæ±‡ç‚¹ã€‚\nå¯¹äº $A$ çŸ©é˜µï¼Œå¦‚æœ $A_{i,j}$ æ˜¯ $1$ ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¿ä¸€æ¡èµ·ç‚¹ä¸º $i$ ï¼Œç»ˆç‚¹ä¸º $m+j$ ï¼Œå®¹é‡ä¸º $+\\infty$ ï¼Œè´¹ç”¨ä¸º $0$ çš„è¾¹ã€‚\nå¯¹äºç¬¬ $i$ ä¸ªå•†å“ç§ç±»ï¼Œæˆ‘ä»¬è¿ä¸€æ¡èµ·ç‚¹ä¸º $m+i$ ï¼Œç»ˆç‚¹ä¸º $t$ ï¼Œå®¹é‡ä¸º $C_{i}$ ï¼Œè´¹ç”¨ä¸º $0$ çš„è¾¹ã€‚\nå¯¹äºç¬¬ $i$ ä¸ªäººï¼Œæˆ‘ä»¬è¿ $S_{i}+1$ æ¡è¾¹ï¼Œèµ·ç‚¹å‡ä¸º $s$ ï¼Œç»ˆç‚¹å‡ä¸º $i$ ï¼Œä»¤ç¬¬ $j$ æ¡è¾¹çš„å®¹é‡ä¸º $S_{i,j}-S_{i,j-1}, j \\in [1,S_{i}+1]$ ï¼Œè´¹ç”¨ä¸º $W_{i,j}$ ã€‚\nè·‘æœ€å°è´¹ç”¨æœ€å¤§æµï¼Œå¾—åˆ°çš„è´¹ç”¨å³ä¸ºç»“æœã€‚\næ³¨æ„éœ€è¦å¼€ long long\u0026hellip;\nå€¼å¾—ä¸€æçš„æ˜¯ï¼Œç”±äºæˆ‘æœ‰ä¸€ä¸ª $j$ å†™æˆäº† $i$ ï¼Œå¯¼è‡´æˆ‘ç»æœ›çš„æ‰¾äº†15åˆ†é’Ÿçš„bug\u0026hellip;ä»¤äººçª’æ¯ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;queue\u0026gt;#include \u0026lt;cctype\u0026gt;#include \u0026lt;cstring\u0026gt;#include \u0026lt;algorithm\u0026gt;#define ll long long using namespace std; namespace fast_io { //... }using namespace fast_io; const int MAX = 1e9; const int MAXN = 1000,MAXM = 200000; struct Edge{ int from,to; int flow,cap; int cost; int nex; }edge[MAXM]; int n,m,s,t,ecnt = 2; int fir[MAXN],pree[MAXN]; ll dis[MAXN];int instack[MAXN]; queue\u0026lt;int\u0026gt; q; void addedge(int a,int b,int c,int d){ //printf(\u0026#34;%lld %lld %lld %lld\\n\u0026#34;,a,b,c,d);  edge[ecnt].from = a,edge[ecnt].to = b; edge[ecnt].cap = c,edge[ecnt].flow = 0; edge[ecnt].cost = d,edge[ecnt].nex = fir[a]; fir[a] = ecnt++; edge[ecnt].from = b,edge[ecnt].to = a; edge[ecnt].cap = 0,edge[ecnt].flow = 0; edge[ecnt].cost = -d,edge[ecnt].nex = fir[b]; fir[b] = ecnt++; } bool spfa(){ while(!q.empty()) q.pop(); memset(dis,0x3f,sizeof(dis)); dis[s] = 0;q.push(s); while(!q.empty()){ int nown = q.front();q.pop(); instack[nown] = 0; for(int nowe = fir[nown];nowe;nowe = edge[nowe].nex){ Edge e = edge[nowe]; if(dis[e.to] \u0026gt; dis[nown] + e.cost \u0026amp;\u0026amp; e.cap \u0026gt; e.flow){ dis[e.to] = dis[nown] + e.cost; pree[e.to] = nowe; if(instack[e.to] == 0){ instack[e.to] = 1; q.push(e.to); } } } } return dis[t] \u0026lt; 0x3f3f3f3f3f3f3f3f; } void argument(ll \u0026amp;sumf,ll \u0026amp;sumc){ int nown = t,nowe,delta = MAX; while(nown!=s){ nowe = pree[nown]; delta = min(delta,edge[nowe].cap - edge[nowe].flow); nown = edge[nowe].from; } nown = t; while(nown!=s){ nowe = pree[nown]; edge[nowe].flow+=delta,edge[nowe^1].flow-=delta; nown = edge[nowe].from; } sumf+=delta,sumc+=delta*dis[t]; } void min_cost_flow(){ ll f = 0,c = 0; while(spfa()) argument(f,c); printf(\u0026#34;%lld\\n\u0026#34;,c); } void init(){ read(m),read(n); s = m+n+1,t = m+n+2; int tmp = 0; for(int i = 1;i\u0026lt;=n;i++){ read(tmp); addedge(m+i,t,tmp,0); } for(int i = 1;i\u0026lt;=m;i++){ for(int j = 1;j\u0026lt;=n;j++){ read(tmp); if(tmp) addedge(i,m+j,MAX,0); } } int b[10]; for(int i = 1;i\u0026lt;=m;i++){ read(tmp); for(int j = 1;j\u0026lt;=tmp;j++) read(b[j]); b[0] = 0;b[tmp+1] = MAX; for(int j = 1;j\u0026lt;=tmp+1;j++){ int w;read(w); addedge(s,i,b[j]-b[j-1],w); } } } int main(){ init(); min_cost_flow(); return 0; }   ","description":"","id":196,"section":"posts","tags":["å›¾è®º","è´¹ç”¨æµ"],"title":"ã€ŒSDOI2011ã€å·¥ä½œå®‰æ’-è´¹ç”¨æµ","uri":"https://blog.chenqiqian.com/posts/sdoi2011-arrange/"},{"content":"Ahoâ€“Corasickç®—æ³•ï¼Œå¸¸å«åšACè‡ªåŠ¨æœºã€‚æ˜¯ä¸€ç§å­—ç¬¦ä¸²å¤šæ¨¡å¼ä¸²åŒ¹é…ç®—æ³•ã€‚èƒ½åœ¨çº¿æ€§æ—¶é—´å†…å®Œæˆå¤šä¸ªæ¨¡å¼ä¸²å¯¹ä¸€ä¸ªæŸ¥è¯¢ä¸²çš„åŒ¹é…ã€‚\n èƒ½è‡ªåŠ¨ACå“¦ã€‚\n To be finished.\næ€æƒ³ æ ‘å‹ç»“æ„ å»ºæ ‘ æŸ¥è¯¢ å…¶ä»– å®ç° åŸºæœ¬ ä¸€äº›æ”¹è¿› ä»£ç  ä¾‹é¢˜","description":"","id":197,"section":"posts","tags":["å­—ç¬¦ä¸²","ACè‡ªåŠ¨æœº","æ¨¡æ¿"],"title":"ACè‡ªåŠ¨æœºå­¦ä¹ ç¬”è®°","uri":"https://blog.chenqiqian.com/posts/notes-ac_automaton/"},{"content":"ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² $S$ ï¼Œæ±‚å‡º $num$ æ•°ç»„â€”â€”å¯¹äºå­—ç¬¦ä¸² $S$ çš„å‰ $i$ ä¸ªå­—ç¬¦æ„æˆçš„å­ä¸²ï¼Œæ—¢æ˜¯å®ƒçš„åç¼€åŒæ—¶åˆæ˜¯å®ƒçš„å‰ç¼€ï¼Œå¹¶ä¸”è¯¥åç¼€ä¸è¯¥å‰ç¼€ä¸é‡å ï¼Œå°†è¿™ç§å­—ç¬¦ä¸²çš„æ•°é‡è®°ä½œ $num[i]$ ã€‚\nç‰¹åˆ«åœ°ï¼Œä¸ºäº†é¿å…å¤§é‡çš„è¾“å‡ºï¼Œä½ ä¸éœ€è¦è¾“å‡º $num[i]$ åˆ†åˆ«æ˜¯å¤šå°‘ï¼Œä½ åªéœ€è¦è¾“å‡ºæ‰€æœ‰ $(num[i]+1)$ çš„ä¹˜ç§¯ï¼Œå¯¹ $10^9+7$ å–æ¨¡çš„ç»“æœå³å¯ã€‚\né“¾æ¥ Luogu P2375\né¢˜è§£ ç»ˆäºå¼€å§‹æ€¼å­—ç¬¦ä¸²çš„é¢˜äº†ã€‚\nè¿™ä¸€é“é¢˜è®©æˆ‘ä»¬æ±‚ $num$ çš„ä¸ªæ•°ï¼Œå…¶å®è”ç³»ä¸€ä¸‹ACè‡ªåŠ¨æœºï¼Œå¾ˆå®¹æ˜“å°±æƒ³åˆ°æ²¿ç€ nex æ•°ç»„å¾€å›è·³ã€‚è·³çš„æ¬¡æ•°å°±æ˜¯ç›¸åŒå‰åç¼€çš„ä¸ªæ•°ï¼Œè¿™ä¸ªå¯ä»¥åœ¨æ±‚ nex çš„æ—¶å€™ç›´æ¥é¢„å¤„ç†å‡ºæ¥ï¼Œè®°ä¸º $cnt$ æ•°ç»„ã€‚\nä½†é¢˜ç›®ä¸­æœ‰ä¸€ä¸ªé™åˆ¶æ¯”è¾ƒçƒ¦äººï¼š\n è¯¥åç¼€ä¸è¯¥å‰ç¼€ä¸é‡å \n ä¸€ä¸ªç®€å•çš„æƒ³æ³•å°±æ˜¯æ±‚å‡º nex æ•°ç»„ï¼Œå¯¹äºæ¯ä¸€ä¸ª $i$ ï¼Œå…ˆå°† nex é™åˆ° $\\frac{i}{2}$ ä»¥ä¸‹ï¼Œç„¶åçœ‹è¿™ä¸ª nex è¿˜èƒ½è·³å¤šå°‘æ¬¡ã€‚ä½†æ˜¯å¾ˆé—æ†¾ï¼Œè¿™ä¸ªTLEäº†ï¼Œåªæœ‰ $50$ åˆ†ã€‚å› ä¸ºæ¯ä¸€æ¬¡éƒ½è·³ nex ä»£ä»·å¤ªé«˜ï¼Œggã€‚\nä¸€ä¸ªç®€å•çš„æ”¹è¿›å°±å¯ä»¥è¿‡æ‰è¿™é“é¢˜ã€‚\næˆ‘ä»¬åªéœ€è¦åƒè·³æ™®é€šçš„ nex ä¸€æ ·å»è·³è¿™ä¸ªåœ°æ–¹çš„ nex ï¼Œåªéœ€è¦æ¯æ¬¡ç¡®ä¿å…¶åœ¨ $\\frac{i}{2}$ ä»¥ä¸‹å°±å¯ä»¥ã€‚ç„¶åå°±å¯ä»¥æ‰¾åˆ° nex ï¼Œä»è€Œå¾—åˆ° $num$ ã€‚\nè¯´é•¿åº¦åœ¨ $\\frac{i}{2}$ ä»¥ä¸‹å…¶å®ä¸å¤ªä¸¥è°¨ï¼Œå…·ä½“çœ‹ä»£ç å§ã€‚\nä»£ç   ACä»£ç ï¼š  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cstring\u0026gt;#define ll long long using namespace std; const int MAXN = 1110000; int n,p = 1000000007; int nex[MAXN],cnt[MAXN]; char s[MAXN]; void cal(){ memset(nex,0,sizeof(nex)); memset(cnt,0,sizeof(cnt)); nex[0] = 0; int len = strlen(s); int j = 0; for(int i = 1;i\u0026lt;len;i++){ while(j \u0026gt; 0 \u0026amp;\u0026amp; s[i]!=s[j]) j = nex[j-1]; if(s[i] == s[j]) ++j; nex[i] = j; cnt[i] = cnt[nex[i-1]]+1; } ll ans = 1; j = 0; for(int i = 1;i\u0026lt;len;i++){ while(j \u0026gt; 0 \u0026amp;\u0026amp; s[i]!=s[j]) j = nex[j-1]; if(s[i] == s[j]) ++j; while(j\u0026gt;0 \u0026amp;\u0026amp; 2*j \u0026gt; i+1) j = nex[j-1]; ans *= (cnt[j]+1),ans%=p; } printf(\u0026#34;%lld\\n\u0026#34;,ans); } void solve(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n); for(int i = 1;i\u0026lt;=n;i++){ scanf(\u0026#34;%s\u0026#34;,s); cal(); } } int main(){ solve(); return 0; }    å¦é™„50åˆ†ä»£ç ï¼š  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cstring\u0026gt;#define ll long long using namespace std; const int MAXN = 1110000; int n,p = 1000000007; int nex[MAXN],cnt[MAXN]; char s[MAXN]; void cal(){ memset(nex,0,sizeof(nex)); memset(cnt,0,sizeof(cnt)); nex[0] = 0; int j = 0,len = strlen(s); ll ans = 1; for(int i = 1;i\u0026lt;len;i++){ while(j \u0026gt; 0 \u0026amp;\u0026amp; s[i]!=s[j]) j = nex[j-1]; if(s[i] == s[j]) ++j; nex[i] = j; cnt[i] = cnt[nex[i-1]]+1; } for(int i = 1;i\u0026lt;len;i++){ j = nex[i]; while(j\u0026gt;0 \u0026amp;\u0026amp; 2*j \u0026gt; i+1) j = nex[j-1]; ans *= (cnt[j]+1),ans%=p; } printf(\u0026#34;%lld\\n\u0026#34;,ans); } void solve(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n); for(int i = 1;i\u0026lt;=n;i++){ scanf(\u0026#34;%s\u0026#34;,s); cal(); } } int main(){ solve(); return 0; }   ","description":"","id":198,"section":"posts","tags":["å­—ç¬¦ä¸²","KMP"],"title":"ã€ŒNOI2014ã€åŠ¨ç‰©å›­-KMP","uri":"https://blog.chenqiqian.com/posts/noi2014-zoo/"},{"content":"ç»™å®šä¸€å¼ æœ‰å‘å›¾ï¼Œæ¯æ¡è¾¹éƒ½æœ‰ä¸€ä¸ªå®¹é‡ $C$ å’Œä¸€ä¸ªæ‰©å®¹è´¹ç”¨ $W$ ã€‚è¿™é‡Œæ‰©å®¹è´¹ç”¨æ˜¯æŒ‡å°†å®¹é‡æ‰©å¤§ $1$ æ‰€éœ€çš„è´¹ç”¨ã€‚\nç°åœ¨è¯·ä½ ç¼–å†™ä¸€ä¸ªç¨‹åºæ±‚å‡ºï¼š\n åœ¨ä¸æ‰©å®¹çš„æƒ…å†µä¸‹ï¼Œ $1$ åˆ° $N$ çš„æœ€å¤§æµï¼› å°† $1$ åˆ° $N$ çš„æœ€å¤§æµå¢åŠ  $K$ æ‰€éœ€çš„æœ€å°æ‰©å®¹è´¹ç”¨ã€‚  é“¾æ¥ Luogu P2604\nBZOJ 1834\né¢˜è§£ ä¸€é“æœ€å¤§æµå’Œè´¹ç”¨æµçš„é¢˜ã€‚\nç¬¬ä¸€é—®ä¸è¯´äº†ã€‚ç¬¬äºŒé—®äº‹å®ä¸Šæˆ‘ä»¬æ³¨æ„åˆ°æˆ‘ä»¬å¯ä»¥æŠŠæ¯æ¡è¾¹æƒ³åƒæˆï¼Œ $C$ çš„å…è´¹æµé‡å’Œè´¹ç”¨ä¸º $W$ çš„æµé‡ã€‚å› ä¸ºç­”æ¡ˆé—®æˆ‘ä»¬åœ¨æœ€å¤§æµä¸º $ans+k$ çš„æ—¶å€™ï¼Œæœ€å°è´¹ç”¨æ˜¯å¤šå°‘ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¼•å…¥ä¸€æ¡è¾¹æ¥æ§åˆ¶æµé‡ï¼Œå†è·‘å¾—åˆ°çš„è´¹ç”¨æµå°±æ˜¯æœ€å°è´¹ç”¨äº†ã€‚\næ€ä¹ˆæ¥è¾¾æˆè¾¹çš„çº¦æŸå‘¢ï¼Ÿäº‹å®ä¸Šæ‹†è¾¹ä¸ºä¸¤æ¡å°±å¥½ï¼Œä¸€æ¡å…è´¹è¾¹ï¼Œä¸€æ¡æ”¶è´¹è¾¹ã€‚\nå…·ä½“å»ºå›¾æ–¹æ³•å¦‚ä¸‹ã€‚\nå…ˆæŒ‰ç…§è´¹ç”¨æµçš„æ ·å­å»ºå›¾ï¼Œæ‰€æœ‰è¾¹çš„è´¹ç”¨ä¸º $0$ ï¼Œæºç‚¹ä¸º $1$ ï¼Œç»ˆç‚¹ä¸º $n$ ï¼Œç„¶åè·‘Dinicå¾—åˆ° $ans1$ ã€‚\nå…³äº $ans2$ ï¼Œç¨å¾®å¤æ‚ä¸€äº›ã€‚\nä¿ç•™åŸå›¾ã€‚å¯¹äºå›¾ä¸­çš„æ¯æ¡è¾¹ï¼Œå†å»ºä¸€æ¡å®¹é‡ä¸º $ans1+k$ ï¼Œè´¹ç”¨ä¸º $w_i$ çš„è¾¹ã€‚ç”± $n$ å·èŠ‚ç‚¹å‘ $n+1$ å·èŠ‚ç‚¹å»ºä¸€æ¡å®¹é‡ä¸º $ans1+K$ ï¼Œè´¹ç”¨ä¸º $0$ çš„è¾¹ï¼Œå¹¶æŠŠæ±‡ç‚¹è®¾ç½®ä¸º $n+1$ ï¼Œæ³¨æ„æŠŠæµé‡åˆå§‹éœ€è¦è®¾ç½®æˆ $ans1$ ã€‚ç›´æ¥åœ¨æ®‹é‡ç½‘ç»œä¸Šè·‘è´¹ç”¨æµï¼Œå¾—åˆ°è´¹ç”¨å³ä¸º $ans2$ ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154  #include \u0026lt;bits/stdc++.h\u0026gt;using namespace std; namespace fast_io { ... }using namespace fast_io; const int MAXN = 6000,MAXM = 110000; int fx[MAXM],tx[MAXM],cx[MAXM],wx[MAXM]; struct Edge{ int from,to; int flow,cap; int cost,nex; }edge[MAXM]; int n,m,s,t,k; int fir[MAXN],cur[MAXN],pree[MAXN],ecnt = 2; void addedge(int a,int b,int ca,int co = 0,int f = 0){ edge[ecnt].from = a,edge[ecnt].to = b; edge[ecnt].cost = co,edge[ecnt].cap = ca; edge[ecnt].flow = f; edge[ecnt].nex = fir[a],fir[a] = ecnt; ecnt++; edge[ecnt].from = b,edge[ecnt].to = a; edge[ecnt].cost = -co,edge[ecnt].cap = 0; edge[ecnt].flow = -f; edge[ecnt].nex = fir[b],fir[b] = ecnt; ecnt++; } int dis[MAXN],instack[MAXN]; queue\u0026lt;int\u0026gt; q; //Dinic bool bfs(){ memset(dis,0,sizeof(dis)); memcpy(cur,fir,sizeof(fir)); while(!q.empty()) q.pop(); q.push(s);dis[s] = 1; while(!q.empty()){ int nown = q.front();q.pop(); for(int nowe = fir[nown];nowe;nowe = edge[nowe].nex){ int v = edge[nowe].to; if(dis[v] == 0 \u0026amp;\u0026amp; edge[nowe].cap \u0026gt; edge[nowe].flow){ dis[v] = dis[nown]+1; q.push(v); if(v == t) return true; } } } return false; } int dfs(int nown,int limit = 0x3f3f3f3f){ if(nown == t||limit == 0) return limit; for(int \u0026amp;nowe = cur[nown];nowe;nowe = edge[nowe].nex){ int v = edge[nowe].to; if(dis[v] == dis[nown]+1 \u0026amp;\u0026amp; edge[nowe].cap \u0026gt; edge[nowe].flow){ int f = dfs(v,min(limit,edge[nowe].cap - edge[nowe].flow)); if(f\u0026gt;0){ edge[nowe].flow+=f; edge[nowe^1].flow-=f; return f; } } } return 0; } int dinic(){ int ans = 0,f; while(bfs()) while((f=dfs(s))\u0026gt;0) ans+=f; return ans; } //è´¹ç”¨æµ bool spfa(){ while(!q.empty()) q.pop(); memset(dis,0x3f,sizeof(dis)); memset(instack,0,sizeof(instack)); dis[s] = 0;q.push(s); while(!q.empty()){ int nown = q.front();q.pop(); instack[nown] = 0; for(int nowe = fir[nown];nowe;nowe = edge[nowe].nex){ Edge e = edge[nowe]; if(dis[e.to]\u0026gt;dis[nown]+e.cost\u0026amp;\u0026amp;e.cap\u0026gt;e.flow){ dis[e.to] = dis[nown]+e.cost; pree[e.to] = nowe; if(instack[e.to] == 0){ q.push(e.to); instack[e.to] = 1; } } } } return dis[t] \u0026lt; 0x3f3f3f3f; } void argument(int \u0026amp;sumc,int \u0026amp;sumf){ int nown = t,delta = 0x3f3f3f3f; while(nown!=s){ delta = min(delta,edge[pree[nown]].cap - edge[pree[nown]].flow); nown = edge[pree[nown]].from; } nown = t; while(nown!=s){ edge[pree[nown]].flow += delta; edge[pree[nown]^1].flow -= delta; nown = edge[pree[nown]].from; } sumf+=delta,sumc+=delta*dis[t]; } int min_cost_flow(int ans){ int c = 0,f = ans; while(spfa()) argument(c,f); return c; } //ä¸»ç¨‹åº void init(){ read(n),read(m),read(k);s = 1,t = n; for(int i = 1;i\u0026lt;=m;i++){ read(fx[i]),read(tx[i]),read(cx[i]),read(wx[i]); addedge(fx[i],tx[i],cx[i]); } } void solve(){ int ans1 = dinic(),ans2; for(int i = 1;i\u0026lt;=m;i++) addedge(fx[i],tx[i],ans1+k,wx[i]); addedge(n,n+1,ans1+k,0,ans1);t = n+1; //æ³¨æ„è¿™ä¸ªåœ°æ–¹éœ€è¦æ”¹å˜æ±‡ç‚¹ï¼ŒåŠ è¾¹çš„æ—¶å€™éœ€è¦ç»™å®šåˆå§‹æµé‡  ans2 = min_cost_flow(ans1); print(ans1),print(\u0026#39; \u0026#39;),print(ans2),print(\u0026#39;\\n\u0026#39;); } int main(){ init(); solve(); flush(); return 0; }   ","description":"","id":199,"section":"posts","tags":["å›¾è®º","è´¹ç”¨æµ","ç½‘ç»œæµ"],"title":"ã€ŒZJOI2010ã€ç½‘ç»œæ‰©å®¹-ç½‘ç»œæµ-è´¹ç”¨æµ","uri":"https://blog.chenqiqian.com/posts/zjoi2010-network/"},{"content":"ç»™å®šä¸€ä¸ªæœ‰å‘å›¾ $G$ ï¼Œè¯·æ±‚å‡º $G$ çš„æœ€å¤§åŠè¿é€šå­å›¾æ‹¥æœ‰çš„èŠ‚ç‚¹æ•° $K$ ï¼Œä»¥åŠä¸åŒçš„æœ€å¤§åŠè¿é€šå­å›¾çš„æ•°ç›® $C$ ã€‚\nç”±äº $C$ å¯èƒ½æ¯”è¾ƒå¤§ï¼Œä»…è¦æ±‚è¾“å‡º $C$ å¯¹ $X$ çš„ä½™æ•°ã€‚\nå…·ä½“å®šä¹‰ï¼š\nä¸€ä¸ªæœ‰å‘å›¾ $G=(V,E)$ ç§°ä¸ºåŠè¿é€šçš„ $(Semi-Connected)$ ï¼Œå¦‚æœæ»¡è¶³ï¼š$\\forall u,vâˆˆV$ ï¼Œå­˜åœ¨ $u \\rightarrow v$ æˆ– $v \\rightarrow u$ ã€‚å³å¯¹äºå›¾ä¸­ä»»æ„ä¸¤ç‚¹ $u,v$ ï¼Œå­˜åœ¨ä¸€æ¡ $u$ åˆ° $v$ çš„æœ‰å‘è·¯å¾„æˆ–è€…ä» $v$ åˆ° $u$ çš„æœ‰å‘è·¯å¾„ã€‚\nè‹¥ $G'=(V',E')$ æ»¡è¶³ $V'\\subset V$ ï¼Œ $E'$ æ˜¯ $E$ ä¸­æ‰€æœ‰è·Ÿ $V'$ æœ‰å…³çš„è¾¹ï¼Œåˆ™ç§° $G'$ æ˜¯ $G$ çš„ä¸€ä¸ªå¯¼å‡ºå­å›¾ã€‚\nè‹¥ $G'$ æ˜¯ $G$ çš„å¯¼å‡ºå­å›¾ï¼Œä¸” $G'$ åŠè¿é€šï¼Œåˆ™ç§° $G'$ ä¸º $G$ çš„åŠè¿é€šå­å›¾ã€‚\nè‹¥ $G'$ æ˜¯ $G$ æ‰€æœ‰åŠè¿é€šå­å›¾ä¸­åŒ…å«èŠ‚ç‚¹æ•°æœ€å¤šçš„ï¼Œåˆ™ç§° $G'$ æ˜¯ $G$ çš„æœ€å¤§åŠè¿é€šå­å›¾ã€‚\né“¾æ¥ Luogu P2272\nBZOJ 1093\né¢˜è§£ ç»è¿‡è§‚å¯Ÿå’Œåˆ†æå‘ç°ï¼Œä¸€ä¸ªæœ‰å‘å›¾æ˜¯ä¸€ä¸ªåŠè¿é€šå­å›¾å½“ä¸”ä»…å½“å…¶ç¼©ç‚¹åæˆä¸ºä¸€æ¡é“¾ã€‚\nè¿™ä¸ªå¾ˆæ˜¾ç„¶ï¼Œç”»ç”»å›¾å°±å‘ç°äº†ã€‚é‚£ä¹ˆç°åœ¨é—®é¢˜å°±å˜æˆäº†å¯»æ‰¾ä¸€å¼ æœ‰å‘æ— ç¯å›¾é‡Œé¢æœ€é•¿é“¾çš„é•¿åº¦åŠä¸ªæ•°ã€‚\nå¯ä»¥ç”¨dpçš„æ–¹æ³•æ¥æ±‚ã€‚\nçŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š\n$$\nlen[u] = max(len[v])+1 ,\\quad {u,v} \\in E\n$$\n$$\nnum[u] = sum(num[v]) ,\\quad {u,v} \\in E , ;len[u] = len[v] + 1\n$$\næœ‰ä¸€ç‚¹å¾ˆå‘çš„å°±æ˜¯ï¼Œä¸èƒ½æœ‰é‡è¾¹ï¼Œè¦ä¸ç„¶å°±ä¼šæ­»çš„å¾ˆæƒ¨ï¼Œé‡å¤è®¡ç®—å¯¼è‡´ç­”æ¡ˆåå¤§ã€‚\næ‰€ä»¥é‡å»ºå›¾è¦å»é‡ï¼ï¼ï¼\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cctype\u0026gt;#include \u0026lt;cstring\u0026gt;#include \u0026lt;algorithm\u0026gt;using namespace std; namespace fast_io { ... }using namespace fast_io; const int MAXN = 110000,MAXM = 2100000; struct stack{ int num[MAXN],topnum; stack(){topnum = 0;} void pop(){topnum--;} int top(){return num[topnum-1];} void push(int val){num[topnum++] = val;} bool empty(){return topnum != 0;} }a; int n,m,ecnt = 1,X; int fir[MAXN]; int cnt = 1,cnum = 0; int low[MAXN],dfn[MAXN],siz[MAXN]; int col[MAXN]; int instack[MAXN]; struct Edge{ int from,to,nex; bool operator \u0026lt; (Edge a)const{ if(from == a.from) return to \u0026lt; a.to; return from \u0026lt; a.from; } }edge[MAXM]; void addedge(int a,int b){ edge[ecnt].from = a,edge[ecnt].to = b; edge[ecnt].nex = fir[a];fir[a] = ecnt++; } void dfs(int nown){ low[nown] = dfn[nown] = cnt++; instack[nown] = 1;a.push(nown); for(int nowe = fir[nown];nowe;nowe = edge[nowe].nex){ int v = edge[nowe].to; if(dfn[v] == 0) dfs(v),low[nown] = min(low[v],low[nown]); else if(instack[v] == 1) low[nown] = min(dfn[v],low[nown]); } if(low[nown] == dfn[nown]){ cnum++;int j = -1; do{ j = a.top();a.pop(); instack[j] = 0; col[j] = cnum; siz[cnum]++; }while(j!=nown); } } void tarjan(){ for(int i = 1;i\u0026lt;=n;i++) if(dfn[i] == 0) dfs(i); for(int i = 1;i\u0026lt;=m;i++){ edge[i].from = col[edge[i].from]; edge[i].to = col[edge[i].to]; } memset(fir,0,sizeof(fir)); //å»é‡ï¼ï¼ï¼  sort(edge+1,edge+m+1); int lastu = 0,lastv = 0; for(int i = 1;i\u0026lt;=m;i++){ int u = edge[i].from,v = edge[i].to; if(u!=v\u0026amp;\u0026amp;(!(u==lastu\u0026amp;\u0026amp;v==lastv))) addedge(u,v); lastu = u,lastv = v; } } int dp[MAXN],num[MAXN]; void dfs2(int nown){ dp[nown] = siz[nown],num[nown] = 1; for(int nowe = fir[nown];nowe;nowe = edge[nowe].nex){ int v = edge[nowe].to; if(dp[v] == 0) dfs2(v); if(dp[nown] \u0026lt; dp[v] + siz[nown]) dp[nown] = dp[v] + siz[nown],num[nown] = num[v]; else if(dp[nown] == dp[v] + siz[nown]) num[nown] += num[v], num[nown] %= X; } } void solve(){ for(int i = 1;i\u0026lt;=cnum;i++) if(num[i] == 0) dfs2(i); int ans1 = 0,ans2 = 0; for(int i = 1;i\u0026lt;=cnum;i++){ if(dp[i] \u0026gt; ans1) ans1 = dp[i],ans2 = num[i]; else if(dp[i] == ans1) ans2 += num[i],ans2 %=X; } print(ans1),print(\u0026#39;\\n\u0026#39;),print(ans2),print(\u0026#39;\\n\u0026#39;); } void init(){ read(n),read(m),read(X); int a,b; for(int i = 1;i\u0026lt;=m;i++){ read(a),read(b); addedge(a,b); } } int main(){ init(); tarjan(); solve(); flush(); return 0; }   ","description":"","id":200,"section":"posts","tags":["å›¾è®º","å¼ºè¿é€šåˆ†é‡","åŠ¨æ€è§„åˆ’"],"title":"ã€ŒZJOI2007ã€æœ€å¤§åŠè¿é€šå­å›¾-å¼ºè¿é€šåˆ†é‡-dp","uri":"https://blog.chenqiqian.com/posts/zjoi2007-semi-connected/"},{"content":"å¢¨å¢¨è´­ä¹°äº†ä¸€å¥— $N$ æ”¯å½©è‰²ç”»ç¬”ï¼ˆå…¶ä¸­æœ‰äº›é¢œè‰²å¯èƒ½ç›¸åŒï¼‰ã€‚å¢¨å¢¨ä¼šå‘ä½ å‘å¸ƒå¦‚ä¸‹æŒ‡ä»¤ï¼š\n  Q L R ä»£è¡¨è¯¢é—®ä½ ä»ç¬¬ $L$ æ”¯ç”»ç¬”åˆ°ç¬¬ $R$ æ”¯ç”»ç¬”ä¸­å…±æœ‰å‡ ç§ä¸åŒé¢œè‰²çš„ç”»ç¬”ã€‚\n  R P Col æŠŠç¬¬ $P$ æ”¯ç”»ç¬”æ›¿æ¢ä¸ºé¢œè‰² $Col$ ã€‚\n  é“¾æ¥ Luogu P1903\né¢˜è§£ å¸¦ä¿®æ”¹çš„è«é˜Ÿè£¸é¢˜ã€‚\nä¸»è¦éœ€è¦æ³¨æ„çš„å°±æ˜¯è‡ªåŠ è‡ªå‡æ—¶é—´ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;algorithm\u0026gt;#include \u0026lt;cmath\u0026gt;#include \u0026lt;cctype\u0026gt;#include \u0026lt;vector\u0026gt;using namespace std; namespace fast_io { ... }using namespace fast_io; const int MAXN = 11000,MAX = 1100000; int n,m,Q; int col[MAXN],re_col[MAXN],re_pos[MAXN],cnum = 1; int l = 0,r = 0,x = 0; int num[MAX],ans = 0; struct Query{ int id,ql,qr,qx,ans; //è¿ç®—ç¬¦é‡è½½  bool operator \u0026lt; (Query b)const{ if(ql/Q != b.ql/Q) return ql/Q \u0026lt; b.ql/Q; if(qr/Q != b.qr/Q) return qr/Q \u0026lt; b.qr/Q; return qx \u0026lt; b.qx; } }; bool cmp(Query a,Query b){ return a.id \u0026lt; b.id; } vector\u0026lt;Query\u0026gt; query; void init(){ read(n),read(m);Q = sqrt(n*2); for(int i = 1;i\u0026lt;=n;i++) read(col[i]); for(int i = 1;i\u0026lt;=m;i++){ char op[10];int a,b; read(op);read(a),read(b); if(op[0] == \u0026#39;Q\u0026#39;){ Query w;w.ql = a,w.qr = b,w.qx = cnum-1; w.id = i;query.push_back(w); } else if(op[0] == \u0026#39;R\u0026#39;){ re_pos[cnum] = a,re_col[cnum] = b; cnum++; } } sort(query.begin(),query.end()); } //åŠ å…¥ç¬¬posä¸ªæ•°å¹¶æ›´æ–°ç­”æ¡ˆ void add(int pos){ if(num[col[pos]]++ == 0) ans++; } //åˆ å»ç¬¬posä¸ªæ•°å¹¶æ›´æ–°ç­”æ¡ˆ void del(int pos){ if(--num[col[pos]] == 0) ans--; } //è¿›è¡Œç¬¬timesæ¬¡ä¿®æ”¹ void change(int times){ if(l\u0026lt;=re_pos[times]\u0026amp;\u0026amp; re_pos[times] \u0026lt;= r){ if(num[re_col[times]]++ == 0) ans++; if(--num[col[re_pos[times]]] == 0) ans--; } swap(re_col[times],col[re_pos[times]]); } void solve(){ for(int i = 0;i\u0026lt;query.size();i++){ //è«é˜Ÿæ ¸å¿ƒè½¬ç§»  Query w = query[i]; while(l \u0026gt; w.ql) add(--l); while(r \u0026lt; w.qr) add(++r); while(l \u0026lt; w.ql) del(l++); while(r \u0026gt; w.qr) del(r--); while(x \u0026lt; w.qx) change(++x); while(x \u0026gt; w.qx) change(x--); query[i].ans = ans; } sort(query.begin(),query.end(),cmp); for(int i = 0;i\u0026lt;query.size();i++) print(query[i].ans),print(\u0026#39;\\n\u0026#39;); } int main(){ init(); solve(); flush(); return 0; }   ","description":"","id":201,"section":"posts","tags":["æ•°æ®ç»“æ„","è«é˜Ÿ"],"title":"ã€Œå›½å®¶é›†è®­é˜Ÿã€æ•°é¢œè‰²-å¸¦ä¿®æ”¹è«é˜Ÿ","uri":"https://blog.chenqiqian.com/posts/luogu-1903/"},{"content":"ç»™å®šä¸€ä¸ªæ•°åˆ— ${a_n}$ ï¼Œ$m$ æ¬¡è¯¢é—®åœ¨ $[l,r]$ åŒºé—´å†…çš„æœ€å°ä¼—æ•°ã€‚\nå¼ºåˆ¶åœ¨çº¿ã€‚\né“¾æ¥ Luogu P4168\né¢˜è§£ ä¸ºäº†åœ¨è¯¾ä¸Šè®²åˆ†å—ï¼Œç‰¹åœ°åšäº†ä¸€é“å¤§åˆ†å—çš„é¢˜ã€‚\nåšæ³•ä¸€ï¼š\né¢„å¤„ç†å‡º $z[i][j]$ ï¼Œè¡¨ç¤ºåœ¨ $[i,j]$ ä¸ªå—çš„åŒºé—´ä¸­çš„ä¼—æ•°ï¼› $cnt[i][c]$ ï¼Œè¡¨ç¤ºåœ¨å‰iä¸ªæ•°ä¸­é¢œè‰²ä¸ºcçš„æ•°çš„ä¸ªæ•°ã€‚\nå¯ä»¥è¯æ˜ï¼Œä¸€ä¸ªåŒºé—´çš„ä¼—æ•°ï¼Œè‚¯å®šåœ¨æ•´å—çš„ä¼—æ•°å’Œé›¶æ•£å—ä¸­å‡ºç°çš„æ•°ä¸­ã€‚\næ¯æ¬¡æŸ¥è¯¢ï¼Œå…ˆå°†ç­”æ¡ˆè®¾æˆæ•´å—çš„ä¼—æ•°ã€‚å¯¹äºé›¶æ•£çš„æ•°ï¼Œæš´åŠ›ç»Ÿè®¡å‡ºåœ¨é›¶æ•£å—ä¸­å‡ºç°çš„æ¬¡æ•°ï¼Œç„¶ååŠ ä¸Šåœ¨æ•´å—å‡ºç°çš„æ¬¡æ•°ï¼ˆå‰ç¼€å’Œç›¸å‡ï¼‰ï¼Œå°è¯•æ›´æ–°ç­”æ¡ˆã€‚\nå¯ä»¥è¯æ˜ï¼Œå¤æ‚åº¦å¤§çº¦æ˜¯ $O(n\\ \\sqrt{n} )$ ã€‚\nåšæ³•äºŒï¼š\né¢„å¤„ç†å‡º $z[i][j]$ ï¼Œè¡¨ç¤ºåœ¨ $[i,j]$ ä¸ªå—çš„åŒºé—´ä¸­çš„ä¼—æ•°ï¼›å¯¹äºæ¯ä¸€ç§é¢œè‰²ï¼Œå¼€ä¸€ä¸ªvectoræŠŠè¿™ä¸ªæ•°æ¯æ¬¡å‡ºç°çš„ä½ç½®ï¼ŒæŒ‰ä»å‰åˆ°åé¡ºåºåŠ è¿›å»ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ $O(\\log{n})$ çš„æ—¶é—´å†…é€šè¿‡äºŒåˆ†æŸ¥è¯¢å‡ºä¸€ä¸ªæ•°åœ¨ $[l,r]$ åŒºé—´å‡ºç°äº†å¤šå°‘æ¬¡ã€‚\nå¯ä»¥è¯æ˜ï¼Œä¸€ä¸ªåŒºé—´çš„ä¼—æ•°ï¼Œè‚¯å®šåœ¨æ•´å—çš„ä¼—æ•°å’Œé›¶æ•£å—ä¸­å‡ºç°çš„æ•°ä¸­ã€‚\næ¯æ¬¡æŸ¥è¯¢ï¼Œå…ˆå°†ç­”æ¡ˆè®¾æˆæ•´å—çš„ä¼—æ•°ï¼Œå¹¶ä¸”è®°å½•å…¶åœ¨ $[l,r]$ å‡ºç°æ¬¡æ•°ï¼Œç„¶åå¯¹äºæ¯ä¸€ä¸ªé›¶æ•£å—ä¸­çš„æ•°ï¼ŒæŸ¥è¯¢å…¶åœ¨ $[l,r]$ ä¸­å‡ºç°çš„æ¬¡æ•°ï¼Œå¹¶å°è¯•æ›´æ–°ç­”æ¡ˆã€‚\nå¯ä»¥è¯æ˜ï¼Œå¤æ‚åº¦å¤§çº¦æ˜¯ $O(n\\ \\sqrt {n}\\ \\log{n})$ ã€‚è¿™ä¸ªå¤æ‚åº¦å­˜åœ¨è¢«å¡æ­»çš„å¯èƒ½ã€‚\nç”±äºæ•°æ®èŒƒå›´å¾ˆå¤§ï¼Œéœ€è¦ç¦»æ•£åŒ–å¹¶ä¸”è®°å½•ç¦»æ•£åŒ–åçš„æ•°å¯¹åº”ä¹‹å‰çš„æ•°æ˜¯ä»€ä¹ˆã€‚\nä»£ç  åšæ³•ä¸€ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cstring\u0026gt;#include \u0026lt;cctype\u0026gt;#include \u0026lt;cmath\u0026gt;#include \u0026lt;algorithm\u0026gt;using namespace std; //å¿«è¯»æ¨¡ç‰ˆ namespace fast_io { inline char read() {...} inline void read(int \u0026amp;x) {...} inline void read(char *a){...} const int OUT_LEN = 1000000; char obuf[OUT_LEN], *ooh = obuf; inline void print(char c) {...} inline void print(int x) {...} inline void print(char *a){...} inline void flush() {...} }using namespace fast_io; const int MAXN = 101000,MAXQ = 1000; struct pu{ int col,id,belong; }pgy[MAXN]; int n,m,Q; int bl[MAXQ],br[MAXQ],id_to[MAXN],numc = 0; int z[MAXQ][MAXQ],cnt[MAXN][MAXQ],t[MAXN]; bool cmp1(pu a,pu b){return a.col \u0026lt; b.col;} bool cmp2(pu a,pu b){return a.id \u0026lt; b.id;} void init(){ read(n),read(m);Q = sqrt(n); for(int i = 1;i\u0026lt;=n;i++){ read(pgy[i].col); pgy[i].id = i,pgy[i].belong = (i-1)/Q+1; if(!bl[pgy[i].belong]) bl[pgy[i].belong] = i; br[pgy[i].belong] = i; } sort(pgy+1,pgy+n+1,cmp1); int lastc = 0; for(int i = 1;i\u0026lt;=n;i++){ if(pgy[i].col!=lastc) numc++,id_to[numc] = pgy[i].col; lastc = pgy[i].col; pgy[i].col = numc; } sort(pgy+1,pgy+n+1,cmp2); for(int i = 1;i\u0026lt;=n;i++) cnt[pgy[i].col][pgy[i].belong]++; for(int i = 1;i\u0026lt;=numc;i++) for(int j = 1;j\u0026lt;=n/Q;j++) cnt[i][j] += cnt[i][j-1]; } void build(){ for(int i = 1;i\u0026lt;=n;i+=Q){ memset(t,0,sizeof(t)); int maxn = 0; for(int j = i;j\u0026lt;=n;j++){ int nowc = pgy[j].col; t[nowc]++; if(t[nowc] \u0026gt; t[maxn] ||(t[nowc] == t[maxn] \u0026amp;\u0026amp; nowc \u0026lt; maxn)) maxn = nowc; if(j%Q == 0) z[(i-1)/Q+1][j/Q] = maxn; } } } int answer(int ql,int qr){ int lb = pgy[ql].belong,rb = pgy[qr].belong,maxn = 0; //printf(\u0026#34;lblock:%d rblock:%d\\n\u0026#34;,lb,rb);  if(lb == rb || lb+1 == rb){ for(int i = ql;i\u0026lt;=qr;i++) t[pgy[i].col] = 0; for(int i = ql;i\u0026lt;=qr;i++){ int nowc = pgy[i].col; t[nowc]++; if(t[nowc] \u0026gt; t[maxn] ||(t[nowc] == t[maxn] \u0026amp;\u0026amp; nowc \u0026lt; maxn)) maxn = nowc; } } else{ for(int i = ql;i\u0026lt;bl[lb+1];i++) t[pgy[i].col] = 0; for(int i = br[rb-1]+1;i\u0026lt;=qr;i++) t[pgy[i].col] = 0; maxn = z[lb+1][rb-1]; t[maxn] = 0; for(int i = ql;i\u0026lt;bl[lb+1];i++){ int nowc = pgy[i].col; t[nowc]++; int maxnum = t[maxn] + cnt[maxn][rb-1]-cnt[maxn][lb]; int tmp = t[nowc] + cnt[nowc][rb-1]-cnt[nowc][lb]; if(tmp \u0026gt; maxnum || (tmp == maxnum \u0026amp;\u0026amp; nowc \u0026lt; maxn)) maxn = nowc; } for(int i = br[rb-1]+1;i\u0026lt;=qr;i++){ int nowc = pgy[i].col; t[nowc]++; int maxnum = t[maxn] + cnt[maxn][rb-1]-cnt[maxn][lb]; int tmp = t[nowc] + cnt[nowc][rb-1]-cnt[nowc][lb]; if(tmp \u0026gt; maxnum || (tmp == maxnum \u0026amp;\u0026amp; nowc \u0026lt; maxn)) maxn = nowc; } } return id_to[maxn]; } void solve(){ int a,b,lastans = 0; for(int i = 1;i\u0026lt;=m;i++){ read(a),read(b); a = (a+lastans-1)%n+1,b = (b+lastans-1)%n+1; if(a \u0026gt; b) swap(a,b); lastans = answer(a,b); print(lastans),print(\u0026#39;\\n\u0026#39;); } } int main(){ init(); build(); solve(); flush(); return 0; }   åšæ³•äºŒï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cstring\u0026gt;#include \u0026lt;cctype\u0026gt;#include \u0026lt;cmath\u0026gt;#include \u0026lt;algorithm\u0026gt;#include \u0026lt;vector\u0026gt;using namespace std; //å¿«è¯»æ¨¡ç‰ˆ namespace fast_io { inline char read() {...} inline void read(int \u0026amp;x) {...} inline void read(char *a){...} const int OUT_LEN = 1000000; char obuf[OUT_LEN], *ooh = obuf; inline void print(char c) {...} inline void print(int x) {...} inline void print(char *a){...} inline void flush() {...} }using namespace fast_io; const int MAXN = 101000,MAXQ = 1000; vector\u0026lt;int\u0026gt; pos[MAXN]; int n,m,Q; struct pu{ int col,id; }pgy[MAXN]; //åœ¨[i,j]å—ä¸­çš„ä¼—æ•° int z[MAXQ][MAXQ]; int id_to[MAXN]; bool cmp1(pu a,pu b){ return a.col \u0026lt; b.col; } bool cmp2(pu a,pu b){ return a.id \u0026lt; b.id; } void init(){ read(n),read(m);Q = sqrt(n*5); for(int i = 1;i\u0026lt;=n;i++) read(pgy[i].col),pgy[i].id = i; sort(pgy+1,pgy+n+1,cmp1); int lastc = 0,numc = 0; for(int i = 1;i\u0026lt;=n;i++){ if(pgy[i].col!=lastc) numc++,id_to[numc] = pgy[i].col; lastc = pgy[i].col; pgy[i].col = numc; } sort(pgy+1,pgy+n+1,cmp2); for(int i = 1;i\u0026lt;=n;i++){ pos[pgy[i].col].push_back(i); } } void build(){ static int t[MAXN]; for(int i = 1;i\u0026lt;=n;i+=Q){ memset(t,0,sizeof(t)); int maxn = 0; for(int j = i;j\u0026lt;=n;j++){ int nowc = pgy[j].col; t[nowc]++; if(t[nowc] \u0026gt; t[maxn] ||(t[nowc] == t[maxn] \u0026amp;\u0026amp; nowc \u0026lt; maxn)) maxn = nowc; if(j%Q == 0) z[(i-1)/Q+1][j/Q] = maxn; } } } int count_num(int lb,int rb,int num){ return lower_bound(pos[num].begin(),pos[num].end(),rb+1)-lower_bound(pos[num].begin(),pos[num].end(),lb); } int answer(int ql,int qr){ int lb = floor(double(ql-2)/Q)+2,rb = qr/Q,maxn = 0,maxnum = 0; if(lb \u0026lt;= rb) maxn = z[lb][rb],maxnum = count_num(ql,qr,maxn); //printf(\u0026#34;lblock:%d rblock:%d\\n\u0026#34;,lb,rb);  lb = (lb-1)*Q+1,rb = rb*Q; //printf(\u0026#34;lbound:%d rbound:%d maxn:%d\\n\u0026#34;,lb,rb,maxn);  while(ql \u0026lt; lb){ --lb; int c = pgy[lb].col,w = count_num(ql,qr,c); if(w \u0026gt; maxnum || (w == maxnum \u0026amp;\u0026amp; c \u0026lt; maxn)) maxn = c,maxnum = w; } while(rb \u0026lt; qr){ rb++; int c = pgy[rb].col,w = count_num(ql,qr,c); if(w \u0026gt; maxnum || (w == maxnum \u0026amp;\u0026amp; c \u0026lt; maxn)) maxn = c,maxnum = w; } return id_to[maxn]; } void solve(){ int a,b,lastans = 0; for(int i = 1;i\u0026lt;=m;i++){ read(a),read(b); a = (a+lastans-1)%n+1,b = (b+lastans-1)%n+1; if(a \u0026gt; b) swap(a,b); lastans = answer(a,b); print(lastans),print(\u0026#39;\\n\u0026#39;); } } int main(){ init(); build(); solve(); flush(); return 0; }   ","description":"","id":202,"section":"posts","tags":["åˆ†å—","æ•°æ®ç»“æ„"],"title":"ã€ŒVioletã€è’²å…¬è‹±-åˆ†å—","uri":"https://blog.chenqiqian.com/posts/luogu-4168/"},{"content":"ç»™å‡ºä¸€é¢— $n$ ä¸ªèŠ‚ç‚¹çš„æ— æƒæ ‘ï¼Œ $m$ æ¬¡è¯¢é—®ï¼Œæ¯æ¬¡ç»™å‡ºä¸‰ä¸ªç‚¹ç¼–å·ä¸º $a$ ï¼Œ$b$ ï¼Œ $c$ ï¼Œè¯¢é—®åˆ°è¿™ä¸‰ä¸ªç‚¹è·ç¦»æœ€å°çš„ç‚¹çš„ç¼–å·ä»¥åŠå…¶è·ç¦»å’Œã€‚\né“¾æ¥ Luogu P4281\né¢˜è§£ é¦–å…ˆï¼Œå¦‚æœæ¯æ¬¡è¯¢é—®éƒ½åªæœ‰ä¸¤ä¸ªç‚¹ï¼Œè¿™ä¸ªé—®é¢˜å°±å¾ˆç®€å•ï¼Œåªè¦æ˜¯æ ‘ä¸Šçš„è·¯å¾„ä¸Šçš„ç‚¹å°±å¯ä»¥ï¼Œå¯»æ‰¾æ ‘ä¸Šçš„è·¯å¾„å…¶å®å°±æ˜¯å¯»æ‰¾ $LCA$ çš„è¿‡ç¨‹ã€‚è¿™å¯ä»¥å¯å‘æˆ‘ä»¬å¯¹äºä¸‰ä¸ªç‚¹çš„æƒ…å†µçš„æ€è€ƒã€‚\nå¦‚æœè¿™é‡Œæœ‰ä¸‰ä¸ªç‚¹ï¼Œæˆ‘ä»¬æ¥è®¤çœŸçš„æ€è€ƒä¸€ä¸‹ã€‚ç»è¿‡ä¸Šä¸€é—®çš„å¯å‘ï¼Œæˆ‘ä»¬æ¥æ€è€ƒä¸€ä¸‹èƒ½ä¸èƒ½è¿ç”¨ $LCA$ æ¥è§£å†³è¿™é“é¢˜ã€‚\næˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œæ ‘ä¸Šä¸‰ä¸ªç‚¹çš„ä¸‰å¯¹ $LCA$ ä¸€å®šæœ‰ä¸¤ä¸ªæ˜¯ç›¸åŒçš„ã€‚è¿™æ˜¯ä¸€ä»¶æƒ³æƒ³çš„è¯æ¯”è¾ƒæ˜¾ç„¶çš„äº‹æƒ…ã€‚å¿…ç„¶èƒ½å¤Ÿæ‰¾åˆ°æŸä¸ªèŠ‚ç‚¹ï¼Œè®©ä¸‰ä¸ªç‚¹ä¸­çš„ä¸¤ä¸ªåœ¨ä¸€ä¾§ï¼Œä¸€ä¸ªåœ¨å¦ä¸€ä¾§ã€‚è€Œè¿™ä¸ªç‚¹å°±æ˜¯ä¸¤ä¸ªå…¬å…±çš„ $LCA$ ã€‚æ€è€ƒçš„å†æ·±å…¥äº›ï¼ˆå¹¶ä¸”ç»“åˆçè’™ï¼‰ï¼Œæˆ‘ä»¬ä¼šå‘ç°è¿™ä¸ªç›¸åŒçš„ $LCA$ è‚¯å®šæ˜¯æ·±åº¦æœ€å°çš„ä¸€ä¸ª $LCA$ ã€‚\nè¿™é‡Œï¼Œæˆ‘ä»¬é¦–å…ˆå¯ä»¥æ˜¾è€Œæ˜“è§çš„å‘ç°ï¼Œè¿™ä¸ªç‚¹å¿…é¡»åœ¨ä¸‰ä¸ªç‚¹äº’ç›¸é€šè¾¾çš„è·¯å¾„ä¸Šã€‚\næˆ‘ä»¬å†æ€è€ƒä¸€ä¸‹ $LCA$ ä¸è·¯å¾„å’Œçš„å…³ç³»ã€‚å‡è®¾æˆ‘ä»¬çŸ¥é“ $a$ å’Œ $b$ çš„ $LCA$ æ˜¯ $x$ ï¼Œè€Œä¸” $x$ æ˜¯ä¸Šè¿°çš„3ä¸ª $LCA$ ä¸­æ·±åº¦æœ€å¤§çš„é‚£ä¸ªï¼Œé‚£ä¹ˆå¯ä»¥å‘ç°ä» $x$ åˆ° $a$ çš„è·ç¦»åŠ ä¸Šä» $x$ åˆ° $b$ çš„è·ç¦»ä¸€å®šæ˜¯æœ€å°çš„ã€‚æ ¹æ®ä¸Šé¢çš„ç»“è®ºï¼Œæˆ‘ä»¬çŸ¥é“ $a$ ï¼Œ $c$ å’Œ $b$ ï¼Œ $c$ çš„ $LCA$ ç‚¹ $y$ ä¸€å®šåœ¨ä¸€ä¸ªç‚¹ä¸Šï¼Œè€Œä¸”è¿™ä¸ª $y$ ä¸€å®šæ¯” $x$ æ·±åº¦å°ã€‚\né‚£ä¹ˆè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬ä¼šå‘ç°æ­¤æ—¶ $a$ ï¼Œ $b$ ï¼Œ $c$ åˆ° $x$ çš„è·ç¦»å’Œæ˜¯æœ€å°çš„ã€‚è¯æ˜çš„è¯å¯ä»¥è¿™ä¹ˆæƒ³ï¼šå¦‚æœ $x'$ æ¯” $x$ é«˜ï¼Œé‚£ä¹ˆè™½ç„¶ $c$ åˆ° $x$ çš„è·ç¦»å‡å°äº† $w$ ï¼Œä½†æ˜¯ $a$ ï¼Œ $b$ åˆ° $x'$ çš„è·ç¦»å‡å¢å¤§äº† $w$ ï¼Œæ˜¾ç„¶è·ç¦»å’Œå¢å¤§ã€‚å¦‚æœ $x'$ æ¯” $x$ ä½ï¼Œæœ‰ä¸€ä¸ªèŠ‚ç‚¹åˆ° $x'$ çš„è·ç¦»å‡å°äº† $w$ ï¼Œå‰©ä¸‹ä¸¤ä¸ªèŠ‚ç‚¹åˆ° $x'$ çš„è·ç¦»å‡å¢å¤§äº† $w$ ï¼Œæ˜¾ç„¶è·ç¦»å’Œä¹Ÿå¢å¤§ã€‚\næ‰€ä»¥æˆ‘ä»¬å°±æ‰¾åˆ°äº†åˆ°ä¸‰ä¸ªç‚¹è·ç¦»å’Œæœ€å°çš„ç‚¹ï¼šè¿™ä¸‰ä¸ªç‚¹çš„ä¸‰å¯¹ $LCA$ ä¸­ï¼Œæ·±åº¦å¤§çš„é‚£ä¸¤ä¸ªLCAå°±æ˜¯ç­”æ¡ˆã€‚\næˆ‘ä»¬åœ¨æ±‚ $LCA$ ä¹‹å‰ï¼Œå¯ä»¥å…ˆé¢„å¤„ç†å‡ºæ·±åº¦$dep$ï¼Œé‚£ä¹ˆä»èŠ‚ç‚¹ $u$ åˆ° $v$ çš„è·¯å¾„é•¿åº¦å°±æ˜¯$dis = dep[u] + dep[v] - 2*dep[lca(u,v)]$ã€‚è¿ç”¨è¿™ä¸ªå¼å­åˆ†åˆ«ç®—å‡º $a$ , $b$ , $c$ åˆ° $a1$ , $b1$ , $c1$ï¼ˆä¸‰ä¸ª $LCA$ ï¼‰çš„è·ç¦»ï¼Œæœ€åå‘ç°æ€»çš„ $dis$ å±…ç„¶æ˜¯è½®æ¢å¼ï¼š$ans = dep[a]+dep[b]+dep[c]-dep[a1]-dep[b1]-dep[c1]$ï¼Œ æ‰€ä»¥å°±ä¸ç”¨åˆ†ç±»è®¨è®ºäº†ã€‚\n$LCA$ æˆ‘ç”¨äº†æ ‘é“¾å‰–åˆ†æ¥æ±‚ï¼Œé¡ºå¸¦å¤„ç†æ·±åº¦ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cctype\u0026gt;#include \u0026lt;vector\u0026gt;using namespace std; namespace fast_io { inline char read() { static const int IN_LEN = 1000000; static char buf[IN_LEN], *s, *t; return s==t?(((t=(s=buf)+fread(buf,1,IN_LEN,stdin))== s)?-1:*s++) : *s++; } inline void read(int \u0026amp;x) { static bool iosig; static char c; for (iosig = false, c = read(); !isdigit(c); c = read()) { if (c == \u0026#39;-\u0026#39;) iosig = true; if (c == -1) return; } for (x = 0; isdigit(c); c = read()) x = ((x+(x\u0026lt;\u0026lt;2))\u0026lt;\u0026lt;1) + (c ^ \u0026#39;0\u0026#39;); if (iosig) x = -x; } const int OUT_LEN = 1000000;char obuf[OUT_LEN], *ooh = obuf; inline void print(char c) { if (ooh == obuf + OUT_LEN) fwrite(obuf, 1, OUT_LEN, stdout), ooh = obuf; *ooh++ = c; } inline void print(int x) { static int buf[30], cnt; if (x == 0) print(\u0026#39;0\u0026#39;); else { if (x \u0026lt; 0) print(\u0026#39;-\u0026#39;), x = -x; for (cnt = 0; x; x /= 10) buf[++cnt] = x % 10 + 48; while (cnt) print((char)buf[cnt--]); } } inline void flush() { fwrite(obuf, 1, ooh - obuf, stdout); } }using namespace fast_io; const int MAXN = 510000; vector\u0026lt;int\u0026gt; edge[MAXN]; int n,m; int dep[MAXN],siz[MAXN],fa[MAXN],son[MAXN],top[MAXN],id[MAXN],cnt = 1; //æ·»åŠ ä»aåˆ°bçš„æ— å‘è¾¹ void addedge(int a,int b){ edge[a].push_back(b); edge[b].push_back(a); } //æ ‘é“¾å‰–åˆ†çš„ç¬¬ä¸€ä¸ªdfs void dfs1(int nown,int f,int depth){ siz[nown] = 1,fa[nown] = f,dep[nown] = depth; int maxsum = -1;son[nown] = 0; for(int i = 0;i\u0026lt;edge[nown].size();i++){ int to = edge[nown][i]; if(to == f) continue; dfs1(to,nown,depth+1); if(siz[to] \u0026gt; maxsum) maxsum = siz[to],son[nown] = to; siz[nown] += siz[to]; } } //æ ‘é“¾å‰–åˆ†çš„ç¬¬äºŒä¸ªdfs void dfs2(int nown,int topf){ id[nown] = cnt++;top[nown] = topf; if(son[nown] == 0) return; dfs2(son[nown],topf); for(int i = 0;i\u0026lt;edge[nown].size();i++){ int to = edge[nown][i]; if(to == fa[nown]|| to == son[nown]) continue; dfs2(to,to); } } //æ±‚a,bä¸¤ç‚¹çš„LCA int lca(int a,int b){ while(top[a]!=top[b]){ if(dep[top[a]] \u0026lt; dep[top[b]]) swap(a,b); a = fa[top[a]]; } if(dep[a] \u0026lt; dep[b]) swap(a,b); return b; } //åˆå§‹åŒ–ä»¥åŠdfs void init(){ read(n),read(m); int a,b; for(int i = 1;i\u0026lt;=n-1;i++){ read(a),read(b); addedge(a,b); } dfs1(1,0,1); dfs2(1,1); } //å›åº”è¯¢é—® void solve(){ int a,b,c,a1,b1,c1,ans,dis; for(int i = 1;i\u0026lt;=m;i++){ read(a),read(b),read(c); //a1,b1,c1çš„æ„ä¹‰è§ä¸‹  a1 = lca(a,b),b1 = lca(b,c),c1 = lca(c,a); dis = 0; if(a1 == b1) ans = c1; else if(b1 == c1) ans = a1; else if(c1 == a1) ans = b1; //è®¡ç®—disçš„å…¬å¼  dis = dep[a] + dep[b] + dep[c] - dep[a1] - dep[b1] - dep[c1]; print(ans),print(\u0026#39; \u0026#39;),print(dis),print(\u0026#39;\\n\u0026#39;); } } int main(){ init(); solve(); flush(); return 0; }   ","description":"","id":203,"section":"posts","tags":["æœ€è¿‘å…¬å…±ç¥–å…ˆ","å›¾è®º","æ ‘å½¢ç»“æ„"],"title":"ã€ŒAHOI2008ã€ç´§æ€¥é›†åˆ-LCA","uri":"https://blog.chenqiqian.com/posts/ahoi2008-emergency/"},{"content":"ç»™å®šä¸€æ£µæœ‰ $n$ ä¸ªèŠ‚ç‚¹çš„æ— æ ¹æ ‘å’Œ $m$ ä¸ªæ“ä½œï¼Œæ“ä½œæœ‰ä¸¤ç±»ï¼š\n å°†èŠ‚ç‚¹ $a$ åˆ°èŠ‚ç‚¹ $b$ è·¯å¾„ä¸Šæ‰€æœ‰ç‚¹éƒ½æŸ“æˆé¢œè‰² $c$ ï¼› è¯¢é—®èŠ‚ç‚¹ $a$ åˆ°èŠ‚ç‚¹ $b$ è·¯å¾„ä¸Šçš„é¢œè‰²æ®µæ•°é‡ï¼ˆè¿ç»­ç›¸åŒé¢œè‰²è¢«è®¤ä¸ºæ˜¯åŒä¸€æ®µï¼‰ï¼Œ  å¦‚â€œ112221â€ç”±3æ®µç»„æˆï¼šâ€œ11â€ã€â€œ222â€å’Œâ€œ1â€ã€‚\nè¯·ä½ å†™ä¸€ä¸ªç¨‹åºä¾æ¬¡å®Œæˆè¿™ $m$ ä¸ªæ“ä½œã€‚\né“¾æ¥ Luogu P2486\né¢˜è§£ è¿™é“é¢˜æ˜¯ä¸€é“ä¸æ˜¯å¾ˆéš¾çš„æ ‘é“¾å‰–åˆ†+çº¿æ®µæ ‘çš„é¢˜ç›®ã€‚\nå¾ˆæ˜æ˜¾æ˜¯ä¸€é“æ ‘é“¾å‰–åˆ†çš„é¢˜ç›®ï¼Œæˆ‘ä»¬åªéœ€è¦ææ˜ç™½ï¼šå¦‚ä½•ç»´æŠ¤åŒºé—´çš„é¢œè‰²å—çš„æ•°ç›®ã€‚\nå¾ˆå®¹æ˜“æƒ³åˆ°ç”¨çº¿æ®µæ ‘æ¥ç»´æŠ¤è¿™ä¸ªä¸œè¥¿ã€‚æ‰€ä»¥æˆ‘ä»¬åªè¦ç»´æŠ¤ä¸‰ä¸ªä¸œè¥¿ï¼šå·¦ç«¯ç‚¹çš„é¢œè‰²ï¼Œå³ç«¯ç‚¹çš„é¢œè‰²ï¼Œæ€»å…±çš„é¢œè‰²å—æ•°ç›®ã€‚\nåœ¨åˆå¹¶çš„æ—¶å€™ï¼Œå¦‚æœå·¦è¾¹å—çš„å³ç«¯ç‚¹çš„é¢œè‰²ç­‰äºå³è¾¹å—çš„å·¦ç«¯ç‚¹é¢œè‰²ï¼Œå°±ç»™æ€»é¢œè‰²å—æ•°ç›®å‡1ï¼Œå°±å¯ä»¥è¾¾æˆåˆå¹¶åŒºé—´çš„ç›®çš„ã€‚åˆå¹¶åçš„å—çš„å·¦é¢œè‰²ç­‰äºå·¦å­©å­çš„å·¦é¢œè‰²ï¼Œå³é¢œè‰²ç­‰äºå³å­©å­çš„å³é¢œè‰²ã€‚æ€»å…±çš„é¢œè‰²å—æ•°ç›®æ˜¯ä¸¤å—é¢œè‰²å—çš„æ•°ç›®åŠ èµ·æ¥ï¼Œå†åˆ¤ä¸€ä¸‹å‰æ–‡æåˆ°çš„ç›¸åŒçš„é¢œè‰²å°±è¡Œäº†\nç”±äºæˆ‘å¤ªèœäº†ï¼Œæ‰€ä»¥æœ‰çš„åœ°æ–¹æ‡’å¾—å»æƒ³ï¼Œå°±å¤šåŠ äº†å‡ ä¸ª if else... äº†äº‹ï¼Œä»£ç ä¹Ÿå°±é•¿äº›ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;vector\u0026gt;#include \u0026lt;cctype\u0026gt;#define lson (nown\u0026lt;\u0026lt;1) #define rson (nown\u0026lt;\u0026lt;1|1) #define mid ((l+r)\u0026gt;\u0026gt;1) using namespace std; //å¿«è¯»æ¨¡ç‰ˆ namespace fast_io { inline char read() {...} inline void read(int \u0026amp;x) {...} inline void read(char *a){...} const int OUT_LEN = 1000000; char obuf[OUT_LEN], *ooh = obuf; inline void print(char c) {...} inline void print(int x) {...} inline void print(char *a){...} inline void flush() {...} }using namespace fast_io; const int MAXN = 110000; int n,m; int son[MAXN],top[MAXN],fa[MAXN],siz[MAXN],dep[MAXN]; int id[MAXN],id_to[MAXN],num[MAXN],cnt = 1; vector\u0026lt;int\u0026gt; edge[MAXN]; //çº¿æ®µæ ‘èŠ‚ç‚¹å®šä¹‰ struct node{ int num,lcol,rcol; bool lazy; node(int n = 0,int l = 0,int r = 0):num(n),lcol(l),rcol(r){}; bool empty(){ return num == 0; } }pool[MAXN\u0026lt;\u0026lt;2]; //çº¿æ®µæ ‘èŠ‚ç‚¹çš„åˆå¹¶ inline node merge(node l,node r){ //ç‰¹åˆ¤ï¼ï¼ï¼  if(l.empty()) return r; if(r.empty()) return l; node ans; ans.num = l.num+r.num; if(l.rcol == r.lcol) ans.num-=1; ans.lcol = l.lcol,ans.rcol = r.rcol; return ans; } //çº¿æ®µæ ‘çš„æ ‡è®°ä¸‹ä¼  inline void push_down(int nown,int l,int r){ if(pool[nown].lazy){ int c = pool[nown].lcol; pool[lson] = node(1,c,c),pool[lson].lazy = 1; pool[rson] = node(1,c,c),pool[rson].lazy = 1; pool[nown].lazy = 0; } } //åè½¬åŒºé—´ inline node reverse(node nown){ swap(nown.lcol,nown.rcol); return nown; } //å»ºæ ‘ inline void build(int nown,int l,int r){ pool[nown].lazy = 0; if(l == r) pool[nown] = node(1,num[id_to[l]],num[id_to[l]]); else{ build(lson,l,mid); build(rson,mid+1,r); pool[nown] = merge(pool[lson],pool[rson]); } } //çº¿æ®µæ ‘åŒºé—´æ›´æ–° inline void update(int nown,int l,int r,int ql,int qr,int c){ if(ql\u0026lt;=l\u0026amp;\u0026amp;r\u0026lt;=qr){ pool[nown] = node(1,c,c); pool[nown].lazy = 1; } else{ push_down(nown,l,r); if(ql\u0026lt;=mid) update(lson,l,mid,ql,qr,c); if(qr\u0026gt;=mid+1) update(rson,mid+1,r,ql,qr,c); pool[nown] = merge(pool[lson],pool[rson]); } } //çº¿æ®µæ ‘åŒºé—´æŸ¥è¯¢é¢œè‰²å—æ ‘ inline node query(int nown,int l,int r,int ql,int qr){ if(ql\u0026lt;=l\u0026amp;\u0026amp;r\u0026lt;=qr) return pool[nown];//è¿™é‡Œçš„è¿”å›å€¼æ˜¯æ•´ä¸ªç»“æ„ä½“  else{ push_down(nown,l,r); if(ql\u0026lt;=mid \u0026amp;\u0026amp; mid+1\u0026lt;=qr){ node ls,rs; ls = query(lson,l,mid,ql,qr); rs = query(rson,mid+1,r,ql,qr); return merge(ls,rs); } else if(qr\u0026lt;=mid) return query(lson,l,mid,ql,qr); else if(ql\u0026gt;=mid+1) return query(rson,mid+1,r,ql,qr); } } /*--- ä»¥ä¸‹ä¸ºæ ‘é“¾å‰–åˆ†æ¨¡ç‰ˆ ---*/ inline void dfs1(int nown,int f,int depth){ dep[nown] = depth,fa[nown] = f,siz[nown] = 1; son[nown] = 0;int maxsum = -1; for(int i = 0;i\u0026lt;edge[nown].size();i++){ int to = edge[nown][i]; if(to == f) continue; dfs1(to,nown,depth+1); siz[nown]+=siz[to]; if(siz[to]\u0026gt;maxsum) maxsum = siz[to],son[nown] = to; } } inline void dfs2(int nown,int topf){ top[nown] = topf,id[nown] = cnt,id_to[cnt] = nown;cnt++; if(!son[nown]) return; dfs2(son[nown],topf); for(int i = 0;i\u0026lt;edge[nown].size();i++){ int to = edge[nown][i]; if(to == fa[nown]||to == son[nown]) continue; dfs2(to,to); } } void update_range(int x,int y,int c){ while(top[x]!=top[y]){ if(dep[top[x]]\u0026lt;dep[top[y]]) swap(x,y); update(1,1,n,id[top[x]],id[x],c); x = fa[top[x]]; } if(dep[x]\u0026gt;dep[y]) swap(x,y); update(1,1,n,id[x],id[y],c); } //è¿™é‡Œå¤šç”¨äº†å‡ ä¸ªif else å’Œreverseæ¥è®©é¢œè‰²å—æ¥å¯¹æ–¹å‘ //å¯ä»¥åŒæ—¶äº¤æ¢lanså’Œransç­‰æ¥å®Œæˆè¿™ä¸€é¡¹(æœªç»éªŒè¯) int query_range(int x,int y){ node lans = node(0,0,0),rans = node(0,0,0); while(top[x]!=top[y]){ if(dep[top[x]] \u0026gt; dep[top[y]]){ lans = merge(lans,reverse(query(1,1,n,id[top[x]],id[x]))); x = fa[top[x]]; } else{ rans = merge(query(1,1,n,id[top[y]],id[y]),rans); y = fa[top[y]]; } } if(dep[x]\u0026lt;dep[y]) lans = merge(lans,query(1,1,n,id[x],id[y])); else rans = merge(reverse(query(1,1,n,id[y],id[x])),rans); return merge(lans,rans).num; } /*--- ä»¥ä¸Šä¸ºæ ‘é“¾å‰–åˆ†æ¨¡ç‰ˆ ---*/ //ç¨‹åºçš„åˆå§‹åŒ– inline void init(){ read(n),read(m); for(int i = 1;i\u0026lt;=n;i++) read(num[i]); int a,b; for(int i = 1;i\u0026lt;=n-1;i++){ read(a),read(b); edge[a].push_back(b); edge[b].push_back(a); } dfs1(1,0,1); dfs2(1,1); build(1,1,n); } //å›åº”è¯¢é—® void solve(){ char op[20];int a,b,c; for(int i = 1;i\u0026lt;=m;i++){ read(op),read(a),read(b); if(op[0] == \u0026#39;C\u0026#39;) read(c),update_range(a,b,c); else if(op[0] == \u0026#39;Q\u0026#39;) print(query_range(a,b)),print(\u0026#39;\\n\u0026#39;); } } int main(){ init(); solve(); flush(); return 0; }   ","description":"","id":204,"section":"posts","tags":["æ•°æ®ç»“æ„","æ ‘é“¾å‰–åˆ†","çº¿æ®µæ ‘"],"title":"ã€ŒSDOI2011ã€æŸ“è‰²-æ ‘é“¾å‰–åˆ†+çº¿æ®µæ ‘","uri":"https://blog.chenqiqian.com/posts/sdoi2011-colour/"},{"content":"\u0008ç»™å®šä¸€é¢— $n$ ä¸ªèŠ‚ç‚¹çš„æ ‘ï¼ŒèŠ‚ç‚¹ç¼–å·ä¸º $1$ åˆ° $n$ ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ªæƒå€¼ $w_i$ ã€‚\næœ‰ä»¥ä¸‹ä¸‰ç§æ“ä½œæˆ–è¯¢é—®ï¼š\nI. CHANGE u t : æŠŠç»“ç‚¹ $u$ çš„æƒå€¼æ”¹ä¸º $t$\nII. QMAX u v: è¯¢é—®ä»ç‚¹ $u$ åˆ°ç‚¹ $v$ çš„è·¯å¾„ä¸Šçš„èŠ‚ç‚¹çš„æœ€å¤§æƒå€¼\nIII. QSUM u v: è¯¢é—®ä»ç‚¹ $u$ åˆ°ç‚¹ $v$ çš„è·¯å¾„ä¸Šçš„èŠ‚ç‚¹çš„æƒå€¼å’Œ\né“¾æ¥ Luogu P2590\né¢˜è§£ æ ‘é“¾å‰–åˆ†æ¨¡ç‰ˆé¢˜ã€‚\nè¿›è¡Œæ ‘é“¾å‰–åˆ†ä¹‹åï¼Œç”±äºæ³¨æ„åˆ°è¿™é‡Œåªæœ‰å•ç‚¹ä¿®æ”¹ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨ä¸€ä¸ª zkw çº¿æ®µæ ‘æ¥ç»´æŠ¤è¿™äº›ä¿¡æ¯ã€‚\n  å¯¹äº CHANGE æ“ä½œï¼Œæˆ‘ä»¬ç›´æ¥æ›´æ”¹å¶å­èŠ‚ç‚¹çš„å€¼ï¼Œç„¶åè¿›è¡Œ zkw çº¿æ®µæ ‘çš„ä»ä¸‹åˆ°ä¸Šçš„æ›´æ–°æ“ä½œï¼Œç›´åˆ°æ ¹ã€‚\n  å¯¹äº QMAX æ“ä½œï¼Œæˆ‘ä»¬å°±ç”¨æ ‘é“¾å‰–åˆ†çš„å¸¸è§„æ“ä½œï¼Œæ¯ä¸€æ­¥æ±‚ä¸€ä¸ªæœ€å¤§å€¼ï¼Œç„¶åæ›´æ–°ç­”æ¡ˆå³å¯ã€‚ QSUM åŒç†ã€‚\n  äº‹å®ä¸Šï¼Œè¿™ä¸ªé¢˜å‡¸æ˜¾å‡ºæ¥ zkw çº¿æ®µæ ‘åœ¨å•ç‚¹ä¿®æ”¹ä¸ŠçœŸæ˜¯ä¸ä¸€èˆ¬çš„å¿«ï¼Œä»¥æˆ‘çš„åƒåœ¾ coding æ°´å¹³å±…ç„¶èƒ½åœ¨ bzoj ä¸Šæ’åˆ°ç¬¬ä¸€é¡µã€‚\n$zkw$ wå¤§æ³•å¥½ï¼\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;vector\u0026gt;#include \u0026lt;cctype\u0026gt;using namespace std; const int MAXN = 31000; inline int max(int a,int b){ return b\u0026gt;a?b:a; } namespace fast_io { inline char read() { //return getchar();  static const int IN_LEN = 1000000; static char buf[IN_LEN], *s, *t; return s==t?(((t=(s=buf)+fread(buf,1,IN_LEN,stdin))== s)?-1:*s++) : *s++; } inline void read(int \u0026amp;x) { static bool iosig; static char c; for (iosig = false, c = read(); !isdigit(c); c = read()) { if (c == \u0026#39;-\u0026#39;) iosig = true; if (c == -1) return; } for (x = 0; isdigit(c); c = read()) x = ((x + (x \u0026lt;\u0026lt; 2)) \u0026lt;\u0026lt; 1)+(c^48); if (iosig) x = -x; } inline void read(char *a){ static char c = read(); while(c!= -1\u0026amp;\u0026amp;(c == \u0026#39; \u0026#39;||c ==\u0026#39;\\n\u0026#39;)) c = read(); while(c!= -1\u0026amp;\u0026amp;c!=\u0026#39; \u0026#39;\u0026amp;\u0026amp;c!=\u0026#39;\\n\u0026#39;) *a++ = c,c = read(); *a = 0; } const int OUT_LEN = 1000000; char obuf[OUT_LEN], *ooh = obuf; inline void print(char c) { if(ooh == obuf+OUT_LEN) fwrite(obuf,1,OUT_LEN,stdout),ooh=obuf; *ooh++ = c; } inline void print(int x) { static int buf[30], cnt; if(x == 0) print(\u0026#39;0\u0026#39;); else { if (x \u0026lt; 0) print(\u0026#39;-\u0026#39;), x = -x; for (cnt = 0; x; x /= 10) buf[++cnt] = x % 10 + 48; while (cnt) print((char)buf[cnt--]); } } inline void print(char *a){ while(*a) print(*a++); } inline void flush() { fwrite(obuf, 1, ooh - obuf, stdout); } }using namespace fast_io; int maxn[MAXN\u0026lt;\u0026lt;2],sumn[MAXN\u0026lt;\u0026lt;2]; int n,M,q,num[MAXN]; //topæ•°ç»„æ˜¯é“¾å­æœ€ä¸Šé¢çš„èŠ‚ç‚¹ï¼Œfaæ˜¯çˆ¶èŠ‚ç‚¹ï¼Œsonæ˜¯é‡å„¿å­èŠ‚ç‚¹ï¼Œsizæ˜¯å­æ ‘å¤§å°ï¼Œdepæ˜¯dfsæ·±åº¦ int top[MAXN],fa[MAXN],son[MAXN],siz[MAXN],dep[MAXN]; //id_to æ˜¯iå·idæŒ‡å‘çš„èŠ‚ç‚¹ç¼–å·ï¼Œidå°±æ˜¯iå·èŠ‚ç‚¹çš„dfsç¼–å· int id_to[MAXN],id[MAXN]; int cnt = 1; vector\u0026lt;int\u0026gt; edge[MAXN]; //zkwçº¿æ®µæ ‘åˆå§‹åŒ– inline void init_seg(){ for(M = 1;M\u0026lt;n+2;M\u0026lt;\u0026lt;=1); for(int i = 1;i\u0026lt;=n;i++) maxn[M+i] = sumn[M+i] = num[id_to[i]]; for(int i = M-1;i;i--) maxn[i]=max(maxn[i\u0026lt;\u0026lt;1],maxn[i\u0026lt;\u0026lt;1|1]),sumn[i]=sumn[i\u0026lt;\u0026lt;1]+sumn[i\u0026lt;\u0026lt;1|1]; } //zkwçº¿æ®µæ ‘åŒºé—´æœ€å€¼ inline int max_seg(int l,int r){ int ans = -100000; for(l=l+M-1,r=r+M+1;l^r^1;l\u0026gt;\u0026gt;=1,r\u0026gt;\u0026gt;=1){ if(~l\u0026amp;1 \u0026amp;\u0026amp; maxn[l^1]\u0026gt;ans) ans = maxn[l^1]; if(r\u0026amp;1 \u0026amp;\u0026amp; maxn[r^1]\u0026gt;ans) ans = maxn[r^1]; } return ans; } //zkwçº¿æ®µæ ‘åŒºé—´æ±‚å’Œ inline int sum_seg(int l,int r){ int ans = 0; for(l=l+M-1,r=r+M+1;l^r^1;l\u0026gt;\u0026gt;=1,r\u0026gt;\u0026gt;=1){ if(~l\u0026amp;1) ans += sumn[l^1]; if(r\u0026amp;1) ans += sumn[r^1]; } return ans; } //zkwçº¿æ®µæ ‘ä¿®æ”¹ inline void upd_seg(int pos,int x){ int nown = pos+M; maxn[nown] = sumn[nown] = x; while(nown\u0026gt;\u0026gt;=1){ maxn[nown] = max(maxn[nown\u0026lt;\u0026lt;1],maxn[nown\u0026lt;\u0026lt;1|1]); sumn[nown] = sumn[nown\u0026lt;\u0026lt;1]+sumn[nown\u0026lt;\u0026lt;1|1]; } } //æ ‘é“¾å‰–åˆ†çš„ç¬¬ä¸€ä¸ªdfs inline void dfs1(int nown,int f,int depth){ son[nown] = 0,dep[nown] = depth,siz[nown] = 1,fa[nown] = f; int maxsum = 0; for(int i = 0;i\u0026lt;edge[nown].size();i++){ int to = edge[nown][i]; if(to == f) continue; dfs1(to,nown,depth+1); siz[nown]+=siz[to]; if(siz[to]\u0026gt;maxsum) maxsum = siz[to],son[nown] = to; } } //æ ‘é“¾å‰–åˆ†çš„ç¬¬äºŒä¸ªdfs inline void dfs2(int nown,int topf){ id[nown] = cnt; id_to[cnt++] = nown; top[nown] = topf; if(!son[nown]) return; dfs2(son[nown],topf); for(int i = 0;i\u0026lt;edge[nown].size();i++){ int to = edge[nown][i]; if(to == son[nown]||to == fa[nown]) continue; dfs2(to,to); } } //æŸ¥è¯¢è·¯å¾„å’Œ inline int query_sum(int x,int y){ int ans = 0; while(top[x]!=top[y]){ if(dep[top[x]]\u0026lt;dep[top[y]]) swap(x,y); ans+=sum_seg(id[top[x]],id[x]); x = fa[top[x]]; } if(dep[x]\u0026gt;dep[y]) swap(x,y); ans+=sum_seg(id[x],id[y]); return ans; } //æŸ¥è¯¢è·¯å¾„æœ€å¤§å€¼ inline int query_max(int x,int y){ int ans = -100000; while(top[x]!=top[y]){ if(dep[top[x]]\u0026lt;dep[top[y]]) swap(x,y); ans = max(ans,max_seg(id[top[x]],id[x])); x = fa[top[x]]; } if(dep[x]\u0026gt;dep[y]) swap(x,y); ans = max(ans,max_seg(id[x],id[y])); return ans; } //ä¿®æ”¹æŸä¸ªèŠ‚ç‚¹ inline void update(int pos,int x){ upd_seg(id[pos],x); } //åˆå§‹åŒ–å›¾å’Œçº¿æ®µæ ‘è¿˜æœ‰ä¸¤æ¬¡dfs void init(){ read(n); int a,b; for(int i = 1;i\u0026lt;=n-1;i++){ read(a),read(b); edge[a].push_back(b); edge[b].push_back(a); } for(int i = 1;i\u0026lt;=n;i++) read(num[i]); dfs1(1,0,1); dfs2(1,1); init_seg(); } //è¿›è¡Œæ“ä½œä»¥åŠå›ç­”è¯¢é—® void solve(){ read(q); char op[20]; int a,b; for(int i = 1;i\u0026lt;=q;i++){ read(op),read(a),read(b); if(op[1] == \u0026#39;M\u0026#39;) print(query_max(a,b)),print(\u0026#39;\\n\u0026#39;); else if(op[1] == \u0026#39;S\u0026#39;) print(query_sum(a,b)),print(\u0026#39;\\n\u0026#39;); else if(op[1] == \u0026#39;H\u0026#39;) update(a,b); } } int main(){ init(); solve(); flush(); return 0; }   ","description":"","id":205,"section":"posts","tags":["æ•°æ®ç»“æ„","æ ‘é“¾å‰–åˆ†"],"title":"ã€ŒZJOI2008ã€æ ‘çš„ç»Ÿè®¡-æ ‘é“¾å‰–åˆ†","uri":"https://blog.chenqiqian.com/posts/zjoi2008-count/"},{"content":"ç»™å®šä¸€æ£µç”± $n$ ä¸ªèŠ‚ç‚¹æ„æˆçš„æ ‘ã€‚\nåœ¨æ ‘ä¸Šå­˜åœ¨ä¸€ä¸ªâ€œæ¿€å‘å™¨â€ï¼Œæ ‡å·ä¸º $s$ ã€‚å½“æ¿€å‘å™¨å·¥ä½œåï¼Œç”µæµä¼šå»¶è¾¹ä¼ å‘æ¯ä¸€ä¸ªç›¸é‚»èŠ‚ç‚¹ã€‚è€Œä¸­é—´èŠ‚ç‚¹æ¥æ”¶åˆ°ç”µæµåï¼Œä¼šå°†è¯¥ç”µæµä¼ å‘ä¸å®ƒè¿æ¥å¹¶ä¸”å°šæœªæ¥æ”¶åˆ°ç”µæµçš„èŠ‚ç‚¹ã€‚å¯¹äºæ¯æ¡è¾¹ $e$ ï¼Œç”µæµé€šè¿‡å®ƒéœ€è¦çš„æ—¶é—´ä¸º $t_e$ ï¼Œç”µæµçš„è½¬å‘å¯ä»¥è®¤ä¸ºæ˜¯åœ¨ç¬é—´å®Œæˆçš„ã€‚æœ€ç»ˆï¼Œæ¿€ç”µæµå°†åˆ°è¾¾ä¸€äº›â€œç»ˆæ­¢èŠ‚ç‚¹â€â€•â€•æ¥æ”¶ç”µæµä¹‹åä¸å†è½¬å‘çš„èŠ‚ç‚¹ã€‚\nä½¿ç”¨ä¸€æ¬¡é“å…·å¯ä»¥ä½¿å¾—ç”µæµé€šè¿‡æŸæ¡è¾¹çš„æ—¶é—´å¢åŠ ä¸€ä¸ªå•ä½ã€‚è¯·é—®æœ€å°‘ä½¿ç”¨å¤šå°‘æ¬¡é“å…·æ‰å¯è¾¾åˆ°æ¯ä¸€ä¸ªâ€œç»ˆæ­¢èŠ‚ç‚¹â€åŒæ—¶æ”¶åˆ°ç”µæµï¼Ÿ\né“¾æ¥ Luogu P1131\né¢˜è§£ æ³¨æ„åˆ°å­æ ‘æ— è®ºæ€ä¹ˆæï¼Œå¯¹ä¸Šé¢çš„é€‰æ‹©æœ‰å½±å“çš„åªæ˜¯ä¸€ä¸ªæœ€åç”µæµåˆ°è¾¾ç»ˆç‚¹åŒæ­¥çš„æ—¶é—´ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠè¿™ä¸ªè®¾è®¡è¿›çŠ¶æ€é‡Œé¢ã€‚\næ³¨æ„åˆ°å¦‚æœå­æ ‘çš„åŒæ­¥çš„æ—¶é—´æœ€å°‘çš„è¯ï¼Œé‚£ä¹ˆå®ƒçš„æ¶ˆè€—é“å…·æ¬¡æ•°å°±åº”è¯¥æ˜¯æœ€å°‘çš„ï¼ŒåŒæ—¶å› ä¸ºè¿™æ£µå­æ ‘çš„æ¯ä¸€å±‚ä¹‹é—´ï¼Œè‡³å°‘å«æœ‰ä¸€æ¡è¾¹ï¼Œé‚£ä¹ˆå¦‚æœå­æ ‘çš„åŒæ­¥æ—¶é—´å˜å¤š $x$ ï¼Œé‚£ä¹ˆåœ¨å­æ ‘ä¸Šçš„é“å…·æ¶ˆè€—æ¬¡æ•°å°±ä¸€å®šè¦å˜å¤šå¤§äºç­‰äº $x$ ï¼Œè€Œè¿™ä¸ªæ—¶å€™åœ¨å­æ ‘ä¸çˆ¶èŠ‚ç‚¹çš„åŒæ­¥ä¸­ï¼Œå­æ ‘çš„æ ¹èŠ‚ç‚¹ä¸çˆ¶èŠ‚ç‚¹é—´çš„è¾¹çš„åŒæ­¥æ—¶é—´æœ€å¤šå‡å°‘ $x$ ï¼Œæ‰€ä»¥å¯ä»¥è¯æ˜çˆ¶èŠ‚ç‚¹çš„æœ€ä¼˜æ¶ˆè€—é“å…·æ¬¡æ•°ä¸€å®šæ˜¯åœ¨å­èŠ‚ç‚¹çš„æœ€ä¼˜åŒæ­¥æ—¶é—´ä¸‹å–å¾—çš„ï¼Œä¹Ÿå°±å¯ä»¥è¯æ˜ $dp$ çš„æ­£ç¡®æ€§ã€‚\nçŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š\n$$\ntime[u] = max(time[v]+len(u,v))\n$$\n$$\nans[u] = sum(ans[v]+time[u]-(time[v]+len(u,v))\n$$\nå…¶ä¸­ $u$ ï¼Œ $v$\u0008 æœ‰ä¸€æ¡è¾¹ï¼Œä¸” $v$ \u0008é\u001d $u$ çš„çˆ¶äº²ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;vector\u0026gt;#include \u0026lt;cctype\u0026gt;#include \u0026lt;algorithm\u0026gt;#define int long long using namespace std; namespace fast_io { ...//çœç•¥å¿«è¯»æ¨¡ç‰ˆ }using namespace fast_io; namespace normal_io{ inline char read(){ return getchar(); } inline void read(int \u0026amp;x){ scanf(\u0026#34;%lld\u0026#34;,\u0026amp;x); } inline void print(int x){ printf(\u0026#34;%lld\u0026#34;,x); } inline void print(char x){ putchar(x); } inline void flush(){ return; } }using namespace normal_io; const int MAXN = 510000; int n,s; struct Edge{ int t,l; Edge(int b = 0,int c = 0):t(b),l(c){}; }; vector\u0026lt;Edge\u0026gt; edge[MAXN]; int ans[MAXN],times[MAXN]; bool vis[MAXN]; void addedge(int a,int b,int c){ edge[a].push_back(Edge(b,c)); edge[b].push_back(Edge(a,c)); } void init(){ read(n),read(s); int a,b,c; for(int i = 1;i\u0026lt;=n-1;i++){ read(a),read(b),read(c); addedge(a,b,c); } } void dp(int nown){ vis[nown] = 1; int tmpsum = 0,mintime = 0,k = 0; for(int i = 0;i\u0026lt;edge[nown].size();i++){ int to = edge[nown][i].t,len = edge[nown][i].l; if(vis[to] == 1) continue; dp(to); ans[nown] += ans[to]; mintime = max(mintime,times[to]+len); tmpsum += (times[to]+len); k++; } ans[nown] += k * mintime - tmpsum,times[nown] = mintime; } void solve(){ dp(s); print(ans[s]); } main(){ init(); solve(); flush(); return 0; }   ","description":"","id":206,"section":"posts","tags":["åŠ¨æ€è§„åˆ’","æ ‘å½¢dp"],"title":"ã€ŒZJOI2007ã€æ—¶æ€åŒæ­¥-æ ‘å½¢dp","uri":"https://blog.chenqiqian.com/posts/zjoi2007-sync/"},{"content":"æœ‰ä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„æ•´æ•°åºåˆ—ï¼Œå¹¶ä¸”æœ‰ä»¥ä¸‹ä¸‰ç§æ“ä½œï¼š\n  INSERT i k ï¼šåœ¨åŸæ•°åˆ—çš„ç¬¬ $i$ ä¸ªæ•°åé¢æ·»åŠ ä¸€ä¸ªæ–°æ•° $k$ ï¼›å¦‚æœåŸæ•°åˆ—çš„ç¬¬ $i$ ä¸ªæ•°å·²ç»æ·»åŠ äº†è‹¥å¹²æ•°ï¼Œåˆ™æ·»åŠ åœ¨è¿™äº›æ•°çš„æœ€å\n  MIN GAPï¼šæŸ¥è¯¢ç›¸é‚»ä¸¤ä¸ªæ•°çš„ä¹‹é—´å·®å€¼ï¼ˆç»å¯¹å€¼ï¼‰çš„æœ€å°å€¼\n  MIN SORT GAPï¼šæŸ¥è¯¢æ‰€æœ‰æ•°ä¸­æœ€æ¥è¿‘çš„ä¸¤ä¸ªæ•°çš„å·®å€¼ï¼ˆç»å¯¹å€¼ï¼‰\n  é“¾æ¥ Luogu P1110\né¢˜è§£ ä¸€é“è¿‘ä¹äºè£¸çš„ Treap ï¼Œç„¶è€Œç”±äºæˆ‘ååˆ†è’Ÿè’»è€Œä¸”å¥½ä¹…æ²¡æ•² Treap ï¼Œè°ƒäº†ä¸¤ä¸ªå°æ—¶æ‰è°ƒå®Œã€‚\nè¿™é“é¢˜æˆ‘ä»¬ç»´æŠ¤ä¸¤æ£µå¹³è¡¡æ ‘ï¼Œä¸€é¢— $b$ è®°å½•æ‰€æœ‰ç›¸é‚»æ•°çš„å·®çš„ç»å¯¹å€¼ï¼Œä¸€é¢— $b$ è®°å½•æ‰€æœ‰çš„æ•°ï¼›ä¸€ä¸ªåˆ—è¡¨ï¼Œè®°å½•æ¯ä¸ªå—çš„æœ€å‰é¢å’Œæœ€åé¢çš„æ•°ã€‚æˆ‘ä»¬æ³¨æ„åˆ°è¯¢é—®ä¸‰çš„ç»“æœéšæ’å…¥çš„æ•°ä¸å¢ï¼Œæ‰€ä»¥åªéœ€è¦ç»´æŠ¤ä¸€ä¸ªæœ€å°å€¼ $minn$ å°±å¯ä»¥äº†ã€‚\n  insert æ“ä½œï¼šé¦–å…ˆæ ¹æ®åˆ—è¡¨å†…å®¹ä» $b$ é‡Œåˆ é™¤å¯¹åº”ä½ç½®å—é—´ä¸¤æ•°çš„å·®ï¼Œç„¶åæŠŠæ’å…¥åå¤šå‡ºæ¥çš„ç›¸é‚»å…ƒç´ å·®ï¼Œè¿™ä¸ªæ•°ä¸è¿™ä¸€å—ç»“å°¾ï¼Œä¸‹ä¸€å—æœ€å‰é¢çš„æ•°çš„å·®åˆ†åˆ«æ’å…¥å¹³è¡¡æ ‘ $b$ ï¼Œæ³¨æ„ i == n æ—¶éœ€è¦ç‰¹åˆ¤ï¼›å¹¶æŠŠæ’å…¥çš„æ•°åŠ åˆ° $a$ é‡Œé¢ï¼Œæ ¹æ®å…¶ä¸å‰é©±åç»§çš„å·®æ›´æ–° $minn$ ï¼Œæ³¨æ„éœ€è¦åˆ¤æ–­ä¸€ä¸‹æ˜¯å¦è¿™ä¸ªæ•°å·²ç»åœ¨å¹³è¡¡æ ‘é‡Œé¢å­˜åœ¨ã€‚\n  ç›¸é‚»å…ƒç´ çš„å·®å€¼æœ€å°å€¼ï¼šç›´æ¥åœ¨ $b$ é‡Œæ±‚æœ€å°å€¼å¹¶è¾“å‡ºã€‚\n  æ’åºåçš„æœ€å°å·®å€¼ï¼šç›´æ¥è¾“å‡º $minn$ ã€‚\n  ä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;algorithm\u0026gt;#include \u0026lt;cstdlib\u0026gt;#include \u0026lt;cctype\u0026gt;using namespace std; namespace fast_io { ...//éšå»å¿«è¯»æ¨¡ç‰ˆ }using namespace fast_io; namespace normal_io{ inline char read(){ return getchar(); } inline void read(char *c){ scanf(\u0026#34;%s\u0026#34;,c); } inline void read(int \u0026amp;x){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;x); } inline void print(int x){ printf(\u0026#34;%d\u0026#34;,x); } inline void print(char x){ putchar(x); } inline void flush(){ return; } }using namespace normal_io; struct treap{ struct node{ int val,p,cnt; node* son[2]; }; const static int MAXN = 1000000; int treapcnt; node pool[MAXN],*null,*root; treap(){ treapcnt = 0; newnode(null); srand(19260817); null-\u0026gt;val = -0x3f3f3f3f; null-\u0026gt;p = 2147483647; null-\u0026gt;cnt = 0; root = null; } void rotate(node *\u0026amp;r,int tmp){ node *t = r-\u0026gt;son[1-tmp]; r-\u0026gt;son[1-tmp] = t-\u0026gt;son[tmp]; t-\u0026gt;son[tmp] = r; r = t; } void newnode(node *\u0026amp;r){ r = \u0026amp;pool[treapcnt++]; r-\u0026gt;son[0] = r-\u0026gt;son[1] = null; } void __insert(node *\u0026amp;r,int v){ if(r == null){ newnode(r); r-\u0026gt;val = v;r-\u0026gt;p = rand();r-\u0026gt;cnt = 1; } else{ if(r-\u0026gt;val == v) r-\u0026gt;cnt++; else{ int tmp = v \u0026gt; r-\u0026gt;val; __insert(r-\u0026gt;son[tmp],v); if(r-\u0026gt;son[tmp]-\u0026gt;p \u0026lt; r-\u0026gt;p) rotate(r,1-tmp); } } } node *find(node *r,int t){ while(r-\u0026gt;son[t]!=null) r = r-\u0026gt;son[t]; return r; } void __erase(node *\u0026amp;r,int v){ if(r-\u0026gt;val == v){ if(r-\u0026gt;cnt \u0026gt; 1) r-\u0026gt;cnt--; else{ if(r-\u0026gt;son[0] == null\u0026amp;\u0026amp;r-\u0026gt;son[1] == null){ r = null;return; } else{ int tt = r-\u0026gt;son[0]-\u0026gt;p \u0026gt; r-\u0026gt;son[1]-\u0026gt;p; rotate(r,1-tt); __erase(r,v); } } } else{ int tmp = v \u0026gt; r-\u0026gt;val; __erase(r-\u0026gt;son[tmp],v); } } node *nei(int v,int t){ node* nown = root,*last = null; while(nown!=null\u0026amp;\u0026amp;nown-\u0026gt;val!=v){ //printf(\u0026#34;2\\n\u0026#34;);  int tmp = v \u0026gt; nown-\u0026gt;val; if(tmp!=t) last = nown; nown = nown-\u0026gt;son[tmp]; } if(nown-\u0026gt;son[t]!=null){ last = find(nown-\u0026gt;son[t],1-t); } return last; } bool find(int v){ node *r = root; while(r!=null\u0026amp;\u0026amp;r-\u0026gt;val!=v){ int tmp = v \u0026gt; r-\u0026gt;val; r = r-\u0026gt;son[tmp]; } return r != null; } inline void __print(node *r,int depth = 0){ if(r == null) return; else{ __print(r-\u0026gt;son[0],depth+1); for(int i = 0;i\u0026lt;depth;i++) putchar(\u0026#39; \u0026#39;); printf(\u0026#34;val:%d cnt:%d P:%d son?:%d %d\\n\u0026#34;,r-\u0026gt;val,r-\u0026gt;cnt,r-\u0026gt;p,r-\u0026gt;son[0]!=null,r-\u0026gt;son[1]!=null); __print(r-\u0026gt;son[1],depth+1); } } void insert(int v){ __insert(root,v); } void erase(int v){ __erase(root,v); } void print(){ __print(root); } }; //ä»¥ä¸Štreapå¸¸è§„æ¨¡ç‰ˆ  treap a,b; const int MAXN = 1000000; int head[MAXN],tail[MAXN],minn,n,m; //aæ˜¯æ‰€æœ‰æ•°ï¼Œbæ˜¯æ‰€æœ‰ç›¸é‚»æ•°å·®å€¼ //headè®°å½•æ­¤å—æœ€å‰æ•°ï¼Œtailè®°å½•æœ€åæ•°ã€‚  void init(){ minn = 0x3f3f3f3f; read(n),read(m); static int tmp[MAXN]; for(int i = 1;i\u0026lt;=n;i++){ int t;read(t); a.insert(t); head[i] = tail[i] = tmp[i] = t; } sort(tmp+1,tmp+n+1); for(int i = 2;i\u0026lt;=n;i++){ //æ›´æ–°åˆå§‹çš„ä¸¤ä¸ªæŸ¥è¯¢ç­”æ¡ˆ  b.insert(abs(head[i]-head[i-1])); minn = min(minn,tmp[i]-tmp[i-1]); } } void solve(){ char op[20];int x,y; for(int i = 1;i\u0026lt;=m;i++){ read(op); if(op[4] == \u0026#39;G\u0026#39;){ print(b.find(b.root,0)-\u0026gt;val),print(\u0026#39;\\n\u0026#39;); //å¯»æ‰¾æœ€å°ç›¸é‚»å…ƒç´ å·®å€¼  } else if(op[4] == \u0026#39;S\u0026#39;){ print(minn),print(\u0026#39;\\n\u0026#39;); //å¯»æ‰¾æ’åºå…ƒç´ å·®å€¼  } else if(op[4] == \u0026#39;R\u0026#39;){ read(x),read(y); if(x != n){ b.erase(abs(head[x+1]-tail[x])); b.insert(abs(head[x+1]-y)); } b.insert(abs(tail[x]-y)); tail[x] = y; //æ›´æ–°æŸ¥è¯¢2ç­”æ¡ˆ  if(a.find(y)) minn = 0; else{ int low = a.nei(y,0)-\u0026gt;val,up = a.nei(y,1)-\u0026gt;val; minn = min(minn,min(abs(y-low),abs(up-y))); } a.insert(y); //æ›´æ–°æŸ¥è¯¢3ç­”æ¡ˆ  } else if(op[4] ==\u0026#39;P\u0026#39;){ a.print(); printf(\u0026#34;------------------------\\n\u0026#34;); b.print(); //è°ƒè¯•ç”¨  } //printf(\u0026#34;Finish\\n\u0026#34;);  } } int main(){ init(); solve(); flush(); return 0; }   ","description":"","id":207,"section":"posts","tags":["Treap","å¹³è¡¡æ ‘","æ•°æ®ç»“æ„"],"title":"ã€ŒZJOI2007ã€æŠ¥è¡¨ç»Ÿè®¡-å¹³è¡¡æ ‘","uri":"https://blog.chenqiqian.com/posts/zjoi2007-count/"},{"content":"è¾“å…¥è¾“å‡ºæ¨¡æ¿æ›¿ä»£æ™®é€šè¯»å†™æ–¹å¼ï¼Œå¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸ŠåŠ å¿«ç¨‹åºè¿è¡Œé€Ÿåº¦ã€‚\nä¾èµ–åº“stdio.h å’Œ ctype.hã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cctype\u0026gt; namespace fast_io { inline char read(){ //return getchar();  static const int IN_LEN = 1000000; static char buf[IN_LEN], *s, *t; return s==t?(((t=(s=buf)+fread(buf,1,IN_LEN,stdin))== s)?-1:*s++) : *s++; } inline void read(int \u0026amp;x){ static bool iosig; static char c; for (iosig = false, c = read(); !isdigit(c); c = read()) { if (c == \u0026#39;-\u0026#39;) iosig = true; if (c == -1) return; } for (x = 0; isdigit(c); c = read()) x = ((x+(x\u0026lt;\u0026lt;2))\u0026lt;\u0026lt;1) + (c ^ \u0026#39;0\u0026#39;); if (iosig) x = -x; } inline void read(char *a){ static char c = read(); while(c!= -1\u0026amp;\u0026amp;(c == \u0026#39; \u0026#39;||c!=\u0026#39;\\r\u0026#39;||c ==\u0026#39;\\n\u0026#39;)) c = read(); while(c!= -1\u0026amp;\u0026amp;c!=\u0026#39; \u0026#39;\u0026amp;\u0026amp;c!=\u0026#39;\\r\u0026#39;\u0026amp;\u0026amp;c!=\u0026#39;\\n\u0026#39;) *a++ = c,c = read(); *a = 0; } const int OUT_LEN = 1000000; char obuf[OUT_LEN], *ooh = obuf; inline void print(char c){ if (ooh == obuf + OUT_LEN) fwrite(obuf, 1, OUT_LEN, stdout), ooh = obuf; *ooh++ = c; } inline void print(int x){ static int buf[30], cnt; if (x == 0) print(\u0026#39;0\u0026#39;); else { if (x \u0026lt; 0) print(\u0026#39;-\u0026#39;), x = -x; for (cnt = 0; x; x /= 10) buf[++cnt] = x % 10 + 48; while (cnt) print((char)buf[cnt--]); } } inline void print(char *a){ while(*a) print(*a++); } inline void flush(){ fwrite(obuf, 1, ooh - obuf, stdout); } }using namespace fast_io; namespace normal_io{ inline char read(){ return getchar(); } inline void read(int \u0026amp;x){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;x); } inline void print(int x){ printf(\u0026#34;%d\u0026#34;,x); } inline void print(char x){ putchar(x); } inline void flush(){ return; } }//using namespace normal_io;  int main(){ int x; read(x); print(x); flush(); return 0; }   shortç‰ˆ update at 20180405\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cctype\u0026gt; namespace fast_io { inline char read(){static const int IN_LEN=1000000;static char buf[IN_LEN],*s,*t;return s==t?(((t=(s=buf)+fread(buf,1,IN_LEN,stdin))==s)?-1:*s++) : *s++;} inline void read(int \u0026amp;x){static bool iosig;static char c;for (iosig=false,c=read();!isdigit(c);c=read()){if(c==\u0026#39;-\u0026#39;)iosig=true;if(c==-1)return;}for(x=0;isdigit(c);c=read())x=((x+(x\u0026lt;\u0026lt;2))\u0026lt;\u0026lt;1)+(c^\u0026#39;0\u0026#39;);if(iosig)x=-x;} inline void read(char *a){static char c = read();while(c!=-1\u0026amp;\u0026amp;(c==\u0026#39; \u0026#39;||c==\u0026#39;\\n\u0026#39;||c==\u0026#39;\\r\u0026#39;))c=read();while(c!=-1\u0026amp;\u0026amp;c!=\u0026#39;\\r\u0026#39;\u0026amp;\u0026amp;c!=\u0026#39; \u0026#39;\u0026amp;\u0026amp;c!=\u0026#39;\\n\u0026#39;) *a++=c,c=read();*a=0;} const int OUT_LEN=1000000;char obuf[OUT_LEN],*ooh=obuf; inline void print(char c){if(ooh==obuf+OUT_LEN) fwrite(obuf,1,OUT_LEN,stdout),ooh=obuf;*ooh++ = c;} inline void print(int x){static int buf[30],cnt;if(x==0)print(\u0026#39;0\u0026#39;);else{if(x\u0026lt;0)print(\u0026#39;-\u0026#39;),x=-x;for(cnt=0;x;x/=10)buf[++cnt]=x%10+48;while (cnt) print((char)buf[cnt--]);}} inline void print(char *a){while(*a) print(*a++);} inline void flush(){fwrite(obuf,1,ooh-obuf,stdout);} }using namespace fast_io; namespace normal_io{ inline char read(){return getchar();} inline void read(int \u0026amp;x){scanf(\u0026#34;%d\u0026#34;,\u0026amp;x);} inline void print(int x){printf(\u0026#34;%d\u0026#34;,x);} inline void print(char x){putchar(x);} inline void flush(){return;} }//using namespace normal_io;  int main(){ int x; read(x); print(x); flush(); return 0; }   ","description":"","id":208,"section":"posts","tags":["æ¨¡æ¿","è¾“å…¥è¾“å‡º"],"title":"è¾“å…¥è¾“å‡ºä¼˜åŒ–æ¨¡æ¿","uri":"https://blog.chenqiqian.com/posts/notes-io-optimize/"},{"content":"æœ€è¿‘åœ¨åšçº¢æ¥¼çš„æ€»ç»“ï¼Œè«åçš„ä¹Ÿå°±æƒ³æ¥å†™ä¸Šä¸¤å¥ã€‚\nè‘¬èŠ±åŸ-åŒç¬™\næ€ä¹ˆè¯´å‘¢ã€‚çº¢æ¥¼æ¢¦è¿™æœ¬ä¹¦ï¼Œè¶Šè¯»è¶Šä»¤äººæ‚²ä¼¤ã€‚è‡³å…­åä¸‰å›ä»¥åï¼Œä¾¿å·²æ— å¿ƒæ¼«å·ï¼Œè‡³ä¸ƒåå…«å›ä»¥åï¼Œä¹Ÿå°±ä¸æƒ³å†è¯»ä¸‹å»ã€‚\nè¦ä¾æˆ‘æ¥è§ï¼Œå…­åäºŒå›å³æ˜¯çº¢æ¥¼å¥³å„¿ç»å”±ï¼Œæœ€åä¸€æ¬¡é½èšçš„å®´æ¬¢ï¼Œæœ€åä¸€æ¬¡æƒ¬æ„çš„æ„‰æ‚¦ã€‚æ¹˜äº‘é†‰å§çŸ³ä¸Šï¼Œç«Ÿè®©æˆ‘ææƒšè§‰å¾—ï¼Œä¸€åˆ‡è¿˜åœ¨åŠå¹´ä»¥å‰ï¼Œè¿˜åœ¨é‚£ä¸ªæ˜¥å¤©ã€‚\nä½†ä¸–äº‹ä¸å¤å•Šã€‚è‡ªæ­¤ä»¥åï¼Œå¤§è§‚å›­ä¸­ä¹Ÿåªå‰©ä¸‹äº†æ½‡æ¹˜ä¹‹æ‚²æˆšï¼Œè˜…èŠœä¹‹å­¤å†·ã€‚å¸ç´ã€å…¥ç”»ã€å››å„¿ã€èŠ³å®˜ã€æ™´é›¯ä¹Ÿä¸€ä¸ªä¸ªç¦»å¼€è¿™å¦‚æ¢¦ä¼¼å¹»çš„å¤§è§‚å›­ï¼Œæ—§æ—¶çš„æ¬¢å®´å·²ç»ä¸å­˜ã€‚è´¾æ¯æœˆåœ†å¤œå®´ï¼Œè€äººçš„å¿ƒé‡Œï¼Œä¹ŸçŸ¥é“ä¸€åˆ‡æä¹Ÿå†éš¾æŒ½å›ï¼Œä¸å¦‚ã€Œäººå¤šäº›ã€ï¼Œå¥½èšå¥½æ•£ã€‚\næ˜¯å•Šã€‚ç››ç­µéš¾ä¹…ï¼Œä¸‡äº‹ç»ˆæœ‰ç¦»æ•£çš„ä¸€å¤©ã€‚\nè¦è¯´è¯»åˆ°äº”åä½™å›ï¼Œå°±å·²ç»æœ‰ä¸‡åƒå¿ƒç»ªã€‚ä¸çŸ¥ä½•æ—¶ï¼Œè®¸å¤šåŸæœ¬åªèƒ½åœ¨è´¾åºœè¾¹ç¼˜çš„è®¸å¤šå°äººç‰©ï¼Œç«Ÿä¹Ÿå¦‚æ­¤å¤šåœ¨ä¹¦ä¸­å‡ºç°ã€‚ä¼¼ä¹ä»é‚£æ—¶å¾€åï¼Œçº¢æ¥¼ä¸€æ¢¦å·²ç»ä¸å†æ˜¯å„¿å¥³çš„æƒ…é•¿ï¼Œä¸æ˜¯å•çº¯çš„æƒ…å¨±ä¸é£æœˆï¼Œè€Œæ˜¯å®¶æ—çš„å‡ç€è¡€æ³ªçš„çœŸå²ã€‚\nå¥³å­©ï¼Œç”·å­©ä»¬æ¢¦ä¸­çš„ç”Ÿæ´»ï¼Œæ€ä¹ˆå¯èƒ½æŒä¹…å‘¢ã€‚çº¢æ¥¼ä¸€é¢˜æ—©å°±å‘Šè¯‰ä½ ï¼Œè¿™ä¸è¿‡æ˜¯ã€ŒçœŸäº‹éšã€ï¼Œä¸è¿‡æ˜¯ã€Œå‡è¯­å­˜ã€ï¼Œä¸è¿‡æ˜¯ã€Œæ¸©æŸ”ä¹¡é‡Œçš„ä¸€åœºæ¢¦å¹»å¤„ã€ã€‚æ®Šä¸çŸ¥ï¼Œæ—¶å¹´ä»åå…«å›çš„å…ƒå®µåˆ°å…­åå›çš„æ˜¥æ—¥ï¼Œä¸è¿‡æ˜¯ä¸€å¹´è½®å›ã€‚ä½†ä¸€å¹´ï¼Œä¸€å¹´ä¹Ÿå¤ªé•¿äº†ã€‚æ‰€æœ‰çš„äº‹æƒ…ï¼Œéƒ½å˜åŒ–äº†è®¸å¤šã€‚\n ã€Œå¥³å­©å­åœ¨æ²¡å‡ºå«å‰åƒæ˜¯ä¸€æšçç ï¼Œè€Œå‡ºå«ä¹‹åå°±å˜æˆäº†é±¼çœ¼ç ä¸€èˆ¬ã€ã€‚\n çº¢æ¥¼æ¢¦å°±åœ¨å°å§ä»¬å‡ºå«æ—¶æˆ›ç„¶è€Œæ­¢äº†ã€‚å›ä¸è§ç‹å¤«äººçš„çˆ½åˆ©ï¼Œå›ä¸è§è´¾æ¯çš„é£åï¼Œå›ä¸è§å®é’—å°æ—¶çš„æ·˜æ°”ã€‚ä½†æ—¶é—´å‘µï¼Œä¹Ÿè®¸ä¸æ›¾å¸¦èµ°ä»€ä¹ˆï¼Œä½†å´ä¸€å®šå¸¦ç»™äº†ä»–ä»¬æ— æ³•æŠ—æ‹’çš„æ”¹å˜ã€‚\nä¸çŸ¥é“æ˜¯ä¸æ˜¯åœ¨è¿™ä¸ªå¹´é¾„ï¼Œæ€»ä¼šæœ‰æ„æ— æ„çš„æŠŠè‡ªå·±å¾€ä¸»è§’çš„ä½ç½®é‡Œå¸¦å…¥ï¼Œè€Œè¿™æ ·ä¹Ÿå°±æ›´èƒ½ä½“ä¼šåˆ°é‚£ç§å¿ƒæœ‰æ‚²ä¼¤è€Œä¸èƒ½è¯­ã€‚\n ã€Œçœ¼çœ‹ä»–èµ·æœ±æ¥¼ï¼Œ çœ¼çœ‹ä»–å®´å®¾å®¢ï¼Œ çœ¼çœ‹ä»–æ¥¼å¡Œäº†ã€‚ã€\n å°±åƒè¿™æ ·å§ã€‚\nå¦‚æœè®©æˆ‘æ¥é€‰ï¼Œæˆ‘å¸Œæœ›æ—¶é—´èƒ½å¤Ÿæ°¸è¿œåœåœ¨é‚£ä¸€å¹´çš„æ˜¥å¤ã€‚\nåœåœ¨å¹¶å¤´è¯»è¥¿å¢ã€‚\nåœåœ¨è‘¬èŠ±ç»ä¸–åŸã€‚\nåœåœ¨æµ·æ£ è¯—ç¤¾èµ·ã€‚\nåœåœ¨é‚£è™šå¹»è€Œåˆç¾å¥½ï¼Œæœ¦èƒ§è€Œåˆæ¬ç¾çš„æ¢¦é‡Œã€‚\nåŠ¨æƒ…çœŸçš„æ˜¯ï¼Œä»¤äººæ²‰è¿·ï¼Œä¹Ÿä»¤äººç™«ç‹‚ã€‚\nã€Œå‡ä½œçœŸæ—¶çœŸäº¦å‡ï¼›æ— ä¸ºæœ‰å¤„æœ‰è¿˜æ— ã€‚ã€ã€Œèº«åæœ‰ä½™å¿˜ç¼©æ‰‹ï¼Œçœ¼å‰æ— è·¯æƒ³å›å¤´ã€\næƒ…ä¹Ÿè®¸å°±æ˜¯è¿™æ ·å§ã€‚\næ¥æºï¼šPixiv\n","description":"","id":209,"section":"posts","tags":["çº¢æ¥¼æ¢¦"],"title":"ã€Œçº¢æ¥¼ä¸€æ¢¦ã€","uri":"https://blog.chenqiqian.com/posts/essay-a-dream-of-red-mansions/"},{"content":"ç»´æŠ¤ä¸€ä¸ªæ•°åˆ—ï¼Œç»™å®šåˆå§‹çš„ $n$ ä¸ªæ•°å­—ã€‚\nç°æœ‰å…­ç§å‘½ä»¤ï¼š\n åœ¨ç¬¬ $pos$ ä¸ªæ•°åæ’å…¥ $tot$ ä¸ªæ•° ç¿»è½¬ä»ç¬¬ $pos$ ä¸ªæ•°å¼€å§‹çš„ $tot$ ä¸ªæ•° åˆ é™¤ä»ç¬¬ $pos$ ä¸ªæ•°å¼€å§‹çš„ $tot$ ä¸ªæ•° æŸ¥è¯¢ä»ç¬¬ $pos$ ä¸ªæ•°å¼€å§‹çš„ $tot$ ä¸ªæ•°çš„å’Œ è®¾å®šä»ç¬¬ $pos$ ä¸ªæ•°å¼€å§‹çš„ $tot$ ä¸ªæ•°è®¾å®šä¸º $c$ æŸ¥è¯¢æ•´ä¸ªæ•°åˆ—ä¸­å’Œæœ€å¤§çš„è¿ç»­å­åŒºé—´çš„å’Œ  é“¾æ¥ Luogu P2042\né¢˜è§£ è¿™æ˜¯ä¸€é“ç»å…¸çš„å¹³è¡¡æ ‘çš„é¢˜ï¼Œè¢«æˆ‘ç”¨æ¥ç»ƒæ‰‹éæ—‹$Treap$ã€‚\nå› ä¸ºæˆ‘å¤ªå¼±äº†ï¼Œæ‰€ä»¥å†™çš„å¾ˆç—›è‹¦ã€‚\nå…³äºåˆå¹¶å’Œåˆ†è£‚çš„ä¸»è¦æ€æƒ³å‚è§ éæ—‹Treapå­¦ä¹ ç¬”è®° ã€‚\nå¯¹äºèŠ‚ç‚¹ï¼Œè¦ç»´æŠ¤ï¼š\næ ‘çš„å¤§å°ï¼Œæ ‘çš„æƒå€¼å’Œï¼Œæ ‘ä»å·¦ç«¯ç‚¹å¼€å§‹çš„æœ€å¤§è¿ç»­å’Œï¼Œæ ‘ä»å³ç«¯ç‚¹å¼€å§‹çš„æœ€å¤§è¿ç»­å’Œï¼Œå’Œæ ‘çš„æœ€å¤§è¿ç»­å­åŒºé—´å’Œã€‚\nä¸»è¦æ“ä½œï¼š\n pushdown  å¾€ä¸‹ $push$ ï¼Œä¿®æ”¹ä¸¤ä¸ªå­èŠ‚ç‚¹å¹¶æ‰“ä¸Šæ ‡è®°ã€‚\n pushup  æ›´æ–°æ‰€æœ‰ä¿¡æ¯ï¼Œç»´æŠ¤ä¸‰ä¸ª $\\max$ ä¿¡æ¯çš„æ–¹å¼æœ‰äº›ç‰¹æ®Šï¼Œä½†ä»”ç»†æƒ³æƒ³åº”å½“èƒ½æƒ³åˆ°ã€‚\nè¿™é‡Œæˆ‘è¢«å‘äº†ã€‚è¿™ä¸ªä¸çº¿æ®µæ ‘çš„åŒºé—´æœ€å¤§æŸ¥è¯¢æœ‰ç‚¹ä¸å¤ªä¸€æ ·ï¼Œæ ¹èŠ‚ç‚¹ä¹Ÿæœ‰ä»£è¡¨çš„æ•°ï¼Œè¿™ä¸ªéœ€è¦è®°ä½ã€‚\n å»ºæ ‘  æ„å»ºç¬›å¡å°”æ ‘ã€‚è¯¦è§ éæ—‹Treapå­¦ä¹ ç¬”è®° ã€‚\n æœ€å¤§æŸ¥è¯¢è¿ç»­å’Œ  ç›´æ¥è¾“å‡ºæ ¹èŠ‚ç‚¹ç»´æŠ¤çš„æœ€å¤§è¿ç»­å­åŒºé—´çš„å€¼å³å¯ã€‚\n æ’å…¥  æŠŠå³å°†æ’å…¥çš„ $tot$ ä¸ªæ•°æŒ‰ç…§ä¸Šæ–‡çš„ä»‹ç»æ–¹æ³•å»ºæ ‘ã€‚\næŠŠåŸæ¥çš„æ•°æŒ‰ç…§ $size$ è£‚æˆä¸¤æ£µæ ‘ï¼Œåˆ†åˆ«æŒ‰é¡ºåºåˆèµ·æ¥å°±å¯ä»¥äº†ã€‚\næ¥ä¸‹æ¥çš„æ“ä½œéƒ½éœ€è¦è£‚æˆä¸‰æ£µæ ‘ï¼Œå·¦è¾¹çš„æœ‰ $pos-1$ ä¸ªæ ‘ï¼Œä¸­é—´æœ‰ $tot$ ä¸ªæ•°ã€‚\n åˆ é™¤  ç›´æ¥åˆ é™¤ä¸­é—´å­æ ‘ï¼Œå·¦å³åˆå¹¶ã€‚å› ä¸ºå†…å­˜ä¸å¤Ÿï¼ˆ $64MB$ ï¼‰ï¼Œéœ€è¦åƒåœ¾å›æ”¶ã€‚\n æ±‚å’Œ  è¾“å‡ºä¸­é—´å­æ ‘çš„å’Œï¼Œå†æŠŠä¸‰ä¸ªå­æ ‘é¡ºæ¬¡åˆå¹¶èµ·æ¥ã€‚\n ç¿»è½¬  ç¿»è½¬ä¸­é—´å­æ ‘å¹¶æ‰“æ ‡è®°ï¼Œå†æŠŠä¸‰ä¸ªå­æ ‘é¡ºæ¬¡åˆå¹¶èµ·æ¥ã€‚\n è®¾å®š  å¯¹ä¸­é—´å­æ ‘å®Œæˆè®¾å®šå¹¶æ‰“æ ‡è®°ï¼Œå†å°†ä¸‰ä¸ªå­æ ‘é¡ºæ¬¡åˆå¹¶èµ·æ¥ã€‚\nè¿˜æœ‰ä¸€ç‚¹å°±æ˜¯åƒåœ¾å›æ”¶ã€‚ç®€ç•¥æ¥è¯´å°±æ˜¯æŠŠåˆ é™¤çš„èŠ‚ç‚¹æš´åŠ›çš„æ‰”åˆ°ä¸€ä¸ªæ ˆé‡Œé¢ï¼Œç„¶åèƒ½ç”¨å°±ç”¨ï¼Œä¸èƒ½æœ‰å°±å†æ–°å¼€å†…å­˜æ± ã€‚\nå…¶ä»–ä¹Ÿæ²¡æœ‰ä»€ä¹ˆé‡è¦çš„ã€‚å¤š pushdown pushupå‡ æ¬¡ï¼Œç„¶åè¿™äº›æ“ä½œéƒ½æ˜¯è¦æ³¨æ„è¾¹ç•Œï¼Œä¹Ÿå°±æ˜¯ null æ—¶å€™çš„æ¡ä»¶çš„ã€‚pushup çš„åˆå¹¶å…¬å¼ä¹Ÿéœ€è¦å¥½å¥½æ–Ÿé…Œã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224  #include \u0026lt;bits/stdc++.h\u0026gt;using namespace std; const int MAXN = 510000; const int MAX = 2147483647; int k,n; struct node_t{ int val,p; int lmax,rmax,maxn,sumn,tag; int size; bool rev,is_tag; node_t *son[2],**null; void pushdown(){ if(this == *null) return; if(is_tag){ son[0]-\u0026gt;cover(tag),son[1]-\u0026gt;cover(tag); is_tag = tag = 0; } if(rev) { son[0]-\u0026gt;reverse(),son[1]-\u0026gt;reverse(); rev = 0; } } void pushup(){ if(this == *null) return; if(son[0] == *null \u0026amp;\u0026amp; son[1] == *null){ size = 1;sumn = lmax = rmax = maxn = val; return; } size = son[0]-\u0026gt;size + son[1]-\u0026gt;size + 1; sumn = son[0]-\u0026gt;sumn + son[1]-\u0026gt;sumn + val; lmax = max(son[0]-\u0026gt;lmax,son[0]-\u0026gt;sumn + val + max(0,son[1]-\u0026gt;lmax)); rmax = max(son[1]-\u0026gt;rmax,son[1]-\u0026gt;sumn + val + max(0,son[0]-\u0026gt;rmax)); maxn = max(0,son[0]-\u0026gt;rmax) + val + max(0,son[1]-\u0026gt;lmax); maxn = max(maxn,max(son[0]-\u0026gt;maxn,son[1]-\u0026gt;maxn)); } void cover(int v){ if(this == *null) return; val = v;sumn = size * v; lmax = rmax = maxn = max(v,sumn); is_tag = 1;tag = v; } void reverse(){ if(this == *null) return; swap(son[0],son[1]); swap(lmax,rmax); rev^=1; } }; struct fhqtreap{ node_t pool[MAXN],*tmp[MAXN],*stack[MAXN],*garbage[MAXN]; node_t *root,*null; int cnt,tot; void newnode(node_t *\u0026amp;r,int val = 0){ if(tot == 0) r = \u0026amp;pool[cnt++]; else r = garbage[--tot];//åƒåœ¾å›æ”¶  r-\u0026gt;val = val;r-\u0026gt;size = 1; r-\u0026gt;lmax = r-\u0026gt;rmax = r-\u0026gt;maxn = r-\u0026gt;sumn = val; r-\u0026gt;son[0] = r-\u0026gt;son[1] = null; r-\u0026gt;is_tag = r-\u0026gt;rev = 0; r-\u0026gt;null = \u0026amp;null; r-\u0026gt;p = rand(); } fhqtreap(){ tot = 0;cnt = 0; srand(time(NULL)); newnode(null,-MAX); null-\u0026gt;p = MAX; root = null; null -\u0026gt; sumn = null-\u0026gt;size = 0; } void cycle(node_t *r){ if(r == null) return; garbage[tot++] = r; cycle(r-\u0026gt;son[0]); cycle(r-\u0026gt;son[1]); } void read_tree(int n){ for(int i = 1;i\u0026lt;=n;i++){ int t;scanf(\u0026#34;%d\u0026#34;,\u0026amp;t); newnode(tmp[i],t); } } node_t *build(int n){ read_tree(n); int top = 1; newnode(stack[0],-MAX); stack[0]-\u0026gt;p = -MAX; for(int i = 1;i\u0026lt;=n;i++){ int nowp = top - 1; node_t *r = tmp[i],*pre = null; while(stack[nowp]-\u0026gt;p \u0026gt; r -\u0026gt; p){ stack[nowp]-\u0026gt;pushup(); pre = stack[nowp]; stack[nowp] = null; nowp--; } stack[nowp+1] = stack[nowp]-\u0026gt;son[1] = r; stack[nowp+1]-\u0026gt;son[0] = pre; top = nowp+2; } while(top) stack[--top]-\u0026gt;pushup(); return stack[0]-\u0026gt;son[1]; } void split(node_t *r,int lsize,node_t *\u0026amp;ls,node_t *\u0026amp;rs){ if(r == null){ ls = null;rs = null;return; } r-\u0026gt;pushdown(); if(r-\u0026gt;son[0]-\u0026gt;size + 1 \u0026lt;= lsize){ ls = r; split(r-\u0026gt;son[1],lsize-r-\u0026gt;son[0]-\u0026gt;size-1,ls-\u0026gt;son[1],rs); } else{ rs = r; split(r-\u0026gt;son[0],lsize,ls,rs-\u0026gt;son[0]); } ls-\u0026gt;pushup();rs-\u0026gt;pushup(); } node_t *merge(node_t *ls,node_t *rs){ if(ls == null) return rs; if(rs == null) return ls; if(ls-\u0026gt;p \u0026lt; rs-\u0026gt;p){ ls-\u0026gt;pushdown(); ls-\u0026gt;son[1] = merge(ls-\u0026gt;son[1],rs); ls-\u0026gt;pushup(); return ls; } else{ rs-\u0026gt;pushdown(); rs-\u0026gt;son[0] = merge(ls,rs-\u0026gt;son[0]); rs-\u0026gt;pushup(); return rs; } } void insert(int rank,int n){ if(n == 0) return; node_t *ls,*rs,*newn,*ret; split(root,rank,ls,rs); newn = build(n); root = merge(merge(ls,newn),rs); } void split(int ls,int ms,node_t *\u0026amp;l,node_t *\u0026amp;m,node_t *\u0026amp;r){ node_t *m1; split(root,ls,l,m1); split(m1,ms,m,r); } void erase(int lb,int ms){ if(ms == 0) return; node_t *l,*m,*r,*ret; split(lb-1,ms,l,m,r); cycle(m); root = merge(l,r); } int get_sum(int lb,int ms){ if(ms == 0) return 0; node_t *l,*m,*r; split(lb-1,ms,l,m,r); int ans = m-\u0026gt;sumn; root = merge(l,merge(m,r)); return ans; } int max_sum(){ return root-\u0026gt;maxn; } void reverse(int lb,int ms){ if(ms == 0) return; node_t *l,*m,*r; split(lb-1,ms,l,m,r); m-\u0026gt;reverse(); root = merge(l,merge(m,r)); } void make_same(int lb,int ms,int c){ if(ms == 0) return; node_t *l,*m,*r; split(lb-1,ms,l,m,r); m-\u0026gt;cover(c); root = merge(l,merge(m,r)); } }; fhqtreap w; void init(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;k); w.root = w.build(n); } void solve(){ for(int i = 1;i\u0026lt;=k;i++){ char op[50];int a,b,c; scanf(\u0026#34;%s\u0026#34;,op); if(op[0] == \u0026#39;M\u0026#39;\u0026amp;\u0026amp;op[2] == \u0026#39;X\u0026#39;) printf(\u0026#34;%d\\n\u0026#34;,w.max_sum()); else{ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;a,\u0026amp;b); if(op[0] == \u0026#39;I\u0026#39;) w.insert(a,b); else if(op[0] == \u0026#39;D\u0026#39;) w.erase(a,b); else if(op[0] == \u0026#39;G\u0026#39;){ printf(\u0026#34;%d\\n\u0026#34;,w.get_sum(a,b)); } else if(op[0] == \u0026#39;M\u0026#39;){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;c); w.make_same(a,b,c); } else if(op[0] == \u0026#39;R\u0026#39;){ w.reverse(a,b); } } } } int main(){ init(); solve(); return 0; }   ","description":"","id":210,"section":"posts","tags":["Treap","å¹³è¡¡æ ‘","æ•°æ®ç»“æ„"],"title":"ã€ŒNOI2005ã€ç»´æŠ¤æ•°åˆ—-éæ—‹Treap","uri":"https://blog.chenqiqian.com/posts/noi2005-sequence/"},{"content":"éæ—‹ Treap ï¼Œæ˜¯ä¸€ç§ä¸åŸºäºæ—‹è½¬çš„å¹³è¡¡æ ‘ã€‚å®ƒåŸºäº Treap çš„æ ‘å †æ€æƒ³ï¼Œå¹¶ä¸”èƒ½å¤Ÿé«˜æ•ˆçš„å®ŒæˆæŸäº›å¯¹åŒºé—´çš„æ“ä½œï¼Œè€Œä¸”çµæ´»æ€§æ¯”è¾ƒé«˜ã€‚å®ƒä¹Ÿå¯ä»¥è¿›è¡Œå¯æŒä¹…åŒ–çš„æ“ä½œã€‚\nTreapå­¦ä¹ ç¬”è®°ï¼Œä»‹ç»äº†åŸºäºæ—‹è½¬çš„ Treap çš„åŸºæœ¬æ¦‚å¿µç­‰ç­‰ï¼Œåœ¨è¿™é‡Œä¸å†èµ˜è¿°ã€‚\nä»£ç ç®€è¿° è¿™é‡Œä»¥ è¿™é“é¢˜é¢˜ä½œä¸ºæ¨¡æ¿ã€‚\nèŠ‚ç‚¹çš„å®šä¹‰ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25  struct node_t{ int val,p,size; // val æ˜¯æ•°å€¼ï¼Œp æ˜¯ä¼˜å…ˆçº§ï¼Œsize æ˜¯å½“å‰èŠ‚ç‚¹ä»£è¡¨çš„åŒºé—´çš„å¤§å°  bool rev; node_t *son[2],**null; //ä¸‹æ”¾æ ‡è®°  void pushdown(){ if(this == *null) return; if(rev) { son[0]-\u0026gt;reverse(),son[1]-\u0026gt;reverse(); rev = 0; } } //æ›´æ–°èŠ‚ç‚¹  void pushup(){ if(this == *null) return; size = son[0]-\u0026gt;size + son[1]-\u0026gt;size + 1; } //åè½¬ä»¥å½“å‰èŠ‚ç‚¹ä¸ºçˆ¶èŠ‚ç‚¹æ‰€ä»£è¡¨çš„åŒºé—´  void reverse(){ if(this == *null) return; swap(son[0],son[1]); rev^=1; } };   è¿™é‡Œçš„ä»£ç å¾ˆç®€å•ï¼Œä¸ä½œèµ˜è¿°ã€‚\nä¸è¿‡æœ‰ä¸€ç‚¹è¦è¯´çš„ã€‚è¿™é‡Œçš„åŒé‡æŒ‡é’ˆ**nullçš„ç›®çš„ä¸»è¦æ˜¯è®©è¿™é‡Œçš„èŠ‚ç‚¹èƒ½å¤Ÿå¿«é€Ÿçš„åˆ¤æ–­æ˜¯å¦è¿™ä¸ªèŠ‚ç‚¹æ˜¯ä¸‹é¢å¹³è¡¡æ ‘çš„nullèŠ‚ç‚¹ã€‚\nTreapç»“æ„ä½“å®šä¹‰ \u0026amp; åˆå§‹åŒ–å‡½æ•° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  struct fhqtreap{ node_t pool[MAXN],*tmp[MAXN],*stack[MAXN]; //tmp å’Œ stack æ•°ç»„éƒ½æ˜¯ä¸ºäº†åé¢çš„$O(n)$å»ºæ ‘åšå‡†å¤‡  node_t *root,*null; int cnt; fhqtreap(){ cnt = 0; srand(time(NULL)); newnode(null); null-\u0026gt;p = MAX; root = null; null-\u0026gt;size = 0; } void newnode(node_t *\u0026amp;r,int val = 0){ r = \u0026amp;pool[cnt++];//åˆ†é…å†…å­˜  r-\u0026gt;val = val;r-\u0026gt;size = 1; r-\u0026gt;son[0] = r-\u0026gt;son[1] = null; r-\u0026gt;rev = 0;//ç½®0  r-\u0026gt;null = \u0026amp;null; r-\u0026gt;p = rand(); }   åˆå§‹åŒ–ä¹Ÿæ²¡æœ‰ä»€ä¹ˆéš¾ç‚¹ã€‚ä¸»è¦éœ€è¦æ³¨æ„ï¼šnullçš„sizeåº”å½“ä¸º0ï¼Œä¼˜å…ˆçº§åº”å½“æ˜¯æœ€å¤§çš„ã€‚\nå»ºæ ‘ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26  void read_tree(int n){ //æŠŠèŠ‚ç‚¹å…¨éƒ¨æ‰”åˆ°tmpé‡Œé¢å»  for(int i = 1;i\u0026lt;=n;i++) newnode(tmp[i],i); } node_t *build(int n){ read_tree(n); int top = 1; newnode(stack[0],-MAX);stack[0]-\u0026gt;p = -MAX; //éœ€è¦ä¿è¯è¶…çº§æ ¹èƒ½å‘†åœ¨æœ€ä¸Šé¢  for(int i = 1;i\u0026lt;=n;i++){ int nowp = top - 1; node_t *r = tmp[i],*pre = null;// r æ˜¯å¾…æ·»åŠ èŠ‚ç‚¹  while(stack[nowp]-\u0026gt;p \u0026gt; r -\u0026gt; p){ stack[nowp]-\u0026gt;pushup();//è¿™é‡Œéœ€è¦pushupï¼å› ä¸ºåº”å½“ä¿è¯ä¸‹é¢æ˜¯ä¸€ä¸ªåˆæ³•çš„treap;  pre = stack[nowp]; stack[nowp] = null; nowp--;// å‡ºæ ˆ  } stack[nowp+1] = stack[nowp]-\u0026gt;son[1] = r;//æŠŠré“¾æ¥åˆ°é“¾ä¸Š  stack[nowp+1]-\u0026gt;son[0] = pre;//æŠŠä¸‹é¢çš„é“¾è¿åˆ°rçš„å·¦å„¿å­  top = nowp+2;//æ›´æ–°æ ˆå†…å…ƒç´   } while(top) stack[--top]-\u0026gt;pushup();//æ›´æ–°  return stack[0]-\u0026gt;son[1];//è¿”å›æ ¹èŠ‚ç‚¹  }   è¿™é‡Œæ¯”è¾ƒå¤æ‚ã€‚ç®€å•æ¥è¯´å°±æ˜¯ä¸€ä¸ªç¬›å¡å°”æ ‘çš„æ„é€ ã€‚\nè¿™æ ·åšçš„ä¸»è¦å¥½å¤„æ˜¯å¯ä»¥åœ¨$O(n)$ä¹‹å†…å®Œæˆå»ºæ ‘ã€‚åœ¨è¿™é‡Œç»™å‡ºä¸€ä¸ªé“¾æ¥ï¼šSengxian\u0026rsquo;s Blog,æˆ‘è§‰å¾—è¿™ä½ç¥çŠ‡è®²çš„æ¯”è¾ƒé€šä¿—æ˜“æ‡‚ã€‚\nå…¶å®æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ä¸€ä¸ªç®€å•çš„æ–¹å¼åœ¨ $O(n \\log {n})$ çš„æ—¶é—´å†…å®Œæˆå»ºæ ‘ï¼Œå°±æ˜¯ä¸€ä¸ªä¸€ä¸ªçš„æ’å…¥è¿›å»ã€‚ä½†è¿™æ ·çœŸçš„ï¼Œå¾ˆæ…¢ã€‚\nä¸»è¦æ­¥éª¤å¦‚ä¸‹ï¼š\nè¿™é‡Œå¯¹äº $\\text{p}$ è€Œè¨€ï¼Œæˆ‘ä»¬æ„é€ å°æ ¹å †ã€‚\næˆ‘ä»¬å°†ä¸€ä¸ªèŠ‚ç‚¹è¡¨ç¤ºä¸ºï¼š$(\\text{key}, \\text{p})$ã€‚é¦–å…ˆå°†æ‰€æœ‰èŠ‚ç‚¹æŒ‰ç…§ $\\text{key}$ ä»å°åˆ°å¤§æ’åºã€‚åœ¨è¿™é‡Œï¼Œ\u0008å°±æ˜¯æˆ‘ä»¬çš„åºåˆ—é¡ºåºã€‚\nå¼•å…¥ä¸€ä¸ªæ ˆï¼Œæ ˆåº•å­˜æ”¾ä¸€ä¸ªå…ƒç´  $(-\\infty, -\\infty)$ï¼Œè¡¨ç¤ºè¶…çº§æ ¹ï¼Œè¿™æ ·ä¿è¯å®ƒæ€»åœ¨æœ€ä¸Šé¢ï¼Œä»–çš„å³å„¿å­å³ä¸ºæˆ‘ä»¬çœŸæ­£çš„æ ‘æ ¹ã€‚è¿™ä¸ªæ ˆï¼Œç»´æŠ¤äº†ç¬›å¡å°”æ ‘æœ€å³è¾¹çš„ä¸€æ¡é“¾ä¸Šé¢çš„å…ƒç´ ã€‚ï¼ˆå§‹ç»ˆå¾€å³çš„ä¸€æ¡é“¾ï¼‰\nä»å‰å¾€åéå† $(\\text{key}, \\text{p})$ï¼š\n å¯¹äºæ¯ä¸€ä¸ª $(\\text{key}_i, \\text{p}_i)$ï¼Œä»æ ˆä¸­æ‰¾å‡ºï¼ˆä»æ ˆé¡¶å¾€æ ˆåº•éå†ï¼‰ç¬¬ä¸€ä¸ª$p$å°äºç­‰äº $\\text{p}_i$ çš„å…ƒç´  $j$ã€‚\n  å°† $j$ ä¹‹ä¸Šå³ $\\text{p} \u0026gt; \\text{p}_o$ çš„ç‚¹å…¨éƒ¨å¼¹å‡ºã€‚\n  æˆ‘ä»¬åœ¨è¿™é‡Œè®° $j$ çš„å³å­èŠ‚ç‚¹ä¸º $pre$ ã€‚åœ¨æ ‘ä¸­ï¼Œå°† $pre$ æŒ‚åœ¨ $j$ çš„å·¦å­æ ‘ä¸Šï¼Œå°† $r$ æŒ‚åœ¨åŸæ¥ $j$ çš„å³å­æ ‘çš„ä½ç½®ã€‚\n å¯ä»¥è¯æ˜è¿™ä¸ªæ„é€ çš„æ—¶é—´å¤æ‚åº¦æ˜¯ $O(n)$ ã€‚\nä»¥ä¸Šå…³äºç¬›å¡å°”æ ‘çš„ä»‹ç»è½¬è½½è‡ªSengxiançš„Blogï¼Œç•¥æœ‰æ”¹å†™ã€‚\nåˆ†è£‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  //åˆ†è£‚ä¸ºä¸¤é¢—å­æ ‘ï¼Œå·¦å­æ ‘çš„å¤§å°ä¸ºlsize void split(node_t *r,int lsize,node_t *\u0026amp;ls,node_t *\u0026amp;rs){ if(r == null){//è¾¹ç•Œ  ls = null;rs = null; return; } r-\u0026gt;pushdown();//å¾ˆé‡è¦ï¼  if(r-\u0026gt;son[0]-\u0026gt;size + 1 \u0026lt;= lsize){ ls = r; split(r-\u0026gt;son[1],lsize - r-\u0026gt;son[0]-\u0026gt;size - 1,ls-\u0026gt;son[1],rs); } else{ rs = r; split(r-\u0026gt;son[0],lsize,ls,rs-\u0026gt;son[0]); } ls-\u0026gt;pushup();rs-\u0026gt;pushup(); }   çœ‹èµ·æ¥å¾ˆéš¾ï¼Œä½†å…¶å®å¾ˆç®€å•ã€‚\næˆ‘ä»¬é¢ä¸´çš„åªæœ‰ä¸€ä¸ªé—®é¢˜ï¼šå½“å‰èŠ‚ç‚¹å±äºå·¦å­æ ‘è¿˜æ˜¯å³å­æ ‘ï¼Ÿ\nåˆ¤å®šæ ‡å‡†ä¸€èˆ¬æ˜¯æ•°å€¼å¤§å°æˆ–è€…æ’åæ¥å†³å®šçš„ã€‚\n å¦‚æœæˆ‘ä»¬åˆ¤å®šå½“å‰æ ¹èŠ‚ç‚¹å±äºåˆ†è£‚åå·¦å­æ ‘ï¼Œé‚£ä¹ˆæ ¹èŠ‚ç‚¹çš„å·¦å­æ ‘å°±ä¸€å®šå±äºåˆ†è£‚åçš„å·¦å­æ ‘ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦å…³å¿ƒæ ¹èŠ‚ç‚¹çš„å³å­æ ‘å±äºåˆ†è£‚åé‚£é¢—å­æ ‘äº†ï¼Œç„¶åè¿™ä¸ªå°±å¯ä»¥é€’å½’ä¸‹å»äº†ï¼›åˆ¤å®šå±äºåˆ†è£‚åçš„å³å­æ ‘æ˜¯åŒç†çš„ã€‚\n ä»£ç ä¹Ÿæ²¡æœ‰ä»€ä¹ˆæ³¨æ„äº‹é¡¹ã€‚å¯ä»¥è¯æ˜ï¼Œåˆ†è£‚çš„æ—¶é—´å¤æ‚åº¦æ˜¯ $O(\\log {n})$ ã€‚\nåˆå¹¶ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  node_t *merge(node_t *ls,node_t *rs){ if(ls == null) return rs; if(rs == null) return ls; // è¾¹ç•Œ  if(ls-\u0026gt;p \u0026lt; rs-\u0026gt;p){ ls-\u0026gt;pushdown(); //éœ€è¦pushdownï¼  ls-\u0026gt;son[1] = merge(ls-\u0026gt;son[1],rs); ls-\u0026gt;pushup();//éœ€è¦pushupï¼  return ls; } else{ rs-\u0026gt;pushdown();//éœ€è¦pushdownï¼  rs-\u0026gt;son[0] = merge(ls,rs-\u0026gt;son[0]); rs-\u0026gt;pushup();//éœ€è¦pushupï¼  return rs; } }   è¿™ä¸ªå’Œåˆ†è£‚ä¹Ÿæ˜¯ç±»ä¼¼çš„ã€‚\næˆ‘ä»¬çš„ä¸»è¦ä»»åŠ¡å˜æˆäº†åˆ¤æ–­ï¼šå·¦å­æ ‘å³å­æ ‘çš„æ ¹èŠ‚ç‚¹å“ªä¸ªåº”è¯¥æ”¾åœ¨æ€»æ ‘çš„æ ¹èŠ‚ç‚¹ï¼Ÿ\nåˆ¤æ–­çš„ä¾æ®ååˆ†æ˜¾ç„¶ã€‚å°±æ˜¯ä¸¤ä¸ªæ ¹èŠ‚ç‚¹çš„ä¼˜å…ˆå€¼ã€‚ç»“åˆä¸Šé¢çš„åˆ†è£‚ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å‘ç°è¿™é‡Œçš„é€’å½’è§„å¾‹ï¼š\n å¦‚æœåˆå¹¶åæ ¹èŠ‚ç‚¹æ˜¯å·¦å­æ ‘çš„æ ¹èŠ‚ç‚¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æŠŠæ•´ä¸ªå·¦å­æ ‘çš„å·¦å­æ ‘ä¿ç•™ä¸‹æ¥ï¼Œä»è€ŒæŠŠå·¦å­æ ‘çš„å³å­æ ‘å’Œå³å­æ ‘ä¸€èµ·åˆå¹¶åˆ°å·¦å­æ ‘çš„å³å­æ ‘ï¼Œç„¶åå·¦å­æ ‘å°±å¯ä»¥ä½œä¸ºè¿”å›çš„èŠ‚ç‚¹äº†ã€‚å³å­æ ‘åŒç†ã€‚\n å¯ä»¥è¯æ˜ï¼Œåˆå¹¶çš„æ—¶é—´å¤æ‚åº¦ä¹Ÿæ˜¯ $O(\\log {n})$ ã€‚\nsplit to three 1 2 3 4 5 6  //lsæ˜¯å·¦å­æ ‘çš„sizeï¼Œrsæ˜¯ä¸­é—´å­æ ‘çš„size void split(int ls,int ms,node_t *\u0026amp;l,node_t *\u0026amp;m,node_t *\u0026amp;r){ node_t *m1; split(root,ls,l,m1); split(m1,ms,m,r); }   å¤ªç®€å•äº†ï¼Œä¸è¯´è¿™ä¸ªã€‚\nåŒºé—´ç¿»è½¬ 1 2 3 4 5 6 7  //è¿™é‡Œä½¿ç”¨çš„æ˜¯å·¦è¾¹å’Œå³è¾¹çš„è¾¹ç•Œ void reverse(int lb,int rb){ node_t *l,*m,*r; split(lb-1,rb-lb+1,l,m,r); m-\u0026gt;reverse(); root = merge(l,merge(m,r)); }   ä¹Ÿä¸å¤ªæƒ³è¯´ã€‚ä¸»è¦å°±æ˜¯è¦æ³¨æ„ä¸€ç‚¹ã€‚æˆ‘ä»¬åœ¨è¿™é‡Œï¼Œè¦ä¿è¯æ‰“è¿‡æ ‡è®°ä»¥åï¼Œè¿™ä¸ªèŠ‚ç‚¹çš„ä¿¡æ¯å·²ç„¶æ­£ç¡®ã€‚è¿™ä¸ªåœ¨å…¶ä»–çš„ä¾‹é¢˜é‡Œä¼šæ¯”è¾ƒä»¤äººèˆ’æœï¼Œå¯ä»¥å‡å°‘ä¸€äº›pushdownã€‚\nè™½ç„¶è¿™é“é¢˜åªæœ‰åŒºé—´ç¿»è½¬ï¼Œä½†æ˜¯å…¶ä»–çš„åŒºé—´æ“ä½œä¹Ÿå¯ä»¥åŒç†å®Œæˆã€‚Splayèƒ½åšçš„ï¼Œéæ—‹Treapéƒ½èƒ½åšï¼Œè€Œä¸”ä»–è¿˜å¯ä»¥è¿›è¡ŒæŒä¹…åŒ–ï¼Œè¿™æ˜¯Splayæ¯”ä¸äº†çš„ã€‚ï¼ˆç„¶è€Œæˆ‘å¹¶ä¸ä¼šå†™\nå®Œæ•´ä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208  #include \u0026lt;bits/stdc++.h\u0026gt;using namespace std; const int MAXN = 510000; const int MAX = 2147483647; /*ä»¥ä¸‹ä¸ºè¾“å…¥è¾“å‡ºä¼˜åŒ–*/ namespace fast_IO { inline char read() { static const int IN_LEN = 1000000; static char buf[IN_LEN], *s, *t; return s==t?t=(s=buf)+fread(buf,1,IN_LEN,stdin),*s++:*s++; } inline void read(int \u0026amp;x) { static bool iosig; static char c; for (iosig = false, c = read(); !isdigit(c); c = read()) { if (c == \u0026#39;-\u0026#39;) iosig = true; if (c == -1) return; } for (x = 0; isdigit(c); c = read()) x = (x \u0026lt;\u0026lt; 1) + (x \u0026lt;\u0026lt; 3) + (c ^ \u0026#39;0\u0026#39;); if (iosig) x = -x; } const int OUT_LEN = 10000000; char obuf[OUT_LEN], *ooh = obuf; inline void print(char c) { if (ooh == obuf + OUT_LEN) fwrite(obuf, 1, OUT_LEN, stdout), ooh = obuf; *ooh++ = c; } inline void print(int x) { static int buf[30], cnt; if (x == 0) { print(\u0026#39;0\u0026#39;); } else { if (x \u0026lt; 0) print(\u0026#39;-\u0026#39;), x = -x; for (cnt = 0; x; x /= 10) buf[++cnt] = x % 10 + 48; while (cnt) print((char)buf[cnt--]); } } inline void flush() { fwrite(obuf, 1, ooh - obuf, stdout); } }using namespace fast_IO; /*ä»¥ä¸Šä¸ºè¾“å…¥è¾“å‡ºä¼˜åŒ–*/ int k,n; struct node_t{ int val,p,size; bool rev; node_t *son[2],**null; void pushdown(){ if(this == *null) return; if(rev) { son[0]-\u0026gt;reverse(),son[1]-\u0026gt;reverse(); rev = 0; } } void pushup(){ if(this == *null) return; size = son[0]-\u0026gt;size + son[1]-\u0026gt;size + 1; } void reverse(){ if(this == *null) return; swap(son[0],son[1]); rev^=1; } }; struct fhqtreap{ node_t pool[MAXN],*tmp[MAXN],*stack[MAXN]; node_t *root,*null; int cnt,tot; void newnode(node_t *\u0026amp;r,int val = 0){ r = \u0026amp;pool[cnt++]; r-\u0026gt;val = val;r-\u0026gt;size = 1; r-\u0026gt;son[0] = r-\u0026gt;son[1] = null;r-\u0026gt;rev = 0; r-\u0026gt;null = \u0026amp;null; r-\u0026gt;p = rand(); } fhqtreap(){ cnt = 0; srand(time(NULL)); newnode(null); null-\u0026gt;p = MAX; root = null; null-\u0026gt;size = 0; } void read_tree(int n){ for(int i = 1;i\u0026lt;=n;i++) newnode(tmp[i],i); } node_t *build(int n){ read_tree(n); int top = 1; newnode(stack[0],-MAX); stack[0]-\u0026gt;p = -MAX; for(int i = 1;i\u0026lt;=n;i++){ int nowp = top - 1; node_t *r = tmp[i],*pre = null; while(stack[nowp]-\u0026gt;p \u0026gt; r -\u0026gt; p){ stack[nowp]-\u0026gt;pushup(); pre = stack[nowp]; stack[nowp] = null; nowp--; } stack[nowp+1] = stack[nowp]-\u0026gt;son[1] = r; stack[nowp+1]-\u0026gt;son[0] = pre; top = nowp+2; } while(top) stack[--top]-\u0026gt;pushup(); return stack[0]-\u0026gt;son[1]; } void split(node_t *r,int lsize,node_t *\u0026amp;ls,node_t *\u0026amp;rs){ if(r == null){ ls = null;rs = null; return; } r-\u0026gt;pushdown(); if(r-\u0026gt;son[0]-\u0026gt;size + 1 \u0026lt;= lsize){ ls = r; split(r-\u0026gt;son[1],lsize - r-\u0026gt;son[0]-\u0026gt;size - 1,ls-\u0026gt;son[1],rs); } else{ rs = r; split(r-\u0026gt;son[0],lsize,ls,rs-\u0026gt;son[0]); } ls-\u0026gt;pushup();rs-\u0026gt;pushup(); } node_t *merge(node_t *ls,node_t *rs){ if(ls == null) return rs; if(rs == null) return ls; if(ls-\u0026gt;p \u0026lt; rs-\u0026gt;p){ ls-\u0026gt;pushdown(); ls-\u0026gt;son[1] = merge(ls-\u0026gt;son[1],rs); ls-\u0026gt;pushup(); return ls; } else{ rs-\u0026gt;pushdown(); rs-\u0026gt;son[0] = merge(ls,rs-\u0026gt;son[0]); rs-\u0026gt;pushup(); return rs; } } void split(int ls,int ms,node_t *\u0026amp;l,node_t *\u0026amp;m,node_t *\u0026amp;r){ node_t *m1; split(root,ls,l,m1); split(m1,ms,m,r); } void reverse(int lb,int rb){ node_t *l,*m,*r; split(lb-1,rb-lb+1,l,m,r); m-\u0026gt;reverse(); root = merge(l,merge(m,r)); } void output(node_t *r,int *a){ if(r == null) return; r-\u0026gt;pushdown(); output(r-\u0026gt;son[0],a); a[r-\u0026gt;son[0]-\u0026gt;size] = r-\u0026gt;val; output(r-\u0026gt;son[1],a + r-\u0026gt;son[0]-\u0026gt;size+1); } void print(node_t *r = NULL,int depth = 0){ if(r == NULL) r = root; if(r == null) return; print(r-\u0026gt;son[0],depth+1); for(int i = 0;i\u0026lt;depth;i++) putchar(\u0026#39; \u0026#39;); printf(\u0026#34;val:%d p:%d size:%d son:%d %d rev?:%d\\n\u0026#34;,r-\u0026gt;val,r-\u0026gt;p,r-\u0026gt;size,r-\u0026gt;son[0] != null,r-\u0026gt;son[1] != null,r-\u0026gt;rev); print(r-\u0026gt;son[1],depth+1); return; } }; fhqtreap w; int ans[MAXN]; void init(){ read(n),read(k); w.root = w.build(n); } void solve(){ int a,b; for(int i = 1;i\u0026lt;=k;i++){ read(a),read(b); w.reverse(a,b); } w.output(w.root,ans); for(int i = 0;i\u0026lt;n;i++){ print(ans[i]);print(\u0026#39; \u0026#39;); } print(\u0026#39;\\n\u0026#39;); } int main(){ init(); solve(); flush(); return 0; }   ä¾‹é¢˜ ã€ŒNOI2005ã€ç»´æŠ¤æ•°åˆ—-éæ—‹Treap\nä¸€äº›å‚è€ƒ è¿™é‡Œæœ‰ä¸€äº›è®²éæ—‹è½¬$Treap$çš„åšå®¢ï¼š\nSengxian\u0026rsquo;s Blog\nxehoth\u0026rsquo;s Blog\nMemphis\u0026rsquo;s Blog\n","description":"","id":211,"section":"posts","tags":["Treap","å¹³è¡¡æ ‘","æ•°æ®ç»“æ„","æ¨¡æ¿"],"title":"éæ—‹Treapå­¦ä¹ ç¬”è®°","uri":"https://blog.chenqiqian.com/posts/notes-none-rotating-treap/"},{"content":"åˆå§‹æ—¶ï¼Œç¬¬ $i$ å·æˆ˜èˆ°å¤„äºç¬¬ $i$ åˆ— $(i = 1, 2, â€¦, 30000)$ ã€‚\næœ‰ä¸¤ç§æŒ‡ä»¤ï¼š\nåˆå¹¶æŒ‡ä»¤ä¸º M i j ï¼Œå«ä¹‰ä¸ºå°†ç¬¬ $i$ å·æˆ˜èˆ°æ‰€åœ¨çš„æ•´ä¸ªæˆ˜èˆ°é˜Ÿåˆ—ï¼Œä½œä¸ºä¸€ä¸ªæ•´ä½“ï¼ˆå¤´åœ¨å‰å°¾åœ¨åï¼‰æ¥è‡³ç¬¬ $j$ å·æˆ˜èˆ°æ‰€åœ¨çš„æˆ˜èˆ°é˜Ÿåˆ—çš„å°¾éƒ¨ã€‚\nè¯¢é—®æŒ‡ä»¤ä¸º C i j ã€‚è¯¥æŒ‡ä»¤æ„æ€è¯¢é—®ç¬¬ $i$ å·æˆ˜èˆ°ä¸ç¬¬ $j$ å·æˆ˜èˆ°å½“å‰æ˜¯å¦åœ¨åŒä¸€åˆ—ä¸­ï¼Œå¦‚æœåœ¨åŒä¸€åˆ—ä¸­ï¼Œé‚£ä¹ˆå®ƒä»¬ä¹‹é—´å¸ƒç½®æœ‰å¤šå°‘æˆ˜èˆ°ã€‚\né“¾æ¥ Luogu P1196\né¢˜è§£ ä¸€é“å¹¶æŸ¥é›†çš„é¢˜ç›®ã€‚\nå› ä¸ºå¿«é€Ÿçš„å¯»æ‰¾ä¸¤ä¸ªæˆ˜èˆ°æ˜¯å¦åœ¨åŒä¸€åˆ—é‡Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¹¶æŸ¥é›†æ•°æ®ç»“æ„ã€‚ä½†æ³¨æ„åˆ°é¢˜ç›®è¿˜è¦è¯¢é—®ä¸¤ä¸ªæˆ˜èˆ°ä¹‹é—´çš„è·ç¦»ï¼Œæˆ‘ä»¬éœ€è¦é¢å¤–ç»´æŠ¤ä¸€äº›ä¿¡æ¯ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç”¨åŠ æƒçš„å¹¶æŸ¥é›†ã€‚\nè¯´çš„åŠ æƒï¼Œäº‹å®ä¸Šå°±æ˜¯åœ¨æ¯ä¸€ä¸ªèŠ‚ç‚¹ä¸Šé¢å¤–ç»´æŠ¤ä¸€äº›ä¿¡æ¯ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åœ¨èŠ‚ç‚¹ä¸Šé¢å¤–ç»´æŠ¤åˆ°çˆ¶èŠ‚ç‚¹çš„è·ç¦»ï¼Œåœ¨æ ¹èŠ‚ç‚¹å¤„ç»´æŠ¤è¿™ä¸ªé›†åˆçš„å¤§å°ã€‚\nåœ¨å¯»æ‰¾æŸä¸ªèŠ‚ç‚¹çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥è¿›è¡Œè·¯å¾„å‹ç¼©ã€‚åªéœ€è¦å…ˆå¯¹çˆ¶èŠ‚ç‚¹é€’å½’å®Œæˆåï¼ŒæŠŠæƒå€¼åŠ ä¸Šçˆ¶èŠ‚ç‚¹çš„æƒå€¼ï¼Œç„¶åå°±å¯ä»¥ç›´æ¥è¿åˆ°æ ¹ä¸Šã€‚\nåˆå¹¶æ“ä½œä¹Ÿå·®ä¸å¤šã€‚ä¸ºäº†ä½¿åˆå¹¶æ“ä½œç®€å•ï¼Œæˆ‘ä»¬éœ€è¦ä¿è¯çˆ¶èŠ‚ç‚¹ä¸€å®šåœ¨å­èŠ‚ç‚¹å‰é¢ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬æ‰¾åˆ°çš„æ ¹èŠ‚ç‚¹å°±æ˜¯æ¯ä¸ªé˜Ÿåˆ—çš„æœ€å‰æ–¹çš„èŠ‚ç‚¹ã€‚ç„¶åå¯ä»¥å°†åé¢æ¥ä¸Šçš„èŠ‚ç‚¹çš„çˆ¶äº²æŒ‡å‘å‰é¢çš„èŠ‚ç‚¹ï¼Œè·ç¦»è®¾ä¸ºå‰é¢çš„é›†åˆçš„å¤§å°ï¼Œå°±å¯ä»¥ç»´æŠ¤äº†ã€‚\næŸ¥è¯¢è·ç¦»çš„æ—¶å€™ï¼Œåªéœ€è¦æŠŠä¸¤ä¸ªèŠ‚ç‚¹åˆ°æ ¹çš„è·ç¦»ç®—å‡ºæ¥ï¼Œä½œå·®å–ç»å¯¹å€¼ï¼Œç„¶åå†å‡å»1å³å¯ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;algorithm\u0026gt;#define MAXN 30010 using namespace std; int f[MAXN],d[MAXN],s[MAXN],t; // f ç»´æŠ¤çˆ¶äº²èŠ‚ç‚¹ï¼Œd ç»´æŠ¤äºçˆ¶äº²èŠ‚ç‚¹çš„è·ç¦»ï¼Œs åœ¨æ ¹èŠ‚ç‚¹å¤„ç»´æŠ¤é›†åˆçš„å…ƒç´ æ•°  int find(int x){ if(f[x] == x){ return x; } else{ int w = find(f[x]); d[x] += d[f[x]]; f[x] = w; return w; } } void un(int x,int y){ int b = find(y),e = find(x); if(b == e){ return; } else{ d[e] = s[b],d[b] = 0; s[b] = s[b] + s[e],s[e] = 0; f[e] = b; return; } } int main(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;t); for(int i = 1;i\u0026lt;MAXN;i++){ f[i] = i,d[i] = 0,s[i] = 1; } for(int i = 1;i\u0026lt;=t;i++){ char op[20];int a,b; scanf(\u0026#34;%s\u0026#34;,op); scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;a,\u0026amp;b); if(op[0] == \u0026#39;M\u0026#39;){ un(a,b); } else{ int a1 = find(a),b1 = find(b); if(a1!=b1){ printf(\u0026#34;-1\\n\u0026#34;); } else{ printf(\u0026#34;%d\\n\u0026#34;,abs(d[a]-d[b])-1); } } } return 0; }   ","description":"","id":212,"section":"posts","tags":["æ•°æ®ç»“æ„","å¹¶æŸ¥é›†"],"title":"ã€ŒNOI2002ã€é“¶æ²³è‹±é›„ä¼ è¯´-å¹¶æŸ¥é›†","uri":"https://blog.chenqiqian.com/posts/noi2002-hero/"},{"content":"Dinicç®—æ³•æ˜¯ä¸€ç§ç”¨äºç½‘ç»œæµä¸­æœ€å¤§æµçš„å¢å¹¿è·¯ç®—æ³•ï¼Œå…¶æ—¶é—´å¤æ‚åº¦ä¸º$O(n^2 \\times m)$ï¼Œä½†å¤§å¤šæ•°æƒ…å†µä¸‹ä¼šè¿œè¿œä¼˜äºæ­¤æ—¶é—´å¤æ‚åº¦ã€‚\nåŸºæœ¬æ¦‚å¿µ ä»Menciç¥çŠ‡çš„åšå®¢å¤åˆ¶è€Œæ¥ã€‚æˆ‘è§‰å¾—è¿™å†™çš„æ˜¯å¾ˆå¥½çš„ä¸€ç¯‡ä»‹ç»ï¼Œé™¤äº†ä»£ç é£æ ¼ä¸å¤ªå–œæ¬¢ã€‚\n  å®¹é‡ï¼š ${capacity}(e)$ è¡¨ç¤ºä¸€æ¡æœ‰å‘è¾¹ $e(u,v)$ çš„æœ€å¤§å…è®¸çš„æµé‡ã€‚\n  æµé‡ï¼š ${flow}(e)$ è¡¨ç¤ºä¸€æ¡æœ‰å‘è¾¹ $e(u,v)$ æ€»å®¹é‡ä¸­å·²è¢«å ç”¨çš„æµé‡ã€‚\n  å‰©ä½™å®¹é‡ï¼ˆæ®‹é‡ï¼‰ï¼šå³ $capacity(e)âˆ’flow(e)$ï¼Œè¡¨ç¤ºå½“å‰æ—¶åˆ»æŸæ¡æœ‰å‘è¾¹ $e(u,v)$ æ€»æµé‡ä¸­æœªè¢«å ç”¨çš„éƒ¨åˆ†ã€‚\n  åå‘è¾¹ï¼šåŸå›¾ä¸­æ¯ä¸€æ¡æœ‰å‘è¾¹åœ¨æ®‹é‡ç½‘ç»œä¸­éƒ½æœ‰å¯¹åº”çš„åå‘è¾¹ï¼Œåå‘è¾¹çš„å®¹é‡ä¸º$0$ï¼Œå®¹é‡çš„å˜åŒ–ä¸åŸè¾¹ç›¸åï¼›ã€åå‘è¾¹ã€çš„æ¦‚å¿µæ˜¯ç›¸å¯¹çš„ï¼Œå³ä¸€æ¡è¾¹çš„åå‘è¾¹çš„åå‘è¾¹æ˜¯å®ƒæœ¬èº«ã€‚\n  æ®‹é‡ç½‘ç»œï¼šåœ¨åŸå›¾çš„åŸºç¡€ä¹‹ä¸Šï¼Œæ·»åŠ æ¯æ¡è¾¹å¯¹åº”çš„åå‘è¾¹ï¼Œå¹¶å‚¨å­˜æ¯æ¡è¾¹çš„å½“å‰æµé‡ã€‚æ®‹é‡ç½‘ç»œä¼šåœ¨ç®—æ³•è¿›è¡Œçš„è¿‡ç¨‹ä¸­è¢«ä¿®æ”¹ã€‚\n  å¢å¹¿è·¯ï¼ˆaugmenting pathï¼‰ï¼šæ®‹é‡ç½‘ç»œä¸­ä»æºç‚¹åˆ°æ±‡ç‚¹çš„ä¸€æ¡è·¯å¾„ï¼Œå¢å¹¿è·¯ä¸Šæ‰€æœ‰è¾¹ä¸­æœ€å°çš„å‰©ä½™å®¹é‡ä¸ºå¢å¹¿æµé‡ã€‚\n  å¢å¹¿ï¼ˆaugmentingï¼‰ï¼šåœ¨æ®‹é‡ç½‘ç»œä¸­å¯»æ‰¾ä¸€æ¡å¢å¹¿è·¯ï¼Œå¹¶å°†å¢å¹¿è·¯ä¸Šæ‰€æœ‰è¾¹çš„æµé‡åŠ ä¸Šå¢å¹¿æµé‡çš„è¿‡ç¨‹ã€‚\n  å±‚æ¬¡ï¼š $level(u)$ è¡¨ç¤ºèŠ‚ç‚¹ $u$ åœ¨å±‚æ¬¡å›¾ä¸­ä¸æºç‚¹çš„è·ç¦»ã€‚\n  å±‚æ¬¡å›¾ï¼šåœ¨åŸæ®‹é‡ç½‘ç»œä¸­æŒ‰ç…§æ¯ä¸ªèŠ‚ç‚¹çš„å±‚æ¬¡æ¥åˆ†å±‚ï¼Œåªä¿ç•™ç›¸é‚»ä¸¤å±‚çš„èŠ‚ç‚¹çš„å›¾ï¼Œæ»¡è½½ï¼ˆå³æµé‡ç­‰äºå®¹é‡ï¼‰çš„è¾¹ä¸å­˜åœ¨äºå±‚æ¬¡å›¾ä¸­ã€‚\n  æ€è·¯ ç”¨æ–‡å­—å™è¿°å¤§æ¦‚å¦‚ä¸‹ï¼š\n1. å»ºç«‹ä»¥å‡ºå‘ç‚¹ä¸ºæºç‚¹çš„å±‚æ¬¡å›¾ï¼ˆå³æºç‚¹åˆ°å„åº—çš„è·ç¦»ï¼‰ 2. åœ¨å±‚æ¬¡å›¾\u0026amp;æ®‹é‡ç½‘ç»œä¸­å¯»æ‰¾å¢å¹¿è·¯ï¼Œå¹¶å¢å¹¿æµé‡ 3. é‡å¤2ç›´åˆ°æ‰¾ä¸åˆ°å¢å¹¿è·¯ 4. é‡å¤123ç›´åˆ°ä¸å­˜åœ¨å±‚æ¬¡å›¾ å®ç° å»ºç«‹å±‚æ¬¡å›¾ä½¿ç”¨bfsï¼Œè€Œå¯»æ‰¾å¢å¹¿è·¯åˆ™æ˜¯ä½¿ç”¨dfsé€’å½’å¢å¹¿ã€‚\nå…·ä½“å®ç°çš„æ—¶å€™ä¹Ÿæœ‰ä¸€å®šçš„æŠ€å·§ï¼Œåœ¨ä»£ç é‡Œé¢æœ‰æ³¨é‡Šã€‚\nåå‘è¾¹å­˜åœ¨çš„æ„ä¹‰æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå½¢è±¡æ¥è¯´å…¶å®å°±æ˜¯ç»™ä½ ä¸€ä¸ªåæ‚”çš„æœºä¼šï¼Œå¾€ä¸€è¾¹æµå»ä¹‹åè¿˜èƒ½å†å›æ¥ã€‚æ³¨æ„åå‘è¾¹çš„å®¹é‡åœ¨æˆ‘è¿™é‡Œåˆå§‹ä¸º0ã€‚\næœ‰ä¸€ä¸ªä¼˜åŒ–å°±æ˜¯å½“å‰å¼§ä¼˜åŒ–ã€‚è¿™ä¸ªä¼˜åŒ–æ˜¯å¾ˆæ˜¾è€Œæ˜“è§çš„ã€‚å¦‚æœè¿™æ¡è¾¹åœ¨å½“å‰å±‚æ¬¡å›¾ä¸‹æ‰¾ä¸åˆ°è·¯ï¼Œé‚£ä¹ˆè¿™æ¡è¾¹åœ¨å½“å‰å±‚æ¬¡å›¾å†…å°±å†ä¹Ÿä¸ä¼šç”¨åˆ°ã€‚æ‰€ä»¥æˆ‘ä»¬å•å¼€ä¸€ä¸ªcuræ•°ç»„ï¼Œè®°å½•ç›®å‰éå†åˆ°çš„è¾¹ï¼Œè¿™æ ·å°±å¯ä»¥è¿›è¡Œä¼˜åŒ–ã€‚\nä»£ç  ä»¥Luogu P3376ä¸ºä¾‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;queue\u0026gt;#include \u0026lt;cstring\u0026gt;#include \u0026lt;algorithm\u0026gt;using namespace std; struct Edge{ int from,to,flow,cap; int next; }edge[201000]; int fir[10100],dis[10100],cur[10100]; int n,m,s,t,tot = 2;//totä»2å¼€å§‹æ˜¯æœ€èˆ’æœçš„ï¼Œæ—¢å¯ä»¥ç›´æ¥å¼‚æˆ–ï¼Œåé¢çš„ç»ˆæ­¢æ¡ä»¶ä¹Ÿä¸ç”¨æƒ³æ¥æƒ³å»ã€‚  bool bfs(){ queue\u0026lt;int\u0026gt; q; memset(dis,0,sizeof(dis)); memcpy(cur,fir,sizeof(fir));//æ¸…ç©ºå½“å‰è¾¹  q.push(s);dis[s] = 1; while(!q.empty()){ int nown = q.front();q.pop(); for(int nowe = fir[nown];nowe!=0;nowe = edge[nowe].next){ int v = edge[nowe].to; if(dis[v] == 0 \u0026amp;\u0026amp; edge[nowe].cap \u0026gt; edge[nowe].flow){ //ä¸¤ä¸ªæ¡ä»¶ï¼šæœªéå†è€Œä¸”è¾¹å¯ä»¥å¢å¹¿  dis[v] = dis[nown]+1; q.push(v); //ç”±äºæˆ‘ä»¬åªæ²¿æœ€çŸ­è·¯å¢å¹¿ï¼Œæ‰€ä»¥è¿™é‡Œå°±å¯ä»¥ç›´æ¥breakæ‰äº†ã€‚  if(v == t) return dis[t]; } } } return dis[t]; } int dfs(int nown,int limit = 0x3f3f3f3f){ //æ‰¾åˆ°ç»ˆç‚¹æˆ–æ²¡å¾—å¯æ‰¾ è¿™ä¸ªä¼˜åŒ–å¾ˆé‡è¦  if(nown == t || limit == 0) return limit; for(int \u0026amp;nowe = cur[nown];nowe!=0;nowe = edge[nowe].next){ //è¿™é‡Œæœ‰å½“å‰å¼§ä¼˜åŒ–  int v = edge[nowe].to; if(dis[v] == dis[nown]+1 \u0026amp;\u0026amp; edge[nowe].flow \u0026lt; edge[nowe].cap){ //æ»¡è¶³å±‚æ¬¡å›¾æ¡ä»¶(æ²¿ç€æœ€çŸ­è·¯)  int f = dfs(v,min(edge[nowe].cap-edge[nowe].flow,limit)); if(f\u0026gt;0){ //æ›´æ”¹å½“å‰è¾¹  edge[nowe].flow+=f; edge[nowe^1].flow-=f; return f; } } } return 0; } int dinic(){ int ans = 0,f; while(bfs()){//bfsæ˜¯æ­¥éª¤1  while( (f = dfs(s)) \u0026gt; 0)//dfsæ˜¯æ­¥éª¤2  ans+=f; } return ans; } void addedge(int a,int b,int c){ edge[tot].from = a;edge[tot].to = b; edge[tot].cap = c;edge[tot].flow = 0; edge[tot].next = fir[a];fir[a] = tot; tot++; } int main(){ scanf(\u0026#34;%d %d %d %d\u0026#34;,\u0026amp;n,\u0026amp;m,\u0026amp;s,\u0026amp;t); for(int i = 0;i\u0026lt;m;i++){ int a,b,c; scanf(\u0026#34;%d %d %d\u0026#34;,\u0026amp;a,\u0026amp;b,\u0026amp;c); addedge(a,b,c); addedge(b,a,0);//éœ€è¦åŠ åå‘è¾¹  } printf(\u0026#34;%d\\n\u0026#34;,dinic()); return 0; }   ","description":"","id":213,"section":"posts","tags":["å›¾è®º","Dinic","æ¨¡æ¿"],"title":"Dinicå­¦ä¹ ç¬”è®°","uri":"https://blog.chenqiqian.com/posts/notes-dinic/"},{"content":"æœ‰äº›åŒå­¦å›å®¶äº†ï¼Œè€Œæœ‰äº›åŒå­¦åˆ™æœ‰ä»¥å‰çš„å¥½æœ‹å‹æ¥æ¢è®¿ï¼Œé‚£ä¹ˆä½å®¿å°±æ˜¯ä¸€ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬å‡è®¾æ¯ä¸ªäººåªèƒ½ç¡å’Œè‡ªå·±ç›´æ¥è®¤è¯†çš„äººçš„åºŠã€‚æˆ‘ä»¬å·²çŸ¥ä¸€å…±æœ‰ $n$ ä¸ªäººï¼Œå¹¶ä¸”çŸ¥é“å…¶ä¸­æ¯ä¸ªäººæ˜¯ä¸æ˜¯æœ¬æ ¡å­¦ç”Ÿï¼Œä¹ŸçŸ¥é“æ¯ä¸ªæœ¬æ ¡å­¦ç”Ÿæ˜¯å¦å›å®¶ã€‚é—®æ˜¯å¦å­˜åœ¨ä¸€ä¸ªæ–¹æ¡ˆä½¿å¾—æ‰€æœ‰ä¸å›å®¶çš„æœ¬æ ¡å­¦ç”Ÿå’Œæ¥çœ‹ä»–ä»¬çš„å…¶ä»–äººéƒ½æœ‰åœ°æ–¹ä½ã€‚\né“¾æ¥ Luogu P2055\né¢˜è§£ è¿™é“é¢˜å…¶å®\u0008å¯ä»¥è½¬åŒ–æˆäºŒåˆ†å›¾åŒ¹é…çš„é—®é¢˜ã€‚å¦‚æœæŠŠæ‰€æœ‰ä¸å›å®¶çš„åœ¨æ ¡ç”Ÿå’Œå‰æ¥æ¢è®¿çš„æœ‹å‹æ”¾åœ¨äºŒåˆ†å›¾ä¸€ä¾§ï¼Œæ‰€æœ‰\u0008æœ¬æ ¡å­¦ç”ŸåºŠæ”¾åœ¨äºŒåˆ†å›¾å¦ä¸€ä¾§ï¼Œå†å°†è®¤è¯†çš„äºº\u0026amp;åºŠè¿è¾¹ï¼ˆåŒ…æ‹¬è‡ªå·±å’Œè‡ªå·±çš„åºŠï¼‰ï¼Œæ³¨æ„ä¸Šé¢çš„\u0008äººä¸åŒ…æ‹¬å›å®¶çš„äººã€‚\nç„¶åå°±æ˜¯ä¸€ä¸ªæ¨¡ç‰ˆçš„äºŒåˆ†å›¾åŒ¹é…äº†ã€‚ç„¶è€Œæˆ‘åªä¼šå†™ç½‘ç»œæµï¼Œæ‰€ä»¥å†™äº†ä¸€ä¸ª Dinic ä¸Šå»ï¼Œä½¿ç”¨äº†å•è·¯å¢å¹¿\u0026amp;å½“å‰å¼§ä¼˜åŒ–ã€‚\nç„¶è€Œå¼€å§‹è°ƒäº†ä¸€ä¸ªä¸‹åˆä¹Ÿæ²¡è°ƒå¯¹ã€‚ç„¶è€Œå›å®¶è°ƒäº†ä¸€ä¸ªæ™šä¸Šä¹Ÿæ²¡è°ƒå¯¹ã€‚\u0008\u0008\u0008æœ€åè¿˜ç®—æ˜¯è°ƒå¯¹äº†ã€‚å¥‡æ€ªçš„æ˜¯æˆ‘ä»Šå¤©åˆæ•²äº†å¦ä¸€ä¸ª Dinic ï¼Œç„¶åç«Ÿç„¶1æ¬¡ AC äº†ã€‚\u0008ç¼˜å¦™ä¸å¯è¨€å•Šã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cstring\u0026gt;#include \u0026lt;queue\u0026gt;#include \u0026lt;algorithm\u0026gt;using namespace std; struct Edge{ int from,to,flow,cap; int next; }edge[20000]; int fir[300],dis[300],cur[300]; int n,T,home[300],local[300],s,t,tot; bool bfs(){ queue\u0026lt;int\u0026gt; q; memset(dis,0,sizeof(dis)); memcpy(cur,fir,sizeof(fir)); q.push(s);dis[s] = 1; while(!q.empty()){ int nown = q.front();q.pop(); for(int e = fir[nown];e!=0;e = edge[e].next){ int v = edge[e].to; if(dis[v] == 0 \u0026amp;\u0026amp; edge[e].cap \u0026gt; edge[e].flow){ dis[v] = dis[nown]+1; q.push(v); } } } return dis[t]; } int dfs(int nown,int limit = 0x3f3f3f3f){ if(nown == t || limit == 0) return limit; for(int \u0026amp;e = cur[nown];e!=0;e = edge[e].next){ int f,v = edge[e].to; if(dis[v] == dis[nown]+1\u0026amp;\u0026amp;edge[e].flow \u0026lt;edge[e].cap){ int f = dfs(v,min(edge[e].cap-edge[e].flow,limit)); if(f\u0026gt;0){ edge[e].flow+=f; edge[e^1].flow-=f; return f; } } } return 0; } int dinic(){ int ans = 0,f; while(bfs()){ while((f = dfs(s)\u0026gt;0)) ans+=f; } return ans; } void addedge(int from,int to,int c){ edge[tot].from = from;edge[tot].to = to; edge[tot].cap = c;edge[tot].flow = 0; edge[tot].next = fir[from];fir[from] = tot; tot++; } int main(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;T); for(int i = 1;i\u0026lt;=T;i++){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n); //æ¸…é›¶  memset(edge,0,sizeof(edge)); memset(home,0,sizeof(home)); memset(local,0,sizeof(local)); memset(fir,0,sizeof(fir)); tot = 2;int cnt = 0; s = 2*n+1,t = 2*n+2; //æ˜¯å¦\u0008æœ¬æ ¡  for(int i = 1;i\u0026lt;=n;i++){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;local[i]); } //æ˜¯å¦å›å®¶  for(int i = 1;i\u0026lt;=n;i++){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;home[i]); if(local[i] == 0) home[i] = 0; } //æ˜¯å¦è®¤è¯†ä¸”ç¬¦åˆæ¡ä»¶  for(int i = 1;i\u0026lt;=n;i++){ for(int j = 1;j\u0026lt;=n;j++){ int tmp;scanf(\u0026#34;%d\u0026#34;,\u0026amp;tmp); if(i == j) tmp = 1; if(home[i] == 1||local[j] == 0||tmp == 0) continue; else addedge(i,j+n,1),addedge(j+n,i,0); } } //è¶…çº§æºç‚¹\u0026amp;\u0026amp;æ±‡ç‚¹  for(int i = 1;i\u0026lt;=n;i++){ if(home[i] == 0) addedge(s,i,1),addedge(i,s,0),cnt++; if(local[i] == 1) addedge(i+n,t,1),addedge(t,i+n,0); } if(dinic()==cnt) printf(\u0026#34;^_^\\n\u0026#34;); else printf(\u0026#34;T_T\\n\u0026#34;); } return 0; }   ","description":"","id":214,"section":"posts","tags":["å›¾è®º","äºŒåˆ†å›¾åŒ¹é…","Dinic"],"title":"ã€ŒZJOI2009ã€å‡æœŸçš„å®¿èˆ-äºŒåˆ†å›¾åŒ¹é…","uri":"https://blog.chenqiqian.com/posts/zjoi2009-vacation/"},{"content":"è¿™ç¯‡\u0008ä¸»è¦ä»‹ç»åœ¨åºåˆ—ä¸Šçš„æ— ä¿®æ”¹ä»¥åŠå¸¦ä¿®æ”¹çš„ç¦»çº¿è«é˜Ÿç®—æ³•ã€‚\nç®€ä»‹ è«é˜Ÿç®—æ³•æ˜¯ä¸€ä¸ªå……æ»¡ç€æš´åŠ›ç¾å­¦çš„ç®—æ³•ã€‚\nè«é˜Ÿç®—æ³•ä¸»è¦æ˜¯ç”¨æ¥è§£å†³ä¸€äº›ç¦»çº¿æ— ä¿®æ”¹çš„åŒºé—´æŸ¥è¯¢é—®é¢˜ï¼Œå®ç°èµ·æ¥ç›¸æ¯”æ¯”è¾ƒçš„ç®€å•ã€‚è€Œè«é˜Ÿç®—æ³•çš„ä¸»è¦ç”¨åœ¨çº¿æ®µæ ‘ç­‰æ•°æ®ç»“æ„æ— æ³•åœ¨å¾ˆçŸ­æ—¶é—´å†…å®ç°åŒºé—´ä¿¡æ¯åˆå¹¶çš„æƒ…å†µã€‚\nè«é˜Ÿç®—æ³• æ ¸å¿ƒæ€æƒ³ é¦–å…ˆè«é˜Ÿç®—æ³•çš„ä½¿ç”¨æƒ…æ™¯åœ¨ä¸Šé¢å·²ç»æåŠã€‚é‚£ä¹ˆæ¥ä¸‹æ¥è®©æˆ‘ä»¬ä»¥ä¸€ä¸ªå®ä¾‹æ¥ç†è§£è«é˜Ÿç®—æ³•ã€‚\n æœ‰ä¸€ä¸ªæ­£æ•´æ•°åºåˆ—$A$ï¼Œ$m$æ¬¡è¯¢é—®åœ¨$[l,r]$åŒºé—´å†…æœ‰å¤šå°‘ä¸ªä¸åŒçš„æ•°ã€‚(HHçš„é¡¹é“¾)\n ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬ä¼šæƒ³åˆ°ä½¿ç”¨çº¿æ®µæ ‘ï¼Œä½†è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¹¶ä¸èƒ½å¾ˆå¿«ï¼ˆæ¯”å¦‚$O(1)$ ï¼‰çš„å®Œæˆä¸¤ä¸ªåŒºé—´ä¿¡æ¯çš„åˆå¹¶ï¼Œæ‰€ä»¥è¯´çº¿æ®µæ ‘åœ¨è¿™é‡Œæ˜¯èµ·ä¸äº†ä½œç”¨çš„ã€‚\nä½†æ˜¯ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°ï¼Œå¦‚æœé‡‡ç”¨é€‚å½“çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å¸¸æ•°æ—¶é—´å†…ç”±$[l,r]$åŒºé—´å¾—åˆ°$[l-1,r]$å’Œ$[l,r+1]$çš„ä¿¡æ¯ï¼Œåªéœ€è¦è®°å½•ä¸€ä¸‹è¿™ä¸ªæ•°å‡ºç°çš„æ¬¡æ•°ï¼Œç„¶åå¢åŠ çš„æ—¶å€™åˆ¤ä¸€ä¸‹æ˜¯å¦ä¸ºç©ºå³å¯ã€‚åŒç†ï¼Œç•¥åŠ æ€è€ƒï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å‘ç°ä»$[l,r]$åŒºé—´å¾—åˆ°$[l+1,r]$å’Œ$[l,r-1]$çš„ä¿¡æ¯çš„æ–¹æ³•ã€‚\næ‰€ä»¥å¦‚æœæˆ‘ä»¬ç›´æ¥å¯¹å·¦ç«¯ç‚¹æ’åºï¼Œç„¶åæš´åŠ›è½¬ç§»çš„è¯ï¼Œé‚£ä¹ˆè¿™ä¸ªç®—æ³•çš„æ—¶é—´å¤æ‚åº¦åœ¨æœ€åæƒ…å†µä¸‹æ˜¯$O(n^2)$çš„ã€‚\nè¿™ä¸ªæ—¶å€™å°±è¦ç”¨è«é˜Ÿçš„æ€æƒ³æ¥ç®€åŒ–è¿™ä¸ªæ—¶é—´å¤æ‚åº¦ã€‚\næˆ‘ä»¬æ³¨æ„åˆ°ï¼Œåœ¨$O(n^2)$ç®—æ³•ä¸­ï¼Œæ¯ä¸€æ¬¡çš„å·¦å³ç«¯ç‚¹æœ€åè¦ç§»åŠ¨$n$æ¬¡ã€‚èƒ½ä¸èƒ½æƒ³ä¸€ä¸ªåŠæ³•ï¼Œè®©è¿™ä¸ªç§»åŠ¨æ¬¡æ•°å˜å°å‘¢ï¼Ÿå¦‚æœé€šè¿‡æŸç§æ–¹æ³•æ’åºåï¼Œèƒ½å¤Ÿä½¿å¾—æŸäº›ç›¸é‚»çš„æŸ¥è¯¢ç§»åŠ¨å˜å°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä¼˜åŒ–æ—¶é—´å¤æ‚åº¦ã€‚ä½†åŒæ—¶æ³¨æ„åˆ°ï¼Œä¼˜åŒ–äº†ä¸€ä¸ªç§»åŠ¨çš„åŒæ—¶ï¼Œä¼šå¯¼è‡´é‚£äº›è¢«æ’é™¤å‡ºä¸Šæ–‡æåˆ°çš„ç›¸é‚»çš„æŸ¥è¯¢ä¹‹é—´çš„ç§»åŠ¨å˜å¤§ä¸€äº›ã€‚æ‰€ä»¥äº‹å®ä¸Šæˆ‘ä»¬æ˜¯åœ¨å¯»æ±‚ä¸€ä¸ªå¹³è¡¡ã€‚\næˆ‘ä»¬å¯ä»¥é‡‡ç”¨åˆ†å—çš„åŠæ³•ã€‚å‡è®¾æˆ‘ä»¬çš„åˆ†å—å¤§å°æ˜¯$Q$,é‚£ä¹ˆåº”è¯¥ä¸€å…±æœ‰$\\frac{n}{Q}$ä¸ªå—ã€‚åˆ†å—ä¹‹åï¼ŒæŒ‰ç…§å·¦ç«¯ç‚¹æ‰€åœ¨çš„å—çš„åºå·ä¸ºç¬¬ä¸€å…³é”®å­—ï¼Œå³ç«¯ç‚¹çš„ä½ç½®ä¸ºç¬¬äºŒå…³é”®å­—æ’åºã€‚è¿™å¥è¯å¾ˆé‡è¦ï¼Œå…¶å®å°±æ˜¯è«é˜Ÿçš„æ ¸å¿ƒå®ç°å§ã€‚\nç„¶åï¼Œæš´åŠ›è½¬ç§»ã€‚\nç„¶åå¯ä»¥æ³¨æ„åˆ°ï¼Œä¸è®ºæ˜¯åœ¨åŒä¸€ä¸ªå—å†…çš„ç§»åŠ¨ï¼Œè¿˜æ˜¯è·¨å—çš„ç§»åŠ¨ï¼Œå·¦ç«¯ç‚¹æœ€å¤šè½¬ç§»çš„æ¬¡æ•°æ˜¯åœ¨$Q$çš„çº§åˆ«çš„ï¼Œä¸€å…±$m$æ¬¡æŸ¥è¯¢ï¼Œé‚£ä¹ˆæ€»å…±è½¬ç§»$mQ$æ¬¡ã€‚è€Œå³ç«¯ç‚¹çš„ç§»åŠ¨ï¼Œåœ¨ä¸€ä¸ªå—å†…çš„æ—¶å€™ï¼Œç”±äºè‚¯å®šæ˜¯å•è°ƒé€’å¢ï¼Œæ‰€ä»¥æ¯æŸ¥è¯¢è¿‡ä¸€ä¸ªå—ï¼Œå·¦ç«¯ç‚¹è½¬ç§»$n$æ¬¡ï¼Œä¸€å…±æœ‰$\\frac{n}{Q}$ä¸ªå—ï¼Œæ‰€ä»¥å³ç«¯ç‚¹çš„ç§»åŠ¨æ€»å…±å°±æ˜¯$\\frac{n^2}{Q}$æ¬¡ã€‚\næ€»å…±åˆèµ·æ¥ï¼Œæ—¶é—´å¤æ‚åº¦å°±æ˜¯$O(T\\times(\\frac{n^2}{Q}+mQ))$ï¼ŒTä¸ºä¸€æ¬¡çŠ¶æ€è½¬ç§»çš„æ—¶é—´ã€‚åˆ©ç”¨ä¸€äº›åŸºç¡€å¤æ‚çš„æ•°å­¦çŸ¥è¯†ï¼Œå¯ä»¥å‘ç°å½“$Q = \\sqrt{n}$çš„æ—¶å€™ï¼Œè¿™ä¸ªå¼å­çš„å€¼æœ€å°ï¼Œæ˜¯$O(T\\times(m+n)\\sqrt{n})$ï¼Œè¿™ä¹Ÿå°±æ˜¯åŸºç¡€è«é˜Ÿç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ã€‚ä¸è¿‡åœ¨å…·ä½“å®ç°ä¸­ï¼Œç²¾ç¡®çš„$\\sqrt{n}$\u0008æœªå¿…å°±æ˜¯æœ€å¿«çš„ï¼Œæœ‰å¯èƒ½éœ€è¦ä¹˜ä¸ªå¸¸æ•°å•¥çš„ã€‚ä¸è¿‡å¤§è‡´æ˜¯å§ã€‚\nå…·ä½“å®ç° \u0008è«é˜Ÿçš„å®ç°è¶…çº§ç®€å•ã€‚\u0008ä¸è¿‡æˆ‘å› ä¸ºæˆ‘å¤ªè’»äº†ï¼Œå¼€å§‹è¿˜æ˜¯æ²¡æœ‰æƒ³æ˜ç™½ã€‚å…¶å®å°±æ˜¯å…ˆæ‰©å¤§ï¼Œåç¼©å°ï¼Œä¸€ä¸ªä¸€ä¸ªæš´åŠ›è½¬ç§»ã€‚\nä»£ç å¦‚ä¸‹ã€‚\n1 2 3 4 5 6 7 8 9 10 11  //ql,qr ä¸ºæŸ¥è¯¢åŒºé—´ï¼Œl,rä¸ºå½“å‰åŒºé—´ //add å’Œ del æ˜¯è‡ªå®šä¹‰çš„è½¬ç§»å‡½æ•° //æ³¨æ„è‡ªå¢è‡ªå‡çš„æ—¶é—´ while(ql\u0026lt;l) add(--l); while(r\u0026lt;qr) add(++r); while(l\u0026lt;ql) del(l++); while(qr\u0026lt;r) del(r--);   è¶…çº§ç®€å•å§ï¼\nå€¼çš„ä¸€æçš„æ˜¯ï¼Œåœ¨æˆ‘å»åŒ—äº¬å†¬ä»¤è¥çš„æ—¶å€™ï¼Œå°ä¸Šçš„ç¥çŠ‡è¯´ï¼š\n è«é˜Ÿçš„å¡å¸¸æœ‰ä¸ªå°æŠ€å·§ï¼šä½ å¥‡æ•°çš„å³ç«¯ç‚¹æ­£åºæ’ï¼Œå¶æ•°çš„å³ç«¯ç‚¹é€†åºæ’ï¼Œå°±å¯ä»¥å‹æ‰ä¸€åŠçš„å¸¸æ•°äº†ï¼\n å¬èµ·æ¥å¾ˆæœ‰é“ç†ï¼Œä½†æˆ‘æ²¡æœ‰è¯•è¿‡ã€‚\nä¾‹é¢˜ ã€ŒSDOI2009ã€HHçš„é¡¹é“¾-è«é˜Ÿoræ ‘çŠ¶æ•°ç»„\n[å›½å®¶é›†è®­é˜Ÿ]å°Zçš„è¢œå­ ï¼ˆé¢˜è§£å¾…è¡¥\nå¸¦ä¿®æ”¹è«é˜Ÿç®—æ³• å¾…ä¿®æ”¹çš„è«é˜Ÿå°±æ˜¯å¯ä»¥æ”¯æŒä¸€äº›ç®€å•çš„ä¿®æ”¹çš„è«é˜Ÿç®—æ³•ã€‚\næ ¸å¿ƒæ€æƒ³ åŸºæœ¬ä¸Šä¸å‰é¢çš„åŸºç¡€ç®—æ³•ç±»ä¼¼ã€‚å‡è®¾è¿™é‡Œçš„ä¿®æ”¹æœ‰$t$æ¬¡ã€‚è¿™é‡Œçš„æ’åºä¸€èˆ¬æ˜¯åˆ†å—ä¹‹åï¼ŒæŒ‰ç…§å·¦ç«¯ç‚¹æ‰€åœ¨çš„å—çš„åºå·ä¸ºç¬¬ä¸€å…³é”®å­—ï¼Œå³ç«¯ç‚¹æ‰€åœ¨çš„å—çš„åºå·ä¸ºç¬¬äºŒå…³é”®å­—ï¼Œæ›´æ”¹çš„æ¬¡æ•°ä¸ºç¬¬ä¸‰å…³é”®å­—æ’åºã€‚\nè¿™é‡Œæˆ‘ä»¬å–åˆ†å—çš„å¤§å°ä¸º$n^{\\frac{2}{3}}$ï¼Œé‚£ä¹ˆæœ‰$n^{\\frac{1}{3}}$ä¸ªå—ï¼Œå¯ä»¥ç®—å‡ºç®—æ³•çš„æ—¶é—´å¤æ‚åº¦æ˜¯$O(T \\times n^{\\frac{5}{3}})$ã€‚ï¼ˆç„¶è€Œå¹¶ä¸å¤ªæ‡‚æ€ä¹ˆæ¨å‡ºæ¥è¿™ä¸ªçš„\u0026hellip;å“ªä½å·¨ä½¬çŸ¥é“è¯·æ•™ä¸€ä¸‹ éå¸¸æ„Ÿè°¢\nå…·ä½“å®ç° ç±»ä¼¼ï¼Œä¸å†™äº†ã€‚\n1  //ä¸€æ®µæ—¶é—´å¤æ‚åº¦ä¸ºO(n^5/3)çš„ä»£ç ã€‚   éœ€è¦æ³¨æ„ï¼Œå¦‚æœå•ç‚¹ä¿®æ”¹æœ‰ä¸€ä¸ªå°æŠ€å·§ï¼Œå°±æ˜¯æ¯æ¬¡ä¸æ˜¯æ›´æ”¹æˆå¾…æ›´æ”¹æ•°ï¼Œè€Œæ˜¯swapå½“å‰æ•°å’Œå¾…æ›´æ”¹æ•°ï¼Œè¿™æ ·å°±å¯ä»¥ç®€å•çš„åšæ›´æ”¹äº†ã€‚\nä¾‹é¢˜ ã€Œå›½å®¶é›†è®­é˜Ÿã€æ•°é¢œè‰²-å¸¦ä¿®æ”¹è«é˜Ÿ\n","description":"","id":215,"section":"posts","tags":["è«é˜Ÿ","æ¨¡æ¿"],"title":"è«é˜Ÿç®—æ³•å­¦ä¹ ç¬”è®°ï¼ˆä¸€ï¼‰","uri":"https://blog.chenqiqian.com/posts/notes-mo-algorithm-1/"},{"content":"ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„æ­£æ•´æ•°åºåˆ— $A$ ,æœ‰ $m$ æ¬¡è¯¢é—®åœ¨ $[l,r]$ åŒºé—´å†…æœ‰å¤šå°‘ä¸ªä¸åŒçš„æ•°ã€‚\né“¾æ¥ Luogu P1972\né¢˜è§£ è¿™é“é¢˜ç›®å‰æˆ‘åªä¼šä¸¤ç§ç¦»çº¿çš„åšæ³•ã€‚\nåšæ³•ä¸€ï¼šè«é˜Ÿ å…¶å®åšè¿™é“é¢˜çš„æ—¶å€™æˆ‘æ˜¯ä¸ä¼šè«é˜Ÿäº†ã€‚ä½†ç°åœ¨ä¼šäº†ï¼Œåˆæƒ³å†™ç¯‡è«é˜Ÿçš„ç¬”è®°ï¼Œæ‰€ä»¥æˆ‘æŠŠè¿™ç¯‡é¢˜è§£å†™å‡ºæ¥äº†ã€‚\né¦–å…ˆå¯¹åºåˆ—åˆ†å—ï¼Œä»¥æŸ¥è¯¢çš„å·¦ç«¯ç‚¹æ‰€åœ¨å—çš„åºå·ä¸ºç¬¬ä¸€å…³é”®å­—ï¼Œå³ç«¯ç‚¹çš„ä½ç½®ä¸ºç¬¬äºŒå…³é”®å­—æ’åºï¼Œç„¶åæš´åŠ›è½¬ç§»ã€‚\næ—¶é—´å¤æ‚åº¦ï¼š $O((m+n) \\sqrt{n})$ æˆ–è€…ç®€å•ç‚¹ï¼š $O(n^\\frac{3}{2})$\nä»£ç è§æœ€åã€‚\nåšæ³•äºŒï¼šç¦»æ•£åŒ–+æ ‘çŠ¶æ•°ç»„ æ³¨æ„åˆ°ï¼Œæˆ‘ä»¬æœ€é‡è¦çš„éœ€è¦å¤„ç†çš„å°±æ˜¯é‡å¤çš„é—®é¢˜ã€‚å¦‚æœä¸éœ€è¦å¤„ç†é‡å¤çš„é—®é¢˜ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç›´æ¥ç”¨æ ‘çŠ¶æ•°ç»„æˆ–è€…å‰ç¼€å’Œå‡ºè§£äº†ã€‚æ‰€ä»¥æˆ‘ä»¬è€ƒè™‘åˆ°è¿™æ ·ä¸€ä¸ªäº‹æƒ…ï¼Œèƒ½å¦ä½¿ç”¨æŸäº›ç„å­¦é«˜ç«¯æ“ä½œï¼Œä½¿å¾—æˆ‘ä»¬ä¸éœ€è¦è€ƒè™‘é‡å¤çš„é—®é¢˜å‘¢ï¼Ÿ\nå¯ä»¥å‘ç°ï¼Œå¦‚æœä¸€ä¸ªæ•°å·²ç»å‡ºç°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä¸éœ€è¦è€ƒè™‘è¿™ä¸ªæ•°åœ¨å…¶ä»–ä½ç½®ä¸Šçš„å‡ºç°ã€‚å› æ­¤æˆ‘ä»¬æœ‰å¦‚ä¸‹çš„æ€è·¯ï¼š\næŠŠæŸ¥è¯¢æŒ‰ç…§æŸ¥è¯¢çš„å³ç«¯ç‚¹ä½ç½®ä»å°åˆ°å¤§æ’åºã€‚ä¸ºäº†å‘ç°æŸä¸ªæ•°æ˜¯å¦ä¼šåœ¨æˆ‘ä»¬çš„æŸ¥è¯¢çš„åºåˆ—ä¸­å‡ºç°ï¼Œæˆ‘ä»¬éœ€è¦è®°å½•è¿™ä¸ªæ•°æœ€åä¸€æ¬¡åœ¨åºåˆ—ä¸­å‡ºç°çš„ä½ç½®ã€‚å¦‚æœæŸ¥è¯¢åŒºé—´çš„å·¦ç«¯ç‚¹åœ¨è¿™ä¸ªæ•°çš„ä½ç½®ä»¥å·¦ï¼Œé‚£ä¹ˆæŸ¥è¯¢åŒºé—´å†…ä¸€å®šæœ‰è¿™ä¸ªæ•°ï¼›è€Œåœ¨è¿™ä¸ªæ•°ä»¥å³çš„è¯ï¼ŒæŸ¥è¯¢åŒºé—´é‡Œä¸€å®šæ²¡æœ‰è¿™ä¸ªæ•°ã€‚ç”±äºè¿™ä¸ªæ•°å‡ºç°å¤šå°‘æ¬¡æˆ‘ä»¬éƒ½åªèƒ½ç®—ä¸€æ¬¡ï¼Œæ‰€ä»¥è¿™ä¸ªæœ€åå‡ºç°çš„æ•°å°±æ˜¯æˆ‘ä»¬åˆ¤æ–­æ˜¯å¦å«æœ‰è¿™ä¸ªæ•°çš„ä¾æ®ã€‚\næ‰€ä»¥æˆ‘ä»¬åœ¨æ ‘çŠ¶æ•°ç»„ä¸­åªç»™æ¯ä¸ªæ•°æœ€åå‡ºç°çš„è¿™ä¸€ä½èµ‹å€¼ $1$ ,å…¶ä½™çš„ç”±äºä¸Šè¿°ï¼Œä¸èƒ½è®¡å…¥ä¸ªæ•°ï¼Œå€¼ä¹Ÿå°±æ˜¯ $0$ ã€‚è¿™æ ·æ“ä½œå°±æ»¡è¶³äº†åŒºé—´å¯å‡æ€§ï¼Œç„¶åç›´æ¥æ ‘çŠ¶æ•°ç»„å‰ç¼€å’Œç›¸å‡å°±å¯ä»¥å¾—åˆ°æ¯æ¬¡çš„ç»“æœã€‚\nç”±äºæ•°å­—çš„èŒƒå›´è¾ƒå¤§ï¼Œåº”è¯¥éœ€è¦ç¦»æ•£åŒ–ã€‚ä½†ç”±äºè¿™ä¸ªè·Ÿæ—¶é—´å¤æ‚åº¦å…³ç³»ä¸å¤§ï¼Œåªä¸ç©ºé—´å¤æ‚åº¦æœ‰å…³ï¼Œæ‰€ä»¥æˆ‘å°±æ²¡æœ‰è¿™ä¹ˆå†™ã€‚\næ—¶é—´å¤æ‚åº¦ï¼š$O((m+n) \\log{n})$ æˆ–è€…å¤§ä½“æ¥è¯´ $O(n \\log{n})$\nä»£ç è§ä¸‹ã€‚\nä»£ç  è¿™é‡Œæä¾›ä¸¤ç§æ–¹æ³•çš„ä»£ç ã€‚\nè«é˜Ÿä»£ç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cmath\u0026gt;#include \u0026lt;algorithm\u0026gt;using namespace std; struct Query{ int id,l,r; }query[201000]; int times[1001000],res[201000],num[51000]; int n,m,q; bool cmp(Query a,Query b){ if(a.l/q!=b.l/q) return a.l/q\u0026lt;b.l/q; else return a.r\u0026lt;b.r; } int main(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n); q = sqrt(n);//qæ˜¯åˆ†å—å¤§å°  for(int i = 1;i\u0026lt;=n;i++) scanf(\u0026#34;%d\u0026#34;,\u0026amp;num[i]); scanf(\u0026#34;%d\u0026#34;,\u0026amp;m); for(int i = 0;i\u0026lt;m;i++){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;query[i].l,\u0026amp;query[i].r); query[i].id = i; } sort(query,query+m,cmp);//æ’åº  int l = 1,r = 1; int ans = 1;times[num[1]]++; for(int i = 0;i\u0026lt;m;i++){ int ql = query[i].l,qr = query[i].r; //è½¬ç§»æ—¶å…ˆæ‰©å¤§å†ç¼©å°  while(ql\u0026lt;l){ l--; if(times[num[l]]++ == 0) ans++; } while(r\u0026lt;qr){ r++; if(times[num[r]]++ == 0) ans++; } while(l\u0026lt;ql){ if(--times[num[l]] == 0) ans--; l++; } while(qr\u0026lt;r){ if(--times[num[r]] == 0) ans--; r--; } res[query[i].id] = ans; } for(int i = 0;i\u0026lt;m;i++) printf(\u0026#34;%d\\n\u0026#34;,res[i]); return 0; }   ç¦»æ•£åŒ–+æ ‘çŠ¶æ•°ç»„ä»£ç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;algorithm\u0026gt;using namespace std; inline int lowbit(int x){ return x\u0026amp;(-x); } int n,m,num[51000],ans[201000],last[1001000]; int tree[201000]; struct que{ int id,l,r,res; }qq[1000000]; bool cmp(que a,que b){ if(a.r!=b.r) return a.r\u0026lt;b.r; return a.l\u0026lt;b.l; } inline void insert(int nown,int val){ for(int i = nown;i\u0026lt;=n;i+=lowbit(i)) tree[i]+=val; } inline int query(int nown){ int res = 0; for(int i = nown;i\u0026gt;0;i-=lowbit(i)) res += tree[i]; return res; } int main(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n); for(int i = 1;i\u0026lt;=n;i++) scanf(\u0026#34;%d\u0026#34;,\u0026amp;num[i]); scanf(\u0026#34;%d\u0026#34;,\u0026amp;m); for(int i = 0;i\u0026lt;m;i++){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;qq[i].l,\u0026amp;qq[i].r); qq[i].id = i; } sort(qq,qq+m,cmp); int end = 0; for(int i = 0;i\u0026lt;m;i++){ while(end\u0026lt;qq[i].r){//æ›´æ–°last\u0026amp;æ ‘çŠ¶æ•°ç»„  end++; if(last[num[end]]!=0)//åŸæ¥å‡ºç°è¿‡å°±æŠ¹å»lastä½ç½®çš„æ•°  insert(last[num[end]],-1); insert(end,1);//æ ‘çŠ¶æ•°ç»„åŠ å…¥æ–°æ ‡è®°  last[num[end]] = end;//æ›´æ–°lastå€¼  } ans[qq[i].id] = query(qq[i].r) - query(qq[i].l-1); } for(int i = 0;i\u0026lt;m;i++) printf(\u0026#34;%d\\n\u0026#34;,ans[i]); return 0; }   ","description":"","id":216,"section":"posts","tags":["è«é˜Ÿ","æ ‘çŠ¶æ•°ç»„"],"title":"ã€ŒSDOI2009ã€HHçš„é¡¹é“¾-è«é˜Ÿoræ ‘çŠ¶æ•°ç»„","uri":"https://blog.chenqiqian.com/posts/sdoi2009-necklace/"},{"content":"ç»´æŠ¤ä¸€ä¸ªåºåˆ—ï¼Œç¬¬ $i$ æ¬¡æ“ä½œæ—¶å¯»æ‰¾ç¬¬iå°çš„æ•°çš„æ‰€åœ¨ä½ç½® $P_i$,å¹¶å°† $(P_{i-1},P_{i}]$ çš„\u0008åŒºé—´ç¿»è½¬ã€‚\nå¦‚æœæœ‰ç›¸åŒçš„æ•°ï¼Œå¿…é¡»ä¿è¯æ’åºåå®ƒä»¬çš„ç›¸å¯¹ä½ç½®å…³ç³»ä¸åˆå§‹æ—¶ç›¸åŒã€‚\né“¾æ¥ Luogu P3165\né¢˜è§£ è¿™é“é¢˜çš„å¤§æ„æ˜¯åŒºé—´\u0008å¯»æ‰¾ï¼ŒåŒºé—´ç¿»è½¬ï¼Œæ‰€ä»¥æˆ‘ä»¬\u0008å¯ä»¥ç”¨\u0008Splayæ¥åšï¼Œç»´æŠ¤ä¸€ä¸ª $size$ å€¼å’ŒåŒºé—´ç¿»è½¬çš„ $rev$ æ ‡è®°ã€‚è™½ç„¶æˆ‘å‰å‡ å¤©è¿˜è¯´å†ä¹Ÿä¸ç”¨Splayäº†ï¼ˆé€ƒã€‚\næ³¨æ„åˆ°æ¯æ¬¡æ“ä½œéƒ½ä¼šä½¿ç¬¬ $i$ ä¸ªæ•°æ’åºå®Œæˆï¼Œæ‰€ä»¥æˆ‘ä»¬æ¯æ¬¡çš„ $P_{i}$ äº‹å®ä¸Šå°±æ˜¯æ•°ç»„ä¸‹æ ‡çš„ $i-1$ ã€‚\nå¯¹äºåŒºé—´çš„å¯»æ‰¾ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°å¯ä»¥åœ¨å¼€å§‹çš„æ—¶å€™å°±è®°å½•ä¸‹æ¥\u0008ç¬¬ $i$ å°çš„æ•°çš„ä½ç½®ï¼Œä¹Ÿå°±æ˜¯æŠŠä»–ä»¬çš„æŒ‡é’ˆå­˜åœ¨ä¸€ä¸ª\u0008æ•°ç»„\u0008é‡Œé¢ã€‚\nç„¶ååœ¨æŸ¥è¯¢çš„æ—¶å€™ï¼Œå…ˆæŠŠç¬¬ $i-1$ å¤§çš„èŠ‚ç‚¹ splay åˆ°æ ¹ï¼›æ‰¾åˆ°ç¬¬ $i$ å°çš„æ•°å¯¹åº”çš„èŠ‚ç‚¹æŒ‡é’ˆï¼Œå¯»æ‰¾å…¶åœ¨æ’åºäºŒå‰æ ‘ä¸­çš„åç»§èŠ‚ç‚¹ï¼ˆå›¾ä¸­çº¢è‰²èŠ‚ç‚¹ï¼‰ï¼Œç„¶åæŠŠ\u0008åç»§ splay åˆ°æ ¹çš„å³å­æ ‘ã€‚\nä½†æ³¨æ„åœ¨å®é™…æŸ¥æ‰¾ä¸­ï¼Œ\u0008å› ä¸ºå¯»æ‰¾åç»§ä¼šç ´åæ ¹ç»“ç‚¹ï¼Œæ‰€ä»¥è¦å…ˆæ‰¾åˆ°åç»§èŠ‚ç‚¹ï¼Œç„¶åå†å®Œæˆä¸Šè¿°æ“ä½œã€‚\nç„¶å\u0008å…³äºä½ç½®ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œæ ¹èŠ‚ç‚¹å·¦è¾¹ï¼ˆåŒ…æ‹¬æ ¹ç»“ç‚¹ï¼‰ï¼Œä¹Ÿå°±æ˜¯å›¾ä¸­çš„ç»¿è‰²éƒ¨åˆ†åº”å½“æœ‰ $i-1$ ä¸ªæ•°ï¼Œè€Œå…¶ä»–åœ¨ $i$ å·¦è¾¹ï¼ˆåŒ…æ‹¬ $i$ ï¼‰çš„æ•°åº”è¯¥å°±æ˜¯å›¾ä¸­çš„è“è‰²éƒ¨åˆ†ï¼Œæ‰€ä»¥åªè¦å°†è“è‰²éƒ¨åˆ†çš„ $size$ åŠ ä¸Šä¸€ä¸ª$i-1$å°±æ˜¯æ¯ä¸€æ¬¡æ“ä½œçš„ç»“æœã€‚\nç¿»è½¬å°±æ˜¯å¸¸è§„çš„åŒºé—´ç¿»è½¬ï¼Œæ‰“æ ‡è®° pushdown ä»€ä¹ˆçš„ã€‚\nä¸ºäº†æ–¹ä¾¿æ»¡è¶³ä¸€äº›\u0008\u0008å®ƒçš„è¦æ±‚ï¼Œ\u0008æˆ‘è¿˜äº‹å…ˆåšäº†\u0008ç¦»æ•£åŒ–çš„å¤„ç†ã€‚ï¼ˆå…¶å®å¹¶æ²¡æœ‰ä»€ä¹ˆ\u0008ç”¨\nå¦å¤–è¿˜æœ‰å°±æ˜¯æˆ‘å†™çš„æ—¶å€™è¿˜å› ä¸ºå°‘ push_down äº†å‡ æ¬¡è¢«\u0008å‘äº†\u0008ä¸€ä¸‹ã€‚ä¸è¿‡æœ€åä¸€æ¬¡è¿‡è¯„æµ‹è¿˜æ˜¯è›®å¼€å¿ƒçš„ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;algorithm\u0026gt;using namespace std; struct wupin{ int id,h; }w[100100]; struct splay_t{ struct node_t{ int val,size; bool rev; node_t *p,*son[2],**root,**null; inline bool get_p(){return p-\u0026gt;son[1] == this;} inline void init(node_t **root,node_t **null){this-\u0026gt;null = null,this-\u0026gt;root = root;} inline int lsize(){return son[0]-\u0026gt;size;} inline int rsize(){return son[1]-\u0026gt;size;} inline void update(){size = lsize()+rsize()+1;} inline void link(node_t *dst,int tmp){ dst-\u0026gt;son[tmp] = this; this-\u0026gt;p = dst; } inline void push_down(){ if(this == *null) return; if(rev){ swap(son[0],son[1]); son[0]-\u0026gt;rev^=1,son[1]-\u0026gt;rev^=1; rev = 0; } } inline void rotate(){ p-\u0026gt;push_down(),push_down(); node_t *rp = p;bool re = get_p(); link(rp-\u0026gt;p,rp-\u0026gt;get_p()); son[1-re]-\u0026gt;link(rp,re); rp-\u0026gt;link(this,1-re); rp-\u0026gt;update(),update(); if(p == *null) *root = this; } inline node_t* splay(node_t *tar = NULL){ if(tar == NULL) tar = *null; p-\u0026gt;push_down(),push_down(); while(p!=tar){ if(p-\u0026gt;p == tar) rotate(); else if(p-\u0026gt;get_p() == get_p()) p-\u0026gt;rotate(),rotate(); else rotate(),rotate(); } return this; } inline node_t *upper(){ splay(); node_t *r = son[1]; while(true){ r-\u0026gt;push_down(); if(r-\u0026gt;son[0] == *null) break; r = r-\u0026gt;son[0]; } return r; } }; int cnt; node_t pool[110000],*to[110000],*null,*root; splay_t(){ cnt = 0; null = newnode(); null-\u0026gt;size = 0; } node_t *newnode(int val = 0){ node_t *r = \u0026amp;pool[cnt++]; r-\u0026gt;init(\u0026amp;root,\u0026amp;null); r-\u0026gt;val = val,r-\u0026gt;size = 1,r-\u0026gt;rev = 0; r-\u0026gt;p = r-\u0026gt;son[0] = r-\u0026gt;son[1] = null; return r; } node_t* build(wupin *a,int l,int r){ if(l\u0026gt;r) return null; int mid = (l+r)\u0026gt;\u0026gt;1; node_t *ret = newnode(a[mid].h); to[a[mid].h] = ret; build(a,l,mid-1)-\u0026gt;link(ret,0); build(a,mid+1,r)-\u0026gt;link(ret,1); ret-\u0026gt;update(); return ret; } }; splay_t s; int n; bool cmp1(wupin a,wupin b){return a.id\u0026lt;b.id;} bool cmp2(wupin a,wupin b){ if(a.h!=b.h) return a.h\u0026lt;b.h; else return a.id\u0026lt;b.id; } void find(){ for(int i = 1;i\u0026lt;=n;i++){ //æ‰¾åˆ°åº”æ“ä½œèŠ‚ç‚¹çš„åç»§  splay_t::node_t *rbound = s.to[i]-\u0026gt;upper(); //æŠŠå‰é¢å½’ä½å¥½çš„æœ€åä¸€ä¸ªèŠ‚ç‚¹æ—‹åˆ°æ ¹èŠ‚ç‚¹  s.to[i-1]-\u0026gt;splay(); //æŠŠåç»§æ—‹è½¬åˆ°æ ¹èŠ‚ç‚¹çš„å³å„¿å­  rbound-\u0026gt;splay(s.to[i-1]); //æ‰“å°ä½ç½®  printf(\u0026#34;%d \u0026#34;,i + rbound-\u0026gt;lsize()-1); //æ·»åŠ lazyæ ‡è®°  rbound-\u0026gt;son[0]-\u0026gt;rev^=1; } } int main(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n); for(int i = 1;i\u0026lt;=n;i++){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;w[i].h); w[i].id = i; } //é¢„å¤„ç†  sort(w+1,w+n+1,cmp2); for(int i = 1;i\u0026lt;=n;i++) w[i].h = i; sort(w+1,w+n+1,cmp1); w[0].h = 0; w[n+1].h = n+1; //æ­£å¼æ“ä½œ  s.root = s.build(w,0,n+1); find(); return 0; }   ","description":"","id":217,"section":"posts","tags":["æ•°æ®ç»“æ„","å¹³è¡¡æ ‘","Splay"],"title":"ã€ŒCQOI2014ã€æ’åºæœºæ¢°è‡‚-Splay","uri":"https://blog.chenqiqian.com/posts/cqoi2014-sort/"},{"content":"ç»´æŠ¤ä¸€ä¸ªæ•°åˆ—ã€‚\nç°æœ‰å››ç§å‘½ä»¤ï¼Œæ–°åŠ å…¥ä¸€ä¸ªæ•° $k$ ï¼ŒæŠŠæ¯ä¸ªæ•°åŠ ä¸Š $k$ ï¼ŒæŠŠæ¯ä¸ªæ•°å‡å» $k$ ï¼ŒæŸ¥è¯¢ç¬¬ $k$ å¤§çš„æ•°ã€‚å¦‚æœæ•°åˆ—ä¸­çš„ä»»æ„æ•°å°äº $min$ ï¼Œå°†å®ƒç«‹å³åˆ é™¤ã€‚å¹¶åœ¨æœ€åè¾“å‡ºæ€»å…±åˆ å»çš„æ•°çš„ä¸ªæ•° $res$ ã€‚\nå¦‚æœæ–°åŠ å…¥çš„æ•° $k$ çš„åˆå€¼å°äº $min$ ï¼Œå®ƒå°†ä¸ä¼šè¢«åŠ å…¥æ•°åˆ—ã€‚\né“¾æ¥ Luogu P1486\né¢˜è§£ è¿™æ˜¯ä¸€é“ç»å…¸çš„å¹³è¡¡æ ‘çš„é¢˜ï¼Œè¢«æˆ‘ç”¨æ¥ç»ƒæ‰‹Splayã€‚\nå†™å®Œè¿™é“é¢˜ä¹‹åæˆ‘å°±è§‰å¾—ï¼Œæˆ‘å†ä¹Ÿä¸ä¼šæƒ³ç”¨Splayäº†ã€‚debugäº†ä¸€å¤©ï¼Œç®€ç›´æµ‘èº«éš¾å—ã€‚ä»¥åå°½é‡å†™æ—‹è½¬\u0026amp;éæ—‹Treapå§ã€‚\nçœŸé¦™ ï¼ï¼ï¼\næ„å»ºä¸€é¢—Splayæ ‘ã€‚éœ€è¦è®°å½•ç›®å‰å·²ç»å…¨ä½“åŠ è¿‡æˆ–è€…å‡è¿‡çš„æ•°ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªç›¸å¯¹å€¼ã€‚æ¢ç®—æ¥è¯´å°±æ˜¯ æ ‘å¤–-ç›¸å¯¹å€¼=æ ‘å†…ï¼Œæ ‘å†…+ç›¸å¯¹å€¼=æ ‘å¤– ã€‚åé¢ä¹Ÿå°±ä¸å†å¤ªå¤šç‰¹æ®Šè¯´æ˜ã€‚éœ€è¦æ·»åŠ ä¸¤ä¸ªè™šçš„æœ€å¤§å’Œæœ€å°èŠ‚ç‚¹ï¼Œä¹Ÿä¼šå¯¼è‡´æ’åè®¡ç®—çš„ä¸€äº›å˜åŒ–ã€‚\n æ’å…¥æ“ä½œ  å…ˆåˆ¤æ–­æ˜¯å¦æ»¡è¶³æ’å…¥æ¡ä»¶ï¼Œå³æ­¤æ•°æ˜¯å¦å¤§äº $min$ ï¼Œç„¶åå‡å»ç›¸å¯¹åæ­£å¸¸æ’å…¥ï¼Œsplay è‡³æ ¹èŠ‚ç‚¹ã€‚\n åŠ ä¸Šä¸€ä¸ªæ•°  ç›´æ¥æ›´æ”¹å…¨å±€ç›¸å¯¹å€¼ï¼Œç”±äºä¸ä¼šå‡ºç°åˆ æ•°ï¼Œä¸ä¼šæœ‰å…¶ä»–æ“ä½œã€‚\n å‡å»ä¸€ä¸ªæ•°  é¦–å…ˆæ›´æ”¹å…¨å±€ç›¸å¯¹å€¼ï¼Œå†æŠŠå°äº $min$ çš„æ•°åˆ é™¤ï¼Œç®€å•çš„æ¥è¯´å°±æ˜¯å§ç¬¬ä¸€ä¸ªå¤§äºç­‰äº $min$ çš„æ•° splay åˆ°æ ¹ä¸Šï¼Œç„¶ååˆ é™¤å·¦å­æ ‘ï¼Œè¡¥ä¸Šå·¦è¾¹çš„æœ€å°èŠ‚ç‚¹ã€‚\nå¦‚æœæ­£å¥½å­˜åœ¨å€¼ä¸º $min$ çš„èŠ‚ç‚¹ï¼Œå°±å°†å®ƒç›´æ¥ splay åˆ°æ ¹ï¼Œå®Œæˆä¸Šè¿°æ“ä½œï¼›å¦‚æœä¸å­˜åœ¨ï¼Œå°±æ’å…¥ä¸€ä¸ªå€¼ä¸º $min-1$ çš„èŠ‚ç‚¹ï¼Œå¯»æ‰¾å®ƒçš„åç»§ï¼Œå¹¶ splay åˆ°æ ¹ï¼Œå®Œæˆä¸Šè¿°æ“ä½œã€‚è¿™æ—¶ç»Ÿè®¡ $res$ éœ€è¦å‡å»æˆ‘ä»¬åˆšåˆšåŠ ä¸Šçš„èŠ‚ç‚¹ã€‚\n æŸ¥è¯¢ç¬¬ k å¤§  ç›´æ¥æŸ¥ï¼Œç„¶å splay åˆ°æ ¹ã€‚åªéœ€è¦æ³¨æ„æˆ‘ä»¬çš„æ•°åˆ—æ˜¯ä»å°åˆ°å¤§æ’åˆ—çš„ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172  #include \u0026lt;cstdio\u0026gt;#define MAX 0x3f3f3f3f using namespace std; inline int qr(){ int f = 1,s = 0;char ch = getchar(); while(ch\u0026lt;\u0026#39;0\u0026#39;||ch\u0026gt;\u0026#39;9\u0026#39;){ if(ch == \u0026#39;-\u0026#39;) f = -1; ch = getchar(); } while(ch\u0026gt;=\u0026#39;0\u0026#39;\u0026amp;\u0026amp;ch\u0026lt;=\u0026#39;9\u0026#39;){ s = (s\u0026lt;\u0026lt;3)+(s\u0026lt;\u0026lt;1)+ch-48; ch = getchar(); } return f*s; } struct splay_t{ struct node_t{ int val,size,cnt; node_t *son[2],*p;node_t **null,**root; //ä¸çˆ¶äº²å…³ç³»  inline bool get_p(){return p-\u0026gt;son[1] == this;} //åŒå‘è¿æ¥  inline void link(node_t *dst,bool re){p = dst;dst-\u0026gt;son[re] = this;} //æ›´æ–°sizeå€¼  inline void update(){size = son[0]-\u0026gt;size + son[1]-\u0026gt;size + cnt;} //åˆå§‹åŒ–**rootå’Œ**null  inline void init(node_t **null,node_t **root){this-\u0026gt;null = null,this-\u0026gt;root = root;} //è·å–å·¦å³èŠ‚ç‚¹çš„å¤§å°  inline int lsize(){return son[0]-\u0026gt;size;}int rsize(){return son[1]-\u0026gt;size;} //å¯»æ‰¾èŠ‚ç‚¹å‰é©±æˆ–è€…åç»§  node_t *uporlow(int tmp){//0å‰é©±ï¼Œ1åç»§  splay(); node_t *t = son[tmp]; while(t-\u0026gt;son[1-tmp] != *null) t = t-\u0026gt;son[1-tmp]; return t; } //æ—‹è½¬  void rotate(){ bool re = get_p();node_t *rp = p; link(rp-\u0026gt;p,rp-\u0026gt;get_p()); son[1-re]-\u0026gt;link(rp,re); rp-\u0026gt;link(this,1-re); rp-\u0026gt;update();update(); if(p == *null) *root = this; } //splayæ“ä½œ  node_t* splay(node_t *tar = NULL){ if(this == *null) return this; if(tar == NULL) tar = *null; while(p!=tar){ if(p-\u0026gt;p == tar) rotate(); else{ if(p-\u0026gt;get_p()==get_p()) p-\u0026gt;rotate(),rotate(); else rotate(),rotate(); } } return this; } }; int treecnt; node_t pool[300000]; node_t *null,*root,*lb,*rb;//lbæ˜¯å·¦è¾¹çš„è™šæ‹ŸèŠ‚ç‚¹ï¼ŒrbåŒç†  //åˆå§‹åŒ–  splay_t(){ treecnt = 0; newnode(null);root = null; null-\u0026gt;size = 0,null-\u0026gt;val = 0; lb = insert(-MAX);rb = insert(MAX); } //æ–°å»ºèŠ‚ç‚¹  void newnode(node_t *\u0026amp;r,int val = 0){ r = \u0026amp;pool[treecnt++]; r-\u0026gt;val = val; r-\u0026gt;son[0] = r-\u0026gt;son[1] = r-\u0026gt;p = null; r-\u0026gt;cnt = r-\u0026gt;size = 1; r-\u0026gt;init(\u0026amp;null,\u0026amp;root); } //å¯»æ‰¾ç»™å®šrankçš„æ•°å­—  node_t* find_Kth(int rank){ node_t *t = root; while(t!=null){ if(rank\u0026lt;t-\u0026gt;lsize()) t = t-\u0026gt;son[0]; else if((rank-=t-\u0026gt;lsize())\u0026lt;t-\u0026gt;cnt) return t-\u0026gt;splay(); else rank-=t-\u0026gt;cnt,t = t-\u0026gt;son[1]; } return null; } //æŒ‰å€¼å¯»æ‰¾  node_t *find_by_val(int val){ node_t *t = root; while(t!=null){ if(val\u0026lt;t-\u0026gt;val) t = t-\u0026gt;son[0]; else if(val==t-\u0026gt;val) return t-\u0026gt;splay(); else t = t-\u0026gt;son[1]; } return null; } //æ’å…¥ç»™å®šå€¼çš„èŠ‚ç‚¹  node_t* insert(int val){ node_t **tar = \u0026amp;root,*parent = null; while(*tar!=null){ (*tar)-\u0026gt;size++; if((*tar)-\u0026gt;val == val){ (*tar)-\u0026gt;cnt++;return *tar; } else{ parent = *tar;tar = \u0026amp;(*tar)-\u0026gt;son[(*tar)-\u0026gt;val\u0026lt;val]; } } newnode(*tar,val); (*tar)-\u0026gt;link(parent,parent-\u0026gt;val \u0026lt; val); return (*tar)-\u0026gt;splay(); } //è°ƒè¯•ç”¨ æ‰“å°æ ‘  void print(node_t *r = NULL,int depth = 0){ if(r == NULL) r = root; if(r == null) return; else{ print(r-\u0026gt;son[0],depth+1); for(int i = 0;i\u0026lt;depth;i++) putchar(\u0026#39; \u0026#39;); printf(\u0026#34;v:%d,size:%d,cnt:%d,son:%d %d,depth:%03d\\n\u0026#34;,r-\u0026gt;val,r-\u0026gt;size,r-\u0026gt;cnt,r-\u0026gt;son[0]!=null,r-\u0026gt;son[1]!=null,depth); print(r-\u0026gt;son[1],depth+1); } } }; splay_t x;int n,minn,res = 0,nowadd = 0; //æ’å…¥ä¸€ä¸ªæ•° inline void insert(int val){if(val\u0026gt;=minn) x.insert(val-nowadd);}//æ³¨æ„è¦å‡å»nowadd //ç»Ÿä¸€åŠ å·¥èµ„ inline void add(int val){nowadd+=val;} //ç»Ÿä¸€å‡å…¬å¸é¡ºä¾¿è£äºº inline void decrease(int val){ nowadd-=val; splay_t::node_t *r = x.find_by_val(minn-nowadd);//æ³¨æ„è¦å‡å»nowadd  if(r!=x.null) r-\u0026gt;splay(),res+=(x.root-\u0026gt;lsize()-1); else x.insert(minn-nowadd-1)-\u0026gt;uporlow(1)-\u0026gt;splay(),res+=(x.root-\u0026gt;lsize()-2); x.lb-\u0026gt;link(x.root,0);x.lb-\u0026gt;son[1] = x.null; x.root-\u0026gt;update(); } //æŸ¥æ‰¾å·¥èµ„æ’åKä½çš„å‘˜å·¥çš„å·¥èµ„ inline int ask(int rank){ if(rank \u0026gt; x.root-\u0026gt;size - 2) return -1; return x.find_Kth(x.root-\u0026gt;size-rank-1)-\u0026gt;val + nowadd;//æ³¨æ„è¦åŠ ä¸Šnowadd } int main(){ n = qr();minn = qr(); for(int i = 0;i\u0026lt;n;i++){ char op[20];int k; scanf(\u0026#34;%s\u0026#34;,op);k = qr(); if(op[0] == \u0026#39;A\u0026#39;) add(k); else if(op[0] == \u0026#39;S\u0026#39;) decrease(k); else if(op[0] == \u0026#39;I\u0026#39;) insert(k); else if(op[0] == \u0026#39;F\u0026#39;) printf(\u0026#34;%d\\n\u0026#34;,ask(k)); else if(op[0] == \u0026#39;P\u0026#39;) x.print(); } printf(\u0026#34;%d\\n\u0026#34;,res); return 0; }   ","description":"","id":218,"section":"posts","tags":["æ•°æ®ç»“æ„","å¹³è¡¡æ ‘","Splay"],"title":"ã€ŒNOI2004ã€éƒé—·çš„å‡ºçº³å‘˜-Splay","uri":"https://blog.chenqiqian.com/posts/noi2004-cashier/"},{"content":"OIè€ƒè¯•å‰æœ€å¥½æ¥çœ‹ä¸€çœ‹\u0026hellip;\nä¼šä¸æ–­çš„è¡¥å……ã€‚\nè€ƒå‰  å¸¦å¥½éœ€è¦çš„ä¸œè¥¿  ç¬” çº¸ æ°´ åƒçš„ é€‚é‡çš„è¡£æœ   å¤ä¹ ä»¥ä¸‹è†œç‰ˆ  çº¿æ®µæ ‘ å¹³è¡¡æ ‘ dp  \u0026hellip;   æ•°å­¦ ç½‘ç»œæµ\u0026amp;è´¹ç”¨æµ ç¼©ç‚¹ å­—ç¬¦ä¸²ç›¸å…³ \u0026hellip;\u0026hellip;ï¼ˆæ¥æ—¥è¡¥å……   æ—©ç‚¹ç¡ åƒç‚¹å¥½çš„  è€ƒä¸­  æ€è·¯æ”¾å¼€ ä¸è¦é„™è§†æš´åŠ› ä¸è¦ç»™è‡ªå·±å¤ªå¤§å‹åŠ› å¤šå–æ°´ å¤šä¸Šå•æ‰€ï¼ˆå­¦ä¹ då§“å¤§ç¥ é‡åˆ°ä¸ä¼šåšçš„é¢˜ç›®æ—¶çš„checklistï¼š  çœ‹ä¸‹æ•°æ®èŒƒå›´å’Œé¢˜ç›®è¦æ±‚ å°è¯•å¯¹ç®—æ³•å…¥åº§ å…ˆæ•²ä¸ª30åˆ†å·¦å³çš„æš´åŠ› ä»”ç»†å›é¡¾ä¸€éå­¦è¿‡çš„æ‰€æœ‰æ•°æ®ç»“æ„å¦‚ä¸Šé¢æ‰€åˆ— æ²¡å‡†å¯ä»¥æ‰“ä¸ªè¡¨ï¼Ÿï¼Ÿ è¯„ä¼°ä¸€ä¸‹æ€è€ƒçš„ä»£ä»·å’Œä¸åšçš„ä»£ä»· åé¢çš„é¢˜å¦‚æœæœ‰æ€è·¯å¯ä»¥å…ˆåš ä¸è¦æ…Œ å†åšä¸å‡ºæ¥å»ç©å±€åˆçº§æ‰«é›·å¹³é™ä¸€ä¸‹   å†™æš´åŠ›å¯¹æ‹  update: å¯¹æ‹\u0026hellip;è¦å†™ç¨‹åºæ‹\u0026hellip;   æœ€åæ£€æŸ¥ä¸¤éæ–‡ä»¶è¾“å…¥è¾“å‡º  update: è¿˜æ˜¯ä¸‰éå§   é™¤éä¸€ç‚¹éƒ½ä¸ä¼š ä¸èƒ½ä¸å†™  è€ƒå  åƒé¡¿å¥½çš„ã€‚ æ‹‰ä¸ªäººå‡ºå»ç©ã€‚ å†åƒé¡¿å¥½çš„ã€‚ å¿˜æ‰æ¯”èµ›ã€‚ ","description":"","id":219,"section":"posts","tags":null,"title":"è€ƒè¯•å‰è¦çœ‹çš„ä¸œè¥¿","uri":"https://blog.chenqiqian.com/posts/notes-test/"},{"content":"ä»Šå¹´å†¬å¤©ï¼Œå»äº†è¶ŸåŒ—äº¬å†¬ä»¤è¥æ—…æ¸¸ã€‚\nå…¶å®æœ¬å°±æ²¡æœ‰æŠ±ç€ä»€ä¹ˆä¿¡å¿ƒã€‚NOIPåªè€ƒäº†äºŒç­‰å¥–ï¼Œå¥½å¤šæé«˜ç»„çš„åŸºç¡€çŸ¥è¯†éƒ½æ²¡æœ‰å­¦å®Œã€‚ä½†è¿˜æ˜¯ä¹‰æ— åé¡¾çš„å»äº†ã€‚ä¹Ÿè®¸æ—©å°±çŸ¥é“ä¼šæ˜¯è¿™ä¸ªæ ·å­ã€‚\nDay1 å†¬ä»¤è¥åœ¨åŒ—å¸ˆå¤§é™„ä¸­ã€‚è™½ç„¶æ˜¯å»è¿‡çš„åœ°æ–¹ï¼Œç„¶è€Œè¿˜æ˜¯ååˆ†è¿·èŒ«çš„æ‰¾å•Šæ‰¾ã€‚ç¬¬ä¸€å¤©ä¸»è¦æ˜¯é¢å¥–ä»ªå¼ç­‰ç­‰ã€‚ç¬¬ä¸€æ¬¡ä½“ä¼šåˆ°å¦‚åé’ˆæ¯¡çš„æ„Ÿè§‰ã€‚æ·±åˆ»çš„è§‰å¾—ï¼Œæ—è¾¹çš„äººå“ªä¸ªéƒ½å¥½åƒé‚£ä¹ˆå·¨ï¼Œè€Œè‡ªå·±ï¼Œå´æ˜¯é‚£ä¹ˆè’Ÿè’»ã€‚ç”Ÿæ€•åšé”™å“ªæ€•ä¸€ç‚¹äº‹æƒ…ï¼Œè€ŒåŒç­çš„OIerå´è¿˜æ²¡æœ‰æ¥å†¬ä»¤è¥ã€‚ä¸‡å¹¸ï¼Œæ‰¾åˆ°äº†å‡ ä¸ªçœ‹ç€è¿˜æ¯”è¾ƒçœ¼ç†Ÿçš„ï¼Œæœç„¶æ˜¯åŒå­¦ã€‚\nä¸‹åˆæ˜¯èƒ¡ä¼Ÿæ ‹è€å¸ˆçš„è¯¾ï¼Œè®²çš„æ˜¯æ·±æœã€‚\nâ€œè¿™ä¹Ÿè®¸æ˜¯æŸäº›äººå†¬ä»¤è¥å”¯ä¸€èƒ½å¬æ‡‚çš„ä¸€èŠ‚è¯¾ã€‚â€æˆ–è®¸å°±æ˜¯æˆ‘å§ã€‚è®²çš„çš„ç¡®ä¸éš¾ï¼Œè€Œä¸”è¿˜æ˜¯è›®æœ‰è¶£çš„ã€‚æœç„¶å¾ˆå‰å®³å‘¢ã€‚\nDay2 ç¬¬ä¸€æ¬¡è€ƒè¯•ã€‚\nçœ‹åˆ°é¢˜ç¬é—´æ‡µé€¼ã€‚ä¸€é“é¢˜éƒ½ä¸ä¼šåšå‘¢ã€‚åªå¥½éšä¾¿å†™äº†å‡ ä¸ªæš´åŠ›éª—åˆ†ï¼Œå‘äº†æ¡pyqä¹‹åå°±å¼€å§‹ç©è·³ä¸€è·³ã€‚ååœ¨æˆ‘æ—è¾¹çš„è²Œä¼¼æ˜¯å°å­¦å…­å¹´çº§ã€‚ä¸å¾—ä¸æ„Ÿå¹ï¼Œå¹´è½»çœŸå¥½ã€‚å¦‚æœèƒ½æ¥äº”å¹´å†¬ä»¤è¥è¿˜è¿›ä¸äº†çœé˜Ÿï¼Œè¯´ä»€ä¹ˆæˆ‘éƒ½ä¸ç›¸ä¿¡ã€‚ç¥ä»–æœ‰å…‰æ˜çš„å‰é€”å§ã€‚\nä¸‹åˆå¼€å§‹è®²é¢˜ã€‚\né¦–å…ˆçœ‹äº†çœ‹ç¨‹åºï¼Œ40ï¼400ã€‚è¢«stdåå€æ€ã€‚ä¸è¿‡ä¹Ÿå¾ˆæ­£å¸¸ã€‚\nè¿™å¤©ä¸‹åˆçš„è®²è¯¾ä¼¼ä¹è¿˜æ¯”è¾ƒå‹å–„ï¼Œå¥½åƒä¸»è¦è®²äº†è´ªå¿ƒå’Œå½’çº³çš„æ€æƒ³ã€‚æˆ‘ä¸ªäººè®¤ä¸ºè®²çš„è¿˜æ˜¯ä¸é”™çš„ï¼Œæˆ‘ä¹Ÿå¿ä½äº†ï¼Œæ²¡æœ‰ç¡ç€ã€‚è®²çš„ä¾‹é¢˜æˆ‘ç«Ÿç„¶ä¹Ÿèƒ½å¬æ‡‚ã€‚ä¸å®¹æ˜“ã€‚\nDay3 ç¬¬äºŒå¤©è€ƒè¯•ã€‚\nè¿˜æ˜¯ä¸€é“é¢˜éƒ½ä¸ä¼šã€‚ä¾æ—§æ˜¯ï¼Œæš´åŠ›éª—åˆ†ç„¶åå°±ç©è·³ä¸€è·³ã€‚æˆ‘ç°åœ¨ä¹Ÿä¾ç„¶è®¤ä¸ºï¼Œå¦‚æœå†¬ä»¤è¥å†å¤šå‡ å¤©ï¼Œæ²¡å‡†æˆ‘çš„è·³ä¸€è·³æ°´å¹³è¿˜èƒ½æœ‰é•¿è¶³çš„è¿›æ­¥ã€‚\nè€ƒå®Œè¯•æ‰çŸ¥é“ï¼Œç¬¬ä¸€é“é¢˜åŸæ¥åªæ˜¯æœ‰æŠ€å·§çš„æ‰“è¡¨ã€‚æœç„¶è¿˜æ˜¯too naiveå‘¢ã€‚ä¸è¿‡åŒæ¥çš„ä¸¤ä½åŒå­¦ä¹Ÿæ²¡èƒ½åšå‡ºåé¢çš„é¢˜ï¼Œè¿˜æ˜¯æœ‰äº†ä¸€ç‚¹å¿ƒç†å®‰æ…°çš„å‘¢ã€‚ä¸è¿‡æœ€ååªè€ƒäº†20åˆ†ã€‚æ‰å¿ƒã€‚\nä¸‹åˆè®²çš„æ˜¯å›½å®¶é›†è®­é˜Ÿè‡ªé€‰é¢˜ã€‚å…¶å®æˆ‘éƒ½ä¸è®°å¾—è®²çš„æ˜¯ä»€ä¹ˆäº†ã€‚åªè®°å¾—ä¹Ÿæ˜¯å¥½éš¾ã€‚æ— å¥ˆåªå¥½æ‰“èµ·äº†ä¸–å¾ã€‚å±…ç„¶æ‰“è¿‡äº†ä¸€ä¸ªå¾æœã€‚å™«\u0026hellip;\u0026hellip;\nå›å®¶å±…ç„¶æ°´è¿‡äº†Treapï¼Œå€¼å¾—åº†è´ºã€‚\nDay4 ç¬¬ä¸‰å¤©è€ƒè¯•ã€‚ä»Šå¤©ç«Ÿç„¶ææƒšçš„ä»¥ä¸ºè‡ªå·±åšå‡ºæ¥äº†ä¸€é“è´ªå¿ƒã€‚ç„¶è€Œæˆ‘è¿˜æ˜¯å¤ªå¤©çœŸã€‚stdç«Ÿæ˜¯ä»€ä¹ˆæˆ‘éƒ½æ²¡æœ‰å¬è¯´è¿‡çš„è´¹ç”¨æµã€‚ä¸è¿‡å‹‰å¼ºéª—åˆ°äº†30åˆ†è¿˜æ˜¯50åˆ†ã€‚åé¢å‡ é“é¢˜æ¥ç€æ— ç©·éª—åˆ†ï¼Œè·³ä¸€è·³ã€‚æœ€åå±…ç„¶éª—ä¸Šäº†100åˆ†ã€‚ä¸é”™ä¸é”™ã€‚\nä¸‹åˆå¥½åƒè®²çš„æ˜¯å›½å®¶é›†è®­é˜Ÿçš„è‡ªé€‰é¢˜ã€‚å®åœ¨å®åœ¨å¥½éš¾ã€‚å¬ç€å¬ç€å®åœ¨å¬ä¸æ‡‚ï¼Œäºæ˜¯å¼€å§‹å­¦ä¸Šåˆè€ƒåˆ°çš„KMPã€‚ç„¶è€Œå†™äº†å¥½ä¹…è¿˜æ²¡æœ‰å†™å¯¹ã€‚æœ€ååˆ°å®¶å†å†™è¿˜æ˜¯æ²¡æœ‰å†™å¯¹ã€‚æœ€åå‘ç°æŠŠä¸€ä¸ªintæ•°ç»„ä¸å°å¿ƒå¼€æˆäº†charã€‚æˆ‘å¤§æ¦‚æ˜¯ä¸ªå‚»å­å§ã€‚\nå›å®¶ä¸çŸ¥é“ä¸ºä»€ä¹ˆè„‘å­æŠ½é£äº†ï¼Œç¨€é‡Œç³Šæ¶‚çš„æ€»å…±åäº†å››è¶Ÿå…¬äº¤æ‰åˆ°å®¶ã€‚åäº†å¥½ä¹…éƒ½æ²¡åè¿‡çš„æ— è½¨ç”µè½¦ã€‚ç»ˆäºä½“ä¼šåˆ°åœ¨å†·é£ä¸­ç‘Ÿç‘Ÿå‘æŠ–çš„ç­‰å…¬äº¤è½¦çš„æ„Ÿè§‰ã€‚è¯¶ã€‚å›åˆ°å®¶éƒ½ä¸€ä¸ªåŠå°æ—¶äº†ã€‚\nDay5 æœ€åä¸€å¤©è€ƒè¯•ã€‚\nä¸€çœ‹åˆ°é¢˜ï¼Œå°±è§‰å¾—å¯ä»¥æš´åŠ›æ‰“è¡¨ã€‚ç„¶å¹¶åµã€‚è°ƒä¸€ä¸ªæš´åŠ›ç¨‹åºè°ƒäº†ä¸€ä¸ªå°æ—¶æ‰ç»ˆäºè°ƒå¯¹ã€‚ç„¶åæ‰“è¡¨ä¸¤åˆ†é’Ÿã€‚å•§å•§å•§ã€‚åé¢ç¬¬äºŒé“é¢˜æœ€ååŠä¸ªå°æ—¶æ‰å¼€å§‹å†™ï¼Œå†™äº†ä¸ªæš´åŠ›æ‰“è¡¨ã€‚ç„¶è€Œæœ€ååªæ‰“åˆ°30åˆ†éƒ½ä¸åˆ°ã€‚æ®è¯´è¿˜æœ‰äººæŸ¥OEISçš„ï¼Ÿï¼Ÿï¼Ÿæˆ‘æ€ä¹ˆæ²¡æƒ³åˆ°ï¼Ÿï¼Ÿï¼Ÿéå¸¸æœ‰è¶£ã€‚å­¦ä¹ äº†ä¸€ä¸ªæ–°æŠ€èƒ½ã€‚æœ€åä¸€é“é¢˜å¥½åƒé¢‡ä¸ºåæ§½ã€‚åæ­£æˆ‘ä¹Ÿä¸ä¼šåšã€‚\nä¸‹åˆè®²é«˜ç²¾åº¦ï¼Œæˆ‘ä¹Ÿæ²¡å¬ï¼Œä¹Ÿåªæ˜¯è®°å¾—å·¨ä½¬1300å¤šè¡Œçš„é«˜ç²¾åº¦è†œç‰ˆã€‚ç»ˆäºæŠŠç¬¬ä¸‰é“çº¿æ®µæ ‘çš„é¢˜ç»™å‡ºå®Œäº†ã€‚ä¸‹åˆå›å®¶å»åäº†ç‰¹4ï¼Œä¸€è·¯åç€å›å®¶å¾ˆexcitedã€‚å•§å•§å•§ã€‚\nå•§å•§ æ€»ç»“ä¸€ä¸‹å§ã€‚å»äº†è¶Ÿå†¬ä»¤è¥ï¼Œè€ƒäº†å››å¤©è¯•ï¼Œå¾—åˆ†250/1400ã€‚å•§å•§ã€‚æŸdå§“äººå¤§æ¦‚è€ƒäº†1000åˆ†å§ã€‚å·®è·å›ºç„¶å­˜åœ¨ï¼Œä¹Ÿå°±å‘Šè¯‰äº†æˆ‘å‰è¿›è¯¥å‘ä½•æ–¹ï¼Œåˆ°äº†ä»€ä¹ˆç¨‹åº¦æ‰èƒ½ç®—å¼ºè€…å§ã€‚\nå’ŒæŸäººæ™šä¸Šè°ˆè®ºäº†ä¸€ä¸‹ã€‚æŸäººè¿™ä¸€æ®µæ—¶é—´å¥½åƒç»å¸¸å¬æˆ‘çš„æ„Ÿæ…¨å§ï¼Œè°¢è°¢ä½ ã€‚è¿˜åæ§½äº†æˆ‘çš„â€œå¼ºå¼±â€æ ‡å‡†ã€‚ä½†çš„ç¡®æ˜¯ï¼Œæ¯è¿›å…¥ä¸€ä¸ªé˜¶æ®µï¼Œæ€»ä¼šè§‰å¾—è‡ªå·±å¾ˆå¼±ï¼Œè€Œå¼ºè€…é¥ä¸å¯åŠã€‚ä½†å°¤å…¶åœ¨æˆ‘è®¤çœŸå¯¹å¾…çš„OIé‡Œï¼Œç›®æ ‡çš„æ— æœ›å´çœŸçš„æœ‰äº›è®©äººç»æœ›ã€‚OIåœ¨é«˜è€ƒé‡Œä¸ä¼šè€ƒåˆ°ï¼Œé€‰æ‹©äº†è¿™é¡¹ï¼Œé‚£æ˜¯çœŸçš„çœŸçš„å–œæ¬¢ã€‚ä½†ä¼¼ä¹çœŸçš„æœ‰ç‚¹æ™šäº†ã€‚\nçœä¸€çœ‹èµ·æ¥ä¸åƒæ˜¯éš¾äº‹ï¼Œå¯çœé˜Ÿï¼Œå®åœ¨æ˜¯é¥ä¸å¯åŠã€‚\nå¦‚æœä¸è¿›é˜Ÿï¼Œé‚£ä¹ˆç«èµ›å¥½åƒç”¨å¤„ä¹Ÿä¸æ˜¯å¾ˆå¤§ã€‚å¯æˆ‘æ¯•ç«Ÿé€‰æ‹©å®ƒï¼Œé™¤äº†ç«èµ›ï¼Œæ›´å¤šçš„ä¹Ÿæ˜¯å–œæ¬¢å§ã€‚\næˆ‘æ°¸è¿œéƒ½ä¸ä¼šè®¤è¾“çš„ã€‚\næ˜å¹´ï¼Œå†æ¥ã€‚\n","description":"","id":220,"section":"posts","tags":["å†¬ä»¤è¥"],"title":"å†¬ä»¤è¥æ—…æ¸¸è®°","uri":"https://blog.chenqiqian.com/posts/trip-bjwc2018/"},{"content":"æˆ–è®¸ï¼Œæˆ‘ä¸€ç›´è®¤ä¸ºæˆ‘æ—©å°±é•¿å¤§äº†å§ã€‚\né‚£åº”è¯¥æ˜¯åœ¨äº”å¹´çº§çš„æ—¶å€™ã€‚æˆ‘åˆä¸€æ¬¡å»æ‰¾è€å¸ˆï¼Œåˆä¸€æ¬¡æ²¡æœ‰è¯´æˆæˆ‘å¿ƒä¸­æœ€ä¸ºå®Œç¾çš„æƒ³æ³•ï¼Œåˆä¸€æ¬¡çš„é™·å…¥æ²‰æ€ã€‚é‚£ä¸ªæ—¶å€™ï¼Œæˆ‘çœŸæ­£çš„æ„è¯†åˆ°ï¼Œæˆ–è®¸å¹¶ä¸æ˜¯æ‰€æœ‰äº‹æƒ…ï¼Œéƒ½èƒ½æŒ‰ç…§æˆ‘å¿ƒä¸­æœ€å¥½çš„æ–¹å¼å»è¿›è¡Œå§ã€‚æˆ–è®¸ä»é‚£ä»¥åï¼Œæˆ‘ä»¥ä¸ºæˆ‘å°±å†ä¹Ÿä¸ä¼šä¸ºäº†æˆ‘å¿ƒä¸­çš„æ¢¦æƒ³çš„ä¸–ç•Œâ€”â€”æˆ–è€…è¯´æ›´ç¾å¥½çš„äº‹æƒ…ï¼Œå»ä¸äººäº‰è¾©äº†å§ã€‚è€Œåˆä¸­ï¼Œä¹Ÿç¡®å®æ˜¯ï¼Œå’Œäººäº‰è¾©å¤§å¤šä¹Ÿéƒ½æ˜¯åšé”™äº†é¢˜æˆ–è€…åšå¯¹äº†é¢˜å»è·ŸåŒå­¦å’Œè€å¸ˆçš„äº‰è¾©äº†å§ã€‚\nä¸€åº¦ï¼Œæˆ‘ç«ŸçœŸçš„ä»¥ä¸ºæˆ‘é•¿å¤§äº†ã€‚\né‚£äº›è®°å¿†å·²ç»å¾ˆæ¨¡ç³Šäº†ï¼Œè€Œè¿‘å‡ å¤©å‘ç”Ÿçš„äº‹æƒ…å´è¿˜å†å†åœ¨ç›®ã€‚\nçœ‹åˆ°æŸä½åŒå­¦çš„éšç¬”ï¼ŒæŸä½åŒå­¦çš„æ‰¹è¯­ï¼Œåˆæƒ³åˆ°äº†å¥½å¤šã€‚\næœ€è¿‘å†™äº†ä¸å°‘éšç¬”ï¼Œä¹Ÿé˜…äº†ä¸å°‘éšç¬”ã€‚è€Œæˆ‘å†™çš„éšç¬”æœ‰ä¸å°‘å´åƒæ˜¯â€œæŠ±æ€¨â€ï¼Œâ€œæŠ±æ€¨â€ç­æ­Œæ¯”èµ›çš„åŠ³æ°‘ä¼¤è´¢ï¼ŒæŠ±æ€¨ä½“è‚²è¿åŠ¨çš„ä¸åˆ‡å®é™…ï¼ŒæŠ±æ€¨ã€Šè®ºè¯­ã€‹çš„æ— ç†è€ƒæ³•ã€‚\næœ€è¿‘å’Œå‡ ä½åŒå­¦äº’ç›¸æ‰¹åˆ¤äº†ä¸€ç•ªã€‚ä»·å€¼è§‚çš„ä¸åŒå…¶å®æ˜¯å¿…ç„¶çš„ã€‚æˆ–è®¸ä½ æœ‰ä¸€èº«å«‰ä¸–çƒ­è¡€ï¼Œæˆ–è®¸æˆ‘æœ‰ä¸€é¢—å¦‚å†°å¯’å¿ƒã€‚è„šè¸å®åœ°è¿˜æ˜¯ä»°æœ›æ˜Ÿç©ºï¼Ÿå‘ç†æƒ³å‰è¡Œè¿˜æ˜¯äºç°å®æ··æ²Œï¼Ÿè°åˆä¼šçŸ¥é“å‘¢ã€‚æƒ³äº†å¾ˆä¹…è¦ä¸è¦æç¬”å†™ä¸‹è‡ªå·±çš„æƒ³æ³•ï¼Œæœ€åè¿˜æ˜¯æ”¾å¼ƒäº†ã€‚æ—©å°±åº”è¯¥çŸ¥é“ï¼Œè¿™äº›äº‹æƒ…ï¼Œç¬‘ç¬‘å°±å¥½ï¼Œä½•å¿…å»åŠ³å¿ƒè´¹ç¥å‘¢ï¼Ÿä½†åˆä¸çŸ¥é“ä¸ºä½•ï¼Œæœ€è¿‘æ€»æ˜¯æƒ³å†™ï¼Œæƒ³å»è¡¨è¾¾æ‰€æœ‰ä¸€åˆ‡ä¸€åˆ‡çš„æƒ³æ³•ï¼Œæˆ–è®¸åº”è¯¥æ”¶æ”¶äº†å§ã€‚\nâ€œè¿™ä¸æ˜¯èƒ½éšå¿ƒæ‰€æ¬²çš„å¹´çºªã€‚â€\nè¯´çš„çœŸçš„æ˜¯å¥½å•Šã€‚æˆ–è®¸ï¼Œä»å°å­¦å°±åº”è¯¥æƒ³åˆ°çš„å§ã€‚ä½†ä¸ºä»€ä¹ˆç°åœ¨åˆå¿˜è®°äº†å‘¢ï¼Ÿè°ä¼šçŸ¥é“å‘¢ã€‚ä¹Ÿè®¸æ˜¯ä¸€é¢—å¿ƒä¸å†å‡‰çš„å½»éª¨ï¼Œä¹Ÿè®¸æ˜¯ä¸€ä¸å°å¿ƒå°±å¿˜è®°äº†ä»¥å‰å§ã€‚\nè¿™å¥è¯å¯ä»¥è¯´æ˜¯ï¼Œâ€œä¸€è¯­ç‚¹ç ´æ¢¦ä¸­äººâ€ã€‚å°å­¦çš„æ— æ•°ç»å†è®©æˆ‘æ›¾ä»¥ä¸ºæˆ‘å·²ç»ä»è¿™æ¢¦ä¸­é†’æ¥ï¼Œå†ä¹Ÿä¸ä¼šå»åšé‚£è’è¯çš„æ¢¦ï¼›ä½†å¦‚ä»Šå‘ç°ï¼Œåˆ°åº•æ˜¯æ¢¦è¿˜æ˜¯ç°å®å´ä¹Ÿåˆ†ä¸å¤ªæ¸…ã€‚æˆ–è®¸æˆ‘ä»ç„¶è¿˜åœ¨æ¢¦ä¸­ï¼Ÿæˆ–è®¸æ˜¯æˆ‘ä¸€ç›´éƒ½é”™äº†ï¼Ÿè°åˆçŸ¥é“å‘¢ã€‚\næ›¾ç»ä»¥ä¸ºé•¿å¤§ï¼Œä½†æç„¶ä¹‹é—´è¢«äººç‚¹é†’ï¼Œå´æ‰çŸ¥é“æ¢¦ä»ç„¶åœ¨ã€‚æœ‰æ¢¦æ˜¯ä¸æ˜¯ä¸€ä»¶å¥½äº‹å‘¢ï¼Ÿ\næˆ–è®¸å‡ å¹´ä¹‹åä»ä¼šæœ‰ç›¸åŒçš„æ„Ÿæ…¨å§ã€‚ä½†ç°åœ¨ï¼ŒçœŸçš„æ²¡æœ‰æ—¶é—´å»æ€è€ƒé‚£ä¹ˆå¤šã€‚ä½†ä¹Ÿè®¸julaoä»¬ä¸ä¸€å®šå§ã€‚\nä¸å¦‚å…ˆæ»šå»æŠŠä½œä¸šå†™å®Œã€‚\nå¦ç¥å„ä½2018å‰ç¥¥å¿«ä¹ï¼Œä¸‡äº‹å¦‚æ„ã€‚\n","description":"","id":221,"section":"posts","tags":null,"title":"ã€Œéšç¬”ã€â€œé•¿å¤§â€","uri":"https://blog.chenqiqian.com/posts/essay-growing/"},{"content":"åœ¨ä½ é¢å‰æœ‰ä¸€åœˆæ•´æ•°ï¼ˆä¸€å…± $n$ ä¸ªï¼‰ï¼Œä½ è¦æŒ‰é¡ºåºå°†å…¶åˆ†ä¸º $m$ ä¸ªéƒ¨åˆ†ï¼Œå„éƒ¨åˆ†å†…çš„æ•°å­—ç›¸åŠ ï¼Œç›¸åŠ æ‰€å¾—çš„ $m$ ä¸ªç»“æœå¯¹ 10 å–æ¨¡åå†ç›¸ä¹˜ï¼Œæœ€ç»ˆå¾—åˆ°ä¸€ä¸ªæ•° $k$ ã€‚æ¸¸æˆçš„è¦æ±‚æ˜¯ä½¿ä½ æ‰€å¾—çš„ $k$ æœ€å¤§æˆ–è€…æœ€å°ã€‚\nä¾‹å¦‚ï¼Œå¯¹äºä¸‹é¢è¿™åœˆæ•°å­—ï¼ˆ $n=4$ï¼Œ $m=2$ï¼‰ï¼š\nè¦æ±‚æœ€å°å€¼æ—¶ï¼Œ$((2-1) mod 10)Ã—((4+3) mod 10)=1Ã—7=7$ï¼Œè¦æ±‚æœ€å¤§å€¼æ—¶ï¼Œä¸º$((2+4+3) mod 10)Ã—(-1 mod 10)=9Ã—9=81$ã€‚ç‰¹åˆ«å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ— è®ºæ˜¯è´Ÿæ•°è¿˜æ˜¯æ­£æ•°ï¼Œå¯¹$10$å–æ¨¡çš„ç»“æœå‡ä¸ºéè´Ÿå€¼ã€‚\nä¸ä¸è¯·ä½ ç¼–å†™ç¨‹åºå¸®ä»–èµ¢å¾—è¿™ä¸ªæ¸¸æˆã€‚\né“¾æ¥ Luogu P1043\né¢˜è§£ å¾ˆæ°´çš„ä¸€é“ $dp$ é¢˜ç›®ã€‚åªè¦çŸ¥é“æ–­ç¯ä¸ºé“¾å‰©ä¸‹çš„ä¹Ÿéƒ½ä¸éš¾ã€‚é¢˜è§£æ´›è°·æ²¡ç»™é€šè¿‡ï¼Œç°åœ¨ä¹Ÿæ‰¾ä¸åˆ°äº†ï¼Œåªæœ‰ä»£ç è¿˜å‰©äº†ä¸‹æ¥ã€‚ä»£ç é‡Œé¢ä¹Ÿæœ‰æ³¨é‡Šï¼Œå‡‘æ´»çœ‹çœ‹ä¹Ÿå¯ä»¥ã€‚\nupdate: è¿™æ˜¯æˆ‘å†™çš„ç¬¬ä¸€ç¯‡é¢˜è§£å•¦ï¼\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cstring\u0026gt;#include \u0026lt;algorithm\u0026gt;#include \u0026lt;cmath\u0026gt;using namespace std; long long num[150],dp_1[150],dp_2[150];//_1æ”¾æœ€å¤§å€¼,_2æ”¾æœ€å°å€¼  int n,m; inline int mod(long long nnn){//modå‡½æ•°  int w = int(floor(double(nnn)/10)); return nnn - w*10; } int main(){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;n,\u0026amp;m); for(int i = 1;i\u0026lt;=n;i++){//æ–­ç¯ä¸ºé“¾çš„å‡†å¤‡  scanf(\u0026#34;%lld\u0026#34;,\u0026amp;(num[i])); num[i+n] = num[i]; } for(int i = 1;i\u0026lt;=2*n;i++)//å‰ç¼€å’Œçš„å¤„ç†  num[i] = num[i-1]+num[i]; //æ­£ç»dp  long long maxn = -1,minn = 0x3f3f3f3f; for(int s = 1;s\u0026lt;=n;s++){//æšä¸¾èµ·ç‚¹  memset(dp_1,0,sizeof(dp_1));//æ¸…é›¶dpæ•°ç»„  memset(dp_2,0,sizeof(dp_2)); for(int j = 0;j\u0026lt;m;j++){//æ¿å­ç”±å°‘åˆ°å¤š  for(int i = s;i\u0026lt;=s+n;i++){//ä¸Šä¸€ä¸ªæ’æ¿å­çš„åœ°æ–¹  if(j == 0){//j==0çš„æ—¶å€™çš„å¤„ç†ï¼Œå…¶å®ä¹Ÿå¯ä»¥å«åˆå§‹åŒ–  dp_1[i] = dp_2[i] = mod(num[s+n]-num[i]); continue; } long long maxtmp = -1,mintmp = 0x3f3f3f3f;//å¯¹æ‰€æœ‰å¯èƒ½ä¸‹ä¸€çŠ¶æ€çš„éå†ï¼Œå¹¶å–æœ€å¤§æˆ–æœ€å°å€¼  for(int x = i+1;x\u0026lt;=s+n-j-1;x++){ maxtmp = max(maxtmp,dp_1[x]*mod(num[x]-num[i])); mintmp = min(mintmp,dp_2[x]*mod(num[x]-num[i])); } dp_1[i] = maxtmp;//å–æœ€å¤§æœ€å°å€¼  dp_2[i] = mintmp; } } maxn = max(dp_1[s],maxn);//å¯¹äºèµ·ç‚¹ä¸åŒçš„æœ€å¤§æœ€å°å€¼è¿›è¡Œæ›´æ–°  minn = min(dp_2[s],minn); } printf(\u0026#34;%lld\\n%lld\\n\u0026#34;,minn,maxn); return 0; }   ","description":"","id":222,"section":"posts","tags":["åŠ¨æ€è§„åˆ’"],"title":"ã€ŒLuogu1043ã€æ•°å­—æ¸¸æˆ-dp","uri":"https://blog.chenqiqian.com/posts/luogu-1043/"},{"content":"åŸæ–‡åœ°å€ï¼šç‚¹æ­¤æŸ¥çœ‹ å¾ˆä¹…å¾ˆä¹…ä»¥å‰ ç®—æ³•çªç„¶å‡ºç°\nå¸¦æ¥å¯¼è®º å¸¦èµ°äº†æ™ºå•†åˆæ¶ˆå¤±ä¸è§\nç¼–ç¨‹ååˆ†å±é™© ä¸–é—´è°æœ€å‹‡æ•¢\nä¸€ä½æ‡µé€¼å„¿èµ¶æ¥ å¤§å£°å–Š\næˆ‘è¦å†™å‡ºæœ€é«˜çš„æ ‘ æ‰“å‡ºæœ€å¤§çš„è¡¨\næœè¿›æœ€æ·±çš„é€’å½’ æŠŠACå¸¦å›åˆ°é¢å‰\nè€å¸ˆéå¸¸é«˜å…´ å¿™é—®ä»–çš„æŠ€èƒ½\nå¹´è½»äººæƒ³äº†æƒ³ ä»–è¯´\nè€å¸ˆæˆ‘ä¼š éç¡®å®šæ€§æœ‰ç©·çŠ¶æ€å†³ç­–è‡ªåŠ¨æœº\nå†æ¥ä¸€æ¬¡ éç¡®å®šæ€§æœ‰ç©·çŠ¶æ€å†³ç­–è‡ªåŠ¨æœº\næ˜¯ä¸æ˜¯ éç¡®å®šæ€§æœ‰ç©·çŠ¶æ€å†³ç­–è‡ªåŠ¨æœº\nå¯¹å¯¹æ˜¯ éç¡®å®šæ€§æœ‰ç©·çŠ¶æ€å†³ç­–è‡ªåŠ¨æœº\næ‡µé€¼æ— åå°‘å¹´ æ§ç€ç®—æ³•å¯¼è®º\nå¸¦ç€å¤§å®¶çš„å¸Œæœ› ä»å­¦æ ¡é‡Œå‡ºå‘\næˆ˜èƒœBUGæ¥è¢­ è·å¾—è°ƒè¯•ç¥æŠ€\næ— æ•°ä»£ç è§è¯ ä»–æ…¢æ…¢å‡çº§\nåè¿œè®ºå›è§’è½ å‚ä¸æ‰€æœ‰è¯é¢˜\nä¸€è·¯æ’åº ä¼´éšæŒ‡å¼•å‰è·¯çš„å•é“¾è¡¨\nè¿›å…¥å†³èµ›è€ƒåœº æ¯”èµ›å’Œå¯æ€•éš¾é¢˜\nå°‘å¹´æ‰“å¼€IDE éš¾é¢˜é“\næˆ‘æ˜¯ FloydåŒºé—´DPå‡è¡¡çº¢é»‘æ ‘\nå†æ¥ä¸€æ¬¡ FloydåŒºé—´DPå‡è¡¡çº¢é»‘æ ‘\næ˜¯ä¸æ˜¯ Kruskalä¸€ç»´DPäºŒå‰æ’åºæ ‘\nä¸å¯¹æ˜¯ FloydåŒºé—´DPå‡è¡¡çº¢é»‘æ ‘\näºæ˜¯ éç¡®å®šæ€§æœ‰é™çŠ¶æ€å†³ç­–è‡ªåŠ¨æœº\næ‰“å‡º æ·±åº¦æœç´¢æ¨¡æ‹Ÿæšä¸¾å•æºæœ€çŸ­è·¯\nåº”ç”¨ æ‹“æ‰‘æ’åºTrieç»“æ„Polyaå®šå¾‹\nå¥—å…¥ Dijkastaè”é€šåˆ†é‡BellmanFord\næœ€å éç¡®å®šæ€§æœ‰é™çŠ¶æ€å†³ç­–è‡ªåŠ¨æœº\nä»–ä½¿ç”¨äº† IOä¼˜åŒ–æ ‘é“¾å‰–åˆ†è¾“å‡ºrandom\nè°ƒç”¨äº† çŸ©é˜µé€Ÿå¹‚è™šäºŒå‰æ ‘è¡Œåˆ—å¼æ¶ˆå…ƒ\nå®Œæˆäº† å‡¸åŒ…æ‰«æåç¼€æ•°ç»„ç½‘ç»œæœ€å¤§æµ\nè€å¸ˆå¬è¯´ éç¡®å®šæ€§æœ‰é™çŠ¶æ€å†³ç­–è‡ªåŠ¨æœº\nä»–å¿˜äº†å†™ #include\u0026lt;stdio\u0026gt; freopen\nå°±è®© éç¡®å®šæ€§æœ‰é™çŠ¶æ€å†³ç­–è‡ªåŠ¨æœº\nå…¨æ‰‹å†™ map/setç¨³å®šå©šå§»KMPå®ç°\nå•¦å•¦ æ‡µé€¼å°‘å¹´ æ•²ç€é”®ç›˜ Ctrl+Væ¥å‡ é\nä»–å‘æ˜äº†ä¸€ä¸ªç®—æ³• ä¹Ÿåœ¨å¤©å¤©æ¸æ¸å¤æ‚\nä¸ºäº†é¿å…ä»¥åéº»çƒ¦ ç®—æ³•å«åšæš´åŠ›æ³•\nå®ƒçš„å…¨åååˆ†éš¾å¿µ æˆ‘ä¸æƒ³è¯´ä¸€é\n","description":"","id":223,"section":"posts","tags":["æ­Œæ›²"],"title":"[è½¬è½½]è¾¾æ‹‰å´©å§-OIç‰ˆ","uri":"https://blog.chenqiqian.com/posts/dalabengba-oi/"},{"content":"é—²ä¸‹æ¥äº†ï¼Œå¼€å§‹å†™ä¸€ç‚¹å­¦ä¹ ç¬”è®°ï¼Œä¹Ÿå¸Œæœ›èƒ½ç»™åäººé€ ç¦å§ã€‚\nç¬¬ä¸€ç¯‡æ¥è¯´ä¸€è¯´ Treap ã€‚\nTreapæ˜¯ä»€ä¹ˆ Tree + Heap æ ‘å †ï¼ˆè‹±è¯­ï¼š Treap ï¼‰ï¼Œæ˜¯æœ‰ä¸€ä¸ªéšæœºé™„åŠ åŸŸæ»¡è¶³å †çš„æ€§è´¨çš„äºŒå‰æœç´¢æ ‘ï¼Œå…¶ç»“æ„ç›¸å½“äºä»¥éšæœºæ•°æ®æ’å…¥çš„äºŒå‰æœç´¢æ ‘ã€‚å…¶åŸºæœ¬æ“ä½œçš„æœŸæœ›æ—¶é—´å¤æ‚åº¦ä¸º $O(\\log {n})$ ã€‚ç›¸å¯¹äºå…¶ä»–çš„å¹³è¡¡äºŒå‰æœç´¢æ ‘ï¼Œ Treap çš„ç‰¹ç‚¹æ˜¯å®ç°ç®€å•ï¼Œä¸”èƒ½åŸºæœ¬å®ç°éšæœºå¹³è¡¡çš„ç»“æ„ã€‚\nåŸºæœ¬æ€æƒ³åŠæ“ä½œ ä¸€èˆ¬åœ¨ Treap é‡Œé¢ç»´æŠ¤ä¸€ä¸ªæœ€å°å †ã€‚\næ—‹è½¬ æ—‹è½¬æ˜¯ä¸€ç§ä¸ç ´åäºŒå‰æœç´¢æ ‘æ€§è´¨çš„æ“ä½œï¼Œæœ‰å·¦æ—‹åŠå³æ—‹ä¸¤ç§ã€‚å…·ä½“æ“ä½œåœ¨ä»£ç éƒ¨åˆ†è§£é‡Šã€‚\næ—‹è½¬çš„æ—¶é—´å¤æ‚åº¦æ˜¯ $O(1)$ ï¼Œå› ä¸ºåªéœ€è¦ä¿®æ”¹å¸¸æ•°ä¸ªæŒ‡é’ˆã€‚\næŒ‰å…³é”®å­—å¯»æ‰¾ å¯ä»¥å‘ç°ï¼Œåœ¨è¦å¯»æ‰¾çš„å…³é”®å­—å°äºå½“å‰èŠ‚ç‚¹å…³é”®å­—æ—¶ï¼Œå…¶èŠ‚ç‚¹åªå¯èƒ½åœ¨å½“å‰èŠ‚ç‚¹çš„å·¦å­æ ‘ä¸­ï¼›ç­‰äºæ—¶å³ä¸ºå½“å‰èŠ‚ç‚¹ï¼›å¤§äºæ—¶å€™åœ¨å³å­æ ‘ä¸­ã€‚äºæ˜¯å¯ä»¥æ ¹æ®å…³é”®å­—å¯»æ‰¾åˆ°èŠ‚ç‚¹ã€‚\næ’å…¥ åœ¨ Treap ä¸­ï¼Œæ’å…¥éœ€è¦æ ¹æ®äºŒå‰æœç´¢æ ‘çš„æ€§è´¨ï¼Œæ‰¾åˆ°èƒ½æ”¾ç½®è¿™ä¸ªèŠ‚ç‚¹çš„ç©ºä½ç½®ï¼Œç»™æ–°èŠ‚ç‚¹éšæœºåˆ†é…ä¸€ä¸ªä¼˜å…ˆå€¼ï¼Œç„¶åè°ƒæ•´ Treap çš„å †æ€§è´¨ã€‚\nåˆ é™¤ å¦‚æœéœ€è¦åˆ é™¤ä¸€ä¸ªèŠ‚ç‚¹ï¼Œé¦–å…ˆåº”å½“å¯»æ‰¾åˆ°è¿™ä¸ªèŠ‚ç‚¹ï¼Œå¹¶å°†è¿™ä¸ªèŠ‚ç‚¹æ—‹è½¬è‡³æœ€åº•å±‚ï¼Œå³å·¦å³å„¿å­çš†ä¸ºç©ºçš„æ—¶å€™ï¼Œåˆ é™¤è¯¥èŠ‚ç‚¹ã€‚å¹¶æ³¨æ„éœ€è¦åœ¨æ—‹è½¬è¿‡ç¨‹ä¸­ç»´æŠ¤æœ€å°å †æ€§è´¨ã€‚\næŸ¥è¯¢æ’å åœ¨è¿™é‡Œæ’åæ˜¯æŒ‡å°äºæŸæ•°çš„æ•°çš„ä¸ªæ•°+1ã€‚æ³¨æ„åˆ°åœ¨æŸäºŒå‰æœç´¢æ ‘ä¸­ï¼Œå°äºæ ¹èŠ‚ç‚¹çš„èŠ‚ç‚¹æ•°ç›®å³ä¸ºæ ¹èŠ‚ç‚¹å·¦å­æ ‘çš„èŠ‚ç‚¹æ•°ç›®ã€‚æ‰€ä»¥åªéœ€è¦æŒ‰å…³é”®å­—æŸ¥æ‰¾åˆ°æ­¤èŠ‚ç‚¹ï¼Œå¹¶å¦‚æœå‘å³æœç´¢ï¼Œå°±åŠ ä¸Šæ­¤èŠ‚ç‚¹å·¦å­æ ‘çš„å¤§å°å’Œæ ¹èŠ‚ç‚¹çš„å¤§å°ï¼Œè¿›è¡Œé€’å½’æœç´¢ã€‚\næŒ‰æ’åæŸ¥æ‰¾ éœ€è¦å¯¹æ¯ä¸€ä¸ªèŠ‚ç‚¹ç»´æŠ¤ä¸€ä¸ª size å€¼ï¼Œæ„ä¸ºä»¥å…¶ä¸ºæ ¹èŠ‚ç‚¹çš„æ ‘çš„å¤§å°ï¼ˆåŒ…æ‹¬æœ¬èº«ï¼‰ã€‚æœç´¢çš„æ—¶å€™ï¼Œå¦‚æœæ’åå°äºå½“å‰èŠ‚ç‚¹å·¦å­æ ‘çš„ size å€¼ç›´æ¥é€’å½’è¿›å…¥å·¦å­æ ‘ï¼›å¦‚æœæ’åè½åœ¨å½“å‰èŠ‚ç‚¹ï¼Œåˆ™è¿”å›å½“å‰èŠ‚ç‚¹ï¼›å¦åˆ™æ›´æ–°æ’åå‘å³å­æ ‘é€’å½’ã€‚\nå‰é©±\u0026amp;åç»§ åœ¨è¿™é‡Œï¼Œå‰é©±å®šä¹‰ä¸ºå°äº $x$ ï¼Œä¸”æœ€å¤§çš„æ•°ã€‚åç»§åŒç†ã€‚è¿™ä¸ªçš„å¯»æ‰¾ç¨å¾®å¤æ‚ã€‚\nä»¥å‰é©±ä¸ºä¾‹ã€‚\nå¦‚æœå¯»æ‰¾åˆ°çš„èŠ‚ç‚¹æœ‰å·¦å­æ ‘ï¼Œé‚£ä¹ˆå…¶å‰é©±å°±æ˜¯å·¦å­æ ‘é‡Œé¢çš„æœ€å¤§å€¼ï¼›å¦‚æœæ²¡æœ‰å·¦å­æ ‘ï¼Œé‚£ä¹ˆå…¶å‰é©±å°±æ˜¯å¯»æ‰¾çš„è·¯å¾„ä¸Šæœ€é è¿‘çš„ä¸€ä¸ªå‘å³å¯»æ‰¾çš„èŠ‚ç‚¹ã€‚\nç¬¬ä¸€ç§å¾ˆå®¹æ˜“æƒ³æ˜ç™½ï¼Œç¬¬äºŒç§ç¨éš¾ä¸€äº›ã€‚\nä»¥æ­¤å›¾ä¸ºä¾‹ã€‚æ¯”å¦‚æˆ‘ä»¬å¯»æ‰¾12çš„å‰é©±ï¼Œå®ƒæ²¡æœ‰å·¦å­æ ‘ï¼Œæ‰€ä»¥å®ƒå±äºæƒ…å†µäºŒã€‚æŒ‰ç…§åˆšæ‰æåˆ°çš„è§„åˆ™ï¼Œå¯ä»¥å‘ç°12çš„å‰é©±æ˜¯11ï¼Œå› ä¸º11æ˜¯æœ€åä¸€ä¸ªå‘å³å¯»æ‰¾ï¼Œå³ä¸‹ä¸€æ¬¡å¯»æ‰¾æ˜¯å…¶å³å„¿å­ï¼ˆ16ï¼‰çš„èŠ‚ç‚¹ã€‚\nå¯ä»¥æ³¨æ„åˆ°ï¼Œ11çš„å·¦å­æ ‘ä¸Šçš„ç‚¹å…¨éƒ½æ¯”6å°ï¼Œä¸ç¬¦åˆè¦æ±‚ï¼›12çš„å·¦å­æ ‘ä¸å­˜åœ¨ï¼Œ12çš„å³å­æ ‘ä¸Šçš„ç‚¹éƒ½æ¯”12å¤§ï¼Œè€Œ11-12çš„è·¯å¾„ä¸Šçš„ç‚¹ï¼Œå…¶åº”å½“æ˜¯å…¨éƒ½æ˜¯å‘å·¦å¯»æ‰¾çš„ï¼Œä¹Ÿéƒ½æ¯”12è¦å¤§ï¼Œè€Œåœ¨11ä»¥ä¸Šçš„ç‚¹ï¼Œåº”å½“éƒ½æ¯”12è¦å¤§ï¼ˆ11æ˜¯å·¦å„¿å­çš„æ—¶å€™ï¼‰ï¼Œæˆ–è€…æ¯”11è¦å°ï¼ˆ11æ˜¯å³å„¿å­çš„æ—¶å€™ï¼‰ï¼Œæ‰€ä»¥ï¼Œ6å°±æ˜¯7çš„å‰é©±ã€‚\nåç»§åŒç†ã€‚\næ’å…¥ã€åˆ é™¤ç­‰ä»¥ä¸Šæ“ä½œçš„æœŸæœ›æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ $O(\\log {n})$ ï¼Œå› ä¸ºæ ‘çš„æœŸæœ›é«˜åº¦æ˜¯ $\\log {n}$ ã€‚\nä»£ç è§£æ ä»¥æ´›è°·P3369 æ™®é€šå¹³è¡¡æ ‘ä¸ºä¾‹ã€‚ä»£ç æ˜¯æŒ‡é’ˆç‰ˆï¼Œä¸è®°å½•çˆ¶èŠ‚ç‚¹ï¼Œé€’å½’æ“ä½œã€‚\nï¼ˆå…¶å®æˆ‘è¿˜æ˜¯è§‰å¾—æ•°ç»„å¥½å†™\nç»“æ„ä½“çš„å®šä¹‰ 1 2 3 4 5 6 7 8 9 10 11  template\u0026lt;typename T,size_t siz\u0026gt; struct treap{ struct node_t{ T val; int p,size,cnt; node_t *son[2]; }; int treapcnt; node_t pool[siz\u0026lt;\u0026lt;1],*root,*null; //... }   åœ¨è¿™é‡Œé‡‡ç”¨äº†æ¨¡æ¿çš„å®šä¹‰æ–¹æ³•ã€‚Tä¸ºä¸€ä¸ªæ¨¡ç‰ˆç±»ã€‚éœ€è¦æ³¨æ„è¿™é‡Œçš„Tæ¨¡æ¿è¦æœ‰å°äºè¿ç®—ç¬¦ã€‚\nå¯¹äºæ¯ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæˆ‘ä»¬ç»´æŠ¤ä»¥ä¸‹å‡ ä¸ªä¿¡æ¯ï¼šå…³é”®å­—ï¼Œéšæœºä¼˜å…ˆå€¼ï¼Œä»¥å…¶ä¸ºæ ¹çš„äºŒå‰æœç´¢æ ‘çš„å¤§å°ï¼Œå’Œè¿™ä¸ªå…³é”®å­—çš„æ•°é‡ï¼Œå·¦å„¿å­å’Œå³å„¿å­çš„æŒ‡é’ˆã€‚é»˜è®¤0ä¸ºå·¦ï¼Œ1ä¸ºå³ã€‚\nåœ¨ç»“æ„ä½“çš„å˜é‡ä¸­ï¼Œæˆ‘ä»¬ç»´æŠ¤äº†ä¸€ä¸ªé™æ€å†…å­˜æ± ï¼Œå†…å­˜æ± å·²ç»ä½¿ç”¨çš„æ•°é‡ï¼Œæ ¹èŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œä»¥åŠä¸€ä¸ªè™šçš„ç©ºèŠ‚ç‚¹ã€‚\nåœ¨è¿™é‡Œè‡ªå·±å®šä¹‰ä¸€ä¸ªç©ºèŠ‚ç‚¹çš„å¥½å¤„ä¸»è¦æ˜¯å¯ä»¥é¿å… NULL å¯¼è‡´çš„ segmentation fault ï¼Œä»¥åŠè®©å‡½æ•°ç¼–å†™å˜å¾—æ›´åŠ ç®€å•ã€‚\néœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè§†é¢˜ç›®ä¸åŒï¼Œ cnt å˜é‡å¯èƒ½å¯ä»¥çœå»ã€‚\nä¸€äº›ç®€å•å‡½æ•° 1 2 3 4 5 6 7 8 9 10 11 12  void newnode(node_t *\u0026amp;r){ r = \u0026amp;pool[Treapcnt++]; r-\u0026gt;son[0] = r-\u0026gt;son[1] = null; } void update(node_t *r){ r-\u0026gt;size = r-\u0026gt;son[0]-\u0026gt;size + r-\u0026gt;son[1]-\u0026gt;size + r-\u0026gt;cnt; } node_t* find_minormax(node_t *r,int tmp){//0æœ€å° 1æœ€å¤§  while(r-\u0026gt;son[tmp]!=null) r = r-\u0026gt;son[tmp]; return r; }   newnode å‡½æ•°åœ¨è¿™é‡Œå®Œæˆå¯¹èŠ‚ç‚¹åˆå§‹åŒ–çš„ä»»åŠ¡ï¼Œå¹¶å¯¹å­èŠ‚ç‚¹èµ‹å€¼ã€‚éœ€è¦æ³¨æ„ä»¥ä¸‹ï¼Œè¿™é‡Œéœ€è¦ä½¿ç”¨å¼•ç”¨çš„æ–¹æ³•ï¼Œå¦åˆ™å¦‚æœä½¿ç”¨äº†è¿”å›å€¼çš„åŠæ³•ï¼Œå°±ä¸èƒ½ä½¿ç”¨ newnode å‡½æ•°å¯¹ null èµ‹å€¼äº†ï¼Œå› ä¸ºä¼šäº§ç”Ÿ NULL è¿™ç§å¯æ€•çš„ä¸œè¥¿ã€‚å…¶å®åœ¨è¿™é‡Œä¹Ÿå¯ä»¥æŠŠèµ‹å…³é”®å­—ã€éšæœºå€¼ã€ size å€¼ç­‰äº‹æƒ…ä¸€å¹¶å®Œæˆï¼Œä½†æ˜¯æˆ‘æ¯”è¾ƒæ‡’ï¼Œæ‰€ä»¥å°±åœ¨åé¢æ‰‹åŠ¨èµ‹å€¼äº†ã€‚\nupdate å‡½æ•°åœ¨è¿™é‡Œå®Œæˆå¯¹èŠ‚ç‚¹ size å€¼çš„æ›´æ–°ï¼Œå¾ˆå¥½ç†è§£ã€‚\nfind_minormax å‡½æ•°åœ¨è¿™é‡Œå®Œæˆå¯¹ä»¥ r ä¸ºæ ¹èŠ‚ç‚¹çš„æ ‘ä¸Šæœ€å¤§æˆ–æœ€å°èŠ‚ç‚¹çš„å¯»æ‰¾ã€‚ä¹Ÿå¾ˆç®€å•ï¼Œå°±ä¸è§£é‡Šäº†ã€‚\nåä¸¤ä¸ªå‡½æ•°å¯ä»¥æ”¾åˆ° node ç»“æ„ä½“é‡Œé¢ï¼Œä½†æ˜¯æˆ‘ä¸å¤ªå–œæ¬¢é‚£ä¹ˆåšï¼Œå› ä¸ºé‚£æ ·ä¼šä½¿ç®­å¤´çš„æ•°ç›®å¤§å¤§å¢å¤šï¼Œä»è€Œå¯¼è‡´å¤´ç–¼ï¼ˆé›¾ã€‚\nç»“æ„ä½“çš„åˆå§‹åŒ– 1 2 3 4 5 6 7 8  treap(){ treapcnt = 0; newnode(null); null-\u0026gt;size = null-\u0026gt;val = 0; null-\u0026gt;p = MAXINT; root = null; srand(time(NULL)); }   ç»“æ„ä½“çš„åˆå§‹åŒ–ä¸éš¾ï¼Œæœ‰å‡ ç‚¹éœ€è¦æ³¨æ„ï¼š\n ç©ºæŒ‡é’ˆçš„ size éœ€è¦ä¸º 0 ç©ºæŒ‡é’ˆçš„éšæœºå€¼éœ€è¦è¶³å¤Ÿå¤§ï¼ˆæœ€å¤§å †ä¸­è¶³å¤Ÿå°ï¼Œæœ€å¥½æ˜¯ maxint ï¼Œå¦åˆ™æœ‰å¯èƒ½åœ¨ä¹‹åçš„åˆ é™¤æ“ä½œä¸­è¢«è½¬ä¸Šå»ï¼Œç„¶åæ ‘å°±æ–­äº† æœ€å¥½ srand ä¸€ä¸‹  æ—‹è½¬ 1 2 3 4 5 6 7  void rotate(node_t *\u0026amp;r,int tmp){//0å·¦æ—‹ï¼Œ1å³æ—‹  node_t *t = r-\u0026gt;son[1-tmp]; r-\u0026gt;son[1-tmp] = t-\u0026gt;son[tmp]; t-\u0026gt;son[tmp] = r; update(r),update(t); r = t; }   æ—‹è½¬æ“ä½œçš„æ–‡å­—å™è¿°ï¼š\nï¼ˆæ‹¬å·é‡Œæ–‡å­—ä»¥å·¦æ—‹ä¸ºä¾‹ï¼‰\n é€‰å®šå½“å‰èŠ‚ç‚¹ r ï¼ˆå›¾ä¸­çš„ x ï¼‰ æ‰¾åˆ°å¹¶è®°å½•éœ€è¦æ—‹ä¸Šæ¥çš„èŠ‚ç‚¹ tï¼ˆå·¦æ—‹æ—‹å³å„¿å­ï¼Œå³æ—‹å·¦å„¿å­ï¼‰ï¼ˆå›¾ä¸­çš„ y ï¼‰ æŠŠ t å°†è¦è¢«è¦†ç›–çš„å„¿å­ï¼ˆä¸æ—‹è½¬æ–¹å‘ç›¸åŒçš„å„¿å­ï¼‰æ¥åˆ° t åœ¨ r åŸæ¥çš„ä½ç½®ä¸Š ï¼ˆæŠŠ b æ¥åœ¨ x çš„å³å­ä½ç½®ä¸Šï¼‰ æŠŠ r æ¥åˆ° t ç©ºå‡ºæ¥çš„ä½ç½®ä¸Š ï¼ˆæŠŠ x æ¥åˆ° y çš„ x çš„å·¦å­æ ‘ä¸Šï¼‰ æ›´æ–° size å€¼ ï¼ˆæ›´æ–° x ï¼Œy çš„ size ï¼‰  ç”±äºæˆ‘ä»¬æ²¡æœ‰è®°å½•çˆ¶èŠ‚ç‚¹ï¼Œæ‰€ä»¥è¿™ä¸ªæ—‹è½¬çš„å†™æ³•è·Ÿ Splay çš„æ—‹è½¬å†™æ³•ä¸å¤ªåƒã€‚ä½†å…¶å® Splay ä¹Ÿå¯ä»¥è¿™ä¹ˆå†™ï¼Œåªä¸è¿‡æ²¡æœ‰å¿…è¦ã€‚\nå…¶å®è¿™ä¸ªè®°ä¸ä¸‹æ¥ä¸è¦ç´§ã€‚å¤§æ¦‚æœ‰ä¸ªå°è±¡ï¼Œè¦å†™çš„æ—¶å€™æ ¹æ®äºŒå‰æœç´¢æ ‘çš„æ€§è´¨ç°æ¨ä¹Ÿå¯ä»¥å…¶å®ã€‚ï¼ˆè¯¯\nä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ—‹è½¬å¾ˆæœ‰å¯èƒ½ï¼ˆå°±æ˜¯ï¼‰ä¼šç ´åä¸€ä¸ªåˆæ³• Treap çš„å †æ€§è´¨ï¼Œæ‰€ä»¥æ—‹è½¬åœ¨ Treap ä¸­åªç”¨æ¥ç»´æŠ¤å †çš„æ€§è´¨ï¼Œè€Œä¸ç”¨åœ¨å…¶ä»–çš„åœ°æ–¹ã€‚è€Œä¸”è¿™é‡Œçš„æŒ‡é’ˆæ˜¯å¼•ç”¨ä¼ é€’ï¼Œæ‰èƒ½ä¿®æ”¹å¯¹åº”çˆ¶èŠ‚ç‚¹çš„å„¿å­æŒ‡é’ˆã€‚\næœ‰ä¸€ç‚¹å¾ˆé‡è¦çš„å°±æ˜¯è¦ç»´æŠ¤ size çš„å€¼ï¼Œè€Œä¸”æ˜¯ä»ä¸‹åˆ°ä¸Šã€‚\næ’å…¥ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  void __insert(node_t *\u0026amp;r,T v){ if(r == null){ newnode(r); r-\u0026gt;val = v,r-\u0026gt;cnt = 1,r-\u0026gt;p = rand(); } else{ if(r-\u0026gt;val == v) r-\u0026gt;cnt++; else{ int tmp = r-\u0026gt;val \u0026lt; v; __insert(r-\u0026gt;son[tmp],v); if(r-\u0026gt;son[tmp]-\u0026gt;p \u0026lt; r-\u0026gt;p) rotate(r,1-tmp); } } update(r); }   ç”¨æ–‡å­—è¯´æ˜ Treap çš„æ’å…¥ç­–ç•¥ï¼š\n é€’å½’è¾¹ç•Œï¼šå¯»æ‰¾åˆ°èŠ‚ç‚¹ï¼Œ cnt++ æˆ–è€…å·²ç»åˆ°è¾¾ç©ºèŠ‚ç‚¹ï¼Œèµ‹å€¼ä¸€ä¸ªæ–°èŠ‚ç‚¹ é€’å½’æ·»åŠ èŠ‚ç‚¹ï¼Œæ¯”å½“å‰èŠ‚ç‚¹å°å‘å·¦ï¼Œæ¯”å½“å‰èŠ‚ç‚¹å¤§å‘å³ ç»´æŠ¤æœ€å°å †çš„æ€§è´¨ æ›´æ–° size å€¼  åœ¨ç»´æŠ¤æœ€å°å †çš„æ€§è´¨çš„æ—¶å€™ï¼Œå¦‚æœå­èŠ‚ç‚¹çš„æƒå€¼è¾ƒå°ï¼Œé‚£æˆ‘ä»¬å°±éœ€è¦æŠŠå®ƒè½¬ä¸Šæ¥ã€‚\néœ€è¦æ³¨æ„ï¼Œè¿™é‡Œçš„èŠ‚ç‚¹æ˜¯å¼•ç”¨æ–¹å¼ä¼ å…¥ï¼Œè¿™æ ·æ‰èƒ½å¯¹çˆ¶èŠ‚ç‚¹çš„å„¿å­æŒ‡é’ˆè¿›è¡Œä¿®æ”¹ï¼Œä»è€Œå®Œæˆæ ‘çš„è¿æ¥ã€‚\nå†æ¬¡é‡å¤ï¼Œä¸è¦å¿˜è®°æ›´æ–° size å€¼ã€‚\nåˆ é™¤ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20  void __erase(node_t *\u0026amp;r,T v){ if(r-\u0026gt;val == v){ if(r-\u0026gt;cnt \u0026gt; 1) r-\u0026gt;cnt--; else{ if(r-\u0026gt;son[0]==null \u0026amp;\u0026amp; r-\u0026gt;son[1]==null){ r = null;return; } else{//è¿˜æœ‰å­èŠ‚ç‚¹ï¼Œ  int tmp = r-\u0026gt;son[1]-\u0026gt;p \u0026lt; r-\u0026gt;son[0]-\u0026gt;p; rotate(r,1-tmp); __erase(r,v); } } } else{ int tmp = r-\u0026gt;val \u0026lt; v; __erase(r-\u0026gt;son[tmp],v); } update(r); }   ç”¨æ–‡å­—è¯´æ˜ Treap çš„åˆ é™¤ç­–ç•¥ï¼š\n é€’å½’è¾¹ç•Œï¼šè¦åˆ é™¤çš„èŠ‚ç‚¹æ²¡æœ‰å„¿å­èŠ‚ç‚¹ å¯»æ‰¾åˆ°å½“å‰èŠ‚ç‚¹ï¼Œå‡å°‘æ•°é‡æˆ–è€…å‘ä¸‹æ—‹è½¬ ç»´æŠ¤æœ€å°å †çš„æ€§è´¨ï¼Œå³æŠŠä¸¤ä¸ªå„¿å­ä¸­æƒå€¼è¾ƒå°çš„æ—‹è½¬ä¸Šæ¥ é€’å½’åˆ é™¤èŠ‚ç‚¹æ³¨æ„æ­¤å¤„çš„èŠ‚ç‚¹æŒ‡é’ˆä»æ˜¯rï¼Œå› ä¸ºråœ¨æ—‹è½¬ä¸­å·²ç»å‘ç”Ÿäº†å˜åŒ– æ›´æ–° size å€¼  åˆ é™¤çš„æ—¶å€™æœ€éœ€è¦æ³¨æ„çš„å·²ç»åœ¨ä¸Šé¢æŒ‡å‡ºã€‚\nè¿˜æœ‰åœ¨æ—‹è½¬æ¯”è¾ƒçš„æ—¶å€™ä¸€å®šæ¯”è¾ƒçš„æ˜¯ä¼˜å…ˆçº§ï¼ï¼ï¼\nTreap çš„åˆ é™¤å’Œæ’å…¥å…¶å®å¾ˆåƒï¼Œåªä¸è¿‡é€’å½’çš„ä½ç½®ç›¸åã€‚æ’å…¥æ˜¯å…ˆé€’å½’å†ç»´æŠ¤ï¼Œè€Œåˆ é™¤æ˜¯å…ˆç»´æŠ¤å†é€’å½’ã€‚\næŸ¥è¯¢æ’å\u0026amp;æ’åæŸ¥è¯¢ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  int __getrank(node_t *r,T v){//æŸ¥æ‰¾æ•°vçš„æ’å  if(r-\u0026gt;val == v||r == null)//è®°å¾—åˆ¤ç©ºï¼  return r-\u0026gt;son[0]-\u0026gt;size + 1; else if(v \u0026lt; r-\u0026gt;val) return __getrank(r-\u0026gt;son[0],v); else return __getrank(r-\u0026gt;son[1],v) + r-\u0026gt;son[0]-\u0026gt;size + r-\u0026gt;cnt; } node_t* __qrank(node_t *r,int rank){//æŸ¥æ‰¾ä»¥rankæ’åçš„æ•°  rank -= r-\u0026gt;son[0]-\u0026gt;size; if(rank\u0026lt;=0) return __qrank(r-\u0026gt;son[0],rank + r-\u0026gt;son[0]-\u0026gt;size); else if(rank \u0026lt;= r-\u0026gt;cnt) return r; else return __qrank(r-\u0026gt;son[1],rank - r-\u0026gt;cnt); }   è¿™ä¸¤ä¸ªæ¯”è¾ƒç®€å•ï¼Œè€Œä¸”åœ¨ä¸Šé¢ä¹Ÿè®²çš„å¾ˆè¯¦ç»†äº†ï¼Œæ‰€ä»¥å°±ä¸€å—è¯´ã€‚\næŸ¥è¯¢æ’åå’Œæ’åæŸ¥è¯¢å…¶å®æ˜¯ç›¸åçš„æ“ä½œï¼Œåªéœ€è¦æ³¨æ„å°†+1ï¼Œ-1å’Œç©ºèŠ‚ç‚¹ç­‰é—®é¢˜å¤„ç†å¥½äº†å°±å¯ä»¥äº†ã€‚\nå‰é©±å’Œåç»§ 1 2 3 4 5 6 7 8 9 10 11  node_t *loworup(T v,int t){//0ä»£è¡¨å‰é©±ï¼Œ1ä»£è¡¨åç»§  node_t *last = null,*nown = root; while(nown-\u0026gt;val!=v \u0026amp;\u0026amp; nown!=null){ int tmp = nown-\u0026gt;val \u0026lt; v; if(tmp!=t) last = nown; nown = nown-\u0026gt;son[tmp]; } if(nown-\u0026gt;son[t]!=null) last = find_minormax(nown-\u0026gt;son[t],1-t); return last; }   è¿™ä¸¤ä¸ªæ“ä½œå…¶å®æ˜¯å®Œå…¨ç›¸åçš„ï¼Œæ‰€ä»¥åˆåˆ°äº†ä¸€ä¸ªå‡½æ•°é‡Œé¢ï¼Œåœ¨åé¢çš„è¿›ä¸€æ­¥çš„å°è£…ä¸­å†åˆ†å¼€ã€‚\næ€è·¯åœ¨ä¸Šé¢å·²ç»æåˆ°ï¼Œåœ¨è¿™é‡Œåªéœ€è¦æ³¨æ„å¯¹ä¸å­˜åœ¨çš„å€¼çš„å‰é©±ï¼åç»§è¿›è¡Œå¤„ç†ã€‚æˆ‘ä»¬æŸ¥ä¸åˆ°ä¸å­˜åœ¨çš„å€¼çš„èŠ‚ç‚¹ï¼Œä½†æˆ‘ä»¬å¯ä»¥å‡è£…é‚£é‡Œæœ‰ä¸€ä¸ªèŠ‚ç‚¹ã€‚å› ä¸º null çš„å­©å­ä¹Ÿæ˜¯ null ï¼Œæ‰€ä»¥è¿™æ®µä»£ç ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨åœ¨å€¼çš„å‰é©±å’Œåç»§é‡Œé¢ã€‚\nå¤šè¯´ä¸€å¥ï¼Œåœ¨ Splay é‡Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æŠŠå¾…æŸ¥èŠ‚ç‚¹ splay åˆ°æ ¹ç„¶åçæä¸€é€š\nè¾“å‡ºæ ‘ 1 2 3 4 5 6 7 8 9  void __print(node_t *r,int depth = 0){ if(r == null) return; else{ __print(r-\u0026gt;son[0],depth+1); for(int i = 0;i\u0026lt;depth;i++) putchar(\u0026#39; \u0026#39;);//æ‰“å°æ·±åº¦  printf(\u0026#34;val:%d cnt:%d size:%d P:%d son?:%d %d\\n\u0026#34;,r-\u0026gt;val,r-\u0026gt;cnt,r-\u0026gt;size,r-\u0026gt;p,r-\u0026gt;son[0]!=null,r-\u0026gt;son[1]!=null); __print(r-\u0026gt;son[1],depth+1); } }   æŒ‰ç…§ä¸­åºéå†æ‰“å°ä¸€æ£µæ ‘ã€‚ä¸»è¦åœ¨è°ƒè¯•çš„æ—¶å€™ç”¨çš„å¤šã€‚æœ‰ä¸€ä¸ªå°æŠ€å·§å°±æ˜¯è®°å½•ä¸€ä¸ªæ·±åº¦ï¼Œç„¶åæŠŠæ·±åº¦é•¿åº¦çš„ç©ºæ ¼æ‰“å°å‡ºæ¥ï¼Œè¿™æ ·å°±å¯ä»¥æ›´ç›´è§‚çš„çœ‹åˆ°å„ä¸ªèŠ‚ç‚¹çš„æ·±åº¦ä»€ä¹ˆçš„ã€‚\nå°è£… 1 2 3 4 5 6 7  void insert(T v){__insert(root,v);} void erase(T v){__erase(root,v);} int getrank(T v){return __getrank(root,v);} int qrank(int rank){return __qrank(root,rank)-\u0026gt;val;} int lower(T v){return loworup(v,0)-\u0026gt;val;} int upper(T v){return loworup(v,1)-\u0026gt;val;} void print(){__print(root);}   å°è£…å…¶å®æ²¡æœ‰å¿…è¦ï¼Œå¯ä»¥ç”¨ä¸€äº›åˆ¤æ–­æ¥ä»£æ›¿ã€‚ä½†æ˜¯æˆ‘ä»¬ä¸ºäº†è®©ä»£ç æ›´åƒå·¥ç¨‹çš„ä»£ç ï¼Œè€Œä¸”è®©å‰é¢çš„ä»£ç æ›´ç¾è§‚ï¼Œæ›´ä»¤äººèµå¿ƒæ‚¦ç›®ï¼Œæ‰€ä»¥æˆ‘ä»¬å°è£…ä¸€ä¸‹å§ã€‚\nå®Œæ•´ä»£ç åŠæ³¨é‡Š é¢˜ç›®ï¼šæ´›è°·P3369 æ™®é€šå¹³è¡¡æ ‘\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147  #include \u0026lt;cstdio\u0026gt;#include \u0026lt;cstdlib\u0026gt;#include \u0026lt;ctime\u0026gt;#define maxint 2147483647 using namespace std; template\u0026lt;typename T,size_t siz\u0026gt;//æ¨¡ç‰ˆT,éœ€è¦æœ‰ç­‰äºä¸ç­‰äºå’Œå°äºè¿ç®—ç¬¦ struct treap{ private: struct node_t{ T val; int p,size,cnt; node_t *son[2]; }; int treapcnt; node_t pool[siz\u0026lt;\u0026lt;1],*root,*null; void newnode(node_t *\u0026amp;r){ r = \u0026amp;pool[treapcnt++]; r-\u0026gt;son[0] = r-\u0026gt;son[1] = null; } void update(node_t *r){ r-\u0026gt;size = r-\u0026gt;son[0]-\u0026gt;size+r-\u0026gt;son[1]-\u0026gt;size+r-\u0026gt;cnt; } void rotate(node_t *\u0026amp;r,int tmp){//0å·¦æ—‹ï¼Œ1å³æ—‹  node_t *t = r-\u0026gt;son[1-tmp];//æ‰¾åˆ°éœ€è¦æ—‹ä¸Šæ¥çš„èŠ‚ç‚¹  r-\u0026gt;son[1-tmp] = t-\u0026gt;son[tmp];//å°†è¢«é€‰èŠ‚ç‚¹çš„è¢«é®è”½çš„å„¿å­äº¤ç»™ä¸Šé¢çš„èŠ‚ç‚¹  t-\u0026gt;son[tmp] = r;//å°†rä½œä¸ºtçš„å„¿å­  update(r),update(t);//æ³¨æ„æ›´æ–°é¡ºåºï¼å…ˆå„¿å­åçˆ¶äº²  r = t;//é€šè¿‡å¼•ç”¨æ›´æ”¹ä¸Šæ–¹èŠ‚ç‚¹çš„å„¿å­  } void __insert(node_t *\u0026amp;r,T v){//rä»£è¡¨å½“å‰èŠ‚ç‚¹ï¼Œvä»£è¡¨å…³é”®å­—  if(r == null){//å¦‚æœrçš„åœ°æ–¹å·²ç»æ²¡æœ‰èŠ‚ç‚¹  newnode(r);//æ–°å»ºèŠ‚ç‚¹ï¼Œå¹¶é€šè¿‡å¼•ç”¨æ·»åŠ è‡³ä¸Šé¢èŠ‚ç‚¹çš„å„¿å­  r-\u0026gt;val = v,r-\u0026gt;cnt = 1,r-\u0026gt;p = rand();//å¯¹ç›¸å…³ä¿¡æ¯çš„è®¾ç½®  } else{ if(r-\u0026gt;val == v) //å¦‚æœå·²ç»æ·»åŠ è¿‡ï¼Œç›´æ¥ç»™æ•°é‡++  r-\u0026gt;cnt++; else{ int tmp = r-\u0026gt;val \u0026lt; v; __insert(r-\u0026gt;son[tmp],v);//é€’å½’æ›´æ”¹  if(r-\u0026gt;son[tmp]-\u0026gt;p \u0026lt; r-\u0026gt;p)//ç»´æŠ¤treapæ€§è´¨  rotate(r,1-tmp); } } update(r);//ä¸è¦å¿˜äº†æ›´æ–°ï¼  } void __erase(node_t *\u0026amp;r,T v){ if(r-\u0026gt;val == v){//å·²ç»æ‰¾åˆ°  if(r-\u0026gt;cnt \u0026gt; 1) r-\u0026gt;cnt--; else{ if(r-\u0026gt;son[0]==null \u0026amp;\u0026amp; r-\u0026gt;son[1]==null){//å·²ç»æ²¡æœ‰å­èŠ‚ç‚¹ï¼Œç›´æ¥åˆ é™¤  r = null;return; } else{//è¿˜æœ‰å­èŠ‚ç‚¹ï¼Œ  int tmp = r-\u0026gt;son[1]-\u0026gt;p \u0026lt; r-\u0026gt;son[0]-\u0026gt;p; rotate(r,1-tmp); //æ‰¾åˆ°å…¶ä¸­éšæœºæƒå€¼è¾ƒå°çš„ä¸€ä¸ªæ—‹è½¬æ›¿æ¢å½“å‰èŠ‚ç‚¹  __erase(r,v);//é€’å½’åˆ é™¤ æ³¨æ„æ­¤å¤„rå·²ç»å‘ç”Ÿäº†å˜åŒ–  } } } else{//è¿˜æ²¡æ‰¾åˆ°  int tmp = r-\u0026gt;val \u0026lt; v; __erase(r-\u0026gt;son[tmp],v);//é€’å½’å¯»æ‰¾  } update(r);//ä¸è¦å¿˜äº†æ›´æ–°ï¼  } void __print(node_t *r,int depth = 0){//è°ƒè¯•ç”¨  if(r == null) return; else{ __print(r-\u0026gt;son[0],depth+1); for(int i = 0;i\u0026lt;depth;i++) putchar(\u0026#39; \u0026#39;);//æ‰“å°æ·±åº¦  printf(\u0026#34;val:%d cnt:%d size:%d P:%d son?:%d %d\\n\u0026#34;,r-\u0026gt;val,r-\u0026gt;cnt,r-\u0026gt;size,r-\u0026gt;p,r-\u0026gt;son[0]!=null,r-\u0026gt;son[1]!=null); __print(r-\u0026gt;son[1],depth+1); } } int __getrank(node_t *r,T v){//æŸ¥æ‰¾æ•°vçš„æ’å  if(r-\u0026gt;val == v||r == null)//è®°å¾—åˆ¤ç©ºï¼  return r-\u0026gt;son[0]-\u0026gt;size +1; else if(v \u0026lt; r-\u0026gt;val) return __getrank(r-\u0026gt;son[0],v); else return __getrank(r-\u0026gt;son[1],v) + r-\u0026gt;son[0]-\u0026gt;size + r-\u0026gt;cnt; } node_t* __qrank(node_t *r,int rank){//æŸ¥æ‰¾ä»¥rankæ’åçš„æ•°  rank -= r-\u0026gt;son[0]-\u0026gt;size; if(rank\u0026lt;=0) return __qrank(r-\u0026gt;son[0],rank + r-\u0026gt;son[0]-\u0026gt;size); else if(rank \u0026lt;= r-\u0026gt;cnt) return r; else return __qrank(r-\u0026gt;son[1],rank - r-\u0026gt;cnt); } node_t *find_minormax(node_t *r,int tmp){ //å¯»æ‰¾ä»¥rä¸ºæ ¹èŠ‚ç‚¹çš„æ ‘ä¸Šæœ€å¤§æˆ–æœ€å°èŠ‚ç‚¹  while(r-\u0026gt;son[tmp]!=null) r = r-\u0026gt;son[tmp]; return r; } node_t *loworup(T v,int t){//0ä»£è¡¨å‰é©±ï¼Œ1ä»£è¡¨åç»§  node_t *last = null,*nown = root;//lastè¡¨ç¤ºä¸Šä¸€ä¸ªæ²¡æœ‰å½“å‰å¯»æ‰¾æ–¹å‘çš„èŠ‚ç‚¹  while(nown-\u0026gt;val!=v \u0026amp;\u0026amp; nown!=null){//è®°å¾—åˆ¤ç©º!  int tmp = nown-\u0026gt;val \u0026lt; v; if(tmp!=t) last = nown; nown = nown-\u0026gt;son[tmp]; } if(nown-\u0026gt;son[t]!=null)//æœ‰å­èŠ‚ç‚¹  last = find_minormax(nown-\u0026gt;son[t],1-t);//å¯»æ‰¾å¯¹åº”æ–¹å‘å­èŠ‚ç‚¹çš„æœ€å°oræœ€å¤§å€¼  return last; } public: treap(){ treapcnt = 0; newnode(null); null-\u0026gt;size = null-\u0026gt;val=0; null-\u0026gt;p = maxint; root = null; srand(time(NULL)); } void insert(T v){__insert(root,v);} void erase(T v){__erase(root,v);} int getrank(T v){return __getrank(root,v);} int qrank(int rank){return __qrank(root,rank)-\u0026gt;val;} int lower(T v){return loworup(v,0)-\u0026gt;val;} int upper(T v){return loworup(v,1)-\u0026gt;val;} void print(){__print(root);} }; treap\u0026lt;int,200000\u0026gt; w; int n; int main(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n); for(int i = 0;i\u0026lt;n;i++){ int op, x; scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;op,\u0026amp;x); if(op == 1) w.insert(x); else if(op == 2) w.erase(x); else if(op == 3) printf(\u0026#34;%d\\n\u0026#34;,w.getrank(x)); else if(op == 4) printf(\u0026#34;%d\\n\u0026#34;,w.qrank(x)); else if(op == 5) printf(\u0026#34;%d\\n\u0026#34;,w.lower(x)); else if(op == 6) printf(\u0026#34;%d\\n\u0026#34;,w.upper(x)); else if(op == 0) w.print(); } return 0; }   update:æ•°ç»„ç‰ˆä»£ç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126  #include \u0026lt;bits/stdc++.h\u0026gt;#define maxint 2147483647 using namespace std; const int MAXN = 200000; struct treap{ int val[MAXN],p[MAXN],son[MAXN][2]; int siz[MAXN],cnt[MAXN]; int root,treapcnt; int newnode(int v){ int x = ++treapcnt; son[x][0] = son[x][1] = 0; val[x] = v;cnt[x] = 1;p[x] = rand(); return x; } void update(int x){ siz[x] = cnt[x]+siz[son[x][1]]+siz[son[x][0]]; } void rotate(int \u0026amp;x,int t){ int y = son[x][t]; son[x][t] = son[y][1-t]; son[y][1-t] = x; update(x),update(y); x = y; } treap(){ srand(19260817); treapcnt = root = 0; p[0] = maxint; } void __insert(int \u0026amp;x,int v){ if(x){ if(val[x] == v) cnt[x]++; else{ int t = v \u0026gt; val[x]; __insert(son[x][t],v); if(p[son[x][t]] \u0026lt; p[x]) rotate(x,t); } } else x = newnode(v); update(x); } void __erase(int \u0026amp;x,int v){ if(val[x] == v){ if(cnt[x]) cnt[x]--; else{ if(son[x][0] == 0 \u0026amp;\u0026amp; son[x][1] == 0){ x = 0;return; } int t = p[son[x][0]] \u0026gt; p[son[x][1]]; rotate(x,t); __erase(x,v); } } else{ int t = val[x] \u0026lt; v; __erase(son[x][t],v); } update(x); } int get_kth(int k){ int x = root; while(true){ if(k\u0026lt;=siz[son[x][0]]) x = son[x][0]; else{ k -= siz[son[x][0]] + cnt[x]; if(k\u0026lt;=0) return val[x]; else x = son[x][1]; } } } int get_rank(int v){ int x = root,ans = 0; while(x){ if(v \u0026lt; val[x]) x = son[x][0]; else if(v \u0026gt; val[x]) ans+=siz[son[x][0]]+cnt[x],x = son[x][1]; else ans+=siz[son[x][0]],x = 0; } return ans; } void __print(int x,int dep){ if(dep == 0) printf(\u0026#34;-------------------\\n\u0026#34;); if(x == 0) return; __print(son[x][0],dep+1); for(int i = 0;i\u0026lt;dep;i++) putchar(\u0026#39; \u0026#39;); printf(\u0026#34;v:%d p:%d siz:%d cnt:%d son:%d %d\\n\u0026#34;,val[x],p[x],siz[x],cnt[x],son[x][0],son[x][1]); __print(son[x][1],dep+1); if(dep == 0) printf(\u0026#34;---------------------\\n\u0026#34;); } void insert(int v){__insert(root,v);} void erase(int v){__erase(root,v);} int upper(int v){return get_kth(get_rank(v+1)+1);} int lower(int v){return get_kth(get_rank(v));} void print(){__print(root,0);} }; treap a; int n,op,v; int main(){ scanf(\u0026#34;%d\u0026#34;,\u0026amp;n); for(int i = 1;i\u0026lt;=n;i++){ scanf(\u0026#34;%d %d\u0026#34;,\u0026amp;op,\u0026amp;v); if(op == 1) a.insert(v); else if(op == 2) a.erase(v); else if(op == 3) printf(\u0026#34;%d\\n\u0026#34;,a.get_rank(v)+1); else if(op == 4) printf(\u0026#34;%d\\n\u0026#34;,a.get_kth(v)); else if(op == 5) printf(\u0026#34;%d\\n\u0026#34;,a.lower(v)); else if(op == 6) printf(\u0026#34;%d\\n\u0026#34;,a.upper(v)); else if(op == 0) a.print(),--i; } return 0; }   ä¾‹é¢˜ ã€ŒZJOI2007ã€æŠ¥è¡¨ç»´æŠ¤\n","description":"é—²ä¸‹æ¥äº†ï¼Œå¼€å§‹å†™ä¸€ç‚¹å­¦ä¹ ç¬”è®°ï¼Œä¹Ÿå¸Œæœ›èƒ½ç»™åäººé€ ç¦å§ã€‚ç¬¬ä¸€ç¯‡æ¥è¯´ä¸€è¯´Treapã€‚","id":226,"section":"posts","tags":["æ•°æ®ç»“æ„","å¹³è¡¡æ ‘","Treap","ç¬”è®°","æ¨¡æ¿"],"title":"Treapå­¦ä¹ ç¬”è®°","uri":"https://blog.chenqiqian.com/posts/notes-treap/"}]