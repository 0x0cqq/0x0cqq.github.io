---
title: 可能是最简单的线段树介绍
date: 2017-12-18 21:19:58
tags: 介绍
categories: OI
visible: hide
urlname: segment-tree
---

看了网上的各种线段树介绍，实在是觉得有点复杂。所以先开一个坑，慢慢填。

## 0x00 概述

本文将从是什么、为什么、怎么做、有什么用这几个方面来介绍一下线段树这一重要的数据结构。

<!-- more -->

## 0x01 什么是线段树

为了学习线段树这样一个数据结构，我们需要先搞明白这是一个什么东西。

线段树是一种二叉搜索树，与区间树相似，它将一个区间划分成一些区间，每个单元区间对应线段树中的一个叶结点。

而每一个节点所包含的区间恰好被其子节点均分为两半。

## 0x02 线段树有什么用呢

一句话：在O(log n)的对数时间维护和查询某段区间的诸如和，最小值，最大值等信息。

权且猜测读者已经了解了树状数组。在树状数组的学习中，我们会知道，树状数组的出现其实是为了平衡前缀和、普通数组这两种数据结构，它能做到的就是在O(log n)的对数时间内求一段区间的和，以及改变某个数的值。

但是倘若需要对区间进行操作该怎么办呢？如果我将区间中的每一个数都进行操作的话，那么时间复杂度已经达到了O(n)，显然是我们不能承受之慢。如果不使用差分版的树状数组这个时候，我们就需要下面即将介绍的——线段树。


## 0x03 操作

开始是打算直接讲lazy标记的，但感觉没有代码讲数据结构简直是耍流氓，所以我们先来看一个简单的线段树的代码。

首先明确我们的需求：能够实现一个支持区间加法，区间求和的线段树。

### 头文件部分
```cpp
#define ll long long
#define lson (nown<<1)
#define rson (nown<<1|1)
#define mid ((l+r)>>1)
#define MAXN 100005

ll sumn[MAXN<<2],addn[MAXN<<2];
```
我一般喜欢把这几个东西先define出来，这样以后的代码能简洁很多。

在这里，我使用的数组来模拟树形结构。```nown ```代表当前节点，规定nown*2为左子节点，nown*2+1为为右子节点


### 函数1：push_up

```cpp
void push_up(int nown){
    sumn[nown] = sumn[lson] + sumn[rson];
}
```

### ...


## 0x04 怎么做到的呢

这一部分主要分为以下几个部分

说到线段树，就不得不说——

### 线段树的核心思想——懒惰（lazy）标记

为什么叫lazy标记呢？顾名思义，也就是为了使我们的修改操作更加的快速，我们会犯一些懒。主要来说，就是不做完所有的区间修改。我们如果发现我们目前要修改的这个区间完全被线段树某个节点对应的区间包含，那么我们就可以意识到，这个区间里的每一个点，我们都需要做这样一个修改。那么我们就会给这个区间打上一个lazy标记，标志着，我知道这个区间要改，我还没有改完这个区间以下的子区间。


### 帮助理解lazy标记的重要性质

性质：我们可以认为，在线段树这样的树状结构上，lazy标记以上的部分的信息都是完全准确的。




(to be finished)

